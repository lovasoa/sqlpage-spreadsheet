!function(){var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function t(e,t,r,n){Object.defineProperty(e,t,{get:r,set:n,enumerable:!0,configurable:!0})}var r=e.parcelRequire26fc,n=r.register;n("83KcA",function(n,o){let i,s,a,l,u,c,d,h,p,f,g,m,_,y,E,b,v,R,T,I,C,S,O,x,A,w,N,D,L,M,U,P,k,F,j,B,H,$,G,W,V,z,K,Y,q,J,X,Q,Z,ee,et,er,en,eo,ei,es,ea,el,eu,ec,ed,eh,ep,ef,eg,em,e_,ey,eE,eb,ev,eR,eT,eI,eC,eS,eO,ex,eA,ew,eN,eD,eL,eM,eU,eP,ek,eF,ej,eB,eH,e$,eG,eW,eV;t(n.exports,"remove",function(){return tt}),t(n.exports,"isBooleanString",function(){return tn}),t(n.exports,"DOCS_NORMAL_EDITOR_UNIT_ID_KEY",function(){return ti}),t(n.exports,"DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY",function(){return ts}),t(n.exports,"DOCS_ZEN_EDITOR_UNIT_ID_KEY",function(){return ta}),t(n.exports,"DEFAULT_EMPTY_DOCUMENT_VALUE",function(){return tl}),t(n.exports,"createInternalEditorID",function(){return tu}),t(n.exports,"isInternalEditorID",function(){return tc}),t(n.exports,"isClassDependencyItem",function(){return tf}),t(n.exports,"Quantity",function(){return sD}),t(n.exports,"createIdentifier",function(){return tL}),t(n.exports,"Optional",function(){return tH}),t(n.exports,"Inject",function(){return t$}),t(n.exports,"Injector",function(){return rd}),t(n.exports,"useInjector",function(){return rT}),t(n.exports,"useDependency",function(){return rI}),t(n.exports,"connectInjector",function(){return rO}),t(n.exports,"useObservable",function(){return rL}),t(n.exports,"shallowEqual",function(){return rU}),t(n.exports,"CustomCommandExecutionError",function(){return rk}),t(n.exports,"throttle",function(){return rF}),t(n.exports,"createInterceptorKey",function(){return rj}),t(n.exports,"composeInterceptors",function(){return rB}),t(n.exports,"InterceptorManager",function(){return r$}),t(n.exports,"MemoryCursor",function(){return rW}),t(n.exports,"isNumeric",function(){return rV}),t(n.exports,"isSafeNumeric",function(){return rz}),t(n.exports,"Registry",function(){return rY}),t(n.exports,"requestImmediateMacroTask",function(){return rq}),t(n.exports,"mergeSets",function(){return rQ}),t(n.exports,"toDisposable",function(){return r7}),t(n.exports,"DisposableCollection",function(){return nt}),t(n.exports,"Disposable",function(){return nn}),t(n.exports,"RxDisposable",function(){return ni}),t(n.exports,"IContextService",function(){return ns}),t(n.exports,"ILogService",function(){return nu}),t(n.exports,"CommandType",function(){return ng}),t(n.exports,"ICommandService",function(){return nm}),t(n.exports,"NilCommand",function(){return ny}),t(n.exports,"sequenceExecute",function(){return nR}),t(n.exports,"sequenceExecuteAsync",function(){return nT}),t(n.exports,"fromCallback",function(){return nI}),t(n.exports,"searchArray",function(){return nx}),t(n.exports,"MOVE_BUFFER_VALUE",function(){return nA}),t(n.exports,"checkIfMove",function(){return nw}),t(n.exports,"BorderStyleTypes",function(){return nD}),t(n.exports,"BorderType",function(){return nL}),t(n.exports,"Dimension",function(){return nF}),t(n.exports,"Direction",function(){return nj}),t(n.exports,"getReverseDirection",function(){return nB}),t(n.exports,"LocaleType",function(){return nG}),t(n.exports,"TextDecoration",function(){return nY}),t(n.exports,"HorizontalAlign",function(){return nq}),t(n.exports,"VerticalAlign",function(){return nJ}),t(n.exports,"WrapStrategy",function(){return nX}),t(n.exports,"FontItalic",function(){return nQ}),t(n.exports,"FontWeight",function(){return nZ}),t(n.exports,"BaselineOffset",function(){return n0}),t(n.exports,"BooleanNumber",function(){return n1}),t(n.exports,"CellValueType",function(){return n2}),t(n.exports,"generateRandomId",function(){return oE}),t(n.exports,"Tools",function(){return oy}),t(n.exports,"convertBodyToHtml",function(){return ov}),t(n.exports,"COLORS",function(){return oD}),t(n.exports,"ColorKit",function(){return oM}),t(n.exports,"isWhiteColor",function(){return oJ}),t(n.exports,"UpdateDocsAttributeType",function(){return oX}),t(n.exports,"isICellData",function(){return oQ}),t(n.exports,"getCellValueType",function(){return oZ}),t(n.exports,"isNullCell",function(){return o0}),t(n.exports,"isCellV",function(){return o1}),t(n.exports,"RANGE_TYPE",function(){return o2}),t(n.exports,"AbsoluteRefType",function(){return o5}),t(n.exports,"selectionToArray",function(){return o3}),t(n.exports,"RANGE_DIRECTION",function(){return o6}),t(n.exports,"DOC_RANGE_TYPE",function(){return o4}),t(n.exports,"getCellInfoInMergeData",function(){return o9}),t(n.exports,"makeCellToSelection",function(){return o8}),t(n.exports,"makeCellRangeToRangeData",function(){return o7}),t(n.exports,"isCellCoverable",function(){return it}),t(n.exports,"getColorStyle",function(){return ir}),t(n.exports,"isFormulaString",function(){return io}),t(n.exports,"isFormulaId",function(){return ii}),t(n.exports,"handleStyleToString",function(){return is}),t(n.exports,"getBorderStyleType",function(){return il}),t(n.exports,"isValidRange",function(){return iu}),t(n.exports,"cellToRange",function(){return ic}),t(n.exports,"checkForSubstrings",function(){return ip}),t(n.exports,"debounce",function(){return ig}),t(n.exports,"horizontalLineSegmentsSubtraction",function(){return im}),t(n.exports,"checkParagraphHasIndentByStyle",function(){return i_}),t(n.exports,"insertTextToContent",function(){return iy}),t(n.exports,"deleteContent",function(){return iE}),t(n.exports,"isRealNum",function(){return ib}),t(n.exports,"hashAlgorithm",function(){return iv}),t(n.exports,"LRUMap",function(){return iA}),t(n.exports,"numfmt",function(){return iL}),t(n.exports,"getArrayLength",function(){return iM}),t(n.exports,"insertMatrixArray",function(){return iU}),t(n.exports,"spliceArray",function(){return iP}),t(n.exports,"concatMatrixArray",function(){return ik}),t(n.exports,"sliceMatrixArray",function(){return iF}),t(n.exports,"moveMatrixArray",function(){return ij}),t(n.exports,"ObjectMatrix",function(){return iG}),t(n.exports,"DEFAULT_STYLES",function(){return iW}),t(n.exports,"Range",function(){return iq}),t(n.exports,"moveRangeByOffset",function(){return iJ}),t(n.exports,"Rectangle",function(){return i5}),t(n.exports,"queryObjectMatrix",function(){return i9}),t(n.exports,"createRowColIter",function(){return i8}),t(n.exports,"numberToABC",function(){return i7}),t(n.exports,"numberToListABC",function(){return st}),t(n.exports,"sortRules",function(){return sr}),t(n.exports,"sortRulesByDesc",function(){return sn}),t(n.exports,"sortRulesFactory",function(){return so}),t(n.exports,"UniverInstanceType",function(){return si}),t(n.exports,"TextXActionType",function(){return sK}),t(n.exports,"DataStreamTreeNodeType",function(){return sY}),t(n.exports,"DataStreamTreeTokenType",function(){return sq}),t(n.exports,"GlyphType",function(){return sQ}),t(n.exports,"BulletAlignment",function(){return sZ}),t(n.exports,"CustomRangeType",function(){return s0}),t(n.exports,"CustomDecorationType",function(){return s1}),t(n.exports,"DocumentFlavor",function(){return s5}),t(n.exports,"GridType",function(){return s3}),t(n.exports,"SectionType",function(){return s6}),t(n.exports,"ColumnSeparatorType",function(){return s4}),t(n.exports,"WrapTextType",function(){return s7}),t(n.exports,"PositionedObjectLayoutType",function(){return ae}),t(n.exports,"SpacingRule",function(){return ar}),t(n.exports,"TableSizeType",function(){return ai}),t(n.exports,"TableAlignmentType",function(){return as}),t(n.exports,"TableTextWrapType",function(){return al}),t(n.exports,"TableCellHeightRule",function(){return au}),t(n.exports,"FontStyleType",function(){return ad}),t(n.exports,"ObjectRelativeFromH",function(){return ah}),t(n.exports,"ObjectRelativeFromV",function(){return ap}),t(n.exports,"NumberUnitType",function(){return af}),t(n.exports,"AlignTypeH",function(){return ag}),t(n.exports,"AlignTypeV",function(){return am}),t(n.exports,"PageOrientType",function(){return ay}),t(n.exports,"DrawingTypeEnum",function(){return ab}),t(n.exports,"PresetListType",function(){return aR}),t(n.exports,"PRESET_LIST_TYPE",function(){return aO}),t(n.exports,"QuickListTypeMap",function(){return aA}),t(n.exports,"normalizeTextRuns",function(){return aw}),t(n.exports,"SliceBodyType",function(){return a2}),t(n.exports,"getBodySlice",function(){return a5}),t(n.exports,"getCustomDecorationSlice",function(){return a4}),t(n.exports,"getCustomRangeSlice",function(){return a6}),t(n.exports,"normalizeBody",function(){return a3}),t(n.exports,"updateAttributeByInsert",function(){return lt}),t(n.exports,"TextX",function(){return ld}),t(n.exports,"JSONX",function(){return lp}),t(n.exports,"DocumentDataModel",function(){return ly}),t(n.exports,"BuildTextUtils",function(){return lW}),t(n.exports,"EventSubject",function(){return lK}),t(n.exports,"fromEventSubject",function(){return lY}),t(n.exports,"IResourceManagerService",function(){return lq}),t(n.exports,"LifecycleStages",function(){return lJ}),t(n.exports,"OnLifecycle",function(){return lZ}),t(n.exports,"runOnLifecycle",function(){return l0}),t(n.exports,"UserManagerService",function(){return ut}),t(n.exports,"IAuthzIoService",function(){return ul}),t(n.exports,"IConfigService",function(){return uu}),t(n.exports,"FOCUSING_SHEET",function(){return uh}),t(n.exports,"FOCUSING_DOC",function(){return up}),t(n.exports,"FOCUSING_EDITOR_BUT_HIDDEN",function(){return ug}),t(n.exports,"EDITOR_ACTIVATED",function(){return um}),t(n.exports,"FOCUSING_EDITOR_INPUT_FORMULA",function(){return u_}),t(n.exports,"FOCUSING_FX_BAR_EDITOR",function(){return uy}),t(n.exports,"FOCUSING_UNIVER_EDITOR",function(){return uE}),t(n.exports,"FOCUSING_EDITOR_STANDALONE",function(){return ub}),t(n.exports,"FOCUSING_UNIVER_EDITOR_STANDALONE_SINGLE_MODE",function(){return uv}),t(n.exports,"FOCUSING_COMMON_DRAWINGS",function(){return uR}),t(n.exports,"FORMULA_EDITOR_ACTIVATED",function(){return uT}),t(n.exports,"ErrorService",function(){return uC}),t(n.exports,"DEFAULT_WORKSHEET_ROW_HEIGHT",function(){return uw}),t(n.exports,"DEFAULT_WORKSHEET_COLUMN_WIDTH_KEY",function(){return uN}),t(n.exports,"DEFAULT_WORKSHEET_COLUMN_WIDTH",function(){return uD}),t(n.exports,"mergeWorksheetSnapshotWithDefault",function(){return uL}),t(n.exports,"extractPureTextFromCell",function(){return uk}),t(n.exports,"getOriginCellValue",function(){return uF}),t(n.exports,"Workbook",function(){return uG}),t(n.exports,"SlideDataModel",function(){return uV}),t(n.exports,"IUniverInstanceService",function(){return uJ}),t(n.exports,"LifecycleService",function(){return u6}),t(n.exports,"ILocalStorageService",function(){return u8}),t(n.exports,"LocaleService",function(){return ce}),t(n.exports,"PermissionStatus",function(){return ct}),t(n.exports,"IPermissionService",function(){return cr}),t(n.exports,"Plugin",function(){return cs}),t(n.exports,"DependentOn",function(){return cp}),t(n.exports,"mergeOverrideWithDependencies",function(){return cm}),t(n.exports,"IResourceLoaderService",function(){return c_}),t(n.exports,"ThemeService",function(){return cb}),t(n.exports,"IUndoRedoService",function(){return cC}),t(n.exports,"RedoCommandId",function(){return cx}),t(n.exports,"UndoCommandId",function(){return cA}),t(n.exports,"UndoCommand",function(){return cw}),t(n.exports,"RedoCommand",function(){return cN}),t(n.exports,"nameCharacterCheck",function(){return cL}),t(n.exports,"isRangesEqual",function(){return cM}),t(n.exports,"isUnitRangesEqual",function(){return cU}),t(n.exports,"skipParseTagNames",function(){return cP}),t(n.exports,"DataValidationErrorStyle",function(){return c$}),t(n.exports,"DataValidationOperator",function(){return cW}),t(n.exports,"DataValidationRenderMode",function(){return cV}),t(n.exports,"DataValidationStatus",function(){return cz}),t(n.exports,"DataValidationType",function(){return cK}),t(n.exports,"Univer",function(){return c0});var ez=r("gQuIR"),eK=r("jv4BO"),eY=r("5WWyv"),eq=r("eSxk0"),eJ=r("a9FIH"),eX=r("fElJC"),eQ=r("d0sRG"),eZ=r("3KKCW"),e0=r("bA4Xh"),e1=r("9kWt8"),e2=r("2Ha4T"),eJ=(r("bspY6"),r("bVip2"),r("a9FIH")),eX=(r("2zeiB"),r("fElJC")),e5=r("kUeYt"),e3=Object.defineProperty,e6=(e,t,r)=>t in e?e3(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,e4=(e,t)=>e3(e,"name",{value:t,configurable:!0}),e9=(e,t,r)=>e6(e,"symbol"!=typeof t?t+"":t,r);function e8(){te()}e4(function(e,t){for(var r=0;r<t.length;r++){let n=t[r];if("string"!=typeof n&&!Array.isArray(n)){for(let t in n)if("default"!==t&&!(t in e)){let r=Object.getOwnPropertyDescriptor(n,t);r&&Object.defineProperty(e,t,r.get?r:{enumerable:!0,get:/* @__PURE__ */e4(()=>n[t],"get")})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))},"_mergeNamespaces"),e4(e8,"installShims");let e7="u">typeof e?e:"u">typeof self?self:window;function te(){"function"!=typeof e7.requestIdleCallback&&(e7.requestIdleCallback=/* @__PURE__ */e4(function(e){let t=Date.now();return setTimeout(/* @__PURE__ */e4(function(){let r=Math.max(0,50-(Date.now()-t));e({didTimeout:0===r,timeRemaining:()=>r})},"rICCallback"),1)},"shimRIC")),"function"!=typeof e7.cancelIdleCallback&&(e7.cancelIdleCallback=/* @__PURE__ */e4(function(e){clearTimeout(e)},"shimCancelRIC"))}function tt(e,t){let r=e.indexOf(t);return r>-1&&(e.splice(r,1),!0)}function tr(e,t){for(let r=e.length-1;r>-1;r--){let n=e[r];if(t(n,r))return n}return null}function tn(e){return["true","false"].includes(e.toLowerCase())}e4(te,"installRequestIdleCallback"),e4(tt,"remove"),e4(function(e){let t=/* @__PURE__ */new Set,r=[];for(let n of e)t.has(n)||(t.add(n),r.push(n));return r},"dedupe"),e4(tr,"findLast"),e4(function(e,t){if(0===e.length)return e;let r=t%e.length;return e.slice(r).concat(e.slice(0,r))},"rotate"),e4(function(e,t){let r=/* @__PURE__ */new Map;return e.forEach(e=>{let n=t(e),o=r.get(n);r.has(n)||(o=[],r.set(n,o)),o.push(e)}),r},"groupBy"),e4(function(e){return Array.isArray(e)?e:[e]},"makeArray"),e4(tn,"isBooleanString");let to="__INTERNAL_EDITOR__",ti=`${to}DOCS_NORMAL`,ts=`${to}DOCS_FORMULA_BAR`,ta=`${to}ZEN_EDITOR`,tl=`\r
`;function tu(e){return`${to}${e}`}function tc(e){return e.startsWith(to)}e4(tu,"createInternalEditorID"),e4(tc,"isInternalEditorID");var td=Symbol("$$IDENTIFIER_DECORATOR");function th(e){return e&&!0===e[td]}function tp(e){return"function"==typeof e}function tf(e){return!!(e&&"u">typeof e.useClass)}function tg(e){return!!(e&&"u">typeof e.useFactory)}function tm(e){return!!(e&&"u">typeof e.useValue)}function t_(e){return!!(e&&"u">typeof e.useExisting)}function ty(e){return!!(e&&"u">typeof e.useAsync)}e4(th,"isIdentifierDecorator"),e4(tp,"isCtor"),e4(tf,"isClassDependencyItem"),e4(tg,"isFactoryDependencyItem"),e4(tm,"isValueDependencyItem"),e4(t_,"isExistingDependencyItem"),e4(ty,"isAsyncDependencyItem");var tE=Symbol("AsyncHook");function tb(e){return!!(e&&e.__symbol===tE)}function tv(e){return typeof e>"u"?"undefined":tp(e)&&!e[td]?e.name:e.toString()}e4(tb,"isAsyncHook"),e4(tv,"prettyPrintIdentifier"),(sv=sD||(sD={})).MANY="many",sv.OPTIONAL="optional",sv.REQUIRED="required",(sR=sL||(sL={})).SELF="self",sR.SKIP_SELF="skipSelf";var tR=(sT=/* @__PURE__ */e4(function(e,t){return(sT=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},"extendStatics"),function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}sT(e,t),e4(r,"__"),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),tT=function(e){function t(t){return e.call(this,"[redi]: ".concat(t))||this}return tR(t,e),e4(t,"RediError"),t}(Error),tI=(sI=/* @__PURE__ */e4(function(e,t){return(sI=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},"extendStatics"),function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}sI(e,t),e4(r,"__"),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),tC=Symbol("$$TARGET"),tS=Symbol("$$DEPENDENCIES"),tO=function(e){function t(t,r){var n="Could not find dependency registered on the ".concat(t,' (indexed) parameter of the constructor of "').concat(tv(r),'".');return e.call(this,n)||this}return tI(t,e),e4(t,"DependencyDescriptorNotFoundError"),t}(tT),tx=function(e){function t(t,r){var n='It seems that you register "undefined" as dependency on the '.concat(r+1,' parameter of "').concat(tv(t),'". Please make sure that there is not cyclic dependency among your TypeScript files, or consider using "forwardRef". For more info please visit our website https://redi.wendell.fun/docs/debug#could-not-find-dependency-registered-on');return e.call(this,n)||this}return tI(t,e),e4(t,"IdentifierUndefinedError"),t}(tT);function tA(e){return e[tS]||[]}function tw(e,t){var r=tA(e).find(function(e){return e.paramIndex===t});if(!r)throw new tO(t,e);return r}function tN(e,t,r,n,o){void 0===n&&(n=sD.REQUIRED);var i={paramIndex:r,identifier:t,quantity:n,lookUp:o,withNew:!1};if(typeof t>"u")throw new tx(e,r);e[tC]===e?e[tS].push(i):(e[tS]=[i],e[tC]=e)}e4(tA,"getDependencies"),e4(tw,"getDependencyByIndex"),e4(tN,"setDependency");var tD=/* @__PURE__ */new Set;function tL(e){if(tD.has(e))throw new tT('Identifier "'.concat(e,'" already exists.'));tD.add(e);var t=/* @__PURE__ */e4(function(e,r,n){tN(e,t,n)},"decorator");return t.toString=function(){return e},t[td]=!0,t}e4(tL,"createIdentifier");var tM=(sC=/* @__PURE__ */e4(function(e,t){return(sC=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},"extendStatics"),function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}sC(e,t),e4(r,"__"),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),tU=function(e){function t(t,r,n){var o='Expect "'.concat(r,'" dependency items for id "').concat(tv(t),'" but get ').concat(n,".");return e.call(this,o)||this}return tM(t,e),e4(t,"QuantityCheckError"),t}(tT);function tP(e,t,r){if(t===sD.OPTIONAL&&r>1||t===sD.REQUIRED&&1!==r)throw new tU(e,t,r)}function tk(e,t){return e===sD.MANY?t:t[0]}function tF(e,t,r){tw(e,t).quantity=r}function tj(e){return /* @__PURE__ */e4(function t(r){return this instanceof t?this:function(t,n,o){if(r)tN(t,r,o,e);else{if(e===sD.REQUIRED)throw new tx(t,o);tF(t,o,e)}}},"decoratorFactory")}e4(tP,"checkQuantity"),e4(tk,"retrieveQuantity"),e4(tF,"changeQuantity"),e4(tj,"quantifyDecoratorFactoryProducer");var tB=tj(sD.MANY),tH=tj(sD.OPTIONAL),t$=tj(sD.REQUIRED);function tG(e){return!!e&&"function"==typeof e.unwrap}function tW(e){return tG(e)?e.unwrap():e}function tV(e){return!!e&&"function"==typeof e.dispose}e4(function(e){return{unwrap:e}},"forwardRef"),e4(tG,"isForwardRef"),e4(tW,"normalizeForwardRef"),e4(tV,"isDisposable");var tz=(sS=/* @__PURE__ */e4(function(e,t){return(sS=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},"extendStatics"),function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}sS(e,t),e4(r,"__"),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function tK(e){return 1===e.length}e4(tK,"isBareClassDependency");var tY=[];function tq(e){tY.push(e)}function tJ(){tY.pop()}function tX(){tY.length=0}e4(tq,"pushResolvingStack"),e4(tJ,"popupResolvingStack"),e4(tX,"clearResolvingStack");var tQ=function(e){function t(t,r,n){var o='Cannot find "'.concat(tv(r),'" registered by any injector. It is the ').concat(n,'th param of "').concat(th(t)?tv(t):t.name,'".');return e.call(this,o)||this}return tz(t,e),e4(t,"DependencyNotFoundForModuleError"),t}(tT),tZ=function(e){function t(t){var r=this,n='Cannot find "'.concat(tv(t),'" registered by any injector. The stack of dependencies is: "').concat(tY.map(function(e){return tv(e)}).join(" -> "),'".');return r=e.call(this,n)||this,tX(),r}return tz(t,e),e4(t,"DependencyNotFoundError"),t}(tT),t0=function(){function e(e){var t=this;this.dependencyMap=/* @__PURE__ */new Map,this.normalizeDependencies(e).map(function(e){return t.add(e[0],e[1])})}return e4(e,"DependencyCollection"),e.prototype.add=function(e,t){typeof t>"u"&&(t={useClass:e,lazy:!1});var r=this.dependencyMap.get(e);typeof r>"u"&&(r=[],this.dependencyMap.set(e,r)),r.push(t)},e.prototype.delete=function(e){this.dependencyMap.delete(e)},e.prototype.get=function(e,t){void 0===t&&(t=sD.REQUIRED);var r=this.dependencyMap.get(e);return tP(e,t,r.length),tk(t,r)},e.prototype.has=function(e){return this.dependencyMap.has(e)},e.prototype.append=function(e){var t=this;this.normalizeDependencies(e).forEach(function(e){return t.add(e[0],e[1])})},e.prototype.dispose=function(){this.dependencyMap.clear()},e.prototype.normalizeDependencies=function(e){return e.map(function(e){return[e[0],tK(e)?{useClass:e[0],lazy:!1}:e[1]]})},e}(),t1=function(){function e(){this.resolvedDependencies=/* @__PURE__ */new Map}return e4(e,"ResolvedDependencyCollection"),e.prototype.add=function(e,t){var r=this.resolvedDependencies.get(e);typeof r>"u"&&(r=[],this.resolvedDependencies.set(e,r)),r.push(t)},e.prototype.has=function(e){return this.resolvedDependencies.has(e)},e.prototype.delete=function(e){this.resolvedDependencies.has(e)&&(this.resolvedDependencies.get(e).forEach(function(e){return tV(e)?e.dispose():void 0}),this.resolvedDependencies.delete(e))},e.prototype.get=function(e,t){void 0===t&&(t=sD.REQUIRED);var r=this.resolvedDependencies.get(e);if(!r)throw new tZ(e);return tP(e,t,r.length),t===sD.MANY?r:r[0]},e.prototype.dispose=function(){Array.from(this.resolvedDependencies.values()).forEach(function(e){e.forEach(function(e){return tV(e)?e.dispose():void 0})}),this.resolvedDependencies.clear()},e}();function t2(e,t,r){tw(e,t).lookUp=r}function t5(e){return /* @__PURE__ */e4(function t(){return this instanceof t?this:function(t,r,n){t2(t,n,e)}},"DecoratorFactory")}e4(t2,"changeLookup"),e4(t5,"lookupDecoratorFactoryProducer");var t3=t5(sL.SKIP_SELF),t6=t5(sL.SELF);function t4(e,t,r){tw(e,t).withNew=r}function t9(e){return /* @__PURE__ */e4(function t(){return this instanceof t?this:function(t,r,n){t4(t,n,e)}},"DecoratorFactory")}e4(t4,"changeToSelf"),e4(t9,"withNewDecoratorFactoryProducer");var t8=t9(!0);function t7(e,t){return void 0===t&&(t=0),e?e.map(function(e,r){if(r+=t,!Array.isArray(e))return{paramIndex:r,identifier:e,quantity:sD.REQUIRED,withNew:!1};var n=e.slice(0,e.length-1),o=e[e.length-1],i=void 0,s=sD.REQUIRED,a=!1;return n.forEach(function(e){if(e instanceof t6)i=sL.SELF;else if(e instanceof t3)i=sL.SKIP_SELF;else if(e instanceof tH)s=sD.OPTIONAL;else if(e instanceof tB)s=sD.MANY;else if(e instanceof t8)a=!0;else throw new tT("unknown dep modifier ".concat(e,"."))}),{paramIndex:r,identifier:o,quantity:s,lookUp:i,withNew:a}}):[]}e4(t7,"normalizeFactoryDeps"),function(){if("u">typeof requestIdleCallback&&"u">typeof cancelIdleCallback)sM=/* @__PURE__ */e4(function(e,t){var r=requestIdleCallback(e,"number"==typeof t?{timeout:t}:void 0),n=!1;return function(){n||(n=!0,cancelIdleCallback(r))}},"runWhenIdle");else{var e=Object.freeze({didTimeout:!0,timeRemaining:/* @__PURE__ */e4(function(){return 15},"timeRemaining")});sM=/* @__PURE__ */e4(function(t){var r=setTimeout(function(){return t(e)}),n=!1;return function(){n||(n=!0,clearTimeout(r))}},"runWhenIdle")}}();var re=function(){function e(e){var t=this;this.didRun=!1,this.selfExecutor=function(){try{t.value=e()}catch(e){t.error=e}finally{t.didRun=!0}},this.disposeCallback=sM(function(){return t.selfExecutor()})}return e4(e,"IdleValue"),e.prototype.hasRun=function(){return this.didRun},e.prototype.dispose=function(){this.disposeCallback()},e.prototype.getValue=function(){if(this.didRun||(this.dispose(),this.selfExecutor()),this.error)throw this.error;return this.value},e}(),rt=(sO=/* @__PURE__ */e4(function(e,t){return(sO=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},"extendStatics"),function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}sO(e,t),e4(r,"__"),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),rr=/* @__PURE__ */e4(function(){return(rr=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},"__assign$1"),rn=/* @__PURE__ */e4(function(e,t,r){if(r||2==arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},"__spreadArray$2"),ro=Symbol("$$NOT_INSTANTIATED_SYMBOL"),ri=function(e){function t(t){return e.call(this,'Detecting cyclic dependency. The last identifier is "'.concat(tv(t),'".'))||this}return rt(t,e),e4(t,"CircularDependencyError"),t}(tT),rs=function(e){function t(){return e.call(this,"Injector cannot be accessed after it was disposed.")||this}return rt(t,e),e4(t,"InjectorAlreadyDisposedError"),t}(tT),ra=function(e){function t(t){return e.call(this,'Async item "'.concat(tv(t),'" returns another async item.'))||this}return rt(t,e),e4(t,"AsyncItemReturnAsyncItemError"),t}(tT),rl=function(e){function t(t){return e.call(this,'Cannot get async item "'.concat(tv(t),'" from sync api.'))||this}return rt(t,e),e4(t,"GetAsyncItemFromSyncApiError"),t}(tT),ru=function(e){function t(t){return e.call(this,'Cannot add dependency "'.concat(tv(t),'" after it is already resolved.'))||this}return rt(t,e),e4(t,"AddDependencyAfterResolutionError"),t}(tT),rc=function(e){function t(t){return e.call(this,'Cannot dependency dependency "'.concat(tv(t),'" after it is already resolved.'))||this}return rt(t,e),e4(t,"DeleteDependencyAfterResolutionError"),t}(tT),rd=function(){function e(e,t){void 0===t&&(t=null),this.parent=t,this.children=[],this.resolutionOngoing=0,this.disposed=!1,this.dependencyCollection=new t0(e||[]),this.resolvedDependencyCollection=new t1,t&&t.children.push(this)}return e4(e,"Injector"),e.prototype.createChild=function(t){return this._ensureInjectorNotDisposed(),new e(t,this)},e.prototype.dispose=function(){this.children.forEach(function(e){return e.dispose()}),this.children.length=0,this.dependencyCollection.dispose(),this.resolvedDependencyCollection.dispose(),this.deleteSelfFromParent(),this.disposed=!0},e.prototype.deleteSelfFromParent=function(){if(this.parent){var e=this.parent.children.indexOf(this);e>-1&&this.parent.children.splice(e,1)}},e.prototype.add=function(e){this._ensureInjectorNotDisposed();var t=e[0],r=e[1];if(this.resolvedDependencyCollection.has(t))throw new ru(t);typeof r>"u"?this.dependencyCollection.add(t):ty(r)||tf(r)||tm(r)||tg(r)?this.dependencyCollection.add(t,r):this.resolvedDependencyCollection.add(t,r)},e.prototype.replace=function(e){this._ensureInjectorNotDisposed();var t=e[0];if(this.resolvedDependencyCollection.has(t))throw new ru(t);this.dependencyCollection.delete(t),1===e.length?this.dependencyCollection.add(t):this.dependencyCollection.add(t,e[1])},e.prototype.delete=function(e){if(this._ensureInjectorNotDisposed(),this.resolvedDependencyCollection.has(e))throw new rc(e);this.dependencyCollection.delete(e)},e.prototype.invoke=function(e){for(var t=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this._ensureInjectorNotDisposed();var o={get:/* @__PURE__ */e4(function(e,r,n){return t._get(e,r,n)},"get"),has:/* @__PURE__ */e4(function(e){return t.has(e)},"has")};return e.apply(void 0,rn([o],r,!1))},e.prototype.has=function(e){var t;return this.dependencyCollection.has(e)||(null===(t=this.parent)||void 0===t?void 0:t.has(e))||!1},e.prototype.get=function(e,t,r){this._ensureInjectorNotDisposed();var n=this._get(e,t,r);if(Array.isArray(n)&&n.some(function(e){return tb(e)})||tb(n))throw new rl(e);return n},e.prototype._get=function(e,t,r,n){var o=sD.REQUIRED;if(t===sD.REQUIRED||t===sD.OPTIONAL||t===sD.MANY?o=t:r=t,!n){var i=this.getValue(e,o,r);if(i!==ro)return i}return this.createDependency(e,o,r,!n)},e.prototype.getAsync=function(e){this._ensureInjectorNotDisposed();var t=this.getValue(e,sD.REQUIRED);if(t!==ro)return Promise.resolve(t);var r=this.createDependency(e,sD.REQUIRED);return tb(r)?r.whenReady():Promise.resolve(r)},e.prototype.createInstance=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return this._ensureInjectorNotDisposed(),this._resolveClassImpl.apply(this,rn([{useClass:e}],t,!1))},e.prototype._resolveDependency=function(e,t,r){var n;void 0===r&&(r=!0),tq(e);try{n=tm(t)?this._resolveValueDependency(e,t):tg(t)?this._resolveFactory(e,t,r):tf(t)?this._resolveClass(e,t,r):t_(t)?this._resolveExisting(e,t):this._resolveAsync(e,t),tJ()}catch(e){throw tJ(),e}return n},e.prototype._resolveExisting=function(e,t){var r=this.get(t.useExisting);return this.resolvedDependencyCollection.add(e,r),r},e.prototype._resolveValueDependency=function(e,t){var r=t.useValue;return this.resolvedDependencyCollection.add(e,r),r},e.prototype._resolveClass=function(e,t,r){var n,o=this;if(void 0===r&&(r=!0),t.lazy){var i=new re(function(){return o._ensureInjectorNotDisposed(),o._resolveClassImpl(t)});n=new Proxy(/* @__PURE__ */Object.create(null),{get:/* @__PURE__ */e4(function(e,t){if(t in e)return e[t];if("whenReady"!==t){var r=i.getValue(),n=r[t];return"function"!=typeof n||(n=n.bind(r),e[t]=n),n}},"get"),set:/* @__PURE__ */e4(function(e,t,r){return i.getValue()[t]=r,!0},"set")})}else n=this._resolveClassImpl(t);return e&&r&&this.resolvedDependencyCollection.add(e,n),n},e.prototype._resolveClassImpl=function(e){for(var t,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=e.useClass;this.markNewResolution(o);for(var i=tA(o).sort(function(e,t){return e.paramIndex-t.paramIndex}).map(function(e){return rr(rr({},e),{identifier:tW(e.identifier)})}),s=[],a=0;a<i.length;a++){var l=i[a];try{var u=this._get(l.identifier,l.quantity,l.lookUp,l.withNew);s.push(u)}catch(e){throw e instanceof tZ?new tQ(o,l.identifier,l.paramIndex):e}}var c=rn([],r,!0),d=i.length>0?i[0].paramIndex:c.length;if(c.length!==d){console.warn("[redi]: Expect ".concat(d," custom parameter(s) of ").concat(tv(o)," but get ").concat(c.length,"."));var h=d-c.length;c=h>0?rn(rn([],c,!0),Array(h).fill(void 0),!0):c.slice(0,d)}var p=new(o.bind.apply(o,rn(rn([void 0],c,!1),s,!1)));return null===(t=null==e?void 0:e.onInstantiation)||void 0===t||t.call(e,p),this.markResolutionCompleted(),p},e.prototype._resolveFactory=function(e,t,r){this.markNewResolution(e);for(var n,o=t7(t.deps),i=[],s=0;s<o.length;s++){var a=o[s];try{var l=this._get(a.identifier,a.quantity,a.lookUp,a.withNew);i.push(l)}catch(t){throw t instanceof tZ?new tQ(e,a.identifier,a.paramIndex):t}}var u=t.useFactory.apply(null,i);return r&&this.resolvedDependencyCollection.add(e,u),this.markResolutionCompleted(),null===(n=null==t?void 0:t.onInstantiation)||void 0===n||n.call(t,u),u},e.prototype._resolveAsync=function(e,t){var r=this;return{__symbol:tE,whenReady:/* @__PURE__ */e4(function(){return r._resolveAsyncImpl(e,t)},"whenReady")}},e.prototype._resolveAsyncImpl=function(e,t){var r=this;return t.useAsync().then(function(n){var o,i=r.getValue(e);if(i!==ro)return i;if(Array.isArray(n)){var s=n[1];if(ty(s))throw new ra(e);o=r._resolveDependency(e,s)}else o=tp(n)?r._resolveClassImpl({useClass:n,onInstantiation:t.onInstantiation}):n;return r.resolvedDependencyCollection.add(e,o),o})},e.prototype.getValue=function(e,t,r){var n=this;void 0===t&&(t=sD.REQUIRED);var o=/* @__PURE__ */e4(function(){return n.dependencyCollection.has(e)&&!n.resolvedDependencyCollection.has(e)?ro:n.resolvedDependencyCollection.get(e,t)},"onSelf"),i=/* @__PURE__ */e4(function(){return n.parent?n.parent.getValue(e,t):ro},"onParent");return r===sL.SKIP_SELF?i():r===sL.SELF||this.resolvedDependencyCollection.has(e)||this.dependencyCollection.has(e)?o():i()},e.prototype.createDependency=function(t,r,n,o){var i=this;void 0===r&&(r=sD.REQUIRED),void 0===o&&(o=!0);var s=/* @__PURE__ */e4(function(){var e=i.dependencyCollection.get(t,r),n=null;return Array.isArray(e)?n=e.map(function(e){return i._resolveDependency(t,e,o)}):e&&(n=i._resolveDependency(t,e,o)),n},"onSelf"),a=/* @__PURE__ */e4(function(){if(i.parent)return i.parent.createDependency(t,r,void 0,o);if(r===sD.OPTIONAL)return null;throw tq(t),new tZ(t)},"onParent");return n===sL.SKIP_SELF?a():t===e?this:this.dependencyCollection.has(t)?s():a()},e.prototype.markNewResolution=function(e){if(this.resolutionOngoing+=1,this.resolutionOngoing>=300)throw new ri(e)},e.prototype.markResolutionCompleted=function(){this.resolutionOngoing-=1},e.prototype._ensureInjectorNotDisposed=function(){if(this.disposed)throw new rs},e}();e4(function(e,t,r){void 0===r&&(r=0),t7(t,r).forEach(function(t){tN(e,t.identifier,t.paramIndex,t.quantity,t.lookUp)})},"setDependencies");var rh="u">typeof globalThis&&globalThis||"u">typeof window&&window||"u">typeof e&&e,rp="REDI_GLOBAL_LOCK",rf="u">typeof e5&&null!=e5.versions&&null!=e5.versions.node;rh[rp]?rf||console.error(`[redi]: You are loading scripts of redi more than once! This may cause undesired behavior in your application.
Maybe your dependencies added redi as its dependency and bundled redi to its dist files. Or you import different versions of redi.
For more info please visit our website: https://redi.wendell.fun/en-US/docs/debug#import-scripts-of-redi-more-than-once`):rh[rp]=!0;var rg="REDI_CONTEXT_LOCK",rm="u">typeof e5&&null!=e5.versions&&null!=e5.versions.node,r_="u">typeof globalThis&&globalThis||"u">typeof window&&window||"u">typeof e&&e;r_[rg]?rm||console.error('[redi]: "RediContext" is already created. You may import "RediContext" from different paths. Use "import { RediContext } from \'@wendellhu/redi/react-bindings\'; instead."'):r_[rg]=!0;var ry=ez.createContext({injector:null});ry.displayName="RediContext";var rE=ry.Provider,rb=ry.Consumer,rv=(sx=/* @__PURE__ */e4(function(e,t){return(sx=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},"extendStatics"),function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}sx(e,t),e4(r,"__"),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),rR=function(e){function t(){return e.call(this,"Using dependency injection outside of a RediContext.")||this}return rv(t,e),e4(t,"HooksNotInRediContextError"),t}(tT);function rT(){var e=ez.useContext(ry);if(!e.injector)throw new rR;return e.injector}function rI(e,t,r){var n=rT();return ez.useMemo(function(){return n.get(e,t,r)},[e,t,r])}e4(rT,"useInjector"),e4(rI,"useDependency");var rC=/* @__PURE__ */e4(function(){return(rC=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},"__assign");function rS(e){var t=e.children,r=e.dependencies,n=ez.useRef(null);return ez.useEffect(function(){return function(){var e;return null===(e=n.current)||void 0===e?void 0:e.dispose()}},[]),ez.createElement(rb,null,function(e){var o;return n.current?o=n.current:(o=e.injector?e.injector.createChild(r):new rd(r),n.current=o),ez.createElement(rE,{value:{injector:o}},t)})}function rO(e,t){return /* @__PURE__ */e4(function(r){return ez.createElement(rE,{value:{injector:t}},ez.createElement(e,rC({},r)))},"ComponentWithInjector")}e4(rS,"RediInjector"),e4(rO,"connectInjector"),e4(function(e,t){return /* @__PURE__ */e4(function(r){return ez.createElement(rS,{dependencies:t},ez.createElement(e,rC({},r)))},"ComponentWithInjector")},"connectDependencies");var rx=(sA=/* @__PURE__ */e4(function(e,t){return(sA=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},"extendStatics"),function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}sA(e,t),e4(r,"__"),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),rA=function(e){function t(t){return e.call(this,'You should make "RediContext" as '.concat(t.constructor.name,"'s default context type. ")+"If you want to use multiple context, please check this on React doc site. https://reactjs.org/docs/context.html#classcontexttype")||this}return rx(t,e),e4(t,"ClassComponentNotInRediContextError"),t}(tT);e4(function(e,t,r){return function(){return{get:/* @__PURE__ */e4(function(){var n=this.context;if(!n||!n.injector)throw new rA(this);return n.injector.get(e,t||sD.REQUIRED,r)},"get")}}},"WithDependency");var rw=/* @__PURE__ */e4(function(e,t,r){if(r||2==arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},"__spreadArray$1");function rN(e,t){var r=e instanceof eK.BehaviorSubject&&typeof t>"u"?e.getValue():t,n=(0,ez.useState)(r),o=n[0],i=n[1];return(0,ez.useEffect)(function(){var t=e.subscribe(function(e){return i(e)});return function(){return t.unsubscribe()}},[e]),o}function rD(e){return"function"==typeof e?e():e}function rL(e,t,r,n){if("function"==typeof e&&!n)throw new tT("Expected deps to be provided when observable is a function!");var o,i=(0,ez.useRef)(null),s=(0,ez.useRef)(!1),a=(0,ez.useMemo)(function(){return e},rw([],"u">typeof n?n:[e],!0)),l=(0,ez.useState)(0);l[0];var u=l[1],c=(0,ez.useRef)((a&&rD(a).subscribe(function(e){s.current=!0,o=e}).unsubscribe(),null!=o?o:t));if((0,ez.useEffect)(function(){var e=null;return a&&(i.current=rD(a),e=i.current.subscribe(function(e){c.current=e,u(function(e){return e+1})})),function(){return null==e?void 0:e.unsubscribe()}},[a]),r&&!s.current)throw Error("Expect `shouldHaveSyncValue` but not getting a sync value!");return c.current}e4(rN,"useDependencyValue"),e4(rD,"unwrap"),e4(rL,"useObservable"),e4(function(e){var t=(0,ez.useState)(0)[1];(0,ez.useEffect)(function(){var r=e.subscribe(function(){return t(function(e){return e+1})});return function(){return r.unsubscribe()}},[])},"useUpdateBinder");var rM=/* @__PURE__ */new WeakMap;function rU(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;let r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;let o=Object.prototype.hasOwnProperty.bind(t);for(let n=0;n<r.length;n++){let i=r[n];if(!o(i)||e[i]!==t[i])return!1}return!0}e4(function(e,t){var r=(0,ez.useRef)(void 0),n=rN(e,t),o=(0,ez.useMemo)(function(){return(0,ez.createContext)(n)},[e]),i=(0,ez.useCallback)(function(e){return(ez&&ez.__esModule?ez.default:ez).createElement(o.Provider,{value:n},e.children)},[e,n]);return r.current!==e&&(r.current&&rM.delete(r.current),r.current=e,rM.set(e,o)),{Provider:i,value:n}},"useDependencyContext"),e4(function(e){var t=rM.get(e);if(!t)throw new tT("try to read context value but no ancestor component subscribed it.");return(0,ez.useContext)(t)},"useDependencyContextValue"),e4(rU,"shallowEqual");let rP=class extends Error{constructor(e){super(e),this.name="CustomCommandExecutionError"}};e4(rP,"CustomCommandExecutionError");let rk=rP;function rF(e,t=16){let r=0,n=null;return /* @__PURE__ */e4(function(...o){let i=Date.now();i-r<t?(n&&clearTimeout(n),n=setTimeout(()=>{r=i,e.apply(this,o)},t)):(r=i,e.apply(this,o))},"throttled")}function rj(e){return`sheet_interceptor_${e}`}e4(rF,"throttle"),e4(rj,"createInterceptorKey");let rB=/* @__PURE__ */e4(e=>function(t,r){let n=-1;function o(t,i){if(t<=n)throw Error("[SheetInterceptorService]: next() called multiple times!");return n=t,t===e.length?i:e[t].handler(i,r,o.bind(null,t+1))}return e4(o,"passThrough"),o(0,t)},"composeInterceptors"),rH=class{constructor(e){e9(this,"_interceptorsByName",/* @__PURE__ */new Map),e9(this,"_interceptorPoints"),this._interceptorPoints=e}fetchThroughInterceptors(e){return rB(this._interceptorsByName.get(e)||[])}intercept(e,t){this._interceptorsByName.has(e)||this._interceptorsByName.set(e,[]);let r=this._interceptorsByName.get(e);return r.push(t),this._interceptorsByName.set(e,r.sort((e,t)=>{var r,n;return(null!=(r=t.priority)?r:0)-(null!=(n=e.priority)?n:0)})),()=>tt(this._interceptorsByName.get(e),t)}getInterceptPoints(){return this._interceptorPoints}dispose(){this._interceptorsByName.clear()}};e4(rH,"InterceptorManager");let r$=rH,rG=class{constructor(){e9(this,"cursor",0)}reset(){return this.cursor=0,this}moveCursor(e){this.cursor+=e}moveCursorTo(e){this.cursor=e}};e4(rG,"MemoryCursor");let rW=rG;function rV(e){return/^-?\d+(\.\d+)?$/.test(e)}function rz(e){return!!rV(e)&&Number(e)<=Number.MAX_SAFE_INTEGER}e4(function(e,t){for(let r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},"mixinClass"),e4(rV,"isNumeric"),e4(rz,"isSafeNumeric");let rK=class e{constructor(){e9(this,"_data",[])}static create(){return new e}add(e){this._data.indexOf(e)>-1||this._data.push(e)}delete(e){let t=this._data.indexOf(e);this._data.splice(t,1)}getData(){return this._data}};e4(rK,"Registry");let rY=rK;function rq(e){let t=new MessageChannel,r=!1,n=/* @__PURE__ */e4(()=>{r||e()},"hanlder");return t.port1.onmessage=n,t.port2.postMessage(null),()=>{r=!0,t.port1.close(),t.port2.close()}}async function rJ(e){for(let[t,r]of e.entries())try{if(!await r())return{index:t,result:!1}}catch(e){return{index:t,result:!1,error:e}}return{result:!0,index:-1}}function rX(e){for(let[t,r]of e.entries())try{if(!r())return{index:t,result:!1}}catch(e){return{index:t,result:!1,error:e}}return{result:!0,index:-1}}function rQ(e,t){return t.forEach(t=>e.add(t)),e}function rZ(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:/* @__PURE__ */e4(function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}},"next")};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function r0(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function r1(e,t,r){if(r||2==arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function r2(e){return"function"==typeof e}function r5(e){var t=e(/* @__PURE__ */e4(function(e){Error.call(e),e.stack=Error().stack},"_super"));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}e4(class e{constructor(){e9(this,"_data",/* @__PURE__ */new Map)}static create(){return new e}add(e,t){this._data.has(e)||this._data.set(e,t)}delete(e){this._data.delete(e)}getData(){return this._data}},"RegistryAsMap"),e4(rq,"requestImmediateMacroTask"),e4(rJ,"sequenceAsync"),e4(rX,"sequence"),e4(rQ,"mergeSets"),e4(rZ,"__values"),e4(r0,"__read"),e4(r1,"__spreadArray"),e4(r2,"isFunction"),e4(r5,"createErrorClass");var r3=r5(function(e){return /* @__PURE__ */e4(function(t){e(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(e,t){return t+1+") "+e.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t},"UnsubscriptionErrorImpl")});function r6(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}e4(r6,"arrRemove");var r4=function(){var e;function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return e4(t,"Subscription"),t.prototype.unsubscribe=function(){var e,t,r,n,o;if(!this.closed){this.closed=!0;var i=this._parentage;if(i){if(this._parentage=null,Array.isArray(i))try{for(var s=rZ(i),a=s.next();!a.done;a=s.next())a.value.remove(this)}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}else i.remove(this)}var l=this.initialTeardown;if(r2(l))try{l()}catch(e){o=e instanceof r3?e.errors:[e]}var u=this._finalizers;if(u){this._finalizers=null;try{for(var c=rZ(u),d=c.next();!d.done;d=c.next()){var h=d.value;try{r8(h)}catch(e){o=null!=o?o:[],e instanceof r3?o=r1(r1([],r0(o)),r0(e.errors)):o.push(e)}}}catch(e){r={error:e}}finally{try{d&&!d.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}}if(o)throw new r3(o)}},t.prototype.add=function(e){var r;if(e&&e!==this){if(this.closed)r8(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(e)}}},t.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},t.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},t.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&r6(t,e)},t.prototype.remove=function(e){var r=this._finalizers;r&&r6(r,e),e instanceof t&&e._removeParent(this)},t.EMPTY=((e=new t).closed=!0,e),t}();function r9(e){return e instanceof r4||e&&"closed"in e&&r2(e.remove)&&r2(e.add)&&r2(e.unsubscribe)}function r8(e){r2(e)?e():e.unsubscribe()}function r7(e){let t=!1;return e?r9(e)?{dispose:/* @__PURE__ */e4(()=>e.unsubscribe(),"dispose")}:"function"==typeof e?{dispose:/* @__PURE__ */e4(()=>{t||(t=!0,e())},"dispose")}:e:r7(()=>{})}r4.EMPTY,e4(r9,"isSubscription"),e4(r8,"execFinalizer"),e4(r7,"toDisposable"),e4(function(e){return r7(()=>{e.unsubscribe()})},"fromObservable");let ne=class{constructor(){e9(this,"_disposables",/* @__PURE__ */new Set)}add(e){let t=r7(e);return this._disposables.add(t),{dispose:/* @__PURE__ */e4(()=>{t.dispose(),this._disposables.delete(t)},"dispose")}}dispose(){this._disposables.forEach(e=>{e.dispose()}),this._disposables.clear()}};e4(ne,"DisposableCollection");let nt=ne,nr=class{constructor(){e9(this,"_disposed",!1),e9(this,"_collection",new nt)}disposeWithMe(e){return this._collection.add(e)}ensureNotDisposed(){if(this._disposed)throw Error("[Disposable]: object is disposed!")}dispose(){this._disposed||(this._disposed=!0,this._collection.dispose())}};e4(nr,"Disposable");let nn=nr,no=class extends nn{constructor(){super(...arguments),e9(this,"dispose$",new e2.Subject)}dispose(){super.dispose(),this.dispose$.next(),this.dispose$.complete()}};e4(no,"RxDisposable");let ni=no;e4(class extends nn{constructor(e){super(),e9(this,"_ref",0),this._rootDisposable=e}inc(){if(this._disposed)throw Error("[RCDisposable]: should not ref to a disposed.");this._ref+=1}dec(){this._ref-=1,0===this._ref&&(this._rootDisposable.dispose(),this.dispose())}},"RCDisposable");let ns=tL("univer.context-service"),na=class extends nn{constructor(){super(...arguments),e9(this,"_contextChanged$",new e2.Subject),e9(this,"contextChanged$",this._contextChanged$.asObservable()),e9(this,"_contextMap",/* @__PURE__ */new Map)}dispose(){super.dispose(),this._contextChanged$.complete()}getContextValue(e){var t;return null!=(t=this._contextMap.get(e))&&t}setContextValue(e,t){this._contextMap.set(e,t),this._contextChanged$.next({[e]:t})}subscribeContextValue$(e){return new eZ.Observable(t=>{let r=this._contextChanged$.pipe((0,eJ.filter)(t=>"u">typeof t[e])).subscribe(r=>t.next(r[e]));return this._contextMap.has(e)&&t.next(this._contextMap.get(e)),()=>r.unsubscribe()})}};e4(na,"ContextService");var nl=((i=nl||{})[i.SILENT=0]="SILENT",i[i.ERROR=1]="ERROR",i[i.WARN=2]="WARN",i[i.INFO=3]="INFO",i[i.VERBOSE=4]="VERBOSE",i);let nu=tL("univer.log"),nc=class extends nn{constructor(){super(...arguments),e9(this,"_logLevel",3)}debug(...e){this._logLevel>=4&&this._log(console.debug,...e)}log(...e){this._logLevel>=3&&this._log(console.log,...e)}warn(...e){this._logLevel>=2&&this._log(console.warn,...e)}error(...e){this._logLevel>=1&&this._log(console.error,...e)}setLogLevel(e){this._logLevel=e}_log(e,...t){let r=t[0];/^\[(.*?)\]/g.test(r)?e(`\x1b[97;104m${r}\x1b[0m`,...t.slice(1)):e(...t)}};e4(nc,"DesktopLogService");var nd=Object.defineProperty,nh=Object.getOwnPropertyDescriptor,np=/* @__PURE__ */e4((e,t,r,n)=>{for(var o,i=n>1?void 0:n?nh(t,r):t,s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&nd(t,r,i),i},"__decorateClass$8"),nf=/* @__PURE__ */e4((e,t)=>(r,n)=>t(r,n,e),"__decorateParam$7"),ng=((s=ng||{})[s.COMMAND=0]="COMMAND",s[s.OPERATION=1]="OPERATION",s[s.MUTATION=2]="MUTATION",s);let nm=tL("anywhere.command-service"),n_=class{constructor(){e9(this,"_commands",/* @__PURE__ */new Map),e9(this,"_commandTypes",/* @__PURE__ */new Map)}registerCommand(e){if(this._commands.has(e.id))throw Error(`[CommandRegistry]: command "${e.id}" has been registered before.`);return this._commands.set(e.id,e),this._commandTypes.set(e.id,e.type),r7(()=>{this._commands.delete(e.id),this._commandTypes.delete(e.id)})}hasCommand(e){return this._commands.has(e)}getCommand(e){return this._commands.has(e)?[this._commands.get(e)]:null}getCommandType(e){return this._commandTypes.get(e)}};e4(n_,"CommandRegistry");let ny={id:"nil",type:0,handler:/* @__PURE__ */e4(()=>!0,"handler")},nE=(e4(sU=class extends nn{constructor(e,t){super(),e9(this,"_commandRegistry"),e9(this,"_beforeCommandExecutionListeners",[]),e9(this,"_commandExecutedListeners",[]),e9(this,"_multiCommandDisposables",/* @__PURE__ */new Map),e9(this,"_commandExecutingLevel",0),e9(this,"_commandExecutionStack",[]),this._injector=e,this._logService=t,this._commandRegistry=new n_,this._registerCommand(ny)}dispose(){super.dispose(),this._commandExecutedListeners.length=0,this._beforeCommandExecutionListeners.length=0}hasCommand(e){return this._commandRegistry.hasCommand(e)}registerCommand(e){return this._registerCommand(e)}registerMultipleCommand(e){return this._registerMultiCommand(e)}beforeCommandExecuted(e){if(-1===this._beforeCommandExecutionListeners.indexOf(e))return this._beforeCommandExecutionListeners.push(e),r7(()=>{let t=this._beforeCommandExecutionListeners.indexOf(e);this._beforeCommandExecutionListeners.splice(t,1)});throw Error("[CommandService]: could not add a listener twice.")}onCommandExecuted(e){if(-1===this._commandExecutedListeners.indexOf(e))return this._commandExecutedListeners.push(e),r7(()=>{let t=this._commandExecutedListeners.indexOf(e);this._commandExecutedListeners.splice(t,1)});throw Error("[CommandService]: could not add a listener twice.")}async executeCommand(e,t,r){try{let n=this._commandRegistry.getCommand(e);if(n){let[e]=n,o={id:e.id,type:e.type,params:t},i=this._pushCommandExecutionStack(o);this._beforeCommandExecutionListeners.forEach(e=>e(o,r));let s=await this._execute(e,t,r);return this._commandExecutedListeners.forEach(e=>e(o,r)),i.dispose(),s}throw Error(`[CommandService]: command "${e}" is not registered.`)}catch(e){if(e instanceof rk)return!1;throw this._logService.error(e),e}}syncExecuteCommand(e,t,r){var n;try{let o=this._commandRegistry.getCommand(e);if(o){let[e]=o,i={id:e.id,type:e.type,params:t};if(2===e.type){let e=tr(this._commandExecutionStack,e=>0===e.type);e&&(i.params=null!=(n=i.params)?n:{},i.params.trigger=e.id)}let s=this._pushCommandExecutionStack(i);this._beforeCommandExecutionListeners.forEach(e=>e(i,r));let a=this._syncExecute(e,t,r);return this._commandExecutedListeners.forEach(e=>e(i,r)),s.dispose(),a}throw Error(`[CommandService]: command "${e}" is not registered.`)}catch(e){throw this._logService.error(e),e}}_pushCommandExecutionStack(e){return this._commandExecutionStack.push(e),r7(()=>tt(this._commandExecutionStack,e))}_registerCommand(e){return this._commandRegistry.registerCommand(e)}_registerMultiCommand(e){let t;let r=this._commandRegistry.getCommand(e.id);if(r){if(!0!==r[0].multi)throw Error("Command has registered as a single command.");t=r[0]}else{let r=new nt;t=new nv(e.id),r.add(this._commandRegistry.registerCommand(t)),r.add(r7(()=>{this._multiCommandDisposables.delete(e.id)})),this._multiCommandDisposables.set(e.id,r)}let n=t.registerImplementation(e);return r7(()=>{var r;n.dispose(),t.hasImplementations()||null==(r=this._multiCommandDisposables.get(e.id))||r.dispose()})}async _execute(e,t,r){let n;this._logService.debug("[CommandService]",`${"|-".repeat(Math.max(this._commandExecutingLevel,0))}executing command "${e.id}"`),this._commandExecutingLevel++;try{n=await this._injector.invoke(e.handler,t,r),this._commandExecutingLevel--}catch(e){throw n=!1,this._commandExecutingLevel=0,e}return n}_syncExecute(e,t,r){let n;this._logService.debug("[CommandService]",`${"|-".repeat(Math.max(0,this._commandExecutingLevel))}executing command "${e.id}".`),this._commandExecutingLevel++;try{if((n=this._injector.invoke(e.handler,t,r))instanceof Promise)throw TypeError("[CommandService]: Command handler should not return a promise.");this._commandExecutingLevel--}catch(e){throw n=!1,this._commandExecutingLevel=0,e}return n}},"CommandService"),sU);nE=np([nf(0,t$(rd)),nf(1,nu)],nE);let nb=class{constructor(e){e9(this,"name"),e9(this,"multi",!0),e9(this,"type",0),e9(this,"priority",0),e9(this,"_implementations",[]),e9(this,"handler",/* @__PURE__ */e4(async(e,t)=>{if(!this._implementations.length)return!1;let r=e.get(nu),n=e.get(ns),o=e.get(rd);for(let e of this._implementations){let i=e.command.preconditions;if((!i||i&&i(n))&&(r.debug("[MultiCommand]",`executing implementation "${e.command.name}".`),await o.invoke(e.command.handler,t)))return!0}return!1},"handler")),this.id=e,this.name=e}registerImplementation(e){let t={command:e};return this._implementations.push(t),this._implementations.sort((e,t)=>t.command.priority-e.command.priority),r7(()=>{let e=this._implementations.indexOf(t);this._implementations.splice(e,1)})}hasImplementations(){return this._implementations.length>0}};e4(nb,"MultiCommand");let nv=nb;function nR(e,t,r){return rX(e.map(e=>()=>t.syncExecuteCommand(e.id,e.params,r)))}function nT(e,t,r){return rJ(e.map(e=>()=>t.executeCommand(e.id,e.params,r)))}function nI(e){return new eZ.Observable(t=>{let r=e((...e)=>t.next(e));return()=>null==r?void 0:r.dispose()})}function nC(e){return /* @__PURE__ */e4(function(t){return new eZ.Observable(r=>(t.subscribe({next:/* @__PURE__ */e4(t=>{r.next(t),e(t)&&r.complete()},"next"),complete:/* @__PURE__ */e4(()=>r.complete(),"complete"),error:/* @__PURE__ */e4(e=>r.error(e),"error")}),()=>r.unsubscribe()))},"complateAfter")}function nS(e,t){let r=0,n=e.length-1;for(;r<=n;){let o=Math.floor((n+r)/2);if(t<e[o]&&(0===o||t>=e[o-1]))return o;if(t>=e[o])r=o+1;else if(t<e[o])n=o-1;else break}return -1}function nO(e,t){let r=0,n=0,o=-1,i=e.length-1;for(;r<e.length&&i>=0&&i>=r;){if(n=e[i],t>=(0===i?0:e[i-1])&&t<=n){o=i;break}if(n=e[r],t>=(0===r?0:e[r-1])&&t<n){o=r;break}r++,i--}return o}function nx(e,t){let r=e.length-1;return t<0?-1:t<e[0]?0:t>e[e.length-1]?Number.POSITIVE_INFINITY:r=e.length<40||t<=e[20]||t>=e[r-20]?nO(e,t):nS(e,t)}e4(nR,"sequenceExecute"),e4(nT,"sequenceExecuteAsync"),e4(nI,"fromCallback"),e4(nC,"takeAfter"),e4(nS,"binarySearchArray"),e4(nO,"orderSearchArray"),e4(nx,"searchArray"),e4(function(e){let t=new Blob([e],{type:"text/javascript"});return window.URL.createObjectURL(t)},"codeToBlob");let nA=2;function nw(e,t){if(null==t||null==e)return!0;let{left:r=0,top:n=0,height:o=0,width:i=0,angle:s=0}=t,{left:a=0,top:l=0,height:u=0,width:c=0,angle:d=0}=e;return Math.abs(a-r)>nA||Math.abs(l-n)>nA||Math.abs(c-i)>nA||Math.abs(u-o)>nA||Math.abs(d-s)>1}e4(nw,"checkIfMove");var nN=((a=nN||{})[a.DEFAULT_SERIES=0]="DEFAULT_SERIES",a[a.ALTERNATE_SERIES=1]="ALTERNATE_SERIES",a),nD=((l=nD||{})[l.NONE=0]="NONE",l[l.THIN=1]="THIN",l[l.HAIR=2]="HAIR",l[l.DOTTED=3]="DOTTED",l[l.DASHED=4]="DASHED",l[l.DASH_DOT=5]="DASH_DOT",l[l.DASH_DOT_DOT=6]="DASH_DOT_DOT",l[l.DOUBLE=7]="DOUBLE",l[l.MEDIUM=8]="MEDIUM",l[l.MEDIUM_DASHED=9]="MEDIUM_DASHED",l[l.MEDIUM_DASH_DOT=10]="MEDIUM_DASH_DOT",l[l.MEDIUM_DASH_DOT_DOT=11]="MEDIUM_DASH_DOT_DOT",l[l.SLANT_DASH_DOT=12]="SLANT_DASH_DOT",l[l.THICK=13]="THICK",l),nL=((u=nL||{}).TOP="top",u.BOTTOM="bottom",u.LEFT="left",u.RIGHT="right",u.NONE="none",u.ALL="all",u.OUTSIDE="outside",u.INSIDE="inside",u.HORIZONTAL="horizontal",u.VERTICAL="vertical",u.TLBR="tlbr",u.TLBC_TLMR="tlbc_tlmr",u.TLBR_TLBC_TLMR="tlbr_tlbc_tlmr",u.BLTR="bl_tr",u.MLTR_BCTR="mltr_bctr",u),nM=((c=nM||{})[c.UNSUPPORTED=0]="UNSUPPORTED",c[c.RGB=1]="RGB",c[c.HEX=2]="HEX",c[c.THEME=3]="THEME",c),nU=((d=nU||{})[d.ON=0]="ON",d[d.OFF=1]="OFF",d),nP=((h=nP||{})[h.PASTE_NORMAL=0]="PASTE_NORMAL",h[h.PASTE_NO_BORDERS=1]="PASTE_NO_BORDERS",h[h.PASTE_FORMAT=2]="PASTE_FORMAT",h[h.PASTE_FORMULA=3]="PASTE_FORMULA",h[h.PASTE_DATA_VALIDATION=4]="PASTE_DATA_VALIDATION",h[h.PASTE_VALUES=5]="PASTE_VALUES",h[h.PASTE_CONDITIONAL_FORMATTING=6]="PASTE_CONDITIONAL_FORMATTING",h[h.PASTE_COLUMN_WIDTHS=7]="PASTE_COLUMN_WIDTHS",h),nk=((p=nk||{})[p.DOCUMENT=0]="DOCUMENT",p[p.PROJECT=1]="PROJECT",p),nF=((f=nF||{})[f.COLUMNS=0]="COLUMNS",f[f.ROWS=1]="ROWS",f),nj=((g=nj||{})[g.UP=0]="UP",g[g.RIGHT=1]="RIGHT",g[g.DOWN=2]="DOWN",g[g.LEFT=3]="LEFT",g);function nB(e){switch(e){case 3:return 1;case 1:return 3;case 0:return 2;case 2:return 0}}e4(nB,"getReverseDirection");var nH=((m=nH||{})[m.NUMBER_FORMAT_TYPE_UNSPECIFIED=0]="NUMBER_FORMAT_TYPE_UNSPECIFIED",m[m.TEXT=1]="TEXT",m[m.NUMBER=2]="NUMBER",m[m.PERCENT=3]="PERCENT",m[m.CURRENCY=4]="CURRENCY",m[m.DATE=5]="DATE",m[m.TIME=6]="TIME",m[m.DATE_TIME=7]="DATE_TIME",m[m.SCIENTIFIC=8]="SCIENTIFIC",m),n$=((_=n$||{})[_.INTERPOLATION_POINT_TYPE_UNSPECIFIED=0]="INTERPOLATION_POINT_TYPE_UNSPECIFIED",_[_.MIN=1]="MIN",_[_.MAX=2]="MAX",_[_.NUMBER=3]="NUMBER",_[_.PERCENT=4]="PERCENT",_[_.PERCENTILE=5]="PERCENTILE",_),nG=((y=nG||{}).EN_US="enUS",y.ZH_CN="zhCN",y.RU_RU="ruRU",y.ZH_TW="zhTW",y.VI_VN="viVN",y),nW=((E=nW||{})[E.RANGE=0]="RANGE",E[E.SHEET=1]="SHEET",E),nV=((b=nV||{})[b.RELATIVE_DATE_UNSPECIFIED=0]="RELATIVE_DATE_UNSPECIFIED",b[b.PAST_YEAR=1]="PAST_YEAR",b[b.PAST_MONTH=2]="PAST_MONTH",b[b.PAST_WEEK=3]="PAST_WEEK",b[b.YESTERDAY=4]="YESTERDAY",b[b.TODAY=5]="TODAY",b[b.TOMORROW=6]="TOMORROW",b),nz=((v=nz||{})[v.GRID=0]="GRID",v[v.KANBAN=1]="KANBAN",v[v.GANTT=2]="GANTT",v),nK=((R=nK||{})[R.UNSPECIFIED=0]="UNSPECIFIED",R[R.LEFT_TO_RIGHT=1]="LEFT_TO_RIGHT",R[R.RIGHT_TO_LEFT=2]="RIGHT_TO_LEFT",R),nY=((T=nY||{})[T.DASH=0]="DASH",T[T.DASH_DOT_DOT_HEAVY=1]="DASH_DOT_DOT_HEAVY",T[T.DASH_DOT_HEAVY=2]="DASH_DOT_HEAVY",T[T.DASHED_HEAVY=3]="DASHED_HEAVY",T[T.DASH_LONG=4]="DASH_LONG",T[T.DASH_LONG_HEAVY=5]="DASH_LONG_HEAVY",T[T.DOT_DASH=6]="DOT_DASH",T[T.DOT_DOT_DASH=7]="DOT_DOT_DASH",T[T.DOTTED=8]="DOTTED",T[T.DOTTED_HEAVY=9]="DOTTED_HEAVY",T[T.DOUBLE=10]="DOUBLE",T[T.NONE=11]="NONE",T[T.SINGLE=12]="SINGLE",T[T.THICK=13]="THICK",T[T.WAVE=14]="WAVE",T[T.WAVY_DOUBLE=15]="WAVY_DOUBLE",T[T.WAVY_HEAVY=16]="WAVY_HEAVY",T[T.WORDS=17]="WORDS",T),nq=((I=nq||{})[I.UNSPECIFIED=0]="UNSPECIFIED",I[I.LEFT=1]="LEFT",I[I.CENTER=2]="CENTER",I[I.RIGHT=3]="RIGHT",I[I.JUSTIFIED=4]="JUSTIFIED",I[I.BOTH=5]="BOTH",I[I.DISTRIBUTED=6]="DISTRIBUTED",I),nJ=((C=nJ||{})[C.UNSPECIFIED=0]="UNSPECIFIED",C[C.TOP=1]="TOP",C[C.MIDDLE=2]="MIDDLE",C[C.BOTTOM=3]="BOTTOM",C),nX=((S=nX||{})[S.UNSPECIFIED=0]="UNSPECIFIED",S[S.OVERFLOW=1]="OVERFLOW",S[S.CLIP=2]="CLIP",S[S.WRAP=3]="WRAP",S),nQ=((O=nQ||{})[O.NORMAL=0]="NORMAL",O[O.ITALIC=1]="ITALIC",O),nZ=((x=nZ||{})[x.NORMAL=0]="NORMAL",x[x.BOLD=1]="BOLD",x),n0=((A=n0||{})[A.NORMAL=1]="NORMAL",A[A.SUBSCRIPT=2]="SUBSCRIPT",A[A.SUPERSCRIPT=3]="SUPERSCRIPT",A),n1=((w=n1||{})[w.FALSE=0]="FALSE",w[w.TRUE=1]="TRUE",w),n2=((N=n2||{})[N.STRING=1]="STRING",N[N.NUMBER=2]="NUMBER",N[N.BOOLEAN=3]="BOOLEAN",N[N.FORCE_STRING=4]="FORCE_STRING",N),n5=((D=n5||{})[D.DARK1=0]="DARK1",D[D.LIGHT1=1]="LIGHT1",D[D.DARK2=2]="DARK2",D[D.LIGHT2=3]="LIGHT2",D[D.ACCENT1=4]="ACCENT1",D[D.ACCENT2=5]="ACCENT2",D[D.ACCENT3=6]="ACCENT3",D[D.ACCENT4=7]="ACCENT4",D[D.ACCENT5=8]="ACCENT5",D[D.ACCENT6=9]="ACCENT6",D[D.HYPERLINK=10]="HYPERLINK",D[D.FOLLOWED_HYPERLINK=11]="FOLLOWED_HYPERLINK",D),n3=((L=n3||{}).OFFICE="Office",L.OFFICE_2007_2010="Office 2007-2010",L.GRAYSCALE="Grayscale",L.BLUE_WARM="Blue Warm",L.BLUE="Blue",L.BLUE_II="Blue II",L.BLUE_GREEN="Blue Green",L.GREEN="Green",L.GREEN_YELLOW="Green Yellow",L.YELLOW="Yellow",L.YELLOW_ORANGE="Yellow Orange",L.ORANGE="Orange",L.ORANGE_RED="Orange Red",L.RED_ORANGE="Red Orange",L.RED="Red",L.RED_VIOLET="Red Violet",L.VIOLET="Violet",L.VIOLET_II="Violet II",L.MEDIAN="Median",L.PAPER="Paper",L.MARQUEE="Marquee",L.SLIPSTREAM="Slipstream",L.Aspect="Aspect",L),n6=((M=n6||{}).Line="line",M.LineInv="lineInv",M.Triangle="triangle",M.RtTriangle="rtTriangle",M.Rect="rect",M.Diamond="diamond",M.Parallelogram="parallelogram",M.Trapezoid="trapezoid",M.NonIsocelesTrapezoid="nonIsocelesTrapezoid",M.Pentagon="pentagon",M.Hexagon="hexagon",M.Heptagon="heptagon",M.Octagon="octagon",M.Decagon="decagon",M.Dodecagon="dodecagon",M.Star4="star4",M.Star5="star5",M.Star6="star6",M.Star7="star7",M.Star8="star8",M.Star10="star10",M.Star12="star12",M.Star16="star16",M.Star24="star24",M.Star32="star32",M.RoundRect="roundRect",M.Round1Rect="round1Rect",M.Round2SameRect="round2SameRect",M.Round2DiagRect="round2DiagRect",M.Ellipse="ellipse",M),n4=((U=n4||{}).RightArrow="rightArrow",U.LeftArrow="leftArrow",U.UpArrow="upArrow",U.DownArrow="downArrow",U.LeftRightArrow="leftRightArrow",U.UpDownArrow="upDownArrow",U.QuadArrow="quadArrow",U.LeftRightUpArrow="leftRightUpArrow",U.BentArrow="bentArrow",U.UturnArrow="uturnArrow",U.CircularArrow="circularArrow",U.NotchedRightArrow="notchedRightArrow",U.HomePlate="homePlate",U.Chevron="chevron",U.LeftCircularArrow="leftCircularArrow",U.LeftRightCircularArrow="leftRightCircularArrow",U),n9=((P=n9||{}).Plaque="plaque",P.Can="can",P.Cube="cube",P.Bevel="bevel",P.Donut="donut",P.NoSmoking="noSmoking",P.BlockArc="blockArc",P.FoldedCorner="foldedCorner",P),n8=((k=n8||{}).SmileyFace="smileyFace",k.Heart="heart",k.LightningBolt="lightningBolt",k.Sun="sun",k.Moon="moon",k.Cloud="cloud",k.Arc="arc",k.Backpack="backpack",k.Frame="frame",k.HalfFrame="halfFrame",k.Corner="corner",k.Chord="chord",k.Pie="pie",k.Teardrop="teardrop",k.WedgeRectCallout="wedgeRectCallout",k.WedgeRRectCallout="wedgeRRectCallout",k.WedgeEllipseCallout="wedgeEllipseCallout",k.CloudCallout="cloudCallout",k.BorderCallout1="borderCallout1",k.BorderCallout2="borderCallout2",k.BorderCallout3="borderCallout3",k.AccentCallout1="accentCallout1",k.AccentCallout2="accentCallout2",k.AccentCallout3="accentCallout3",k.Callout1="callout1",k.Callout2="callout2",k.Callout3="callout3",k.ActionButtonBackPrevious="actionButtonBackPrevious",k.ActionButtonEnd="actionButtonEnd",k.ActionButtonForwardNext="actionButtonForwardNext",k.ActionButtonHelp="actionButtonHelp",k.ActionButtonHome="actionButtonHome",k.ActionButtonInformation="actionButtonInformation",k.ActionButtonMovie="actionButtonMovie",k.ActionButtonReturn="actionButtonReturn",k.ActionButtonSound="actionButtonSound",k),n7=((F=n7||{})[F.LEFT=0]="LEFT",F[F.RIGHT=1]="RIGHT",F);let oe=/* @__PURE__ */e4(e=>crypto.getRandomValues(new Uint8Array(e)),"random"),ot=/* @__PURE__ */e4((e,t,r)=>{let n=(2<<Math.log(e.length-1)/Math.LN2)-1,o=-~(1.6*n*t/e.length);return (i=t)=>{let s="";for(;;){let t=r(o),a=o;for(;a--;)if((s+=e[t[a]&n]||"").length===i)return s}}},"customRandom"),or=/* @__PURE__ */e4((e,t=21)=>ot(e,t,oe),"customAlphabet"),on=/* @__PURE__ */e4((e=21)=>{let t="",r=crypto.getRandomValues(new Uint8Array(e));for(;e--;)t+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[63&r[e]];return t},"nanoid");var oo="u">typeof globalThis?globalThis:"u">typeof window?window:"u">typeof e?e:"u">typeof self?self:{};function oi(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}e4(oi,"getDefaultExportFromCjs");var os={exports:{}};os.exports,function(e,t){var r,n="__lodash_hash_undefined__",o="[object Arguments]",i="[object Function]",s="[object Object]",a=/^\[object .+?Constructor\]$/,l=/^(?:0|[1-9]\d*)$/,u={};u["[object Float32Array]"]=u["[object Float64Array]"]=u["[object Int8Array]"]=u["[object Int16Array]"]=u["[object Int32Array]"]=u["[object Uint8Array]"]=u["[object Uint8ClampedArray]"]=u["[object Uint16Array]"]=u["[object Uint32Array]"]=!0,u[o]=u["[object Array]"]=u["[object ArrayBuffer]"]=u["[object Boolean]"]=u["[object DataView]"]=u["[object Date]"]=u["[object Error]"]=u[i]=u["[object Map]"]=u["[object Number]"]=u[s]=u["[object RegExp]"]=u["[object Set]"]=u["[object String]"]=u["[object WeakMap]"]=!1;var c="object"==typeof oo&&oo&&oo.Object===Object&&oo,d="object"==typeof self&&self&&self.Object===Object&&self,h=c||d||Function("return this")(),p=t&&!t.nodeType&&t,f=p&&e&&!e.nodeType&&e,g=f&&f.exports===p,m=g&&c.process,_=function(){try{return f&&f.require&&f.require("util").types||m&&m.binding&&m.binding("util")}catch{}}(),y=_&&_.isTypedArray;function E(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function b(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}function v(e){return function(t){return e(t)}}function R(e,t){return null==e?void 0:e[t]}function T(e,t){return function(r){return e(t(r))}}e4(E,"apply"),e4(b,"baseTimes"),e4(v,"baseUnary"),e4(R,"getValue"),e4(T,"overArg");var I=Array.prototype,C=Function.prototype,S=Object.prototype,O=h["__core-js_shared__"],x=C.toString,A=S.hasOwnProperty,w=(r=/[^.]+$/.exec(O&&O.keys&&O.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"",N=S.toString,D=x.call(Object),L=RegExp("^"+x.call(A).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),M=g?h.Buffer:void 0,U=h.Symbol,P=h.Uint8Array;M&&M.allocUnsafe;var k=T(Object.getPrototypeOf,Object),F=Object.create,j=S.propertyIsEnumerable,B=I.splice,H=U?U.toStringTag:void 0,$=function(){try{var e=e$(Object,"defineProperty");return e({},"",{}),e}catch{}}(),G=M?M.isBuffer:void 0,W=Math.max,V=Date.now,z=e$(h,"Map"),K=e$(Object,"create"),Y=function(){function e(){}return e4(e,"object"),function(t){if(!tr(t))return{};if(F)return F(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();function q(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function J(){this.__data__=K?K(null):{},this.size=0}function X(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Q(e){var t=this.__data__;if(K){var r=t[e];return r===n?void 0:r}return A.call(t,e)?t[e]:void 0}function Z(e){var t=this.__data__;return K?void 0!==t[e]:A.call(t,e)}function ee(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=K&&void 0===t?n:t,this}function et(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function er(){this.__data__=[],this.size=0}function en(e){var t=this.__data__,r=eR(t,e);return!(r<0)&&(r==t.length-1?t.pop():B.call(t,r,1),--this.size,!0)}function eo(e){var t=this.__data__,r=eR(t,e);return r<0?void 0:t[r][1]}function ei(e){return eR(this.__data__,e)>-1}function es(e,t){var r=this.__data__,n=eR(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}function ea(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function el(){this.size=0,this.__data__={hash:new q,map:new(z||et),string:new q}}function eu(e){var t=eH(this,e).delete(e);return this.size-=t?1:0,t}function ec(e){return eH(this,e).get(e)}function ed(e){return eH(this,e).has(e)}function eh(e,t){var r=eH(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}function ep(e){var t=this.__data__=new et(e);this.size=t.size}function ef(){this.__data__=new et,this.size=0}function eg(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}function em(e){return this.__data__.get(e)}function e_(e){return this.__data__.has(e)}function ey(e,t){var r=this.__data__;if(r instanceof et){var n=r.__data__;if(!z||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new ea(n)}return r.set(e,t),this.size=r.size,this}function eE(e,t){var r=e6(e),n=!r&&e3(e),o=!r&&!n&&e7(e),i=!r&&!n&&!o&&ti(e),s=r||n||o||i,a=s?b(e.length,String):[],l=a.length;for(var u in e)s&&("length"==u||o&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||eV(u,l))||a.push(u);return a}function eb(e,t,r){(void 0===r||e5(e[t],r))&&(void 0!==r||t in e)||eT(e,t,r)}function ev(e,t,r){var n=e[t];A.call(e,t)&&e5(n,r)&&(void 0!==r||t in e)||eT(e,t,r)}function eR(e,t){for(var r=e.length;r--;)if(e5(e[r][0],t))return r;return -1}function eT(e,t,r){"__proto__"==t&&$?$(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}e4(q,"Hash"),e4(J,"hashClear"),e4(X,"hashDelete"),e4(Q,"hashGet"),e4(Z,"hashHas"),e4(ee,"hashSet"),q.prototype.clear=J,q.prototype.delete=X,q.prototype.get=Q,q.prototype.has=Z,q.prototype.set=ee,e4(et,"ListCache"),e4(er,"listCacheClear"),e4(en,"listCacheDelete"),e4(eo,"listCacheGet"),e4(ei,"listCacheHas"),e4(es,"listCacheSet"),et.prototype.clear=er,et.prototype.delete=en,et.prototype.get=eo,et.prototype.has=ei,et.prototype.set=es,e4(ea,"MapCache"),e4(el,"mapCacheClear"),e4(eu,"mapCacheDelete"),e4(ec,"mapCacheGet"),e4(ed,"mapCacheHas"),e4(eh,"mapCacheSet"),ea.prototype.clear=el,ea.prototype.delete=eu,ea.prototype.get=ec,ea.prototype.has=ed,ea.prototype.set=eh,e4(ep,"Stack"),e4(ef,"stackClear"),e4(eg,"stackDelete"),e4(em,"stackGet"),e4(e_,"stackHas"),e4(ey,"stackSet"),ep.prototype.clear=ef,ep.prototype.delete=eg,ep.prototype.get=em,ep.prototype.has=e_,ep.prototype.set=ey,e4(eE,"arrayLikeKeys"),e4(eb,"assignMergeValue"),e4(ev,"assignValue"),e4(eR,"assocIndexOf"),e4(eT,"baseAssignValue");var eI=eB();function eC(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":H&&H in Object(e)?eG(e):eX(e)}function eS(e){return tn(e)&&eC(e)==o}function eO(e){return!(!tr(e)||eY(e))&&(te(e)?L:a).test(e2(e))}function ex(e){return tn(e)&&tt(e.length)&&!!u[eC(e)]}function eA(e){if(!tr(e))return eJ(e);var t=eq(e),r=[];for(var n in e)"constructor"==n&&(t||!A.call(e,n))||r.push(n);return r}function ew(e,t,r,n,o){e!==t&&eI(t,function(i,s){if(o||(o=new ep),tr(i))eN(e,t,s,r,ew,n,o);else{var a=n?n(eZ(e,s),i,s+"",e,t,o):void 0;void 0===a&&(a=i),eb(e,s,a)}},ta)}function eN(e,t,r,n,o,i,s){var a=eZ(e,r),l=eZ(t,r),u=s.get(l);if(u){eb(e,r,u);return}var c=i?i(a,l,r+"",e,t,s):void 0,d=void 0===c;if(d){var h=e6(l),p=!h&&e7(l),f=!h&&!p&&ti(l);c=l,h||p||f?e6(a)?c=a:e8(a)?c=ek(a):p?(d=!1,c=eM(l)):f?(d=!1,c=eP(l)):c=[]:to(l)||e3(l)?(c=a,e3(a)?c=ts(a):(!tr(a)||te(a))&&(c=eW(l))):d=!1}d&&(s.set(l,c),o(c,l,n,i,s),s.delete(l)),eb(e,r,c)}function eD(e,t){return e0(eQ(e,t,tc),e+"")}e4(eC,"baseGetTag"),e4(eS,"baseIsArguments"),e4(eO,"baseIsNative"),e4(ex,"baseIsTypedArray"),e4(eA,"baseKeysIn"),e4(ew,"baseMerge"),e4(eN,"baseMergeDeep"),e4(eD,"baseRest");var eL=$?function(e,t){return $(e,"toString",{configurable:!0,enumerable:!1,value:tu(t),writable:!0})}:tc;function eM(e,t){return e.slice()}function eU(e){var t=new e.constructor(e.byteLength);return new P(t).set(new P(e)),t}function eP(e,t){var r=eU(e.buffer);return new e.constructor(r,e.byteOffset,e.length)}function ek(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}function eF(e,t,r,n){var o=!r;r||(r={});for(var i=-1,s=t.length;++i<s;){var a=t[i],l=void 0;void 0===l&&(l=e[a]),o?eT(r,a,l):ev(r,a,l)}return r}function ej(e){return eD(function(t,r){var n=-1,o=r.length,i=o>1?r[o-1]:void 0,s=o>2?r[2]:void 0;for(i=e.length>3&&"function"==typeof i?(o--,i):void 0,s&&ez(r[0],r[1],s)&&(i=o<3?void 0:i,o=1),t=Object(t);++n<o;){var a=r[n];a&&e(t,a,n,i)}return t})}function eB(e){return function(e,t,r){for(var n=-1,o=Object(e),i=r(e),s=i.length;s--;){var a=i[++n];if(!1===t(o[a],a,o))break}return e}}function eH(e,t){var r=e.__data__;return eK(t)?r["string"==typeof t?"string":"hash"]:r.map}function e$(e,t){var r=R(e,t);return eO(r)?r:void 0}function eG(e){var t=A.call(e,H),r=e[H];try{e[H]=void 0;var n=!0}catch{}var o=N.call(e);return n&&(t?e[H]=r:delete e[H]),o}function eW(e){return"function"!=typeof e.constructor||eq(e)?{}:Y(k(e))}function eV(e,t){var r=typeof e;return!!(t=null==t?0x1fffffffffffff:t)&&("number"==r||"symbol"!=r&&l.test(e))&&e>-1&&e%1==0&&e<t}function ez(e,t,r){if(!tr(r))return!1;var n=typeof t;return("number"==n?!!(e9(r)&&eV(t,r.length)):"string"==n&&t in r)&&e5(r[t],e)}function eK(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function eY(e){return!!w&&w in e}function eq(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||S)}function eJ(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}function eX(e){return N.call(e)}function eQ(e,t,r){return t=W(void 0===t?e.length-1:t,0),function(){for(var n=arguments,o=-1,i=W(n.length-t,0),s=Array(i);++o<i;)s[o]=n[t+o];o=-1;for(var a=Array(t+1);++o<t;)a[o]=n[o];return a[t]=r(s),E(e,this,a)}}function eZ(e,t){if(!("constructor"===t&&"function"==typeof e[t])&&"__proto__"!=t)return e[t]}e4(eM,"cloneBuffer"),e4(eU,"cloneArrayBuffer"),e4(eP,"cloneTypedArray"),e4(ek,"copyArray"),e4(eF,"copyObject"),e4(ej,"createAssigner"),e4(eB,"createBaseFor"),e4(eH,"getMapData"),e4(e$,"getNative"),e4(eG,"getRawTag"),e4(eW,"initCloneObject"),e4(eV,"isIndex"),e4(ez,"isIterateeCall"),e4(eK,"isKeyable"),e4(eY,"isMasked"),e4(eq,"isPrototype"),e4(eJ,"nativeKeysIn"),e4(eX,"objectToString"),e4(eQ,"overRest"),e4(eZ,"safeGet");var e0=e1(eL);function e1(e){var t=0,r=0;return function(){var n=V(),o=16-(n-r);if(r=n,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function e2(e){if(null!=e){try{return x.call(e)}catch{}try{return e+""}catch{}}return""}function e5(e,t){return e===t||e!=e&&t!=t}e4(e1,"shortOut"),e4(e2,"toSource"),e4(e5,"eq");var e3=eS(/* @__PURE__ */function(){return arguments}())?eS:function(e){return tn(e)&&A.call(e,"callee")&&!j.call(e,"callee")},e6=Array.isArray;function e9(e){return null!=e&&tt(e.length)&&!te(e)}function e8(e){return tn(e)&&e9(e)}e4(e9,"isArrayLike"),e4(e8,"isArrayLikeObject");var e7=G||td;function te(e){if(!tr(e))return!1;var t=eC(e);return t==i||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function tt(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=0x1fffffffffffff}function tr(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function tn(e){return null!=e&&"object"==typeof e}function to(e){if(!tn(e)||eC(e)!=s)return!1;var t=k(e);if(null===t)return!0;var r=A.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&x.call(r)==D}e4(te,"isFunction"),e4(tt,"isLength"),e4(tr,"isObject"),e4(tn,"isObjectLike"),e4(to,"isPlainObject");var ti=y?v(y):ex;function ts(e){return eF(e,ta(e))}function ta(e){return e9(e)?eE(e):eA(e)}e4(ts,"toPlainObject"),e4(ta,"keysIn");var tl=ej(function(e,t,r,n){ew(e,t,r,n)});function tu(e){return function(){return e}}function tc(e){return e}function td(){return!1}e4(tu,"constant"),e4(tc,"identity"),e4(td,"stubFalse"),e.exports=tl}(os,os.exports);let oa=/* @__PURE__ */oi(os.exports),ol=/* @__PURE__ */new Set(["ac","ad","ae","aero","af","ag","ai","al","am","ao","aq","ar","arpa","as","asia","at","au","aw","ax","az","ba","bb","bd","be","bf","bg","bh","bi","biz","bj","bm","bn","bo","br","bs","bt","bv","bw","by","bz","ca","cat","cc","cd","cf","cg","ch","ci","ck","cl","cm","cn","co","com","coop","cr","cu","cv","cw","cx","cy","cz","de","dj","dk","dm","do","dz","ec","edu","ee","eg","er","es","et","eu","fi","fj","fk","fm","fo","fr","ga","gb","gd","ge","gf","gg","gh","gi","gl","gm","gn","gov","gp","gq","gr","gs","gt","gu","gw","gy","hk","hm","hn","hr","ht","hu","id","ie","il","im","in","info","int","io","iq","ir","is","it","je","jm","jo","jobs","jp","ke","kg","kh","ki","km","kn","kp","kr","kw","ky","kz","la","lb","lc","li","lk","lr","ls","lt","lu","lv","ly","ma","mc","md","me","mg","mh","mil","mk","ml","mm","mn","mo","mobi","mp","mq","mr","ms","mt","mu","museum","mv","mw","mx","my","mz","na","name","nc","ne","net","nf","ng","ni","nl","no","np","nr","nu","nz","om","onion","org","pa","pe","pf","pg","ph","pk","pl","pm","pn","post","pr","pro","ps","pt","pw","py","qa","re","ro","rs","ru","rw","sa","sb","sc","sd","se","sg","sh","si","sj","sk","sl","sm","sn","so","sr","ss","st","su","sv","sx","sy","sz","tc","td","tel","tf","tg","th","tj","tk","tl","tm","tn","to","tr","tt","tv","tw","tz","ua","ug","uk","us","uy","uz","va","vc","ve","vg","vi","vn","vu","wf","ws","yt","za","zm","zw"]),ou=RegExp("^(?:(?:(?:https?|ftp):)?\\/\\/)?(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z0-9\\u00a1-\\uffff][a-z0-9\\u00a1-\\uffff_-]{0,62})?[a-z0-9\\u00a1-\\uffff]\\.)+(?:[a-z\\u00a1-\\uffff]{2,}\\.?))(?::\\d{2,5})?(?:[/?#]\\S*)?$","i");function oc(e){if(!Number.isNaN(+e))return!1;if(e.startsWith("http://localhost:3002")||e.startsWith("localhost:3002"))return!0;if(ou.test(e)){if(od(e))return!0;try{let t=new URL(op(e)).hostname.split(".").pop();if(t&&ol.has(t))return!0}catch{}}return!1}function od(e){return/^[a-zA-Z]+:\/\//.test(e)}function oh(e){return/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(e)}function op(e){return od(e)?e:oh(e)?`mailto://${e}`:`https://${e}`}e4(oc,"isLegalUrl"),e4(od,"hasProtocol"),e4(oh,"isEmail"),e4(op,"normalizeUrl");let of=/^-ms-/,og=/-([a-z])/g,om=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],o_=class e{static stringAt(e){let t="",r=e;for(;r>=om.length;)r/=om.length,r-=1,t+=om[r%om.length];let n=e%om.length;return t+om[n]}static indexAt(e){let t=0;for(let r=0;r<e.length-1;r+=1){let n=e.charCodeAt(r)-65,o=e.length-1-r;t+=om.length**o+om.length*n}return t+(e.charCodeAt(e.length-1)-65)}static deleteBlank(t){return e.isString(t)?t.replace(/\s/g,""):t}static getSystemType(){let e=navigator.userAgent,t="Win32"===navigator.platform||"Windows"===navigator.platform,r="Mac68K"===navigator.platform||"MacPPC"===navigator.platform||"Macintosh"===navigator.platform||"MacIntel"===navigator.platform;if(r)return"Mac";if("X11"===navigator.platform&&!t&&!r)return"Unix";if(String(navigator.platform).indexOf("Linux")>-1)return"Linux";if(t){if(e.indexOf("Windows NT 5.0")>-1||e.indexOf("Windows 2000")>-1)return"Windows 2000";if(e.indexOf("Windows NT 5.1")>-1||e.indexOf("Windows XP")>-1)return"Windows XP";if(e.indexOf("Windows NT 5.2")>-1||e.indexOf("Windows 2003")>-1)return"Windows 2003";if(e.indexOf("Windows NT 6.0")>-1||e.indexOf("Windows Vista")>-1)return"Windows Vista";if(e.indexOf("Windows NT 6.1")>-1||e.indexOf("Windows 7")>-1)return"Windows 7";if(e.indexOf("Windows NT 10")>-1||e.indexOf("Windows 10")>-1)return"Windows 10";if(e.indexOf("Windows NT 11")>-1||e.indexOf("Windows 11")>-1)return"Windows 11"}return"Unknown system"}static getBrowserType(){let e=navigator.userAgent,t=e.indexOf("Opera")>-1,r=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!t,n=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1,o=e.indexOf("Edge")>-1,i=e.indexOf("Firefox")>-1,s=e.indexOf("Safari")>-1&&-1===e.indexOf("Chrome"),a=e.indexOf("Chrome")>-1&&e.indexOf("Safari")>-1;if(r){RegExp("MSIE (\\d+\\.\\d+);").test(e);let t=Number.parseFloat(RegExp.$1);return 7===t?"IE7":8===t?"IE8":9===t?"IE9":10===t?"IE10":"0"}return i?"FF":t?"Opera":s?"Safari":a?"Chrome":o?"Edge":n?"IE11":"Unknown browser"}static generateRandomId(e=21,t){return oE(e,t)}static getClassName(e){return e.constructor.name}static deepMerge(t,...r){function n(t,r){t.forEach((t,i)=>{var s,a;if(e.isArray(t)){let e=null!=(s=r[i])?s:[];r[i]=e,n(t,e);return}if(e.isObject(t)){let e=null!=(a=r[i])?a:{};r[i]=e,o(t,e);return}r[i]=t})}function o(t,r){Object.keys(t).forEach(i=>{var s,a;let l=t[i];if(e.isObject(l)){let e=null!=(s=r[i])?s:{};r[i]=e,o(l,e);return}if(e.isArray(l)){let e=null!=(a=r[i])?a:[];r[i]=e,n(l,e);return}r[i]=l})}function i(r){Object.keys(r).forEach(i=>{var s,a;let l=r[i];if(e.isArray(l)){let e=null!=(s=t[i])?s:[];t[i]=e,n(l,e);return}if(e.isObject(l)){let e=null!=(a=t[i])?a:{};t[i]=e,o(l,e);return}t[i]=l})}return r.forEach(e=>e&&i(e)),e4(n,"deepArray"),e4(o,"deepObject"),e4(i,"deepItem"),t}static numberFixed(e,t){return Number(Number(e).toFixed(t))}static diffValue(t,r){function n(t,r){return e.getValueType(t)===e.getValueType(r)&&(e.isArray(t)?o(t,r):e.isObject(t)?i(t,r):e.isDate(t)?t.getTime()===r.getTime():e.isRegExp(t)?t.toString()===r.toString():t===r)}function o(e,o){if(t.length!==r.length)return!1;for(let t=0,r=e.length;t<r;t++)if(!n(e[t],o[t]))return!1;return!0}function i(e,t){let r=Object.keys(e),o=Object.keys(t);if(r.length!==o.length)return!1;for(let i of r)if(!o.includes(i)||!n(e[i],t[i]))return!1;return!0}return e4(n,"diffValue"),e4(o,"diffArrays"),e4(i,"diffObject"),n(t,r)}static deepClone(t){if(!this.isDefine(t))return t;if(this.isRegExp(t))return new RegExp(t);if(this.isDate(t))return new Date(t);if(this.isArray(t)){let r=[];return t.forEach((t,n)=>{r[n]=e.deepClone(t)}),r}if(this.isObject(t)){let r={};return Object.keys(t).forEach(n=>{let o=t[n];r[n]=e.deepClone(o)}),Object.setPrototypeOf(r,Object.getPrototypeOf(t)),r}return t}static getLanguage(){return globalThis.navigator&&(navigator.languages&&navigator.languages[0]||navigator.language)||"en-US"}static getValueType(e){return Object.prototype.toString.apply(e)}static isDefine(e){return null!=e}static isBlank(e){return!this.isDefine(e)||!!this.isString(e)&&""===e.trim()}static isBoolean(e){return"[object Boolean]"===this.getValueType(e)}static isPlainObject(e){return!!this.isDefine(e)&&Object.getPrototypeOf(e)===Object.getPrototypeOf({})}static isFunction(e){return"[object Function]"===this.getValueType(e)}static isDate(e){return"[object Date]"===this.getValueType(e)}static isRegExp(e){return"[object RegExp]"===this.getValueType(e)}static isArray(e){return"[object Array]"===this.getValueType(e)}static isString(e){return"[object String]"===this.getValueType(e)}static isNumber(e){return"[object Number]"===this.getValueType(e)}static isStringNumber(e){return!isNaN(Number.parseFloat(e))&&isFinite(e)}static isObject(e){return"[object Object]"===this.getValueType(e)}static isEmptyObject(e){for(let t in e)return!1;return!0}static isMobile(){let e=0,t=0;return document.body.clientWidth&&(e=document.body.clientWidth),document.body.clientHeight&&(t=document.body.clientHeight),this.isAndroid()||this.isIPhone()||this.isTablet()||e<350&&t<500}static isTablet(){return/ipad|android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase())}static isWeChat(){return"micromessenger"===String(navigator.userAgent.toLowerCase().match(/MicroMessenger/i))}static isAndroid(){let e=navigator.userAgent;return e.indexOf("Android")>-1||e.indexOf("Linux")>-1}static isIPhone(){return/iPhone/i.test(navigator.userAgent)}static isLegalUrl(e){return oc(e)}static normalizeUrl(e){return op(e)}static itCount(e){return t=>{for(let r=0;r<e;r++)t&&t()}}static hasLength(t,r){return!!e.isDefine(t)&&(e.isDefine(r)?t.length===r:t.length>0)}static capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}static fCamelCase(e,t){return t.toUpperCase()}static camelCase(e){return e.replace(of,"ms-").replace(og,this.fCamelCase)}static removeNull(t){return this.isObject(t)&&Object.keys(t).forEach(r=>{let n=t[r];null==n?delete t[r]:e.removeNull(n)}),t}static fillTwoDimensionalArray(e,t,r){return Array(e).fill(r).map(e=>Array(t).fill(r))}static numToWord(e){let t="";for(;e>0;){let r=e%26;t=String.fromCharCode(96+(r=0===r?r=26:r))+t,e=(e-r)/26}return t.toLocaleUpperCase()}static ABCatNum(e){if(null==e||0===e.length)return Number.NaN;let t=e.toLowerCase().split(""),r=t.length,n=0;for(let e=0;e<r;e++)n+=(t[e].charCodeAt(0)-96)*26**(r-e-1);return 0===n?Number.NaN:n-1}static chatAtABC(e){let t="";for(;e>=0;)t=String.fromCharCode(e%26+97)+t,e=Math.floor(e/26)-1;return t.toUpperCase()}static randSort(e){for(let t=0,r=e.length;t<r;t++){let n=Number.parseInt((Math.random()*r).toString()),o=e[n];e[n]=e[t],e[t]=o}return e}static commonExtend(e,t){let r={};for(let t in e)r[t]=e[t];for(let e in t)null!=t[e]&&(r[e]=t[e]);return r}static commonExtend1(e,t){for(let r in e)null==t[r]&&(t[r]=e[r]);return t}static arrayToObject(e){let t={};return e.forEach((e,r)=>{t[r]={},e.forEach((e,n)=>{t[r][n]=e})}),t}static hasIntersectionBetweenTwoRanges(e,t,r,n){return t>=r&&n>=e}static isStartValidPosition(e){return/^[A-Za-z_]/.test(e)}static isValidParameter(e){let t=/[~!@#$%^&*()+=\-{}\[\]\|:;"'<>,?\/ ]+/.test(e),r=e.length<=255;return!t&&r}static set(e,t,r){let n=t.split("."),o=n.pop();n.forEach(t=>{e[t]||(e[t]={}),e=e[t]}),o&&(e[o]=r)}static clamp(e,t,r){return Math.max(t,Math.min(r,e))}static now(){return performance&&performance.now?performance.now():Date.now()}static mergeWith(e,t,r){return oa(e,t,r)}};e4(o_,"Tools");let oy=o_;function oE(e=21,t){return t?or(t,e)():on(e)}function ob(e,t,r){let{dataStream:n,textRuns:o=[]}=e,i=t,s=[];for(let e of o){let{st:o,ed:a}=e;oy.hasIntersectionBetweenTwoRanges(t,r,o,a)&&(o>i?(s.push(n.slice(i,o)),s.push(oR(n,{...e,ed:Math.min(a,r)}))):s.push(oR(n,{...e,st:i,ed:Math.min(a,r)}))),i=Math.max(t,Math.min(a,r))}return i!==r&&s.push(n.slice(i,r)),s.join("")}function ov(e,t=!0){var r;if(!t||null==(r=e.paragraphs)||!r.length)return ob(e,0,e.dataStream.length);{let{dataStream:t,paragraphs:r=[]}=e,n="",o=-1;for(let t of r){let{startIndex:r,paragraphStyle:i={}}=t,{spaceAbove:s,spaceBelow:a,lineSpacing:l}=i,u=[];null!=s&&("number"==typeof s?u.push(`margin-top: ${s}px`):u.push(`margin-top: ${s.v}px`)),null!=a&&("number"==typeof a?u.push(`margin-bottom: ${a}px`):u.push(`margin-bottom: ${a.v}px`)),null!=l&&u.push(`line-height: ${l}`),r>o+1?n+=`<p class="UniverNormal" ${u.length?`style="${u.join("; ")};"`:""}>${ob(e,o+1,r)}</p>`:n+=`<p class="UniverNormal" ${u.length?`style="${u.join("; ")};"`:""}></p>`,o=r}return o!==t.length&&(n+=ob(e,o,t.length)),n}}function oR(e,t){let{st:r,ed:n,ts:o={}}=t,{ff:i,fs:s,it:a,bl:l,ul:u,st:c,ol:d,bg:h,cl:p,va:f}=o,g=e.slice(r,n),m=[];return a===n1.TRUE&&(g=`<i>${g}</i>`),f===n0.SUPERSCRIPT?g=`<sup>${g}</sup>`:f===n0.SUBSCRIPT&&(g=`<sub>${g}</sub>`),(null==u?void 0:u.s)===n1.TRUE&&(g=`<u>${g}</u>`),(null==c?void 0:c.s)===n1.TRUE&&(g=`<s>${g}</s>`),l===n1.TRUE&&(g=`<strong>${g}</strong>`),i&&m.push(`font-family: ${i}`),p&&m.push(`color: ${p.rgb}`),s&&m.push(`font-size: ${s}pt`),d&&m.push("text-decoration: overline"),h&&m.push(`background: ${h.rgb}`),m.length?`<span style="${m.join("; ")};">${g}</span>`:g}e4(oE,"generateRandomId"),e4(ob,"getBodySliceHtml"),e4(ov,"convertBodyToHtml"),e4(oR,"covertTextRunToHtml");let oT={[n3.OFFICE]:{[n5.ACCENT1]:"#4472C4",[n5.ACCENT2]:"#ED7D31",[n5.ACCENT3]:"#A5A5A5",[n5.ACCENT4]:"#70AD47",[n5.ACCENT5]:"#5B9BD5",[n5.ACCENT6]:"#70AD47",[n5.DARK1]:"#000000",[n5.DARK2]:"#44546A",[n5.LIGHT1]:"#FFFFFF",[n5.LIGHT2]:"#E7E6E6",[n5.HYPERLINK]:"#0563C1",[n5.FOLLOWED_HYPERLINK]:"#954F72"}},oI=class{constructor(){e9(this,"_themeValue",n5.LIGHT1),e9(this,"_themeColors"),e9(this,"_themeTint"),e9(this,"_rgbValue",""),e9(this,"_colorType"),this._colorType=nM.UNSUPPORTED,this._themeColors=n3.OFFICE,this._themeTint=0}asRgbColor(){return new oA(this._rgbValue,this)}asThemeColor(){return new oN(this._themeValue,this._themeTint,this._themeColors,this)}build(){switch(this._colorType){case nM.THEME:return this.asThemeColor();case nM.RGB:return this.asRgbColor();case nM.UNSUPPORTED:throw Error("unsupported color type")}}setRgbColor(e){return this._colorType=nM.RGB,this._rgbValue=e,this}setThemeColors(e){this._colorType=nM.THEME,this._themeColors=e}setThemeTint(e){this._colorType=nM.THEME,this._themeTint=e}setThemeColor(e){return this._colorType=nM.THEME,this._themeValue=e,this}getColorType(){return this._colorType}};e4(oI,"ColorBuilder");let oC=class e{constructor(e){e9(this,"_builder"),this._builder=e}static rgbColorToHexValue(e){return`#${(0x1000000+(e.getRed()<<16)+(e.getGreen()<<8)+e.getBlue()).toString(16).slice(1)}`}static hexValueToRgbColor(e){e?e.indexOf("#")>-1&&(e=e.substring(1)):e="#000000";let t=+`0x${e[0]}${e[1]}`,r=+`0x${e[2]}${e[3]}`,n=+`0x${e[4]}${e[5]}`;return new oI().setRgbColor(`rgb(${t},${r},${n})`).asRgbColor()}static hexToRgbString(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(e,t,r,n)=>t+t+r+r+n+n);let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e),r=null;if(t){let e=Number.parseInt(t[1],16),n=Number.parseInt(t[2],16),o=Number.parseInt(t[3],16);r=`rgba(${e},${n},${o})`}return r}asRgbColor(){return this._builder.asRgbColor()}asThemeColor(){return this._builder.asThemeColor()}getColorType(){return this._builder.getColorType()}clone(){return new e(this._builder)}equals(e){return!1}};e4(oC,"Color");let oS=oC,oO=class{constructor(e){e9(this,"_saturation",0),e9(this,"_hue",0),e9(this,"_lightness",0),e9(this,"_alpha",0);let t=e.getRed()/255,r=e.getGreen()/255,n=e.getBlue()/255,o=e.getAlpha()/255,i=Math.min(t,Math.min(r,n)),s=Math.max(t,Math.max(r,n)),a=s-i;if(s===i){this._hue=0,this._saturation=0,this._lightness=s;return}this._lightness=(i+s)/2,this._lightness<.5?this._saturation=a/(s+i):this._saturation=a/(2-s-i),t===s&&(this._hue=(r-n)/a),r===s&&(this._hue=2+(n-t)/a),n===s&&(this._hue=4+(t-r)/a),this._hue*=60,this._hue<0&&(this._hue+=360),this._alpha=o}asRgbColor(){let e;let t=new oI;if(0===this._saturation)return t.setRgbColor(`rgba(${255*this._lightness},${255*this._lightness},${255*this._lightness},${255*this._alpha})`),t.asRgbColor();e=this._lightness<.5?this._lightness*(1+this._saturation):this._lightness+this._saturation-this._lightness*this._saturation;let r=2*this._lightness-e,n=this._hue/360,o=this.setColor(e,r,n+1/3),i=this.setColor(e,r,n),s=this.setColor(e,r,n-1/3);return t.setRgbColor(`rgba(${Math.round(255*o)},${Math.round(255*i)},${Math.round(255*s)},${255*this._alpha})`),t.asRgbColor()}getLightness(){return this._lightness}getHue(){return this._hue}getSaturation(){return this._saturation}getAlpha(){return this._alpha}setColor(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),6*r<1?t+(e-t)*6*r:2*r<1?e:3*r<2?t+(e-t)*(2/3-r)*6:t}setLightness(e){this._lightness=e}};e4(oO,"HLSColor");let ox=class e extends oS{constructor(t,r){super(r),e9(this,"_cssString"),e9(this,"_red"),e9(this,"_green"),e9(this,"_blue"),e9(this,"_alpha");let n=t.match(e.RGBA_EXTRACT);if(n){let e=+n[1],r=+n[2],o=+n[3],i=+n[4];this._cssString=t,this._red=e,this._green=r,this._blue=o,this._alpha=i;return}if(n=t.match(e.RGB_EXTRACT)){let e=+n[1],r=+n[2],o=+n[3];this._cssString=t,this._red=e,this._green=r,this._blue=o,this._alpha=1;return}throw Error("Invalid rgba or rgb color")}asHexString(){return oS.rgbColorToHexValue(this)}getRed(){let t=this._red+e.RGB_COLOR_AMT;return t>255?t=255:t<0&&(t=0),t}getGreen(){let t=this._green+e.RGB_COLOR_AMT;return t>255?t=255:t<0&&(t=0),t}getBlue(){let t=this._blue+e.RGB_COLOR_AMT;return t>255?t=255:t<0&&(t=0),t}getAlpha(){return this._alpha}getColorType(){return nM.RGB}clone(){return new e(this._cssString,this._builder)}asThemeColor(){throw Error("rgb color not support to themeColor")}equals(t){return t instanceof e&&t._red===this._red&&t._blue===this._blue&&t._green===this._green&&t._alpha===this._alpha}getCssString(){return this._cssString}};e4(ox,"RgbColor"),e9(ox,"RGB_COLOR_AMT",0),e9(ox,"RGBA_EXTRACT",RegExp("\\s*rgba\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d.\\d|\\d\\s*)\\)\\s*")),e9(ox,"RGB_EXTRACT",RegExp("\\s*rgb\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*)\\)\\s*"));let oA=ox,ow=class e extends oS{constructor(e,t,r,n){super(n),e9(this,"_themeColorType"),e9(this,"_themeTint"),e9(this,"_themeColors"),this._themeColorType=e,this._themeTint=t,this._themeColors=r}lumValue(e,t){return null==e?t:e<0?t*(1+e):t*(1-e)+(255-255*(1-e))}asRgbColor(){let t;let r=oT[this._themeColors];if(null==r)throw Error("not find themeColors type");let n=r[this._themeColorType];if(null==n)throw Error("not find themeColors value");if(e._cacheThemeColor.has(this._themeColors)){if((t=e._cacheThemeColor.get(this._themeColors)).has(this._themeColorType))return t.get(this._themeColorType)}else t=/* @__PURE__ */new Map,e._cacheThemeColor.set(this._themeColors,t);let o=new oO(oS.hexValueToRgbColor(n));o.setLightness(this.lumValue(this._themeTint,255*o.getLightness())/255);let i=o.asRgbColor();return t.set(this._themeColorType,i),i}clone(){return new e(this._themeColorType,this._themeTint,this._themeColors,this._builder)}equals(t){return t instanceof e&&t._themeColorType===this._themeColorType}getColorType(){return nM.THEME}getThemeColorType(){return this._themeColorType}};e4(ow,"ThemeColor"),e9(ow,"_cacheThemeColor",/* @__PURE__ */new Map);let oN=ow,oD={aliceBlue:[240,248,255],antiqueWhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blancheAlmond:[255,235,205],blue:[0,0,255],blueViolet:[138,43,226],brown:[165,42,42],burlyWood:[222,184,135],cadetBlue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornFlowerBlue:[100,149,237],cornSilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkCyan:[0,139,139],darkGoldenrod:[184,132,11],darkGray:[169,169,169],darkGreen:[0,100,0],darkGrey:[169,169,169],darkKhaki:[189,183,107],darkMagenta:[139,0,139],darkOliveGreen:[85,107,47],darkOrange:[255,140,0],darkOrchid:[153,50,204],darkRed:[139,0,0],darkSalmon:[233,150,122],darkSeaGreen:[143,188,143],darkSlateBlue:[72,61,139],darkSlateGray:[47,79,79],darkSlateGrey:[47,79,79],darkTurquoise:[0,206,209],darkViolet:[148,0,211],deepPink:[255,20,147],deepSkyBlue:[0,191,255],dimGray:[105,105,105],dimGrey:[105,105,105],dodgerBlue:[30,144,255],firebrick:[178,34,34],floralWhite:[255,255,240],forestGreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostWhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenYellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotPink:[255,105,180],indianRed:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderBlush:[255,240,245],lawnGreen:[124,252,0],lemonChiffon:[255,250,205],lightblue:[173,216,230],lightCoral:[240,128,128],lightCyan:[224,255,255],lightGoldenrodYellow:[250,250,210],lightGray:[211,211,211],lightGreen:[144,238,144],lightGrey:[211,211,211],lightPink:[255,182,193],lightSalmon:[255,160,122],lightSeaGreen:[32,178,170],lightSkyBlue:[135,206,250],lightSlateGray:[119,136,153],lightSlateGrey:[119,136,153],lightSteelBlue:[176,196,222],lightYellow:[255,255,224],lime:[0,255,0],limeGreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumAquamarine:[102,205,170],mediumBlue:[0,0,205],mediumOrchid:[186,85,211],mediumPurple:[147,112,219],mediumSeaGreen:[60,179,113],mediumSlateBlue:[123,104,238],mediumSpringGreen:[0,250,154],mediumTurquoise:[72,209,204],mediumVioletRed:[199,21,133],midBightBlue:[25,25,112],mintCream:[245,255,250],mistyRose:[255,228,225],moccasin:[255,228,181],navajoWhite:[255,222,173],navy:[0,0,128],oldLace:[253,245,230],olive:[128,128,0],oliveDrab:[107,142,35],orange:[255,165,0],orangeRed:[255,69,0],orchid:[218,112,214],paleGoldenrod:[238,232,170],paleGreen:[152,251,152],paleTurquoise:[175,238,238],paleVioletRed:[219,112,147],papayaWhip:[255,239,213],peachPuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderBlue:[176,224,230],purple:[128,0,128],rebeccaPurple:[102,51,153],red:[255,0,0],rosyBrown:[188,143,143],royalBlue:[65,105,225],saddleBrown:[139,69,19],salmon:[250,128,114],sandyBrown:[244,164,96],seaGreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyBlue:[135,206,235],slateBlue:[106,90,205],slateGray:[119,128,144],slateGrey:[119,128,144],snow:[255,255,250],springGreen:[0,255,127],steelBlue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whiteSmoke:[245,245,245],yellow:[255,255,0],yellowGreen:[154,205,5]},oL=class e{constructor(t){if(e9(this,"_color"),e9(this,"_rgbColor"),e9(this,"_isValid",!1),null==t){this._setNullColor();return}if(t instanceof e){this._color={...t._color},this._rgbColor={...t._rgbColor};return}let r=ok(t);if(null==r){this._setNullColor();return}this._color=r;let n=o$(this._color);if(null==n){this._setNullColor();return}this._rgbColor=n,this._isValid=!0}static mix(t,r,n){var o,i;n=Math.min(1,Math.max(0,n));let s=new e(t).toRgb(),a=new e(r).toRgb(),l=null!=(o=s.a)?o:1,u=null!=(i=a.a)?i:1;return new e({r:(a.r-s.r)*n+s.r,g:(a.g-s.g)*n+s.g,b:(a.b-s.b)*n+s.b,a:(u-l)*n+l})}static getContrastRatio(t,r){let n=new e(t).getLuminance(),o=new e(r).getLuminance();return(Math.max(n,o)+.05)/(Math.min(n,o)+.05)}get isValid(){return this._isValid}toRgb(){return this._rgbColor}toRgbString(){let{r:e,g:t,b:r,a:n=1}=this.toRgb(),o=n<1;return`rgb${o?"a":""}(${e},${t},${r}${o?`,${n}`:""})`}toString(){return this.toRgbString()}toHexString(e){let{r:t,g:r,b:n,a:o=1}=this.toRgb(),i=o<1,s=[oU(Math.round(t).toString(16)),oU(Math.round(r).toString(16)),oU(Math.round(n).toString(16)),oU(Math.round(255*o).toString(16))];return e&&s[0][0]===s[0][1]&&s[1][0]===s[1][1]&&s[2][0]===s[2][1]&&s[3][0]===s[3][1]?i?`#${s[0][0]}${s[1][0]}${s[2][0]}${s[3][0]}`:`#${s[0][0]}${s[1][0]}${s[2][0]}`:i?`#${s[0]}${s[1]}${s[2]}${s[3]}`:`#${s[0]}${s[1]}${s[2]}`}toHsv(){return oK(this.toRgb())}toHsl(){return oz(this.toRgb())}lighten(t=10){let r=this.toHsl();return r.l+=t,r.l=Math.min(Math.max(r.l,0),100),new e(r)}darken(t=10){let r=this.toHsl();return r.l-=t,r.l=Math.min(Math.max(r.l,0),100),new e(r)}setAlpha(t){return new e({...this._rgbColor,a:t})}getLuminance(){let{r:e,g:t,b:r}=this.toRgb();return Number((.2126*(e=oP(e))+.7152*(t=oP(t))+.0722*(r=oP(r))).toFixed(3))}getBrightness(){let{r:e,g:t,b:r}=this.toRgb();return(299*e+587*t+114*r)/1e3}getAlpha(){var e;return null!=(e=this._color.a)?e:1}isDark(){return 128>this.getBrightness()}isLight(){return!this.isDark()}_setNullColor(){this._isValid=!1,this._color={r:0,g:0,b:0,a:0},this._rgbColor={r:0,g:0,b:0,a:0}}};e4(oL,"ColorKit");let oM=oL,oU=/* @__PURE__ */e4(e=>1===e.length?`0${e}`:e,"pad2"),oP=/* @__PURE__ */e4(e=>(e/=255)<=.03928?e/12.92:((e+.055)/1.055)**2.4,"rgbNormalize"),ok=/* @__PURE__ */e4(e=>{if(oq(e)){if("r"in e){let t={r:Math.round(e.r),g:Math.round(e.g),b:Math.round(e.b)};return void 0!==e.a&&(t.a=e.a),t}if("l"in e){let t={h:Math.round(e.h),s:e.s,l:e.l};return void 0!==e.a&&(t.a=e.a),t}let t={h:Math.round(e.h),s:e.s,v:e.v};return void 0!==e.a&&(t.a=e.a),t}let t=e.trim();if(oD[t]){let e=oD[t],r={r:Math.round(e[0]),g:Math.round(e[1]),b:Math.round(e[2])};return r.a=e[3]||1,r}return t.startsWith("#")?oF(t):t.startsWith("rgb")?oj(t):t.startsWith("hsl")?oB(t):t.startsWith("hsv")?oH(t):void 0},"toColor"),oF=/* @__PURE__ */e4(e=>{let t=e.substring(1),r=RegExp(`.{1,${t.length>=6?2:1}}`,"g"),n=t.match(r);if(!n||n.length<3)throw Error(`The color '${e}' is illegal hex color`);1===n[0].length&&(n=n.map(e=>e+e));let o={r:Number.parseInt(n[0],16),g:Number.parseInt(n[1],16),b:Number.parseInt(n[2],16)};return n.length>3&&(o.a=Number.parseInt(n[3],16)/255),o},"hexToColor"),oj=/* @__PURE__ */e4(e=>{let t=e.indexOf("(");if(-1===t)throw Error(`The color '${e}' is illegal rgb color`);let r=e.substring(t+1,e.length-1).split(",");if(r.length<3)throw Error(`The color '${e}' is illegal rgb color`);let n={r:Number.parseInt(r[0],10),g:Number.parseInt(r[1],10),b:Number.parseInt(r[2],10)};return r.length>3&&(n.a=Number.parseFloat(r[3])),n},"rgbToColor"),oB=/* @__PURE__ */e4(e=>{let t=e.indexOf("(");if(-1===t)throw Error(`The color '${e}' is illegal hsl color`);let r=e.substring(t+1,e.length-1).split(",");if(r.length<3)throw Error(`The color '${e}' is illegal hsl color`);let n={h:Number.parseInt(r[0],10),s:Number.parseFloat(r[1]),l:Number.parseFloat(r[2])};return r.length>3&&(n.a=Number.parseFloat(r[3])),n},"hslToColor"),oH=/* @__PURE__ */e4(e=>{let t=e.indexOf("(");if(-1===t)throw Error(`The color '${e}' is illegal hsv color`);let r=e.substring(t+1,e.length-1).split(",");if(r.length<3)throw Error(`The color '${e}' is illegal hsv color`);let n={h:Number.parseInt(r[0],10),s:Number.parseFloat(r[1]),v:Number.parseFloat(r[2])};return r.length>3&&(n.a=Number.parseFloat(r[3])),n},"hsvToColor"),o$=/* @__PURE__ */e4(e=>{let t=ok(e);if(null!=t)return"r"in t?t:"l"in t?oW(t):oV(t)},"toRgbColor"),oG=/* @__PURE__ */e4((e,t,r)=>(r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e),"hue2Rgb"),oW=/* @__PURE__ */e4(e=>{let{h:t,s:r,l:n}=e;t/=360,r/=100,n/=100;let o=0,i=0,s=0;if(0===r)o=i=s=n;else{let e=n<.5?n*(1+r):n+r-n*r,a=2*n-e;o=oG(a,e,t+1/3),i=oG(a,e,t),s=oG(a,e,t-1/3)}let a={r:Math.round(255*o),g:Math.round(255*i),b:Math.round(255*s)};return void 0!==e.a&&(a.a=e.a),a},"hsl2Rgb"),oV=/* @__PURE__ */e4(e=>{let{h:t,s:r,v:n}=e;t=t/360*6,r/=100,n/=100;let o=Math.floor(t),i=t-o,s=n*(1-r),a=n*(1-i*r),l=n*(1-(1-i)*r),u=o%6,c={r:255*[n,a,s,s,l,n][u],g:255*[l,n,n,a,s,s][u],b:255*[s,s,l,n,n,a][u]};return void 0!==e.a&&(c.a=e.a),c},"hsv2Rgb"),oz=/* @__PURE__ */e4(e=>{let t,r,{r:n,g:o,b:i}=e,s=Math.max(n/=255,o/=255,i/=255),a=Math.min(n,o,i),l=(s+a)/2;if(s===a)t=r=0;else{let e=s-a;switch(r=l>.5?e/(2-s-a):e/(s+a),s){case n:t=(o-i)/e+(o<i?6:0);break;case o:t=(i-n)/e+2;break;default:t=(n-o)/e+4}t/=6}let u={h:Math.round(360*t),s:Math.round(100*r),l:Math.round(100*l)};return void 0!==e.a&&(u.a=e.a),u},"rgb2Hsl"),oK=/* @__PURE__ */e4(e=>{let t,{r:r,g:n,b:o}=e,i=Math.max(r/=255,n/=255,o/=255),s=Math.min(r,n,o),a=i-s;if(i===s)t=0;else{switch(i){case r:t=(n-o)/a+(n<o?6:0);break;case n:t=(o-r)/a+2;break;default:t=(r-n)/a+4}t/=6}let l={h:Math.round(360*t),s:Math.round(100*(0===i?0:a/i)),v:Math.round(100*i)};return void 0!==e.a&&(l.a=e.a),l},"rgb2Hsv"),oY=/* @__PURE__ */e4(e=>null==e,"isUndefinedOrNull"),oq=/* @__PURE__ */e4(e=>!oY(e)&&"object"==typeof e,"isObject");function oJ(e){return!!(/^#(?:[Ff]{3}|[Ff]{6})\b/.test(e)||/^rgb\s*\(\s*255\s*,\s*255\s*,\s*255\s*\)$/.test(e)||/^rgba\s*\(\s*255\s*,\s*255\s*,\s*255\s*,\s*(1|1\.0*|0?\.\d+)\)$/.test(e)||/^hsl\s*\(\s*0*\s*,\s*0%*\s*,\s*100%*\s*\)$/.test(e)||/^hsla\s*\(\s*0*\s*,\s*0%*\s*,\s*100%*\s*,\s*(1|1\.0*|0?\.\d+)\)$/.test(e))}e4(function(e){return!!(/^#(?:[0]{3}|[0]{6})\b/.test(e)||/^rgb\s*\(\s*0+\s*,\s*0+\s*,\s*0+\s*\)$/.test(e)||/^rgba\s*\(\s*0+\s*,\s*0+\s*,\s*0+\s*,\s*(1|1\.0*|0?\.\d+)\)$/.test(e)||/^hsl\s*\(\s*0*\s*,\s*0%*\s*,\s*0%*\s*\)$/.test(e)||/^hsla\s*\(\s*0*\s*,\s*0%*\s*,\s*0%*\s*,\s*(1|1\.0*|0?\.\d+)\)$/.test(e))},"isBlackColor"),e4(oJ,"isWhiteColor");var oX=((j=oX||{})[j.COVER=0]="COVER",j[j.REPLACE=1]="REPLACE",j[j.INTERSECTION=2]="INTERSECTION",j);function oQ(e){return e&&(void 0!==e.s||void 0!==e.p||void 0!==e.v||void 0!==e.t||void 0!==e.f||void 0!==e.si||void 0!==e.custom)}function oZ(e){return void 0!==e.t?e.t:"string"==typeof e.v?n2.STRING:"number"==typeof e.v?n2.NUMBER:"boolean"==typeof e.v?n2.BOOLEAN:void 0}function o0(e){if(null==e)return!0;let{v:t,f:r,si:n,p:o,s:i,custom:s}=e;return!(!(null==t||"string"==typeof t&&0===t.length)||null!=r&&r.length>0||null!=n&&n.length>0||null!=o||null!=s)}function o1(e){return null!=e&&("string"==typeof e||"number"==typeof e||"boolean"==typeof e)}e4(oQ,"isICellData"),e4(oZ,"getCellValueType"),e4(o0,"isNullCell"),e4(o1,"isCellV");var o2=((B=o2||{})[B.NORMAL=0]="NORMAL",B[B.ROW=1]="ROW",B[B.COLUMN=2]="COLUMN",B[B.ALL=3]="ALL",B),o5=((H=o5||{})[H.NONE=0]="NONE",H[H.ROW=1]="ROW",H[H.COLUMN=2]="COLUMN",H[H.ALL=3]="ALL",H);function o3(e){return[e.startRow,e.startColumn,e.endRow,e.endColumn]}e4(o3,"selectionToArray");var o6=(($=o6||{}).NONE="none",$.BACKWARD="backward",$.FORWARD="forward",$),o4=((G=o4||{}).RECT="RECT",G.TEXT="TEXT",G);function o9(e,t,r){let n=!1,o=!1,i=e,s=t,a=e,l=t;if(null==r)return{actualRow:e,actualColumn:t,isMergedMainCell:o,isMerged:n,endRow:i,endColumn:s,startRow:a,startColumn:l};for(let u=0;u<r.length;u++){let{startRow:c,endRow:d,startColumn:h,endColumn:p}=r[u];if(e===c&&t===h){i=d,s=p,a=c,l=h,o=!0;break}if(e>=c&&e<=d&&t>=h&&t<=p){i=d,s=p,a=c,l=h,n=!0;break}}return{actualRow:e,actualColumn:t,isMergedMainCell:o,isMerged:n,endRow:i,endColumn:s,startRow:a,startColumn:l}}function o8(e){let{actualRow:t,actualColumn:r,isMerged:n,isMergedMainCell:o,mergeInfo:i}=e,{startY:s,endY:a,startX:l,endX:u}=e,c=t,d=r,h=t,p=r;if(n&&i){let{startRow:e,startColumn:t,endRow:r,endColumn:n,startY:o,endY:f,startX:g,endX:m}=i;c=e,d=t,h=r,p=n,s=o,a=f,l=g,u=m}return o&&(s=i.startY,a=i.endY,l=i.startX,u=i.endX,h=i.endRow,p=i.endColumn),{startRow:c,startColumn:d,endRow:h,endColumn:p,startY:s,endY:a,startX:l,endX:u}}function o7(e){if(!e)return;let{actualRow:t,actualColumn:r,isMerged:n,isMergedMainCell:o,startRow:i,startColumn:s,endRow:a,endColumn:l}=e,u=t,c=r,d=t,h=r;return(n||o)&&(u=i,c=s,d=a,h=l),{startRow:u,startColumn:c,endRow:d,endColumn:h}}function ie(e){var t;return!e||0===((null==(t=null==e?void 0:e.v)?void 0:t.toString())||"").length&&!e.p}function it(e){return ie(e)&&(null==e?void 0:e.coverable)!==!1}function ir(e){if(e){if(e.rgb)return e.rgb;if(e.th)return new oI().setThemeColor(e.th).asThemeColor().asRgbColor().getCssString()}return null}function io(e){return oy.isString(e)&&"="===e.substring(0,1)&&e.length>1}function ii(e){return oy.isString(e)&&e.length>0}function is(e,t=!1){var r;let n="",o=/* @__PURE__ */new Map([["ff",()=>{e.ff&&(n+=`font-family: ${e.ff}; `)}],["fs",()=>{if(e.fs){let t=e.fs;e.va&&(t/=2),n+=`font-size: ${t}pt; `}}],["it",()=>{e.it&&(n+="font-style: italic; ")}],["bl",()=>{e.bl&&(n+="font-weight: bold; ")}],["ul",()=>{var t;null!=(t=e.ul)&&t.s&&(n.indexOf("text-decoration-line")>-1?n=n.replace(/(text-decoration-line:\s*[^;]+)(?=;)/g,(e,t)=>`${t} underline`):n+="text-decoration: underline; ",e.ul.cl&&-1===n.indexOf("text-decoration-color")&&(n+=`text-decoration-color: ${ir(e.ul.cl)}; `),e.ul.t&&-1===n.indexOf("text-decoration-style")&&(n+=`text-decoration-style: ${e.ul.t} `))}],["st",()=>{var t;null!=(t=e.st)&&t.s&&(n.indexOf("text-decoration-line")>-1?n=n.replace(/(text-decoration-line:\s*[^;]+)(?=;)/g,(e,t)=>`${t} line-through`):n+="text-decoration-line: line-through; ",e.st.cl&&-1===n.indexOf("text-decoration-color")&&(n+=`text-decoration-color: ${ir(e.st.cl)}; `),e.st.t&&-1===n.indexOf("text-decoration-style")&&(n+=`text-decoration-style: ${e.st.t} `))}],["ol",()=>{var t;null!=(t=e.ol)&&t.s&&(n.indexOf("text-decoration-line")>-1?n=n.replace(/(text-decoration-line:\s*[^;]+)(?=;)/g,(e,t)=>`${t} overline`):n+="text-decoration-line: overline; ",e.ol.cl&&-1===n.indexOf("text-decoration-color")&&(n+=`text-decoration-color: ${ir(e.ol.cl)}; `),e.ol.t&&-1===n.indexOf("text-decoration-style")&&(n+=`text-decoration-style: ${e.ol.t} `))}],["bg",()=>{e.bg&&(n+=`background: ${ir(e.bg)}; `)}],["bd",()=>{var t,r,o,i,s,a,l,u,c,d,h,p;null!=(t=e.bd)&&t.b&&(n+=`border-bottom: ${ia(null==(r=e.bd)?void 0:r.b.s)} ${null!=(o=ir(e.bd.b.cl))?o:""}; `),null!=(i=e.bd)&&i.t&&(n+=`border-top: ${ia(null==(s=e.bd)?void 0:s.t.s)} ${null!=(a=ir(e.bd.t.cl))?a:""}; `),null!=(l=e.bd)&&l.r&&(n+=`border-right: ${ia(null==(u=e.bd)?void 0:u.r.s)} ${null!=(c=ir(e.bd.r.cl))?c:""}; `),null!=(d=e.bd)&&d.l&&(n+=`border-left: ${ia(null==(h=e.bd)?void 0:h.l.s)} ${null!=(p=ir(e.bd.l.cl))?p:""}; `)}],["cl",()=>{e.cl&&(n+=`color: ${ir(e.cl)}; `)}],["va",()=>{e.va===n0.SUBSCRIPT?n+="vertical-align: sub; ":e.va===n0.SUPERSCRIPT&&(n+="vertical-align: super; ")}],["td",()=>{e.td===nK.LEFT_TO_RIGHT?n+="direction: ltr; ":e.td===nK.RIGHT_TO_LEFT&&(n+="direction: rtl; ")}],["tr",()=>{var t,r,o;e.tr&&(n+=`--data-rotate: (${null==(t=e.tr)?void 0:t.a}deg${null!=(r=e.tr)&&r.v?` ,${null==(o=e.tr)?void 0:o.v}`:""});`)}],["ht",()=>{e.ht===nq.LEFT?n+="text-align: left; ":e.ht===nq.RIGHT?n+="text-align: right; ":e.ht===nq.CENTER?n+="text-align: center; ":e.ht===nq.JUSTIFIED&&(n+="text-align: justify; ")}],["vt",()=>{e.vt===nJ.BOTTOM?n+="vertical-align: bottom; ":e.vt===nJ.TOP?n+="vertical-align: top; ":e.vt===nJ.MIDDLE&&(n+="vertical-align: middle; ")}],["tb",()=>{e.tb===nX.CLIP?n+="white-space: nowrap; overflow-x: hidden; ":e.tb===nX.WRAP&&(n+="white-space: normal;")}],["pd",()=>{var t,r,o,i,s,a,l,u;let c=`${null==(t=e.pd)?void 0:t.b}pt`,d=`${null==(r=e.pd)?void 0:r.t}pt`,h=`${null==(o=e.pd)?void 0:o.l}pt`,p=`${null==(i=e.pd)?void 0:i.r}pt`;null!=(s=e.pd)&&s.b&&(n+=`padding-bottom: ${c}; `),null!=(a=e.pd)&&a.t&&(n+=`padding-top: ${d}; `),null!=(l=e.pd)&&l.l&&(n+=`padding-left: ${h}; `),null!=(u=e.pd)&&u.r&&(n+=`padding-right: ${p}; `)}]]),i=["bd","tr","tb"];for(let n in e)t&&i.includes(n)||null==(r=o.get(n))||r();return n}function ia(e){let t="";return e===nD.NONE?t="none":e===nD.THIN?t="0.5pt solid":e===nD.HAIR?t="0.5pt double":e===nD.DOTTED?t="0.5pt dotted":e===nD.DASHED||e===nD.DASH_DOT?t="0.5pt dashed":e===nD.DASH_DOT_DOT?t="0.5pt dotted":e===nD.DOUBLE?t="0.5pt double":e===nD.MEDIUM?t="1pt solid":e===nD.MEDIUM_DASHED||e===nD.MEDIUM_DASH_DOT?t="1pt dashed":e===nD.MEDIUM_DASH_DOT_DOT?t="1pt dotted":e===nD.SLANT_DASH_DOT?t="0.5pt dashed":e===nD.THICK&&(t="1.5pt solid"),t}function il(e){let t=0;if("none"===(e=e.trim()))t=nD.NONE;else if("0.5pt solid"===e)t=nD.THIN;else if("0.5pt double"===e)t=nD.HAIR;else if("0.5pt dotted"===e)t=nD.DOTTED;else if("0.5pt dashed"===e)t=nD.DASHED;else if("1pt solid"===e)t=nD.MEDIUM;else if("1pt dashed"===e)t=nD.MEDIUM_DASHED;else if("1pt dotted"===e)t=nD.MEDIUM_DASH_DOT_DOT;else if("1.5pt solid"===e)t=nD.THICK;else{if(e.includes("none"))return nD.NONE;t=nD.THIN}return t}function iu(e,t){let{startRow:r,endRow:n,startColumn:o,endColumn:i,rangeType:s}=e;if(r<0||o<0||n<0||i<0||!(Number.isNaN(r)&&Number.isNaN(n))&&s===o2.COLUMN||!(Number.isNaN(o)&&Number.isNaN(i))&&s===o2.ROW||s!==o2.ROW&&s!==o2.COLUMN&&(Number.isNaN(o)||Number.isNaN(r)||Number.isNaN(i)||Number.isNaN(n)))return!1;if(t){let e=t.getRowCount(),r=t.getColumnCount();if(n>=e||i>=r)return!1}return!0}function ic(e,t){return{startRow:e,endRow:e,startColumn:t,endColumn:t}}function id(e,t){return Object.prototype.toString.call(e)===Object.prototype.toString.call(t)&&("[object Object]"===Object.prototype.toString.call(e)||"[object Array]"===Object.prototype.toString.call(e)?Object.keys(e).length===Object.keys(t).length&&Object.keys(e).every(r=>id(e[r],t[r])):e===t)}function ih(e,t){let r=e.ts||{},n=t.ts||{};return e.sId===t.sId&&id(r,n)}function ip(e,t){return t.some(t=>e.indexOf(t)>-1)}function ig(e,t){let r;function n(...o){let i=this,s=/* @__PURE__ */e4(function(){r=null,e.apply(i,o)},"later");clearTimeout(r),r=setTimeout(s,t)}return e4(n,"run"),Object.defineProperty(n,"cancel",{value:/* @__PURE__ */e4(()=>{clearTimeout(r)},"value"),enumerable:!1,writable:!1}),n}function im(e,t,r,n){if(e>t&&([e,t]=[t,e]),r>n&&([r,n]=[n,r]),t<r||n<e)return[e,t];r<e&&(r=e),n>t&&(n=t);let o=n-r+1;return e===r?[n+1-o,t-o]:t===n?[e,r-1]:[e,t-o]}function i_(e){var t;return!(null==e||(null==e.indentStart||0===e.indentStart.v)&&null==e.hanging||(null==(t=e.hanging)?void 0:t.v)===0)}function iy(e,t,r){return e.slice(0,t)+r+e.slice(t)}function iE(e,t,r){return t>r?e:e.slice(0,t)+e.slice(r)}function ib(e){return null!==e&&""!==e.toString().replace(/\s/g,"")&&"boolean"!=typeof e&&!isNaN(e)}function iv(e){let t=0;for(let r=0;r<e.length;r++)t=e.charCodeAt(r)+(t<<6)+(t<<16)-t;return t>>>0}e4(o9,"getCellInfoInMergeData"),e4(o8,"makeCellToSelection"),e4(o7,"makeCellRangeToRangeData"),e4(ie,"isEmptyCell"),e4(it,"isCellCoverable"),e4(ir,"getColorStyle"),e4(io,"isFormulaString"),e4(ii,"isFormulaId"),e4(is,"handleStyleToString"),e4(ia,"getBorderStyle"),e4(il,"getBorderStyleType"),e4(function(e,t){let r=e.body;if(t){let{headers:n,footers:o}=e;null!=n&&n[t]?r=n[t].body:null!=o&&o[t]&&(r=o[t].body)}return r},"getDocsUpdateBody"),e4(iu,"isValidRange"),e4(ic,"cellToRange"),e4(id,"deepCompare"),e4(ih,"isSameStyleTextRun"),e4(ip,"checkForSubstrings"),e4(ig,"debounce"),e4(im,"horizontalLineSegmentsSubtraction"),e4(function(e){if(null==e)return!1;let t=e.bullet;return(null==t?void 0:t.listId)!=null},"checkParagraphHasBullet"),e4(function(e){return null!=e&&i_(e.paragraphStyle)},"checkParagraphHasIndent"),e4(i_,"checkParagraphHasIndentByStyle"),e4(iy,"insertTextToContent"),e4(iE,"deleteContent"),e4(ib,"isRealNum"),e4(iv,"hashAlgorithm");let iR=Symbol("newer"),iT=Symbol("older"),iI=class{constructor(e){e9(this,"entry"),this.entry=e}[Symbol.iterator](){return this}next(){let e=this.entry;return e?(this.entry=e[iR],{done:!1,value:e.key}):{done:!0,value:void 0}}};e4(iI,"KeyIterator");let iC=class{constructor(e){e9(this,"entry"),this.entry=e}[Symbol.iterator](){return this}next(){let e=this.entry;return e?(this.entry=e[iR],{done:!1,value:e.value}):{done:!0,value:void 0}}};e4(iC,"ValueIterator");let iS=class{constructor(e){e9(this,"entry"),this.entry=e}[Symbol.iterator](){return this}next(){let e=this.entry;return e?(this.entry=e[iR],{done:!1,value:[e.key,e.value]}):{done:!0,value:void 0}}};e4(iS,"EntryIterator");let iO=class{constructor(e,t){e9(this,"key"),e9(this,"value"),e9(this,iR),e9(this,iT),this.key=e,this.value=t,this[iR]=void 0,this[iT]=void 0}toJSON(){return{key:this.key,value:this.value}}};e4(iO,"Entry");let ix=class{constructor(...e){if(e9(this,"_keymap"),e9(this,"size",0),e9(this,"limit"),e9(this,"oldest"),e9(this,"newest"),e9(this,"_onShiftListeners",[]),iN.hasLength(e,1)){if(iN.isNumber(e[0])){let t=e[0];this._initialize(t,void 0);return}if(iN.isIterable(e[0])){let t=e[0];this._initialize(0,t)}return}if(iN.hasLength(e,2)){let t=e[0],r=e[1];this._initialize(t,r)}}onShift(e){if(-1===this._onShiftListeners.indexOf(e))return this._onShiftListeners.push(e),r7(()=>tt(this._onShiftListeners,e));throw Error("[LRUMap]: the listener has been registered!")}_initialize(e,t){this.oldest=void 0,this.newest=void 0,this.size=0,this.limit=e,this._keymap=/* @__PURE__ */new Map,t&&(this.assign(t),e<1&&(this.limit=this.size))}_markEntryAsUsed(e){e!==this.newest&&(e[iR]&&(e===this.oldest&&(this.oldest=e[iR]),e[iR][iT]=e[iT]),e[iT]&&(e[iT][iR]=e[iR]),e[iR]=void 0,e[iT]=this.newest,this.newest&&(this.newest[iR]=e),this.newest=e)}assign(e){let t,r=this.limit||Number.MAX_VALUE;this._keymap.clear();let n=e[Symbol.iterator]();for(let e=n.next();!e.done;e=n.next()){let n=new iO(e.value[0],e.value[1]);if(this._keymap.set(n.key,n),t?(t[iR]=n,n[iT]=t):this.oldest=n,t=n,0==r--)throw Error("overflow")}this.newest=t,this.size=this._keymap.size}set(e,t){let r=this._keymap.get(e);return r?(r.value=t,this._markEntryAsUsed(r)):(this._keymap.set(e,r=new iO(e,t)),this.newest?(this.newest[iR]=r,r[iT]=this.newest):this.oldest=r,this.newest=r,++this.size,this.size>this.limit&&this.shift()),this}shift(){let e=this.oldest;if(e)return this.oldest&&this.oldest[iR]?(this.oldest=this.oldest[iR],this.oldest[iT]=void 0):(this.oldest=void 0,this.newest=void 0),e[iR]=e[iT]=void 0,this._keymap.delete(e.key),--this.size,this._onShiftListeners.forEach(t=>t(e)),[e.key,e.value]}get(e){let t=this._keymap.get(e);if(t)return this._markEntryAsUsed(t),t.value}has(e){return this._keymap.has(e)}find(e){let t=this._keymap.get(e);return t?t.value:void 0}delete(e){let t=this._keymap.get(e);if(t)return this._keymap.delete(t.key),t[iR]&&t[iT]?(t[iT][iR]=t[iR],t[iR][iT]=t[iT]):t[iR]?(t[iR][iT]=void 0,this.oldest=t[iR]):t[iT]?(t[iT][iR]=void 0,this.newest=t[iT]):this.oldest=this.newest=void 0,this.size--,t.value}clear(){this.oldest=void 0,this.newest=void 0,this.size=0,this._keymap.clear()}keys(){return new iI(this.oldest)}values(){return new iC(this.oldest)}entries(){return this[Symbol.iterator]()}[Symbol.iterator](){return new iS(this.oldest)}forEach(e,t){"object"!=typeof t&&(t=this);let r=this.oldest;for(;r;)e.call(t,r.value,r.key,this),r=r[iR]}toJSON(){let e=Array(this.size),t=0,r=this.oldest;for(;r;)e[t++]={key:r.key,value:r.value},r=r[iR];return e}toString(){let e="",t=this.oldest;for(;t;)e+=`${String(t.key)}:${t.value}`,(t=t[iR])&&(e+=" < ");return e}};e4(ix,"LRUMap");let iA=ix,iw=class{static hasLength(e,t){return e.length===t}static getValueType(e){return Object.prototype.toString.apply(e)}static isObject(e){return"[object Object]"===this.getValueType(e)}static isIterable(e){return null!=e[Symbol.iterator]}static isNumber(e){return"[object Number]"===this.getValueType(e)}};e4(iw,"LRUHelper");let iN=iw;var iD={exports:{}};"u">typeof self&&self,sw=function(){return function(){var e={d:/* @__PURE__ */e4(function(t,r){for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},"d"),o:/* @__PURE__ */e4(function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},"o")},t={};e.d(t,{default:/* @__PURE__ */e4(function(){return ed},"default")});var r={1078:"af",1052:"sq",1118:"am",5121:"ar_DZ",15361:"ar_BH",3073:"ar_EG",2049:"ar_IQ",11265:"ar_JO",13313:"ar_KW",12289:"ar_LB",4097:"ar_LY",6145:"ar_MA",8193:"ar_OM",16385:"ar_QA",1025:"ar_SA",10241:"ar_SY",7169:"ar_TN",14337:"ar_AE",9217:"ar_YE",1067:"hy",1101:"as",2092:"az_AZ",1068:"az_AZ",1069:"eu",1059:"be",2117:"bn",1093:"bn_IN",5146:"bs",1026:"bg",1109:"my",1027:"ca",2052:"zh_CN",3076:"zh_HK",5124:"zh_MO",4100:"zh_SG",1028:"zh_TW",1050:"hr",1029:"cs",1030:"da",1125:"dv",2067:"nl_BE",1043:"nl_NL",1126:"bin",3081:"en_AU",10249:"en_BZ",4105:"en_CA",9225:"en_CB",2057:"en_GB",16393:"en_IN",6153:"en_IE",8201:"en_JM",5129:"en_NZ",13321:"en_PH",7177:"en_ZA",11273:"en_TT",1033:"en_US",12297:"en_ZW",1061:"et",1071:"mk",1080:"fo",1065:"fa",1124:"fil",1035:"fi",2060:"fr_BE",11276:"fr_CM",3084:"fr_CA",9228:"fr_CG",12300:"fr_CI",1036:"fr_FR",5132:"fr_LU",13324:"fr_ML",6156:"fr_MC",14348:"fr_MA",10252:"fr_SN",4108:"fr_CH",7180:"fr",1122:"fy_NL",2108:"gd_IE",1084:"gd",1110:"gl",1079:"ka",3079:"de_AT",1031:"de_DE",5127:"de_LI",4103:"de_LU",2055:"de_CH",1032:"el",1140:"gn",1095:"gu",1279:"en",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig_NG",1057:"id",1040:"it_IT",2064:"it_CH",1041:"ja",1099:"kn",1120:"ks",1087:"kk",1107:"km",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1142:"la",1062:"lv",1063:"lt",2110:"ms_BN",1086:"ms_MY",1100:"ml",1082:"mt",1112:"mni",1153:"mi",1102:"mr",1104:"mn",2128:"mn",1121:"ne",1044:"no_NO",2068:"no_NO",1096:"or",1045:"pl",1046:"pt_BR",2070:"pt_PT",1094:"pa",1047:"rm",2072:"ro_MO",1048:"ro_RO",1049:"ru",2073:"ru_MO",1083:"se",1103:"sa",3098:"sr_SP",2074:"sr_SP",1072:"st",1074:"tn",1113:"sd",1115:"si",1051:"sk",1060:"sl",1143:"so",1070:"sb",11274:"es_AR",16394:"es_BO",13322:"es_CL",9226:"es_CO",5130:"es_CR",7178:"es_DO",12298:"es_EC",17418:"es_SV",4106:"es_GT",18442:"es_HN",2058:"es_MX",19466:"es_NI",6154:"es_PA",15370:"es_PY",10250:"es_PE",20490:"es_PR",1034:"es_ES",14346:"es_UY",8202:"es_VE",1089:"sw",2077:"sv_FI",1053:"sv_SE",1114:"syc",1064:"tg",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1073:"ts",1055:"tr",1090:"tk",1058:"uk",1056:"ur",2115:"uz_UZ",1091:"uz_UZ",1075:"ve",1066:"vi",1106:"cy",1076:"xh",1085:"yi",1077:"zu"};let n=/^([a-z\d]+)(?:[_-]([a-z\d]+))?(?:\.([a-z\d]+))?(?:@([a-z\d]+))?$/i,o={},i={group:" ",decimal:".",positive:"+",negative:"-",percent:"%",exponent:"E",nan:"NaN",infinity:"∞",ampm:["AM","PM"],mmmm6:["Muharram","Safar","Rabiʻ I","Rabiʻ II","Jumada I","Jumada II","Rajab","Shaʻban","Ramadan","Shawwal","Dhuʻl-Qiʻdah","Dhuʻl-Hijjah"],mmm6:["Muh.","Saf.","Rab. I","Rab. II","Jum. I","Jum. II","Raj.","Sha.","Ram.","Shaw.","Dhuʻl-Q.","Dhuʻl-H."],mmmm:["January","February","March","April","May","June","July","August","September","October","November","December"],mmm:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dddd:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ddd:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]};function s(e){let t=n.exec(e);if(!t)throw SyntaxError("Malformed locale: ".concat(e));return{lang:t[1]+(t[2]?"_"+t[2]:""),language:t[1],territory:t[2]||"",codeset:t[3]||"",modifier:t[4]||""}}function a(e){if("number"==typeof e)return r[65535&e]||null;let t=parseInt(e,16);return isFinite(t)&&r[65535&t]?r[65535&t]||null:n.test(e)?e:null}function l(e){let t=a(e),r=null;if(t){let e=s(t);r=o[e.lang]||o[e.language]||null}return r}function u(e){return Object.assign({},i,e)}function c(e,t){let r="object"==typeof t?t:s(t);return o[r.lang]=u(e),r.language===r.lang||o[r.language]||(o[r.language]=u(e)),o[r.lang]}e4(s,"s"),e4(a,"o"),e4(l,"l"),e4(u,"d"),e4(c,"m");let d=u({group:","});function h(e,t){if("number"!=typeof e)return e;if(e<0)return-h(-e,t);if(t){let r=10**(t||0)||1;return h(e*r,0)/r}return Math.round(e)}function p(e,t,r){let n=e<0?-1:1,o=10**(t||2),i=10**(r||2),s,a,l=Math.abs(e),u=0,c=0,d=0,h=1;if((e=l)%1==0)a=[e*n,1];else if(e<1e-19)a=[n,1e19];else if(e>1e19)a=[1e19*n,1];else{do if(l=1/(l-Math.floor(l)),s=h,h=h*Math.floor(l)+u,u=s,c=d,(d=Math.floor(e*h+.5))>=o||h>=i)return[n*c,u];while(Math.abs(e-d/h)>=1e-10&&l!==Math.floor(l))a=[n*d,h]}return a}e4(h,"c"),d.isDefault=!0,c({group:",",ampm:["上午","下午"],mmmm:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],mmm:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dddd:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],ddd:["周日","周一","周二","周三","周四","周五","周六"]},"zh_CN"),c({group:",",nan:"非數值",ampm:["上午","下午"],mmmm:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],mmm:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dddd:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],ddd:["週日","週一","週二","週三","週四","週五","週六"]},"zh_TW"),c({group:",",ampm:["午前","午後"],mmmm:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],mmm:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dddd:["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],ddd:["日","月","火","水","木","金","土"]},"ja"),c({group:",",ampm:["오전","오후"],mmmm:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],mmm:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],dddd:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],ddd:["일","월","화","수","목","금","토"]},"ko"),c({group:",",ampm:["ก่อนเที่ยง","หลังเที่ยง"],mmmm:["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"],mmm:["ม.ค.","ก.พ.","มี.ค.","เม.ย.","พ.ค.","มิ.ย.","ก.ค.","ส.ค.","ก.ย.","ต.ค.","พ.ย.","ธ.ค."],dddd:["วันอาทิตย์","วันจันทร์","วันอังคาร","วันพุธ","วันพฤหัสบดี","วันศุกร์","วันเสาร์"],ddd:["อา.","จ.","อ.","พ.","พฤ.","ศ.","ส."]},"th"),c({decimal:",",ampm:["dop.","odp."],mmmm:["ledna","února","března","dubna","května","června","července","srpna","září","října","listopadu","prosince"],mmm:["led","úno","bře","dub","kvě","čvn","čvc","srp","zář","říj","lis","pro"],dddd:["neděle","pondělí","úterý","středa","čtvrtek","pátek","sobota"],ddd:["ne","po","út","st","čt","pá","so"]},"cs"),c({group:".",decimal:",",mmmm:["januar","februar","marts","april","maj","juni","juli","august","september","oktober","november","december"],mmm:["jan.","feb.","mar.","apr.","maj","jun.","jul.","aug.","sep.","okt.","nov.","dec."],dddd:["søndag","mandag","tirsdag","onsdag","torsdag","fredag","lørdag"],ddd:["søn.","man.","tir.","ons.","tor.","fre.","lør."]},"da"),c({group:".",decimal:",",ampm:["a.m.","p.m."],mmmm:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],mmm:["jan.","feb.","mrt.","apr.","mei","jun.","jul.","aug.","sep.","okt.","nov.","dec."],dddd:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],ddd:["zo","ma","di","wo","do","vr","za"]},"nl"),c({group:","},"en"),c({decimal:",",nan:"epäluku",ampm:["ap.","ip."],mmmm:["tammikuuta","helmikuuta","maaliskuuta","huhtikuuta","toukokuuta","kesäkuuta","heinäkuuta","elokuuta","syyskuuta","lokakuuta","marraskuuta","joulukuuta"],mmm:["tammik.","helmik.","maalisk.","huhtik.","toukok.","kesäk.","heinäk.","elok.","syysk.","lokak.","marrask.","jouluk."],dddd:["sunnuntaina","maanantaina","tiistaina","keskiviikkona","torstaina","perjantaina","lauantaina"],ddd:["su","ma","ti","ke","to","pe","la"]},"fi"),c({group:" ",decimal:",",mmmm:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],mmm:["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."],dddd:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],ddd:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."]},"fr"),c({group:".",decimal:",",mmmm:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],mmm:["Jan.","Feb.","März","Apr.","Mai","Juni","Juli","Aug.","Sept.","Okt.","Nov.","Dez."],dddd:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],ddd:["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."]},"de"),c({group:".",decimal:",",ampm:["π.μ.","μ.μ."],mmmm:["Ιανουαρίου","Φεβρουαρίου","Μαρτίου","Απριλίου","Μαΐου","Ιουνίου","Ιουλίου","Αυγούστου","Σεπτεμβρίου","Οκτωβρίου","Νοεμβρίου","Δεκεμβρίου"],mmm:["Ιαν","Φεβ","Μαρ","Απρ","Μαΐ","Ιουν","Ιουλ","Αυγ","Σεπ","Οκτ","Νοε","Δεκ"],dddd:["Κυριακή","Δευτέρα","Τρίτη","Τετάρτη","Πέμπτη","Παρασκευή","Σάββατο"],ddd:["Κυρ","Δευ","Τρί","Τετ","Πέμ","Παρ","Σάβ"]},"el"),c({decimal:",",ampm:["de.","du."],mmmm:["január","február","március","április","május","június","július","augusztus","szeptember","október","november","december"],mmm:["jan.","febr.","márc.","ápr.","máj.","jún.","júl.","aug.","szept.","okt.","nov.","dec."],dddd:["vasárnap","hétfő","kedd","szerda","csütörtök","péntek","szombat"],ddd:["V","H","K","Sze","Cs","P","Szo"]},"hu"),c({group:".",decimal:",",ampm:["f.h.","e.h."],mmmm:["janúar","febrúar","mars","apríl","maí","júní","júlí","ágúst","september","október","nóvember","desember"],mmm:["jan.","feb.","mar.","apr.","maí","jún.","júl.","ágú.","sep.","okt.","nóv.","des."],dddd:["sunnudagur","mánudagur","þriðjudagur","miðvikudagur","fimmtudagur","föstudagur","laugardagur"],ddd:["sun.","mán.","þri.","mið.","fim.","fös.","lau."]},"is"),c({group:".",decimal:",",mmmm:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],mmm:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"],dddd:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],ddd:["Min","Sen","Sel","Rab","Kam","Jum","Sab"]},"id"),c({group:".",decimal:",",mmmm:["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"],mmm:["gen","feb","mar","apr","mag","giu","lug","ago","set","ott","nov","dic"],dddd:["domenica","lunedì","martedì","mercoledì","giovedì","venerdì","sabato"],ddd:["dom","lun","mar","mer","gio","ven","sab"]},"it"),c({decimal:",",ampm:["a.m.","p.m."],mmmm:["januar","februar","mars","april","mai","juni","juli","august","september","oktober","november","desember"],mmm:["jan.","feb.","mar.","apr.","mai","jun.","jul.","aug.","sep.","okt.","nov.","des."],dddd:["søndag","mandag","tirsdag","onsdag","torsdag","fredag","lørdag"],ddd:["søn.","man.","tir.","ons.","tor.","fre.","lør."]},"nb"),c({decimal:",",mmmm:["stycznia","lutego","marca","kwietnia","maja","czerwca","lipca","sierpnia","września","października","listopada","grudnia"],mmm:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","paź","lis","gru"],dddd:["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","sobota"],ddd:["niedz.","pon.","wt.","śr.","czw.","pt.","sob."]},"pl"),c({group:".",decimal:",",mmmm:["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],mmm:["jan.","fev.","mar.","abr.","mai.","jun.","jul.","ago.","set.","out.","nov.","dez."],dddd:["domingo","segunda-feira","terça-feira","quarta-feira","quinta-feira","sexta-feira","sábado"],ddd:["dom.","seg.","ter.","qua.","qui.","sex.","sáb."]},"pt"),c({decimal:",",nan:"не число",mmmm:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],mmm:["янв.","февр.","мар.","апр.","мая","июн.","июл.","авг.","сент.","окт.","нояб.","дек."],dddd:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],ddd:["вс","пн","вт","ср","чт","пт","сб"]},"ru"),c({decimal:",",mmmm:["januára","februára","marca","apríla","mája","júna","júla","augusta","septembra","októbra","novembra","decembra"],mmm:["jan","feb","mar","apr","máj","jún","júl","aug","sep","okt","nov","dec"],dddd:["nedeľa","pondelok","utorok","streda","štvrtok","piatok","sobota"],ddd:["ne","po","ut","st","št","pi","so"]},"sk"),c({group:".",decimal:",",ampm:["a. m.","p. m."],mmmm:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],mmm:["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sept.","oct.","nov.","dic."],dddd:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],ddd:["dom.","lun.","mar.","mié.","jue.","vie.","sáb."]},"es"),c({decimal:",",ampm:["fm","em"],mmmm:["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],mmm:["jan.","feb.","mars","apr.","maj","juni","juli","aug.","sep.","okt.","nov.","dec."],dddd:["söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag"],ddd:["sön","mån","tis","ons","tors","fre","lör"]},"sv"),c({group:".",decimal:",",ampm:["ÖÖ","ÖS"],mmmm:["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],mmm:["Oca","Şub","Mar","Nis","May","Haz","Tem","Ağu","Eyl","Eki","Kas","Ara"],dddd:["Pazar","Pazartesi","Salı","Çarşamba","Perşembe","Cuma","Cumartesi"],ddd:["Paz","Pzt","Sal","Çar","Per","Cum","Cmt"]},"tr"),e4(p,"p");let f={overflow:"######",dateErrorThrows:!1,dateErrorNumber:!0,dateSpanLarge:!0,leap1900:!0,nbsp:!0,throws:!0,invalid:"######",locale:"",ignoreTimezone:!1},g=Object.assign({},f);function m(e){if(null===e&&(e=f),e){for(let t in e)if(t in f){let r=e[t];g[t]=null==r?f[t]:r}}return{...g}}e4(m,"h");let _={"#":"",0:"0","?":" "},y={"@":"text","-":"minus","+":"plus"},E=["#000","#FFF","#F00","#0F0","#00F","#FF0","#F0F","#0FF","#000","#FFF","#F00","#0F0","#00F","#FF0","#F0F","#0FF","#800","#080","#008","#880","#808","#088","#CCC","#888","#99F","#936","#FFC","#CFF","#606","#F88","#06C","#CCF","#008","#F0F","#FF0","#0FF","#808","#800","#088","#00F","#0CF","#CFF","#CFC","#FF9","#9CF","#F9C","#C9F","#FC9","#36F","#3CC","#9C0","#FC0"],b=["¤","$","£","¥","֏","؋","৳","฿","៛","₡","₦","₩","₪","₫","€","₭","₮","₱","₲","₴","₸","₹","₺","₼","₽","₾","₿"],v=RegExp("["+b.join("")+"]");function R(e,t,r){return t[r+"_max"]=e.length,t[r+"_min"]=e.replace(/#/g,"").length,t}e4(R,"M");let T={};function I(e){if(!(e in T)){let t=[],r=e.replace(/^[#,]+/,"").replace(/[1-9]\d*/g,e=>"?".repeat(e.length));for(let e=0;e<r.length;e++){let n=r.charAt(e);t[e]=n in _?_[n]:n}T[e]=t.join("")}return T[e]}function C(e,t){"string"==typeof e&&(e={type:"string",value:e=e.replace(/ /g,_["?"])}),t.push(e)}function S(e){let t=[],r={scale:1,percent:!1,text:!1,date:0,date_eval:!1,date_system:1,sec_decimals:0,general:!1,clock:24,int_pattern:[],frac_pattern:[],man_pattern:[],den_pattern:[],num_pattern:[],tokens:t},n=e+"",o="int",i=!1,s=null,l=[],u,c,d=!1;for(;n&&!i;){if(u=/^General/i.exec(n))r.general=!0,C({type:"general"},t);else if("int"===o&&(u=/^[#?0]+(?:,[#?0]+)*/.exec(n))||"den"===o&&(u=/^[#?\d]+/.exec(n))||(u=/^[#?0]+/.exec(n)))r[o+"_pattern"].push(u[0]),C(s={type:o,num:u[0]},t);else if((u=/^\//.exec(n))&&r[o+"_pattern"].length){if(!s)throw SyntaxError("Missing a numerator in pattern ".concat(e));r.fractions=!0,r.num_pattern.push(r[o+"_pattern"].pop()),s.type="num",o="den",C({type:"div"},t)}else if(u=/^,+/.exec(n)){let e=n.charAt(1) in _;c.slice(-1) in _&&(u[0].length>1||!e)?r.scale=.001**u[0].length:r.dec_fractions||C(u[0],t)}else{if(u=/^;/.exec(n)){i=!0;break}if(u=/^[@+-]/.exec(n))"@"===u[0]&&(r.text=!0),C({type:y[u[0]]},t);else if(u=/^(?:\[(h+|m+|s+)\])/i.exec(n)){let e=u[1].toLowerCase(),n=e[0],o={type:"",size:0,date:1,raw:u[0],pad:e.length};"h"===n?(o.size=16,o.type="hour-elap"):"m"===n?(o.size=32,o.type="min-elap"):(o.size=64,o.type="sec-elap"),r.date=r.date|o.size,l.push(o),C(o,t)}else if(u=/^(?:B2)/i.exec(n))d||(r.date_system=6);else if(u=/^(?:B1)/i.exec(n))d||(r.date_system=1);else if(u=/^(?:([hHmMsSyYbBdDegG])\1*)/.exec(n)){let e={type:"",size:0,date:1,raw:u[0]},n=u[0].toLowerCase(),o=n[0];if("y"===n||"yy"===n)e.size=2,e.type="year-short";else if("y"===o||"e"===o)e.size=2,e.type="year";else if("b"===n||"bb"===n)e.size=2,e.type="b-year-short";else if("b"===o)e.size=2,e.type="b-year";else if("d"===n||"dd"===n)e.size=8,e.type="day",e.pad=/dd/.test(n);else if("ddd"===n)e.size=8,e.type="weekday-short";else if("d"===o)e.size=8,e.type="weekday";else if("h"===o)e.size=16,e.type="hour",e.pad=/hh/i.test(n);else if("m"===o){3===n.length?(e.size=4,e.type="monthname-short"):5===n.length?(e.size=4,e.type="monthname-single"):n.length>=4&&(e.size=4,e.type="monthname");let t=l[l.length-1];!e.type&&t&&!t.used&&80&t.size&&(t.used=!0,e.size=32,e.type="min",e.pad=/mm/.test(n)),e.type||(e.size=4,e.type="month",e.pad=/mm/.test(n),e.indeterminate=!0)}else if("s"===o){e.size=64,e.type="sec",e.pad=/ss/.test(n);let t=l[l.length-1];t&&32&t.size?e.used=!0:t&&t.indeterminate&&(delete t.indeterminate,t.size=32,t.type="min",e.used=!0)}r.date=r.date|e.size,r.date_eval=!0,l.push(e),C(e,t)}else if(u=/^(?:AM\/PM|am\/pm|A\/P)/.exec(n))r.clock=12,r.date=16|r.date,r.date_eval=!0,C({type:"am",short:"A/P"===u[0]},t);else if(r.date&&(u=/^\.0{1,3}/i.exec(n))){let e=u[0].length-1,n=[64,128,256,512][e];r.date=r.date|n,r.date_eval=!0,r.sec_decimals=Math.max(r.sec_decimals,e),C({type:"subsec",size:n,decimals:e,date:1,raw:u[0]},t)}else if((u=/^\\(.)/.exec(n))||(u=/^"([^"]*?)"/.exec(n)))C(u[1],t);else if(u=/^\[(<[=>]?|>=?|=)\s*(-?[.\d]+)\]/.exec(n))r.condition=[u[1],parseFloat(u[2],10)];else if(u=/^\[\$([^\]]+)\]/.exec(n)){let e=u[1].split("-"),n=e.length<2?"":e[e.length-1],o=e[0];o&&C(o,t);let i=a(n);i&&(r.locale=i);let s=parseInt(n,16);isFinite(s)&&0xff0000&s&&(s>>16&255)==6&&(r.date_system=6),d=!0}else if(u=/^\[(black|blue|cyan|green|magenta|red|white|yellow|color\s*(\d+))\]/i.exec(n))r.color=u[2]?E[parseInt(u[2],10)]||"#000":u[1].toLowerCase();else if(!(u=/^\[(DBNum1|ENG|HIJ|JPN|TWN)\]/i.exec(n))){if(u=/^%/.exec(n))r.scale=100,r.percent=!0,C("%",t);else if(u=/^_(\\.|.)/.exec(n))C(" ",t);else if(u=/^\./.exec(n))C({type:"point",value:u[0]},t),r.dec_fractions=!0,o="frac";else if(u=/^[Ee]([+-]?|(?=[0#?]))/.exec(n))r.exponential=!0,r.exp_plus="+"===u[1],o="man",C({type:"exp",plus:"+"===u[1]},t);else if(!(u=/^\*(\\.|.)/.exec(n))){if(u=/^[BENn[]/.exec(n))throw SyntaxError("Unexpected char ".concat(n.charAt(0)," in pattern ").concat(e));"("===n[0]&&(r.parens=!0),C((u=[n[0]])[0],t)}}}c=u[0],n=n.slice(u?u[0].length:1)}if(r.pattern=e.slice(0,e.length-n.length),/^((?:\[[^\]]+\])+)(;|$)/.test(r.pattern)&&!/^\[(?:h+|m+|s+)\]/.test(r.pattern)&&C({type:"text"},t),r.fractions&&r.dec_fractions||r.fractions&&r.exponential)throw SyntaxError("Invalid pattern: ".concat(r.pattern));let h=r.int_pattern.join("");if(r.grouping=h.indexOf(",")>=0,r.grouping){let e=h.split(","),t=e.length;2===t?(r.group_pri=e[1].length,r.group_sec=r.group_pri):t>2&&(r.group_pri=e[t-1].length,r.group_sec=e[t-2].length)}else r.group_pri=0,r.group_sec=0;R(h.replace(/[,]/g,""),r,"int"),R(r.frac_pattern.join(""),r,"frac"),R(r.man_pattern.join(""),r,"man");let p=r.num_pattern.join(""),f=r.den_pattern.join(""),g=/\?/.test(f)||/\?/.test(p);return f=f.replace(/\d/g,g?"?":"#"),g&&(f=f.replace(/#$/g,"?")),R(p,r,"num"),R(f,r,"den"),g&&(p=p.replace(/#$/g,"?")),r.int_padding=I(r.int_pattern.join("")),r.man_padding=I(r.man_pattern.join("")),r.num_padding=I(p),r.den_padding=I(f),r.den_pattern.length&&(r.denominator=parseInt(r.den_pattern.join("").replace(/\D/g,""),10)),r.integer=!!r.int_pattern.join("").length,r.fractions&&t.forEach((e,r)=>{let n=t[r+1];"string"===e.type&&n&&("num"===n.type?e.rule="num+int":"div"===n.type?e.rule="num":"den"===n.type&&(e.rule="den"))}),r}e4(I,"x"),e4(C,"F"),e4(S,"z");let O=/* @__PURE__ */e4(e=>{let t=e.condition;t&&t[1]<0&&("<"===t[0]||"<="===t[0]||"="===t[0])||e.tokens.unshift({type:"minus",volatile:!0})},"w");function x(e){let t=[],r,n=!1,o=null,i=e,s=0,l=!1,u=0,c=0;do{if(((l=S(i)).date||l.general)&&(l.int_pattern.length||l.frac_pattern.length||1!==l.scale||l.text))throw Error("Illegal format");if(l.condition&&(c++,n=!0),l.text){if(o)throw Error("Unexpected partition");o=l}l.locale&&(r=a(l.locale)),t.push(l),s=";"===i.charAt(l.pattern.length)?1:0,i=i.slice(l.pattern.length+s),u++}while(s&&u<4&&c<3)if(s)throw Error("Unexpected partition");if(c>2)throw Error("Unexpected condition");let d=t[3];if(d&&(d.int_pattern.length||d.frac_pattern.length||d.date))throw Error("Unexpected partition");if(n){let e=t.length;if(1===e&&(t[1]=S("General"),t[1].generated=!0),e<3){let e=t[0],r=t[1];if(O(e),r.condition)O(r);else{let t=e.condition;("="===t[0]||t[1]>=0&&(">"===t[0]||">="===t[0]))&&r.tokens.unshift({type:"minus",volatile:!0})}}else t.forEach(O)}else{if(t.length<4&&o)for(let e=0,r=t.length;e<r;e++)t[e]===o&&t.splice(e,1);if(t.length<1&&o&&(t[0]=S("General"),t[0].generated=!0),t.length<2){let e=S(t[0].pattern);e.tokens.unshift({type:"minus",volatile:!0}),e.generated=!0,t.push(e)}if(t.length<3){let e=S(t[0].pattern);e.generated=!0,t.push(e)}if(t.length<4){if(o)t.push(o);else{let e=S("@");e.generated=!0,t.push(e)}}t[0].condition=[">",0],t[1].condition=["<",0],t[2].condition=null}return{pattern:e,partitions:t,locale:r}}e4(x,"D");let A=Math.floor;function w(e){if((!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&e>=0){if(0===e)return[1900,1,0];if(60===e)return[1900,2,29];if(e<60)return[1900,e<32?1:2,(e-1)%31+1]}let t=e+68569+2415019,r=A(4*t/146097);t-=A((146097*r+3)/4);let n=A(4e3*(t+1)/1461001);t=t-A(1461*n/4)+31;let o=A(80*t/2447),i=t-A(2447*o/80);t=A(o/11);let s=o+2-12*t;return[0|100*(r-49)+n+t,0|s,0|i]}function N(e){return w(e+1462)}function D(e){if(60===e)throw Error("#VALUE!");if(e<=1)return[1317,8,29];if(e<60)return[1317,e<32?9:10,1+(e-2)%30];let t=10631/30,r=e+466935,n=A(r/10631),o=A(((r-=10631*n)-.1335)/t);r-=A(o*t+.1335);let i=A((r+28.5001)/29.5);return 13===i?[30*n+o,12,30]:[30*n+o,i,r-A(29.5001*i-29)]}function L(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=A(e);return 6===t?D(n):-1===t?N(n):w(n,r)}e4(w,"C"),e4(N,"E"),e4(D,"A"),e4(L,"Y");let M=Math.floor;function U(e,t){let r=null;if(Array.isArray(e)){let[t,n,o,i,s,a]=e;r=Date.UTC(t,null==n?0:n-1,null!=o?o:1,i||0,s||0,a||0)}else if(e instanceof Date&&(r=1*e,!t||!t.ignoreTimezone)){let t=/* @__PURE__ */new Date;t.setUTCFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t.setUTCHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),r=1*t}if(null!=r&&isFinite(r)){let e=r/864e5;return e-(e<=-25509?-25568:-25569)}return e}function P(e,t){let r=0|e,n=86400*(e-r),o=M(n);n-o>.9999&&86400===(o+=1)&&(o=0,r+=1);let i=o<0?86400+o:o,[s,a,l]=L(e,0,t&&t.leap1900),u=M(i/60/60)%60,c=M(i/60)%60,d=M(i)%60;if(t&&t.nativeDate){let e=/* @__PURE__ */new Date(0);return e.setUTCFullYear(s,a-1,l),e.setUTCHours(u,c,d),e}return[s,a,l,u,c,d]}function k(e){return!!(e[0]&&e[0].percent||e[1]&&e[1].percent||e[2]&&e[2].percent||e[3]&&e[3].percent)}function F(e){return!!(e[0]&&e[0].date||e[1]&&e[1].date||e[2]&&e[2].date||e[3]&&e[3].date)}function j(e){let[t,r,n,o]=e;return!(t&&!t.generated||r&&!r.generated||n&&!n.generated||!o||!o.text||o.generated)}e4(U,"P"),e4(P,"I"),e4(k,"O"),e4(F,"J"),e4(j,"L");let B={text:15,datetime:10.8,date:10.8,time:10.8,percent:10.6,currency:10.4,grouped:10.2,scientific:6,number:4,fraction:2,general:0,error:0},H=[["DMY",1],["DM",2],["MY",3],["MDY",4],["MD",5],["hmsa",6],["hma",7],["hms",8],["hm",9]],$={total:1,sign:0,period:0,int:1,frac:0},G=/* @__PURE__ */e4((e,t)=>e.replace(/\./,t.decimal),"H");function W(e,t,r,n){let o=0|r;if("string"==typeof r)e.push(r);else if(r===o)e.push(Math.abs(o));else{let t=Math.abs(r),o=t?Math.floor(Math.log10(t)):0,i=o<0?t*10**-o:t/10**o;10===i&&(i=1,o++);let s=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=Math.abs(e);if(!r)return $;let n=t&&e<0?1:0,o=Math.floor(r),i=Math.floor(Math.log10(r)+1),s=0,a=0;if(o!==r){s=1;let e=String(h(i<0?r*10**-i:r/10**i,15)),t=e.length,n=!0,o=0;for(;o<=e.length;){if("."===e[o]){t--;break}"0"===e[o]&&n?t--:n=!1,o++}(a=t-i)<0&&(a=0,s=0)}return{total:n+Math.max(i,1)+s+a,digits:Math.max(i,0)+a,sign:n,period:s,int:Math.max(i,1),frac:a}}(t),a=/* @__PURE__ */e4(()=>{let t;let r=Math.abs(o);t=1===i?i:h(i,5),e.push(G(t+"",n),n.exponent,o<0?n.negative:n.positive,r<10?"0":"",r)},"o");if(o>=-4&&o<=-1){let r=t.toPrecision(10+o).replace(/\.?0+$/,"");e.push(G(r,n))}else if(10===o){let r=t.toFixed(10).slice(0,12).replace(/\.$/,"");e.push(G(r,n))}else if(9>=Math.abs(o)){if(s.total<=11){let r=h(t,9).toFixed(s.frac);e.push(G(r,n))}else 9===o?e.push(Math.floor(t)):o>=0&&o<9?e.push(h(t,9-o)):a()}else s.total>=12?a():Math.floor(t)===t?e.push(Math.floor(t)):e.push(G(h(t,9).toFixed(s.frac),n))}return e}e4(W,"B");let V={int:"integer",frac:"fraction",man:"mantissa",num:"numerator",den:"denominator"},z=/* @__PURE__ */e4(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=Math.floor(Math.log10(e));return t>1?Math.floor(r/t)*t:r},"Z");function K(e,t,r,n){var o,i;let s="",a="",l="",u="",c="",f=0,g=0|e,m=0,y=0,E=1,b=0,v=0,R=0,T=0,I=0,C=0,S=n||d;if(!t.text&&isFinite(t.scale)&&1!==t.scale&&(e=function(e){if(0===e)return e;let t=Math.ceil(Math.log10(e<0?-e:e)),r=10**(16-Math.floor(t));return Math.round(e*r)/r}(e*t.scale)),t.exponential){let r=Math.abs(e);if(r){let e=10**-z(r,t.int_max);f=z(h(r*e,t.frac_max)/e,t.int_max)}r/=10**f,e=e<0?-r:r,s+=Math.abs(f)}if(t.integer){let r=Math.abs(h(e,t.fractions?1:t.frac_max));c+=r<1?"":Math.floor(r)}if(t.grouping){let e="",r=c.length;for(r>t.group_pri&&(r-=t.group_pri,e=S.group+c.slice(r,r+t.group_pri)+e);r>t.group_sec;)r-=t.group_sec,e=S.group+c.slice(r,r+t.group_sec)+e;c=r?c.slice(0,r)+e:e}t.dec_fractions&&(u=String(h(e,t.frac_max)).split(".")[1]||"");let O=!1;if(t.fractions){let r=Math.abs(t.integer?e%1:e);if(r){if(O=!0,isFinite(t.denominator))l+=t.denominator,"0"===(a+=h(r*t.denominator))&&(a="",l="",O=!1,c||(c="0"));else{let e=p(r,t.integer?t.num_max:1/0,t.den_max);a+=e[0],l+=e[1],t.integer&&"0"===a&&(c||(c="0"),a="",l="",O=!1)}}}if(t.date){g=Math.trunc(e);let n=86400*(e-g);if(m=Math.floor(n),1e-6>Math.abs(C=n-m)?C=0:C>.9999&&(C=0,86400===(m+=1)&&(m=0,g+=1)),C){let e=512&t.date||256&t.date||128&t.date;(512===e&&C>.9995||256===e&&C>.995||128===e&&C>.95||!e&&C>=.5)&&(m++,C=0)}if(g||t.date_system){let n=L(e,t.date_system,r.leap1900);y=n[0],E=n[1],b=n[2]}if(m){let e=m<0?86400+m:m;I=Math.floor(e)%60,T=Math.floor(e/60)%60,R=Math.floor(e/60/60)%60}if(v=(6+g)%7,t.date_eval&&(o=e,i=g+m/86400,r.dateSpanLarge?o<-694324||i>=0x222ba13:o<0||i>=2958466)){if(r.dateErrorThrows)throw Error("Date out of bounds");return r.dateErrorNumber?W(e<0?[S.negative]:[],0,e,S).join(""):r.overflow}}if(t.int_padding&&(c=1===t.int_padding.length?c||t.int_padding:t.int_padding.substring(0,t.int_padding.length-c.length)+c),t.num_padding&&(a=1===t.num_padding.length?a||t.num_padding:t.num_padding.substring(0,t.num_padding.length-a.length)+a),t.den_padding&&(l=1===t.den_padding.length?l||t.den_padding:l+t.den_padding.slice(l.length)),t.man_padding){let e=t.exp_plus?"+":"";s=1===t.man_padding.length?(f<0?"-":e)+(s||t.man_padding):(f<0?"-":e)+t.man_padding.slice(0,t.man_padding.length-s.length)+s}let x=[],A=0,w={int:0,frac:0,man:0,num:0,den:0};for(let o=0,i=t.tokens.length;o<i;o++){let i=t.tokens[o],d=i.num?i.num.length:0;if("string"===i.type)i.rule?"num"===i.rule?O?x.push(i.value):(t.num_min>0||t.den_min>0)&&x.push(i.value.replace(/./g,_["?"])):"num+int"===i.rule?O&&c?x.push(i.value):t.den_min>0&&(c||t.num_min)&&x.push(i.value.replace(/./g,_["?"])):"den"===i.rule&&(O?x.push(i.value):(t.den_min>0||t.den_min>0)&&x.push(i.value.replace(/./g,_["?"]))):x.push(i.value);else if("error"===i.type)x.push(r.invalid);else if("point"===i.type)x.push(t.date?i.value:S.decimal);else if("general"===i.type)W(x,0,e,S);else if("exp"===i.type)x.push(S.exponent);else if("minus"===i.type)i.volatile&&t.date||i.volatile&&(e>=0||"number"!=typeof e)||(i.volatile&&!t.fractions&&(t.integer||t.dec_fractions)?(e<0&&c&&"0"!==c||u)&&x.push(S.negative):x.push(S.negative));else if("plus"===i.type)x.push(S.positive);else if("text"===i.type)x.push(e);else if("div"===i.type)O?x.push("/"):t.num_min>0||t.den_min>0?x.push(_["?"]):x.push(_["#"]);else if("int"===i.type){if(1===t.int_pattern.length)x.push(c);else{let e=A?t.int_pattern.join("").length-w.int:1/0,r=A===t.int_pattern.length-1?0:t.int_pattern.join("").length-(w.int+i.num.length);x.push(c.substring(c.length-e,c.length-r)),A++,w.int+=i.num.length}}else if("frac"===i.type){let e=w.frac;for(let t=0;t<d;t++)x.push(u[t+e]||_[i.num[t]]);w.frac+=d}else if(i.type in V)1===t[i.type+"_pattern"].length?("int"===i.type&&x.push(c),"frac"===i.type&&x.push(u),"man"===i.type&&x.push(s),"num"===i.type&&x.push(a),"den"===i.type&&x.push(l)):(x.push(V[i.type].slice(w[i.type],w[i.type]+d)),w[i.type]+=d);else if("year"===i.type)y<0&&x.push(S.negative),x.push(String(Math.abs(y)).padStart(4,"0"));else if("year-short"===i.type){let e=y%100;x.push(e<10?"0":"",e)}else if("month"===i.type)x.push(i.pad&&E<10?"0":"",E);else if("monthname-single"===i.type)6===t.date_system?x.push(S.mmmm6[E-1].charAt(0)):x.push(S.mmmm[E-1].charAt(0));else if("monthname-short"===i.type)6===t.date_system?x.push(S.mmm6[E-1]):x.push(S.mmm[E-1]);else if("monthname"===i.type)6===t.date_system?x.push(S.mmmm6[E-1]):x.push(S.mmmm[E-1]);else if("weekday-short"===i.type)x.push(S.ddd[v]);else if("weekday"===i.type)x.push(S.dddd[v]);else if("day"===i.type)x.push(i.pad&&b<10?"0":"",b);else if("hour"===i.type){let e=R%t.clock||(t.clock<24?t.clock:0);x.push(i.pad&&e<10?"0":"",e)}else if("min"===i.type)x.push(i.pad&&T<10?"0":"",T);else if("sec"===i.type)x.push(i.pad&&I<10?"0":"",I);else if("subsec"===i.type){x.push(S.decimal);let e=C.toFixed(t.sec_decimals);x.push(e.slice(2,2+i.decimals))}else if("am"===i.type){let e=R<12?0:1;i.short&&!n?x.push("AP"[e]):x.push(S.ampm[e])}else if("hour-elap"===i.type){e<0&&x.push(S.negative);let t=24*g+Math.floor(Math.abs(m)/3600);x.push(String(Math.abs(t)).padStart(i.pad,"0"))}else if("min-elap"===i.type){e<0&&x.push(S.negative);let t=1440*g+Math.floor(Math.abs(m)/60);x.push(String(Math.abs(t)).padStart(i.pad,"0"))}else if("sec-elap"===i.type){e<0&&x.push(S.negative);let t=86400*g+Math.abs(m);x.push(String(Math.abs(t)).padStart(i.pad,"0"))}else if("b-year"===i.type)x.push(y+543);else if("b-year-short"===i.type){let e=(y+543)%100;x.push(e<10?"0":"",e)}}return r.nbsp?x.join(""):x.join("").replace(/\u00a0/g," ")}function Y(e,t){for(let r=0;r<3;r++){let n=t[r];if(n){let t;if(n.condition){let r=n.condition[0],o=n.condition[1];"="===r?t=e===o:">"===r?t=e>o:"<"===r?t=e<o:">="===r?t=e>=o:"<="===r?t=e<=o:"<>"===r&&(t=e!==o)}else t=!0;if(t)return n}}}e4(K,"K"),e4(Y,"q");let q=S("@"),J="black",X={};function Q(e,t){if(e){let r=e[0];t[r]=t[r]||{},Q(e.slice(1),t[r])}else t.$=!0}e4(Q,"ee"),["d-F-y","d-F-Y","d-M-y","d-M-Y","F-d-y","F-d-Y","F-j-y","F-j-Y","j-F-y","j-F-Y","j-M-y","j-M-Y","M-d-y","M-d-Y","M-j-y","M-j-Y","m-d-y","m-d-Y","m-j-y","m-j-Y","n-d-y","n-d-Y","n-j-y","n-j-Y","y-F-d","y-F-j","y-M-d","y-M-j","Y-F-d","Y-F-j","Y-M-d","Y-m-d","Y-M-j","Y-m-j","Y-n-d","Y-n-j","j-F","j-M","d-F","d-M","n-d","n-j","n-Y","m-d","m-j","m-Y","M-Y","M-y","F-y","F-Y","Y-M","Y-n","Y-m","Y-F","Y-M"].forEach(e=>{Q(e,X),Q(e+" x",X),Q(e+" l",X),Q(e+" l x",X),Q("l "+e,X),Q("l "+e+" x",X),Q(e+" D",X),Q(e+" D x",X),Q("D "+e,X),Q("D "+e+" x",X)});let Z={jan:1,feb:2,mar:3,apr:4,may:5,jun:6,jul:7,aug:8,sep:9,oct:10,nov:11,dec:12},ee={january:1,february:2,march:3,april:4,june:6,july:7,august:8,september:9,october:10,november:11,december:12},et={sunday:"l",monday:"l",tuesday:"l",wednesday:"l",thursday:"l",friday:"l",saturday:"l",sun:"D",mon:"D",tue:"D",wed:"D",thu:"D",fri:"D",sat:"D"},er=/* @__PURE__ */new Date().getUTCFullYear();function en(e){let t=RegExp("^([\\s+%"+b.join("")+"(-]*)(((?:(?:\\d[\\d,]*)(?:\\.\\d*)?|(?:\\.\\d+)))([eE][+-]?\\d+)?)([\\s%"+b.join("")+")]*)$").exec(e);if(t){let[,e,r,n,o,i]=t,s=1,a="",l=!1,u=!1,c=!1,d=!1,h=!1,p=null,f=!1,g=parseFloat(r.replace(/,/g,""));if(!isFinite(g))return null;for(let t=0;t<e.length;t++){let r=e[t];if("-"===r){if(l||u)return null;l=!0,s=-1}else if(v.test(r)){if(h)return null;h=!0,p=r}else if("("===r){if(u||l)return null;u=!0,s=-1}else if("%"===r){if(d)return null;d=!0}}for(let e=0;e<i.length;e++){let t=i[e];if(v.test(t)){if(h)return null;h=!0,p=t,f=!0}else if(")"===t){if(c||!u)return null;c=!0}else if("%"===t){if(d)return null;d=!0}}if(o){if(d||h)return null;a="0.00E+00"}else if(d){if(h)return null;a=n.includes(".")?"0.00%":"0%",g*=.01}else if(h){let e=n.includes(".")?"#,##0.00":"#,##0";a=f?e+p:p+e}else n.includes(",")&&(a=n.includes(".")?"#,##0.00":"#,##0");let m={v:g*s};return a&&(m.z=a),m}}e4(en,"ie");let eo=/* @__PURE__ */e4((e,t,r)=>{let n=r.path||"",o=Object.keys(t);for(let i=0;i<o.length;i++){let s;let a=o[i];if(t[a]){if("$"===a||"€"===a)e||(s=r);else if("-"===a){let o=/^(\s*([./-]|,\s)\s*|\s+)/.exec(e);if(o){let i="-"===o[1]||"/"===o[1]||"."===o[1]?o[1]:" ";if(!r.sep||r.sep===i){let l=o[0].replace(/\s+/g," ");s=eo(e.slice(o[0].length),t[a],{...r,sep:i,path:n+l})}}}else if(" "===a){let o=/^[,.]?\s+/.exec(e);if(o){let i=o[0].replace(/\s+/g," ");s=eo(e.slice(o[0].length),t[a],{...r,path:n+i})}}else if("j"===a||"d"===a){let o=/^(0?[1-9]|1\d|2\d|3[01])\b/.exec(e);o&&(s=eo(e.slice(o[0].length),t[a],{...r,day:o[0],path:n+a}))}else if("n"===a||"m"===a){let o=/^(0?[1-9]|1[012])\b/.exec(e);o&&(s=eo(e.slice(o[0].length),t[a],{...r,month:+o[0],_mon:o[0],path:n+a}))}else if("F"===a||"M"===a){let o=/^([a-z]{3,9})\b/i.exec(e),i=o&&("F"===a?ee:Z)[o[0].toLowerCase()];i&&(s=eo(e.slice(o[0].length),t[a],{...r,month:i,_mon:o[0],path:n+a}))}else if("l"===a||"D"===a){let o=/^([a-z]{3,9})\b/i.exec(e);(o&&et[o[0].toLowerCase()])===a&&(s=eo(e.slice(o[0].length),t[a],{...r,path:n+a}))}else if("y"===a){let o=/^\d\d\b/.exec(e);if(o){let i=+o[0]>=30?+o[0]+1900:+o[0]+2e3;s=eo(e.slice(o[0].length),t[a],{...r,year:i,path:n+a})}}else if("Y"===a){let o=/^\d\d\d\d\b/.exec(e);o&&(s=eo(e.slice(o[0].length),t[a],{...r,year:+o[0],path:n+a}))}else{if("x"!==a)throw Error('Unknown date token "'.concat(a,'"'));{let o=es(e);o&&(s=eo("",t[a],{...r,time:o.v,tf:o.z,path:n+a}))}}if(s)return s}}},"se");function ei(e,t){let r=eo(e.trim(),X,{path:""});if(r){var n;if("."===r.sep&&3===r.path.length)return null;let e=+(null!==(n=r.year)&&void 0!==n?n:er);if(r.day||(r.day=1),!function(e,t,r){if(r<1||t<1||t>12)return!1;if(2===t){if(r>(e%4==0&&e%100!=0||e%400==0||1900===e?29:28))return!1}else if((4===t||6===t||9===t||11===t)&&r>30||(1===t||3===t||5===t||7===t||8===t||10===t||12===t)&&r>31)return!1;return!0}(e,r.month,r.day))return null;let o=-1/0;if(e<1900)return null;e<=1900&&r.month<=2?o=25568:e<1e4&&(o=25569);let i=Date.UTC(e,r.month-1,r.day)/864e5+o+(r.time||0);if(i>=0&&i<=2958465){let e="0"===r._mon[0]||"0"===r.day[0]||2===r._mon.length&&2===r.day.length,n=r.path.replace(/[jdlDnmMFyYx-]/g,t=>"j"===t||"d"===t?e?"dd":"d":"D"===t?"ddd":"l"===t?"dddd":"n"===t||"m"===t?e?"mm":"m":"M"===t?"mmm":"F"===t?"mmmm":"y"===t?"yy":"x"===t?r.tf||"":"Y"===t?"yyyy":t);return t&&t.nativeDate?{v:P(i,t),z:n}:{v:i,z:n}}}return null}function es(e){let t=/^\s*([10]?\d|2[0-4])(?::([0-5]\d|\d))?(?::([0-5]\d|\d))?(\.\d{1,10})?(?:\s*([AP])M?)?\s*$/i.exec(e);if(t){let[,e,r,n,o,i]=t;if(o&&!n||!i&&!r&&!n)return null;let s=1*(e||0);if(i){if(s>=13)return null;"p"!==i[0]&&"P"!==i[0]||(s+=12)}return{v:(60*s*60+1*(r||0)*60+1*(n||0)+1*(o||0))/86400,z:(2===e.length?"hh":"h")+":mm"+(n?":ss":"")+(i?" AM/PM":"")}}return null}function ea(e){return/^\s*true\s*$/i.test(e)?{v:!0}:/^\s*false\s*$/i.test(e)?{v:!1}:null}e4(ei,"oe"),e4(es,"le"),e4(ea,"de");let el={};function eu(e,t){let{pattern:r,partitions:n,locale:o}=e,i=/* @__PURE__ */e4(e=>{let r=Object.assign({},m(),t,e);return o&&(r.locale=o),r},"i"),s=/* @__PURE__ */e4((e,t)=>{let r=i(t);return function(e,t,r){let n=l(r.locale),o=t[3]?t[3]:q;if("boolean"==typeof e&&(e=e?"TRUE":"FALSE"),null==e)return"";if("number"!=typeof e)return K(e,o,r,n);if(!isFinite(e)){let t=n||d;return isNaN(e)?t.nan:(e<0?t.negative:"")+t.infinity}let i=Y(e,t);return i?K(e,i,r,n):r.overflow}(U(e,r),n,r)},"s");s.color=(e,t)=>(function(e,t){if("number"!=typeof e||!isFinite(e))return(t[3]?t[3].color:q.color)||J;let r=Y(e,t);return r&&r.color||J})(U(e,i(t)),n);let a=function(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,[n,o]=e,i=n.frac_max,s={type:"general",isDate:F(e),isText:j(e),isPercent:k(e),maxDecimals:n.general?9:i,scale:null!==(t=n.scale)&&void 0!==t?t:1,color:0,parentheses:0,grouped:n.grouping?1:0,_partitions:e},a=!s.isDate&&!s.isText&&!n.error&&n.tokens.some(e=>"string"===e.type&&(r?e.value===r:v.test(e.value))),l="G",u=i>=0?Math.min(15,i):"",c="",d="";if(o&&o.color&&(d="-",s.color=1),n.parens&&(c="()",s.parentheses=1),a)l="C",s.type="currency";else if(n.error)s.type="error",s.maxDecimals=0;else if(s.isDate){let e=0,t=0,r="";n.tokens.forEach(n=>{let o=n.type;/^(b-)?year/.test(o)?(r+="Y",t++):o.startsWith("month")?(r+="M",t++):/^(week)?day/.test(o)?(r+="D",t++):"hour"!==o&&"min"!==o&&"sec"!==o&&"am"!==o||(r+=o[0],e++)}),s.type="date",t&&e?s.type="datetime":!t&&e&&(s.type="time");let o=H.find(e=>r.startsWith(e[0]));l=o?"D":"G",u=o?o[1]:""}else s.isText?(l="G",s.type="text",u="",s.maxDecimals=0):n.general?(l="G",s.type="general",u=""):n.fractions?(l="G",s.type="fraction",u=""):n.exponential?(l="S",s.type="scientific"):s.isPercent?(l="P",s.type="percent"):n.grouping?(l=",",s.type="grouped"):(n.int_max||i)&&(l="F",s.type="number");return s.code=l+u+d+c,s.level=B[s.type],Object.freeze(s)}(n,(t||{}).currency)||SyntaxError();return s.info=a,s.dateInfo=function(e){let[t]=e;return{year:!!(2&t.date),month:!!(4&t.date),day:!!(8&t.date),hours:!!(16&t.date),minutes:!!(32&t.date),seconds:!!(64&t.date),clockType:12===t.clock?12:24}}(n),s.isPercent=()=>!!a.isPercent,s.isDate=()=>!!a.isDate,s.isText=()=>!!a.isText,s.pattern=r,e.error&&(s.error=e.error),s.options=i,s.locale=o||t&&t.locale||"",Object.freeze(s)}function ec(e,t){e||(e="General");let r=null;return el[e]?r=el[e]:(r=Object.assign({},m(),t).throws?x(e):function(e){try{return x(e)}catch(r){let t={tokens:[{type:"error"}],error:r.message};return{pattern:e,partitions:[t,t,t,t],error:r.message,locale:null}}}(e)).error||(el[e]=r),eu(r,t)}e4(eu,"ue"),e4(ec,"ce"),ec.isDate=e=>ec(e,{throws:!1}).isDate(),ec.isPercent=e=>ec(e,{throws:!1}).isPercent(),ec.isText=e=>ec(e,{throws:!1}).isText(),ec.getInfo=(e,t)=>ec(e,{...t,throws:!1}).info,ec.getDateInfo=(e,t)=>ec(e,{...t,throws:!1}).dateInfo,ec.dateToSerial=U,ec.dateFromSerial=P,ec.options=m,ec.dec2frac=p,ec.round=h,ec.codeToLocale=r,ec.parseLocale=s,ec.getLocale=l,ec.addLocale=(e,t)=>{let r=s(t);return delete el[r.lang],delete el[r.language],c(e,r)},ec.format=function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=r&&"object"==typeof r?r:{locale:r,throws:!n};return ec(e,o)(U(t,o),o)},ec.is_date=ec.isDate,ec.parseNumber=en,ec.parseDate=ei,ec.parseTime=es,ec.parseBool=ea,ec.parseValue=function(e,t){var r,n,o;return null!==(r=null!==(n=null!==(o=en(e))&&void 0!==o?o:ei(e,t))&&void 0!==n?n:es(e))&&void 0!==r?r:ea(e)};var ed=ec;return t.default}()},iD.exports=sw();let iL=/* @__PURE__ */oi(iD.exports);function iM(e){let t=0;for(let r of Object.keys(e))t=Math.max(t,Number(r));return t+1}function iU(e,t,r){let n=iM(r);for(let t=n-1;t>=e;t--)r[t+1]=r[t];r[e]=t}function iP(e,t,r){let n=Object.keys(r).reduce((e,t)=>Math.max(e,Number.parseInt(t)),0)+1;for(let o=e;o<n;o++)o<e+t?delete r[o]:void 0!==r[o]&&(r[o-t]=r[o],delete r[o])}function ik(e,t){let r=Object.keys(e),n=r.length,o=Object.keys(t),i=o.length,s={},a=0;for(let t=0;t<n;t++,a++){let n=r[t];s[a]=e[n]}for(let e=0;e<i;e++,a++){let r=o[e];s[a]=t[r]}return s}function iF(e,t,r){if(iM(r)>0){let n={},o=0;for(let i=e;i<=t;i++)r[i]&&(n[o]=r[i],o++);return n}return{}}function ij(e,t,r,n){let o=e>r;if(!o&&e+t>r)throw Error("Invalid move operation");o?iB(e,t,r,n):iH(e,t,r,n)}function iB(e,t,r,n){let o=[];for(let r=e;r<e+t;r++)o.push(n[r]);for(let o=e-1;o>=r;o--){let e=n[o];n[o+t]=e,void 0===e&&delete n[o+t]}o.forEach((e,t)=>{n[r+t]=e,void 0===e&&delete n[r+t]})}function iH(e,t,r,n){let o=[];for(let r=e;r<e+t;r++)o.push(n[r]);for(let o=e+t;o<r;o++){let e=n[o];n[o-t]=e,void 0===e&&delete n[o-t]}o.forEach((e,o)=>{n[r+o-t]=e,void 0===e&&delete n[r+o-t]})}e4(iM,"getArrayLength"),e4(iU,"insertMatrixArray"),e4(iP,"spliceArray"),e4(ik,"concatMatrixArray"),e4(iF,"sliceMatrixArray"),e4(ij,"moveMatrixArray"),e4(iB,"_moveBackward"),e4(iH,"_moveForward");let i$=class e{constructor(e={}){e9(this,"_matrix"),this._setOriginValue(e)}static MakeObjectMatrixSize(t){return new e({[t-1]:{}})}getMatrix(){return this._matrix}forEach(e){let t=this._matrix;for(let r of Object.keys(t)){let n=Number(r),o=t[n];if(!1===e(n,o))break}return this}forRow(e){let t=this._matrix;for(let r of Object.keys(t)){let n=Number(r),o=t[n];if(!1===e(n,Object.keys(o).map(e=>Number(e))))break}return this}forValue(e){let t=this._matrix;for(let r of Object.keys(t)){let n=Number(r),o=t[n];if(o){for(let t of Object.keys(o))if(!1===e(n,Number(t),o[Number(t)]))return this}}return this}swapRow(e,t){let r=this._matrix[e],n=this._matrix[t];this._matrix[e]=n,this._matrix[t]=r}getRow(e){return this._matrix[e]}getRowOrCreate(e){let t=this.getRow(e);return null==t&&(t={},this._matrix[e]=t),t}reset(){this._setOriginValue({})}hasValue(){let e=this._matrix,t=Object.keys(e);if(0===t.length)return!1;for(let r of t)if(Object.keys(e[Number(r)]).length>0)return!0;return!1}getValue(e,t){var r,n;return null==(n=null==(r=this._matrix)?void 0:r[e])?void 0:n[t]}setValue(e,t,r){this.getRowOrCreate(e)[t]=r}deleteValue(e,t){var r,n;null==(n=null==(r=this._matrix)?void 0:r[e])||delete n[t]}realDeleteValue(e,t){var r,n,o;if(null==(n=null==(r=this._matrix)?void 0:r[e])||delete n[t],this.getRow(e)){let t=this.getRow(e);if(null==t)return;0===Object.keys(t).length&&(null==(o=this._matrix)||delete o[e])}}setRow(e,t){this._matrix[e]=t}moveRows(e,t,r){ij(e,t,r,this._matrix)}moveColumns(e,t,r){this.forEach((n,o)=>{ij(e,t,r,o)})}insertRows(e,t){for(let r=e;r<e+t;r++)iU(r,{},this._matrix)}insertColumns(e,t){for(let r=e;r<e+t;r++)this.forEach((e,t)=>{t&&iU(r,void 0,t)})}removeRows(e,t){iP(e,t,this._matrix)}removeColumns(e,t){this.forEach((r,n)=>{n&&iP(e,t,n)})}getFragment(t,r,n,o){let i=new e,s=0;for(let e=t;e<=r;e++){let t={},r=0;for(let i=n;i<=o;i++){let n=this.getValue(e,i);t[r]=n,r++}i.setRow(s,t),s++}return i}getSlice(t,r,n,o){let i=new e;for(let e=t;e<=r;e++)for(let t=n;t<=o;t++){let r=this.getValue(e,t);r&&i.setValue(e,t,oy.deepClone(r))}return i}getSizeOf(){return Object.keys(this._matrix).length}getLength(){return iM(this._matrix)}getRange(){let e=this.getLength()-1,t=0,r=this.getLength();for(let e=0;e<r;e++){let r=this.getRow(e);if(r){let e=iM(r)-1;t=e>t?e:t}}return{startRow:0,startColumn:0,endRow:e,endColumn:t}}toNativeArray(){let e=[];return this.forValue((t,r,n)=>{e.push(n)}),e}toArray(){let e=[];return this.forRow((t,r)=>{null==e[t]&&(e[t]=[]),r.forEach(r=>{e[t][r]=this.getValue(t,r)})}),e}toFullArray(){let{endColumn:e,endRow:t}=this.getRange(),r=[];for(let n=0;n<=t;n++){let t=Array(e+1).fill(void 0);r.push(t)}return this.forValue((e,t,n)=>{r[e][t]=n}),r}toJSON(){return this._matrix}clone(){return JSON.parse(JSON.stringify(this._matrix))}getData(){return JSON.parse(JSON.stringify(this._matrix))}getArrayData(){let t=0,r=0,n=!1,o=!1,i=new e;return this.forEach((e,s)=>{n||(n=!0,t=e),Object.keys(s).forEach(n=>{let s=Number(n);o?s<r&&(r=s):(o=!0,r=s);let a=this.getValue(e,s);i.setValue(e-t,s-r,a)})}),i.getData()}getStartEndScope(){let e=1/0,t=-1/0,r=1/0,n=-1/0,o=Object.keys(this._matrix);for(let i of(o.length>0&&(e=+o[0],t=+o[o.length-1]),o)){let e=Object.keys(this._matrix[i]);e.length>0&&(r=Math.min(r,+e[0]),n=Math.max(n,+e[e.length-1]))}return{startRow:e,endRow:t,startColumn:r,endColumn:n}}getDataRange(){let e=0,t=0,r=0,n=-1,o=!1,i=!1;return this.forEach((s,a)=>{if(o||(o=!0,e=s),null==a)return;let l=iM(a)-1;l>r&&(r=l),Object.keys(a).forEach(e=>{let r=Number(e);i?r<t&&(t=r):(i=!0,t=r)}),s>n&&(n=s)}),{startRow:e,startColumn:t,endRow:n,endColumn:r}}getDiscreteRanges(){let e=[];return this.forEach((t,r)=>{Object.keys(r).forEach(r=>{let n=Number(r),o=!1;for(let r of e)if(t>=r.startRow&&t<=r.endRow+1&&n>=r.startColumn&&n<=r.endColumn+1){r.endRow=Math.max(t,r.endRow),r.endColumn=Math.max(n,r.endColumn),o=!0;break}o||e.push({startRow:t,endRow:t,startColumn:n,endColumn:n})})}),e}merge(e){this.forValue((t,r)=>{let n=e.getValue(t,r);null!=n&&this.setValue(t,r,n)})}_setOriginValue(e={}){this._matrix=e}};e4(i$,"ObjectMatrix");let iG=i$,iW={ff:"Arial",fs:11,it:n1.FALSE,bl:n1.FALSE,ul:{s:n1.FALSE},st:{s:n1.FALSE},ol:{s:n1.FALSE},tr:{a:0,v:n1.FALSE},td:nK.UNSPECIFIED,cl:{rgb:"#000"},bg:{rgb:"#fff"},ht:nq.UNSPECIFIED,vt:nJ.UNSPECIFIED,tb:nX.UNSPECIFIED,pd:{t:0,r:0,b:0,l:0},n:null},iV={id:"default_slide",title:"defaultSlide",pageSize:{width:300,height:300}};var iz=((W=iz||{}).ARRAY_CONVERTOR="ARRAY_CONVERTOR",W.MATRIX_CONVERTOR="MATRIX_CONVERTOR",W);function iK(e,t){let{textRuns:r=[]}=t,n=0;for(let t of r){let{ts:r={},st:o,ed:i}=t;if(null==r[e])return n1.FALSE;switch(e){case"bl":case"it":if(r[e]===n1.FALSE)return n1.FALSE;break;case"ul":case"st":if(r[e].s===n1.FALSE)return n1.FALSE;break;default:throw Error(`unknown style key: ${e} in IStyleBase`)}n+=i-o}return t.dataStream.indexOf(`\r
`)===n?n1.TRUE:n1.FALSE}e4(iK,"isAllFormatInTextRuns");let iY=class e{constructor(e,t,r){e9(this,"_range"),e9(this,"_worksheet"),this._deps=r,this._range=t,this._worksheet=e}static foreach(e,t){let{startRow:r,startColumn:n,endRow:o,endColumn:i}=e;for(let e=r;e<=o;e++)for(let r=n;r<=i;r++)t(e,r)}getRangeData(){return this._range}getValue(){return this.getValues()[0][0]}getValues(){let{startRow:e,endRow:t,startColumn:r,endColumn:n}=this._range,o=[];for(let i=e;i<=t;i++){let e=[];for(let t=r;t<=n;t++)e.push(this.getMatrix().getValue(i,t)||null);o.push(e)}return o}getMatrix(){let{startRow:e,endRow:t,startColumn:r,endColumn:n}=this._range,o=this._worksheet.getCellMatrix(),i=new iG;for(let s=e;s<=t;s++)for(let e=r;e<=n;e++)i.setValue(s,e,o.getValue(s,e)||null);return i}getMatrixObject(){let{startRow:e,endRow:t,startColumn:r,endColumn:n}=this._range,o=this._worksheet.getCellMatrix(),i=new iG;for(let s=e;s<=t;s++)for(let t=r;t<=n;t++)i.setValue(s-e,t-r,o.getValue(s,t)||{});return i}getA1Notation(){let e,t;let{startRow:r,endRow:n,startColumn:o,endColumn:i}=this._range;return o<i?(e=oy.numToWord(o+1)+(r+1),t=oy.numToWord(i+1)+(n+1)):(e=oy.numToWord(i+1)+(n+1),t=oy.numToWord(o+1)+(r+1)),e===t?`${e}`:`${e}:${t}`}getBackground(){return this.getBackgrounds()[0][0]}getBackgrounds(){let e=this._deps.getStyles();return this.getValues().map(t=>t.map(t=>{var r;let n=e.getStyleByCell(t);return(null==(r=null==n?void 0:n.bg)?void 0:r.rgb)||iW.bg.rgb}))}getCell(t,r){let{startRow:n,startColumn:o}=this._range;return new e(this._worksheet,{startRow:n+t,endRow:n+t,startColumn:o+r,endColumn:o+r},this._deps)}getColumn(){return this._range.startColumn}getObjectValue(e={}){return this.getObjectValues(e)[0][0]}getObjectValues(e={}){var t;let{startRow:r,endRow:n,startColumn:o,endColumn:i}=this._range,s=this._worksheet.getCellMatrix().getFragment(r,n,o,i).getData();if(e.isIncludeStyle){let e=this._deps.getStyles();for(let a=0;a<=n-r;a++)for(let r=0;r<=i-o;r++){if(null==s||(null==(t=null==s?void 0:s[a])?void 0:t[r])==null)continue;let n=s[a][r].s;n&&(s[a][r].s=e.get(n))}}return s}getFontColor(){return this.getFontColors()[0][0]}getFontColors(){let e=this._deps.getStyles();return this.getValues().map(t=>t.map(t=>{var r;let n=e.getStyleByCell(t);return(null==(r=null==n?void 0:n.cl)?void 0:r.rgb)||iW.cl.rgb}))}getFontFamilies(){return this._getStyles("ff")}getFontFamily(){return this.getFontFamilies()[0][0]}getUnderlines(){return this._getStyles("ul")}getUnderline(){var e,t;let{p:r}=null!=(e=this.getValue())?e:{};return r&&Array.isArray(null==(t=r.body)?void 0:t.textRuns)&&r.body.textRuns.length>0?iK("ul",r.body)===n1.TRUE?{s:n1.TRUE}:{s:n1.FALSE}:this.getUnderlines()[0][0]}getOverlines(){return this._getStyles("ol")}getOverline(){return this.getOverlines()[0][0]}getStrikeThrough(){var e,t;let{p:r}=null!=(e=this.getValue())?e:{};return r&&Array.isArray(null==(t=r.body)?void 0:t.textRuns)&&r.body.textRuns.length>0?iK("st",r.body)===n1.TRUE?{s:n1.TRUE}:{s:n1.FALSE}:this.getStrikeThroughs()[0][0]}getStrikeThroughs(){return this._getStyles("st")}getFontSize(){var e,t;let r=(null==(e=this.getValue())?void 0:e.p)||{};return r&&Array.isArray(null==(t=r.body)?void 0:t.textRuns)&&r.body.textRuns.length>0&&r.body.textRuns.some(e=>{var t;return(null==(t=null==e?void 0:e.ts)?void 0:t.fs)!=null})?Math.max(...r.body.textRuns.map(e=>{var t;return(null==(t=null==e?void 0:e.ts)?void 0:t.fs)||0})):this.getFontSizes()[0][0]}getFontSizes(){return this._getStyles("fs")}getBorder(){return this.getBorders()[0][0]}getBorders(){return this._getStyles("bd")}getFontStyle(){var e,t;let{p:r}=null!=(e=this.getValue())?e:{};return r&&Array.isArray(null==(t=r.body)?void 0:t.textRuns)&&r.body.textRuns.length>0?iK("it",r.body)===n1.TRUE?nQ.ITALIC:nQ.NORMAL:this._getFontStyles()[0][0]}_getFontStyles(){return this._getStyles("it")}getFontWeight(){var e,t;let{p:r}=null!=(e=this.getValue())?e:{};return r&&Array.isArray(null==(t=r.body)?void 0:t.textRuns)&&r.body.textRuns.length>0?iK("bl",r.body)===n1.TRUE?nZ.BOLD:nZ.NORMAL:this._getFontWeights()[0][0]}_getFontWeights(){return this._getStyles("bl")}getGridId(){return this._worksheet.getSheetId()}getHeight(){let{_range:e,_worksheet:t}=this,{startRow:r,endRow:n}=e,o=0;for(let e=0;e<=n-r;e++)o+=t.getRowHeight(e);return o}getHorizontalAlignment(){return this.getHorizontalAlignments()[0][0]}getHorizontalAlignments(){return this._getStyles("ht")}getLastColumn(){return this._range.endColumn}getLastRow(){return this._range.endRow}getNumColumns(){let{startColumn:e,endColumn:t}=this._range;return t-e+1}getNumRows(){let{startRow:e,endRow:t}=this._range;return t-e+1}getRichTextValue(){return this.getRichTextValues()[0][0]}getRichTextValues(){return this.getValues().map(e=>e.map(e=>(null==e?void 0:e.p)||""))}getRowIndex(){return this._range.startRow}getSheet(){return this._worksheet}getTextDirection(){return this.getTextDirections()[0][0]}getTextDirections(){return this._getStyles("td")}getTextRotation(){return this.getTextRotations()[0][0]}getTextRotations(){return this._getStyles("tr")}getTextStyle(){return this.getTextStyles()[0][0]}getTextStyles(){let e=this._deps.getStyles();return this.getValues().map(t=>t.map(t=>e.getStyleByCell(t)))}getVerticalAlignment(){return this.getVerticalAlignments()[0][0]}getVerticalAlignments(){return this._getStyles("vt")}getWidth(){let{_range:e,_worksheet:t}=this,{startColumn:r,endColumn:n}=e,o=0;for(let e=0;e<=n-r;e++)o+=t.getColumnWidth(e);return o}getWrap(){return this.getWrapStrategy()===nX.WRAP?n1.TRUE:n1.FALSE}getWrapStrategies(){return this._getStyles("tb")}getWrapStrategy(){return this.getWrapStrategies()[0][0]}forEach(t){e.foreach(this._range,t)}_getStyles(e){let t=this._deps.getStyles();return this.getValues().map(r=>r.map(r=>{let n=t&&t.getStyleByCell(r);return n&&n[e]||iW[e]}))}};e4(iY,"Range"),e9(iY,"transformRange",/* @__PURE__ */e4((e,t)=>e.rangeType===o2.ALL?{startColumn:0,startRow:0,endColumn:t.getMaxColumns()-1,endRow:t.getMaxRows()-1}:e.rangeType===o2.COLUMN?{startRow:0,endRow:t.getMaxRows()-1,startColumn:e.startColumn,endColumn:e.endColumn}:e.rangeType===o2.ROW?{startColumn:0,endColumn:t.getMaxColumns()-1,startRow:e.startRow,endRow:e.endRow}:e,"transformRange"));let iq=iY;function iJ(e,t,r,n=!1){let o={...e},i=o.startAbsoluteRefType||o5.NONE,s=o.endAbsoluteRefType||o5.NONE;return n||i!==o5.ALL||s!==o5.ALL?n||i===o5.NONE&&s===o5.NONE?i5.moveOffset(o,t,r):(i===o5.NONE?o={...o,startRow:o.startRow+r,startColumn:o.startColumn+t}:i===o5.COLUMN?o={...o,startRow:o.startRow+r}:i===o5.ROW&&(o={...o,startColumn:o.startColumn+t}),s===o5.NONE?o={...o,endRow:o.endRow+r,endColumn:o.endColumn+t}:s===o5.COLUMN?o={...o,endRow:o.endRow+r}:s===o5.ROW&&(o={...o,endColumn:o.endColumn+t}),o):o}function iX(e){let t=/* @__PURE__ */new Set,r=/* @__PURE__ */new Set;for(let n of e)t.add(n.startColumn),t.add(n.endColumn+1),r.add(n.startRow),r.add(n.endRow+1);let n=Array.from(t).sort((e,t)=>e-t),o=Array.from(r).sort((e,t)=>e-t),i=[];for(let e=0;e<o.length-1;e++)for(let t=0;t<n.length-1;t++)i.push({startColumn:n[t],endColumn:n[t+1]-1,startRow:o[e],endRow:o[e+1]-1});let s=[];for(let t of i)for(let r of e)if(r.startRow<=t.endRow&&r.endRow>=t.startRow&&r.startColumn<=t.endColumn&&r.endColumn>=t.startColumn){s.push({startColumn:Math.max(t.startColumn,r.startColumn),endColumn:Math.min(t.endColumn,r.endColumn),startRow:Math.max(t.startRow,r.startRow),endRow:Math.min(t.endRow,r.endRow)});break}return s}function iQ(e){e.sort((e,t)=>e.startRow-t.startRow||e.startColumn-t.startColumn);let t={};for(let r of e)t[r.startRow]||(t[r.startRow]=[]),t[r.startRow].push(r);let r=[];for(let e in t){let n=t[+e];n.sort((e,t)=>e.startColumn-t.startColumn);let o=n[0];for(let e=1;e<n.length;e++){let t=n[e];t.startColumn<=o.endColumn+1&&t.startRow===o.startRow&&t.endRow===o.endRow?o.endColumn=Math.max(o.endColumn,t.endColumn):(r.push(o),o=t)}r.push(o)}return r}function iZ(e){e.sort((e,t)=>e.startColumn-t.startColumn||e.startRow-t.startRow);let t={};for(let r of e)t[r.startColumn]||(t[r.startColumn]=[]),t[r.startColumn].push(r);let r=[];for(let e in t){let n=t[+e];n.sort((e,t)=>e.startRow-t.startRow);let o=n[0];for(let e=1;e<n.length;e++){let t=n[e];t.startRow<=o.endRow+1&&t.startColumn===o.startColumn&&t.endColumn===o.endColumn?o.endRow=Math.max(o.endRow,t.endRow):(r.push(o),o=t)}r.push(o)}return r}function i0(e){return iZ(iQ(iX(e)))}function i1(e,t){let r=[];return e.forEach(e=>{r.push(...i5.subtract(e,t))}),i5.mergeRanges(r)}e4(iJ,"moveRangeByOffset"),e4(iX,"splitIntoGrid"),e4(iQ,"mergeHorizontalRanges"),e4(iZ,"mergeVerticalRanges"),e4(i0,"mergeRanges$1"),e4(i1,"multiSubtractSingleRange");let i2=class e{static clone(e){return void 0!==e.rangeType?{startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn,rangeType:e.rangeType}:{startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn}}static equals(e,t){return null!=e&&null!=t&&e.endRow===t.endRow&&e.endColumn===t.endColumn&&e.startRow===t.startRow&&e.startColumn===t.startColumn&&(e.rangeType===t.rangeType||void 0===e.rangeType&&t.rangeType===o2.NORMAL||void 0===t.rangeType&&e.rangeType===o2.NORMAL)}static intersects(e,t){if(e.rangeType===o2.ROW&&t.rangeType===o2.COLUMN||e.rangeType===o2.COLUMN&&t.rangeType===o2.ROW)return!0;if(e.rangeType===o2.ROW&&t.rangeType===o2.ROW)return e.startRow<=t.endRow&&e.endRow>=t.startRow;if(e.rangeType===o2.COLUMN&&t.rangeType===o2.COLUMN)return e.startColumn<=t.endColumn&&e.endColumn>=t.startColumn;let r=Math.floor(Number.MAX_SAFE_INTEGER/10),n=Number.isNaN(e.startRow)?0:e.startRow,o=Number.isNaN(e.endRow)?r:e.endRow,i=Number.isNaN(e.startColumn)?0:e.startColumn,s=Number.isNaN(e.endColumn)?r:e.endColumn,a=Number.isNaN(t.startRow)?0:t.startRow,l=Number.isNaN(t.endRow)?r:t.endRow,u=Number.isNaN(t.startColumn)?0:t.startColumn,c=Number.isNaN(t.endColumn)?r:t.endColumn,d=Math.abs(n+o-a-l),h=Math.abs(n-o)+Math.abs(a-l);return Math.abs(i+s-u-c)<=Math.abs(i-s)+Math.abs(u-c)&&d<=h}static getIntersects(e,t){let r,n,o;let i=e.startRow,s=e.endRow,a=e.startColumn,l=e.endColumn,u=t.startRow,c=t.endRow,d=t.startColumn,h=t.endColumn;return u<=s&&(n=u>=i?u:i,c>=i&&(o=c>=s?s:c,d<=l&&(r=d>a?d:a,h>=a)))?{startRow:n,endRow:o,startColumn:r,endColumn:h>=l?l:h,rangeType:o2.NORMAL}:null}static contains(e,t){return e.startRow<=t.startRow&&e.endRow>=t.endRow&&e.startColumn<=t.startColumn&&e.endColumn>=t.endColumn}static realContain(t,r){return e.contains(t,r)&&(t.startRow<r.startRow||t.endRow>r.endRow||t.startColumn<r.startColumn||t.endColumn>r.endColumn)}static union(...e){return e.reduce((e,t)=>({startRow:Math.min(e.startRow,t.startRow),startColumn:Math.min(e.startColumn,t.startColumn),endRow:Math.max(e.endRow,t.endRow),endColumn:Math.max(e.endColumn,t.endColumn),rangeType:o2.NORMAL}),e[0])}static realUnion(...t){let r=t.some(e=>e.rangeType===o2.COLUMN),n=t.some(e=>e.rangeType===o2.ROW),o=e.union(...t);return{startColumn:n?Number.NaN:o.startColumn,endColumn:n?Number.NaN:o.endColumn,startRow:r?Number.NaN:o.startRow,endRow:r?Number.NaN:o.endRow,rangeType:n?o2.ROW:r?o2.COLUMN:o2.NORMAL}}static subtract(e,t){if(t.startRow>e.endRow||t.endRow<e.startRow||t.startColumn>e.endColumn||t.endColumn<e.startColumn)return[e];let r=[];t.startRow>=e.startRow&&r.push({startRow:e.startRow,startColumn:e.startColumn,endRow:t.startRow-1,endColumn:e.endColumn}),t.endRow<=e.endRow&&r.push({startRow:t.endRow+1,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn});let n=Math.max(e.startRow,t.startRow),o=Math.min(e.endRow,t.endRow);return t.startColumn>=e.startColumn&&r.push({startRow:n,startColumn:e.startColumn,endRow:o,endColumn:t.startColumn-1}),t.endColumn<=e.endColumn&&r.push({startRow:n,startColumn:t.endColumn+1,endRow:o,endColumn:e.endColumn}),r.filter(e=>e.startRow<=e.endRow&&e.startColumn<=e.endColumn)}static mergeRanges(e){return i0(e)}static subtractMulti(t,r){if(!r.length)return t;let n=t;return r.forEach(e=>{n=i1(n,e)}),e.mergeRanges(n)}static hasIntersectionBetweenTwoRect(e,t){return!(e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top)}static getIntersectionBetweenTwoRect(e,t){let r=Math.max(e.left,t.left),n=Math.min(e.right,t.right),o=Math.max(e.top,t.top),i=Math.min(e.bottom,t.bottom);return n<=r||i<=o?null:{left:r,right:n,top:o,bottom:i,width:n-r,height:i-o}}};e4(i2,"Rectangle"),e9(i2,"getRelativeRange",/* @__PURE__ */e4((e,t)=>({startRow:e.startRow-t.startRow,endRow:e.endRow-e.startRow,startColumn:e.startColumn-t.startColumn,endColumn:e.endColumn-e.startColumn}),"getRelativeRange")),e9(i2,"getPositionRange",/* @__PURE__ */e4((e,t,r)=>({...r||{},startRow:r&&[o5.ROW,o5.ALL].includes(r.startAbsoluteRefType||0)?r.startRow:e.startRow+t.startRow,endRow:r&&[o5.ROW,o5.ALL].includes(r.endAbsoluteRefType||0)?r.endRow:e.endRow+e.startRow+t.startRow,startColumn:r&&[o5.COLUMN,o5.ALL].includes(r.startAbsoluteRefType||0)?r.startColumn:e.startColumn+t.startColumn,endColumn:r&&[o5.COLUMN,o5.ALL].includes(r.endAbsoluteRefType||0)?r.endColumn:e.endColumn+e.startColumn+t.startColumn}),"getPositionRange")),e9(i2,"moveHorizontal",/* @__PURE__ */e4((e,t=0,r=0)=>({...e,startColumn:e.startColumn+t,endColumn:e.endColumn+t+r}),"moveHorizontal")),e9(i2,"moveVertical",/* @__PURE__ */e4((e,t=0,r=0)=>({...e,startRow:e.startRow+t,endRow:e.endRow+t+r}),"moveVertical")),e9(i2,"moveOffset",/* @__PURE__ */e4((e,t,r)=>({...e,startRow:e.startRow+r,endRow:e.endRow+r,startColumn:e.startColumn+t,endColumn:e.endColumn+t}),"moveOffset"));let i5=i2;function i3(e,t){if(0===e.length||0===e[0].length)return null;let r=Array(e[0].length).fill(0),n=0,o=null;for(let i=0;i<e.length;i++){for(let n=0;n<e[0].length;n++)r[n]=t(e[i][n])?r[n]+1:0;let s=i6(r);s.area>n&&(n=s.area,o={startColumn:s.start,startRow:i-s.height+1,endColumn:s.end,endRow:i})}return o}function i6(e){let t=[],r=0,n={area:0,height:0,start:0,end:0},o=0;for(;o<e.length;)if(0===t.length||e[o]>=e[t[t.length-1]])t.push(o++);else{let i=e[t.pop()],s=0===t.length?o:o-t[t.length-1]-1;i*s>r&&(n={area:r=i*s,height:i,start:0===t.length?0:t[t.length-1]+1,end:o-1})}for(;t.length>0;){let i=e[t.pop()],s=0===t.length?o:o-t[t.length-1]-1;i*s>r&&(n={area:r=i*s,height:i,start:0===t.length?0:t[t.length-1]+1,end:o-1})}return n}function i4(e,t){iq.foreach(t,(t,r)=>{e[t][r]=void 0})}function i9(e,t){let r=e.toFullArray(),n=[];for(;;){let e=i3(r,t);if(!e)break;n.push(e),i4(r,e)}return n}function i8(e,t,r,n){return{forEach(o){for(let i=e;i<=t;i++)for(let e=r;e<=n;e++)o(i,e)}}}function i7(e){let t="";for(;e>=0;)t=String.fromCharCode(e%26+65)+t,e=Math.floor(e/26)-1;return t}function se(e,t){let r="";for(;t>0;)r+=e,t--;return r}function st(e,t=!1){let r=97;return t&&(r=65),se(String.fromCharCode(e%26+r),Math.floor(e/26)+1)}function sr(e,t){return e.zIndex>t.zIndex?1:e.zIndex===t.zIndex?0:-1}function sn(e,t){return e.zIndex>t.zIndex?-1:e.zIndex===t.zIndex?0:1}function so(e="index",t=1){return(r,n)=>r[e]>n[e]?t:r[e]===n[e]?0:-t}e4(i3,"maximalRectangle"),e4(i6,"largestRectangleArea"),e4(i4,"resetMatrix"),e4(i9,"queryObjectMatrix"),e4(class{constructor(e,t){e9(this,"_values",[]),e9(this,"_keys",[]),e9(this,"_keyMaps",/* @__PURE__ */new Map),this._values=e,this._keys=t,e.forEach(e=>{this._initKeyMap(e)})}_initKeyMap(e){this._keys.forEach(t=>{let r=e[t],n=this._keyMaps.get(t)||/* @__PURE__ */new Map;n.set(r,e),this._keyMaps.set(t,n)})}getValue(e,t){let r=t||this._keys;for(let t=0;t<r.length;t++){let n=this._keyMaps.get(r[t]);if(null!=n&&n.has(e))return n.get(e)}return null}hasValue(e){for(let t=0;t<this._keys.length;t++){let r=this._keyMaps.get(this._keys[t]);if(null!=r&&r.has(e))return!0}return!1}addValue(e){this._values.push(e),this._initKeyMap(e)}setValue(e,t,r){let n=this.getValue(e);n&&Object.keys(n).includes(t)&&(n[t]=r)}deleteValue(e){let t=this.getValue(e);if(t){this._keys.forEach(e=>{let r=this._keyMaps.get(e),n=t[e];null==r||r.delete(n)});let e=this._values.findIndex(e=>e===t);this._values.splice(e,1)}}getValues(){return this._values}getKeyMap(e){var t;return[...(null==(t=this._keyMaps.get(e))?void 0:t.keys())||[]]}clear(){this._values=[],this._keys=[],this._keyMaps.clear()}},"RefAlias"),e4(i8,"createRowColIter"),e4(function(e){if(null==e||0===e.length)return Number.NaN;let t=e.toLowerCase().split(""),r=t.length,n=/* @__PURE__ */e4(e=>e.charCodeAt(0)-96,"getCharNumber"),o=0;for(let e=0;e<r;e++)o+=n(t[e])*26**(r-e-1);return 0===o?Number.NaN:o-1},"ABCToNumber"),e4(i7,"numberToABC"),e4(se,"repeatStringNumTimes"),e4(st,"numberToListABC"),e4(sr,"sortRules"),e4(sn,"sortRulesByDesc"),e4(so,"sortRulesFactory");var si=((V=si||{})[V.UNIVER_UNKNOWN=0]="UNIVER_UNKNOWN",V[V.UNIVER_DOC=1]="UNIVER_DOC",V[V.UNIVER_SHEET=2]="UNIVER_SHEET",V[V.UNIVER_SLIDE=3]="UNIVER_SLIDE",V[V.UNIVER_PROJECT=4]="UNIVER_PROJECT",V[V.UNRECOGNIZED=-1]="UNRECOGNIZED",V),ss=((z=ss||{})[z.Reader=0]="Reader",z[z.Editor=1]="Editor",z[z.Owner=2]="Owner",z[z.UNRECOGNIZED=-1]="UNRECOGNIZED",z),sa=((K=sa||{})[K.SomeCollaborator=0]="SomeCollaborator",K[K.AllCollaborator=1]="AllCollaborator",K[K.OneSelf=2]="OneSelf",K[K.UNRECOGNIZED=-1]="UNRECOGNIZED",K);let sl=class extends nn{};e4(sl,"UnitModel");let su=sl;function sc(e=oy.generateRandomId(6),t=nG.EN_US,r=""){return{id:e,locale:t,title:r,body:{dataStream:`\r
`,textRuns:[],paragraphs:[{startIndex:0,paragraphStyle:{spaceAbove:{v:5},lineSpacing:1,spaceBelow:{v:0}}}],sectionBreaks:[{startIndex:1}]},documentStyle:{pageSize:{width:793.3333333333334,height:1122.6666666666667},marginTop:50,marginBottom:50,marginRight:40,marginLeft:40,renderConfig:{vertexAngle:0,centerAngle:0}},settings:{}}}e4(sc,"getEmptySnapshot$1");var sd={},sh={},sp={};function sf(e,t){if(Array.isArray(t))return!1;for(let r in e)if(!sm(e[r],t[r]))return!1;for(let r in t)if(void 0===e[r])return!1;return!0}function sg(e,t){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!sm(e[r],t[r]))return!1;return!0}function sm(e,t){return e===t||null!==e&&null!==t&&"object"==typeof e&&"object"==typeof t&&(Array.isArray(e)?sg(e,t):sf(e,t))}Object.defineProperty(sp,"__esModule",{value:!0}),e4(sf,"eqObj"),e4(sg,"eqArr"),e4(sm,"deepEqual"),sp.default=sm;var s_={};function sy(e){if(null===e)return null;if(Array.isArray(e))return e.map(sy);if("object"!=typeof e)return e;{let t={};for(let r in e)t[r]=sy(e[r]);return t}}Object.defineProperty(s_,"__esModule",{value:!0}),e4(sy,"deepClone"),s_.default=sy;var sE={};!function(e){function t(e,t){if(!e)throw Error(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.eachChildOf=e.advancer=e.readCursor=e.writeCursor=e.WriteCursor=e.ReadCursor=e.isValidPathItem=void 0,e4(t,"assert");let r=/* @__PURE__ */e4(e=>null!=e&&"object"==typeof e&&!Array.isArray(e),"isObject"),n=/* @__PURE__ */e4((e,t)=>typeof e==typeof t?e>t:"string"==typeof e&&"number"==typeof t,"isGreaterKey");function o(e,t){for(let r in e)t.write(r,e[r])}e4(o,"copyAll"),e.isValidPathItem=e=>"number"==typeof e||"string"==typeof e&&"__proto__"!==e;let i=class{constructor(e=null){this.parents=[],this.indexes=[],this.lcIdx=-1,this.idx=-1,this.container=e}ascend(){t(this.parents.length===this.indexes.length/2),0===this.idx?this.parents.length?(this.lcIdx=this.indexes.pop(),this.container=this.parents.pop(),this.idx=this.indexes.pop()):(this.lcIdx=0,this.idx=-1):(t(this.idx>0),this.idx--,r(this.container[this.idx])&&this.idx--)}getPath(){let e=[],t=this.container,n=this.parents.length-1,o=this.idx;for(;o>=0;)e.unshift(t[o]),0===o?(o=this.indexes[2*n],t=this.parents[n--]):o-=r(t[o-1])?2:1;return e}};e4(i,"Cursor");let s=i,a=class e extends s{get(){return this.container?this.container.slice(this.idx+1):null}getKey(){return t(null!=this.container,"Invalid call to getKey before cursor descended"),this.container[this.idx]}getComponent(){let e;return this.container&&this.container.length>this.idx+1&&r(e=this.container[this.idx+1])?e:null}descendFirst(){let e=this.idx+1;if(!this.container||e>=this.container.length||r(this.container[e])&&e+1>=this.container.length)return!1;r(this.container[e])&&e++;let t=this.container[e];return Array.isArray(t)?(this.indexes.push(this.idx),this.parents.push(this.container),this.indexes.push(e),this.idx=0,this.container=t):this.idx=e,!0}nextSibling(){if(t(this.parents.length===this.indexes.length/2),this.idx>0||0===this.parents.length)return!1;let e=this.indexes[this.indexes.length-1]+1,r=this.parents[this.parents.length-1];return!(e>=r.length)&&(t(!isNaN(e)),this.indexes[this.indexes.length-1]=e,this.container=r[e],!0)}_init(e,t,r,n){this.container=e,this.idx=t,this.parents=r.slice(),this.indexes=n.slice()}clone(){let t=new e;return t._init(this.container,this.idx,this.parents,this.indexes),t}*[Symbol.iterator](){if(this.descendFirst()){do yield this.getKey();while(this.nextSibling())this.ascend()}}traverse(e,t){let r=this.getComponent();for(let n of(r&&t(r,e),this))e&&e.descend(n),this.traverse(e,t),e&&e.ascend()}eachPick(e,t){this.traverse(e,(e,r)=>{null!=e.p&&t(e.p,r)})}eachDrop(e,t){this.traverse(e,(e,r)=>{null!=e.d&&t(e.d,r)})}};e4(a,"ReadCursor"),e.ReadCursor=a;let l=class extends s{constructor(e=null){super(e),this.pendingDescent=[],this._op=e}flushDescent(){t(this.parents.length===this.indexes.length/2),null===this.container&&(this._op=this.container=[]);for(let e=0;e<this.pendingDescent.length;e++){let o=this.pendingDescent[e],i=this.idx+1;if(i<this.container.length&&r(this.container[i])&&i++,t(i===this.container.length||!r(this.container[i])),i===this.container.length)this.container.push(o),this.idx=i;else if(this.container[i]===o)this.idx=i;else{if(!Array.isArray(this.container[i])){let e=this.container.splice(i,this.container.length-i);this.container.push(e),this.lcIdx>-1&&(this.lcIdx=i)}for(this.indexes.push(this.idx),this.parents.push(this.container),-1!==this.lcIdx&&(t(n(o,this.container[this.lcIdx][0])),i=this.lcIdx+1,this.lcIdx=-1);i<this.container.length&&n(o,this.container[i][0]);)i++;if(this.indexes.push(i),this.idx=0,i<this.container.length&&this.container[i][0]===o)this.container=this.container[i];else{let e=[o];this.container.splice(i,0,e),this.container=e}}}this.pendingDescent.length=0}reset(){this.lcIdx=-1}getComponent(){this.flushDescent();let e=this.idx+1;if(e<this.container.length&&r(this.container[e]))return this.container[e];{let t={};return this.container.splice(e,0,t),t}}write(e,r){let n=this.getComponent();t(null==n[e]||n[e]===r,"Internal consistency error: Overwritten component. File a bug"),n[e]=r}get(){return this._op}descend(t){if(!e.isValidPathItem(t))throw Error("Invalid JSON key");this.pendingDescent.push(t)}descendPath(e){return this.pendingDescent.push(...e),this}ascend(){this.pendingDescent.length?this.pendingDescent.pop():super.ascend()}mergeTree(e,r=o){if(null===e)return;if(t(Array.isArray(e)),e===this._op)throw Error("Cannot merge into my own tree");let n=this.lcIdx,i=this.parents.length,s=0;for(let t=0;t<e.length;t++){let n=e[t];"string"==typeof n||"number"==typeof n?(s++,this.descend(n)):Array.isArray(n)?this.mergeTree(n,r):"object"==typeof n&&r(n,this)}for(;s--;)this.ascend();this.lcIdx=this.parents.length===i?n:-1}at(e,t){this.descendPath(e),t(this);for(let t=0;t<e.length;t++)this.ascend();return this}writeAtPath(e,t,r){return this.at(e,()=>this.write(t,r)),this.reset(),this}writeMove(e,t,r=0){return this.writeAtPath(e,"p",r).writeAtPath(t,"d",r)}getPath(){let e=super.getPath();return e.push(...this.pendingDescent),e}};function u(e,t,r){let o,i;function s(o){let s;for(;i;){let a=s=e.getKey();if(null!=o){let r=!1;if(t&&"number"==typeof a&&(s=t(a,e.getComponent()))<0&&(s=~s,r=!0),n(s,o))return null;if(s===o&&!r)return e}r&&"number"==typeof s&&r(s,e.getComponent()),i=e.nextSibling()}return null}return i=o=!!e&&e.descendFirst(),e4(s,"adv"),s.end=()=>{o&&e.ascend()},s}function c(e,t,r){let o,i,s,a;for(o=i=e&&e.descendFirst(),s=a=t&&t.descendFirst();o||s;){let i=o?e.getKey():null,a=s?t.getKey():null;null!==i&&null!==a&&(n(a,i)?a=null:i!==a&&(i=null)),r(null==i?a:i,null!=i?e:null,null!=a?t:null),null!=i&&o&&(o=e.nextSibling()),null!=a&&s&&(s=t.nextSibling())}i&&e.ascend(),a&&t.ascend()}e4(l,"WriteCursor"),e.WriteCursor=l,e.writeCursor=()=>new l,e.readCursor=e=>new a(e),e4(u,"advancer"),e.advancer=u,e4(c,"eachChildOf"),e.eachChildOf=c}(sE);var sb={};Object.defineProperty(sb,"__esModule",{value:!0}),sb.ConflictType=void 0,(sN=sb.ConflictType||(sb.ConflictType={}))[sN.RM_UNEXPECTED_CONTENT=1]="RM_UNEXPECTED_CONTENT",sN[sN.DROP_COLLISION=2]="DROP_COLLISION",sN[sN.BLACKHOLE=3]="BLACKHOLE";var sv,sR,sT,sI,sC,sS,sO,sx,sA,sw,sN,sD,sL,sM,sU,sP,sk={},sF={};function sj(){return sP||(sP=1,Object.defineProperty(sF,"__esModule",{value:!0}),sF.uniToStrPos=sF.strPosToUni=void 0,sF.strPosToUni=(e,t=e.length)=>{let r=0,n=0;for(;n<t;n++){let t=e.charCodeAt(n);t>=55296&&t<=57343&&(r++,n++)}if(n!==t)throw Error("Invalid offset - splits unicode bytes");return n-r},sF.uniToStrPos=(e,t)=>{let r=0;for(;t>0;t--){let t=e.charCodeAt(r);r+=t>=55296&&t<=57343?2:1}return r}),sF}e4(sj,"requireUnicount");var sB,sH={};function s$(){return sB||(sB=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.uniSlice=e.dlen=e.eachOp=void 0;let t=sj(),r=/* @__PURE__ */e4(t=>{if(!Array.isArray(t))throw Error("Op must be an array of components");let r=null;for(let n=0;n<t.length;n++){let o=t[n];switch(typeof o){case"object":if("number"!=typeof o.d&&"string"!=typeof o.d)throw Error("Delete must be number or string");if(0>=e.dlen(o.d))throw Error("Deletes must not be empty");break;case"string":if(!(o.length>0))throw Error("Inserts cannot be empty");break;case"number":if(!(o>0))throw Error("Skip components must be >0");if("number"==typeof r)throw Error("Adjacent skip components should be combined")}r=o}if("number"==typeof r)throw Error("Op has a trailing skip")},"checkOp");function n(r,n){let o=0,i=0;for(let s=0;s<r.length;s++){let a=r[s];switch(n(a,o,i),typeof a){case"object":o+=e.dlen(a.d);break;case"string":i+=t.strPosToUni(a);break;case"number":o+=a,i+=a}}}function o(e,t){let r=[],o=a(r);return n(e,(e,r,n)=>{o(t(e,r,n))}),d(r)}e4(n,"eachOp"),e.eachOp=n,e4(o,"mapOp");let i=/* @__PURE__ */e4(e=>e,"id"),s=/* @__PURE__ */e4(e=>o(e,i),"normalize");e.dlen=e=>"number"==typeof e?e:t.strPosToUni(e);let a=/* @__PURE__ */e4(t=>r=>{if(!(!r||0===r.d||""===r.d)){if(0===t.length)t.push(r);else if(typeof r==typeof t[t.length-1]){if("object"==typeof r){let n=t[t.length-1];n.d="string"==typeof n.d&&"string"==typeof r.d?n.d+r.d:e.dlen(n.d)+e.dlen(r.d)}else t[t.length-1]+=r}else t.push(r)}},"makeAppend"),l=/* @__PURE__ */e4(e=>"number"==typeof e?e:"string"==typeof e?t.strPosToUni(e):"number"==typeof e.d?e.d:t.strPosToUni(e.d),"componentLength");e.uniSlice=(e,r,n)=>{let o=t.uniToStrPos(e,r),i=null==n?1/0:t.uniToStrPos(e,n);return e.slice(o,i)};let u=/* @__PURE__ */e4((t,r,n)=>"number"==typeof t?null==n?t-r:Math.min(t,n)-r:e.uniSlice(t,r,n),"dslice"),c=/* @__PURE__ */e4(r=>{let n=0,o=0;return{take:/* @__PURE__ */e4((i,s)=>{let a;if(n===r.length)return -1===i?null:i;let l=r[n];if("number"==typeof l)return -1===i||l-o<=i?(a=l-o,++n,o=0,a):(o+=i,i);if("string"==typeof l){if(-1===i||"i"===s||t.strPosToUni(l.slice(o))<=i)return a=l.slice(o),++n,o=0,a;{let e=o+t.uniToStrPos(l.slice(o),i);return a=l.slice(o,e),o=e,a}}if(-1===i||"d"===s||e.dlen(l.d)-o<=i)return a={d:u(l.d,o)},++n,o=0,a;{let e=u(l.d,o,o+i);return o+=i,{d:e}}},"take"),peek:/* @__PURE__ */e4(()=>r[n],"peek")}},"makeTake"),d=/* @__PURE__ */e4(e=>(e.length>0&&"number"==typeof e[e.length-1]&&e.pop(),e),"trim");function h(n,o,i){let s;if("left"!==i&&"right"!==i)throw Error("side ("+i+") must be 'left' or 'right'");r(n),r(o);let u=[],h=a(u),{take:p,peek:f}=c(n);for(let r=0;r<o.length;r++){let n,s;let a=o[r];switch(typeof a){case"number":for(n=a;n>0;)h(s=p(n,"i")),"string"!=typeof s&&(n-=l(s));break;case"string":"left"===i&&"string"==typeof f()&&h(p(-1)),h(t.strPosToUni(a));break;case"object":for(n=e.dlen(a.d);n>0;)switch(typeof(s=p(n,"i"))){case"number":n-=s;break;case"string":h(s);break;case"object":n-=e.dlen(s.d)}}}for(;s=p(-1);)h(s);return d(u)}function p(n,o){let i;r(n),r(o);let s=[],h=a(s),{take:p}=c(n);for(let r=0;r<o.length;r++){let n,i;let s=o[r];switch(typeof s){case"number":for(n=s;n>0;)h(i=p(n,"d")),"object"!=typeof i&&(n-=l(i));break;case"string":h(s);break;case"object":n=e.dlen(s.d);let a=0;for(;a<n;)switch(typeof(i=p(n-a,"d"))){case"number":h({d:u(s.d,a,a+i)}),a+=i;break;case"string":a+=t.strPosToUni(i);break;case"object":h(i)}}}for(;i=p(-1);)h(i);return d(s)}e4(h,"transform"),e4(p,"compose");let f=/* @__PURE__ */e4((r,n)=>{let o=0;for(let i=0;i<n.length&&r>o;i++){let s=n[i];switch(typeof s){case"number":o+=s;break;case"string":let a=t.strPosToUni(s);o+=a,r+=a;break;case"object":r-=Math.min(e.dlen(s.d),r-o)}}return r},"transformPosition"),g=/* @__PURE__ */e4((e,t)=>"number"==typeof e?f(e,t):e.map(e=>f(e,t)),"transformSelection");function m(e,t,r){return o(e,(e,n)=>"object"==typeof e&&"number"==typeof e.d?{d:r.slice(t,n,n+e.d)}:e)}function _(e){return o(e,e=>{switch(typeof e){case"object":if("number"==typeof e.d)throw Error("Cannot invert text op: Deleted characters missing from operation. makeInvertible must be called first.");return e.d;case"string":return{d:e};case"number":return e}})}function y(e){return o(e,e=>"object"==typeof e&&"string"==typeof e.d?{d:t.strPosToUni(e.d)}:e)}function E(e){let t=!0;return n(e,e=>{"object"==typeof e&&"number"==typeof e.d&&(t=!1)}),t}function b(t){return{name:"text-unicode",uri:"http://sharejs.org/types/text-unicode",trim:d,normalize:s,checkOp:r,create(e=""){if("string"!=typeof e)throw Error("Initial data must be a string");return t.create(e)},apply(n,o){r(o);let i=t.builder(n);for(let t=0;t<o.length;t++){let r=o[t];switch(typeof r){case"number":i.skip(r);break;case"string":i.append(r);break;case"object":i.del(e.dlen(r.d))}}return i.build()},transform:h,compose:p,transformPosition:f,transformSelection:g,isInvertible:E,makeInvertible:(e,r)=>m(e,r,t),stripInvertible:y,invert:_,invertWithDoc:(e,r)=>_(m(e,r,t)),isNoop:/* @__PURE__ */e4(e=>0===e.length,"isNoop")}}e4(m,"makeInvertible"),e4(_,"invert"),e4(y,"stripInvertible"),e4(E,"isInvertible"),e4(b,"makeType"),e.default=b}(sH)),sH}e4(s$,"requireType");var sG,sW={};function sV(){if(sG)return sW;sG=1,Object.defineProperty(sW,"__esModule",{value:!0});let e=s$(),t=sj();function r(r,n){return{get:r,getLength:()=>r().length,insert:(e,o,i)=>n([t.strPosToUni(r(),e),o],i),remove:(e,o,i)=>n([t.strPosToUni(r(),e),{d:o}],i),_onOp(t){e.eachOp(t,(t,r,n)=>{switch(typeof t){case"string":this.onInsert&&this.onInsert(n,t);break;case"object":let o=e.dlen(t.d);this.onRemove&&this.onRemove(n,o)}})},onInsert:null,onRemove:null}}return e4(r,"api$1"),sW.default=r,r.provides={text:!0},sW}function sz(){return l4||(l4=1,function(e){var t=oo&&oo.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:/* @__PURE__ */e4(function(){return t[r]},"get")})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=oo&&oo.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=oo&&oo.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var o in e)Object.hasOwnProperty.call(e,o)&&t(n,e,o);return r(n,e),n},o=oo&&oo.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.type=e.remove=e.insert=void 0;let i=sj(),s=n(s$()),a=o(sV()),l={create:e=>e,toString:e=>e,builder(e){if("string"!=typeof e)throw Error("Invalid document snapshot: "+e);let t=[];return{skip(r){let n=i.uniToStrPos(e,r);if(n>e.length)throw Error("The op is too long for this document");t.push(e.slice(0,n)),e=e.slice(n)},append(e){t.push(e)},del(t){e=e.slice(i.uniToStrPos(e,t))},build:()=>t.join("")+e}},slice:s.uniSlice},u=Object.assign(Object.assign({},s.default(l)),{api:a.default});e.type=u,e.insert=(e,t)=>0===t.length?[]:0===e?[t]:[e,t],e.remove=(e,t)=>0===s.dlen(t)?[]:0===e?[{d:t}]:[e,{d:t}];var c=s$();Object.defineProperty(e,"makeType",{enumerable:!0,get:/* @__PURE__ */e4(function(){return c.default},"get")})}(sk)),sk}e4(sV,"requireApi"),e4(sz,"requireDist"),function(e){var t=oo&&oo.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.editOp=e.replaceOp=e.insertOp=e.moveOp=e.removeOp=e.type=void 0,t(sp);let r=t(s_);function n(e,t){if(!e)throw Error(t)}e4(n,"assert"),e.type={name:"json1",uri:"http://sharejs.org/types/JSONv1",readCursor:sE.readCursor,writeCursor:sE.writeCursor,create:/* @__PURE__ */e4(e=>e,"create"),isNoop:/* @__PURE__ */e4(e=>null==e,"isNoop"),setDebug(e){},registerSubtype:f,checkValidOp:R,normalize:T,apply:I,transformPosition:C,compose:S,tryTransform:D,transform:M,makeInvertible:A,invert:O,invertWithDoc:w,RM_UNEXPECTED_CONTENT:sb.ConflictType.RM_UNEXPECTED_CONTENT,DROP_COLLISION:sb.ConflictType.DROP_COLLISION,BLACKHOLE:sb.ConflictType.BLACKHOLE,transformNoConflict:/* @__PURE__ */e4((e,t,r)=>k(()=>!0,e,t,r),"transformNoConflict"),typeAllowingConflictsPred:/* @__PURE__ */e4(t=>Object.assign(Object.assign({},e.type),{transform:/* @__PURE__ */e4((e,r,n)=>k(t,e,r,n),"transform")}),"typeAllowingConflictsPred")};let o=/* @__PURE__ */e4(e=>e?e.getComponent():null,"getComponent");function i(e){return e&&"object"==typeof e&&!Array.isArray(e)}e4(i,"isObject");let s=/* @__PURE__ */e4(e=>Array.isArray(e)?e.slice():null!==e&&"object"==typeof e?Object.assign({},e):e,"shallowClone"),a=/* @__PURE__ */e4(e=>e&&(null!=e.p||void 0!==e.r),"hasPick"),l=/* @__PURE__ */e4(e=>e&&(null!=e.d||void 0!==e.i),"hasDrop");function u(e,t){return n(null!=e),"number"==typeof t?(n(Array.isArray(e),"Invalid key - child is not an array"),(e=e.slice()).splice(t,1)):(n(i(e),"Invalid key - child is not an object"),delete(e=Object.assign({},e))[t]),e}function c(e,t,r){return"number"==typeof t?(n(null!=e,"Container is missing for key"),n(Array.isArray(e),"Cannot use numerical key for object container"),n(e.length>=t,"Cannot insert into out of bounds index"),e.splice(t,0,r)):(n(i(e),"Cannot insert into missing item"),n(void 0===e[t],"Trying to overwrite value at key. Your op needs to remove it first"),e[t]=r),r}e4(u,"removeChild"),e4(c,"insertChildMut"),e.removeOp=(e,t=!0)=>sE.writeCursor().writeAtPath(e,"r",t).get(),e.moveOp=(e,t)=>sE.writeCursor().writeMove(e,t).get(),e.insertOp=(e,t)=>sE.writeCursor().writeAtPath(e,"i",t).get(),e.replaceOp=(e,t,r)=>sE.writeCursor().at(e,e=>{e.write("r",t),e.write("i",r)}).get(),e.editOp=(e,t,r,n=!1)=>sE.writeCursor().at(e,e=>E(e,t,r,n)).get();let d=/* @__PURE__ */e4((e,t)=>null!=e&&("number"==typeof t?Array.isArray(e):"object"==typeof e),"isValidKey"),h=/* @__PURE__ */e4((e,t)=>d(e,t)?e[t]:void 0,"maybeGetChild"),p={};function f(e){let t=e.type?e.type:e;t.name&&(p[t.name]=t),t.uri&&(p[t.uri]=t)}e4(f,"registerSubtype");let g=/* @__PURE__ */e4(e=>{let t=p[e];if(t)return t;throw Error("Missing type: "+e)},"typeOrThrow");f(sz());let m=/* @__PURE__ */e4((e,t)=>e+t,"add");f({name:"number",apply:m,compose:m,invert:/* @__PURE__ */e4(e=>-e,"invert"),transform:/* @__PURE__ */e4(e=>e,"transform")});let _=/* @__PURE__ */e4(e=>null==e?null:e.et?g(e.et):e.es?p["text-unicode"]:null!=e.ena?p.number:null,"getEditType"),y=/* @__PURE__ */e4(e=>e.es?e.es:null!=e.ena?e.ena:e.e,"getEdit"),E=/* @__PURE__ */e4((e,t,r,n=!1)=>{let[o,i]="string"==typeof t?[g(t),t]:[t,t.name];!n&&o.isNoop&&o.isNoop(r)||("number"===i?e.write("ena",r):"text-unicode"===i?e.write("es",r):(e.write("et",i),e.write("e",r)))},"writeEdit");function b(e){n("number"==typeof e),n(e>=0),n(e===(0|e))}function v(e){"number"==typeof e?b(e):n("string"==typeof e)}function R(e){if(null===e)return;let t=/* @__PURE__ */new Set,r=/* @__PURE__ */new Set,o=/* @__PURE__ */e4(e=>{let o=!0,i=!1;for(let s in e){let a=e[s];if(o=!1,n("p"===s||"r"===s||"d"===s||"i"===s||"e"===s||"es"===s||"ena"===s||"et"===s,"Invalid component item '"+s+"'"),"p"===s)b(a),n(!t.has(a)),t.add(a),n(void 0===e.r);else if("d"===s)b(a),n(!r.has(a)),r.add(a),n(void 0===e.i);else if("e"===s||"es"===s||"ena"===s){n(!i),i=!0;let t=_(e);n(t,"Missing type in edit"),t.checkValidOp&&t.checkValidOp(y(e))}}n(!o)},"checkComponent"),i=/* @__PURE__ */e4((e,t,r)=>{if(!Array.isArray(e))throw Error("Op must be null or a list");if(0===e.length)throw Error("Empty descent");t||v(e[0]);let s=1,a=0,l=0;for(let t=0;t<e.length;t++){let r=e[t];if(n(null!=r),Array.isArray(r)){let e=i(r,!1);if(a){let t=typeof l,r=typeof e;t===r?n(l<e,"descent keys are not in order"):n("number"===t&&"string"===r)}l=e,a++,s=3}else"object"==typeof r?(n(1===s,`Prev not scalar - instead ${s}`),o(r),s=2):(n(3!==s),v(r),n(sE.isValidPathItem(r),"Invalid path key"),s=1)}return n(1!==a,"Operation makes multiple descents. Remove some []"),n(2===s||3===s),e[0]},"checkDescent");i(e,!0),n(t.size===r.size,"Mismatched picks and drops in op");for(let e=0;e<t.size;e++)n(t.has(e)),n(r.has(e))}function T(e){let t=0,r=[],n=sE.writeCursor();return n.mergeTree(e,(e,n)=>{var o;let i=_(e);if(i){let t=y(e);E(n,i,i.normalize?i.normalize(t):t)}for(let i of["r","p","i","d"])if(void 0!==e[i]){let s="p"===i||"d"===i?(null==r[o=e[i]]&&(r[o]=t++),r[o]):e[i];n.write(i,s)}}),n.get()}function I(e,t){if(R(t),null===t)return e;let r=[];return /* @__PURE__ */e4(function e(t,o){let i=t,a=0,l={root:t},u=0,p=l,f="root";function g(){for(;u<a;u++){let e=o[u];"object"!=typeof e&&(n(d(p,f)),p=p[f]=s(p[f]),f=e)}}for(e4(g,"mut");a<o.length;a++){let t=o[a];if(Array.isArray(t)){let r=e(i,t);r!==i&&void 0!==r&&(g(),i=p[f]=r)}else if("object"==typeof t){null!=t.d?(g(),i=c(p,f,r[t.d])):void 0!==t.i&&(g(),i=c(p,f,t.i));let e=_(t);if(e)g(),i=p[f]=e.apply(i,y(t));else if(void 0!==t.e)throw Error("Subtype "+t.et+" undefined")}else i=h(i,t)}return l.root},"drop")(e=/* @__PURE__ */e4(function e(t,o){var i,l;let c=[],d=0;for(;d<o.length;d++){let e=o[d];if(Array.isArray(e))break;"object"!=typeof e&&(c.push(t),t=h(t,e))}for(let r=o.length-1;r>=d;r--)t=e(t,o[r]);for(--d;d>=0;d--){let e=o[d];if("object"!=typeof e){let r=c.pop();t=t===h(r,e)?r:void 0===t?u(r,e):(l=t,(i=s(i=r))[e]=l,i)}else a(e)&&(n(void 0!==t,"Cannot pick up or remove undefined"),null!=e.p&&(r[e.p]=t),t=void 0)}return t},"pick")(e,t),t)}function C(e,t){e=e.slice(),R(t);let r=sE.readCursor(t),n,i,s=!1,u=[];for(let t=0;;t++){let o=e[t],l=r.getComponent();if(l&&(void 0!==l.r?s=!0:null!=l.p&&(s=!1,n=l.p,i=t)),t>=e.length)break;let c=0,d=sE.advancer(r,void 0,(e,t)=>{a(t)&&c++});u.unshift(d);let h=d(o);if("number"==typeof o&&(e[t]-=c),!h)break}if(u.forEach(e=>e.end()),s)return null;let c=/* @__PURE__ */e4(()=>{let t=0;if(null!=n){let n=r.getPath();t=n.length,e=n.concat(e.slice(i))}for(;t<e.length;t++){let n=e[t],i=o(r),s=_(i);if(s){let r=y(i);s.transformPosition&&(e[t]=s.transformPosition(e[t],r));break}let a=0,u=sE.advancer(r,(e,t)=>l(t)?~(e-a):e-a,(e,t)=>{l(t)&&a++})(n);if("number"==typeof n&&(e[t]+=a),!u)break}},"handleDrop");return null!=n?r.eachDrop(null,e=>{e===n&&c()}):c(),e}function S(e,t){if(R(e),R(t),null==e)return t;if(null==t)return e;let r=sE.readCursor(e),n=sE.readCursor(t),o=sE.writeCursor(),i=[],s=[],a=[],l=[],u=[],c=[],d=/* @__PURE__ */new Set;r.traverse(null,e=>{null!=e.p&&(a[e.p]=r.clone())}),n.traverse(null,e=>{null!=e.d&&(l[e.d]=n.clone())});let h=sE.writeCursor();return /* @__PURE__ */r.clone(),n.clone(),o.reset(),o.mergeTree(h.get()),o.reset(),o.get(),i.map(e=>e.get()),s.map(e=>e.get()),r.traverse(o,(e,t)=>{let r=e.p;if(null!=r){let e=u[r];null!=e&&t.write("p",e);let n=i[r];n&&n.get(),n&&t.mergeTree(n.get())}else void 0!==e.r&&t.write("r",e.r)}),o.reset(),o.get(),n.traverse(o,(e,t)=>{let r=e.d;if(null!=r){let e=c[r];null!=e&&t.write("d",e);let n=s[r];n&&t.mergeTree(n.get())}else void 0!==e.i&&t.write("i",e.i);let n=_(e);n&&!d.has(e)&&E(t,n,y(e))}),o.get()}function O(e){let t;if(null==e)return null;let r=new sE.ReadCursor(e),n=new sE.WriteCursor,o=[];return /* @__PURE__ */t&&(n.reset(),/* @__PURE__ */r.clone(),o.length&&(n.reset(),r.traverse(n,(e,t)=>{let r=e.p;if(null!=r){let e=o[r];e&&e.get(),e&&t.mergeTree(e.get())}}))),n.get()}e4(b,"checkNonNegInteger"),e4(v,"checkScalar"),e4(R,"checkValidOp"),e4(T,"normalize"),e4(I,"apply"),e4(C,"transformPosition"),e4(S,"compose"),e4(O,"invert");let x=/* @__PURE__ */e4((e,t)=>e.some(e=>"object"==typeof e&&(Array.isArray(e)?x(e,t):t(e))),"anyComponent");function A(e,t){if(null==e||!x(e,e=>{var t;return void 0!==e.r||(null===(t=_(e))||void 0===t?void 0:t.makeInvertible)!=null}))return e;let o=new sE.ReadCursor(e),i=new sE.WriteCursor,a=!1,l=[],c=[],d=/* @__PURE__ */e4((e,t,o)=>{let i=e.getComponent(),p=!1;if(i){null!=i.d&&t.write("d",i.d),void 0!==i.i&&t.write("i",i.i);let r=i.p;if(null!=r&&(l[r]=e.clone(),n(void 0!==o,"Operation picks up at an invalid key"),c[r]=o,t.write("p",i.p)),void 0!==i.r&&void 0===o)throw Error("Invalid doc / op in makeInvertible: removed item missing from doc");let s=_(i);s&&(s.makeInvertible?a=!0:E(t,s,y(i),!0))}let f=0;for(let r of e){t.descend(r);let n="number"==typeof r?r-f:r,i=h(o,n),a=d(e,t,i);i!==a&&(p||(p=!0,o=s(o)),void 0===a?(o=u(o,n),"number"==typeof r&&f++):o[n]=a),t.ascend()}return i&&(void 0!==i.r?(t.write("r",r.default(o)),o=void 0):null!=i.p&&(o=void 0)),o},"traversePick");return d(o,i,t),i.get(),a&&(i.reset(),/* @__PURE__ */o.clone()),i.get()}function w(e,t){return O(A(e,t))}e4(A,"makeInvertible"),e4(w,"invertWithDoc");let N=/* @__PURE__ */e4(e=>{if(null==e)return null;let t=e.slice();for(let r=0;r<e.length;r++){let e=t[r];Array.isArray(e)&&(t[r]=N(e))}return t},"shallowCloneOp");function D(e,t,r){n("left"===r||"right"===r,"Direction must be left or right");let o="left"===r?0:1;if(null==t)return{ok:!0,result:e};R(e),R(t);let i=null,s=[],a=[],l=[],u=[],c=[],d=[],h=[],p=[],f=[],g=[],m=sE.readCursor(e),_=sE.readCursor(t),y=sE.writeCursor();if(/* @__PURE__ *//* @__PURE__ */_.clone(),u.map(e=>e&&e.get()),i)return{ok:!1,conflict:i};d.map(e=>!!e),/* @__PURE__ */_.clone(),y.reset();let E=[];if(/* @__PURE__ */m.clone(),_.clone(),i)return{ok:!1,conflict:i};y.reset();let b=/* @__PURE__ */e4((e,t,r)=>e.traverse(t,(t,n)=>{null!=t.d&&r(t.d,e,n)}),"eachDrop");(c.length||h.length)&&(b(_,y,(e,t,r)=>{c[e]&&!d[e]&&r.write("r",!0),h[e]&&r.mergeTree(h[e].get())}),y.reset());let v=[],T=[];if((p.length||c.length)&&!i){let e=sE.readCursor(N(y.get()));if(b(e,null,(e,t)=>{v[e]=t.clone()}),p.forEach(e=>{e&&b(sE.readCursor(e.get()),null,(e,t)=>{v[e]=t.clone()})}),/* @__PURE__ */e.clone(),y.reset(),i)return{ok:!1,conflict:i};if(y.get(),T.length){let e=T.map(e=>e?e.get():null);if(b(sE.readCursor(N(y.get())),y,(t,r,n)=>{let o=e[t];o&&(n.mergeTree(o),e[t]=null)}),e.find(e=>e)){let t=sE.writeCursor(),r=sE.writeCursor(),n=0,d=0;e.forEach(e=>{null!=e&&b(sE.readCursor(e),null,e=>{let i=E[e];t.writeMove(s[i].getPath(),a[i].getPath(),n++);let h=g[i];h&&h.forEach(e=>{c[e]||1!==o&&null!=f[e]||r.writeMove(l[e].getPath(),u[e].getPath(),d++)})})}),i={type:sb.ConflictType.BLACKHOLE,op1:t.get(),op2:r.get()}}}}return i?{ok:!1,conflict:i}:{ok:!0,result:y.get()}}e4(D,"tryTransform");let L=/* @__PURE__ */e4(e=>{let t=Error("Transform detected write conflict");throw t.conflict=e,t.type=t.name="writeConflict",t},"throwConflictErr");function M(e,t,r){let n=D(e,t,r);if(n.ok)return n.result;L(n.conflict)}e4(M,"transform");let U=/* @__PURE__ */e4(e=>{let t=sE.writeCursor();return sE.readCursor(e).traverse(t,(e,t)=>{(l(e)||_(e))&&t.write("r",!0)}),t.get()},"opThatRemovesDE"),P=/* @__PURE__ */e4((e,t)=>{let{type:r,op1:n,op2:o}=e;switch(r){case sb.ConflictType.DROP_COLLISION:return"left"===t?[null,U(o)]:[U(n),null];case sb.ConflictType.RM_UNEXPECTED_CONTENT:let i=!1;return sE.readCursor(n).traverse(null,e=>{void 0!==e.r&&(i=!0)}),i?[null,U(o)]:[U(n),null];case sb.ConflictType.BLACKHOLE:return[U(n),U(o)];default:throw Error("Unrecognised conflict: "+r)}},"resolveConflict");function k(e,t,r,n){let o=null;for(;;){let i=D(t,r,n);if(i.ok)return S(o,i.result);{let{conflict:s}=i;e(s)||L(s);let[a,l]=P(s,n);t=S(T(t),a),r=S(T(r),l),o=S(o,l)}}}e4(k,"transformWithConflictsPred")}(sh),l3=oo&&oo.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:/* @__PURE__ */e4(function(){return t[r]},"get")})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),l6=oo&&oo.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||l3(t,e,r)},Object.defineProperty(sd,"__esModule",{value:!0}),l6(sh,sd),Object.defineProperty(sd,"ReadCursor",{enumerable:!0,get:/* @__PURE__ */e4(function(){return sE.ReadCursor},"get")}),Object.defineProperty(sd,"WriteCursor",{enumerable:!0,get:/* @__PURE__ */e4(function(){return sE.WriteCursor},"get")}),Object.defineProperty(sd,"ConflictType",{enumerable:!0,get:/* @__PURE__ */e4(function(){return sb.ConflictType},"get")});var sK=((Y=sK||{}).RETAIN="r",Y.INSERT="i",Y.DELETE="d",Y),sY=((q=sY||{}).PARAGRAPH="PARAGRAPH",q.SECTION_BREAK="SECTION_BREAK",q.TABLE="TABLE",q.TABLE_ROW="TABLE_ROW",q.TABLE_CELL="TABLE_CELL",q.CUSTOM_BLOCK="CUSTOM_BLOCK",q),sq=((J=sq||{}).PARAGRAPH="\r",J.SECTION_BREAK=`
`,J.TABLE_START="\x1a",J.TABLE_ROW_START="\x1b",J.TABLE_CELL_START="\x1c",J.TABLE_CELL_END="\x1d",J.TABLE_ROW_END="\x0e",J.TABLE_END="\x0f",J.CUSTOM_RANGE_START="\x1f",J.CUSTOM_RANGE_END="\x1e",J.COLUMN_BREAK="\v",J.PAGE_BREAK="\f",J.DOCS_END="\0",J.TAB="	",J.CUSTOM_BLOCK="\b",J.LETTER="",J.SPACE=" ",J);e4(function(e){return`${e}`},"makeCustomRangeStream");var sJ=((X=sJ||{})[X.character=0]="character",X[X.paragraph=1]="paragraph",X[X.table=2]="table",X[X.numbering=3]="numbering",X),sX=((Q=sX||{})[Q.TAB=0]="TAB",Q[Q.SPACE=1]="SPACE",Q[Q.NOTHING=2]="NOTHING",Q),sQ=((Z=sQ||{})[Z.BULLET=0]="BULLET",Z[Z.NONE=1]="NONE",Z[Z.DECIMAL=2]="DECIMAL",Z[Z.DECIMAL_ZERO=3]="DECIMAL_ZERO",Z[Z.UPPER_LETTER=4]="UPPER_LETTER",Z[Z.LOWER_LETTER=5]="LOWER_LETTER",Z[Z.UPPER_ROMAN=6]="UPPER_ROMAN",Z[Z.LOWER_ROMAN=7]="LOWER_ROMAN",Z[Z.ORDINAL=8]="ORDINAL",Z[Z.CARDINAL_TEXT=9]="CARDINAL_TEXT",Z[Z.ORDINAL_TEXT=10]="ORDINAL_TEXT",Z[Z.HEX=11]="HEX",Z[Z.CHICAGO=12]="CHICAGO",Z[Z.IDEOGRAPH_DIGITAL=13]="IDEOGRAPH_DIGITAL",Z[Z.JAPANESE_COUNTING=14]="JAPANESE_COUNTING",Z[Z.AIUEO=15]="AIUEO",Z[Z.IROHA=16]="IROHA",Z[Z.DECIMAL_FULL_WIDTH=17]="DECIMAL_FULL_WIDTH",Z[Z.DECIMAL_HALF_WIDTH=18]="DECIMAL_HALF_WIDTH",Z[Z.JAPANESE_LEGAL=19]="JAPANESE_LEGAL",Z[Z.JAPANESE_DIGITAL_TEN_THOUSAND=20]="JAPANESE_DIGITAL_TEN_THOUSAND",Z[Z.DECIMAL_ENCLOSED_CIRCLE=21]="DECIMAL_ENCLOSED_CIRCLE",Z[Z.DECIMAL_FULL_WIDTH2=22]="DECIMAL_FULL_WIDTH2",Z[Z.AIUEO_FULL_WIDTH=23]="AIUEO_FULL_WIDTH",Z[Z.IROHA_FULL_WIDTH=24]="IROHA_FULL_WIDTH",Z[Z.GANADA=25]="GANADA",Z[Z.CHOSUNG=26]="CHOSUNG",Z[Z.DECIMAL_ENCLOSED_FULLSTOP=27]="DECIMAL_ENCLOSED_FULLSTOP",Z[Z.DECIMAL_ENCLOSED_PAREN=28]="DECIMAL_ENCLOSED_PAREN",Z[Z.DECIMAL_ENCLOSED_CIRCLE_CHINESE=29]="DECIMAL_ENCLOSED_CIRCLE_CHINESE",Z[Z.IDEOGRAPH_ENCLOSED_CIRCLE=30]="IDEOGRAPH_ENCLOSED_CIRCLE",Z[Z.IDEOGRAPH_TRADITIONAL=31]="IDEOGRAPH_TRADITIONAL",Z[Z.IDEOGRAPH_ZODIAC=32]="IDEOGRAPH_ZODIAC",Z[Z.IDEOGRAPH_ZODIAC_TRADITIONAL=33]="IDEOGRAPH_ZODIAC_TRADITIONAL",Z[Z.TAIWANESE_COUNTING=34]="TAIWANESE_COUNTING",Z[Z.IDEOGRAPH_LEGAL_TRADITIONAL=35]="IDEOGRAPH_LEGAL_TRADITIONAL",Z[Z.TAIWANESE_COUNTING_THOUSAND=36]="TAIWANESE_COUNTING_THOUSAND",Z[Z.TAIWANESE_DIGITAL=37]="TAIWANESE_DIGITAL",Z[Z.CHINESE_COUNTING=38]="CHINESE_COUNTING",Z[Z.CHINESE_LEGAL_SIMPLIFIED=39]="CHINESE_LEGAL_SIMPLIFIED",Z[Z.CHINESE_COUNTING_THOUSAND=40]="CHINESE_COUNTING_THOUSAND",Z[Z.KOREAN_DIGITAL=41]="KOREAN_DIGITAL",Z[Z.KOREAN_COUNTING=42]="KOREAN_COUNTING",Z[Z.KOREAN_LEGAL=43]="KOREAN_LEGAL",Z[Z.KOREAN_DIGITAL2=44]="KOREAN_DIGITAL2",Z[Z.VIETNAMESE_COUNTING=45]="VIETNAMESE_COUNTING",Z[Z.RUSSIAN_LOWER=46]="RUSSIAN_LOWER",Z[Z.RUSSIAN_UPPER=47]="RUSSIAN_UPPER",Z[Z.NUMBER_IN_DASH=48]="NUMBER_IN_DASH",Z[Z.HEBREW1=49]="HEBREW1",Z[Z.HEBREW2=50]="HEBREW2",Z[Z.ARABIC_ALPHA=51]="ARABIC_ALPHA",Z[Z.ARABIC_ABJAD=52]="ARABIC_ABJAD",Z[Z.HINDI_VOWELS=53]="HINDI_VOWELS",Z[Z.HINDI_CONSONANTS=54]="HINDI_CONSONANTS",Z[Z.HINDI_NUMBERS=55]="HINDI_NUMBERS",Z[Z.HINDI_COUNTING=56]="HINDI_COUNTING",Z[Z.THAI_LETTERS=57]="THAI_LETTERS",Z[Z.THAI_NUMBERS=58]="THAI_NUMBERS",Z[Z.THAI_COUNTING=59]="THAI_COUNTING",Z[Z.CUSTOM=60]="CUSTOM",Z),sZ=((ee=sZ||{})[ee.BULLET_ALIGNMENT_UNSPECIFIED=0]="BULLET_ALIGNMENT_UNSPECIFIED",ee[ee.START=1]="START",ee[ee.CENTER=2]="CENTER",ee[ee.END=3]="END",ee[ee.BOTH=4]="BOTH",ee),s0=((et=s0||{})[et.HYPERLINK=0]="HYPERLINK",et[et.FIELD=1]="FIELD",et[et.SDT=2]="SDT",et[et.BOOKMARK=3]="BOOKMARK",et[et.COMMENT=4]="COMMENT",et[et.CUSTOM=5]="CUSTOM",et[et.MENTION=6]="MENTION",et[et.UNI_FORMULA=7]="UNI_FORMULA",et),s1=((er=s1||{})[er.COMMENT=0]="COMMENT",er),s2=((en=s2||{})[en.DRAWING=0]="DRAWING",en[en.CUSTOM=1]="CUSTOM",en),s5=((eo=s5||{})[eo.TRADITIONAL=0]="TRADITIONAL",eo[eo.MODERN=1]="MODERN",eo),s3=((ei=s3||{})[ei.DEFAULT=0]="DEFAULT",ei[ei.LINES=1]="LINES",ei[ei.LINES_AND_CHARS=2]="LINES_AND_CHARS",ei[ei.SNAP_TO_CHARS=3]="SNAP_TO_CHARS",ei),s6=((es=s6||{})[es.SECTION_TYPE_UNSPECIFIED=0]="SECTION_TYPE_UNSPECIFIED",es[es.CONTINUOUS=1]="CONTINUOUS",es[es.NEXT_PAGE=2]="NEXT_PAGE",es[es.EVEN_PAGE=3]="EVEN_PAGE",es[es.ODD_PAGE=4]="ODD_PAGE",es),s4=((ea=s4||{})[ea.COLUMN_SEPARATOR_STYLE_UNSPECIFIED=0]="COLUMN_SEPARATOR_STYLE_UNSPECIFIED",ea[ea.NONE=1]="NONE",ea[ea.BETWEEN_EACH_COLUMN=2]="BETWEEN_EACH_COLUMN",ea),s9=((el=s9||{})[el.NORMAL=0]="NORMAL",el[el.TBRL=1]="TBRL",el[el.LRTBV=2]="LRTBV",el),s8=((eu=s8||{})[eu.TEXT_RUN=0]="TEXT_RUN",eu[eu.AUTO_TEXT=1]="AUTO_TEXT",eu[eu.PAGE_BREAK=2]="PAGE_BREAK",eu[eu.COLUMN_BREAK=3]="COLUMN_BREAK",eu[eu.FOOT_NOTE_REFERENCE=4]="FOOT_NOTE_REFERENCE",eu[eu.HORIZONTAL_RULE=5]="HORIZONTAL_RULE",eu[eu.EQUATION=6]="EQUATION",eu[eu.DRAWING=7]="DRAWING",eu[eu.PERSON=8]="PERSON",eu[eu.RICH_LINK=9]="RICH_LINK",eu),s7=((ec=s7||{})[ec.BOTH_SIDES=0]="BOTH_SIDES",ec[ec.LEFT=1]="LEFT",ec[ec.RIGHT=2]="RIGHT",ec[ec.LARGEST=3]="LARGEST",ec),ae=((ed=ae||{})[ed.INLINE=0]="INLINE",ed[ed.WRAP_NONE=1]="WRAP_NONE",ed[ed.WRAP_POLYGON=2]="WRAP_POLYGON",ed[ed.WRAP_SQUARE=3]="WRAP_SQUARE",ed[ed.WRAP_THROUGH=4]="WRAP_THROUGH",ed[ed.WRAP_TIGHT=5]="WRAP_TIGHT",ed[ed.WRAP_TOP_AND_BOTTOM=6]="WRAP_TOP_AND_BOTTOM",ed),at=((eh=at||{})[eh.NAMED_STYLE_TYPE_UNSPECIFIED=0]="NAMED_STYLE_TYPE_UNSPECIFIED",eh[eh.NORMAL_TEXT=1]="NORMAL_TEXT",eh[eh.TITLE=2]="TITLE",eh[eh.SUBTITLE=3]="SUBTITLE",eh[eh.HEADING_1=4]="HEADING_1",eh[eh.HEADING_2=5]="HEADING_2",eh[eh.HEADING_3=6]="HEADING_3",eh[eh.HEADING_4=7]="HEADING_4",eh[eh.HEADING_5=8]="HEADING_5",eh[eh.HEADING_6=9]="HEADING_6",eh),ar=((ep=ar||{})[ep.AUTO=0]="AUTO",ep[ep.AT_LEAST=1]="AT_LEAST",ep[ep.EXACT=2]="EXACT",ep),an=((ef=an||{})[ef.DASH_STYLE_UNSPECIFIED=0]="DASH_STYLE_UNSPECIFIED",ef[ef.SOLID=1]="SOLID",ef[ef.DOT=2]="DOT",ef[ef.DASH=3]="DASH",ef),ao=((eg=ao||{})[eg.TAB_STOP_ALIGNMENT_UNSPECIFIED=0]="TAB_STOP_ALIGNMENT_UNSPECIFIED",eg[eg.START=1]="START",eg[eg.CENTER=2]="CENTER",eg[eg.END=3]="END",eg),ai=((em=ai||{})[em.UNSPECIFIED=0]="UNSPECIFIED",em[em.SPECIFIED=1]="SPECIFIED",em),as=((e_=as||{})[e_.START=0]="START",e_[e_.CENTER=1]="CENTER",e_[e_.END=2]="END",e_),aa=((ey=aa||{})[ey.AUTO_FIT=0]="AUTO_FIT",ey[ey.FIXED=1]="FIXED",ey),al=((eE=al||{})[eE.NONE=0]="NONE",eE[eE.WRAP=1]="WRAP",eE),au=((eb=au||{})[eb.AUTO=0]="AUTO",eb[eb.AT_LEAST=1]="AT_LEAST",eb[eb.EXACT=2]="EXACT",eb),ac=((ev=ac||{})[ev.CONTENT_ALIGNMENT_UNSPECIFIED=0]="CONTENT_ALIGNMENT_UNSPECIFIED",ev[ev.BOTH=1]="BOTH",ev[ev.TOP=2]="TOP",ev[ev.CENTER=3]="CENTER",ev[ev.BOTTOM=4]="BOTTOM",ev),ad=((eR=ad||{}).NORMAL="normal",eR.BOLD="bold",eR.ITALIC="italic",eR),ah=((eT=ah||{})[eT.PAGE=0]="PAGE",eT[eT.COLUMN=1]="COLUMN",eT[eT.CHARACTER=2]="CHARACTER",eT[eT.MARGIN=3]="MARGIN",eT[eT.INSIDE_MARGIN=4]="INSIDE_MARGIN",eT[eT.OUTSIDE_MARGIN=5]="OUTSIDE_MARGIN",eT[eT.LEFT_MARGIN=6]="LEFT_MARGIN",eT[eT.RIGHT_MARGIN=7]="RIGHT_MARGIN",eT),ap=((eI=ap||{})[eI.PAGE=0]="PAGE",eI[eI.PARAGRAPH=1]="PARAGRAPH",eI[eI.LINE=2]="LINE",eI[eI.MARGIN=3]="MARGIN",eI[eI.TOP_MARGIN=4]="TOP_MARGIN",eI[eI.BOTTOM_MARGIN=5]="BOTTOM_MARGIN",eI[eI.INSIDE_MARGIN=6]="INSIDE_MARGIN",eI[eI.OUTSIDE_MARGIN=7]="OUTSIDE_MARGIN",eI),af=((eC=af||{})[eC.POINT=0]="POINT",eC[eC.LINE=1]="LINE",eC[eC.CHARACTER=2]="CHARACTER",eC[eC.PIXEL=3]="PIXEL",eC[eC.PERCENT=4]="PERCENT",eC),ag=((eS=ag||{})[eS.CENTER=0]="CENTER",eS[eS.INSIDE=1]="INSIDE",eS[eS.LEFT=2]="LEFT",eS[eS.OUTSIDE=3]="OUTSIDE",eS[eS.RIGHT=4]="RIGHT",eS[eS.BOTH=5]="BOTH",eS[eS.DISTRIBUTE=6]="DISTRIBUTE",eS),am=((eO=am||{})[eO.BOTTOM=0]="BOTTOM",eO[eO.CENTER=1]="CENTER",eO[eO.INSIDE=2]="INSIDE",eO[eO.OUTSIDE=3]="OUTSIDE",eO[eO.TOP=4]="TOP",eO),a_=((ex=a_||{})[ex.compressPunctuation=0]="compressPunctuation",ex[ex.compressPunctuationAndJapaneseKana=1]="compressPunctuationAndJapaneseKana",ex[ex.doNotCompress=2]="doNotCompress",ex),ay=((eA=ay||{})[eA.PORTRAIT=0]="PORTRAIT",eA[eA.LANDSCAPE=1]="LANDSCAPE",eA),aE=((ew=aE||{})[ew.forward=0]="forward",ew[ew.backward=1]="backward",ew[ew.front=2]="front",ew[ew.back=3]="back",ew),ab=((eN=ab||{})[eN.UNRECOGNIZED=-1]="UNRECOGNIZED",eN[eN.DRAWING_IMAGE=0]="DRAWING_IMAGE",eN[eN.DRAWING_SHAPE=1]="DRAWING_SHAPE",eN[eN.DRAWING_CHART=2]="DRAWING_CHART",eN[eN.DRAWING_TABLE=3]="DRAWING_TABLE",eN[eN.DRAWING_SMART_ART=4]="DRAWING_SMART_ART",eN[eN.DRAWING_VIDEO=5]="DRAWING_VIDEO",eN[eN.DRAWING_GROUP=6]="DRAWING_GROUP",eN[eN.DRAWING_UNIT=7]="DRAWING_UNIT",eN[eN.DRAWING_DOM=8]="DRAWING_DOM",eN),av=((eD=av||{}).ORDER_LIST_QUICK_1="1.",eD.ORDER_LIST_QUICK_2="a)",eD.ORDER_LIST_QUICK_3="a.",eD.ORDER_LIST_QUICK_4="i.",eD.ORDER_LIST_QUICK_5="A.",eD.ORDER_LIST_QUICK_6="I.",eD.ORDER_LIST_QUICK_7="01.",eD),aR=((eL=aR||{}).BULLET_LIST="BULLET_LIST",eL.BULLET_LIST_1="BULLET_LIST_1",eL.BULLET_LIST_2="BULLET_LIST_2",eL.BULLET_LIST_3="BULLET_LIST_3",eL.BULLET_LIST_4="BULLET_LIST_4",eL.BULLET_LIST_5="BULLET_LIST_5",eL.ORDER_LIST="ORDER_LIST",eL.ORDER_LIST_1="ORDER_LIST_1",eL.ORDER_LIST_2="ORDER_LIST_2",eL.ORDER_LIST_3="ORDER_LIST_3",eL.ORDER_LIST_4="ORDER_LIST_4",eL.ORDER_LIST_5="ORDER_LIST_5",eL.ORDER_LIST_QUICK_2="ORDER_LIST_QUICK_2",eL.ORDER_LIST_QUICK_3="ORDER_LIST_QUICK_3",eL.ORDER_LIST_QUICK_4="ORDER_LIST_QUICK_4",eL.ORDER_LIST_QUICK_5="ORDER_LIST_QUICK_5",eL.ORDER_LIST_QUICK_6="ORDER_LIST_QUICK_6",eL.CHECK_LIST="CHECK_LIST",eL.CHECK_LIST_CHECKED="CHECK_LIST_CHECKED",eL);let aT={"a)":{glyphFormat:"%1)",glyphType:sQ.DECIMAL},"1.":{glyphFormat:"%1.",glyphType:sQ.DECIMAL},"a.":{glyphFormat:"%1.",glyphType:sQ.LOWER_LETTER},"A.":{glyphFormat:"%1.",glyphType:sQ.UPPER_LETTER},"i.":{glyphFormat:"%1.",glyphType:sQ.LOWER_ROMAN},"I.":{glyphFormat:"%1.",glyphType:sQ.UPPER_LETTER}},aI=/* @__PURE__ */e4(e=>[...e,...e,...e].map((e,t)=>({glyphFormat:` %${t+1}`,glyphSymbol:e,bulletAlignment:sZ.START,textStyle:{fs:12},startNumber:0,paragraphProperties:{hanging:{v:21},indentStart:{v:21*t}}})),"bulletListFactory"),aC=/* @__PURE__ */e4(e=>e.map((e,t)=>({...e,bulletAlignment:sZ.START,textStyle:{fs:12},startNumber:0,paragraphProperties:{hanging:{v:21},indentStart:{v:21*t}}})),"orderListFactory"),aS=/* @__PURE__ */e4((e,t)=>Array(9).fill(0).map((r,n)=>({glyphFormat:` %${n+1}`,glyphSymbol:e,bulletAlignment:sZ.START,textStyle:{fs:16},startNumber:0,paragraphProperties:{hanging:{v:21},indentStart:{v:21*n},textStyle:t}})),"checkListFactory"),aO={BULLET_LIST:{listType:"BULLET_LIST",nestingLevel:aI(["●","○","■"])},BULLET_LIST_1:{listType:"BULLET_LIST",nestingLevel:aI(["❖","➢","■"])},BULLET_LIST_2:{listType:"BULLET_LIST",nestingLevel:aI(["✔","●","◆"])},BULLET_LIST_3:{listType:"BULLET_LIST",nestingLevel:aI(["■","◆","○"])},BULLET_LIST_4:{listType:"BULLET_LIST",nestingLevel:aI(["✧","○","■"])},BULLET_LIST_5:{listType:"BULLET_LIST",nestingLevel:aI(["➢","○","◆"])},ORDER_LIST:{listType:"ORDER_LIST",nestingLevel:aC([{glyphFormat:"%1.",glyphType:sQ.DECIMAL},{glyphFormat:"%2.",glyphType:sQ.LOWER_LETTER},{glyphFormat:"%3.",glyphType:sQ.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:sQ.DECIMAL},{glyphFormat:"%5.",glyphType:sQ.LOWER_LETTER},{glyphFormat:"%6.",glyphType:sQ.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:sQ.DECIMAL},{glyphFormat:"%8.",glyphType:sQ.LOWER_LETTER},{glyphFormat:"%9.",glyphType:sQ.LOWER_ROMAN}])},ORDER_LIST_1:{listType:"ORDER_LIST",nestingLevel:aC([{glyphFormat:"%1)",glyphType:sQ.DECIMAL},{glyphFormat:"%2)",glyphType:sQ.LOWER_LETTER},{glyphFormat:"%3)",glyphType:sQ.LOWER_ROMAN},{glyphFormat:"%4)",glyphType:sQ.DECIMAL},{glyphFormat:"%5)",glyphType:sQ.LOWER_LETTER},{glyphFormat:"%6)",glyphType:sQ.LOWER_ROMAN},{glyphFormat:"%7)",glyphType:sQ.DECIMAL},{glyphFormat:"%8)",glyphType:sQ.LOWER_LETTER},{glyphFormat:"%9)",glyphType:sQ.LOWER_ROMAN}])},ORDER_LIST_2:{listType:"ORDER_LIST",nestingLevel:aC(["%1.","%1.%2.","%1.%2.%3.","%1.%2.%3.%4.","%1.%2.%3.%4.%5.","%1.%2.%3.%4.%5.%6.","%1.%2.%3.%4.%5.%6.%7."].map(e=>({glyphFormat:e,glyphType:sQ.DECIMAL})))},ORDER_LIST_3:{listType:"ORDER_LIST",nestingLevel:aC([{glyphFormat:"%1.",glyphType:sQ.UPPER_LETTER},{glyphFormat:"%2.",glyphType:sQ.LOWER_LETTER},{glyphFormat:"%3.",glyphType:sQ.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:sQ.UPPER_LETTER},{glyphFormat:"%5.",glyphType:sQ.LOWER_LETTER},{glyphFormat:"%6.",glyphType:sQ.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:sQ.UPPER_LETTER},{glyphFormat:"%8.",glyphType:sQ.LOWER_LETTER},{glyphFormat:"%9.",glyphType:sQ.LOWER_ROMAN}])},ORDER_LIST_4:{listType:"ORDER_LIST",nestingLevel:aC([{glyphFormat:"%1.",glyphType:sQ.UPPER_LETTER},{glyphFormat:"%2.",glyphType:sQ.DECIMAL},{glyphFormat:"%3.",glyphType:sQ.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:sQ.UPPER_LETTER},{glyphFormat:"%5.",glyphType:sQ.DECIMAL},{glyphFormat:"%6.",glyphType:sQ.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:sQ.UPPER_LETTER},{glyphFormat:"%8.",glyphType:sQ.DECIMAL},{glyphFormat:"%9.",glyphType:sQ.LOWER_ROMAN}])},ORDER_LIST_5:{listType:"ORDER_LIST",nestingLevel:aC([{glyphFormat:"%1.",glyphType:sQ.DECIMAL_ZERO},{glyphFormat:"%2.",glyphType:sQ.LOWER_LETTER},{glyphFormat:"%3.",glyphType:sQ.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:sQ.DECIMAL_ZERO},{glyphFormat:"%5.",glyphType:sQ.LOWER_LETTER},{glyphFormat:"%6.",glyphType:sQ.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:sQ.DECIMAL_ZERO},{glyphFormat:"%8.",glyphType:sQ.LOWER_LETTER},{glyphFormat:"%9.",glyphType:sQ.LOWER_ROMAN}])},CHECK_LIST:{listType:"CHECK_LIST",nestingLevel:aS("☐")},CHECK_LIST_CHECKED:{listType:"CHECK_LIST_CHECKED",nestingLevel:aS("☑",{st:{s:n1.TRUE}})}},ax=/* @__PURE__ */e4(e=>{let{glyphFormat:t,glyphType:r}=e,n=oy.deepClone(aO.ORDER_LIST);return n.nestingLevel[0].glyphFormat=t,n.nestingLevel[0].glyphType=r,n},"generateOrderList");Object.assign(aO,{ORDER_LIST_QUICK_2:ax(aT["a)"]),ORDER_LIST_QUICK_3:ax(aT["a."]),ORDER_LIST_QUICK_4:ax(aT["i."]),ORDER_LIST_QUICK_6:ax(aT["I."])});let aA={"1.":"ORDER_LIST","a)":"ORDER_LIST_QUICK_2","a.":"ORDER_LIST_QUICK_3","i.":"ORDER_LIST_QUICK_4","A.":"ORDER_LIST_3","I.":"ORDER_LIST_QUICK_6","01.":"ORDER_LIST_5"};function aw(e){let t=[];for(let r of e){let{ed:e,ts:n}=r;if(void 0===r.sId&&delete r.sId,oy.isEmptyObject(n)&&null==r.sId)continue;if(0===t.length){t.push(r);continue}let o=t.pop();ih(r,o)&&oy.hasIntersectionBetweenTwoRanges(o.st,o.ed,r.st,r.ed)?t.push({...r,st:o.st,ed:e}):t.push(o,r)}return t}function aN(e,t,r,n){var o;let{textRuns:i}=e;if(null==i)return;let s=[],a=i.length,l=!1,u=null!=(o=t.textRuns)?o:[];if(u.length)for(let e of u)e.st+=n,e.ed+=n;for(let e=0;e<a;e++){let t=i[e],o=i[e+1],{st:a,ed:c}=t;if(c<n)s.push(t);else if(n>=a&&n<=c){if(o&&o.st===o.ed&&n===o.st){s.push(t);continue}if(l)t.st+=r,t.ed+=r,s.push(t);else{l=!0,t.ed+=r;let e=[];if(u.length){let n={...t,st:a,ed:u[0].st};n.ed>n.st&&e.push(n),e.push(...u);let o=u[u.length-1],i={...t,st:o.ed,ed:c+r};i.ed>i.st&&e.push(i)}else e.push(t);s.push(...e)}}else t.st+=r,t.ed+=r,l||(l=!0,s.push(...u)),s.push(t)}l||(l=!0,s.push(...u)),e.textRuns=aw(s)}function aD(e,t,r,n){let{paragraphs:o}=e;if(null==o)return;let{paragraphs:i,dataStream:s}=t,a=[],l=-1;for(let e=0,t=o.length;e<t;e++){let t=o[e],{startIndex:i}=t;i>=n&&(t.startIndex+=r),-1===l&&i>=n&&(l=e),a.push(t.startIndex)}let u=-1;if(i){for(let e=0,t=i.length;e<t;e++){let t=i[e];t.startIndex+=n;let r=t.startIndex;u=a.indexOf(r)}if(s===sq.PARAGRAPH&&1===i.length){let e=o[l],t=i[0],r=e.paragraphStyle,n=e.bullet;e.paragraphStyle=t.paragraphStyle,e.bullet=t.bullet,t.paragraphStyle=r,t.bullet=n}-1!==u&&o.splice(u,1),o.push(...i),o.sort(so("startIndex"))}}function aL(e,t,r,n){let{sectionBreaks:o}=e;if(null==o)return;for(let e=0,t=o.length;e<t;e++){let t=o[e],{startIndex:i}=t;i>=n&&(t.startIndex+=r)}let i=t.sectionBreaks;if(i){for(let e=0,t=i.length;e<t;e++){let t=i[e];t.startIndex+=n}o.push(...i),o.sort(so("startIndex"))}}function aM(e,t,r,n){let{customBlocks:o}=e;if(null==o)return;for(let e=0,t=o.length;e<t;e++){let t=o[e],{startIndex:i}=t;i>=n&&(t.startIndex+=r)}let i=t.customBlocks;if(i){for(let e=0,t=i.length;e<t;e++){let t=i[e];t.startIndex+=n}o.push(...i),o.sort(so("startIndex"))}}function aU(e,t,r,n){let{tables:o}=e;if(null==o)return;for(let e=0,t=o.length;e<t;e++){let t=o[e],{startIndex:i,endIndex:s}=t;i>n?(t.startIndex+=r,t.endIndex+=r):s>n&&(t.endIndex+=r)}let i=t.tables;if(i){for(let e=0,t=i.length;e<t;e++){let t=i[e];t.startIndex+=n,t.endIndex+=n}o.push(...i),o.sort(so("startIndex"))}}function aP(e,t,r,n){e.customRanges||(e.customRanges=[]);let{customRanges:o}=e,i={};for(let e=0,t=o.length;e<t;e++){let t=o[e];i[t.rangeId]=t;let{startIndex:s,endIndex:a}=t;s>=n?(t.startIndex+=r,t.endIndex+=r):a>n-1&&(t.endIndex+=r)}if(o.find(e=>e.startIndex>n&&e.endIndex<n))return;let s=[];if(t.customRanges){for(let r=0,o=t.customRanges.length;r<o;r++){let o=t.customRanges[r],a=i[o.rangeId];if(o.startIndex+=n,o.endIndex+=n,a){if(a.startIndex<=o.startIndex&&a.endIndex>=o.endIndex)continue;if(e.dataStream[a.startIndex]===sq.CUSTOM_RANGE_START&&e.dataStream[a.endIndex]===sq.CUSTOM_RANGE_END){s.push(o);continue}if(e.dataStream[a.startIndex]===sq.CUSTOM_RANGE_START){a.endIndex=o.endIndex;continue}if(e.dataStream[a.endIndex]===sq.CUSTOM_RANGE_END){a.startIndex=o.startIndex;continue}}s.push(o)}o.push(...s),o.sort(so("startIndex"))}}function ak(e){e.sort((e,t)=>e.startIndex-t.startIndex);let t=[],r=e[0];for(let n=1;n<e.length;n++)r.endIndex+1>=e[n].startIndex?r.endIndex=Math.max(r.endIndex,e[n].endIndex):(t.push(r),r=e[n]);return t.push(r),t}function aF(e){let t={};for(let r=0,n=e.length;r<n;r++){let n=e[r],o=t[n.id];t[n.id]=[...null!=o?o:[],n]}return Object.keys(t).forEach(e=>{let r=ak(t[e]);t[e]=r}),Object.values(t).flat()}function aj(e,t,r,n){e.customDecorations||(e.customDecorations=[]);let{customDecorations:o}=e;if(r>0)for(let e=0,t=o.length;e<t;e++){let t=o[e],{startIndex:i,endIndex:s}=t;i>=n?(t.startIndex+=r,t.endIndex+=r):s>n-1&&(t.endIndex+=r)}if(t.customDecorations){let r=[];for(let e=0,o=t.customDecorations.length;e<o;e++){let o=t.customDecorations[e];r.push(o),o.startIndex+=n,o.endIndex+=n}o.push(...r),e.customDecorations=aF(o),e.customDecorations.sort(so("startIndex"))}}function aB(e,t,r){var n;let{textRuns:o}=e,i=r+t,s=[];if(r===i&&null!=o&&o.find(e=>e.st===r&&e.ed===r)){let t=o.find(e=>e.st===r&&e.ed===r);return s.push({...t,st:t.st-r,ed:t.ed-r}),e.textRuns=null==(n=e.textRuns)?void 0:n.filter(e=>e!==t),s}if(o){let n=[];for(let e=0,a=o.length;e<a;e++){let a=o[e],{st:l,ed:u}=a;if(r<=l&&i>=u){if(s.push({...a,st:l-r,ed:u-r}),r!==l)continue;a.ed=l}else l<=r&&u>=i?(s.push({...a,st:r-r,ed:i-r}),a.ed-=t):r>=l&&r<u?(s.push({...a,st:r-r,ed:u-r}),a.ed=r):i>l&&i<=u?(s.push({...a,st:l-r,ed:i-r}),a.st=i-t,a.ed-=t):l>=i&&(a.st-=t,a.ed-=t);n.push(a)}e.textRuns=n}return 0===s.length&&s.push({st:0,ed:t,ts:{}}),s}function aH(e,t,r){let{paragraphs:n}=e,o=r+t,i=[];if(n){let s=[];for(let e=0,a=n.length;e<a;e++){let a=n[e],{startIndex:l}=a;if(l>=r&&l<o){i.push({...a,startIndex:l-r});continue}l>=o&&(a.startIndex-=t),s.push(a)}e.paragraphs=s}return i}function a$(e,t,r){let{sectionBreaks:n}=e,o=r+t-1,i=[];if(n){let s=[];for(let e=0,a=n.length;e<a;e++){let a=n[e],{startIndex:l}=a;if(l>=r&&l<=o){i.push({...a,startIndex:l-r});continue}l>o&&(a.startIndex-=t),s.push(a)}e.sectionBreaks=s}return i}function aG(e,t,r){let{customBlocks:n}=e,o=r+t-1,i=[];if(n){let s=[];for(let e=0,a=n.length;e<a;e++){let a=n[e],{startIndex:l}=a;if(l>=r&&l<=o){i.push({...a,startIndex:l-r});continue}l>o&&(a.startIndex-=t),s.push(a)}e.customBlocks=s}return i}function aW(e,t,r){let{tables:n}=e,o=r+t-1,i=[];if(n){let s=[];for(let e=0,a=n.length;e<a;e++){let a=n[e],{startIndex:l,endIndex:u}=a;if(r<=l&&o>=u){i.push({...a,startIndex:l-r,endIndex:u-r});continue}if(l<=r&&u>=o){let e=im(l,u,r,o);if(a.startIndex=e[0],a.endIndex=e[1],a.startIndex===a.endIndex)continue}else o<l&&(a.startIndex-=t,a.endIndex-=t);s.push(a)}e.tables=s}return i}function aV(e,t,r){let{customRanges:n}=e,o=r+t-1,i=[];if(n){let s=[];for(let e=0,a=n.length;e<a;e++){let a=n[e],{startIndex:l,endIndex:u}=a;if(r<=l&&o>=l){i.push({...a,startIndex:l-r,endIndex:u-r});continue}if(l<=r&&u>=o){let e=im(l,u,r,o);a.startIndex=e[0],a.endIndex=e[1]}else o<l&&(a.startIndex-=t,a.endIndex-=t);s.push(a)}e.customRanges=s}return i}function az(e,t,r,n=!0){let{customDecorations:o}=e,i=r+t-1,s=[];if(o){let a=[];for(let e=0,l=o.length;e<l;e++){let l=o[e],{startIndex:u,endIndex:c}=l;if(u>=r&&c<=i){s.push(l);continue}if(Math.max(r,u)<=Math.min(i,c)){let e=im(u,c,r,i);l.startIndex=e[0],l.endIndex=e[1]}else i<u&&n&&(l.startIndex-=t,l.endIndex-=t);a.push(l)}e.customDecorations=a}return s}function aK(e,t,r,n,o){let i=aY(e,t,r,n,o),s=aJ(e,t,r,n,o),a=aX(e,t,r,n,o),l=aQ(e,t,r,n,o);return{dataStream:"",textRuns:i,paragraphs:s,sectionBreaks:a,customBlocks:l,tables:aZ(e,t,r,n,o),customRanges:a0(e,t,r,n,o),customDecorations:a1(e,t,r,n,o)}}function aY(e,t,r,n,o){let{textRuns:i}=e,{textRuns:s}=t;if(null==i||null==s)return;let a=aB(e,r,n);if(o!==oX.REPLACE){let e=aq(s,a,o);t.textRuns=e}return aN(e,t,r,n),a}function aq(e,t,r){if(0===t.length)return e;e=oy.deepClone(e),t=oy.deepClone(t);let n=[],o=e.length,i=t.length,s=0,a=0,l=null;function u(){return!!l&&(n.push(l),l=null,!0)}for(e4(u,"pushPendingAndReturnStatus");s<o&&a<i;){let o;let{st:i,ed:c,ts:d}=e[s],{st:h,ed:p,ts:f,sId:g}=t[a];if(o=r===oX.COVER?{...f,...d}:{...d,...f},c<h)u()||n.push(e[s]),s++;else if(p<i)u()||n.push(t[a]),a++;else{let r={st:Math.min(i,h),ed:Math.max(i,h),ts:i<h?{...d}:{...f},sId:i<h?void 0:g};r.ed>r.st&&n.push(r),n.push({st:Math.max(i,h),ed:Math.min(c,p),ts:o,sId:g}),c<p?(s++,t[a].st=c,t[a].st===t[a].ed&&a++):(a++,e[s].st=p,e[s].st===e[s].ed&&s++);let u={st:Math.min(c,p),ed:Math.max(c,p),ts:c<p?{...f}:{...d},sId:c<p?g:void 0};l=u.ed>u.st?u:null}}u();let c=n[n.length-1],d=e[o-1],h=t[i-1];return c&&c.ed!==Math.max(d.ed,h.ed)&&(d.ed>h.ed?n.push(d):n.push(h)),aw(n)}function aJ(e,t,r,n,o){let{paragraphs:i}=e,{paragraphs:s}=t;if(null==i||null==s)return;let a=aH(e,r,n);if(o!==oX.REPLACE){let e=[];for(let t of s){let{startIndex:r,paragraphStyle:n,bullet:i}=t,s=[];for(let e of a){let t,a;let{startIndex:l,paragraphStyle:u,bullet:c}=e;if(o===oX.COVER?(t={...u,...n},a={listId:"",listType:aR.BULLET_LIST,nestingLevel:0,textStyle:{},...c,...i}):(t={...n,...u},a={listId:"",listType:aR.BULLET_LIST,nestingLevel:0,textStyle:{},...i,...c}),r===l){s.push({startIndex:r,paragraphStyle:t,bullet:a});break}}e.push(...s),s=[]}t.paragraphs=e}return aD(e,t,r,n),a}function aX(e,t,r,n,o){let{sectionBreaks:i}=e,{sectionBreaks:s}=t;if(null==i||null==s)return;let a=a$(e,r,n);if(o!==oX.REPLACE){let e=[];for(let t of s){let{startIndex:r}=t,n=[];for(let e of a){let{startIndex:i}=e;if(r===i){o===oX.COVER?n.push({...e,...t}):n.push({...t,...e});break}}e.push(...n),n=[]}t.sectionBreaks=e}return aD(e,t,r,n),a}function aQ(e,t,r,n,o){let{customBlocks:i}=e,{customBlocks:s}=t;if(null==i||null==s)return;let a=aG(e,r,n);if(o!==oX.REPLACE){let e=[];for(let t of s){let{startIndex:r}=t,n=[];for(let e of a){let{startIndex:i}=e;if(r===i){o===oX.COVER?n.push({...e,...t}):n.push({...t,...e});break}}e.push(...n),n=[]}t.customBlocks=e}return aM(e,t,r,n),a}function aZ(e,t,r,n,o){let{tables:i}=e,{tables:s}=t;if(null==i||null==s)return;let a=aW(e,r,n);if(o!==oX.REPLACE){let e=[];for(let t of s){let{startIndex:r,endIndex:n}=t,i=[];for(let e of a){let{startIndex:s,endIndex:a}=e;if(s>=r&&a<=n){o===oX.COVER?i.push({...e,...t}):i.push({...t,...e});break}}e.push(...i),i=[]}t.tables=e}return aU(e,t,r,n),a}function a0(e,t,r,n,o){e.customRanges||(e.customRanges=[]);let{customRanges:i}=e,{customRanges:s}=t;if(null==i||null==s)return;let a=[];return o===oX.REPLACE&&(a=aV(e,r,n)),aP(e,t,0,n),a}function a1(e,t,r,n,o){e.customDecorations||(e.customDecorations=[]);let i=[];return o===oX.REPLACE&&(i=az(e,r,n,!1)),aj(e,t,0,n),i}e4(aw,"normalizeTextRuns"),e4(aN,"insertTextRuns"),e4(aD,"insertParagraphs"),e4(aL,"insertSectionBreaks"),e4(aM,"insertCustomBlocks"),e4(aU,"insertTables"),e4(aP,"insertCustomRanges"),e4(ak,"mergeRanges"),e4(aF,"mergeDecorations"),e4(aj,"insertCustomDecorations"),e4(aB,"deleteTextRuns"),e4(aH,"deleteParagraphs"),e4(a$,"deleteSectionBreaks"),e4(aG,"deleteCustomBlocks"),e4(aW,"deleteTables"),e4(aV,"deleteCustomRanges"),e4(az,"deleteCustomDecorations"),e4(aK,"updateAttribute"),e4(aY,"updateTextRuns"),e4(aq,"coverTextRuns"),e4(aJ,"updateParagraphs"),e4(aX,"updateSectionBreaks"),e4(aQ,"updateCustomBlocks"),e4(aZ,"updateTables"),e4(a0,"updateCustomRanges"),e4(a1,"updateCustomDecorations");var a2=((eM=a2||{})[eM.copy=0]="copy",eM[eM.cut=1]="cut",eM);function a5(e,t,r,n=!1,o=1){let{dataStream:i,textRuns:s=[],paragraphs:a=[],customBlocks:l=[],tables:u=[]}=e,c={dataStream:i.slice(t,r)},d=[];for(let e of s){let n=oy.deepClone(e),{st:o,ed:i}=n;oy.hasIntersectionBetweenTwoRanges(o,i,t,r)&&(t>=o&&t<=i?d.push({...n,st:t,ed:Math.min(r,i)}):r>=o&&r<=i?d.push({...n,st:Math.max(t,o),ed:r}):d.push(n))}d.length?c.textRuns=d.map(e=>{let{st:r,ed:n}=e;return{...e,st:r-t,ed:n-t}}):n&&(c.textRuns=[{st:0,ed:r-t,ts:{}}]);let h=[];for(let e of u){let n=oy.deepClone(e),{startIndex:o,endIndex:i}=n;o>=t&&i<=r&&h.push({...n,startIndex:o-t,endIndex:i-t})}h.length&&(c.tables=h);let p=[];for(let e of a){let{startIndex:n}=e;n>=t&&n<=r&&p.push(oy.deepClone(e))}p.length&&(c.paragraphs=p.map(e=>({...e,startIndex:e.startIndex-t}))),1===o&&(c.customDecorations=a4(e,t,r));let{customRanges:f}=a6(e,t,r);c.customRanges=f;let g=[];for(let e of l){let{startIndex:n}=e;n>=t&&n<=r&&g.push(oy.deepClone(e))}return g.length&&(c.customBlocks=g.map(e=>({...e,startIndex:e.startIndex-t}))),c}function a3(e){let{dataStream:t,textRuns:r,paragraphs:n,customRanges:o,customDecorations:i,tables:s}=e,a=0,l=0;null==o||o.forEach(e=>{e.startIndex<0&&(a=Math.max(a,-e.startIndex)),e.endIndex>t.length-1&&(l=Math.max(l,e.endIndex-t.length+1))});let u=`${sq.CUSTOM_RANGE_START.repeat(a)}${t}${sq.CUSTOM_RANGE_END.repeat(l)}`;return r&&(r[0]&&(r[0].st=r[0].st-a),r[r.length-1]&&(r[r.length-1].ed=r[r.length-1].ed+l)),null==r||r.forEach(e=>{e.st+=a,e.ed+=a}),null==n||n.forEach(e=>{e.startIndex+=a}),null==o||o.forEach(e=>{e.startIndex+=a,e.endIndex+=a}),null==i||i.forEach(e=>{e.startIndex+=a,e.endIndex+=l}),null==s||s.forEach(e=>{e.startIndex+=a,e.endIndex+=l}),{...e,dataStream:u,textRuns:r,paragraphs:n,customRanges:o,customDecorations:i,tables:s}}function a6(e,t,r){let{customRanges:n=[]}=e,o=0,i=0,s=n.filter(e=>Math.max(e.startIndex,t)<=Math.min(e.endIndex,r-1)).map(e=>({...e,startIndex:e.startIndex,endIndex:e.endIndex}));if(s.length){s.forEach(e=>{e.startIndex<t&&(o+=1),e.endIndex>r-1&&(i+=1)});for(let e=0;e<o;e++)s[e].startIndex=t-o+e;if(i){let e=[...s].sort((e,t)=>t.endIndex-e.endIndex);for(let t=0;t<i;t++)e[t].endIndex=r+i-t-1}}return{customRanges:s.map(e=>({...e,startIndex:e.startIndex-t,endIndex:e.endIndex-t})),leftOffset:o,rightOffset:i}}function a4(e,t,r){let{customDecorations:n=[]}=e,o=[];return n.forEach(e=>{if(Math.max(e.startIndex,t)<=Math.min(e.endIndex,r-1)){let n=oy.deepClone(e);o.push({...n,startIndex:Math.max(n.startIndex-t,0),endIndex:Math.min(n.endIndex,r)-t})}}),o}function a9(e,t,r=oX.COVER){if(""!==t.dataStream)throw Error("Cannot compose other body with non-empty dataStream");let n={dataStream:e.dataStream},{textRuns:o=[],paragraphs:i=[]}=e,{textRuns:s=[],paragraphs:a=[]}=t,l=aq(s,o,r);l.length&&(n.textRuns=l);let u=[],c=0,d=0;for(;c<i.length&&d<a.length;){let e=i[c],t=a[d],{startIndex:r}=e,{startIndex:n}=t;r===n?(u.push(oy.deepMerge(e,t)),c++,d++):r<n?(u.push(oy.deepClone(e)),c++):(u.push(oy.deepClone(t)),d++)}return c<i.length&&u.push(...i.slice(c)),d<a.length&&u.push(...a.slice(d)),u.length&&(n.paragraphs=u),n}function a8(e){let{body:t}=e;if(null==t)return!0;let{textRuns:r=[],paragraphs:n=[]}=t;return 0===r.length&&0===n.length}e4(a5,"getBodySlice"),e4(a3,"normalizeBody"),e4(a6,"getCustomRangeSlice"),e4(a4,"getCustomDecorationSlice"),e4(a9,"composeBody"),e4(a8,"isUselessRetainAction");let a7=class{constructor(e){e9(this,"_index",0),e9(this,"_offset",0),this._actions=e}hasNext(){return this.peekLength()<Number.POSITIVE_INFINITY}next(e){e||(e=Number.POSITIVE_INFINITY);let t=this._actions[this._index];if(!t)return{t:sK.RETAIN,len:Number.POSITIVE_INFINITY};{let r=this._offset,n=t.len;return e>=n-r?(e=n-r,this._index+=1,this._offset=0):this._offset+=e,t.t===sK.DELETE||t.t===sK.RETAIN&&null==t.body?oy.deepClone({...t,len:e}):oy.deepClone({...t,len:e,body:a5(t.body,r,r+e)})}}peek(){return this._actions[this._index]}peekLength(){return this._actions[this._index]?this._actions[this._index].len-this._offset:Number.POSITIVE_INFINITY}peekType(){let e=this._actions[this._index];return e?e.t:sK.RETAIN}rest(){if(!this.hasNext())return[];if(0===this._offset)return this._actions.slice(this._index);{let e=this._offset,t=this._index,r=this.next(),n=this._actions.slice(this._index);return this._offset=e,this._index=t,[r].concat(n)}}};function le(e,t,r){let{dataStream:n}=e,o=r+t,i=aB(e,t,r),s=aH(e,t,r),a=a$(e,t,r),l=aG(e,t,r),u=aW(e,t,r),c=aV(e,t,r),d=az(e,t,r),h="";return n&&(e.dataStream=iE(n,r,o),h=n.slice(r,o)),{dataStream:h,textRuns:i,paragraphs:s,sectionBreaks:a,customBlocks:l,tables:u,customRanges:c,customDecorations:d}}function lt(e,t,r,n){e.dataStream=iy(e.dataStream,n,t.dataStream),aN(e,t,r,n),aD(e,t,r,n),aL(e,t,r,n),aM(e,t,r,n),aU(e,t,r,n),aP(e,t,r,n),aj(e,t,r,n)}function lr(e,t,r,n,o=oX.COVER){return aK(e,t,r,n,o)}function ln(e,t,r){return t<=0?{dataStream:""}:le(e,t,r)}function lo(e,t,r,n){0!==r&&lt(e,t,r,n)}function li(e,t){let r=new rW;return r.reset(),t.forEach(t=>{let n=oy.deepClone(t);switch(n.t){case sK.RETAIN:{let{coverType:t,body:o,len:i}=n;null!=o&&lr(e,o,i,r.cursor,t),r.moveCursor(i);break}case sK.INSERT:{let{body:t,len:o}=n;lo(e,t,o,r.cursor),r.moveCursor(o);break}case sK.DELETE:{let{len:t}=n;ln(e,t,r.cursor);break}default:throw Error(`Unknown action type for action: ${n}.`)}}),e}function ls(e,t,r){if(0===e.length)return t;t=oy.deepClone(t),e=oy.deepClone(e);let n=[],o=t.length,i=e.length,s=0,a=0,l=null;function u(){return!!l&&(n.push(l),l=null,!0)}for(e4(u,"pushPendingAndReturnStatus");s<o&&a<i;){let{st:o,ed:i,ts:c}=t[s],{st:d,ed:h,ts:p,sId:f}=e[a],g={};if(0===r)g={...c};else if(g={...c},p)for(let e of Object.keys(p))g[e]&&delete g[e];if(i<d)u()||n.push(t[s]),s++;else if(h<o)u()||n.push(e[a]),a++;else{let r={st:Math.min(o,d),ed:Math.max(o,d),ts:o<d?{...c}:{...p},sId:o<d?void 0:f};r.ed>r.st&&n.push(),n.push({st:Math.max(o,d),ed:Math.min(i,h),ts:g,sId:f}),i<h?(s++,e[a].st=i,e[a].st===e[a].ed&&a++):(a++,t[s].st=h,t[s].st===t[s].ed&&s++);let u={st:Math.min(i,h),ed:Math.max(i,h),ts:i<h?{...p}:{...c},sId:i<h?f:void 0};l=u.ed>u.st?u:null}}u();let c=n[n.length-1],d=t[o-1],h=e[i-1];return c.ed!==Math.max(d.ed,h.ed)&&(d.ed>h.ed?n.push(d):n.push(h)),aw(n)}function la(e,t,r){let n={startIndex:t.startIndex};if(t.paragraphStyle){if(null==e.paragraphStyle)n.paragraphStyle={...t.paragraphStyle};else if(n.paragraphStyle={...t.paragraphStyle},1===r)for(let t of Object.keys(e.paragraphStyle))n.paragraphStyle[t]&&delete n.paragraphStyle[t]}return t.bullet&&(null==e.bullet||0===r)&&(n.bullet={...t.bullet}),n}function ll(e,t,r=!1){let{body:n}=e,{body:o}=t;if(null==n||""!==n.dataStream||null==o||""!==o.dataStream)throw Error("Data stream is not supported in transform.");let i={dataStream:""},{textRuns:s=[],paragraphs:a=[]}=n,{textRuns:l=[],paragraphs:u=[]}=o,c=[];(c=r?ls(s,l,1):ls(s,l,0)).length&&(i.textRuns=c);let d=[],h=0,p=0;for(;h<a.length&&p<u.length;){let e=a[h],t=u[p],{startIndex:n}=e,{startIndex:o}=t;if(n===o){let o={startIndex:n};o=r?la(e,t,1):la(e,t,0),d.push(o),h++,p++}else n<o?h++:(d.push(oy.deepClone(t)),p++)}return p<u.length&&d.push(...u.slice(p)),d.length&&(i.paragraphs=d),i}function lu(e){return 1===Object.keys(e).length}e4(a7,"ActionIterator"),e4(le,"updateAttributeByDelete"),e4(lt,"updateAttributeByInsert"),e4(lr,"updateApply"),e4(ln,"deleteApply"),e4(lo,"insertApply"),e4(li,"textXApply"),e4(ls,"transformTextRuns"),e4(la,"transformParagraph"),e4(ll,"transformBody"),e4(lu,"onlyHasDataStream");let lc=class e{constructor(){e9(this,"_actions",[])}static apply(e,t){return li(e,t)}static compose(t,r){let n=new a7(t),o=new a7(r),i=new e;for(;n.hasNext()||o.hasNext();)if(o.peekType()===sK.INSERT)i.push(o.next());else if(n.peekType()===sK.DELETE)i.push(n.next());else{let e=Math.min(n.peekLength(),o.peekLength()),t=n.next(e),r=o.next(e);t.t===sK.INSERT&&r.t===sK.RETAIN?null==r.body?i.push(t):i.push({...t,body:a9(t.body,r.body,r.coverType)}):t.t===sK.RETAIN&&r.t===sK.RETAIN?null==t.body&&null==r.body?i.push(t.len!==Number.POSITIVE_INFINITY?t:r):t.body&&r.body?i.push({...t,body:a9(t.body,r.body,r.coverType)}):i.push(t.body?t:r):t.t===sK.RETAIN&&r.t===sK.DELETE?i.push(r):t.t===sK.INSERT&&(r.t,sK.DELETE)}return i.trimEndUselessRetainAction(),i.serialize()}static transform(e,t,r="right"){return this._transform(t,e,"left"===r?"right":"left")}static _transform(t,r,n="right"){var o;let i=new a7(t),s=new a7(r),a=new e;for(;i.hasNext()||s.hasNext();)if(i.peekType()===sK.INSERT&&("left"===n||s.peekType()!==sK.INSERT)){let e=i.next();a.retain(e.len,null!=(o=e.segmentId)?o:"")}else if(s.peekType()===sK.INSERT)a.push(s.next());else{let e=Math.min(i.peekLength(),s.peekLength()),t=i.next(e),r=s.next(e);if(t.t===sK.DELETE)continue;if(r.t===sK.DELETE){a.push(r);continue}null==t.body||null==r.body?a.push(r):a.push({...r,body:ll(t,r,"left"===n)})}return a.trimEndUselessRetainAction(),a.serialize()}static transformPosition(e,t,r=!1){let n=new a7(e),o=0;for(;n.hasNext()&&o<=t;){let e=n.peekLength(),i=n.peekType();if(n.next(),i===sK.DELETE){t-=Math.min(e,t-o);continue}i===sK.INSERT&&(o<t||!r)&&(t+=e),o+=e}return t}static isNoop(e){return 0===e.length}static invert(e){let t=[];for(let r of e)if(r.t===sK.INSERT)t.push({t:sK.DELETE,len:r.len,line:0,body:r.body,segmentId:r.segmentId});else if(r.t===sK.DELETE){if(null==r.body)throw Error("Can not invert DELETE action without body property, makeInvertible must be called first.");t.push({t:sK.INSERT,body:r.body,len:r.len,line:0,segmentId:r.segmentId})}else if(null!=r.body){if(null==r.oldBody)throw Error("Can not invert RETAIN action without oldBody property, makeInvertible must be called first.");t.push({t:sK.RETAIN,body:r.oldBody,oldBody:r.body,len:r.len,coverType:oX.REPLACE,segmentId:r.segmentId})}else t.push(r);return t}static makeInvertible(e,t){let r=[],n=0;for(let o of e){if(o.t===sK.DELETE&&null==o.body){let e=a5(t,n,n+o.len,!1);o.len=e.dataStream.length,o.body=e}if(o.t===sK.RETAIN&&null!=o.body){let e=a5(t,n,n+o.len,!0);o.oldBody={...e,dataStream:""},o.len=e.dataStream.length}r.push(o),o.t!==sK.INSERT&&(n+=o.len)}return r}insert(e,t,r=""){let n={t:sK.INSERT,body:t,len:e,line:0,segmentId:r};return this.push(n),this}retain(e,t="",r,n){let o={t:sK.RETAIN,len:e,segmentId:t};return null!=r&&(o.body=r),null!=n&&(o.coverType=n),this.push(o),this}delete(e,t=""){let r={t:sK.DELETE,len:e,line:0,segmentId:t};return this.push(r),this}empty(){return this._actions=[],this}serialize(){return this._actions}push(...e){if(e.length>1){for(let t of e)this.push(t);return this}let t=this._actions.length,r=this._actions[t-1],n=oy.deepClone(e[0]);if(n.t===sK.RETAIN&&0===n.len&&null==n.body)return this;if("object"==typeof r){if(r.t===sK.DELETE&&n.t===sK.DELETE)return r.len+=n.len,this;if(r.t===sK.DELETE&&n.t===sK.INSERT&&(t-=1,null==(r=this._actions[t-1])))return this._actions.unshift(n),this;if(r.t===sK.RETAIN&&n.t===sK.RETAIN&&null==r.body&&null==n.body)return r.len+=n.len,this;if(r.t===sK.INSERT&&lu(r.body)&&n.t===sK.INSERT&&lu(n.body))return r.len+=n.len,r.body.dataStream+=n.body.dataStream,this}return t===this._actions.length?this._actions.push(n):this._actions.splice(t,0,n),this}trimEndUselessRetainAction(){let e=this._actions[this._actions.length-1];for(;e&&e.t===sK.RETAIN&&a8(e);)this._actions.pop(),e=this._actions[this._actions.length-1];return this}};e4(lc,"TextX"),e9(lc,"id","text-x"),e9(lc,"uri","https://github.com/dream-num/univer#text-x");let ld=lc;Object.defineProperty(ld,"name",{value:"text-x"});let lh=class e{static registerSubtype(e){var t;null==e||this._subTypes.has(e.name)&&(null==(t=this._subTypes.get(e.name))?void 0:t.id)!==ld.id||(this._subTypes.set(e.name,e),sd.type.registerSubtype(e))}static apply(e,t){if(!sd.type.isNoop(t))return sd.type.apply(e,t)}static compose(e,t){return sd.type.compose(e,t)}static transform(e,t,r){return sd.type.transform(e,t,r)}static transformPosition(e,t,r="right"){return e&&2===e.length&&"body"===e[0]&&e[1].et===ld.name?ld.transformPosition(e[1].e,t,"left"===r):t}static invertWithDoc(e,t){return sd.type.invertWithDoc(e,t)}static isNoop(e){return sd.type.isNoop(e)}static getInstance(){return null==this._instance&&(this._instance=new e),this._instance}removeOp(e,t){return sd.removeOp(e,t)}moveOp(e,t){return sd.moveOp(e,t)}insertOp(e,t){return sd.insertOp(e,t)}replaceOp(e,t,r){return sd.replaceOp(e,t,r)}editOp(e,t=["body"]){return sd.editOp(t,ld.name,e)}};e4(lh,"JSONX"),e9(lh,"uri","https://github.com/dream-num/univer#json-x"),e9(lh,"_subTypes",/* @__PURE__ */new Map),e9(lh,"_instance",null);let lp=lh;lp.registerSubtype(ld);let lf={id:"default_doc",documentStyle:{}},lg=class extends su{constructor(e){var t;super(),e9(this,"type",si.UNIVER_DOC),e9(this,"_name$",new eK.BehaviorSubject("")),e9(this,"name$",this._name$.asObservable()),e9(this,"snapshot"),this.snapshot={...lf,...e},this._name$.next(null!=(t=this.snapshot.title)?t:"No Title")}getUnitId(){throw Error("Method not implemented.")}getRev(){var e;return null!=(e=this.snapshot.rev)?e:1}incrementRev(){this.snapshot.rev=this.getRev()+1}setRev(e){this.snapshot.rev=e}setName(e){this.snapshot.title=e,this._name$.next(e)}get drawings(){return this.snapshot.drawings}get documentStyle(){return this.snapshot.documentStyle}get lists(){return this.snapshot.lists}get zoomRatio(){var e;return(null==(e=this.snapshot.settings)?void 0:e.zoomRatio)||1}resetDrawing(e,t){this.snapshot.drawings=e,this.snapshot.drawingsOrder=t}getBody(){return this.snapshot.body}getSnapshot(){return this.snapshot}getBulletPresetList(){var e;let t=null!=(e=this.snapshot.lists)?e:{};return{...aO,...t}}updateDocumentId(e){this.snapshot.id=e}updateDocumentRenderConfig(e){let{documentStyle:t}=this.snapshot;null==t.renderConfig?t.renderConfig=e:t.renderConfig={...t.renderConfig,...e}}updateDocumentStyle(e){null==this.snapshot.documentStyle?this.snapshot.documentStyle=e:this.snapshot.documentStyle={...this.snapshot.documentStyle,...e}}updateDocumentDataMargin(e){let{t:t,l:r,b:n,r:o}=e,{documentStyle:i}=this.snapshot;null!=t&&(i.marginTop=t),null!=r&&(i.marginLeft=r),null!=n&&(i.marginBottom=n),null!=o&&(i.marginRight=o)}updateDocumentDataPageSize(e,t){let{documentStyle:r}=this.snapshot;if(!r.pageSize){e=null!=e?e:Number.POSITIVE_INFINITY,t=null!=t?t:Number.POSITIVE_INFINITY,r.pageSize={width:e,height:t};return}void 0!==e&&(r.pageSize.width=e),void 0!==t&&(r.pageSize.height=t)}updateDrawing(e,t){let{drawings:r}=this,{width:n,height:o,left:i,top:s}=t,a=null==r?void 0:r[e];if(!a)return;let l=a.docTransform;l.size.width=n,l.size.height=o,l.positionH.posOffset=i,l.positionV.posOffset=s}setZoomRatio(e=1){null==this.snapshot.settings?this.snapshot.settings={zoomRatio:e}:this.snapshot.settings.zoomRatio=1}};e4(lg,"DocumentDataModelSimple");let lm=lg,l_=class e extends lm{constructor(e){var t,r;super(oy.isEmptyObject(e)?sc():e),e9(this,"_unitId"),e9(this,"headerModelMap",/* @__PURE__ */new Map),e9(this,"footerModelMap",/* @__PURE__ */new Map),this._unitId=null!=(t=this.snapshot.id)?t:oy.generateRandomId(6),this._initializeHeaderFooterModel(),this._name$.next(null!=(r=this.snapshot.title)?r:"")}dispose(){super.dispose(),this.headerModelMap.forEach(e=>{e.dispose()}),this.footerModelMap.forEach(e=>{e.dispose()}),this._name$.complete()}getDrawings(){return this.snapshot.drawings}getDrawingsOrder(){return this.snapshot.drawingsOrder}getCustomRanges(){var e;return null==(e=this.snapshot.body)?void 0:e.customRanges}getCustomDecorations(){var e;return null==(e=this.snapshot.body)?void 0:e.customDecorations}getSettings(){return this.snapshot.settings}reset(e){if(e.id&&e.id!==this._unitId)throw Error("Cannot reset a document model with a different unit id!");this.snapshot={...lf,...e},this._initializeHeaderFooterModel()}getSelfOrHeaderFooterModel(e){if(null!=e){if(this.headerModelMap.has(e))return this.headerModelMap.get(e);if(this.footerModelMap.has(e))return this.footerModelMap.get(e)}return this}getUnitId(){return this._unitId}apply(e){if(!lp.isNoop(e))return this.snapshot=lp.apply(this.snapshot,e),null!=e&&e.some(e=>Array.isArray(e)&&((null==e?void 0:e[0])==="headers"||(null==e?void 0:e[0])==="footers"))&&(this.headerModelMap.clear(),this.footerModelMap.clear(),this._initializeHeaderFooterModel()),this.snapshot}sliceBody(e,t,r=a2.copy){let n=this.getBody();if(null!=n)return a5(n,e,t,!1,r)}_initializeHeaderFooterModel(){let{headers:t,footers:r}=this.getSnapshot();if(t)for(let r in t){let n=t[r];this.headerModelMap.set(r,new e(n)),this.headerModelMap.get(r).updateDocumentId(this.getUnitId())}if(r)for(let t in r){let n=r[t];this.footerModelMap.set(t,new e(n)),this.footerModelMap.get(t).updateDocumentId(this.getUnitId())}}updateDocumentId(e){super.updateDocumentId(e),this._unitId=e}};e4(l_,"DocumentDataModel");let ly=l_;function lE(e){return e===sq.CUSTOM_RANGE_END||e===sq.CUSTOM_RANGE_START}function lb(e,t,r,n){return e<=r&&t>=r||e>=r&&e<=n}function lv(e,t,r,n){let o=n.slice(r.startIndex+1,r.endIndex),i=Math.max(e-(r.startIndex+1),0),s=e+t-1-(r.startIndex+1);if(s<0)return!1;if(0===i&&s>=o.length)return!0;let a=o.slice(0,i)+o.slice(i+t);for(let e=0,t=a.length;e<t;e++)if(!lE(a[e]))return!1;return!0}function lR(e,t){let r=[];for(let n=0,o=t.length;n<o;n++){let o=t[n];e.collapsed?o.startIndex<e.startOffset&&e.startOffset<=o.endIndex&&r.push(o):lb(e.startOffset,e.endOffset,o.startIndex,o.endIndex)&&r.push(o)}return r}function lT(e){return{...oy.deepClone(e),rangeId:oE()}}function lI(e,t){let r=[],n=e[0];for(let o of t)o<e[0]||o>e[1]||(n<o&&r.push([n,o-1]),n=o+1);return n<=e[1]&&r.push([n,e[1]]),r}e4(lE,"isCustomRangeSplitSymbol"),e4(lb,"isIntersecting"),e4(lv,"shouldDeleteCustomRange"),e4(lR,"getCustomRangesInterestsWithRange"),e4(lT,"copyCustomRange"),e4(lI,"excludePointsFromRange");var lC=((eU=lC||{})[eU.SLIDE=0]="SLIDE",eU[eU.MASTER=1]="MASTER",eU[eU.LAYOUT=2]="LAYOUT",eU[eU.HANDOUT_MASTER=3]="HANDOUT_MASTER",eU[eU.NOTES_MASTER=4]="NOTES_MASTER",eU),lS=((eP=lS||{})[eP.SHAPE=0]="SHAPE",eP[eP.IMAGE=1]="IMAGE",eP[eP.TEXT=2]="TEXT",eP[eP.SPREADSHEET=3]="SPREADSHEET",eP[eP.DOCUMENT=4]="DOCUMENT",eP[eP.SLIDE=5]="SLIDE",eP),lO=((ek=lO||{})[ek.RELATIVE_SLIDE_LINK_UNSPECIFIED=0]="RELATIVE_SLIDE_LINK_UNSPECIFIED",ek[ek.NEXT_SLIDE=1]="NEXT_SLIDE",ek[ek.PREVIOUS_SLIDE=2]="PREVIOUS_SLIDE",ek[ek.FIRST_SLIDE=3]="FIRST_SLIDE",ek[ek.LAST_SLIDE=4]="LAST_SLIDE",ek);let lx=[sq.TABLE_START,sq.TABLE_ROW_START,sq.TABLE_CELL_START,sq.TABLE_CELL_END,sq.TABLE_ROW_END,sq.TABLE_END,sq.CUSTOM_RANGE_START,sq.CUSTOM_RANGE_END,sq.CUSTOM_BLOCK],lA=/* @__PURE__ */e4(e=>{let t=e.endsWith(`\r
`)?e.slice(0,-2):e;return lx.reduce((e,t)=>e.replaceAll(t,""),t)},"getPlainText"),lw=/* @__PURE__ */e4(e=>{let t=e.replace(/\n/g,"\r"),r=[],n=[],o=0,i="",s=0,a=/* @__PURE__ */e4((a,l=!0)=>{let u=t.slice(o,a);if(oy.isLegalUrl(u)){let t=oE(),c=`${sq.CUSTOM_RANGE_START}${u}${sq.CUSTOM_RANGE_END}`,d={startIndex:o+2*s,endIndex:o+2*s+c.length-1,rangeId:t,rangeType:s0.HYPERLINK,properties:{url:e}};n.push(d),i+=c,o=a+1,s++,l&&(i+="\r",r.push({startIndex:a+2*s}))}else i+=t.slice(o,a+1),o=a+1,l&&r.push({startIndex:a+2*s})},"loopParagraph"),l=0;for(let e=0;e<t.length;e++)"\r"===t[e]&&(a(e),l=e);return l!==t.length-1&&a(t.length,!1),{dataStream:i,paragraphs:r,customRanges:n}},"fromPlainText");function lN(e,t){if(typeof t>"u")return{startOffset:e,endOffset:e,collapsed:!0};if(t<e)throw Error(`Cannot make a doc selection when endOffset ${t} is less than startOffset ${e}.`);return{startOffset:e,endOffset:t,collapsed:e===t}}function lD(e){let{startOffset:t,endOffset:r,collapsed:n}=e;return{startOffset:Math.min(t,r),endOffset:Math.max(t,r),collapsed:n}}function lL(e,t){let{startOffset:r,endOffset:n}=lD(e);for(;t.dataStream[r-1]===sq.CUSTOM_RANGE_START;)r-=1;for(;t.dataStream[n]===sq.CUSTOM_RANGE_END;)n+=1;return{startOffset:r,endOffset:n}}function lM(e,t,r=n7.LEFT){var n;let{startOffset:o,endOffset:i,collapsed:s}=lD(e);if(s){if(r===n7.LEFT)for(;lE(t.dataStream[o-1]);)i-=1,o-=1;else for(;lE(t.dataStream[o]);)i+=1,o+=1}else{let r=lL(e,t);o=r.startOffset,i=r.endOffset}s=o===i;let a=null==(n=t.customRanges)?void 0:n.filter(e=>!!e.wholeEntity&&(!(o<=e.startIndex)||!(i>e.endIndex))&&lk(o,s?i:i-1,e.startIndex,e.endIndex));return null!=a&&a.length&&a.forEach(e=>{o=Math.min(e.startIndex,o),i=Math.max(e.endIndex+1,i)}),{...e,startOffset:o,endOffset:i,collapsed:o===i}}function lU(e,t){let{startOffset:r,endOffset:n,collapsed:o}=lD(e);if(!o)return{...e,...lL(e,t),collapsed:!1};for(;t.dataStream[n]===sq.CUSTOM_RANGE_END;)n+=1,r+=1;for(;t.dataStream[n-1]===sq.CUSTOM_RANGE_START;)n-=1,r-=1;return{...e,startOffset:r,endOffset:n,collapsed:o}}function lP(e,t){if(e.startOffset===e.endOffset)return null;let r=t.customRanges;if(!r)return lD(e);let{startOffset:n,endOffset:o}=lL(e,t);for(;lE(t.dataStream[n]);){if(t.dataStream[n]===sq.CUSTOM_RANGE_START){let e=r.find(e=>e.startIndex===n);if(!e)throw Error("No custom-range matched");if(e.endIndex===o-1)return{startOffset:n,endOffset:o,collapsed:!1};if(e.endIndex<o-1)break}n+=1}for(;lE(t.dataStream[o-1]);){if(t.dataStream[n]===sq.CUSTOM_RANGE_END){let e=r.find(e=>e.endIndex===o-1);if(!e)throw Error("No custom-range matched");if(e.startIndex===n)return{startOffset:n,endOffset:o,collapsed:!1};if(e.startIndex>n)break}o-=1}return o<=n?null:{startOffset:n,endOffset:o,collapsed:!1}}function lk(e,t,r,n){return Math.max(e,r)<=Math.min(t,n)}function lF(e,t="",r,n){var o;let{startOffset:i,endOffset:s}=e,a=[],l=i-r,u=s-r,c=n.dataStream,d=null==(o=n.customRanges)?void 0:o.filter(e=>lb(e.startIndex,e.endIndex,i,s)),h=new Set(null==d?void 0:d.filter(e=>lv(i,s-i,e,c))),p=/* @__PURE__ */new Set;null==d||d.forEach(e=>{h.has(e)||(e.startIndex-r>=l&&e.startIndex-r<=u&&e.endIndex-r>u&&p.add(e.startIndex),e.endIndex-r>=l&&e.endIndex-r<=u&&e.startIndex<l&&p.add(e.endIndex))}),l>0&&a.push({t:sK.RETAIN,len:l,segmentId:t});let f=[...p].sort((e,t)=>e-t),g=l;return f.forEach(e=>{let r=e-g;r>0&&a.push({t:sK.DELETE,len:r,line:0,segmentId:t}),a.push({t:sK.RETAIN,len:1,segmentId:t}),g=e+1}),g<u&&(a.push({t:sK.DELETE,len:u-g,line:0,segmentId:t}),g=u+1),{dos:a,cursor:g,retain:p.size}}function lj(e,t){var r,n;let{rangeId:o,segmentId:i,documentDataModel:s,insert:a}=t,l=null==(n=null==(r=s.getSelfOrHeaderFooterModel(i).getBody())?void 0:r.customRanges)?void 0:n.find(e=>e.rangeId===o);if(!l)return!1;let{startIndex:u,endIndex:c}=l,d=new ld,h=c-u+1;return u>0&&d.push({t:sK.RETAIN,len:u,segmentId:i}),d.push({t:sK.DELETE,len:1,segmentId:i,line:0}),h-2>0&&d.push({t:sK.RETAIN,len:h-2,segmentId:i}),d.push({t:sK.DELETE,len:1,segmentId:i,line:0}),a&&d.push({body:a,t:sK.INSERT,len:a.dataStream.length,segmentId:i,line:1}),d}function lB(e){var t,r;let{range:n,rangeId:o,rangeType:i,segmentId:s,wholeEntity:a,properties:l,body:u}=e,c=lP(n,u);if(!c||!u)return!1;let{startOffset:d,endOffset:h}=c,p=null!=(t=u.customRanges)?t:[],f=0,g=new ld,m=/* @__PURE__ */e4((e,t,r)=>{let n=[];for(let r=0,o=p.length;r<o;r++){let o=p[r];if(o.rangeType===i&&Math.max(o.startIndex,e)<=Math.min(o.endIndex,t)&&n.push({...o}),o.startIndex>t)break}let u=n.map(e=>[e.startIndex,e.endIndex]).flat().sort((e,t)=>e-t),c=u.length?{startOffset:Math.min(u[0],e),endOffset:Math.max(u[u.length-1]+1,t+1)}:{startOffset:e,endOffset:t+1};c.startOffset!==f&&(g.push({t:sK.RETAIN,len:c.startOffset-f,segmentId:s}),f=c.startOffset),g.push({t:sK.INSERT,body:{dataStream:sq.CUSTOM_RANGE_START},len:1,line:0,segmentId:s}),u.forEach(e=>{e!==f&&(g.push({t:sK.RETAIN,len:e-f,segmentId:s}),f=e),g.push({t:sK.DELETE,len:1,line:0,segmentId:s}),f++}),f!==c.endOffset&&(g.push({t:sK.RETAIN,len:c.endOffset-f,segmentId:s}),f=c.endOffset),g.push({t:sK.INSERT,body:{dataStream:sq.CUSTOM_RANGE_END,customRanges:[{rangeId:r?`${o}-${r}`:o,rangeType:i,startIndex:-(c.endOffset-c.startOffset-u.length+1),endIndex:0,wholeEntity:a,properties:{...l}}]},len:1,line:0,segmentId:s})},"addCustomRange"),_=(null!=(r=u.paragraphs)?r:[]).filter(e=>e.startIndex<h&&e.startIndex>d);return lI([d,h-1],_.map(e=>e.startIndex)).forEach(([e,t],r)=>m(e,t,r)),g}function lH(e,t,r="",n=0,o=!0){var i;let{startOffset:s,endOffset:a}=lM(e,t),l=[],{paragraphs:u=[],dataStream:c}=t,d=s-n,h=a-n,p=null==u?void 0:u.find(e=>e.startIndex-n>=d&&e.startIndex-n<h),f=null==(i=t.customRanges)?void 0:i.filter(e=>lb(e.startIndex,e.endIndex,s,a)),g=new Set(null==f?void 0:f.filter(e=>lv(s,a-s,e,c))),m=/* @__PURE__ */new Set;if(null==f||f.forEach(e=>{g.has(e)||(e.startIndex-n>=d&&e.startIndex-n<=h&&e.endIndex-n>h&&m.add(e.startIndex),e.endIndex-n>=d&&e.endIndex-n<=h&&e.startIndex<d&&m.add(e.endIndex))}),d>0&&l.push({t:sK.RETAIN,len:d,segmentId:r}),o&&p&&p.startIndex-n>d){let e=p.startIndex-n;m.add(e)}let _=[...m].sort((e,t)=>e-t),y=d;return _.forEach(e=>{let t=e-y;t>0&&l.push({t:sK.DELETE,len:t,line:0,segmentId:r}),l.push({t:sK.RETAIN,len:1,segmentId:r}),y=e+1}),y<h&&l.push({t:sK.DELETE,len:h-y,line:0,segmentId:r}),l}e4(lN,"makeSelection"),e4(lD,"normalizeSelection"),e4(lL,"getSelectionWithSymbolMax"),e4(lM,"getDeleteSelection"),e4(lU,"getInsertSelection"),e4(lP,"getSelectionForAddCustomRange"),e4(lk,"isSegmentIntersects"),e4(lF,"getRetainAndDeleteFromReplace"),e4(lj,"deleteCustomRangeTextX"),e4(lB,"addCustomRangeTextX"),e4(lH,"getRetainAndDeleteAndExcludeLineBreak");let l$=/* @__PURE__ */e4(e=>{var t;let{selection:r,body:n,doc:o}=e,i=r.segmentId,s=null==(t=o.getSelfOrHeaderFooterModel(i))?void 0:t.getBody();if(!s)return!1;let a=new ld,l=lH(r,s,i);return l.length&&a.push(...l),a.push({t:sK.INSERT,body:n,len:n.dataStream.length,line:0,segmentId:i}),a},"replaceSelectionTextX"),lG=class{};e4(lG,"BuildTextUtils"),e9(lG,"customRange",{add:lB,delete:lj,copyCustomRange:lT,getCustomRangesInterestsWithRange:lR,shouldDeleteCustomRange:lv,isIntersecting:lb}),e9(lG,"selection",{replace:l$,makeSelection:lN,normalizeSelection:lD,getDeleteSelection:lM,getInsertSelection:lU,getDeleteActions:lF,getDeleteExculdeLastLineBreakActions:lH}),e9(lG,"range",{isIntersects:lk}),e9(lG,"transform",{getPlainText:lA,fromPlainText:lw});let lW=lG;e4(function(e,t,r){let n;if(""===t)return e;let o=new ly({id:"mock-id",body:e,documentStyle:{}}),i=t.length;for(;(n=o.getBody().dataStream.indexOf(t))>=0;){let e=new ld,t=lp.getInstance();if(n>0&&e.retain(n),r.length>0){let t=o.sliceBody(n,n+i),s={dataStream:r};Array.isArray(null==t?void 0:t.textRuns)&&t.textRuns.length&&(s.textRuns=[{...t.textRuns[0],st:0,ed:r.length}]),e.insert(r.length,s)}e.delete(i),o.apply(t.editOp(e.serialize()))}let s=o.getBody();return o.dispose(),s},"replaceInDocumentBody");let lV=class{constructor(){e9(this,"skipNextObservers",!1),e9(this,"lastReturnValue"),e9(this,"isStopPropagation",!1)}stopPropagation(){this.isStopPropagation=!0}};e4(lV,"EventState");let lz=class extends e2.Subject{constructor(){super(...arguments),e9(this,"_sortedObservers",[])}subscribe(){throw Error("[EventSubject]: please use `subscribeEvent` instead of `subscribe` method for `EventSubject`.")}next(){throw Error("[EventSubject]: please use `emitEvent` instead of `next` method for `EventSubject`.")}unsubscribe(){super.unsubscribe(),this._sortedObservers.length=0}complete(){super.complete(),this._sortedObservers.length=0}subscribeEvent(e){let t;t="function"==typeof e?{next:/* @__PURE__ */e4(([t,r])=>e(t,r),"next")}:e;let r=super.subscribe(t);return this._sortedObservers.push(t),this._sortedObservers.sort((e,t)=>{var r,n;return(null!=(r=e.priority)?r:0)-(null!=(n=t.priority)?n:0)}),r.add(()=>this._sortedObservers=this._sortedObservers.filter(e=>e!==t)),r}clearObservers(){this._sortedObservers.forEach(e=>{var t;return null==(t=e.complete)?void 0:t.call(e)}),this._sortedObservers.length=0}emitEvent(e){var t;if(!this.closed){let r=new lV;for(let n of(r.lastReturnValue=e,this._sortedObservers)){let o=null==(t=n.next)?void 0:t.call(n,[e,r]);if(r.lastReturnValue=o,r.skipNextObservers)return{handled:!0,lastReturnValue:r.lastReturnValue,stopPropagation:r.isStopPropagation}}return{handled:this._sortedObservers.length>0,lastReturnValue:r.lastReturnValue,stopPropagation:r.isStopPropagation}}throw Error("[EventSubject]: cannot emit event on a closed subject.")}};e4(lz,"EventSubject");let lK=lz;function lY(e){return new eZ.Observable(t=>{let r=e.subscribeEvent(e=>{t.next(e)});return()=>r.unsubscribe()})}e4(lY,"fromEventSubject");let lq=tL("core.resource-manager.service");var lJ=((eF=lJ||{})[eF.Starting=0]="Starting",eF[eF.Ready=1]="Ready",eF[eF.Rendered=2]="Rendered",eF[eF.Steady=3]="Steady",eF);let lX={0:"Starting",1:"Ready",2:"Rendered",3:"Steady"},lQ=/* @__PURE__ */new Map;function lZ(e,t){return /* @__PURE__ */e4(function(r){l0(e,t)},"decorator2")}function l0(e,t){lQ.has(e)||lQ.set(e,[]),lQ.get(e).push(t)}e4(lZ,"OnLifecycle"),e4(l0,"runOnLifecycle");let l1={[ss.Editor]:"Editor",[ss.Owner]:"Owner",[ss.Reader]:"Reader",[ss.UNRECOGNIZED]:"UNRECOGNIZED"},l2=/* @__PURE__ */e4(e=>e?{userID:`${l1[e]}_${oy.generateRandomId(8)}`,name:l1[e],avatar:""}:{userID:"",name:"",avatar:"",anonymous:!0,canBindAnonymous:!1},"createDefaultUser"),l5=/* @__PURE__ */e4((e,t)=>e.startsWith(l1[t]),"isDevRole");var l3,l6,l4,l9,l8=Object.defineProperty,l7=Object.getOwnPropertyDescriptor,ue=/* @__PURE__ */e4((e,t,r,n)=>{for(var o,i=n>1?void 0:n?l7(t,r):t,s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&l8(t,r,i),i},"__decorateClass$7");let ut=(e4(l9=class{constructor(){e9(this,"_model",/* @__PURE__ */new Map),e9(this,"_userChange$",new e2.Subject),e9(this,"userChange$",this._userChange$.asObservable()),e9(this,"_currentUser$",new eK.BehaviorSubject(l2())),e9(this,"currentUser$",this._currentUser$.asObservable())}getCurrentUser(){return this._currentUser$.getValue()}setCurrentUser(e){this.addUser(e),this._currentUser$.next(e)}addUser(e){this._model.set(e.userID,e),this._userChange$.next({type:"add",user:e})}getUser(e,t){let r=this._model.get(e);if(r)return r;t&&t()}delete(e){let t=this.getUser(e);this._model.delete(e),t&&this._userChange$.next({type:"delete",user:t})}clear(){this._model.clear(),this._userChange$.next({type:"clear"})}list(){return Array.from(this._model.values())}},"UserManagerService"),l9);ut=ue([lZ(lJ.Starting,ut)],ut);var ur,un=Object.defineProperty,uo=Object.getOwnPropertyDescriptor,ui=/* @__PURE__ */e4((e,t,r,n)=>{for(var o,i=n>1?void 0:n?uo(t,r):t,s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&un(t,r,i),i},"__decorateClass$6"),us=/* @__PURE__ */e4((e,t)=>(r,n)=>t(r,n,e),"__decorateParam$6");let ua=(ur=class{constructor(e,t){e9(this,"_permissionMap",/* @__PURE__ */new Map([])),this._resourceManagerService=e,this._userManagerService=t,this._initSnapshot(),this._initDefaultUser()}_initDefaultUser(){let e=this._userManagerService.getCurrentUser();e&&e.userID||this._userManagerService.setCurrentUser(l2(ss.Owner))}_getRole(e){let t=this._userManagerService.getCurrentUser();return!!t&&l5(t.userID,e)}_initSnapshot(){this._resourceManagerService.registerPluginResource({toJson:/* @__PURE__ */e4(e=>JSON.stringify([...this._permissionMap.keys()].reduce((e,t)=>{let r=this._permissionMap.get(t);return e[t]=r,e},{})),"toJson"),parseJson:/* @__PURE__ */e4(e=>JSON.parse(e),"parseJson"),pluginName:"SHEET_AuthzIoMockService_PLUGIN",businesses:[si.UNIVER_SHEET,si.UNIVER_DOC,si.UNIVER_SLIDE],onLoad:/* @__PURE__ */e4((e,t)=>{for(let e in t)this._permissionMap.set(e,t[e])},"onLoad"),onUnLoad:/* @__PURE__ */e4(()=>{this._permissionMap.clear()},"onUnLoad")})}async create(e){return oE(8)}async allowed(e){return Promise.resolve([])}async batchAllowed(e){return Promise.resolve([])}async list(e){let t=[];return e.objectIDs.forEach(r=>{let n=this._permissionMap.get(r);if(n){let o={objectID:r,unitID:e.unitID,objectType:n.objectType,name:n.name,shareOn:!1,shareRole:ss.Owner,shareScope:-1,scope:{read:sa.AllCollaborator,edit:sa.AllCollaborator},creator:l2(ss.Owner),strategies:[{action:6,role:1},{action:16,role:1},{action:17,role:1},{action:18,role:1},{action:19,role:1},{action:33,role:1},{action:34,role:1},{action:35,role:1},{action:36,role:1},{action:37,role:1},{action:38,role:1},{action:39,role:1},{action:40,role:1}],actions:e.actions.map(e=>({action:e,allowed:this._getRole(ss.Owner)||this._getRole(ss.Editor)}))};t.push(o)}}),t}async listCollaborators(){return[]}async listRoles(){return{roles:[],actions:[]}}async deleteCollaborator(){}async update(e){}async updateCollaborator(){}async createCollaborator(){}async putCollaborators(e){}},e4(ur,"AuthzIoLocalService"),ur);ua=ui([us(0,lq),us(1,t$(ut))],ua);let ul=tL("IAuthzIoIoService"),uu=tL("univer.config-service"),uc=class{constructor(){e9(this,"_config",/* @__PURE__ */new Map)}getConfig(e){return this._config.get(e)}setConfig(e,t,r){var n;let{merge:o=!1}=r||{},i=null!=(n=this._config.get(e))?n:{};if(o){this._config.set(e,oy.deepMerge(i,t));return}this._config.set(e,t)}deleteConfig(e){return this._config.delete(e)}};e4(uc,"ConfigService");let ud="FOCUSING_UNIT",uh="FOCUSING_SHEET",up="FOCUSING_DOC",uf="FOCUSING_SLIDE",ug="FOCUSING_EDITOR_BUT_HIDDEN",um="EDITOR_ACTIVATED",u_="FOCUSING_EDITOR_INPUT_FORMULA",uy="FOCUSING_FX_BAR_EDITOR",uE="FOCUSING_UNIVER_EDITOR",ub="FOCUSING_EDITOR_INPUT_FORMULA",uv="FOCUSING_UNIVER_EDITOR_STANDALONE_SINGLE_MODE",uR="FOCUSING_COMMON_DRAWINGS",uT="FORMULA_EDITOR_ACTIVATED",uI=class extends nn{constructor(){super(...arguments),e9(this,"_error$",new e2.Subject),e9(this,"error$",this._error$.asObservable())}dispose(){this._error$.complete()}emit(e){this._error$.next({errorKey:e})}};e4(uI,"ErrorService");let uC=uI;function uS(e="",t=nG.ZH_CN,r=""){return{id:e,sheetOrder:[],name:r,appVersion:"0.2.15",locale:t,styles:{},sheets:{},resources:[]}}e4(uS,"getEmptySnapshot");let uO=class{constructor(e={}){e9(this,"_styles"),e9(this,"_cacheMap",new iA(1e5)),this._styles=e,this._generateCacheMap()}each(e){return Object.entries(this._styles).forEach(e),this}search(e,t){return this._cacheMap.has(t)?this._cacheMap.get(t):this._getExistingStyleId(e)||"-1"}get(e){return"string"!=typeof e?e:(e=String(e),this._styles[e])}add(e,t){let r=oy.generateRandomId(6);return this._styles[r]=e,this._cacheMap.set(t,r),r}setValue(e){if(null==e)return;let t=JSON.stringify(e),r=this.search(e,t);return"-1"!==r?r:this.add(e,t)}toJSON(){return this._styles}getStyleByCell(e){let t;t=e&&oy.isObject(e.s)?e.s:(null==e?void 0:e.s)&&this.get(e.s);let r=null==e?void 0:e.interceptorStyle;return r?{...t,...r}:t}_generateCacheMap(){let{_styles:e,_cacheMap:t}=this;for(let r in e){let n=JSON.stringify(e[r]);t.set(n,r)}}_getExistingStyleId(e){let{_styles:t}=this;for(let r in t)if(oy.diffValue(t[r],e))return r;return null}};e4(uO,"Styles");let ux=class{constructor(e,t){e9(this,"_columnData",{}),this._config=e,this._columnData=t}getColumnData(){return this._columnData}getColVisible(e){let{_columnData:t}=this,r=t[e];return!r||r.hd!==n1.TRUE}getHiddenCols(e=0,t=this.getSize()-1){let r=[],n=!1,o=-1;for(let i=e;i<=t;i++){let e=this.getColVisible(i);n&&e?(n=!1,r.push({rangeType:o2.COLUMN,startColumn:o,endColumn:i-1,startRow:0,endRow:0})):n||e||(n=!0,o=i)}return n&&r.push({startRow:0,endRow:0,startColumn:o,endColumn:t,rangeType:o2.COLUMN}),r}getVisibleCols(e=0,t=this.getSize()-1){let r=[],n=!1,o=-1;for(let i=e;i<=t;i++){let e=this.getColVisible(i);n&&!e?(n=!1,r.push({rangeType:o2.COLUMN,startColumn:o,endColumn:i-1,startRow:0,endRow:0})):!n&&e&&(n=!0,o=i)}return n&&r.push({startRow:0,endRow:0,startColumn:o,endColumn:t,rangeType:o2.COLUMN}),r}getColumnDatas(e,t){let r={},n=0;for(let o=e;o<e+t;o++){let e=this.getColumnOrCreate(o);r[n]=e,n++}return r}getSize(){return iM(this._columnData)}getColumnWidth(e){let{_columnData:t}=this,r=this._config;return(t[e]||{hd:n1.FALSE,w:r.defaultColumnWidth}).w||r.defaultColumnWidth}getColumn(e){let t=this._columnData[e];if(t)return t}getColumnOrCreate(e){let{_columnData:t}=this,r=this._config,n=t[e];if(n)return n;let o={w:r.defaultColumnWidth,hd:n1.FALSE};return this._columnData[e]=o,o}};e4(ux,"ColumnManager");let uA=class{constructor(e,t,r){e9(this,"_rowData"),this._config=e,this._viewModel=t,this._rowData=r}getRowData(){return this._rowData}getRowDatas(e,t){let r={},n=0;for(let o=e;o<e+t;o++){let e=this.getRowOrCreate(o);r[n]=e,n++}return r}getRowHeight(e,t=1){let{_rowData:r}=this,n=this._config,o=0;for(let i=0;i<t;i++){let{ia:t,ah:s,h:a=n.defaultRowHeight}=r[i+e]||{hd:n1.FALSE,h:n.defaultRowHeight};o+=(null==t||t===n1.TRUE)&&"number"==typeof s?s:a}return o}getRow(e){return this._rowData[e]}getRowOrCreate(e){let{_rowData:t}=this,r=t[e];if(r)return r;let n=this._config,o={hd:n1.FALSE,h:n.defaultRowHeight};return t[e]=o,o}getHiddenRows(e=0,t=this.getSize()-1){let r=[],n=!1,o=-1;for(let i=e;i<=t;i++){let e=this.getRowRawVisible(i);n&&e?(n=!1,r.push({startRow:o,endRow:i-1,startColumn:0,endColumn:0,rangeType:o2.ROW})):n||e||(n=!0,o=i)}return n&&r.push({startRow:o,endRow:t,startColumn:0,endColumn:0,rangeType:o2.ROW}),r}getVisibleRows(e=0,t=this.getSize()-1){let r=[],n=!1,o=-1;for(let i=e;i<=t;i++){let e=this.getRowRawVisible(i);n&&!e?(n=!1,r.push({startRow:o,endRow:i-1,startColumn:0,endColumn:0,rangeType:o2.ROW})):!n&&e&&(n=!0,o=i)}return n&&r.push({startRow:o,endRow:t,startColumn:0,endColumn:0,rangeType:o2.ROW}),r}getRowRawVisible(e){let t=this.getRow(e);return!t||t.hd!==n1.TRUE}getSize(){return iM(this._rowData)}};e4(uA,"RowManager");let uw=24,uN="DEFAULT_WORKSHEET_COLUMN_WIDTH",uD=88;function uL(e){let t={name:"Sheet1",id:"sheet-01",tabColor:"",hidden:n1.FALSE,rowCount:1e3,columnCount:20,zoomRatio:1,freeze:{xSplit:0,ySplit:0,startRow:-1,startColumn:-1},scrollTop:0,scrollLeft:0,defaultColumnWidth:uD,defaultRowHeight:uw,mergeData:[],cellData:{},rowData:{},columnData:{},showGridlines:n1.TRUE,rowHeader:{width:46,hidden:n1.FALSE},columnHeader:{height:20,hidden:n1.FALSE},rightToLeft:n1.FALSE};return Object.keys(t).forEach(r=>{typeof e[r]>"u"&&(e[r]=t[r])}),e}e4(uL,"mergeWorksheetSnapshotWithDefault");let uM=class extends nn{constructor(e){super(),e9(this,"_cellCache",{}),e9(this,"_rowCache",{}),e9(this,"_columnCache",{}),e9(this,"_hasAll",!1),e9(this,"_allIndex",-1),e9(this,"_mergeData"),e9(this,"_rangeMap",new iA(5e4)),e9(this,"_skeletonCache",new iA(5e4)),this._init(e.concat())}_init(e){this._mergeData=e,this._createCache(e)}_clearCache(){this._cellCache={},this._rowCache={},this._columnCache={},this._hasAll=!1,this._allIndex=-1,this._rangeMap.clear(),this._skeletonCache.clear()}_createCache(e){let t=0;for(let r of e){let{rangeType:e}=r;e===o2.ROW?this._createRowCache(r,t):e===o2.COLUMN?this._createColumnCache(r,t):e===o2.ALL?this._createCellAllCache(t):this._createCellCache(r,t),t++}}rebuild(e){this._clearCache(),this._init(e.concat())}_createRowCache(e,t){let{startRow:r,endRow:n}=e;for(let e=r;e<=n;e++){let r=`${e}`;this._rowCache[r]=t}}_createColumnCache(e,t){let{startColumn:r,endColumn:n}=e;for(let e=r;e<=n;e++){let r=`${e}`;this._columnCache[r]=t}}_createCellAllCache(e){this._hasAll=!0,this._allIndex=e}_createCellCache(e,t){for(let r=e.startRow;r<=e.endRow;r++)for(let n=e.startColumn;n<=e.endColumn;n++)this._cellCache[`${r}-${n}`]=t}add(e){this._mergeData.push(e),this._clearCache(),this._createCache(this._mergeData)}remove(e,t){let r=this._getMergeDataIndex(e,t);-1!==r&&(this._mergeData.splice(r,1),this._clearCache(),this._createCache(this._mergeData))}getMergedCell(e,t){let r=this._getMergeDataIndex(e,t);return -1!==r?this._mergeData[r]:null}isRowContainsMergedCell(e){return!!this._hasAll||!oy.isEmptyObject(this._columnCache)||this._mergeData.some(t=>t.startRow<=e&&e<=t.endRow)}isColumnContainsMergedCell(e){return!!this._hasAll||!oy.isEmptyObject(this._rowCache)||this._mergeData.some(t=>t.startColumn<=e&&e<=t.endColumn)}getMergedCellRange(e,t,r,n){let o=[],i=`${e}-${t}-${r}-${n}`;if(this._rangeMap.has(i))return this._getRangeFromCache(i);let s=0,a=[];for(let i of this._mergeData||[])i5.intersects(i,{startRow:e,endRow:r,startColumn:t,endColumn:n})&&(o.push({...i}),a.push(s),s++);return this._rangeMap.set(i,a),o}getMergedCellRangeForSkeleton(e,t,r,n){let o=[],i=this._mergeData,s=`${e}-${t}-${r}-${n}`;if(this._skeletonCache.has(s))return this._getSkeletonRangeFromCache(s);let a=[];for(let s=0;s<i.length;s++){let{startRow:l,endRow:u,startColumn:c,endColumn:d}=i[s];for(let i=e;i<=r;i++){let e=!1;for(let r=t;r<=n;r++)if(i>=l&&i<=u&&r>=c&&r<=d){o.push({startRow:l,endRow:u,startColumn:c,endColumn:d}),a.push(s),e=!0;break}if(e)break}}return this._skeletonCache.set(s,a),o}_getRangeFromCache(e){let t=this._rangeMap.get(e)||[],r=[];for(let e of t)r.push({...this._mergeData[e]});return r}_getSkeletonRangeFromCache(e){let t=this._skeletonCache.get(e)||[],r=[];for(let e of t)r.push({...this._mergeData[e]});return r}_getMergeDataIndex(e,t){if(this._hasAll)return this._allIndex;let r=`${e}`,n=`${t}`;if(void 0!==this._rowCache[r])return this._rowCache[r];if(void 0!==this._columnCache[n])return this._columnCache[n];let o=`${e}-${t}`;return void 0!==this._cellCache[o]?this._cellCache[o]:-1}getMergeDataSnapshot(){return this._mergeData}dispose(){this._clearCache(),this._mergeData=[]}};e4(uM,"SpanModel");let uU=class extends nn{constructor(e){super(),e9(this,"_cellContentInterceptor",null),e9(this,"_rowFilteredInterceptor",null),this.getRawCell=e}dispose(){super.dispose(),this._cellContentInterceptor=null,this._rowFilteredInterceptor=null}getCell(e,t){return this._cellContentInterceptor?this._cellContentInterceptor.getCell(e,t):this.getRawCell(e,t)}getRowFiltered(e){var t,r;return null!=(r=null==(t=this._rowFilteredInterceptor)?void 0:t.getRowFiltered(e))&&r}registerCellContentInterceptor(e){if(this._cellContentInterceptor)throw Error("[SheetViewModel]: Interceptor already registered.");return this._cellContentInterceptor=e,r7(()=>this._cellContentInterceptor=null)}registerRowFilteredInterceptor(e){if(this._rowFilteredInterceptor)throw Error("[SheetViewModel]: Interceptor already registered.");return this._rowFilteredInterceptor=e,r7(()=>this._rowFilteredInterceptor=null)}};e4(uU,"SheetViewModel");let uP=class e{constructor(e,t,r){var n;e9(this,"_sheetId"),e9(this,"_snapshot"),e9(this,"_cellData"),e9(this,"_rowManager"),e9(this,"_columnManager"),e9(this,"_viewModel"),e9(this,"_spanModel"),this.unitId=e,this._styles=r,this._snapshot=uL(t);let{columnData:o,rowData:i,cellData:s}=this._snapshot;this._sheetId=null!=(n=this._snapshot.id)?n:oy.generateRandomId(6),this._cellData=new iG(s),this._viewModel=new uU((e,t)=>this.getCellRaw(e,t)),this._rowManager=new uA(this._snapshot,this._viewModel,i),this._columnManager=new ux(this._snapshot,o),this._spanModel=new uM(this._snapshot.mergeData)}__interceptViewModel(e){e(this._viewModel)}getSnapshot(){return this._snapshot}setMergeData(e){this._snapshot.mergeData=e,this.getSpanModel().rebuild(e)}getSpanModel(){return this._spanModel}getCellMatrix(){return this._cellData}getCellMatrixPrintRange(){let e=this.getCellMatrix(),t=this.getMergeData(),r=-1,n=-1,o=-1,i=-1,s=!1,a=!1;return e.forEach((t,l)=>{Object.keys(l).forEach(l=>{let u=+l,c=e.getValue(t,u),d=null!=c&&c.s?this._styles.get(c.s):null,h=(null==d?void 0:d.bd)&&(d.bd.b||d.bd.l||d.bd.r||d.bd.t||d.bd.bc_tr||d.bd.bl_tr||d.bd.ml_tr||d.bd.tl_bc||d.bd.tl_br||d.bd.tl_mr);(c&&(c.v||c.p)||null!=d&&d.bg||h)&&(s?r=Math.min(r,t):(r=t,s=!0),n=Math.max(n,t),a?o=Math.min(o,u):(a=!0,o=u),i=Math.max(i,u))})}),t.forEach(e=>{s?r=Math.min(r,e.startRow):(r=e.startRow,s=!0),n=Math.max(n,e.endRow),a?o=Math.min(o,e.startColumn):(o=e.startColumn,s=!0),i=Math.max(i,e.endColumn)}),s&&a?{startColumn:o,startRow:r,endColumn:i,endRow:n}:null}getRowManager(){return this._rowManager}getUnitId(){return this.unitId}getSheetId(){return this._sheetId}getColumnManager(){return this._columnManager}getName(){return this._snapshot.name}clone(){let{_snapshot:t}=this,r=oy.deepClone(t);return new e(this.unitId,r,this._styles)}getMergeData(){return this._spanModel.getMergeDataSnapshot()}getMergedCell(e,t){return this._spanModel.getMergedCell(e,t)}getMergedCellRange(e,t,r,n){return this._spanModel.getMergedCellRange(e,t,r,n)}isRowContainsMergedCell(e){return this._spanModel.isRowContainsMergedCell(e)}isColumnContainsMergedCell(e){return this._spanModel.isColumnContainsMergedCell(e)}getCellInfoInMergeData(e,t){let r=this.getMergedCell(e,t),n=!1,o=!1,i=e,s=t,a=e,l=t;if(r){let{startRow:u,endRow:c,startColumn:d,endColumn:h}=r;e===u&&t===d?(i=c,s=h,a=u,l=d,o=!0):e>=u&&e<=c&&t>=d&&t<=h&&(i=c,s=h,a=u,l=d,n=!0)}return{actualRow:e,actualColumn:t,isMergedMainCell:o,isMerged:n,endRow:i,endColumn:s,startRow:a,startColumn:l}}getCell(e,t){return e<0||t<0?null:this._viewModel.getCell(e,t)}getCellRaw(e,t){return this.getCellMatrix().getValue(e,t)}getRowFiltered(e){return this._viewModel.getRowFiltered(e)}getMatrixWithMergedCells(e,t,r,n,o=!1){let i=this.getCellMatrix(),s=this._spanModel.getMergedCellRange(e,t,r,n),a=new iG;return i8(e,r,t,n).forEach((e,t)=>{let r=o?this.getCellRaw(e,t):this.getCell(e,t);r&&a.setValue(e,t,r)}),s.forEach(e=>{let{startColumn:t,startRow:r,endColumn:n,endRow:o}=e;i8(r,o,t,n).forEach((e,s)=>{e===r&&s===t&&a.setValue(e,s,{...i.getValue(e,s),rowSpan:o-r+1,colSpan:n-t+1}),(e!==r||s!==t)&&a.realDeleteValue(e,s)})}),a}getRange(e,t,r,n){return"object"==typeof e?new iq(this,e,{getStyles:/* @__PURE__ */e4(()=>this._styles,"getStyles")}):new iq(this,{startRow:e,startColumn:t,endColumn:n||t,endRow:r||e},{getStyles:/* @__PURE__ */e4(()=>this._styles,"getStyles")})}getScrollLeftTopFromSnapshot(){return{scrollLeft:this._snapshot.scrollLeft,scrollTop:this._snapshot.scrollTop}}getZoomRatio(){return this._snapshot.zoomRatio||1}getConfig(){return this._snapshot}getFreeze(){return this._snapshot.freeze}getMaxColumns(){let{_snapshot:e}=this,{columnCount:t}=e;return t}getMaxRows(){let{_snapshot:e}=this,{rowCount:t}=e;return t}getRowCount(){return this._snapshot.rowCount}setRowCount(e){this._snapshot.rowCount=e}getColumnCount(){return this._snapshot.columnCount}setColumnCount(e){this._snapshot.columnCount=e}isSheetHidden(){return this._snapshot.hidden}hasHiddenGridlines(){let{_snapshot:e}=this,{showGridlines:t}=e;return 0===t}getTabColor(){let{_snapshot:e}=this,{tabColor:t}=e;return t}getColumnWidth(e){return this.getColumnManager().getColumnWidth(e)}getRowHeight(e){return this._viewModel.getRowFiltered(e)?0:this.getRowManager().getRowHeight(e)}isRowFiltered(e){return this._viewModel.getRowFiltered(e)}getRowVisible(e){return!this.isRowFiltered(e)&&this.getRowRawVisible(e)}getRowRawVisible(e){return this.getRowManager().getRowRawVisible(e)}getHiddenRows(e,t){let r=this.getMaxColumns()-1,n=this._rowManager.getHiddenRows(e,t);return n.forEach(e=>e.endColumn=r),n}getColVisible(e){return this._columnManager.getColVisible(e)}getHiddenCols(e,t){let r=this.getMaxRows()-1,n=this._columnManager.getHiddenCols(e,t);return n.forEach(e=>e.endRow=r),n}getVisibleRows(){let e=this.getRowCount();return this._rowManager.getVisibleRows(0,e-1)}getVisibleCols(){let e=this.getColumnCount();return this._columnManager.getVisibleCols(0,e-1)}isRightToLeft(){let{_snapshot:e}=this,{rightToLeft:t}=e;return t}getLastRowWithContent(){return this._cellData.getLength()-1}getLastColumnWithContent(){return this._cellData.getRange().endColumn}cellHasValue(e){return e&&(void 0!==e.v||void 0!==e.f||void 0!==e.p)}iterateByRow(e,t=!0){let{startRow:r,startColumn:n,endRow:o,endColumn:i}=e,s=this;return{[Symbol.iterator]:()=>{let e=r,a=n;return{next(){for(;;){if(a>i&&(e+=1,a=n),e>o)return{done:!0,value:void 0};let r=s.getCell(e,a),l=!r,u=s.getMergedCell(e,a);if(u){if(e!==u.startRow||a!==u.startColumn||l&&t){a=u.endColumn+1;continue}let n={row:e,col:a,value:r};return n.colSpan=u.endColumn-u.startColumn+1,n.rowSpan=u.endRow-u.startRow+1,a=u.endColumn+1,{done:!1,value:n}}if(l&&t)a+=1;else{let t={row:e,col:a,value:r};return a+=1,{done:!1,value:t}}}}}}}}iterateByColumn(e,t=!0,r=!0){let{startRow:n,startColumn:o,endRow:i,endColumn:s}=e,a=this;return{[Symbol.iterator]:()=>{let e=n,l=o;return{next(){for(;;){if(e>i&&(l+=1,e=n),l>s)return{done:!0,value:void 0};let o=a.getMergedCell(e,l);if(o){let n=e!==o.startRow,i=n||l!==o.startColumn;if(r&&i||!r&&n){e=o.endRow+1;continue}let s=a.getCell(o.startRow,o.startColumn);if(!s&&t){e=o.endRow+1;continue}let u={row:e,col:o.startColumn,value:s};return u.colSpan=o.endColumn-o.startColumn+1,u.rowSpan=o.endRow-o.startRow+1,e=o.endRow+1,{done:!1,value:u}}let u=a.getCell(e,l);if(!u&&t)e+=1;else{let t={row:e,col:l,value:u};return e+=1,{done:!1,value:t}}}}}}}}};function uk(e){var t,r;if(!e)return"";let n=null==(r=null==(t=e.p)?void 0:t.body)?void 0:r.dataStream;if(n)return lW.transform.getPlainText(n);let o=e.v;return"string"==typeof o?e.t===n2.BOOLEAN?o.toUpperCase():o.replace(/[\r\n]/g,""):"number"==typeof o?e.t===n2.BOOLEAN?o?"TRUE":"FALSE":o.toString():"boolean"==typeof o?o?"TRUE":"FALSE":""}function uF(e){if(null===e)return"";if(null!=e&&e.p){let t=null==e?void 0:e.p.body;if(null==t)return"";let r=t.dataStream;return lW.transform.getPlainText(r)}return null==e?void 0:e.v}e4(uP,"Worksheet"),e4(uk,"extractPureTextFromCell"),e4(uF,"getOriginCellValue");var uj=Object.defineProperty,uB=Object.getOwnPropertyDescriptor,uH=/* @__PURE__ */e4((e,t,r,n)=>{for(var o,i=n>1?void 0:n?uB(t,r):t,s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&uj(t,r,i),i},"__decorateClass$5"),u$=/* @__PURE__ */e4((e,t)=>(r,n)=>t(r,n,e),"__decorateParam$5");e4(function(e,t){return`${e.getUnitId()}|${t.getSheetId()}`},"getWorksheetUID");let uG=(e4(uQ=class extends su{constructor(e={},t){super(),e9(this,"type",si.UNIVER_SHEET),e9(this,"_sheetCreated$",new e2.Subject),e9(this,"sheetCreated$",this._sheetCreated$.asObservable()),e9(this,"_sheetDisposed$",new e2.Subject),e9(this,"sheetDisposed$",this._sheetDisposed$.asObservable()),e9(this,"_activeSheet$",new eK.BehaviorSubject(null)),e9(this,"activeSheet$",this._activeSheet$.asObservable()),e9(this,"_worksheets"),e9(this,"_styles"),e9(this,"_snapshot"),e9(this,"_unitId"),e9(this,"_count"),e9(this,"_name$"),e9(this,"name$"),this._logService=t;let r=uS();oy.isEmptyObject(e)?this._snapshot=r:this._snapshot=oy.commonExtend(r,e);let{styles:n}=this._snapshot;(null==this._snapshot.id||0===this._snapshot.id.length)&&(this._snapshot.id=oy.generateRandomId(6)),this._unitId=this._snapshot.id,this._styles=new uO(n),this._count=1,this._worksheets=/* @__PURE__ */new Map,this._name$=new eK.BehaviorSubject(e.name||""),this.name$=this._name$.asObservable(),this._parseWorksheetSnapshots()}get _activeSheet(){return this._activeSheet$.getValue()}get name(){return this._name$.getValue()}static isIRangeType(e){return"string"==typeof e||"startRow"in e||"row"in e}dispose(){super.dispose(),this._sheetCreated$.complete(),this._sheetDisposed$.complete(),this._activeSheet$.complete(),this._name$.complete()}save(){return oy.deepClone(this._snapshot)}getSnapshot(){return this._snapshot}getName(){return this._snapshot.name}setName(e){this._name$.next(e),this._snapshot.name=e}getUnitId(){return this._unitId}getRev(){var e;return null!=(e=this._snapshot.rev)?e:1}incrementRev(){this._snapshot.rev=this.getRev()+1}setRev(e){this._snapshot.rev=e}addWorksheet(e,t,r){let{sheets:n,sheetOrder:o}=this._snapshot;if(n[e])return!1;n[e]=r,o.splice(t,0,e);let i=new uP(this._unitId,r,this._styles);return this._worksheets.set(e,i),this._sheetCreated$.next(i),!0}getSheetOrders(){return this._snapshot.sheetOrder}getWorksheets(){return this._worksheets}getActiveSpreadsheet(){return this}getStyles(){return this._styles}getConfig(){return this._snapshot}getIndexBySheetId(e){let{sheetOrder:t}=this._snapshot;return t.findIndex(t=>t===e)}getActiveSheet(e){if(!this._activeSheet&&typeof e>"u")throw Error(`[Workbook]: no active Worksheet on Workbook ${this._unitId}!`);return this._activeSheet}ensureActiveSheet(){let e=this._activeSheet;if(e)return e;let t=this._snapshot.sheetOrder;for(let e=0,r=t.length;e<r;e++){let r=this._worksheets.get(t[e]);if(r&&r.isSheetHidden()!==n1.TRUE)return this.setActiveSheet(r),r}let r=this._worksheets.get(t[0]);return this.setActiveSheet(r),r}setActiveSheet(e){this._activeSheet$.next(e)}removeSheet(e){let t=this._worksheets.get(e);return!!t&&(this._worksheets.delete(e),this._snapshot.sheetOrder.splice(this._snapshot.sheetOrder.indexOf(e),1),delete this._snapshot.sheets[e],this._sheetDisposed$.next(t),!0)}getActiveSheetIndex(){let{sheetOrder:e}=this._snapshot;return e.findIndex(e=>this._worksheets.get(e)===this._activeSheet)}getSheetSize(){return this._snapshot.sheetOrder.length}getSheets(){let{sheetOrder:e}=this._snapshot;return e.map(e=>this._worksheets.get(e))}getSheetsName(){let{sheetOrder:e}=this._snapshot,t=[];return e.forEach(e=>{let r=this._worksheets.get(e);r&&t.push(r.getName())}),t}getSheetIndex(e){let{sheetOrder:t}=this._snapshot;return t.findIndex(t=>e.getSheetId()===t)}getSheetBySheetName(e){let{sheetOrder:t}=this._snapshot,r=t.find(t=>this._worksheets.get(t).getName()===e);return this._worksheets.get(r)}getSheetBySheetId(e){return this._worksheets.get(e)}getSheetByIndex(e){let{sheetOrder:t}=this._snapshot;return this._worksheets.get(t[e])}getHiddenWorksheets(){return this.getSheets().filter(e=>e.getConfig().hidden===n1.TRUE).map(e=>e.getConfig().id)}getUnhiddenWorksheets(){return this.getSheets().filter(e=>e.getConfig().hidden!==n1.TRUE).map(e=>e.getConfig().id)}load(e){this._snapshot=e}checkSheetName(e){return this.getSheetsName().includes(e)}uniqueSheetName(e="Sheet1"){let t=e;for(;this.checkSheetName(t);)t=e+this._count,this._count++;return t}generateNewSheetName(e){let t=e+this._count;for(;this.checkSheetName(t);)t=e+this._count,this._count++;return t}_parseWorksheetSnapshots(){let{_snapshot:e,_worksheets:t}=this,{sheets:r,sheetOrder:n}=e;if(oy.isEmptyObject(r)){let e=oy.generateRandomId();r[e]={id:e}}for(let e in r){let o=r[e],{name:i}=o;o.name=this.uniqueSheetName(i),o.name!==i&&this._logService.debug("[Workbook]",`The worksheet name ${i} is duplicated, we changed it to ${o.name}. Please fix the problem in your snapshot.`);let s=new uP(this._unitId,o,this._styles);t.set(e,s),n.includes(e)||n.push(e)}this.ensureActiveSheet()}},"Workbook"),uQ);uG=uH([u$(1,nu)],uG);let uW=class extends su{constructor(e){var t;super(),e9(this,"type",si.UNIVER_SLIDE),e9(this,"_activePage$",new eK.BehaviorSubject(null)),e9(this,"activePage$",this._activePage$.asObservable()),e9(this,"_name$"),e9(this,"name$"),e9(this,"_snapshot"),e9(this,"_unitId"),this._snapshot={...iV,...e},this._unitId=null!=(t=this._snapshot.id)?t:oy.generateRandomId(6),this._name$=new eK.BehaviorSubject(this._snapshot.title),this.name$=this._name$.asObservable()}get _activePage(){var e,t;let r=this._activePage$.getValue();if(!r){let r=null==(e=this.getPageOrder())?void 0:e[0];return r?null==(t=this.getPages())?void 0:t[r]:null}return r}setName(e){var t;this._snapshot.title=e,this._name$.next(e),this._unitId=null!=(t=this._snapshot.id)?t:oE(6)}getRev(){return 0}incrementRev(){}setRev(e){}getSnapshot(){return this._snapshot}getUnitId(){return this._unitId}getPages(){var e;return null==(e=this._snapshot.body)?void 0:e.pages}getPageOrder(){var e;return null==(e=this._snapshot.body)?void 0:e.pageOrder}getPage(e){let t=this.getPages();return null==t?void 0:t[e]}getElementsByPage(e){var t;return null==(t=this.getPage(e))?void 0:t.pageElements}getElement(e,t){var r;return null==(r=this.getElementsByPage(e))?void 0:r[t]}getPageSize(){return this._snapshot.pageSize}getBlankPage(){let e=oE(6);return{id:e,pageType:lC.SLIDE,zIndex:10,title:e,description:"",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{}}}setActivePage(e){this._activePage$.next(e)}getActivePage(){return this._activePage}updatePage(e,t){this._snapshot.body&&(this._snapshot.body.pages[e]=t)}appendPage(e){var t;if(!this._snapshot.body)return;this._snapshot.body.pages[e.id]=e;let r=this._activePage,n=this._snapshot.body.pageOrder.indexOf(null!=(t=null==r?void 0:r.id)?t:"");this._snapshot.body.pageOrder.splice(n+1,0,e.id)}};e4(uW,"SlideDataModel");let uV=uW;var uz=Object.defineProperty,uK=Object.getOwnPropertyDescriptor,uY=/* @__PURE__ */e4((e,t,r,n)=>{for(var o,i=n>1?void 0:n?uK(t,r):t,s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&uz(t,r,i),i},"__decorateClass$4"),uq=/* @__PURE__ */e4((e,t)=>(r,n)=>t(r,n,e),"__decorateParam$4");let uJ=tL("univer.current"),uX=(uZ=class extends nn{constructor(e,t){super(),e9(this,"_unitsByType",/* @__PURE__ */new Map),e9(this,"_createHandler"),e9(this,"_ctorByType",/* @__PURE__ */new Map),e9(this,"_currentUnits",/* @__PURE__ */new Map),e9(this,"_currentUnits$",new eK.BehaviorSubject(this._currentUnits)),e9(this,"currentUnits$",this._currentUnits$.asObservable()),e9(this,"_unitAdded$",new e2.Subject),e9(this,"unitAdded$",this._unitAdded$.asObservable()),e9(this,"_unitDisposed$",new e2.Subject),e9(this,"unitDisposed$",this._unitDisposed$.asObservable()),e9(this,"_focused$",new eK.BehaviorSubject(null)),e9(this,"focused$",this._focused$.asObservable()),this._injector=e,this._contextService=t}dispose(){super.dispose(),this._focused$.complete()}__setCreateHandler(e){this._createHandler=e}createUnit(e,t,r){return this._createHandler(e,t,this._ctorByType.get(e),r)}registerCtorForType(e,t){return this._ctorByType.set(e,t),{dispose:/* @__PURE__ */e4(()=>{this._ctorByType.delete(e)},"dispose")}}getCurrentTypeOfUnit$(e){return this.currentUnits$.pipe((0,eX.map)(t=>{var r;return null!=(r=t.get(e))?r:null}),(0,eq.distinctUntilChanged)())}getCurrentUnitForType(e){return this._currentUnits.get(e)}setCurrentUnitForType(e){let t=this._getUnitById(e);if(!t)throw Error(`[UniverInstanceService]: no document with unitId ${e}!`);this._currentUnits.set(t[1],t[0]),this._currentUnits$.next(this._currentUnits)}getTypeOfUnitAdded$(e){return this._unitAdded$.pipe((0,eJ.filter)(t=>t.type===e))}__addUnit(e,t){var r;let n=e.type;this._unitsByType.has(n)||this._unitsByType.set(n,[]);let o=this._unitsByType.get(n),i=e.getUnitId();if(-1!==o.findIndex(e=>e.getUnitId()===i))throw Error(`[UniverInstanceService]: cannot create a unit with the same unit id: ${i}.`);o.push(e),this._unitAdded$.next(e),(null==(r=null==t?void 0:t.makeCurrent)||r)&&this.setCurrentUnitForType(e.getUnitId())}getTypeOfUnitDisposed$(e){return this.unitDisposed$.pipe((0,eJ.filter)(t=>t.type===e))}getUnit(e,t){var r;let n=null==(r=this._getUnitById(e))?void 0:r[0];return t&&(null==n?void 0:n.type)!==t?null:n}getCurrentUniverDocInstance(){return this.getCurrentUnitForType(si.UNIVER_DOC)}getUniverDocInstance(e){return this.getUnit(e,si.UNIVER_DOC)}getUniverSheetInstance(e){return this.getUnit(e,si.UNIVER_SHEET)}getAllUnitsForType(e){var t;return null!=(t=this._unitsByType.get(e))?t:[]}changeDoc(e,t){let r=this.getAllUnitsForType(si.UNIVER_DOC),n=r.find(t=>t.getUnitId()===e);if(null!=n){let e=r.indexOf(n);r.splice(e,1)}this.__addUnit(t)}get focused(){var e;let t=this._focused$.getValue();return t?null==(e=this._getUnitById(t))?void 0:e[0]:null}focusUnit(e){this._focused$.next(e),this.focused instanceof uG?(this._contextService.setContextValue(ud,!0),this._contextService.setContextValue(up,!1),this._contextService.setContextValue(uh,!0),this._contextService.setContextValue(uf,!1),this.setCurrentUnitForType(e)):this.focused instanceof ly?(this._contextService.setContextValue(ud,!0),this._contextService.setContextValue(up,!0),this._contextService.setContextValue(uh,!1),this._contextService.setContextValue(uf,!1),this.setCurrentUnitForType(e)):this.focused instanceof uV?(this._contextService.setContextValue(ud,!0),this._contextService.setContextValue(up,!1),this._contextService.setContextValue(uh,!1),this._contextService.setContextValue(uf,!0),this.setCurrentUnitForType(e)):(this._contextService.setContextValue(ud,!1),this._contextService.setContextValue(up,!1),this._contextService.setContextValue(uh,!1),this._contextService.setContextValue(uf,!1))}getFocusedUnit(){return this.focused}getUnitType(e){let t=this._getUnitById(e);return t?t[1]:si.UNRECOGNIZED}disposeUnit(e){let t=this._getUnitById(e);if(!t)return!1;let[r,n]=t,o=this._unitsByType.get(n),i=o.indexOf(r);return o.splice(i,1),this._tryRemoveCurrentUnitForType(e,n),this._tryBlurUnitOnRemoval(e),this._unitDisposed$.next(r),!0}_tryRemoveCurrentUnitForType(e,t){let r=this.getCurrentUnitForType(t);(null==r?void 0:r.getUnitId())===e&&(this._currentUnits.set(t,null),this._currentUnits$.next(this._currentUnits))}_tryBlurUnitOnRemoval(e){var t;(null==(t=this.focused)?void 0:t.getUnitId())===e&&this._focused$.next(null)}_getUnitById(e){for(let[t,r]of this._unitsByType){let n=r.find(t=>t.getUnitId()===e);if(n)return[n,t]}}},e4(uZ,"UniverInstanceService"),uZ);uX=uY([uq(0,t$(rd)),uq(1,ns)],uX);var uQ,uZ,u0,u1=Object.defineProperty,u2=Object.getOwnPropertyDescriptor,u5=/* @__PURE__ */e4((e,t,r,n)=>{for(var o,i=n>1?void 0:n?u2(t,r):t,s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&u1(t,r,i),i},"__decorateClass$3"),u3=/* @__PURE__ */e4((e,t)=>(r,n)=>t(r,n,e),"__decorateParam$3");let u6=(e4(u0=class extends nn{constructor(e){super(),e9(this,"_lifecycle$",new eK.BehaviorSubject(lJ.Starting)),e9(this,"lifecycle$",this._lifecycle$.asObservable()),e9(this,"_lock",!1),this._logService=e,this._reportProgress(lJ.Starting)}get stage(){return this._lifecycle$.getValue()}set stage(e){if(this._lock)throw Error("[LifecycleService]: cannot set new stage when related logic is all handled!");if(e<this.stage)throw Error("[LifecycleService]: lifecycle stage cannot go backward!");e!==this.stage&&(this._lock=!0,this._reportProgress(e),this._lifecycle$.next(e),this._lock=!1)}dispose(){this._lifecycle$.complete(),super.dispose()}subscribeWithPrevious(){return(0,eQ.merge)(u9(this.stage),this._lifecycle$.pipe((0,e1.skip)(1))).pipe(nC(e=>e===lJ.Steady))}_reportProgress(e){this._logService.debug("[LifecycleService]",`lifecycle progressed to "${lX[e]}".`)}},"LifecycleService"),u0);u6=u5([u3(0,nu)],u6);let u4=(e4(ck=class extends nn{constructor(e){super(),e9(this,"_seenTokens",/* @__PURE__ */new Set),this._injector=e}initModulesOnStage(e){var t;null==(t=lQ.get(e))||t.forEach(e=>{this._injector.has(e)&&!this._seenTokens.has(e)&&(this._injector.get(e),this._seenTokens.add(e))})}},"LifecycleInitializerService"),ck);function u9(e){switch(e){case lJ.Starting:return(0,e0.of)(lJ.Starting);case lJ.Ready:return(0,e0.of)(lJ.Starting,lJ.Ready);case lJ.Rendered:return(0,e0.of)(lJ.Starting,lJ.Ready,lJ.Rendered);default:return(0,e0.of)(lJ.Starting,lJ.Ready,lJ.Rendered,lJ.Steady)}}u4=u5([u3(0,t$(rd))],u4),e4(u9,"getLifecycleStagesAndBefore");let u8=tL("ILocalStorageService"),u7=class extends nn{constructor(){super(),e9(this,"_currentLocale$",new eK.BehaviorSubject(nG.ZH_CN)),e9(this,"currentLocale$",this._currentLocale$.asObservable()),e9(this,"_locales",null),e9(this,"localeChanged$",new e2.Subject),e9(this,"t",/* @__PURE__ */e4((e,...t)=>{if(!this._locales)throw Error("[LocaleService]: Locale not initialized");let r=e.split("."),n=this.resolveKeyPath(this._locales[this._currentLocale],r);if("string"!=typeof n)return e;{let e=n;return t.forEach((t,r)=>{e=e.replace(`{${r}}`,t)}),e}},"t")),this.disposeWithMe(r7(()=>this.localeChanged$.complete()))}get _currentLocale(){return this._currentLocale$.value}load(e){var t;this._locales=oy.deepMerge(null!=(t=this._locales)?t:{},e)}setLocale(e){this._currentLocale$.next(e),this.localeChanged$.next()}getLocales(){var e;return null==(e=this._locales)?void 0:e[this._currentLocale]}getCurrentLocale(){return this._currentLocale}resolveKeyPath(e,t){let r=t.shift();if(r&&e&&r in e){let n=e[r];return t.length>0&&("object"==typeof n||Array.isArray(n))?this.resolveKeyPath(n,t):n}return null}};e4(u7,"LocaleService");let ce=u7;var ct=((ej=ct||{}).INIT="init",ej.FETCHING="fetching",ej.DONE="done",ej);let cr=tL("univer.permission-service");l0(lJ.Starting,cr);let cn=class extends nn{constructor(){super(...arguments),e9(this,"_permissionPointMap",/* @__PURE__ */new Map),e9(this,"_permissionPointUpdate$",new e2.Subject),e9(this,"permissionPointUpdate$",this._permissionPointUpdate$.asObservable())}deletePermissionPoint(e){let t=this._permissionPointMap.get(e);t&&(t.complete(),this._permissionPointMap.delete(e))}addPermissionPoint(e){let t=e instanceof eK.BehaviorSubject,r=t?e.getValue():e;if(!r.id)return!1;if(this._permissionPointMap.get(r.id))throw Error(`${r.id} PermissionPoint already exists`);return this._permissionPointMap.set(r.id,t?e:new eK.BehaviorSubject(r)),this._permissionPointUpdate$.next(r),!0}updatePermissionPoint(e,t){let r=this._permissionPointMap.get(e);if(!r)return;let n=r.getValue();n.value=t,n.status=ct.DONE,r.next(n),this._permissionPointUpdate$.next(n)}clearPermissionMap(){this._permissionPointMap.clear()}getPermissionPoint(e){let t=this._permissionPointMap.get(e);if(t)return t.getValue()}getPermissionPoint$(e){let t=this._permissionPointMap.get(e);if(t)return t}composePermission$(e){let t=e.map(e=>{var t;let r=null==(t=this._permissionPointMap)?void 0:t.get(e);if(!r)throw Error(`[PermissionService]: ${e} permissionPoint does not exist!`);return r.asObservable()});return(0,eY.combineLatest)(t).pipe((0,eX.map)(e=>e))}composePermission(e){return e.map(e=>{var t;let r=null==(t=this._permissionPointMap)?void 0:t.get(e);if(!r)throw Error(`[PermissionService]: ${e} permissionPoint does not exist!`);return r.getValue()})}getAllPermissionPoint(){let e=/* @__PURE__ */new Map;return this._permissionPointMap.forEach((t,r)=>{e.set(r,t)}),e}};e4(cn,"PermissionService");let co=Symbol("DependentOn"),ci=class extends nn{onStarting(e){}onReady(){}onRendered(){}onSteady(){}getUniverInstanceType(){return this.constructor.type}getPluginName(){return this.constructor.pluginName}};e4(ci,"Plugin"),e9(ci,"pluginName"),e9(ci,"type",si.UNIVER_UNKNOWN);let cs=ci,ca=class{constructor(){e9(this,"_plugins",[])}addPlugin(e){this._plugins.push(e)}removePlugins(){let e=this._plugins.slice();return this._plugins.length=0,e}forEachPlugin(e){this._plugins.forEach(e)}};e4(ca,"PluginStore");let cl=class{constructor(){e9(this,"_pluginsRegistered",[])}registerPlugin(e,t){this._pluginsRegistered.push({plugin:e,options:t})}getRegisterPlugins(){return this._pluginsRegistered.slice()}removePlugins(){this._pluginsRegistered=[]}};e4(cl,"PluginRegistry");var cu=Object.defineProperty,cc=Object.getOwnPropertyDescriptor,cd=/* @__PURE__ */e4((e,t,r,n)=>{for(var o,i=n>1?void 0:n?cc(t,r):t,s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&cu(t,r,i),i},"__decorateClass$2"),ch=/* @__PURE__ */e4((e,t)=>(r,n)=>t(r,n,e),"__decorateParam$2");function cp(...e){return function(t){t[co]=e}}e4(cp,"DependentOn");let cf=(e4(cF=class{constructor(e){e9(this,"_pluginHolderForUniver"),e9(this,"_pluginHoldersForTypes",/* @__PURE__ */new Map),e9(this,"_seenPlugins",/* @__PURE__ */new Set),e9(this,"_flushTimer"),this._injector=e,this._pluginHolderForUniver=this._injector.createInstance(cg,this._checkPluginSeen.bind(this),this._immediateInitPlugin.bind(this)),this._pluginHolderForUniver.start()}dispose(){for(let e of(this._clearFlushTimer(),this._pluginHoldersForTypes.values()))e.dispose();this._pluginHolderForUniver.dispose()}registerPlugin(e,t){this._assertPluginValid(e),this._scheduleInitPlugin();let{type:r}=e;r===si.UNIVER_UNKNOWN?(this._pluginHolderForUniver.register(e,t),this._pluginHolderForUniver.flush()):this._ensurePluginHolderForType(r).register(e,t)}startPluginForType(e){this._ensurePluginHolderForType(e).start()}_ensurePluginHolderForType(e){if(!this._pluginHoldersForTypes.has(e)){let t=this._injector.createInstance(cg,this._checkPluginSeen.bind(this),this._immediateInitPlugin.bind(this));return this._pluginHoldersForTypes.set(e,t),t}return this._pluginHoldersForTypes.get(e)}_immediateInitPlugin(e){this._seenPlugins.add(e.pluginName),this._ensurePluginHolderForType(e.type).immediateInitPlugin(e)}_checkPluginSeen(e){return this._seenPlugins.has(e.pluginName)}_assertPluginValid(e){let{type:t,pluginName:r}=e;if(t===si.UNRECOGNIZED)throw Error(`[PluginService]: invalid plugin type for ${e.name}. Please assign a "type" to your plugin.`);if(!r)throw Error(`[PluginService]: no plugin name for ${e.name}. Please assign a "pluginName" to your plugin.`);if(this._seenPlugins.has(r))throw Error(`[PluginService]: duplicated plugin name for "${r}". Maybe a plugin that dependents on "${r} has already registered it. In that case please register "${r}" before the that plugin.`);this._seenPlugins.add(e.pluginName)}_scheduleInitPlugin(){void 0===this._flushTimer&&(this._flushTimer=setTimeout(()=>{this._pluginHolderForUniver.started||this._pluginHolderForUniver.start(),this._flushPlugins(),this._clearFlushTimer()},4))}_clearFlushTimer(){this._flushTimer&&(clearTimeout(this._flushTimer),this._flushTimer=void 0)}_flushPlugins(){for(let[e,t]of(this._pluginHolderForUniver.flush(),this._pluginHoldersForTypes))t.started&&t.flush()}},"PluginService"),cF);cf=cd([ch(0,t$(rd))],cf);let cg=(cj=class extends nn{constructor(e,t,r,n,o,i){super(),e9(this,"_started",!1),e9(this,"_warnedAboutOnStartingDeprecation",!1),e9(this,"_pluginRegistry",new cl),e9(this,"_pluginStore",new ca),e9(this,"_awaitingPlugins",[]),this._checkPluginRegistered=e,this._registerPlugin=t,this._logService=r,this._injector=n,this._lifecycleService=o,this._lifecycleInitializerService=i,this.disposeWithMe(this._lifecycleService.lifecycle$.pipe((0,e1.skip)(1)).subscribe(e=>{this._awaitingPlugins.forEach(t=>this._runStage(t,e))}))}get started(){return this._started}dispose(){super.dispose(),this._pluginStore.forEachPlugin(e=>e.dispose()),this._pluginStore.removePlugins(),this._pluginRegistry.removePlugins(),this._awaitingPlugins.length=0}register(e,t){this._pluginRegistry.registerPlugin(e,t)}immediateInitPlugin(e){let t=this._initPlugin(e,void 0);this._pluginsRunLifecycle([t])}start(){this._started||(this._started=!0,this.flush())}flush(){if(!this._started)return;let e=this._pluginRegistry.getRegisterPlugins().map(({plugin:e,options:t})=>this._initPlugin(e,t));e.length&&(this._pluginsRunLifecycle(e),this._pluginRegistry.removePlugins())}_initPlugin(e,t){let r=e[co];if(r){let t=/* @__PURE__ */e4(()=>{let t=r.find(e=>!this._checkPluginRegistered(e));return!!t&&(this._logService.debug("[PluginService]",`Plugin "${e.pluginName}" depends on "${t.pluginName}" which is not registered. Univer will automatically register it with default configuration.`),this._registerPlugin(t,void 0),!0)},"exhaustUnregisteredDependents");for(;t(););}let n=this._injector.createInstance(e,t);return this._pluginStore.addPlugin(n),this._logService.debug("[PluginService]",`Plugin "${n.getPluginName()}" registered.`),n}_pluginsRunLifecycle(e){u9(this._lifecycleService.stage).subscribe(t=>this._runStage(e,t)),this._awaitingPlugins.push(e)}_runStage(e,t){e.forEach(e=>{switch(t){case lJ.Starting:e.onStarting.length>0&&e.onStarting!==cs.prototype.onStarting&&!this._warnedAboutOnStartingDeprecation&&(this._logService.warn("[PluginService]",e.onStarting.length,`Plugin "${e.getPluginName()}" is using deprecated "onStarting" method with arguments. Please use "this._injector" instead.`),this._warnedAboutOnStartingDeprecation=!0),e.onStarting(this._injector);break;case lJ.Ready:e.onReady();break;case lJ.Rendered:e.onRendered();break;case lJ.Steady:e.onSteady()}}),this._lifecycleInitializerService.initModulesOnStage(t)}},e4(cj,"PluginHolder"),cj);function cm(e,t){if(!t)return e;let r=[];for(let n of e){let e=t.find(([e])=>e===n[0]);if(e){if(null===e[1])continue;r.push([n[0],e[1]])}else r.push(n)}return r}cg=cd([ch(2,nu),ch(3,t$(rd)),ch(4,t$(u6)),ch(5,t$(u4))],cg),e4(cm,"mergeOverrideWithDependencies");let c_=tL("resource-loader-service");l0(lJ.Ready,c_);let cy=class extends nn{constructor(){super(...arguments),e9(this,"_resourceMap",/* @__PURE__ */new Map),e9(this,"_register$",new e2.Subject),e9(this,"register$",this._register$.asObservable())}getAllResourceHooks(){return[...this._resourceMap.values()]}getResources(e,t){return t?this.getResourcesByType(e,t):this.getAllResourceHooks().map(t=>{let r=t.toJson(e);return{name:t.pluginName,data:r}})}getResourcesByType(e,t){return this.getAllResourceHooks().filter(e=>e.businesses.includes(t)).map(t=>{let r=t.toJson(e);return{name:t.pluginName,data:r}})}registerPluginResource(e){let t=e.pluginName;if(this._resourceMap.has(t))throw Error(`the pluginName is registered {${t}}`);return this._resourceMap.set(t,e),this._register$.next(e),r7(()=>this._resourceMap.delete(t))}disposePluginResource(e){this._resourceMap.delete(e)}loadResources(e,t){this.getAllResourceHooks().forEach(r=>{var n;let o=null==(n=null==t?void 0:t.find(e=>e.name===r.pluginName))?void 0:n.data;if(o)try{let t=r.parseJson(o);r.onLoad(e,t)}catch{console.error("LoadResources Error!")}})}unloadResources(e){this.getAllResourceHooks().forEach(t=>{t.onUnLoad(e)})}dispose(){this._register$.complete(),this._resourceMap.clear()}};e4(cy,"ResourceManagerService");let cE=class extends nn{constructor(){super(),e9(this,"_currentTheme"),e9(this,"_currentTheme$",new eK.BehaviorSubject({})),e9(this,"currentTheme$",this._currentTheme$.asObservable()),this.disposeWithMe(r7(()=>this._currentTheme$.complete()))}getCurrentTheme(){if(!this._currentTheme)throw Error("[ThemeService]: current theme is not set!");return this._currentTheme}setTheme(e){this._currentTheme=e,this._currentTheme$.next(e)}};e4(cE,"ThemeService");let cb=cE;var cv=Object.defineProperty,cR=Object.getOwnPropertyDescriptor,cT=/* @__PURE__ */e4((e,t,r,n)=>{for(var o,i=n>1?void 0:n?cR(t,r):t,s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&cv(t,r,i),i},"__decorateClass$1"),cI=/* @__PURE__ */e4((e,t)=>(r,n)=>t(r,n,e),"__decorateParam$1");let cC=tL("univer.undo-redo.service"),cS=class{dispose(){}async dispatchToHandlers(){return!1}};e4(cS,"MultiImplementationCommand");let cO=cS,cx="univer.command.redo",cA="univer.command.undo",cw=new class extends cO{constructor(){super(...arguments),e9(this,"type",ng.COMMAND),e9(this,"id",cA)}async handler(e){let t=e.get(cC),r=t.pitchTopUndoElement();if(!r)return!1;let n=e.get(nm);return!!nR(r.undoMutations,n)&&(t.popUndoToRedo(),!0)}},cN=new class extends cO{constructor(){super(...arguments),e9(this,"type",ng.COMMAND),e9(this,"id",cx)}async handler(e){let t=e.get(cC),r=t.pitchTopRedoElement();if(!r)return!1;let n=e.get(nm);return!!nR(r.redoMutations,n)&&(t.popRedoToUndo(),!0)}},cD=(cB=class extends nn{constructor(e,t,r){super(),e9(this,"undoRedoStatus$"),e9(this,"_undoRedoStatus$",new eK.BehaviorSubject({undos:0,redos:0})),e9(this,"_undoStacks",/* @__PURE__ */new Map),e9(this,"_redoStacks",/* @__PURE__ */new Map),e9(this,"_batchingStatus",/* @__PURE__ */new Map),this._univerInstanceService=e,this._commandService=t,this._contextService=r,this.undoRedoStatus$=this._undoRedoStatus$.asObservable(),this.disposeWithMe(this._commandService.registerCommand(cw)),this.disposeWithMe(this._commandService.registerCommand(cN)),this.disposeWithMe(r7(()=>this._undoRedoStatus$.complete())),this.disposeWithMe(r7(this._univerInstanceService.focused$.subscribe(()=>this._updateStatus())))}pushUndoRedo(e){let{unitID:t}=e,r=this._getRedoStack(t,!0),n=this._getUndoStack(t,!0);if(r.length=0,this._batchingStatus.has(e.unitID)){let t=this._batchingStatus.get(e.unitID),r=this._pitchUndoElement(e.unitID);0!==t&&r?this._tryBatchingElements(r,e):(o(e),this._batchingStatus.set(e.unitID,1))}else o(e);function o(e){n.push(e),n.length>20&&n.splice(0,1)}e4(o,"appendNewItem"),this._updateStatus()}clearUndoRedo(e){let t=this._getRedoStack(e);t&&(t.length=0);let r=this._getUndoStack(e);r&&(r.length=0),this._updateStatus()}pitchTopUndoElement(){let e=this._getFocusedUnitId();return this._pitchUndoElement(e)}pitchTopRedoElement(){let e=this._getFocusedUnitId();return this._pitchRedoElement(e)}_pitchUndoElement(e){let t=this._getUndoStack(e);return null!=t&&t.length?t[t.length-1]:null}_pitchRedoElement(e){let t=this._getRedoStack(e);return null!=t&&t.length?t[t.length-1]:null}popUndoToRedo(){let e=this._getUndoStackForFocused().pop();e&&(this._getRedoStackForFocused().push(e),this._updateStatus())}popRedoToUndo(){let e=this._getRedoStackForFocused().pop();e&&(this._getUndoStackForFocused().push(e),this._updateStatus())}__tempBatchingUndoRedo(e){if(this._batchingStatus.has(e))throw Error("[LocalUndoRedoService]: cannot batching undo redo twice at the same time!");return this._batchingStatus.set(e,0),r7(()=>this._batchingStatus.delete(e))}_updateStatus(){var e,t;let r=this._getFocusedUnitId(),n=r&&(null==(e=this._undoStacks.get(r))?void 0:e.length)||0,o=r&&(null==(t=this._redoStacks.get(r))?void 0:t.length)||0;this._undoRedoStatus$.next({undos:n,redos:o})}_getUndoStack(e,t=!1){let r=this._undoStacks.get(e);return!r&&t&&(r=[],this._undoStacks.set(e,r)),r||null}_getRedoStack(e,t=!1){let r=this._redoStacks.get(e);return!r&&t&&(r=[],this._redoStacks.set(e,r)),r||null}_getUndoStackForFocused(){let e=this._getFocusedUnitId();if(!e)throw Error("No focused univer instance!");return this._getUndoStack(e,!0)}_getRedoStackForFocused(){let e=this._getFocusedUnitId();if(!e)throw Error("No focused univer instance!");return this._getRedoStack(e,!0)}_tryBatchingElements(e,t){e.redoMutations.push(...t.redoMutations),e.undoMutations.push(...t.undoMutations)}_getFocusedUnitId(){var e,t,r,n;let o=this._contextService.getContextValue(uh),i=this._contextService.getContextValue(uy),s=this._contextService.getContextValue(um);return o?i?ts:s?ti:null!=(t=null==(e=this._univerInstanceService.getFocusedUnit())?void 0:e.getUnitId())?t:"":null!=(n=null==(r=this._univerInstanceService.getFocusedUnit())?void 0:r.getUnitId())?n:""}},e4(cB,"LocalUndoRedoService"),cB);function cL(e){return!(0===e.length||e.length>31||e.startsWith("'")||e.endsWith("'")||/[:\\\/\?\*\[\]]/.test(e))}cD=cT([cI(0,uJ),cI(1,nm),cI(2,ns)],cD),e4(cL,"nameCharacterCheck"),e4(function(e){return new Promise(t=>setTimeout(t,e))},"awaitTime");let cM=/* @__PURE__ */e4((e,t)=>t.length===e.length&&!e.some(e=>t.some(t=>!i5.equals(t,e))),"isRangesEqual"),cU=/* @__PURE__ */e4((e,t)=>t.length===e.length&&e.every((e,r)=>{let n=t[r];return n.unitId===e.unitId&&n.sheetId===e.sheetId&&i5.equals(e.range,n.range)}),"isUnitRangesEqual"),cP=["script","style","meta","comment","link"];var ck,cF,cj,cB,cH,c$=((eB=c$||{})[eB.INFO=0]="INFO",eB[eB.STOP=1]="STOP",eB[eB.WARNING=2]="WARNING",eB),cG=((eH=cG||{})[eH.DISABLED=0]="DISABLED",eH[eH.FULL_ALPHA=1]="FULL_ALPHA",eH[eH.FULL_HANGUL=2]="FULL_HANGUL",eH[eH.FULL_KATAKANA=3]="FULL_KATAKANA",eH[eH.HALF_ALPHA=4]="HALF_ALPHA",eH[eH.HALF_HANGUL=5]="HALF_HANGUL",eH[eH.HALF_KATAKANA=6]="HALF_KATAKANA",eH[eH.HIRAGANA=7]="HIRAGANA",eH[eH.NO_CONTROL=8]="NO_CONTROL",eH[eH.OFF=9]="OFF",eH[eH.ON=10]="ON",eH),cW=((e$=cW||{}).BETWEEN="between",e$.EQUAL="equal",e$.GREATER_THAN="greaterThan",e$.GREATER_THAN_OR_EQUAL="greaterThanOrEqual",e$.LESS_THAN="lessThan",e$.LESS_THAN_OR_EQUAL="lessThanOrEqual",e$.NOT_BETWEEN="notBetween",e$.NOT_EQUAL="notEqual",e$),cV=((eG=cV||{})[eG.TEXT=0]="TEXT",eG[eG.ARROW=1]="ARROW",eG[eG.CUSTOM=2]="CUSTOM",eG),cz=((eW=cz||{}).VALID="valid",eW.INVALID="invalid",eW.VALIDATING="validating",eW),cK=((eV=cK||{}).CUSTOM="custom",eV.LIST="list",eV.LIST_MULTIPLE="listMultiple",eV.NONE="none",eV.TEXT_LENGTH="textLength",eV.DATE="date",eV.TIME="time",eV.WHOLE="whole",eV.DECIMAL="decimal",eV.CHECKBOX="checkbox",eV),cY=Object.defineProperty,cq=Object.getOwnPropertyDescriptor,cJ=/* @__PURE__ */e4((e,t,r,n)=>{for(var o,i=n>1?void 0:n?cq(t,r):t,s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&cY(t,r,i),i},"__decorateClass"),cX=/* @__PURE__ */e4((e,t)=>(r,n)=>t(r,n,e),"__decorateParam");let cQ=(cH=class extends nn{constructor(e,t){super(),this._resourceManagerService=e,this._univerInstanceService=t,this._init()}_init(){let e=/* @__PURE__ */e4(e=>{e.businesses.forEach(t=>{switch(t){case si.UNRECOGNIZED:case si.UNIVER_UNKNOWN:case si.UNIVER_SLIDE:case si.UNIVER_DOC:this._univerInstanceService.getAllUnitsForType(si.UNIVER_DOC).forEach(t=>{let r=(t.getSnapshot().resources||[]).find(t=>t.name===e.pluginName);if(r)try{let n=e.parseJson(r.data);e.onLoad(t.getUnitId(),n)}catch{console.error(`Load Document{${t.getUnitId()}} Resources{${e.pluginName}} Data Error.`)}});break;case si.UNIVER_SHEET:this._univerInstanceService.getAllUnitsForType(si.UNIVER_SHEET).forEach(t=>{let r=(t.getSnapshot().resources||[]).find(t=>t.name===e.pluginName);if(r)try{let n=e.parseJson(r.data);e.onLoad(t.getUnitId(),n)}catch{console.error(`Load Workbook{${t.getUnitId()}} Resources{${e.pluginName}} Data Error.`)}})}})},"handleHookAdd");this._resourceManagerService.getAllResourceHooks().forEach(t=>e(t)),this.disposeWithMe(this._resourceManagerService.register$.subscribe(t=>e(t))),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitAdded$(si.UNIVER_SHEET).subscribe(e=>{this._resourceManagerService.loadResources(e.getUnitId(),e.getSnapshot().resources)})),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitAdded$(si.UNIVER_DOC).subscribe(e=>{tc(e.getUnitId())||this._resourceManagerService.loadResources(e.getUnitId(),e.getSnapshot().resources)})),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitDisposed$(si.UNIVER_SHEET).subscribe(e=>{this._resourceManagerService.unloadResources(e.getUnitId())})),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitDisposed$(si.UNIVER_DOC).subscribe(e=>{this._resourceManagerService.unloadResources(e.getUnitId())}))}saveUnit(e){let t=this._univerInstanceService.getUnit(e);if(!t)return null;let r=this._resourceManagerService.getResources(e,t.type),n=oy.deepClone(t.getSnapshot());return n.resources=r,n}},e4(cH,"ResourceLoaderService"),cH);cQ=cJ([cX(0,t$(lq)),cX(1,t$(uJ))],cQ);let cZ=class{constructor(e={},t){e9(this,"_startedTypes",/* @__PURE__ */new Set),e9(this,"_injector");let r=this._injector=c1(t,null==e?void 0:e.override),{theme:n,locale:o,locales:i,logLevel:s}=e;n&&this._injector.get(cb).setTheme(n),i&&this._injector.get(ce).load(i),o&&this._injector.get(ce).setLocale(o),s&&this._injector.get(nu).setLogLevel(s),this._init(r)}get _univerInstanceService(){return this._injector.get(uJ)}get _pluginService(){return this._injector.get(cf)}__getInjector(){return this._injector}dispose(){this._injector.dispose()}setLocale(e){this._injector.get(ce).setLocale(e)}createUnit(e,t){return this._univerInstanceService.createUnit(e,t)}createUniverSheet(e){return this._injector.get(nu).warn("[Univer]: Univer.createUniverSheet is deprecated, use createUnit instead"),this._univerInstanceService.createUnit(si.UNIVER_SHEET,e)}createUniverDoc(e){return this._injector.get(nu).warn("[Univer]: Univer.createUniverDoc is deprecated, use createUnit instead"),this._univerInstanceService.createUnit(si.UNIVER_DOC,e)}createUniverSlide(e){return this._injector.get(nu).warn("[Univer]: Univer.createUniverSlide is deprecated, use createUnit instead"),this._univerInstanceService.createUnit(si.UNIVER_SLIDE,e)}_init(e){this._univerInstanceService.registerCtorForType(si.UNIVER_SHEET,uG),this._univerInstanceService.registerCtorForType(si.UNIVER_DOC,ly),this._univerInstanceService.registerCtorForType(si.UNIVER_SLIDE,uV);let t=e.get(uJ);t.__setCreateHandler((r,n,o,i)=>{if(!this._startedTypes.has(r)){this._pluginService.startPluginForType(r),this._startedTypes.add(r);let s=e.createInstance(o,n);return t.__addUnit(s,i),this._tryProgressToReady(),s}let s=e.createInstance(o,n);return t.__addUnit(s,i),s})}_tryProgressToReady(){this._injector.get(u6).stage<lJ.Ready&&(this._injector.get(u6).stage=lJ.Ready)}registerPlugin(e,t){this._pluginService.registerPlugin(e,t)}};e4(cZ,"Univer");let c0=cZ;function c1(e,t){let r=cm([[uC],[ce],[cb],[u6],[u4],[cf],[ut],[uJ,{useClass:uX}],[cr,{useClass:cn}],[nu,{useClass:nc,lazy:!0}],[nm,{useClass:nE}],[cC,{useClass:cD,lazy:!0}],[uu,{useClass:uc}],[ns,{useClass:na}],[lq,{useClass:cy,lazy:!0}],[c_,{useClass:cQ,lazy:!0}],[ul,{useClass:ua,lazy:!0}]],t);return e?e.createChild(r):new rd(r)}e4(c1,"createUniverInjector"),e8()}),n("gQuIR",function(e,t){e.exports=r("vnpT8")}),n("vnpT8",function(e,r){t(e.exports,"Children",function(){return n},function(e){return n=e}),t(e.exports,"Component",function(){return o},function(e){return o=e}),t(e.exports,"Fragment",function(){return i},function(e){return i=e}),t(e.exports,"Profiler",function(){return s},function(e){return s=e}),t(e.exports,"PureComponent",function(){return a},function(e){return a=e}),t(e.exports,"StrictMode",function(){return l},function(e){return l=e}),t(e.exports,"Suspense",function(){return u},function(e){return u=e}),t(e.exports,"__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED",function(){return c},function(e){return c=e}),t(e.exports,"act",function(){return d},function(e){return d=e}),t(e.exports,"cloneElement",function(){return h},function(e){return h=e}),t(e.exports,"createContext",function(){return p},function(e){return p=e}),t(e.exports,"createElement",function(){return f},function(e){return f=e}),t(e.exports,"createFactory",function(){return g},function(e){return g=e}),t(e.exports,"createRef",function(){return m},function(e){return m=e}),t(e.exports,"forwardRef",function(){return _},function(e){return _=e}),t(e.exports,"isValidElement",function(){return y},function(e){return y=e}),t(e.exports,"lazy",function(){return E},function(e){return E=e}),t(e.exports,"memo",function(){return b},function(e){return b=e}),t(e.exports,"startTransition",function(){return v},function(e){return v=e}),t(e.exports,"unstable_act",function(){return R},function(e){return R=e}),t(e.exports,"useCallback",function(){return T},function(e){return T=e}),t(e.exports,"useContext",function(){return I},function(e){return I=e}),t(e.exports,"useDebugValue",function(){return C},function(e){return C=e}),t(e.exports,"useDeferredValue",function(){return S},function(e){return S=e}),t(e.exports,"useEffect",function(){return O},function(e){return O=e}),t(e.exports,"useId",function(){return x},function(e){return x=e}),t(e.exports,"useImperativeHandle",function(){return A},function(e){return A=e}),t(e.exports,"useInsertionEffect",function(){return w},function(e){return w=e}),t(e.exports,"useLayoutEffect",function(){return N},function(e){return N=e}),t(e.exports,"useMemo",function(){return D},function(e){return D=e}),t(e.exports,"useReducer",function(){return L},function(e){return L=e}),t(e.exports,"useRef",function(){return M},function(e){return M=e}),t(e.exports,"useState",function(){return U},function(e){return U=e}),t(e.exports,"useSyncExternalStore",function(){return P},function(e){return P=e}),t(e.exports,"useTransition",function(){return k},function(e){return k=e}),t(e.exports,"version",function(){return F},function(e){return F=e});var n,o,i,s,a,l,u,c,d,h,p,f,g,m,_,y,E,b,v,R,T,I,C,S,O,x,A,w,N,D,L,M,U,P,k,F,j=Symbol.for("react.element"),B=Symbol.for("react.portal"),H=Symbol.for("react.fragment"),$=Symbol.for("react.strict_mode"),G=Symbol.for("react.profiler"),W=Symbol.for("react.provider"),V=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),K=Symbol.for("react.suspense"),Y=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),J=Symbol.iterator,X={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Q=Object.assign,Z={};function ee(e,t,r){this.props=e,this.context=t,this.refs=Z,this.updater=r||X}function et(){}function er(e,t,r){this.props=e,this.context=t,this.refs=Z,this.updater=r||X}ee.prototype.isReactComponent={},ee.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},ee.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},et.prototype=ee.prototype;var en=er.prototype=new et;en.constructor=er,Q(en,ee.prototype),en.isPureReactComponent=!0;var eo=Array.isArray,ei=Object.prototype.hasOwnProperty,es={current:null},ea={key:!0,ref:!0,__self:!0,__source:!0};function el(e,t,r){var n,o={},i=null,s=null;if(null!=t)for(n in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(i=""+t.key),t)ei.call(t,n)&&!ea.hasOwnProperty(n)&&(o[n]=t[n]);var a=arguments.length-2;if(1===a)o.children=r;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];o.children=l}if(e&&e.defaultProps)for(n in a=e.defaultProps)void 0===o[n]&&(o[n]=a[n]);return{$$typeof:j,type:e,key:i,ref:s,props:o,_owner:es.current}}function eu(e){return"object"==typeof e&&null!==e&&e.$$typeof===j}var ec=/\/+/g;function ed(e,t){var r,n;return"object"==typeof e&&null!==e&&null!=e.key?(r=""+e.key,n={"=":"=0",":":"=2"},"$"+r.replace(/[=:]/g,function(e){return n[e]})):t.toString(36)}function eh(e,t,r){if(null==e)return e;var n=[],o=0;return function e(t,r,n,o,i){var s,a,l,u=typeof t;("undefined"===u||"boolean"===u)&&(t=null);var c=!1;if(null===t)c=!0;else switch(u){case"string":case"number":c=!0;break;case"object":switch(t.$$typeof){case j:case B:c=!0}}if(c)return i=i(c=t),t=""===o?"."+ed(c,0):o,eo(i)?(n="",null!=t&&(n=t.replace(ec,"$&/")+"/"),e(i,r,n,"",function(e){return e})):null!=i&&(eu(i)&&(s=i,a=n+(!i.key||c&&c.key===i.key?"":(""+i.key).replace(ec,"$&/")+"/")+t,i={$$typeof:j,type:s.type,key:a,ref:s.ref,props:s.props,_owner:s._owner}),r.push(i)),1;if(c=0,o=""===o?".":o+":",eo(t))for(var d=0;d<t.length;d++){var h=o+ed(u=t[d],d);c+=e(u,r,n,h,i)}else if("function"==typeof(h=null===(l=t)||"object"!=typeof l?null:"function"==typeof(l=J&&l[J]||l["@@iterator"])?l:null))for(t=h.call(t),d=0;!(u=t.next()).done;)h=o+ed(u=u.value,d++),c+=e(u,r,n,h,i);else if("object"===u)throw Error("Objects are not valid as a React child (found: "+("[object Object]"===(r=String(t))?"object with keys {"+Object.keys(t).join(", ")+"}":r)+"). If you meant to render a collection of children, use an array instead.");return c}(e,n,"","",function(e){return t.call(r,e,o++)}),n}function ep(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){(0===e._status||-1===e._status)&&(e._status=1,e._result=t)},function(t){(0===e._status||-1===e._status)&&(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var ef={current:null},eg={transition:null};function em(){throw Error("act(...) is not supported in production builds of React.")}n={map:eh,forEach:function(e,t,r){eh(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return eh(e,function(){t++}),t},toArray:function(e){return eh(e,function(e){return e})||[]},only:function(e){if(!eu(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},o=ee,i=H,s=G,a=er,l=$,u=K,c={ReactCurrentDispatcher:ef,ReactCurrentBatchConfig:eg,ReactCurrentOwner:es},d=em,h=function(e,t,r){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Q({},e.props),o=e.key,i=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,s=es.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in t)ei.call(t,l)&&!ea.hasOwnProperty(l)&&(n[l]=void 0===t[l]&&void 0!==a?a[l]:t[l])}var l=arguments.length-2;if(1===l)n.children=r;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];n.children=a}return{$$typeof:j,type:e.type,key:o,ref:i,props:n,_owner:s}},p=function(e){return(e={$$typeof:V,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:W,_context:e},e.Consumer=e},f=el,g=function(e){var t=el.bind(null,e);return t.type=e,t},m=function(){return{current:null}},_=function(e){return{$$typeof:z,render:e}},y=eu,E=function(e){return{$$typeof:q,_payload:{_status:-1,_result:e},_init:ep}},b=function(e,t){return{$$typeof:Y,type:e,compare:void 0===t?null:t}},v=function(e){var t=eg.transition;eg.transition={};try{e()}finally{eg.transition=t}},R=em,T=function(e,t){return ef.current.useCallback(e,t)},I=function(e){return ef.current.useContext(e)},C=function(){},S=function(e){return ef.current.useDeferredValue(e)},O=function(e,t){return ef.current.useEffect(e,t)},x=function(){return ef.current.useId()},A=function(e,t,r){return ef.current.useImperativeHandle(e,t,r)},w=function(e,t){return ef.current.useInsertionEffect(e,t)},N=function(e,t){return ef.current.useLayoutEffect(e,t)},D=function(e,t){return ef.current.useMemo(e,t)},L=function(e,t,r){return ef.current.useReducer(e,t,r)},M=function(e){return ef.current.useRef(e)},U=function(e){return ef.current.useState(e)},P=function(e,t,r){return ef.current.useSyncExternalStore(e,t,r)},k=function(){return ef.current.useTransition()},F="18.3.1"}),n("jv4BO",function(e,n){t(e.exports,"BehaviorSubject",function(){return i});var o=r("9tuco"),i=function(e){function t(t){var r=e.call(this)||this;return r._value=t,r}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var r=e.prototype._subscribe.call(this,t);return r.closed||t.next(this._value),r},t.prototype.getValue=function(){var e=this.hasError,t=this.thrownError,r=this._value;if(e)throw t;return this._throwIfClosed(),r},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(r("2Ha4T").Subject)}),n("9tuco",function(e,r){t(e.exports,"__extends",function(){return o}),t(e.exports,"__awaiter",function(){return i}),t(e.exports,"__generator",function(){return s}),t(e.exports,"__values",function(){return a}),t(e.exports,"__read",function(){return l}),t(e.exports,"__spreadArray",function(){return u}),t(e.exports,"__await",function(){return c}),t(e.exports,"__asyncGenerator",function(){return d}),t(e.exports,"__asyncValues",function(){return h});var n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function i(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{l(n.next(e))}catch(e){i(e)}}function a(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,a)}l((n=n.apply(e,t||[])).next())})}function s(e,t){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){return function(a){if(r)throw TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}function a(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function l(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function u(e,t,r){if(r||2==arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function c(e){return this instanceof c?(this.v=e,this):new c(e)}function d(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),s("next"),s("throw"),s("return",function(e){return function(t){return Promise.resolve(t).then(e,u)}}),n[Symbol.asyncIterator]=function(){return this},n;function s(e,t){o[e]&&(n[e]=function(t){return new Promise(function(r,n){i.push([e,t,r,n])>1||a(e,t)})},t&&(n[e]=t(n[e])))}function a(e,t){try{var r;(r=o[e](t)).value instanceof c?Promise.resolve(r.value.v).then(l,u):d(i[0][2],r)}catch(e){d(i[0][3],e)}}function l(e){a("next",e)}function u(e){a("throw",e)}function d(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}}function h(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=a(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,o){(function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)})(n,o,(t=e[r](t)).done,t.value)})}}}"function"==typeof SuppressedError&&SuppressedError}),n("2Ha4T",function(e,n){t(e.exports,"Subject",function(){return c});var o=r("9tuco"),i=r("3KKCW"),s=r("dCdPC"),a=r("iq3se"),l=r("iDS9r"),u=r("3TCTj"),c=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return(0,o.__extends)(t,e),t.prototype.lift=function(e){var t=new d(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new a.ObjectUnsubscribedError},t.prototype.next=function(e){var t=this;(0,u.errorContext)(function(){var r,n;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var i=(0,o.__values)(t.currentObservers),s=i.next();!s.done;s=i.next())s.value.next(e)}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}}})},t.prototype.error=function(e){var t=this;(0,u.errorContext)(function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var r=t.observers;r.length;)r.shift().error(e)}})},t.prototype.complete=function(){var e=this;(0,u.errorContext)(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,r=this.hasError,n=this.isStopped,o=this.observers;return r||n?s.EMPTY_SUBSCRIPTION:(this.currentObservers=null,o.push(e),new s.Subscription(function(){t.currentObservers=null,(0,l.arrRemove)(o,e)}))},t.prototype._checkFinalizedStatuses=function(e){var t=this.hasError,r=this.thrownError,n=this.isStopped;t?e.error(r):n&&e.complete()},t.prototype.asObservable=function(){var e=new i.Observable;return e.source=this,e},t.create=function(e,t){return new d(e,t)},t}(i.Observable),d=function(e){function t(t,r){var n=e.call(this)||this;return n.destination=t,n.source=r,n}return(0,o.__extends)(t,e),t.prototype.next=function(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===r||r.call(t,e)},t.prototype.error=function(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===r||r.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,r;return null!==(r=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==r?r:s.EMPTY_SUBSCRIPTION},t}(c)}),n("3KKCW",function(e,n){t(e.exports,"Observable",function(){return d});var o=r("7e8Ix"),i=r("dCdPC"),s=r("cZTHs"),a=r("emM2N"),l=r("1aLGW"),u=r("im29J"),c=r("3TCTj"),d=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var n,s=this,a=(n=e)&&n instanceof o.Subscriber||n&&(0,u.isFunction)(n.next)&&(0,u.isFunction)(n.error)&&(0,u.isFunction)(n.complete)&&(0,i.isSubscription)(n)?e:new o.SafeSubscriber(e,t,r);return(0,c.errorContext)(function(){var e=s.operator,t=s.source;a.add(e?e.call(a,t):t?s._subscribe(a):s._trySubscribe(a))}),a},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=h(t))(function(t,n){var i=new o.SafeSubscriber({next:function(t){try{e(t)}catch(e){n(e),i.unsubscribe()}},error:n,complete:t});r.subscribe(i)})},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[s.observable]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,a.pipeFromArray)(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=h(e))(function(e,r){var n;t.subscribe(function(e){return n=e},function(e){return r(e)},function(){return e(n)})})},e.create=function(t){return new e(t)},e}();function h(e){var t;return null!==(t=null!=e?e:l.config.Promise)&&void 0!==t?t:Promise}}),n("7e8Ix",function(e,n){t(e.exports,"Subscriber",function(){return p}),t(e.exports,"SafeSubscriber",function(){return _});var o=r("9tuco"),i=r("im29J"),s=r("dCdPC"),a=r("1aLGW"),l=r("6sJHQ"),u=r("gyLB6"),c=r("fcmbD"),d=r("iY2zb"),h=r("3TCTj"),p=function(e){function t(t){var r=e.call(this)||this;return r.isStopped=!1,t?(r.destination=t,(0,s.isSubscription)(t)&&t.add(r)):r.destination=b,r}return(0,o.__extends)(t,e),t.create=function(e,t,r){return new _(e,t,r)},t.prototype.next=function(e){this.isStopped?E((0,c.nextNotification)(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?E((0,c.errorNotification)(e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?E(c.COMPLETE_NOTIFICATION,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(s.Subscription),f=Function.prototype.bind;function g(e,t){return f.call(e,t)}var m=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){y(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){y(e)}else y(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){y(e)}},e}(),_=function(e){function t(t,r,n){var o,s,l=e.call(this)||this;return(0,i.isFunction)(t)||!t?o={next:null!=t?t:void 0,error:null!=r?r:void 0,complete:null!=n?n:void 0}:l&&a.config.useDeprecatedNextContext?((s=Object.create(t)).unsubscribe=function(){return l.unsubscribe()},o={next:t.next&&g(t.next,s),error:t.error&&g(t.error,s),complete:t.complete&&g(t.complete,s)}):o=t,l.destination=new m(o),l}return(0,o.__extends)(t,e),t}(p);function y(e){a.config.useDeprecatedSynchronousErrorHandling?(0,h.captureError)(e):(0,l.reportUnhandledError)(e)}function E(e,t){var r=a.config.onStoppedNotification;r&&(0,d.timeoutProvider).setTimeout(function(){return r(e,t)})}var b={closed:!0,next:u.noop,error:function(e){throw e},complete:u.noop}}),n("im29J",function(e,r){t(e.exports,"isFunction",function(){return n});function n(e){return"function"==typeof e}}),n("dCdPC",function(e,n){t(e.exports,"Subscription",function(){return l}),t(e.exports,"EMPTY_SUBSCRIPTION",function(){return u}),t(e.exports,"isSubscription",function(){return c});var o=r("9tuco"),i=r("im29J"),s=r("1cbWX"),a=r("iDS9r"),l=function(){var e;function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e,t,r,n,a,l=this._parentage;if(l){if(this._parentage=null,Array.isArray(l))try{for(var u=(0,o.__values)(l),c=u.next();!c.done;c=u.next())c.value.remove(this)}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}else l.remove(this)}var h=this.initialTeardown;if((0,i.isFunction)(h))try{h()}catch(e){a=e instanceof s.UnsubscriptionError?e.errors:[e]}var p=this._finalizers;if(p){this._finalizers=null;try{for(var f=(0,o.__values)(p),g=f.next();!g.done;g=f.next()){var m=g.value;try{d(m)}catch(e){a=null!=a?a:[],e instanceof s.UnsubscriptionError?a=(0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(a)),(0,o.__read)(e.errors)):a.push(e)}}}catch(e){r={error:e}}finally{try{g&&!g.done&&(n=f.return)&&n.call(f)}finally{if(r)throw r.error}}}if(a)throw new s.UnsubscriptionError(a)}},t.prototype.add=function(e){var r;if(e&&e!==this){if(this.closed)d(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(e)}}},t.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},t.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},t.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&(0,a.arrRemove)(t,e)},t.prototype.remove=function(e){var r=this._finalizers;r&&(0,a.arrRemove)(r,e),e instanceof t&&e._removeParent(this)},t.EMPTY=((e=new t).closed=!0,e),t}(),u=l.EMPTY;function c(e){return e instanceof l||e&&"closed"in e&&(0,i.isFunction)(e.remove)&&(0,i.isFunction)(e.add)&&(0,i.isFunction)(e.unsubscribe)}function d(e){(0,i.isFunction)(e)?e():e.unsubscribe()}}),n("1cbWX",function(e,n){t(e.exports,"UnsubscriptionError",function(){return o});var o=(0,r("AdhWW").createErrorClass)(function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}})}),n("AdhWW",function(e,r){t(e.exports,"createErrorClass",function(){return n});function n(e){var t=e(function(e){Error.call(e),e.stack=Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}}),n("iDS9r",function(e,r){t(e.exports,"arrRemove",function(){return n});function n(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}}),n("1aLGW",function(e,r){t(e.exports,"config",function(){return n});var n={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}}),n("6sJHQ",function(e,n){t(e.exports,"reportUnhandledError",function(){return s});var o=r("1aLGW"),i=r("iY2zb");function s(e){(0,i.timeoutProvider).setTimeout(function(){var t=o.config.onUnhandledError;if(t)t(e);else throw e})}}),n("iY2zb",function(e,n){t(e.exports,"timeoutProvider",function(){return i});var o=r("9tuco"),i={setTimeout:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var s=i.delegate;return(null==s?void 0:s.setTimeout)?s.setTimeout.apply(s,(0,o.__spreadArray)([e,t],(0,o.__read)(r))):setTimeout.apply(void 0,(0,o.__spreadArray)([e,t],(0,o.__read)(r)))},clearTimeout:function(e){var t=i.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0}}),n("gyLB6",function(e,r){t(e.exports,"noop",function(){return n});function n(){}}),n("fcmbD",function(e,r){t(e.exports,"COMPLETE_NOTIFICATION",function(){return n}),t(e.exports,"errorNotification",function(){return o}),t(e.exports,"nextNotification",function(){return i});var n=s("C",void 0,void 0);function o(e){return s("E",void 0,e)}function i(e){return s("N",e,void 0)}function s(e,t,r){return{kind:e,value:t,error:r}}}),n("3TCTj",function(e,n){t(e.exports,"errorContext",function(){return s}),t(e.exports,"captureError",function(){return a});var o=r("1aLGW"),i=null;function s(e){if(o.config.useDeprecatedSynchronousErrorHandling){var t=!i;if(t&&(i={errorThrown:!1,error:null}),e(),t){var r=i,n=r.errorThrown,s=r.error;if(i=null,n)throw s}}else e()}function a(e){o.config.useDeprecatedSynchronousErrorHandling&&i&&(i.errorThrown=!0,i.error=e)}}),n("cZTHs",function(e,r){t(e.exports,"observable",function(){return n});var n="function"==typeof Symbol&&Symbol.observable||"@@observable"}),n("emM2N",function(e,n){t(e.exports,"pipe",function(){return i}),t(e.exports,"pipeFromArray",function(){return s});var o=r("agvo5");function i(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s(e)}function s(e){return 0===e.length?o.identity:1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)}}}),n("agvo5",function(e,r){t(e.exports,"identity",function(){return n});function n(e){return e}}),n("iq3se",function(e,n){t(e.exports,"ObjectUnsubscribedError",function(){return o});var o=(0,r("AdhWW").createErrorClass)(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})}),n("5WWyv",function(e,n){t(e.exports,"combineLatest",function(){return p}),t(e.exports,"combineLatestInit",function(){return f});var o=r("3KKCW"),i=r("j6OvA"),s=r("kXLY9"),a=r("agvo5"),l=r("6pRSk"),u=r("sCDrc"),c=r("4vTTG"),d=r("hMcgT"),h=r("idNW3");function p(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=(0,u.popScheduler)(e),n=(0,u.popResultSelector)(e),d=(0,i.argsArgArrayOrObject)(e),h=d.args,p=d.keys;if(0===h.length)return(0,s.from)([],r);var g=new o.Observable(f(h,r,p?function(e){return(0,c.createObject)(p,e)}:a.identity));return n?g.pipe((0,l.mapOneOrManyArgs)(n)):g}function f(e,t,r){return void 0===r&&(r=a.identity),function(n){g(t,function(){for(var o=e.length,i=Array(o),a=o,l=o,u=function(o){g(t,function(){var u=(0,s.from)(e[o],t),c=!1;u.subscribe((0,d.createOperatorSubscriber)(n,function(e){i[o]=e,!c&&(c=!0,l--),l||n.next(r(i.slice()))},function(){--a||n.complete()}))},n)},c=0;c<o;c++)u(c)},n)}}function g(e,t,r){e?(0,h.executeSchedule)(r,e,t):t()}}),n("j6OvA",function(e,r){t(e.exports,"argsArgArrayOrObject",function(){return a});var n=Array.isArray,o=Object.getPrototypeOf,i=Object.prototype,s=Object.keys;function a(e){if(1===e.length){var t=e[0];if(n(t))return{args:t,keys:null};if(t&&"object"==typeof t&&o(t)===i){var r=s(t);return{args:r.map(function(e){return t[e]}),keys:r}}}return{args:e,keys:null}}}),n("kXLY9",function(e,n){t(e.exports,"from",function(){return s});var o=r("6IDxO"),i=r("jzqEI");function s(e,t){return t?(0,o.scheduled)(e,t):(0,i.innerFrom)(e)}}),n("6IDxO",function(e,n){t(e.exports,"scheduled",function(){return _});var o=r("7yWwW"),i=r("8TTSf"),s=r("UB66k"),a=r("1eZZx"),l=r("w7zot"),u=r("bNutF"),c=r("5FGNl"),d=r("fBvih"),h=r("i4b9N"),p=r("7V3Wo"),f=r("z0RWe"),g=r("jMImb"),m=r("4k5ma");function _(e,t){if(null!=e){if((0,u.isInteropObservable)(e))return(0,o.scheduleObservable)(e,t);if((0,d.isArrayLike)(e))return(0,s.scheduleArray)(e,t);if((0,c.isPromise)(e))return(0,i.schedulePromise)(e,t);if((0,p.isAsyncIterable)(e))return(0,l.scheduleAsyncIterable)(e,t);if((0,h.isIterable)(e))return(0,a.scheduleIterable)(e,t);if((0,g.isReadableStreamLike)(e))return(0,m.scheduleReadableStreamLike)(e,t)}throw(0,f.createInvalidObservableTypeError)(e)}}),n("7yWwW",function(e,n){t(e.exports,"scheduleObservable",function(){return a});var o=r("jzqEI"),i=r("1sL2G"),s=r("j2lqv");function a(e,t){return(0,o.innerFrom)(e).pipe((0,s.subscribeOn)(t),(0,i.observeOn)(t))}}),n("jzqEI",function(e,n){t(e.exports,"innerFrom",function(){return m});var o=r("9tuco"),i=r("fBvih"),s=r("5FGNl"),a=r("3KKCW"),l=r("bNutF"),u=r("7V3Wo"),c=r("z0RWe"),d=r("i4b9N"),h=r("jMImb"),p=r("im29J"),f=r("6sJHQ"),g=r("cZTHs");function m(e){if(e instanceof a.Observable)return e;if(null!=e){if((0,l.isInteropObservable)(e))return new a.Observable(function(t){var r=e[0,g.observable]();if((0,p.isFunction)(r.subscribe))return r.subscribe(t);throw TypeError("Provided object does not correctly implement Symbol.observable")});if((0,i.isArrayLike)(e))return new a.Observable(function(t){for(var r=0;r<e.length&&!t.closed;r++)t.next(e[r]);t.complete()});if((0,s.isPromise)(e))return new a.Observable(function(t){e.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,f.reportUnhandledError)});if((0,u.isAsyncIterable)(e))return _(e);if((0,d.isIterable)(e))return new a.Observable(function(t){var r,n;try{for(var i=(0,o.__values)(e),s=i.next();!s.done;s=i.next()){var a=s.value;if(t.next(a),t.closed)return}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}t.complete()});if((0,h.isReadableStreamLike)(e))return _((0,h.readableStreamLikeToAsyncGenerator)(e))}throw(0,c.createInvalidObservableTypeError)(e)}function _(e){return new a.Observable(function(t){(function(e,t){var r,n,i,s;return(0,o.__awaiter)(this,void 0,void 0,function(){var a;return(0,o.__generator)(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),r=(0,o.__asyncValues)(e),l.label=1;case 1:return[4,r.next()];case 2:if((n=l.sent()).done)return[3,4];if(a=n.value,t.next(a),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return i={error:l.sent()},[3,11];case 6:if(l.trys.push([6,,9,10]),!(n&&!n.done&&(s=r.return)))return[3,8];return[4,s.call(r)];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})})(e,t).catch(function(e){return t.error(e)})})}}),n("fBvih",function(e,r){t(e.exports,"isArrayLike",function(){return n});var n=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e}}),n("5FGNl",function(e,n){t(e.exports,"isPromise",function(){return i});var o=r("im29J");function i(e){return(0,o.isFunction)(null==e?void 0:e.then)}}),n("bNutF",function(e,n){t(e.exports,"isInteropObservable",function(){return s});var o=r("cZTHs"),i=r("im29J");function s(e){return(0,i.isFunction)(e[o.observable])}}),n("7V3Wo",function(e,n){t(e.exports,"isAsyncIterable",function(){return i});var o=r("im29J");function i(e){return Symbol.asyncIterator&&(0,o.isFunction)(null==e?void 0:e[Symbol.asyncIterator])}}),n("z0RWe",function(e,r){t(e.exports,"createInvalidObservableTypeError",function(){return n});function n(e){return TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}}),n("i4b9N",function(e,n){t(e.exports,"isIterable",function(){return s});var o=r("KeWPv"),i=r("im29J");function s(e){return(0,i.isFunction)(null==e?void 0:e[o.iterator])}}),n("KeWPv",function(e,r){t(e.exports,"iterator",function(){return n});var n="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}),n("jMImb",function(e,n){t(e.exports,"readableStreamLikeToAsyncGenerator",function(){return s}),t(e.exports,"isReadableStreamLike",function(){return a});var o=r("9tuco"),i=r("im29J");function s(e){return(0,o.__asyncGenerator)(this,arguments,function(){var t,r,n;return(0,o.__generator)(this,function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,(0,o.__await)(t.read())];case 3:if(n=(r=i.sent()).value,!r.done)return[3,5];return[4,(0,o.__await)(void 0)];case 4:return[2,i.sent()];case 5:return[4,(0,o.__await)(n)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function a(e){return(0,i.isFunction)(null==e?void 0:e.getReader)}}),n("1sL2G",function(e,n){t(e.exports,"observeOn",function(){return a});var o=r("idNW3"),i=r("jaOYC"),s=r("hMcgT");function a(e,t){return void 0===t&&(t=0),(0,i.operate)(function(r,n){r.subscribe((0,s.createOperatorSubscriber)(n,function(r){return(0,o.executeSchedule)(n,e,function(){return n.next(r)},t)},function(){return(0,o.executeSchedule)(n,e,function(){return n.complete()},t)},function(r){return(0,o.executeSchedule)(n,e,function(){return n.error(r)},t)}))})}}),n("idNW3",function(e,r){t(e.exports,"executeSchedule",function(){return n});function n(e,t,r,n,o){void 0===n&&(n=0),void 0===o&&(o=!1);var i=t.schedule(function(){r(),o?e.add(this.schedule(null,n)):this.unsubscribe()},n);if(e.add(i),!o)return i}}),n("jaOYC",function(e,n){t(e.exports,"operate",function(){return i});var o=r("im29J");function i(e){return function(t){if((0,o.isFunction)(null==t?void 0:t.lift))return t.lift(function(t){try{return e(t,this)}catch(e){this.error(e)}});throw TypeError("Unable to lift unknown Observable type")}}}),n("hMcgT",function(e,n){t(e.exports,"createOperatorSubscriber",function(){return i});var o=r("9tuco");function i(e,t,r,n,o){return new s(e,t,r,n,o)}var s=function(e){function t(t,r,n,o,i,s){var a=e.call(this,t)||this;return a.onFinalize=i,a.shouldUnsubscribe=s,a._next=r?function(e){try{r(e)}catch(e){t.error(e)}}:e.prototype._next,a._error=o?function(e){try{o(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=n?function(){try{n()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,a}return(0,o.__extends)(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),r||null===(t=this.onFinalize)||void 0===t||t.call(this)}},t}(r("7e8Ix").Subscriber)}),n("j2lqv",function(e,n){t(e.exports,"subscribeOn",function(){return i});var o=r("jaOYC");function i(e,t){return void 0===t&&(t=0),(0,o.operate)(function(r,n){n.add(e.schedule(function(){return r.subscribe(n)},t))})}}),n("8TTSf",function(e,n){t(e.exports,"schedulePromise",function(){return a});var o=r("jzqEI"),i=r("1sL2G"),s=r("j2lqv");function a(e,t){return(0,o.innerFrom)(e).pipe((0,s.subscribeOn)(t),(0,i.observeOn)(t))}}),n("UB66k",function(e,n){t(e.exports,"scheduleArray",function(){return i});var o=r("3KKCW");function i(e,t){return new o.Observable(function(r){var n=0;return t.schedule(function(){n===e.length?r.complete():(r.next(e[n++]),r.closed||this.schedule())})})}}),n("1eZZx",function(e,n){t(e.exports,"scheduleIterable",function(){return l});var o=r("3KKCW"),i=r("KeWPv"),s=r("im29J"),a=r("idNW3");function l(e,t){return new o.Observable(function(r){var n;return(0,a.executeSchedule)(r,t,function(){n=e[0,i.iterator](),(0,a.executeSchedule)(r,t,function(){var e,t,o;try{t=(e=n.next()).value,o=e.done}catch(e){r.error(e);return}o?r.complete():r.next(t)},0,!0)}),function(){return(0,s.isFunction)(null==n?void 0:n.return)&&n.return()}})}}),n("w7zot",function(e,n){t(e.exports,"scheduleAsyncIterable",function(){return s});var o=r("3KKCW"),i=r("idNW3");function s(e,t){if(!e)throw Error("Iterable cannot be null");return new o.Observable(function(r){(0,i.executeSchedule)(r,t,function(){var n=e[Symbol.asyncIterator]();(0,i.executeSchedule)(r,t,function(){n.next().then(function(e){e.done?r.complete():r.next(e.value)})},0,!0)})})}}),n("4k5ma",function(e,n){t(e.exports,"scheduleReadableStreamLike",function(){return s});var o=r("w7zot"),i=r("jMImb");function s(e,t){return(0,o.scheduleAsyncIterable)((0,i.readableStreamLikeToAsyncGenerator)(e),t)}}),n("6pRSk",function(e,n){t(e.exports,"mapOneOrManyArgs",function(){return a});var o=r("9tuco"),i=r("fElJC"),s=Array.isArray;function a(e){return(0,i.map)(function(t){return s(t)?e.apply(void 0,(0,o.__spreadArray)([],(0,o.__read)(t))):e(t)})}}),n("fElJC",function(e,n){t(e.exports,"map",function(){return s});var o=r("jaOYC"),i=r("hMcgT");function s(e,t){return(0,o.operate)(function(r,n){var o=0;r.subscribe((0,i.createOperatorSubscriber)(n,function(r){n.next(e.call(t,r,o++))}))})}}),n("sCDrc",function(e,n){t(e.exports,"popResultSelector",function(){return a}),t(e.exports,"popScheduler",function(){return l}),t(e.exports,"popNumber",function(){return u});var o=r("im29J"),i=r("73uzh");function s(e){return e[e.length-1]}function a(e){return(0,o.isFunction)(s(e))?e.pop():void 0}function l(e){return(0,i.isScheduler)(s(e))?e.pop():void 0}function u(e,t){return"number"==typeof s(e)?e.pop():t}}),n("73uzh",function(e,n){t(e.exports,"isScheduler",function(){return i});var o=r("im29J");function i(e){return e&&(0,o.isFunction)(e.schedule)}}),n("4vTTG",function(e,r){t(e.exports,"createObject",function(){return n});function n(e,t){return e.reduce(function(e,r,n){return e[r]=t[n],e},{})}}),n("eSxk0",function(e,n){t(e.exports,"distinctUntilChanged",function(){return a});var o=r("agvo5"),i=r("jaOYC"),s=r("hMcgT");function a(e,t){return void 0===t&&(t=o.identity),e=null!=e?e:l,(0,i.operate)(function(r,n){var o,i=!0;r.subscribe((0,s.createOperatorSubscriber)(n,function(r){var s=t(r);(i||!e(o,s))&&(i=!1,o=s,n.next(r))}))})}function l(e,t){return e===t}}),n("a9FIH",function(e,n){t(e.exports,"filter",function(){return s});var o=r("jaOYC"),i=r("hMcgT");function s(e,t){return(0,o.operate)(function(r,n){var o=0;r.subscribe((0,i.createOperatorSubscriber)(n,function(r){return e.call(t,r,o++)&&n.next(r)}))})}}),n("d0sRG",function(e,n){t(e.exports,"merge",function(){return u});var o=r("dojbi"),i=r("jzqEI"),s=r("lhKdU"),a=r("sCDrc"),l=r("kXLY9");function u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=(0,a.popScheduler)(e),n=(0,a.popNumber)(e,1/0);return e.length?1===e.length?(0,i.innerFrom)(e[0]):(0,o.mergeAll)(n)((0,l.from)(e,r)):s.EMPTY}}),n("dojbi",function(e,n){t(e.exports,"mergeAll",function(){return s});var o=r("9e68V"),i=r("agvo5");function s(e){return void 0===e&&(e=1/0),(0,o.mergeMap)(i.identity,e)}}),n("9e68V",function(e,n){t(e.exports,"mergeMap",function(){return function e(t,r,n){return(void 0===n&&(n=1/0),(0,l.isFunction)(r))?e(function(e,n){return(0,o.map)(function(t,o){return r(e,t,n,o)})((0,i.innerFrom)(t(e,n)))},n):("number"==typeof r&&(n=r),(0,s.operate)(function(e,r){return(0,a.mergeInternals)(e,r,t,n)}))}});var o=r("fElJC"),i=r("jzqEI"),s=r("jaOYC"),a=r("5bFHp"),l=r("im29J")}),n("5bFHp",function(e,n){t(e.exports,"mergeInternals",function(){return a});var o=r("jzqEI"),i=r("idNW3"),s=r("hMcgT");function a(e,t,r,n,a,l,u,c){var d=[],h=0,p=0,f=!1,g=function(){!f||d.length||h||t.complete()},m=function(e){return h<n?_(e):d.push(e)},_=function(e){l&&t.next(e),h++;var c=!1;(0,o.innerFrom)(r(e,p++)).subscribe((0,s.createOperatorSubscriber)(t,function(e){null==a||a(e),l?m(e):t.next(e)},function(){c=!0},void 0,function(){if(c)try{for(h--;d.length&&h<n;)!function(){var e=d.shift();u?(0,i.executeSchedule)(t,u,function(){return _(e)}):_(e)}();g()}catch(e){t.error(e)}}))};return e.subscribe((0,s.createOperatorSubscriber)(t,m,function(){f=!0,g()})),function(){null==c||c()}}}),n("lhKdU",function(e,n){t(e.exports,"EMPTY",function(){return o});var o=new(r("3KKCW")).Observable(function(e){return e.complete()})}),n("bA4Xh",function(e,n){t(e.exports,"of",function(){return s});var o=r("sCDrc"),i=r("kXLY9");function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=(0,o.popScheduler)(e);return(0,i.from)(e,r)}}),n("9kWt8",function(e,n){t(e.exports,"skip",function(){return i});var o=r("a9FIH");function i(e){return(0,o.filter)(function(t,r){return e<=r})}}),n("bspY6",function(e,n){t(e.exports,"timer",function(){return l});var o=r("3KKCW"),i=r("fVAG8"),s=r("73uzh"),a=r("78k3C");function l(e,t,r){void 0===e&&(e=0),void 0===r&&(r=i.async);var n=-1;return null!=t&&((0,s.isScheduler)(t)?r=t:n=t),new o.Observable(function(t){var o=(0,a.isValidDate)(e)?+e-r.now():e;o<0&&(o=0);var i=0;return r.schedule(function(){t.closed||(t.next(i++),0<=n?this.schedule(void 0,n):t.complete())},o)})}}),n("fVAG8",function(e,n){t(e.exports,"asyncScheduler",function(){return i}),t(e.exports,"async",function(){return s});var o=r("gGhjx"),i=new(r("aZ1GC")).AsyncScheduler(o.AsyncAction),s=i}),n("gGhjx",function(e,n){t(e.exports,"AsyncAction",function(){return l});var o=r("9tuco"),i=r("kvIAD"),s=r("7hUiW"),a=r("iDS9r"),l=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.scheduler=t,n.work=r,n.pending=!1,n}return(0,o.__extends)(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r,n=this.id,o=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(o,n,t)),this.pending=!0,this.delay=t,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(o,this.id,t),this},t.prototype.requestAsyncId=function(e,t,r){return void 0===r&&(r=0),(0,s.intervalProvider).setInterval(e.flush.bind(e,this),r)},t.prototype.recycleAsyncId=function(e,t,r){if(void 0===r&&(r=0),null!=r&&this.delay===r&&!1===this.pending)return t;null!=t&&(0,s.intervalProvider).clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return Error("executing a cancelled action");this.pending=!1;var r=this._execute(e,t);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var r,n=!1;try{this.work(e)}catch(e){n=!0,r=e||Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),r},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,r=this.scheduler,n=r.actions;this.work=this.state=this.scheduler=null,this.pending=!1,(0,a.arrRemove)(n,this),null!=t&&(this.id=this.recycleAsyncId(r,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(i.Action)}),n("kvIAD",function(e,n){t(e.exports,"Action",function(){return i});var o=r("9tuco"),i=function(e){function t(t,r){return e.call(this)||this}return(0,o.__extends)(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(r("dCdPC").Subscription)}),n("7hUiW",function(e,n){t(e.exports,"intervalProvider",function(){return i});var o=r("9tuco"),i={setInterval:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var s=i.delegate;return(null==s?void 0:s.setInterval)?s.setInterval.apply(s,(0,o.__spreadArray)([e,t],(0,o.__read)(r))):setInterval.apply(void 0,(0,o.__spreadArray)([e,t],(0,o.__read)(r)))},clearInterval:function(e){var t=i.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0}}),n("aZ1GC",function(e,n){t(e.exports,"AsyncScheduler",function(){return s});var o=r("9tuco"),i=r("hNMRY"),s=function(e){function t(t,r){void 0===r&&(r=i.Scheduler.now);var n=e.call(this,t,r)||this;return n.actions=[],n._active=!1,n}return(0,o.__extends)(t,e),t.prototype.flush=function(e){var t,r=this.actions;if(this._active){r.push(e);return}this._active=!0;do if(t=e.execute(e.state,e.delay))break;while(e=r.shift())if(this._active=!1,t){for(;e=r.shift();)e.unsubscribe();throw t}},t}(i.Scheduler)}),n("hNMRY",function(e,n){t(e.exports,"Scheduler",function(){return i});var o=r("jBYTm"),i=function(){function e(t,r){void 0===r&&(r=e.now),this.schedulerActionCtor=t,this.now=r}return e.prototype.schedule=function(e,t,r){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(r,t)},e.now=o.dateTimestampProvider.now,e}()}),n("jBYTm",function(e,r){t(e.exports,"dateTimestampProvider",function(){return n});var n={now:function(){return(n.delegate||Date).now()},delegate:void 0}}),n("78k3C",function(e,r){t(e.exports,"isValidDate",function(){return n});function n(e){return e instanceof Date&&!isNaN(e)}}),n("bVip2",function(e,n){t(e.exports,"debounceTime",function(){return a});var o=r("fVAG8"),i=r("jaOYC"),s=r("hMcgT");function a(e,t){return void 0===t&&(t=o.asyncScheduler),(0,i.operate)(function(r,n){var o=null,i=null,a=null,l=function(){if(o){o.unsubscribe(),o=null;var e=i;i=null,n.next(e)}};function u(){var r=a+e,i=t.now();if(i<r){o=this.schedule(void 0,r-i),n.add(o);return}l()}r.subscribe((0,s.createOperatorSubscriber)(n,function(r){i=r,a=t.now(),o||(o=t.schedule(u,e),n.add(o))},function(){l(),n.complete()},void 0,function(){i=o=null}))})}}),n("2zeiB",function(e,n){t(e.exports,"first",function(){return c});var o=r("jbQQ8"),i=r("a9FIH"),s=r("lXa9G"),a=r("5E1X4"),l=r("jlN6v"),u=r("agvo5");function c(e,t){var r=arguments.length>=2;return function(n){return n.pipe(e?(0,i.filter)(function(t,r){return e(t,r,n)}):u.identity,(0,s.take)(1),r?(0,a.defaultIfEmpty)(t):(0,l.throwIfEmpty)(function(){return new o.EmptyError}))}}}),n("jbQQ8",function(e,n){t(e.exports,"EmptyError",function(){return o});var o=(0,r("AdhWW").createErrorClass)(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}})}),n("lXa9G",function(e,n){t(e.exports,"take",function(){return a});var o=r("lhKdU"),i=r("jaOYC"),s=r("hMcgT");function a(e){return e<=0?function(){return o.EMPTY}:(0,i.operate)(function(t,r){var n=0;t.subscribe((0,s.createOperatorSubscriber)(r,function(t){++n<=e&&(r.next(t),e<=n&&r.complete())}))})}}),n("5E1X4",function(e,n){t(e.exports,"defaultIfEmpty",function(){return s});var o=r("jaOYC"),i=r("hMcgT");function s(e){return(0,o.operate)(function(t,r){var n=!1;t.subscribe((0,i.createOperatorSubscriber)(r,function(e){n=!0,r.next(e)},function(){n||r.next(e),r.complete()}))})}}),n("jlN6v",function(e,n){t(e.exports,"throwIfEmpty",function(){return a});var o=r("jbQQ8"),i=r("jaOYC"),s=r("hMcgT");function a(e){return void 0===e&&(e=l),(0,i.operate)(function(t,r){var n=!1;t.subscribe((0,s.createOperatorSubscriber)(r,function(e){n=!0,r.next(e)},function(){return n?r.complete():r.error(e())}))})}function l(){return new o.EmptyError}}),n("kUeYt",function(e,t){var r,n,o,i=e.exports={};function s(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function l(e){if(r===setTimeout)return setTimeout(e,0);if((r===s||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:s}catch(e){r=s}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var u=[],c=!1,d=-1;function h(){c&&o&&(c=!1,o.length?u=o.concat(u):d=-1,u.length&&p())}function p(){if(!c){var e=l(h);c=!0;for(var t=u.length;t;){for(o=u,u=[];++d<t;)o&&o[d].run();d=-1,t=u.length}o=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new f(e,t)),1!==u.length||c||l(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw Error("process.chdir is not supported")},i.umask=function(){return 0}})}();
//# sourceMappingURL=es.29c55add.js.map
