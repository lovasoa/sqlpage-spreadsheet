function e(e,t,n,i){Object.defineProperty(e,t,{get:n,set:i,enumerable:!0,configurable:!0})}var t=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire26fc,n=t.register;n("g6Cit",function(n,i){let r,a,o,s,l,A,d,c,u;e(n.exports,"DOCS_VIEW_KEY",function(){return W}),e(n.exports,"VIEWPORT_KEY",function(){return z}),e(n.exports,"DOCS_COMPONENT_MAIN_LAYER_INDEX",function(){return G}),e(n.exports,"addCustomRangeBySelectionFactory",function(){return Z}),e(n.exports,"deleteCustomRangeFactory",function(){return $}),e(n.exports,"replaceSelectionFactory",function(){return et}),e(n.exports,"InsertCommand",function(){return eo}),e(n.exports,"BreakLineCommand",function(){return ed}),e(n.exports,"DeleteLeftCommand",function(){return eH}),e(n.exports,"IMEInputCommand",function(){return tA}),e(n.exports,"SetInlineFormatCommand",function(){return tQ}),e(n.exports,"SetInlineFormatBoldCommand",function(){return tu}),e(n.exports,"SetInlineFormatItalicCommand",function(){return th}),e(n.exports,"SetInlineFormatUnderlineCommand",function(){return tm}),e(n.exports,"SetInlineFormatStrikethroughCommand",function(){return tI}),e(n.exports,"SetInlineFormatSubscriptCommand",function(){return tE}),e(n.exports,"SetInlineFormatSuperscriptCommand",function(){return tT}),e(n.exports,"SetInlineFormatFontSizeCommand",function(){return ty}),e(n.exports,"SetInlineFormatFontFamilyCommand",function(){return tx}),e(n.exports,"SetInlineFormatTextColorCommand",function(){return tO}),e(n.exports,"ReplaceContentCommand",function(){return t1}),e(n.exports,"CoverContentCommand",function(){return t9}),e(n.exports,"MoveCursorOperation",function(){return ng}),e(n.exports,"MoveSelectionOperation",function(){return nh}),e(n.exports,"NodePositionConvertToCursor",function(){return nH}),e(n.exports,"getLineBounding",function(){return nq}),e(n.exports,"getCanvasOffsetByEngine",function(){return n2}),e(n.exports,"DocSelectionRenderService",function(){return io}),e(n.exports,"DOC_VERTICAL_PADDING",function(){return oI}),e(n.exports,"DocCanvasPopManagerService",function(){return oR}),e(n.exports,"DocEventManagerService",function(){return oQ}),e(n.exports,"UniverDocsUIPlugin",function(){return s2});var g=t("7yNYd"),h=t("7AR1b"),p=t("3e0Iz"),m=t("fL2Ug"),f=t("6nOkr"),I=t("5LPkb"),S=t("5K4WI"),E=t("arCqp"),v=t("lMvMU"),T=t("5HvWP"),C=t("hciHF"),y=t("97m73"),b=t("1O3Nt"),x=t("1mjSk"),R=t("9z4na"),O=t("2jrJe"),B=t("gv2K9"),M=t("5gqvu"),D=t("1UDbf"),N=t("aFl3s"),P=t("binOv"),v=t("lMvMU"),C=t("hciHF"),Q=Object.defineProperty,U=(e,t,n)=>t in e?Q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,_=(e,t)=>Q(e,"name",{value:t,configurable:!0}),w=(e,t,n)=>U(e,"symbol"!=typeof t?t+"":t,n),L=Object.defineProperty,F=Object.getOwnPropertyDescriptor,k=/* @__PURE__ */_((e,t,n,i)=>{for(var r,a=i>1?void 0:i?F(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&L(t,n,a),a},"__decorateClass$q"),H=/* @__PURE__ */_((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$q");function V(e,t){var n,i;let{startOffset:r,endOffset:a}=e,o=[],s=-1;for(let e=0;e<t.length;e++){let l=t[e],A=t[e-1],{startIndex:d}=l;r>s&&r<=d||a>s&&a<=d?o.push({...l,paragraphStart:(null!=(n=null==A?void 0:A.startIndex)?n:-1)+1,paragraphEnd:l.startIndex}):d>=r&&d<=a&&o.push({...l,paragraphStart:(null!=(i=null==A?void 0:A.startIndex)?i:-1)+1,paragraphEnd:l.startIndex}),s=d}return o}_(V,"getParagraphsInRange$1");let j=(_(n5=class extends g.Disposable{constructor(e,t){super(),w(this,"_matches",/* @__PURE__ */new Map),this._univerInstanceService=e,this._textSelectionManagerService=t}registerAutoFormat(e){let t=this._matches.get(e.id);return t?(t.push(e),t.sort((e,t)=>{var n,i;return(null!=(n=t.priority)?n:0)-(null!=(i=e.priority)?i:0)})):this._matches.set(e.id,[e]),(0,g.toDisposable)(()=>{let t=this._matches.get(e.id);if(t){let n=t.findIndex(t=>t===e);n>=0&&t.splice(n,1)}})}onAutoFormat(e,t){var n,i,r,a,o,s;let l=null!=(n=this._matches.get(e))?n:[],A=this._univerInstanceService.getCurrentUnitForType(g.UniverInstanceType.UNIVER_DOC),d=this._textSelectionManagerService.getActiveTextRange();if(A&&d){let n=A.getSelfOrHeaderFooterModel(d.segmentId),c={unit:n,selection:d,isBody:!d.segmentId,paragraphs:V(d,null!=(r=null==(i=n.getBody())?void 0:i.paragraphs)?r:[]),customRanges:(0,g.BuildTextUtils).customRange.getCustomRangesInterestsWithRange(d,null!=(o=null==(a=n.getBody())?void 0:a.customRanges)?o:[]),commandId:e,commandParams:t},u=l.find(e=>e.match(c));return null!=(s=null==u?void 0:u.getMutations(c))?s:[]}return[]}},"DocAutoFormatService"),n5);j=k([H(0,g.IUniverInstanceService),H(1,(0,g.Inject)(h.DocSelectionManagerService))],j);var W=((r=W||{}).MAIN="__Document_Render_Main__",r.BACKGROUND="__Document_Render_Background__",r),z=((a=z||{}).VIEW_MAIN="viewMain",a.VIEW_TOP="viewTop",a.VIEW_LEFT="viewLeft",a.VIEW_LEFT_TOP="viewLeftTop",a);let G=2;function Y(e){let{mainComponent:t,scene:n,engine:i,components:r}=e;return{document:t,docBackground:r.get(W.BACKGROUND),scene:n,engine:i}}function K(e,t){let n=e.getCurrentUnitForType(g.UniverInstanceType.UNIVER_DOC);if(!n)return null;let i=n.getUnitId(),r=t.getRenderById(i);if(null==r)return;let{mainComponent:a,scene:o,engine:s,components:l}=r;return{document:a,docBackground:l.get(W.BACKGROUND),scene:o,engine:s}}function q(e){let{unitId:t,ranges:n,id:i,type:r,segmentId:a}=e,o={id:h.RichTextEditingMutation.id,params:{unitId:t,actions:[],textRanges:void 0}},s=new g.TextX,l=(0,g.JSONX).getInstance(),A=0;for(let e=0;e<n.length;e++){let{startOffset:t,endOffset:o}=n[e];t>0&&s.push({t:g.TextXActionType.RETAIN,len:t-A,segmentId:a}),s.push({t:g.TextXActionType.RETAIN,body:{dataStream:"",customDecorations:[{id:i,type:r,startIndex:0,endIndex:o-t-1}]},len:o-t,segmentId:a}),A=o}return o.params.actions=l.editOp(s.serialize()),o}function X(e,t){var n;return null==(n=e.get(p.IRenderManagerService).getRenderById(t))?void 0:n.with(h.DocSkeletonManagerService)}function J(e,t=""){if(!t)return["body"];let{headers:n,footers:i}=e.getSnapshot();if(null==n&&null==i)throw Error("Document data model must have headers or footers when update by segment id");if((null==n?void 0:n[t])!=null)return["headers",t,"body"];if((null==i?void 0:i[t])!=null)return["footers",t,"body"];throw Error("Segment id not found in headers or footers")}function Z(e,t){let{rangeId:n,rangeType:i,wholeEntity:r,properties:a,unitId:o,selection:s}=t,l=e.get(h.DocSelectionManagerService),A=e.get(g.IUniverInstanceService),d=null!=s?s:l.getActiveTextRange(),c=null==d?void 0:d.segmentId;if(!d)return!1;let u=A.getUnit(o,g.UniverInstanceType.UNIVER_DOC);if(!u)return!1;let p=u.getSelfOrHeaderFooterModel(d.segmentId).getBody();if(!p)return!1;let{startOffset:m,endOffset:f}=(0,g.BuildTextUtils).selection.normalizeSelection(d),I=(0,g.BuildTextUtils).customRange.add({range:{startOffset:m,endOffset:f,collapsed:m===f},rangeId:n,rangeType:i,segmentId:c,wholeEntity:r,properties:a,body:p});if(!I)return!1;let S=(0,g.JSONX).getInstance(),E={id:h.RichTextEditingMutation.id,params:{unitId:o,actions:[],textRanges:void 0},textX:I},v=J(u,c);return E.params.actions=S.editOp(I.serialize(),v),E}function $(e,t){let{unitId:n,segmentId:i,insert:r}=t,a=e.get(g.IUniverInstanceService).getUnit(n);if(!a)return!1;let o={id:h.RichTextEditingMutation.id,params:{unitId:t.unitId,actions:[],textRanges:void 0,segmentId:i}},s=(0,g.JSONX).getInstance(),l=(0,g.BuildTextUtils).customRange.delete(e,{documentDataModel:a,rangeId:t.rangeId,insert:r,segmentId:i});if(!l)return!1;let A=J(a,i);return o.params.actions=s.editOp(l.serialize(),A),o}function ee(e,t){return t.some(t=>e.startIndex>t.startIndex&&e.startIndex<t.endIndex)}function et(e,t){var n,i,r,a;let{unitId:o,body:s,doc:l}=t,A=l;if(A||(A=e.get(g.IUniverInstanceService).getUnit(o)),!A)return!1;let d=null==(n=t.selection)?void 0:n.segmentId,c=null==(i=A.getSelfOrHeaderFooterModel(d))?void 0:i.getBody();if(!c)return!1;let u=e.get(h.DocSelectionManagerService),p=null!=(r=t.selection)?r:u.getActiveTextRange();if(!p||!c)return!1;let m=null!=(a=t.textRanges)?a:[{startOffset:p.startOffset+s.dataStream.length,endOffset:p.startOffset+s.dataStream.length,collapsed:!0,segmentId:d}],f=(0,g.BuildTextUtils).selection.replace({selection:p,body:s,doc:A});if(!f)return!1;let I={id:h.RichTextEditingMutation.id,params:{unitId:o,actions:[],textRanges:m,debounce:!0,segmentId:d},textX:f},S=(0,g.JSONX).getInstance(),E=J(A,d);return I.params.actions=S.editOp(f.serialize(),E),I}_(Y,"neoGetDocObject"),_(K,"getDocObject"),_(function(e,t){let n=t.getRenderById(e);if(null==n)return;let{mainComponent:i,scene:r,engine:a,components:o}=n;return{document:i,docBackground:o.get(W.BACKGROUND),scene:r,engine:a}},"getDocObjectById"),_(q,"addCustomDecorationFactory"),_(function(e,t){let{segmentId:n,id:i,type:r}=t,a=e.get(h.DocSelectionManagerService),o=e.get(g.IUniverInstanceService),s=a.getCurrentTextRanges();if(!s)return!1;let l=o.getCurrentUnitForType(g.UniverInstanceType.UNIVER_DOC);if(!l)return!1;let A=l.getBody(),d=l.getUnitId();return!!A&&q({unitId:d,ranges:s,id:i,type:r,segmentId:n})},"addCustomDecorationBySelectionFactory"),_(function(e,t){var n,i;let{unitId:r,id:a,segmentId:o}=t,s=e.get(g.IUniverInstanceService).getUnit(r),l=null==s?void 0:s.getBody();if(!s||!l)return!1;let A=null==(i=null==(n=s.getBody())?void 0:n.customDecorations)?void 0:i.filter(e=>e.id===a);if(!(null!=A&&A.length))return!1;let d=A.map(e=>(0,g.getBodySlice)(l,e.startIndex,e.endIndex+1)),c=d.map(e=>{var t;let n=(0,g.Tools).deepClone(e);return n.customDecorations=null==(t=n.customDecorations)?void 0:t.filter(e=>e.id!==a),n}),u={id:h.RichTextEditingMutation.id,params:{unitId:r,actions:[],textRanges:void 0}},p=new g.TextX,m=(0,g.JSONX).getInstance(),f=0;return A.forEach((e,t)=>{let n=c[t],i=d[t];e.startIndex!==f&&p.push({t:g.TextXActionType.RETAIN,len:e.startIndex-f,segmentId:o}),f=e.startIndex,p.push({t:g.TextXActionType.RETAIN,len:e.endIndex-e.startIndex+1,segmentId:o,body:n,oldBody:i,coverType:g.UpdateDocsAttributeType.REPLACE}),f+=e.endIndex-e.startIndex+1}),u.params.actions=m.editOp(p.serialize()),u},"deleteCustomDecorationFactory"),_(X,"getCommandSkeleton"),_(J,"getRichTextEditPath"),_(function(e,t,n){let{unitId:i,segmentId:r}=t,a=e.get(g.IUniverInstanceService).getUnit(i);if(!a)return!1;let o={id:h.RichTextEditingMutation.id,params:{unitId:t.unitId,actions:[],textRanges:void 0}},s=(0,g.JSONX).getInstance(),l=(0,g.BuildTextUtils).customRange.add({...t,body:n});if(!l)return!1;let A=J(a,r);return o.params.actions=s.editOp(l.serialize(),A),o},"addCustomRangeFactory"),_(Z,"addCustomRangeBySelectionFactory"),_($,"deleteCustomRangeFactory"),_(ee,"hasParagraphInTable"),_(et,"replaceSelectionFactory"),_(function(e){return{left:e.positionH.posOffset,top:e.positionV.posOffset,width:e.size.width,height:e.size.height}},"docDrawingPositionToTransform"),_(function(e,t=0,n=0){return{size:{width:e.width,height:e.height},positionH:{relativeFrom:g.ObjectRelativeFromH.MARGIN,posOffset:(e.left||0)-t},positionV:{relativeFrom:g.ObjectRelativeFromV.PAGE,posOffset:(e.top||0)-n},angle:e.angle||0}},"transformToDocDrawingPosition");let en={id:"doc.command.tab",type:g.CommandType.COMMAND,async handler(e,t){let n=e.get(j).onAutoFormat(en.id,t);return(await (0,g.sequenceExecuteAsync)(n,e.get(g.ICommandService))).result}},ei={id:"doc.command.after-space",type:g.CommandType.COMMAND,async handler(e){let t=e.get(j).onAutoFormat(ei.id);return(await (0,g.sequenceExecuteAsync)(t,e.get(g.ICommandService))).result}},er={id:"doc.command.enter",type:g.CommandType.COMMAND,async handler(e){let t=e.get(j).onAutoFormat(er.id);return(await (0,g.sequenceExecuteAsync)(t,e.get(g.ICommandService))).result}};var ea=((o=ea||{})[o.LEFT=0]="LEFT",o[o.RIGHT=1]="RIGHT",o);let eo={id:"doc.command.insert-text",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>{var n;let i=e.get(g.ICommandService),{range:r,segmentId:a,body:o,unitId:s,cursorOffset:l,extendLastRange:A}=t,d=e.get(h.DocSelectionManagerService),c=e.get(g.IUniverInstanceService).getUnit(s,g.UniverInstanceType.UNIVER_DOC);if(null==c)return!1;let u=d.getActiveTextRange(),p=c.getSelfOrHeaderFooterModel(null!=(n=null==u?void 0:u.segmentId)?n:"").getBody();if(!p)return!1;let m=A?(0,g.BuildTextUtils).selection.getDeleteSelection(r,p):(0,g.BuildTextUtils).selection.getInsertSelection(r,p),{startOffset:f,collapsed:I}=m,S=null!=l?l:o.dataStream.length,E=[{startOffset:f+S,endOffset:f+S,style:null==u?void 0:u.style,collapsed:I}],v={id:h.RichTextEditingMutation.id,params:{unitId:s,actions:[],textRanges:E,debounce:!0}},T=new g.TextX,C=(0,g.JSONX).getInstance();if(I)f>0&&T.push({t:g.TextXActionType.RETAIN,len:f,segmentId:a});else{let{dos:e,retain:t}=(0,g.BuildTextUtils).selection.getDeleteActions(m,a,0,p);T.push(...e),v.params.textRanges=[{startOffset:f+S+t,endOffset:f+S+t,collapsed:I}]}T.push({t:g.TextXActionType.INSERT,body:o,len:o.dataStream.length,line:0,segmentId:a});let y=J(c,a);return v.params.actions=C.editOp(T.serialize(),y),!!i.syncExecuteCommand(v.id,v.params)},"handler")},es={id:"doc.command.delete-text",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>{var n;let i=e.get(g.ICommandService),r=e.get(g.IUniverInstanceService),{range:a,segmentId:o,unitId:s,direction:l,len:A=1}=t,d=r.getUnit(s,g.UniverInstanceType.UNIVER_DOC),c=null==d?void 0:d.getSelfOrHeaderFooterModel(o).getBody();if(null==d||null==c)return!1;let{startOffset:u}=a,p=c.dataStream,m=l===ea.LEFT?u-A:u,f=m+A-1,I=null==(n=c.customRanges)?void 0:n.filter(e=>(0,g.BuildTextUtils).customRange.isIntersecting(e.startIndex,e.endIndex,m,f)),S=null==I?void 0:I.filter(e=>(0,g.BuildTextUtils).customRange.shouldDeleteCustomRange(m,A,e,p)),E=[];for(let e=0;e<A;e++)E.push(m+e);null==S||S.forEach(e=>{E.push(e.startIndex,e.endIndex)}),E.sort((e,t)=>e-t);let v=E[0],T={id:h.RichTextEditingMutation.id,params:{unitId:s,actions:[],textRanges:[{startOffset:v,endOffset:v,collapsed:!0}],debounce:!0}},C=new g.TextX,y=(0,g.JSONX).getInstance(),b=0;for(let e=0;e<E.length;e++){let t=E[e];t-b>0&&C.push({t:g.TextXActionType.RETAIN,len:t-b,segmentId:o}),C.push({t:g.TextXActionType.DELETE,len:1,segmentId:o,line:0}),b=t+1}let x=J(d,o);return T.params.actions=y.editOp(C.serialize(),x),!!i.syncExecuteCommand(T.id,T.params)},"handler")},el={id:"doc.command.update-text",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>{let{range:n,segmentId:i,updateBody:r,coverType:a,unitId:o,textRanges:s}=t,l=e.get(g.ICommandService),A=e.get(g.IUniverInstanceService).getCurrentUniverDocInstance();if(null==A)return!1;let d={id:h.RichTextEditingMutation.id,params:{unitId:o,actions:[],textRanges:s}},c=new g.TextX,u=(0,g.JSONX).getInstance(),{startOffset:p,endOffset:m}=n;c.push({t:g.TextXActionType.RETAIN,len:p,segmentId:i}),c.push({t:g.TextXActionType.RETAIN,body:r,len:m-p,segmentId:i,coverType:a});let f=J(A,i);return d.params.actions=u.editOp(c.serialize(),f),!!l.syncExecuteCommand(d.id,d.params)},"handler")};function eA(e,t){var n,i;let r=[];for(let t=0,n=e.length;t<n;t++)e[t]===g.DataStreamTreeTokenType.PARAGRAPH&&r.push({startIndex:t});if(t)for(let e of r)t.bullet&&(e.bullet=(0,g.Tools).deepClone(t.bullet),e.bullet.listType===g.PresetListType.CHECK_LIST_CHECKED&&(e.bullet.listType=g.PresetListType.CHECK_LIST)),t.paragraphStyle&&(e.paragraphStyle=(0,g.Tools).deepClone(t.paragraphStyle),(null==(n=t.bullet)?void 0:n.listType)===g.PresetListType.CHECK_LIST_CHECKED&&null!=(i=e.paragraphStyle)&&i.textStyle&&(e.paragraphStyle.textStyle.st={s:g.BooleanNumber.FALSE}));return r}_(eA,"generateParagraphs");let ed={id:"doc.command.break-line",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async e=>{var t,n;let i=e.get(h.DocSelectionManagerService),r=e.get(g.IUniverInstanceService),a=e.get(g.ICommandService),o=i.getActiveTextRange(),s=i.getCurrentRectRanges();if(null==o)return!1;if(s&&s.length){let{startOffset:e}=o;return i.replaceTextRanges([{startOffset:e,endOffset:e}]),!0}let{segmentId:l}=o,A=r.getCurrentUniverDocInstance(),d=null==A?void 0:A.getSelfOrHeaderFooterModel(l).getBody();if(!A||!d)return!1;let c=A.getUnitId(),{startOffset:u,endOffset:p}=(0,g.BuildTextUtils).selection.getInsertSelection(o,d),m=(null!=(t=d.paragraphs)?t:[]).find(e=>e.startIndex>=u);if(!m||!(m.startIndex>p))return await a.executeCommand(eo.id,{unitId:c,body:{dataStream:g.DataStreamTreeTokenType.PARAGRAPH,paragraphs:eA(g.DataStreamTreeTokenType.PARAGRAPH,m)},range:o,segmentId:l});{let e=(0,g.normalizeBody)((0,g.getBodySlice)(d,p,m.startIndex+1));e.customRanges=null==(n=e.customRanges)?void 0:n.map(g.BuildTextUtils.customRange.copyCustomRange);let t={startOffset:u,endOffset:m.startIndex+1,collapsed:!1};return(0,g.updateAttributeByInsert)(e,{dataStream:g.DataStreamTreeTokenType.PARAGRAPH,paragraphs:eA(g.DataStreamTreeTokenType.PARAGRAPH,m)},1,0),await a.executeCommand(eo.id,{unitId:c,body:e,range:t,segmentId:l,cursorOffset:1})}},"handler")};var ec=((s=ec||{})[s.ABOVE=0]="ABOVE",s[s.BELLOW=1]="BELLOW",s),eu=((l=eu||{})[l.LEFT=0]="LEFT",l[l.RIGHT=1]="RIGHT",l);function eg(e,t){let n=g.DataStreamTreeTokenType.TABLE_START,i=[],r=[];for(let a=0;a<e;a++){n+=g.DataStreamTreeTokenType.TABLE_ROW_START;for(let e=0;e<t;e++)n+=`${g.DataStreamTreeTokenType.TABLE_CELL_START}\r
${g.DataStreamTreeTokenType.TABLE_CELL_END}`,i.push({startIndex:n.length-3,paragraphStyle:{spaceAbove:{v:3},lineSpacing:2,spaceBelow:{v:0}}}),r.push({startIndex:n.length-2});n+=g.DataStreamTreeTokenType.TABLE_ROW_END}return{dataStream:n+=g.DataStreamTreeTokenType.TABLE_END,paragraphs:i,sectionBreaks:r}}function eh(){return{margin:{start:{v:10},end:{v:10},top:{v:5},bottom:{v:5}}}}function ep(e){let t=eh();return{tableCells:[...Array(e).fill(null).map(()=>(0,g.Tools).deepClone(t))],trHeight:{val:{v:30},hRule:g.TableCellHeightRule.AUTO}}}function em(e){return{size:{type:g.TableSizeType.SPECIFIED,width:{v:e}}}}function ef(e,t,n){let i=em(n/t),r=ep(t);return{tableRows:[...Array(e).fill(null).map(()=>(0,g.Tools).deepClone(r))],tableColumns:[...Array(t).fill(null).map(()=>(0,g.Tools).deepClone(i))],tableId:(0,g.generateRandomId)(6),align:g.TableAlignmentType.START,indent:{v:0},textWrap:g.TableTextWrapType.NONE,position:{positionH:{relativeFrom:g.ObjectRelativeFromH.PAGE,posOffset:0},positionV:{relativeFrom:g.ObjectRelativeFromV.PAGE,posOffset:0}},dist:{distB:0,distL:0,distR:0,distT:0},cellMargin:{start:{v:10},end:{v:10},top:{v:5},bottom:{v:5}},size:{type:g.TableSizeType.UNSPECIFIED,width:{v:n}}}}function eI(e,t){if(!e&&!t)return null;if(t&&t.length>0){let e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;for(let i of t){let{startOffset:t,endOffset:r,segmentId:a}=i;null==t||null==r||null==a||(e=Math.min(e,t),n=Math.max(n,r))}if(Number.isFinite(e)&&Number.isFinite(n))return{startOffset:e,endOffset:n,segmentId:""}}else if(e){let{startOffset:t,endOffset:n,segmentId:i}=e;return null==t||null==n||null==i?null:{startOffset:t,endOffset:n,segmentId:i}}}function eS(e){let t=g.DataStreamTreeTokenType.TABLE_ROW_START,n=[],i=[];for(let r=0;r<e;r++)n.push({startIndex:(t+=`${g.DataStreamTreeTokenType.TABLE_CELL_START}\r
${g.DataStreamTreeTokenType.TABLE_CELL_END}`).length-3,paragraphStyle:{spaceAbove:{v:3},lineSpacing:2,spaceBelow:{v:0}}}),i.push({startIndex:t.length-2});return{dataStream:t+=g.DataStreamTreeTokenType.TABLE_ROW_END,paragraphs:n,sectionBreaks:i}}function eE(){let e=`${g.DataStreamTreeTokenType.TABLE_CELL_START}\r
${g.DataStreamTreeTokenType.TABLE_CELL_END}`,t=[],n=[];return t.push({startIndex:1,paragraphStyle:{spaceAbove:{v:3},lineSpacing:2,spaceBelow:{v:0}}}),n.push({startIndex:2}),{dataStream:e,paragraphs:t,sectionBreaks:n}}function ev(e,t,n){var i,r,a;let{startOffset:o,endOffset:s,segmentId:l}=e,A=n.getSelfOrHeaderFooterViewModel(l),d=0===t?o:s,c=null,u=null==(a=null==(r=null==(i=n.getBody())?void 0:i.tables)?void 0:r.find(e=>d>=e.startIndex&&d<=e.endIndex))?void 0:a.tableId,g=0;for(let e of A.children){for(let t of e.children){let{children:e}=t,n=e[0];if(n){for(let e of n.children)if(e.startIndex<=d&&d<=e.endIndex){g=n.children.indexOf(e),c=e;break}}if(c)break}if(c)break}return null==c||null==u?null:{offset:0===t?c.startIndex:c.endIndex+1,colCount:c.children.length,tableId:u,insertRowIndex:0===t?g:g+1}}function eT(e,t,n){var i,r,a;let{startOffset:o,endOffset:s,segmentId:l}=e,A=n.getSelfOrHeaderFooterViewModel(l),d=0===t?o:s,c=null==(a=null==(r=null==(i=n.getBody())?void 0:i.tables)?void 0:r.find(e=>d>=e.startIndex&&d<=e.endIndex))?void 0:a.tableId,u=[],g=null,h=-1;for(let e of A.children){for(let t of e.children){let{children:e}=t,n=e[0];if(n){if(d<n.startIndex||d>n.endIndex)continue;for(let e of(g=n,n.children)){for(let t of e.children){let n=e.children.indexOf(t);if(d>=t.startIndex&&d<=t.endIndex){h=n;break}}if(-1!==h)break}}if(g)break}if(g)break}if(null==g||null==c||-1===h)return null;let p=0;for(let e of g.children){let n=e.children[h],i=0===t?n.startIndex:n.endIndex+1;u.push(i-p),p=i}return{offsets:u,tableId:c,columnIndex:h,rowCount:g.children.length}}function eC(e,t,n){let i=[],r=t[n].size.width.v,a=0;for(let e=0;e<t.length;e++)a+=t[e].size.width.v;a+=r;for(let n=0;n<t.length;n++)i.push(t[n].size.width.v/a*e);return{widths:i,newColWidth:r=r/a*e}}function ey(e,t){var n,i,r;let{startOffset:a,endOffset:o,segmentId:s}=e,l=t.getSelfOrHeaderFooterViewModel(s),A=null==(r=null==(i=null==(n=t.getBody())?void 0:n.tables)?void 0:i.find(e=>a>=e.startIndex&&o<=e.endIndex))?void 0:r.tableId,d=[],c=-1,u=0,g=-1,h=!1;for(let e of l.children){for(let t of e.children){let{children:e}=t,n=e[0];if(n){if(a<n.startIndex||o>n.endIndex)continue;for(let e of(g=n.startIndex+3,n.children)){let t=n.children.indexOf(e),{startIndex:i,endIndex:r}=e;a>=i&&a<=r?(c=i,d.push(t),u+=r-i+1):(i>a&&r<o||o>=i&&o<=r)&&(d.push(t),u+=r-i+1),d.length===n.children.length&&(h=!0)}}if(d.length)break}if(d.length)break}return null==A||0===d.length?null:{tableId:A,rowIndexes:d,offset:c,len:u,cursor:g,selectWholeTable:h}}function eb(e,t){var n,i,r;let{startOffset:a,endOffset:o,segmentId:s}=e,l=t.getSelfOrHeaderFooterViewModel(s),A=null==(r=null==(i=null==(n=t.getBody())?void 0:n.tables)?void 0:i.find(e=>a>=e.startIndex&&o<=e.endIndex))?void 0:r.tableId,d=[],c=null,u=[],g=-1,h=-1;for(let e of l.children){for(let t of e.children){let{children:e}=t,n=e[0];if(n){if(a<n.startIndex||o>n.endIndex)continue;for(let e of(c=n,n.children))for(let t of e.children){let n=e.children.indexOf(t);a>=t.startIndex&&a<=t.endIndex&&(g=n),o>=t.startIndex&&o<=t.endIndex&&(h=n)}}if(c)break}if(c)break}if(null==c||null==A)return null;for(let e=g;e<=h;e++)u.push(e);let p=0;for(let e of c.children){let t=e.children[g],n=e.children[h];d.push({retain:t.startIndex-p,delete:n.endIndex-t.startIndex+1}),p=n.endIndex+1}return{offsets:d,tableId:A,columnIndexes:u,cursor:c.startIndex+3,selectWholeTable:u.length===c.children[0].children.length,rowCount:c.children.length}}function ex(e,t){var n,i,r;let{startOffset:a,endOffset:o,segmentId:s}=e,l=t.getSelfOrHeaderFooterViewModel(s),A=null==(r=null==(i=null==(n=t.getBody())?void 0:n.tables)?void 0:i.find(e=>a>=e.startIndex&&o<=e.endIndex))?void 0:r.tableId,d=-1,c=0,u=-1;for(let e of l.children){for(let t of e.children){let{children:e}=t,n=e[0];if(n){if(a<n.startIndex||o>n.endIndex)continue;d=n.startIndex,c=n.endIndex-n.startIndex+1,u=n.startIndex}if(n)break}if(c>0)break}return null==A?null:{tableId:A,offset:d,len:c,cursor:u}}function eR(e,t){var n,i,r;let{startOffset:a,endOffset:o,segmentId:s}=e,l=t.getSelfOrHeaderFooterViewModel(s),A=null==(r=null==(i=null==(n=t.getBody())?void 0:n.tables)?void 0:i.find(e=>a>=e.startIndex&&o<=e.endIndex))?void 0:r.tableId,d=[],c=null,u=-1,g=-1,h=-1;for(let e of l.children){for(let t of e.children){let{children:e}=t,n=e[0];if(n){if(a<n.startIndex||o>n.endIndex)continue;for(let e of(c=n,n.children)){let t=n.children.indexOf(e);for(let n of e.children){let i=e.children.indexOf(n);a>=n.startIndex&&a<=n.endIndex&&(u=t,g=i),o>=n.startIndex&&o<=n.endIndex&&(h=i)}}}if(c)break}if(c)break}if(null==c||null==A||-1===u)return null;let p=c.children[u];for(let e=g;e<=h;e++){let t=p.children[e];d.push({retain:t.startIndex+1,delete:t.endIndex-t.startIndex-3})}return{offsets:d,tableId:A,cursor:c.startIndex+3,rowCount:c.children.length}}_(eg,"genEmptyTable"),_(eh,"getEmptyTableCell"),_(ep,"getEmptyTableRow"),_(em,"getTableColumn"),_(ef,"genTableSource"),_(eI,"getRangeInfoFromRanges"),_(eS,"getInsertRowBody"),_(eE,"getInsertColumnBody"),_(ev,"getInsertRowActionsParams"),_(eT,"getInsertColumnActionsParams"),_(eC,"getColumnWidths"),_(ey,"getDeleteRowsActionsParams"),_(eb,"getDeleteColumnsActionParams"),_(ex,"getDeleteTableActionParams"),_(eR,"getDeleteRowContentActionParams");var eO=((A=eO||{})[A.NEXT=0]="NEXT",A[A.PREV=1]="PREV",A);function eB(e,t,n){let{startOffset:i}=t,r=null;for(let t of e.children){for(let e of t.children){let t=e.children[0];if(t&&i>t.startIndex&&i<t.endIndex){r=t;break}}if(r)break}if(null==r)return null;let a=-1,o=-1,s=null;for(let e of r.children){for(let t of e.children)if(i>t.startIndex&&i<t.endIndex){a=e.children.indexOf(t),o=r.children.indexOf(e),s=e;break}if(a>-1)break}if(-1===a||-1===o||null==s)return null;let l=null;if(0===n){if(!(l=s.children[a+1])){let e=r.children[o+1];e&&(l=e.children[0])}}else if(!(l=s.children[a-1])){let e=r.children[o-1];e&&(l=e.children[e.children.length-1])}if(l){let{startIndex:e,endIndex:t}=l;return{startOffset:e+1,endOffset:t-2}}}function eM(e,t){let n=[],{customBlocks:i=[]}=e;for(let e of t){let{startOffset:t,endOffset:r}=e;if(!(null==t||null==r))for(let e of i){let{startIndex:i}=e;i>=t&&i<r&&n.push(e.blockId)}}return n}function eD(e){return e.some(e=>{let{startNodePosition:t}=e;return!!t&&(null==t?void 0:t.path.indexOf("cells"))>-1})}_(eB,"getCellOffsets"),_(eM,"getCustomBlockIdsInSelections"),_(eD,"hasRangeInTable");let eN={id:"doc.command.inner-paste",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>{var n,i,r,a;let{segmentId:o,textRanges:s,doc:l}=t,A=e.get(g.ICommandService),d=e.get(h.DocSelectionManagerService),c=e.get(g.IUniverInstanceService),u=d.getCurrentTextRanges(),{body:p,tableSource:m,drawings:f}=l;if(!Array.isArray(u)||0===u.length||null==p)return!1;let I=c.getCurrentUniverDocInstance(),S=null==I?void 0:I.getSelfOrHeaderFooterModel(o).getBody();if(null==I||null==S)return!1;let E=I.getUnitId(),v={id:h.RichTextEditingMutation.id,params:{unitId:E,actions:[],textRanges:s,segmentId:o}},T=new g.MemoryCursor;T.reset();let C=new g.TextX,y=(0,g.JSONX).getInstance(),b=[],x=!!(null!=(n=p.tables)&&n.length),R=!!(null!=(i=p.customBlocks)&&i.length);if(x&&o||x&&eD(u))return!1;for(let e of u){let{startOffset:t,endOffset:n,collapsed:i}=e,s=t-T.cursor,l=(0,g.Tools).deepClone(p);if(x)for(let e of l.tables){let{tableId:t}=e,n=(0,g.Tools).generateRandomId(6);e.tableId=n;let i=(0,g.Tools).deepClone(m[t]);i.tableId=n;let r=y.insertOp(["tableSource",n],i);b.push(r)}if(R&&f){let e=null!=(a=null==(r=I.getSnapshot().drawingsOrder)?void 0:r.length)?a:0;for(let t of l.customBlocks){let{blockId:n}=t,i=(0,g.Tools).generateRandomId(6);t.blockId=i;let r=(0,g.Tools).deepClone(f[n]);r.drawingId=i;let a=y.insertOp(["drawings",i],r),o=y.insertOp(["drawingsOrder",e],i);b.push(a),b.push(o)}}if(i)C.push({t:g.TextXActionType.RETAIN,len:s,segmentId:o});else{let{dos:t}=(0,g.BuildTextUtils).selection.getDeleteActions(e,o,T.cursor,S);C.push(...t)}C.push({t:g.TextXActionType.INSERT,body:l,len:p.dataStream.length,line:0,segmentId:o}),T.reset(),T.moveCursor(n)}let O=J(I,o);return b.push(y.editOp(C.serialize(),O)),v.params.actions=b.reduce((e,t)=>(0,g.JSONX).compose(e,t),null),!!A.syncExecuteCommand(v.id,v.params)},"handler")};function eP(e,t,n){var i,r;let a=t.getSelfOrHeaderFooterModel(n).getBody(),o=new g.TextX,s=(0,g.JSONX).getInstance(),l=[];if(null==a)return l;let A=new g.MemoryCursor;for(let t of(A.reset(),e)){let{startOffset:e,endOffset:i,collapsed:r}=t;if(null==e||null==i)continue;let s=e-A.cursor;r?o.push({t:g.TextXActionType.RETAIN,len:s,segmentId:n}):o.push(...(0,g.BuildTextUtils).selection.getDeleteExculdeLastLineBreakActions(t,a,n,A.cursor,!1)),A.reset(),A.moveCursor(i)}let d=J(t,n);l.push(s.editOp(o.serialize(),d));let c=eM(a,e),u=null!=(i=t.getDrawings())?i:{},h=null!=(r=t.getDrawingsOrder())?r:[],p=c.sort((e,t)=>h.indexOf(e)>h.indexOf(t)?-1:h.indexOf(e)<h.indexOf(t)?1:0);if(p.length>0)for(let e of p){let t=u[e],n=h.indexOf(e);if(null==t||n<0)continue;let i=s.removeOp(["drawings",e],t),r=s.removeOp(["drawingsOrder",n],e);l.push(i),l.push(r)}return l.reduce((e,t)=>(0,g.JSONX).compose(e,t),null)}function eQ(e,t,n,i){let r=[];if(null==t.getSelfOrHeaderFooterModel(i).getBody())return r;let a=new g.TextX,o=(0,g.JSONX).getInstance(),s=new g.MemoryCursor;for(let t of(s.reset(),e)){let{startOffset:e,endOffset:l,spanEntireRow:A,spanEntireTable:d}=t;if(!(null==e||null==l)){if(d){let t=ex({startOffset:e,endOffset:l,segmentId:i},n);if(null==t)continue;let{offset:A,len:d,tableId:c}=t;A-s.cursor>0&&a.push({t:g.TextXActionType.RETAIN,len:A-s.cursor,segmentId:i}),a.push({t:g.TextXActionType.DELETE,len:d,line:0,segmentId:i});let u=o.removeOp(["tableSource",c]);r.push(u),s.moveCursorTo(A+d)}else if(A){let t=ey({startOffset:e,endOffset:l,segmentId:i},n);if(null==t)continue;let{offset:A,rowIndexes:d,len:c,tableId:u}=t;for(let e of(A-s.cursor>0&&a.push({t:g.TextXActionType.RETAIN,len:A-s.cursor,segmentId:i}),a.push({t:g.TextXActionType.DELETE,len:c,line:0,segmentId:i}),d.reverse())){let t=o.removeOp(["tableSource",u,"tableRows",e]);r.push(t)}s.moveCursorTo(A+c)}else{let t=eR({startOffset:e,endOffset:l,segmentId:i},n);if(null==t)continue;let{offsets:r}=t;for(let e of r){let{retain:t,delete:n}=e;t-s.cursor>0&&a.push({t:g.TextXActionType.RETAIN,len:t-s.cursor,segmentId:i}),a.push({t:g.TextXActionType.DELETE,len:n,line:0,segmentId:i}),s.moveCursorTo(t+n)}}}}let l=J(t,i);return r.push(o.editOp(a.serialize(),l)),r.reduce((e,t)=>(0,g.JSONX).compose(e,t),null)}function eU(e,t,n,i,r){let a=[];if(Array.isArray(e)&&(null==e?void 0:e.length)!==0&&(a=eP(e,n,r)),Array.isArray(t)&&(null==t?void 0:t.length)!==0){let e=eQ(t,n,i,r);a=null==a||0===a.length?e:(0,g.JSONX).compose(a,(0,g.JSONX).transform(e,a,"right"))}return a}_(eP,"getCutActionsFromTextRanges"),_(eQ,"getCutActionsFromRectRanges"),_(eU,"getCutActionsFromDocRanges");let e_={id:"doc.command.inner-cut",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>{var n,i;let{segmentId:r,textRanges:a}=t,o=e.get(g.ICommandService),s=e.get(h.DocSelectionManagerService),l=e.get(g.IUniverInstanceService),A=null!=(n=t.selections)?n:s.getCurrentTextRanges(),d=s.getCurrentRectRanges();if((!Array.isArray(A)||0===A.length)&&(!Array.isArray(d)||0===d.length))return!1;let c=null==(i=l.getCurrentUniverDocInstance())?void 0:i.getUnitId();if(!c)return!1;let u=l.getUniverDocInstance(c);if(null==u)return!1;let p=X(e,c);if(null==p)return!1;let m=p.getViewModel(),f={id:h.RichTextEditingMutation.id,params:{unitId:c,actions:[],textRanges:a}};return f.params.actions=eU(A,d,u,m,r),!!o.syncExecuteCommand(f.id,f.params)},"handler")},ew=g.BuildTextUtils.selection.getDeleteSelection,eL={id:"doc.command.delete-custom-block",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>{var n;let i=e.get(h.DocSelectionManagerService),r=e.get(g.IUniverInstanceService),a=e.get(g.ICommandService),o=i.getActiveTextRange(),s=r.getCurrentUniverDocInstance();if(null==o||null==s)return!1;let{direction:l,range:A,unitId:d,drawingId:c}=t,{startOffset:u,segmentId:p,style:m}=o,f=l===ea.LEFT?u-1:u,I={id:h.RichTextEditingMutation.id,params:{unitId:d,actions:[],textRanges:[{startOffset:f,endOffset:f,style:m}],prevTextRanges:[A]}},S=new g.TextX,E=(0,g.JSONX).getInstance(),v=[];u>0&&S.push({t:g.TextXActionType.RETAIN,len:l===ea.LEFT?u-1:u,segmentId:p}),S.push({t:g.TextXActionType.DELETE,len:1,line:0,segmentId:p});let T=J(s,p);v.push(E.editOp(S.serialize(),T));let C=(null!=(n=s.getDrawings())?n:{})[c],y=s.getDrawingsOrder().indexOf(c),b=E.removeOp(["drawings",c],C),x=E.removeOp(["drawingsOrder",y],c);return v.push(b),v.push(x),I.params.actions=v.reduce((e,t)=>(0,g.JSONX).compose(e,t),null),!!a.syncExecuteCommand(I.id,I.params)},"handler")},eF={id:"doc.command.merge-two-paragraph",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>{let n=e.get(h.DocSelectionManagerService),i=e.get(g.IUniverInstanceService),r=e.get(g.ICommandService),{direction:a,range:o}=t,s=n.getActiveTextRange(),l=n.getCurrentTextRanges();if(null==s||null==l)return!1;let{segmentId:A,style:d}=s,c=i.getCurrentUniverDocInstance(),u=null==c?void 0:c.getSelfOrHeaderFooterModel(A).getBody();if(!c||!u)return!1;let p=ew(s,u),m=c.getUnitId(),{startOffset:f,collapsed:I}=p;if(!I)return!1;let S=a===ea.LEFT?f:f+1,E=u.paragraphs.find(e=>e.startIndex>=S).startIndex,v=ej(e,m,u,S,E),T=a===ea.LEFT?f-1:f,C={id:h.RichTextEditingMutation.id,params:{unitId:m,actions:[],textRanges:[{startOffset:T,endOffset:T,style:d}],prevTextRanges:[o]}},y=new g.TextX,b=(0,g.JSONX).getInstance();y.push({t:g.TextXActionType.RETAIN,len:a===ea.LEFT?f-1:f,segmentId:A}),v.dataStream.length&&y.push({t:g.TextXActionType.INSERT,body:v,len:v.dataStream.length,line:0,segmentId:A}),y.push({t:g.TextXActionType.RETAIN,len:1,segmentId:A}),y.push({t:g.TextXActionType.DELETE,len:E+1-S,line:0,segmentId:A});let x=J(c,A);return C.params.actions=b.editOp(y.serialize(),x),!!r.syncExecuteCommand(C.id,C.params)},"handler")};function ek(e,t){let n=0;if(null==e||0===e.length){if("number"==typeof t[0].startOffset){let e=t[0],{spanEntireRow:i,spanEntireTable:r}=e;n=r?e.startOffset-3:i?e.startRow>0?e.startOffset-6:e.startOffset:t[0].startOffset}}else if(e.length>0&&t.length>0){let i=e[0],r=t[0];if(null!=i.startOffset&&null!=r.startOffset){if(i.startOffset<r.startOffset)n=i.startOffset;else if(i.startOffset>=r.startOffset){let{spanEntireRow:e,spanEntireTable:t}=r;t?n=r.startOffset-3:e&&(n=r.startOffset-6)}}}return n}_(ek,"getCursorWhenDelete");let eH={id:"doc.command.delete-left",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async e=>{var t,n;let i=e.get(h.DocSelectionManagerService),r=e.get(g.IUniverInstanceService),a=e.get(g.ICommandService),o=!0,s=r.getCurrentUniverDocInstance();if(!s)return!1;let l=X(e,s.getUnitId()),A=i.getActiveTextRange(),d=i.getCurrentRectRanges(),c=i.getCurrentTextRanges(),u=null==l?void 0:l.getSkeleton();if(null==u)return!1;if(null!=d&&d.length){let e=ek(c,d),t=d[0].segmentId;return a.executeCommand(e_.id,{segmentId:t,textRanges:[{startOffset:e,endOffset:e}]})}if(null==A||null==c)return!1;let{segmentId:m,style:f,segmentPage:I}=A,S=s.getSelfOrHeaderFooterModel(m).getBody();if(null==S)return!1;let E=ew(A,S),{startOffset:v,collapsed:T}=E,C=u.findNodeByCharIndex(v,m,I),y=(0,p.hasListGlyph)(C),b=(0,p.isIndentByGlyph)(C,S),x=v,R=u.findNodeByCharIndex(v-1,m,I);if((0,p.isFirstGlyph)(C)&&R!==C&&(!0===y||!0===b)&&T){let e=(0,p.getParagraphByGlyph)(C,S);if(null==e)return!1;let t=null==e?void 0:e.startIndex,n={startIndex:0},i=e.paragraphStyle;if(!0===y){let t=e.paragraphStyle;if(t){n.paragraphStyle=t;let{hanging:e}=t;e&&(n.paragraphStyle.indentStart=e,n.paragraphStyle.hanging=void 0)}}else if(!0===b){let t=e.bullet;t&&(n.bullet=t),null!=i&&(n.paragraphStyle={...i},delete n.paragraphStyle.hanging,delete n.paragraphStyle.indentStart)}let r=[{startOffset:x,endOffset:x,style:f}];o=await a.executeCommand(el.id,{unitId:s.getUnitId(),updateBody:{dataStream:"",paragraphs:[{...n}]},range:{startOffset:t,endOffset:t+1},textRanges:r,coverType:g.UpdateDocsAttributeType.REPLACE,segmentId:m})}else if(!0===T){if(null==R)return!0;if("\r"===R.content)o=await a.executeCommand(eF.id,{direction:ea.LEFT,range:E});else if("\b"===R.streamType){let e=null==(n=s.getSnapshot().drawings)?void 0:n[null!=(t=R.drawingId)?t:""];if(null==e)return!0;if(e.layoutType===g.PositionedObjectLayoutType.INLINE){let e=s.getUnitId();o=await a.executeCommand(eL.id,{direction:ea.LEFT,range:A,unitId:e,drawingId:R.drawingId})}else{let e=u.findNodeByCharIndex(v-2);if(null==e)return!0;x-=R.count;let t=[{startOffset:x-=e.count,endOffset:x,style:f}];o=await a.executeCommand(es.id,{unitId:s.getUnitId(),range:{...A,startOffset:A.startOffset-1,endOffset:A.endOffset-1},segmentId:m,direction:ea.LEFT,len:e.count,textRanges:t})}}else x-=R.count,o=await a.executeCommand(es.id,{unitId:s.getUnitId(),range:E,segmentId:m,direction:ea.LEFT,len:R.count})}else{let e=eW(E,[E]);o=await a.executeCommand(e_.id,{segmentId:m,textRanges:e,selections:[E]})}return o},"handler")},eV={id:"doc.command.delete-right",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async e=>{var t,n;let i=e.get(h.DocSelectionManagerService),r=e.get(g.IUniverInstanceService).getCurrentUniverDocInstance();if(!r)return!1;let a=X(e,r.getUnitId()),o=e.get(g.ICommandService),s=i.getActiveTextRange(),l=i.getCurrentRectRanges(),A=i.getCurrentTextRanges(),d=null==a?void 0:a.getSkeleton();if(null!=l&&l.length){let e=ek(A,l),t=l[0].segmentId;return o.executeCommand(e_.id,{segmentId:t,textRanges:[{startOffset:e,endOffset:e}]})}if(null==s||null==d||null==A)return!1;let{segmentId:c,style:u,segmentPage:p}=s,m=null==r?void 0:r.getSelfOrHeaderFooterModel(c).getBody();if(!r||!m)return!1;let f=ew(s,m,ea.RIGHT),{startOffset:I,endOffset:S,collapsed:E}=f;if(I===m.dataStream.length-2&&E)return!0;let v=!1;if(!0===E){let e=d.findNodeByCharIndex(I,c,p),i=d.findNodeByCharIndex(I+1);if(e.streamType===g.DataStreamTreeTokenType.PARAGRAPH&&(null==i?void 0:i.streamType)===g.DataStreamTreeTokenType.SECTION_BREAK)return!1;if("\r"===e.content)v=await o.executeCommand(eF.id,{direction:ea.RIGHT,range:s});else if("\b"===e.streamType){let a=null==(n=r.getSnapshot().drawings)?void 0:n[null!=(t=e.drawingId)?t:""];if(null==a)return!0;if(a.layoutType===g.PositionedObjectLayoutType.INLINE){let t=r.getUnitId();v=await o.executeCommand(eL.id,{direction:ea.RIGHT,range:s,unitId:t,drawingId:e.drawingId})}else{if(null==i)return!0;v=await o.executeCommand(es.id,{unitId:r.getUnitId(),range:{...s,startOffset:I+1,endOffset:S+1},segmentId:c,direction:ea.RIGHT,textRanges:[{startOffset:I+1,endOffset:I+1,style:u}],len:i.count})}}else v=await o.executeCommand(es.id,{unitId:r.getUnitId(),range:f,segmentId:c,direction:ea.RIGHT,textRanges:[{startOffset:I,endOffset:I,style:u}],len:e.count})}else{let e=eW(f,[f]);v=await o.executeCommand(e_.id,{segmentId:c,textRanges:e,selections:[f]})}return v},"handler")};function ej(e,t,n,i,r){let{textRuns:a=[],customBlocks:o=[]}=n,s={dataStream:n.dataStream.substring(i,r),customRanges:(0,g.getCustomRangeSlice)(n,i,r).customRanges.map(e=>({...(0,g.Tools).deepClone(e),rangeId:(0,g.generateRandomId)()})),customDecorations:(0,g.getCustomDecorationSlice)(n,i,r)},l=[];for(let e of a){let{st:t,ed:n}=e;n<=i||t>=r||(t<i?l.push({...e,st:0,ed:n-i}):n>r?l.push({...e,st:t-i,ed:r-i}):l.push({...e,st:t-i,ed:n-i}))}l.length>0&&(s.textRuns=l);let A=[];for(let e of o){let{startIndex:t}=e;t>=i&&t<=r&&A.push({...e,startIndex:t-i})}return A.length>0&&(s.customBlocks=A),s}function eW(e,t){let n=e.endOffset;for(let i of t){let{startOffset:t,endOffset:r}=i;null==t||null==r||r<=e.endOffset&&(n-=r-t)}return[{startOffset:n,endOffset:n,style:e.style}]}function ez(){return(0,g.Tools).generateRandomId(6)}function eG(e){let t=e.match(/data-copy-id="([^\s]+)"/);return t&&t[1]?t[1]:null}_(ej,"getParagraphBody"),_(eW,"getTextRangesWhenDelete"),_(ez,"genId"),_(eG,"extractId");let eY=class{constructor(){w(this,"_cache",new g.LRUMap(10))}set(e,t){this._cache.set(e,t)}get(e){return this._cache.get(e)}clear(){this._cache.clear()}};_(eY,"CopyContentCache");let eK=new eY;function eq(e){let t=e.style,n={},i=e.tagName.toLowerCase();switch(i){case"b":case"em":case"strong":n.bl=g.BooleanNumber.TRUE;break;case"s":n.st={s:g.BooleanNumber.TRUE};break;case"u":n.ul={s:g.BooleanNumber.TRUE};break;case"i":n.it=g.BooleanNumber.TRUE;break;case"sub":case"sup":n.va="sup"===i?g.BaselineOffset.SUPERSCRIPT:g.BaselineOffset.SUBSCRIPT}for(let e=0;e<t.length;e++){let i=t[e],r=t.getPropertyValue(i);switch(i){case"font-family":n.ff=r.replace(/^"/g,"").replace(/"$/g,"");break;case"font-size":{let e=Number.parseInt(r);Number.isNaN(e)||(r.endsWith("pt")?n.fs=e:r.endsWith("px")&&(n.fs=(0,p.pixelToPt)(e)));break}case"font-style":"italic"===r&&(n.it=g.BooleanNumber.TRUE);break;case"font-weight":(Number(r)>400||"bold"===String(r))&&(n.bl=g.BooleanNumber.TRUE);break;case"text-decoration":/underline/.test(r)?n.ul={s:g.BooleanNumber.TRUE}:/overline/.test(r)?n.ol={s:g.BooleanNumber.TRUE}:/line-through/.test(r)&&(n.st={s:g.BooleanNumber.TRUE});break;case"color":try{let e=new g.ColorKit(r);e.isValid&&(n.cl={rgb:e.toRgbString()})}catch{}break;case"background-color":{let e=new g.ColorKit(r);e.isValid&&(n.bg={rgb:e.toRgbString()})}}}return n}function eX(e){let t=new DOMParser,n=`<x-univer id="univer-root">${e}</x-univer>`;return t.parseFromString(n,"text/html").querySelector("#univer-root")}function eJ(e,t){let n=e.tagName.toLowerCase();return"string"==typeof t?n===t:Array.isArray(t)?t.some(e=>e===n):t(e)}_(eq,"extractNodeStyle"),_(eX,"parseToDom"),_(eJ,"matchFilter");let eZ=class e{constructor(){w(this,"_tableCache",[]),w(this,"_styleCache",/* @__PURE__ */new Map),w(this,"_styleRules",[]),w(this,"_afterProcessRules",[])}static use(e){if(this._pluginList.includes(e))throw Error(`Univer paste plugin ${e.name} already added`);this._pluginList.push(e)}convert(t){let n=e._pluginList.find(e=>e.checkPasteType(t)),i=eX(t),r={body:{dataStream:"",paragraphs:[],sectionBreaks:[],tables:[],textRuns:[]},tableSource:{}};return n&&(this._styleRules=[...n.stylesRules],this._afterProcessRules=[...n.afterProcessRules]),this._tableCache=[],this._styleCache.clear(),this._process(null,i.childNodes,r),this._styleCache.clear(),this._styleRules=[],this._afterProcessRules=[],r}_process(e,t,n){var i,r;let a=n.body;for(let o of t)if(o.nodeType===Node.TEXT_NODE){let t;if((null==(i=o.nodeValue)?void 0:i.trim())==="")continue;let n=null==(r=o.nodeValue)?void 0:r.replace(/[\r\n]/g,"");e&&this._styleCache.has(e)&&(t=this._styleCache.get(e)),a.dataStream+=n,t&&Object.getOwnPropertyNames(t).length&&a.textRuns.push({st:a.dataStream.length-n.length,ed:a.dataStream.length,ts:t})}else{if((0,g.skipParseTagNames).includes(o.nodeName.toLowerCase()))continue;if(o.nodeType===Node.ELEMENT_NODE){let t=this._processBeforeLink(o,n),i=e?this._styleCache.get(e):{},r=this._styleRules.find(({filter:e})=>eJ(o,e)),a=r?r.getStyle(o):eq(o);this._styleCache.set(o,{...i,...a});let{childNodes:s}=o;this._processBeforeTable(o,n),this._process(o,s,n),this._processAfterTable(o,n);let l=this._afterProcessRules.find(({filter:e})=>eJ(o,e));l&&l.handler(n,o),this._processAfterLink(o,n,t)}}}_processBeforeTable(e,t){var n;let i=e.tagName.toUpperCase(),r=t.body;switch(i){case"TABLE":{"\r"!==r.dataStream[r.dataStream.length-1]&&(r.dataStream+="\r",null==r.paragraphs&&(r.paragraphs=[]),null==(n=r.paragraphs)||n.push({startIndex:r.dataStream.length-1}));let e=ef(0,0,600);this._tableCache.push({table:e,startIndex:r.dataStream.length}),r.dataStream+=g.DataStreamTreeTokenType.TABLE_START;break}case"TR":{let e=ep(0);this._tableCache[this._tableCache.length-1].table.tableRows.push(e),r.dataStream+=g.DataStreamTreeTokenType.TABLE_ROW_START;break}case"TD":{let e=eh(),t=this._tableCache[this._tableCache.length-1].table;t.tableRows[t.tableRows.length-1].tableCells.push(e),r.dataStream+=g.DataStreamTreeTokenType.TABLE_CELL_START}}}_processAfterTable(e,t){var n,i;let r=e.tagName.toUpperCase(),a=t.body;null==t.tableSource&&(t.tableSource={}),null==a.tables&&(a.tables=[]),null==a.sectionBreaks&&(a.sectionBreaks=[]);let{tableSource:o}=t;switch(r){case"TABLE":{let{startIndex:e,table:t}=this._tableCache.pop(),n=t.tableRows[0].tableCells.length,i=em(600/n),r=[...Array(n).fill(null).map(()=>(0,g.Tools).deepClone(i))];t.tableColumns=r,o[t.tableId]=t,a.dataStream+=g.DataStreamTreeTokenType.TABLE_END,a.tables.push({startIndex:e,endIndex:a.dataStream.length-1,tableId:t.tableId});break}case"TR":a.dataStream+=g.DataStreamTreeTokenType.TABLE_ROW_END;break;case"TD":"\r"!==a.dataStream[a.dataStream.length-1]&&(null==(n=a.paragraphs)||n.push({startIndex:a.dataStream.length}),a.dataStream+="\r"),null==(i=a.sectionBreaks)||i.push({startIndex:a.dataStream.length}),a.dataStream+=`
${g.DataStreamTreeTokenType.TABLE_CELL_END}`}}_processBeforeLink(e,t){let n=t.body,i=n.dataStream.length;return"A"===e.tagName.toUpperCase()&&(n.dataStream+=g.DataStreamTreeTokenType.CUSTOM_RANGE_START),i}_processAfterLink(e,t,n){var i,r;let a=t.body;"A"===e.tagName.toUpperCase()&&(a.dataStream+=g.DataStreamTreeTokenType.CUSTOM_RANGE_END,a.customRanges=null!=(i=a.customRanges)?i:[],a.customRanges.push({startIndex:n,endIndex:a.dataStream.length-1,rangeId:null!=(r=e.dataset.rangeid)?r:(0,g.generateRandomId)(),rangeType:g.CustomRangeType.HYPERLINK,properties:{url:e.href}}))}};function e$(e){let t=e.style,n={};for(let e=0;e<t.length;e++){let i=t[e],r=t.getPropertyValue(i);switch(i){case"margin-top":{let e=Number.parseInt(r);n.spaceAbove={v:/pt/.test(r)?(0,p.ptToPixel)(e):e};break}case"margin-bottom":{let e=Number.parseInt(r);n.spaceBelow={v:/pt/.test(r)?(0,p.ptToPixel)(e):e};break}case"line-height":{let e=Number.parseFloat(r);r.endsWith("%")&&(e/=100),n.lineSpacing=e}}}return Object.getOwnPropertyNames(n).length?n:null}function e0(e,t){let{st:n,ed:i,ts:r={}}=t,{ff:a,fs:o,it:s,bl:l,ul:A,st:d,ol:c,bg:u,cl:h,va:p}=r,m=e.slice(n,i),f=[];return s===g.BooleanNumber.TRUE&&(m=`<i>${m}</i>`),p===g.BaselineOffset.SUPERSCRIPT?m=`<sup>${m}</sup>`:p===g.BaselineOffset.SUBSCRIPT&&(m=`<sub>${m}</sub>`),(null==A?void 0:A.s)===g.BooleanNumber.TRUE&&(m=`<u>${m}</u>`),(null==d?void 0:d.s)===g.BooleanNumber.TRUE&&(m=`<s>${m}</s>`),l===g.BooleanNumber.TRUE&&(m=`<strong>${m}</strong>`),a&&f.push(`font-family: ${a}`),h&&f.push(`color: ${h.rgb}`),o&&f.push(`font-size: ${o}pt`),c&&f.push("text-decoration: overline"),u&&f.push(`background: ${u.rgb}`),f.length?`<span style="${f.join("; ")};">${m}</span>`:m}function e1(e,t,n){let{dataStream:i,textRuns:r=[]}=e,a=t,o=[];for(let e of r){let{st:r,ed:s}=e;(0,g.Tools).hasIntersectionBetweenTwoRanges(t,n,r,s)&&(r>a?(o.push(i.slice(a,r)),o.push(e0(i,{...e,ed:Math.min(s,n)}))):o.push(e0(i,{...e,st:a,ed:Math.min(s,n)}))),a=Math.max(t,Math.min(s,n))}return a!==n&&o.push(i.slice(a,n)),o.join("")}function e9(e,t,n){let{customRanges:i=[]}=e,r=i.filter(e=>e.startIndex>=t&&e.endIndex<=n),a=t,o="";r.forEach(t=>{var n,i;let{startIndex:r,endIndex:s,rangeType:l,rangeId:A}=t,d=e1(e,a,r);o+=d;let c=e1(e,r+1,s);l===g.CustomRangeType.HYPERLINK?o+=`<a data-rangeid="${A}" href="${null!=(i=null==(n=t.properties)?void 0:n.url)?i:""}">${c}</a>`:o+=c,a=s+1});let s=e1(e,a,n);return o+=s}function e3(e){let{paragraphs:t=[],sectionBreaks:n=[]}=e,{dataStream:i}=e;i.endsWith(`\r
`)||(i+=`\r
`,t.push({startIndex:i.length-2}),n.push({startIndex:i.length-1}),e.dataStream=i,e.paragraphs=t,e.sectionBreaks=n);let r={html:""};for(let t of(0,p.parseDataStreamToTree)(i))e2(t,e,r);return r.html}function e2(e,t,n){var i;switch(e.nodeType){case g.DataStreamTreeNodeType.SECTION_BREAK:for(let i of e.children)e2(i,t,n);break;case g.DataStreamTreeNodeType.PARAGRAPH:{let{children:r,startIndex:a,endIndex:o}=e,{paragraphStyle:s={}}=null!=(i=t.paragraphs.find(e=>e.startIndex===o))?i:{},{spaceAbove:l,spaceBelow:A,lineSpacing:d}=s,c=[];if(null!=l&&("number"==typeof l?c.push(`margin-top: ${l}px`):c.push(`margin-top: ${l.v}px`)),null!=A&&("number"==typeof A?c.push(`margin-bottom: ${A}px`):c.push(`margin-bottom: ${A.v}px`)),null!=d&&c.push(`line-height: ${d}`),n.html+=`<p class="UniverNormal" ${c.length?`style="${c.join("; ")};"`:""}>`,r.length)for(let e of r)e2(e,t,n);n.html+=`${e9(t,a,o)}</p>`;break}case g.DataStreamTreeNodeType.TABLE:{let{children:i}=e;for(let e of(n.html+='<table class="UniverTable" style="width: 100%; border-collapse: collapse;"><tbody>',i))e2(e,t,n);n.html+="</tbody></table>";break}case g.DataStreamTreeNodeType.TABLE_ROW:{let{children:i}=e;for(let e of(n.html+='<tr class="UniverTableRow">',i))e2(e,t,n);n.html+="</tr>";break}case g.DataStreamTreeNodeType.TABLE_CELL:{let{children:i}=e;for(let e of(n.html+='<td class="UniverTableCell">',i))e2(e,t,n);n.html+="</td>";break}default:throw Error(`Unknown node type: ${e.nodeType}`)}}_(eZ,"HtmlToUDMService"),w(eZ,"_pluginList",[]),_(e$,"getParagraphStyle"),_(e0,"covertTextRunToHtml"),_(e1,"getBodyInlineSlice"),_(e9,"getBodySliceHtml"),_(e3,"convertBodyToHtml"),_(e2,"processNode");let e4=class{convert(e){if(0===e.length)throw Error("The bodyList length at least to be 1");let t="";for(let n of(0,g.Tools).deepClone(e))t+=e3(n);return t}};_(e4,"UDMToHtmlService");var e8=Object.defineProperty,e6=Object.getOwnPropertyDescriptor,e5=/* @__PURE__ */_((e,t,n,i)=>{for(var r,a=i>1?void 0:i?e6(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&e8(t,n,a),a},"__decorateClass$p"),e7=/* @__PURE__ */_((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$p");function te(e,t,n){var i,r,a;let o=(0,g.getBodySlice)(e,t,n+2),s=g.DataStreamTreeTokenType.TABLE_START+g.DataStreamTreeTokenType.TABLE_ROW_START+g.DataStreamTreeTokenType.TABLE_CELL_START+o.dataStream+g.DataStreamTreeTokenType.TABLE_CELL_END+g.DataStreamTreeTokenType.TABLE_ROW_END+g.DataStreamTreeTokenType.TABLE_END;return o.dataStream=s,null==(i=o.textRuns)||i.forEach(e=>{let{st:t,ed:n}=e;e.st=t+3,e.ed=n+3}),null==(r=o.tables)||r.forEach(e=>{let{startIndex:t,endIndex:n}=e;e.startIndex=t+3,e.endIndex=n+3}),null==(a=o.paragraphs)||a.forEach(e=>{let{startIndex:t}=e;e.startIndex=t+3}),o}eZ.use({name:"univer-doc-paste-plugin-word",checkPasteType:e=>/word|mso/i.test(e),stylesRules:[{filter:["b"],getStyle(e){let t=eq(e);return{bl:g.BooleanNumber.TRUE,...t}}}],afterProcessRules:[{filter:e=>"P"===e.tagName,handler(e,t){let n=e.body;null==n.paragraphs&&(n.paragraphs=[]);let i={startIndex:n.dataStream.length},r=e$(t);r&&(i.paragraphStyle=r),n.paragraphs.push(i),n.dataStream+="\r"}}]}),eZ.use({name:"univer-doc-paste-plugin-lark",checkPasteType:e=>/lark-record-clipboard/i.test(e),stylesRules:[{filter:["s"],getStyle(e){let t=eq(e);return{st:{s:g.BooleanNumber.TRUE},...t}}}],afterProcessRules:[{filter:e=>"DIV"===e.tagName&&/ace-line/i.test(e.className),handler(e){let t=e.body;null==t.paragraphs&&(t.paragraphs=[]),t.paragraphs.push({startIndex:t.dataStream.length}),t.dataStream+="\r"}}]}),eZ.use({name:"univer-doc-paste-plugin-univer",checkPasteType:e=>/UniverNormal/i.test(e),stylesRules:[],afterProcessRules:[{filter:e=>"P"===e.tagName&&/UniverNormal/i.test(e.className),handler(e,t){let n=e.body;null==n.paragraphs&&(n.paragraphs=[]);let i={startIndex:n.dataStream.length},r=e$(t);r&&(i.paragraphStyle=r),n.paragraphs.push(i),n.dataStream+="\r"}}]}),_(te,"getTableSlice");let tt=(0,g.createIdentifier)("doc.clipboard-service"),tn=(_(n7=class extends g.Disposable{constructor(e,t,n,i,r){super(),w(this,"_clipboardHooks",[]),w(this,"_htmlToUDM",new eZ),w(this,"_umdToHtml",new e4),this._univerInstanceService=e,this._logService=t,this._commandService=n,this._clipboardInterfaceService=i,this._docSelectionManagerService=r}async copy(e=g.SliceBodyType.copy){var t;let{bodyList:n=[],needCache:i=!1,snapshot:r}=null!=(t=this._getDocumentBodyInRanges(e))?t:{};if(0===n.length||null==r)return!1;try{let e=this._docSelectionManagerService.getActiveTextRange(),t=!!(null!=e&&e.segmentId);this._setClipboardData(n,r,!t&&i)}catch(e){return this._logService.error("[DocClipboardService] copy failed",e),!1}return!0}async cut(){return this._cut()}async paste(e){let t=await this._genDocDataFromClipboardItems(e);return this._paste(t)}async legacyPaste(e,t){var n;let i=this._genDocDataFromHtmlAndText(e,t);if((null==(n=this._univerInstanceService.getCurrentUnitForType(g.UniverInstanceType.UNIVER_DOC))?void 0:n.getUnitId())===g.DOCS_NORMAL_EDITOR_UNIT_ID_KEY){if(t){let e=(0,g.BuildTextUtils).transform.fromPlainText(t);return this._paste({body:e})}i.body.textRuns=[]}return this._paste(i)}async _cut(){var e,t,n;let{segmentId:i,endOffset:r,style:a}=null!=(e=this._docSelectionManagerService.getActiveTextRange())?e:{},o=null!=(t=this._docSelectionManagerService.getCurrentTextRanges())?t:[],s=null!=(n=this._docSelectionManagerService.getCurrentRectRanges())?n:[];if(null==i&&this._logService.error("[DocClipboardController] segmentId is not existed"),0===o.length&&0===s.length)return!1;this.copy(g.SliceBodyType.cut);try{let e=0;if(s.length>0)e=ek(o,s);else if(null!=r)for(let t of(e=r,o)){let{startOffset:n,endOffset:i}=t;null==n||null==i||i<=r&&(e-=i-n)}let t=[{startOffset:e,endOffset:e,style:a}];return this._commandService.executeCommand(e_.id,{segmentId:i,textRanges:t})}catch{return this._logService.error("[DocClipboardController] cut content failed"),!1}}async _paste(e){var t,n;let{body:i}=e;if(null==i)return!1;let r=(0,g.normalizeBody)(i);if(!(null==(t=this._univerInstanceService.getCurrentUnitForType(g.UniverInstanceType.UNIVER_DOC))?void 0:t.getUnitId()))return!1;this._clipboardHooks.forEach(e=>{e.onBeforePaste&&(r=e.onBeforePaste(r))}),r.customRanges=null==(n=r.customRanges)?void 0:n.map(g.BuildTextUtils.customRange.copyCustomRange);let{segmentId:a,endOffset:o,style:s}=this._docSelectionManagerService.getActiveTextRange()||{},l=this._docSelectionManagerService.getCurrentTextRanges();if(null==a&&this._logService.error("[DocClipboardController] segmentId does not exist!"),null==o||null==l)return!1;try{let t=o;for(let e of l){let{startOffset:n,endOffset:i}=e;null==n||null==i||i<=o&&(t+=r.dataStream.length-(i-n))}let n=[{startOffset:t,endOffset:t,style:s}];return this._commandService.executeCommand(eN.id,{doc:{...e,body:r},segmentId:a,textRanges:n})}catch{return this._logService.error("[DocClipboardController]","clipboard is empty."),!1}}async _setClipboardData(e,t,n=!0){var i,r;let a=ez(),o=(e.length>1?e.map(e=>e.dataStream).join(`
`):e[0].dataStream).replaceAll(g.DataStreamTreeTokenType.CUSTOM_RANGE_START,"").replaceAll(g.DataStreamTreeTokenType.CUSTOM_RANGE_END,""),s=this._umdToHtml.convert(e);if(1===e.length&&n){s=s.replace(/(<[a-z]+)/,(e,t)=>`${t} data-copy-id="${a}"`);let n=e[0],o={body:n};if(null!=(i=n.customBlocks)&&i.length)for(let e of(o.drawings={},n.customBlocks)){let{blockId:n}=e,i=null==(r=t.drawings)?void 0:r[n];if(i){let t=(0,g.Tools).generateRandomId(6);e.blockId=t,o.drawings[t]={...(0,g.Tools).deepClone(i),drawingId:t}}}eK.set(a,o)}return this._clipboardInterfaceService.write(o,s)}addClipboardHook(e){return this._clipboardHooks.push(e),(0,g.toDisposable)(()=>{let t=this._clipboardHooks.indexOf(e);t>-1&&this._clipboardHooks.splice(t,1)})}_getDocumentBodyInRanges(e){var t;let n=this._univerInstanceService.getCurrentUniverDocInstance(),i=this._docSelectionManagerService.getDocRanges(),r=[],a=!0;if(null==n||0===i.length)return;let o=i[0].segmentId,s=null==(t=null==n?void 0:n.getSelfOrHeaderFooterModel(o))?void 0:t.getBody(),l=n.getSnapshot();if(null!=s){for(let t of i){let{startOffset:i,endOffset:l,collapsed:A,rangeType:d}=t;if(A||null==i||null==l)continue;if(d===g.DOC_RANGE_TYPE.RECT){let e;a=!1;let{spanEntireRow:n}=t;e=te(s,i,l),r.push(e);continue}let c=(0,g.BuildTextUtils).selection.getDeleteSelection({startOffset:i,endOffset:l,collapsed:A},s),u=n.getSelfOrHeaderFooterModel(o).sliceBody(c.startOffset,c.endOffset,e);null!=u&&r.push(u)}return{bodyList:r,needCache:a,snapshot:l}}}async _genDocDataFromClipboardItems(e){try{let t="",n="";for(let i of e)for(let e of i.types)e===m.PLAIN_TEXT_CLIPBOARD_MIME_TYPE?n=await i.getType(e).then(e=>e&&e.text()):e===m.HTML_CLIPBOARD_MIME_TYPE&&(t=await i.getType(e).then(e=>e&&e.text()));return this._genDocDataFromHtmlAndText(t,n)}catch(e){return Promise.reject(e)}}_genDocDataFromHtmlAndText(e,t){if(!e){if(t)return{body:(0,g.BuildTextUtils).transform.fromPlainText(t)};throw Error("[DocClipboardService] html and text cannot be both empty!")}let n=eG(e);if(n){let e=eK.get(n);if(e)return e}return this._htmlToUDM.convert(e)}},"DocClipboardService"),n7);function ti(e){return e.getContextValue(g.FOCUSING_DOC)||e.getContextValue(g.EDITOR_ACTIVATED)}function tr(e){return e.getContextValue(g.EDITOR_ACTIVATED)}tn=e5([e7(0,g.IUniverInstanceService),e7(1,g.ILogService),e7(2,g.ICommandService),e7(3,m.IClipboardInterfaceService),e7(4,(0,g.Inject)(h.DocSelectionManagerService))],tn),_(ti,"whenDocOrEditor"),_(tr,"whenFocusEditor");let ta={id:m.CopyCommand.id,name:"doc.command.copy",type:g.CommandType.COMMAND,multi:!0,priority:999,preconditions:ti,handler:/* @__PURE__ */_(async e=>e.get(tt).copy(),"handler")},to={id:m.CutCommand.id,name:"doc.command.cut",type:g.CommandType.COMMAND,multi:!0,priority:999,preconditions:ti,handler:/* @__PURE__ */_(async e=>e.get(tt).cut(),"handler")},ts={id:m.PasteCommand.id,name:"doc.command.paste",type:g.CommandType.COMMAND,multi:!0,priority:999,preconditions:ti,handler:/* @__PURE__ */_(async e=>{let t=e.get(tt),n=await e.get(m.IClipboardInterfaceService).read();return 0!==n.length&&t.paste(n)},"handler")},tl=class extends g.RxDisposable{constructor(e){super(),w(this,"_previousActiveRange",null),w(this,"_undoMutationParamsCache",[]),w(this,"_redoMutationParamsCache",[]),this._context=e}clearUndoRedoMutationParamsCache(){this._undoMutationParamsCache=[],this._redoMutationParamsCache=[]}getUndoRedoMutationParamsCache(){return{undoCache:this._undoMutationParamsCache,redoCache:this._redoMutationParamsCache}}setUndoRedoMutationParamsCache({undoCache:e=[],redoCache:t=[]}){this._undoMutationParamsCache=e,this._redoMutationParamsCache=t}getActiveRange(){return this._previousActiveRange}setActiveRange(e){this._previousActiveRange=e}pushUndoRedoMutationParams(e,t){this._undoMutationParamsCache.push(e),this._redoMutationParamsCache.push(t)}fetchComposedUndoRedoMutationParams(){if(0===this._undoMutationParamsCache.length||null==this._previousActiveRange||0===this._redoMutationParamsCache.length)return null;let{unitId:e}=this._undoMutationParamsCache[0],t={unitId:e,actions:this._undoMutationParamsCache.reverse().reduce((e,t)=>(0,g.JSONX).compose(e,t.actions),null),textRanges:[]};return{redoMutationParams:{unitId:e,actions:this._redoMutationParamsCache.reduce((e,t)=>(0,g.JSONX).compose(e,t.actions),null),textRanges:[]},undoMutationParams:t,previousActiveRange:this._previousActiveRange}}dispose(){this._undoMutationParamsCache=[],this._redoMutationParamsCache=[],this._previousActiveRange=null}};_(tl,"DocIMEInputManagerService");let tA={id:"doc.command.ime-input",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>{var n;let{unitId:i,newText:r,oldTextLen:a,isCompositionEnd:o,isCompositionStart:s}=t,l=e.get(g.ICommandService),A=null==(n=e.get(p.IRenderManagerService).getRenderById(i))?void 0:n.with(tl),d=e.get(g.IUniverInstanceService).getCurrentUniverDocInstance();if(null==d||null==A)return!1;let c=A.getActiveRange();if(!c)return!1;let{style:u,segmentId:m}=c,f=d.getSelfOrHeaderFooterModel(m).getBody();if(null==f)return!1;let I=(0,g.BuildTextUtils).selection.getInsertSelection(c,f);Object.assign(c,I);let{startOffset:S}=c,E=r.length,v=[{startOffset:S+E,endOffset:S+E,collapsed:!0,style:u}],T={id:h.RichTextEditingMutation.id,params:{unitId:i,actions:[],textRanges:v}},C=new g.TextX,y=(0,g.JSONX).getInstance();if(!c.collapsed&&s){let{dos:e,retain:t,cursor:n}=(0,g.BuildTextUtils).selection.getDeleteActions(c,m,0,f);C.push(...e),T.params.textRanges=[{startOffset:S+E+t,endOffset:S+E+t,collapsed:!0}]}else C.push({t:g.TextXActionType.RETAIN,len:S,segmentId:m});a>0&&C.push({t:g.TextXActionType.DELETE,len:a,line:0,segmentId:m}),C.push({t:g.TextXActionType.INSERT,body:{dataStream:r},len:r.length,line:0,segmentId:m});let b=J(d,m);T.params.actions=y.editOp(C.serialize(),b),T.params.noHistory=!o,T.params.isCompositionEnd=o;let x=l.syncExecuteCommand(T.id,T.params);return A.pushUndoRedoMutationParams(x,T.params),!!x},"handler")};function td(e,t,n){return n.executeCommand(tQ.id,{preCommandId:e,...null!=t?t:{}})}_(td,"handleInlineFormat");let tc="doc.command.set-inline-format-bold",tu={id:tc,type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>td(tc,t,e.get(g.ICommandService)),"handler")},tg="doc.command.set-inline-format-italic",th={id:tg,type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>td(tg,t,e.get(g.ICommandService)),"handler")},tp="doc.command.set-inline-format-underline",tm={id:tp,type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>td(tp,t,e.get(g.ICommandService)),"handler")},tf="doc.command.set-inline-format-strikethrough",tI={id:tf,type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>td(tf,t,e.get(g.ICommandService)),"handler")},tS="doc.command.set-inline-format-subscript",tE={id:tS,type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>td(tS,t,e.get(g.ICommandService)),"handler")},tv="doc.command.set-inline-format-superscript",tT={id:tv,type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>td(tv,t,e.get(g.ICommandService)),"handler")},tC="doc.command.set-inline-format-fontsize",ty={id:tC,type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>td(tC,t,e.get(g.ICommandService)),"handler")},tb="doc.command.set-inline-format-font-family",tx={id:tb,type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>td(tb,t,e.get(g.ICommandService)),"handler")},tR="doc.command.set-inline-format-text-color",tO={id:tR,type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>td(tR,t,e.get(g.ICommandService)),"handler")},tB="doc.command.set-inline-format-text-background-color",tM={id:tB,type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>td(tB,t,e.get(g.ICommandService)),"handler")},tD="doc.command.reset-inline-format-text-background-color",tN={id:tD,type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>td(tD,t,e.get(g.ICommandService)),"handler")},tP={[tu.id]:"bl",[th.id]:"it",[tm.id]:"ul",[tI.id]:"st",[ty.id]:"fs",[tx.id]:"ff",[tO.id]:"cl",[tM.id]:"bg",[tN.id]:"bg",[tE.id]:"va",[tT.id]:"va"},tQ={id:"doc.command.set-inline-format",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>{let n;let{value:i,preCommandId:r}=t,a=e.get(g.ICommandService),o=e.get(h.DocSelectionManagerService),s=e.get(g.IUniverInstanceService),l=o.getDocRanges();if(0===l.length)return!1;let A=l[0].segmentId,d=s.getCurrentUniverDocInstance();if(null==d)return!1;let c=d.getUnitId();switch(r){case tu.id:case th.id:case tm.id:case tI.id:case tE.id:case tT.id:n=t_(d.getSelfOrHeaderFooterModel(A).getBody().textRuns,r,l);break;case ty.id:case tx.id:n=i;break;case tO.id:case tM.id:n={rgb:i};break;case tN.id:n={rgb:null};break;default:throw Error(`Unknown command: ${r} in handleInlineFormat`)}let u={id:h.RichTextEditingMutation.id,params:{unitId:c,actions:[],textRanges:l}},p=new g.TextX,m=(0,g.JSONX).getInstance(),f=new g.MemoryCursor;for(let e of(f.reset(),l)){let{startOffset:t,endOffset:i}=e;if(null==t||null==i)continue;let a={dataStream:"",textRuns:[{st:0,ed:i-t,ts:{[tP[r]]:n}}]},o=t-f.cursor;0!==o&&p.push({t:g.TextXActionType.RETAIN,len:o,segmentId:A}),p.push({t:g.TextXActionType.RETAIN,body:a,len:i-t,segmentId:A}),f.reset(),f.moveCursor(i)}let I=J(d,A);return u.params.actions=m.editOp(p.serialize(),I),!!a.syncExecuteCommand(u.id,u.params)},"handler")};function tU(e){return null!==e&&"object"==typeof e}function t_(e,t,n){let i=0,r=0,a=tP[t];for(;i!==e.length&&r!==n.length;){let{startOffset:o,endOffset:s}=n[r],{st:l,ed:A,ts:d}=e[i];if(s<=l)r++;else if(A<=o)i++;else{if(/bl|it/.test(a))return(null==d?void 0:d[a])===g.BooleanNumber.TRUE?g.BooleanNumber.FALSE:g.BooleanNumber.TRUE;if(/ul|st/.test(a))return tU(null==d?void 0:d[a])&&(null==d?void 0:d[a]).s===g.BooleanNumber.TRUE?{s:g.BooleanNumber.FALSE}:{s:g.BooleanNumber.TRUE};if(/va/.test(a))return t===tE.id?(null==d?void 0:d[a])===g.BaselineOffset.SUBSCRIPT?g.BaselineOffset.NORMAL:g.BaselineOffset.SUBSCRIPT:(null==d?void 0:d[a])===g.BaselineOffset.SUPERSCRIPT?g.BaselineOffset.NORMAL:g.BaselineOffset.SUPERSCRIPT;i++}}return/bl|it/.test(a)?g.BooleanNumber.TRUE:/ul|st/.test(a)?{s:g.BooleanNumber.TRUE}:t===tE.id?g.BaselineOffset.SUBSCRIPT:g.BaselineOffset.SUPERSCRIPT}_(tU,"isTextDecoration"),_(t_,"getReverseFormatValueInSelection");let tw={id:"doc.command.list-operation",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_((e,t)=>{var n,i,r,a,o,s;let l=e.get(h.DocSelectionManagerService),A=e.get(g.IUniverInstanceService),d=e.get(g.ICommandService),c=t.listType,u=A.getCurrentUniverDocInstance(),m=null!=(n=l.getDocRanges())?n:[];if(null==u||0===m.length)return!1;let f=m[0].segmentId,I=null==(i=u.getSelfOrHeaderFooterModel(f).getBody())?void 0:i.paragraphs;if(null==I)return!1;let S=null!=(a=null==(r=u.getSelfOrHeaderFooterModel(f).getBody())?void 0:r.sectionBreaks)?a:[],E=tK(m,I),v=u.getUnitId(),T=E.every(e=>{var t;return(null==(t=e.bullet)?void 0:t.listType.indexOf(c))===0}),C=(0,g.Tools).generateRandomId(6);if(1===E.length){let e=I.indexOf(E[0]),t=I[e-1],n=I[e+1];t&&t.bullet&&0===t.bullet.listType.indexOf(c)?(C=t.bullet.listId,c!==g.PresetListType.CHECK_LIST&&(c=t.bullet.listType)):n&&n.bullet&&0===n.bullet.listType.indexOf(c)&&(C=n.bullet.listId,c!==g.PresetListType.CHECK_LIST&&(c=n.bullet.listType))}let y={id:h.RichTextEditingMutation.id,params:{unitId:v,actions:[],textRanges:m}},b=new g.MemoryCursor;b.reset();let x=new g.TextX,R=(0,g.JSONX).getInstance(),O=null!=(o=u.getSnapshot().lists)?o:{},B={...g.PRESET_LIST_TYPE,...O},{defaultTabStop:M=36}=u.getSnapshot().documentStyle;for(let e of E){let{startIndex:t,paragraphStyle:n={},bullet:i}=e,{indentFirstLine:r,snapToGrid:a,indentStart:o}=n,{hanging:l,indentStart:A}=B[c].nestingLevel[0].paragraphProperties||{},{charSpace:d,gridType:u}=tq(t,S)||{charSpace:0,gridType:g.GridType.LINES},h=(0,p.getCharSpaceApply)(d,M,u,a);x.push({t:g.TextXActionType.RETAIN,len:t-b.cursor,segmentId:f}),x.push({t:g.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[T?{paragraphStyle:{...n,hanging:void 0,indentStart:o?{v:Math.max(0,(0,p.getNumberUnitValue)(o,h)+(0,p.getNumberUnitValue)(l,h)-(0,p.getNumberUnitValue)(A,h))}:void 0},startIndex:0}:{startIndex:0,paragraphStyle:{...n,indentFirstLine:void 0,hanging:l,indentStart:{v:(0,p.getNumberUnitValue)(A,h)-(0,p.getNumberUnitValue)(l,h)+(0,p.getNumberUnitValue)(r,h)+(0,p.getNumberUnitValue)(o,h)}},bullet:{nestingLevel:null!=(s=null==i?void 0:i.nestingLevel)?s:0,textStyle:{fs:20},listType:c,listId:C}}]},segmentId:f,coverType:g.UpdateDocsAttributeType.REPLACE}),b.moveCursorTo(t+1)}let D=J(u,f);return y.params.actions=R.editOp(x.serialize(),D),!!d.syncExecuteCommand(y.id,y.params)},"handler")},tL={id:"doc.command.change-list-type",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_((e,t)=>{var n,i,r,a,o,s;let l=e.get(h.DocSelectionManagerService),A=e.get(g.IUniverInstanceService),d=e.get(g.ICommandService),{listType:c}=t,u=A.getCurrentUniverDocInstance(),m=l.getDocRanges();if(null==u||null==m||!m.length)return!1;let{segmentId:f}=m[0],I=null!=(n=l.getDocRanges())?n:[],S=null==(i=u.getSelfOrHeaderFooterModel(f).getBody())?void 0:i.paragraphs;if(null==S)return!1;let E=null!=(a=null==(r=u.getSelfOrHeaderFooterModel(f).getBody())?void 0:r.sectionBreaks)?a:[],v=tY(m,S),T=u.getUnitId(),C=(0,g.Tools).generateRandomId(6),y={id:h.RichTextEditingMutation.id,params:{unitId:T,actions:[],textRanges:I}},b=new g.MemoryCursor;b.reset();let x=new g.TextX,R=(0,g.JSONX).getInstance(),O=null!=(o=u.getSnapshot().lists)?o:{},B={...g.PRESET_LIST_TYPE,...O},{defaultTabStop:M=36}=u.getSnapshot().documentStyle;for(let e of v){let{startIndex:t,paragraphStyle:n={},bullet:i}=e,{indentFirstLine:r,snapToGrid:a,indentStart:o}=n,{hanging:l,indentStart:A}=B[c].nestingLevel[0].paragraphProperties||{},{charSpace:d,gridType:u}=tq(t,E)||{charSpace:0,gridType:g.GridType.LINES},h=(0,p.getCharSpaceApply)(d,M,u,a);x.push({t:g.TextXActionType.RETAIN,len:t-b.cursor,segmentId:f}),x.push({t:g.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:{...n,indentFirstLine:void 0,hanging:l,indentStart:{v:(0,p.getNumberUnitValue)(A,h)-(0,p.getNumberUnitValue)(l,h)+(0,p.getNumberUnitValue)(r,h)+(0,p.getNumberUnitValue)(o,h)}},bullet:{nestingLevel:null!=(s=null==i?void 0:i.nestingLevel)?s:0,textStyle:(null==i?void 0:i.listType)===c?i.textStyle:{fs:20},listType:c,listId:C}}]},segmentId:f,coverType:g.UpdateDocsAttributeType.REPLACE}),b.moveCursorTo(t+1)}let D=J(u,f);return y.params.actions=R.editOp(x.serialize(),D),!!d.syncExecuteCommand(y.id,y.params)},"handler")};var tF=((d=tF||{})[d.increase=1]="increase",d[d.decrease=-1]="decrease",d);let tk={id:"doc.command.change-list-nesting-level",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_((e,t)=>{var n,i,r,a,o;if(!t)return!1;let{type:s}=t,l=e.get(h.DocSelectionManagerService),A=e.get(g.IUniverInstanceService),d=e.get(g.ICommandService),c=A.getCurrentUniverDocInstance(),u=l.getActiveTextRange();if(null==c||null==u)return!1;let{segmentId:p}=u,m=null!=(i=null==(n=c.getBody())?void 0:n.tables)?i:[],f=null!=(r=l.getDocRanges())?r:[],I=null==(a=c.getSelfOrHeaderFooterModel(p).getBody())?void 0:a.paragraphs;if(null==I)return!1;let S=tG(u,I),E=c.getUnitId(),v={id:h.RichTextEditingMutation.id,params:{unitId:E,actions:[],textRanges:f}},T=new g.MemoryCursor;T.reset();let C=new g.TextX,y=(0,g.JSONX).getInstance(),b=null!=(o=c.getSnapshot().lists)?o:{},x={...g.PRESET_LIST_TYPE,...b};for(let e of S){let{startIndex:t,paragraphStyle:n={},bullet:i}=e,r=ee(e,m);if(C.push({t:g.TextXActionType.RETAIN,len:t-T.cursor,segmentId:p}),i){let e=x[i.listType].nestingLevel.length-1;r&&(e=Math.min(e,2)),C.push({t:g.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:{...n},bullet:{...i,nestingLevel:Math.max(Math.min(i.nestingLevel+s,e),0)}}]},segmentId:p,coverType:g.UpdateDocsAttributeType.REPLACE})}else C.push({t:g.TextXActionType.RETAIN,len:1});T.moveCursorTo(t+1)}let R=J(c,p);return v.params.actions=y.editOp(C.serialize(),R),!!d.syncExecuteCommand(v.id,v.params)},"handler")},tH={id:"doc.command.bullet-list",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_((e,t)=>{let n=e.get(g.ICommandService);return null!=t&&t.value?n.syncExecuteCommand(tL.id,{listType:t.value}):n.syncExecuteCommand(tw.id,{listType:g.PresetListType.BULLET_LIST})},"handler")},tV={id:"doc.command.check-list",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_((e,t)=>{let n=e.get(g.ICommandService);return null!=t&&t.value?n.syncExecuteCommand(tL.id,{listType:t.value}):n.syncExecuteCommand(tw.id,{listType:g.PresetListType.CHECK_LIST})},"handler")},tj={id:"doc.command.toggle-check-list",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_((e,t)=>{var n;if(!t)return!1;let i=e.get(g.IUniverInstanceService),r=e.get(g.ICommandService),{index:a,segmentId:o}=t,s=i.getCurrentUniverDocInstance();if(null==s)return!1;let l=null==(n=s.getSelfOrHeaderFooterModel(o).getBody())?void 0:n.paragraphs;if(null==l)return!1;let A=l.find(e=>e.startIndex===a),d=s.getUnitId();if(!(null!=A&&A.bullet)||-1===A.bullet.listType.indexOf(g.PresetListType.CHECK_LIST))return!1;let c={id:h.RichTextEditingMutation.id,params:{unitId:d,actions:[],textRanges:[],segmentId:o}},u=new g.MemoryCursor;u.reset();let p=new g.TextX,m=(0,g.JSONX).getInstance(),{startIndex:f,paragraphStyle:I={}}=A,S=A.bullet.listType===g.PresetListType.CHECK_LIST?g.PresetListType.CHECK_LIST_CHECKED:g.PresetListType.CHECK_LIST;p.push({t:g.TextXActionType.RETAIN,len:f-u.cursor,segmentId:o}),p.push({t:g.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...A,paragraphStyle:I,startIndex:0,bullet:{...A.bullet,listType:S}}]},coverType:g.UpdateDocsAttributeType.REPLACE,segmentId:o}),u.moveCursorTo(f+1);let E=J(s,o);return c.params.actions=m.editOp(p.serialize(),E),!!r.syncExecuteCommand(c.id,c.params)},"handler")},tW={id:"doc.command.order-list",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_((e,t)=>{let n=e.get(g.ICommandService);return null!=t&&t.value?n.syncExecuteCommand(tL.id,{listType:t.value}):n.syncExecuteCommand(tw.id,{listType:g.PresetListType.ORDER_LIST})},"handler")},tz={id:"doc.command.quick-list",type:g.CommandType.COMMAND,handler(e,t){var n,i,r,a,o;if(!t)return!1;let s=e.get(h.DocSelectionManagerService),l=e.get(g.IUniverInstanceService),A=e.get(g.ICommandService),d=l.getCurrentUniverDocInstance(),c=s.getActiveTextRange();if(null==d||null==c)return!1;let{segmentId:u}=c,{listType:m,paragraph:f}=t,{paragraphStart:I,paragraphEnd:S}=f,E=new g.TextX,v=(0,g.JSONX).getInstance(),{defaultTabStop:T=36}=d.getSnapshot().documentStyle,C=null!=(i=null==(n=d.getSelfOrHeaderFooterModel(u).getBody())?void 0:n.sectionBreaks)?i:[],{startIndex:y,paragraphStyle:b={}}=f,{indentFirstLine:x,snapToGrid:R,indentStart:O}=b,B=g.PRESET_LIST_TYPE[m].nestingLevel[0].paragraphProperties||{},{hanging:M,indentStart:D}=B,N=B.textStyle,{charSpace:P,gridType:Q}=tq(y,C)||{charSpace:0,gridType:g.GridType.LINES},U=(0,p.getCharSpaceApply)(P,T,Q,R),_=(0,g.Tools).generateRandomId(6),w=null!=(a=null==(r=d.getBody())?void 0:r.paragraphs)?a:[],L=w.findIndex(e=>e.startIndex===f.startIndex),F=w[L-1],k=w[L+1];F&&F.bullet&&0===F.bullet.listType.indexOf(m)?_=F.bullet.listId:k&&k.bullet&&0===k.bullet.listType.indexOf(m)&&(_=k.bullet.listId);let H={id:h.RichTextEditingMutation.id,params:{unitId:d.getUnitId(),actions:[],textRanges:[{startOffset:I,endOffset:I,collapsed:!0}]}};E.push({t:g.TextXActionType.RETAIN,len:I}),E.push({t:g.TextXActionType.DELETE,len:S-I,line:1}),E.push({t:g.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:{...b,textStyle:{...b.textStyle,...N},indentFirstLine:void 0,hanging:M,indentStart:{v:(0,p.getNumberUnitValue)(D,U)-(0,p.getNumberUnitValue)(M,U)+(0,p.getNumberUnitValue)(x,U)+(0,p.getNumberUnitValue)(O,U)}},bullet:{...null!=(o=f.bullet)?o:{nestingLevel:0,textStyle:{fs:20}},listType:m,listId:_}}]}});let V=J(d,u);return H.params.actions=v.editOp(E.serialize(),V),!!A.syncExecuteCommand(H.id,H.params)}};function tG(e,t){let{startOffset:n,endOffset:i}=e,r=[],a=-1;for(let e of t){let{startIndex:t}=e;(n>a&&n<=t||i>a&&i<=t||t>=n&&t<=i)&&r.push(e),a=t}return r}function tY(e,t){let n=tK(e,t),i=t.indexOf(n[0]),r=t.indexOf(n[n.length-1]);if(n[0].bullet)for(let e=i-1;e>=0;e--){let i=t[e];i.bullet&&i.bullet.listId===n[0].bullet.listId&&n.unshift(i)}let a=n[n.length-1];if(a.bullet)for(let e=r+1;e<t.length;e++){let i=t[e];i.bullet&&i.bullet.listId===a.bullet.listId&&n.push(i)}return n}function tK(e,t){let n=[];for(let i of e){let e=tG(i,t);n.push(...e)}return n}function tq(e,t){let n=t.sort((0,g.sortRulesFactory)("startIndex"));for(let i=0;i<n.length;i++){let n=t[i];if(n.startIndex>=e)return n}}_(tG,"getParagraphsInRange"),_(tY,"getParagraphsRelative"),_(tK,"getParagraphsInRanges"),_(tq,"findNearestSectionBreak");let tX={id:"doc.command.align-action",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_((e,t)=>{var n;let i=e.get(h.DocSelectionManagerService),r=e.get(g.IUniverInstanceService),a=e.get(g.ICommandService),{alignType:o}=t,s=r.getCurrentUniverDocInstance();if(null==s)return!1;let l=i.getDocRanges();if(0===l.length)return!1;let A=l[0].segmentId,d=null==(n=s.getSelfOrHeaderFooterModel(A).getBody())?void 0:n.paragraphs;if(null==d)return!1;let c=tK(l,d),u=s.getUnitId(),p=c.every(e=>{var t;return(null==(t=e.paragraphStyle)?void 0:t.horizontalAlign)===o}),m={id:h.RichTextEditingMutation.id,params:{unitId:u,actions:[],textRanges:l}},f=new g.MemoryCursor;f.reset();let I=new g.TextX,S=(0,g.JSONX).getInstance();for(let e of c){let{startIndex:t}=e;I.push({t:g.TextXActionType.RETAIN,len:t-f.cursor,segmentId:A});let n={...e.paragraphStyle,horizontalAlign:p?g.HorizontalAlign.UNSPECIFIED:o};I.push({t:g.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...e,paragraphStyle:n,startIndex:0}]},segmentId:A,coverType:g.UpdateDocsAttributeType.REPLACE}),f.moveCursorTo(t+1)}let E=J(s,A);return m.params.actions=S.editOp(I.serialize(),E),!!a.syncExecuteCommand(m.id,m.params)},"handler")},tJ={id:"doc.command.align-left",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(e=>e.get(g.ICommandService).syncExecuteCommand(tX.id,{alignType:g.HorizontalAlign.LEFT}),"handler")},tZ={id:"doc.command.align-center",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(e=>e.get(g.ICommandService).syncExecuteCommand(tX.id,{alignType:g.HorizontalAlign.CENTER}),"handler")},t$={id:"doc.command.align-right",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(e=>e.get(g.ICommandService).syncExecuteCommand(tX.id,{alignType:g.HorizontalAlign.RIGHT}),"handler")},t0={id:"doc.command.align-justify",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(e=>e.get(g.ICommandService).syncExecuteCommand(tX.id,{alignType:g.HorizontalAlign.JUSTIFIED}),"handler")},t1={id:"doc.command-replace-content",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>{let{unitId:n,body:i,textRanges:r,segmentId:a="",options:o}=t,s=e.get(g.IUniverInstanceService),l=e.get(g.ICommandService),A=e.get(h.DocSelectionManagerService),d=s.getUniverDocInstance(n),c=null==d?void 0:d.getSnapshot().body,u=A.getCurrentTextRanges();if(null==d||null==c||!Array.isArray(u)||0===u.length)return!1;let p=t3(n,a,d,c,i);return p.params.textRanges=r,o&&(p.params.options=o),!!l.syncExecuteCommand(p.id,p.params)},"handler")},t9={id:"doc.command-cover-content",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>{let{unitId:n,body:i,segmentId:r=""}=t,a=e.get(g.IUniverInstanceService),o=e.get(g.ICommandService),s=e.get(g.IUndoRedoService),l=a.getUniverDocInstance(n),A=null==l?void 0:l.getSnapshot().body;if(null==l||null==A)return!1;let d=t3(n,r,l,A,i);return d.params.noNeedSetTextRange=!0,d.params.noHistory=!0,o.syncExecuteCommand(d.id,d.params),s.clearUndoRedo(n),!0},"handler")};function t3(e,t,n,i,r){let a={id:h.RichTextEditingMutation.id,params:{unitId:e,actions:[],textRanges:[]}},o=new g.TextX,s=(0,g.JSONX).getInstance(),l=(null==i?void 0:i.dataStream.length)-2;l>0&&o.push({t:g.TextXActionType.DELETE,len:l,line:0,segmentId:t}),r.dataStream.length>0&&o.push({t:g.TextXActionType.INSERT,body:r,len:r.dataStream.length,line:0,segmentId:t});let A=J(n,t);return a.params.actions=s.editOp(o.serialize(),A),a}_(t3,"getMutationParams"),g.CommandType.COMMAND;let t2=/* @__PURE__ */_((e,t)=>{let n=e.get(g.IUniverInstanceService).getUniverDocInstance(t.unitId),i=(null==n?void 0:n.zoomRatio)||1;return{...(0,g.Tools).deepClone(t),zoomRatio:i}},"SetDocZoomRatioUndoMutationFactory"),t4={id:"doc.operation.set-zoom-ratio",type:g.CommandType.OPERATION,handler:/* @__PURE__ */_((e,t)=>{let n=e.get(g.IUniverInstanceService).getUniverDocInstance(t.unitId);if(!n)return!1;let i=n.getSnapshot();return null==i.settings?i.settings={zoomRatio:t.zoomRatio}:i.settings.zoomRatio=t.zoomRatio,!0},"handler")},t8={type:g.CommandType.COMMAND,id:"doc.command.set-zoom-ratio",handler:/* @__PURE__ */_(async(e,t)=>{var n,i,r;let a=e.get(g.ICommandService),o=e.get(g.IUndoRedoService),s=e.get(g.IUniverInstanceService),l=null==(n=s.getCurrentUniverDocInstance())?void 0:n.getUnitId();if(!l)return!1;let A=1;if(t&&(l=null!=(i=t.documentId)?i:l,A=null!=(r=t.zoomRatio)?r:A),!s.getUniverDocInstance(l))return!1;let d={zoomRatio:A,unitId:l},c=t2(e,d);return!!a.syncExecuteCommand(t4.id,d)&&(o.pushUndoRedo({unitID:l,undoMutations:[{id:t4.id,params:c}],redoMutations:[{id:t4.id,params:d}]}),!0)},"handler")},t6={id:"doc.command.create-table",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>{var n,i,r,a,o,s;let{rowCount:l,colCount:A}=t,d=e.get(h.DocSelectionManagerService),c=e.get(g.IUniverInstanceService),u=e.get(g.ICommandService),p=d.getActiveTextRange();if(null==p)return!1;let{segmentId:m,segmentPage:f}=p,I=c.getCurrentUniverDocInstance(),S=null==I?void 0:I.getSelfOrHeaderFooterModel(m).getBody();if(null==I||null==S)return!1;let E=I.getUnitId(),v=X(e,E),T=null==v?void 0:v.getSkeleton();if(null==T)return!1;let{startOffset:C}=(0,g.BuildTextUtils).selection.getInsertSelection(p,S),y=(null!=(n=S.paragraphs)?n:[]).find(e=>e.startIndex>=C),b=T.findNodeByCharIndex(C,m,f),x=null==(i=null==b?void 0:b.parent)?void 0:i.parent,R=T.findNodeByCharIndex(C-1,m,f),O=R&&"\r"!==R.content;if(null==b||null==x)return!1;let B=O||x.isBehindTable,M=new g.TextX,D=(0,g.JSONX).getInstance(),N=[],P=C+(B?4:3),Q={id:h.RichTextEditingMutation.id,params:{unitId:E,actions:[],textRanges:[{startOffset:P,endOffset:P,collapsed:!0}]}};C>0&&M.push({t:g.TextXActionType.RETAIN,len:C,segmentId:m}),B&&M.push({t:g.TextXActionType.INSERT,body:{dataStream:g.DataStreamTreeTokenType.PARAGRAPH,paragraphs:eA(g.DataStreamTreeTokenType.PARAGRAPH,y)},len:1,line:0,segmentId:m});let{dataStream:U,paragraphs:_,sectionBreaks:w}=eg(l,A),L=null==(s=null==(o=null==(a=null==(r=b.parent)?void 0:r.parent)?void 0:a.parent)?void 0:o.parent)?void 0:s.parent;if(null==L)return!1;let{pageWidth:F,marginLeft:k,marginRight:H}=L,V=ef(l,A,F-k-H);M.push({t:g.TextXActionType.INSERT,body:{dataStream:U,paragraphs:_,sectionBreaks:w,tables:[{startIndex:0,endIndex:U.length,tableId:V.tableId}]},len:U.length,line:0,segmentId:m});let j=J(I,m);return N.push(D.editOp(M.serialize(),j)),N.push(D.insertOp(["tableSource",V.tableId],V)),Q.params.actions=N.reduce((e,t)=>(0,g.JSONX).compose(e,t),null),!!u.syncExecuteCommand(Q.id,Q.params)},"handler")},t5={id:"doc.table.delete-rows",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async e=>{let t=e.get(h.DocSelectionManagerService),n=e.get(g.IUniverInstanceService),i=e.get(g.ICommandService),r=t.getCurrentRectRanges(),a=eI(t.getActiveTextRange(),r);if(null==a)return!1;let{segmentId:o}=a,s=n.getCurrentUniverDocInstance(),l=null==s?void 0:s.getSelfOrHeaderFooterModel(o).getBody();if(null==s||null==l)return!1;let A=X(e,s.getUnitId());if(null==A)return!1;let d=A.getViewModel(),c=null==s?void 0:s.getUnitId(),u=new g.TextX,p=(0,g.JSONX).getInstance(),m=ey(a,d);if(null==m)return!1;let{offset:f,rowIndexes:I,len:S,tableId:E,cursor:v,selectWholeTable:T}=m;if(T)return i.executeCommand(ne.id);let C=[],y={id:h.RichTextEditingMutation.id,params:{unitId:c,actions:[],textRanges:[{startOffset:v,endOffset:v,collapsed:!0}]}};f>0&&u.push({t:g.TextXActionType.RETAIN,len:f,segmentId:o}),u.push({t:g.TextXActionType.DELETE,len:S,line:0,segmentId:o});let b=J(s,o);for(let e of(C.push(p.editOp(u.serialize(),b)),I.reverse())){let t=p.removeOp(["tableSource",E,"tableRows",e]);C.push(t)}return y.params.actions=C.reduce((e,t)=>(0,g.JSONX).compose(e,t),null),!!i.syncExecuteCommand(y.id,y.params)},"handler")},t7={id:"doc.table.delete-columns",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async e=>{let t=e.get(h.DocSelectionManagerService),n=e.get(g.IUniverInstanceService),i=e.get(g.ICommandService),r=t.getCurrentRectRanges(),a=eI(t.getActiveTextRange(),r);if(null==a)return!1;let{segmentId:o}=a,s=n.getCurrentUniverDocInstance(),l=null==s?void 0:s.getSelfOrHeaderFooterModel(o).getBody();if(null==s||null==l)return!1;let A=X(e,s.getUnitId());if(null==A)return!1;let d=A.getViewModel(),c=null==s?void 0:s.getUnitId(),u=new g.TextX,p=(0,g.JSONX).getInstance(),m=eb(a,d);if(null==m)return!1;let{offsets:f,columnIndexes:I,tableId:S,cursor:E,rowCount:v,selectWholeTable:T}=m;if(T)return i.executeCommand(ne.id);let C=[],y={id:h.RichTextEditingMutation.id,params:{unitId:c,actions:[],textRanges:[{startOffset:E,endOffset:E,collapsed:!0}]}};for(let e of f){let{retain:t,delete:n}=e;t>0&&u.push({t:g.TextXActionType.RETAIN,len:t,segmentId:o}),u.push({t:g.TextXActionType.DELETE,len:n,line:0,segmentId:o})}let b=J(s,o);C.push(p.editOp(u.serialize(),b)),I.reverse();for(let e=0;e<v;e++)for(let t of I){let n=p.removeOp(["tableSource",S,"tableRows",e,"tableCells",t]);C.push(n)}for(let e of I){let t=p.removeOp(["tableSource",S,"tableColumns",e]);C.push(t)}return y.params.actions=C.reduce((e,t)=>(0,g.JSONX).compose(e,t),null),!!i.syncExecuteCommand(y.id,y.params)},"handler")},ne={id:"doc.table.delete-table",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async e=>{let t=e.get(h.DocSelectionManagerService),n=e.get(g.IUniverInstanceService),i=e.get(g.ICommandService),r=t.getCurrentRectRanges(),a=eI(t.getActiveTextRange(),r);if(null==a)return!1;let{segmentId:o}=a,s=n.getCurrentUniverDocInstance(),l=null==s?void 0:s.getSelfOrHeaderFooterModel(o).getBody();if(null==s||null==l)return!1;let A=X(e,s.getUnitId());if(null==A)return!1;let d=A.getViewModel(),c=null==s?void 0:s.getUnitId(),u=new g.TextX,p=(0,g.JSONX).getInstance(),m=ex(a,d);if(null==m)return!1;let{offset:f,len:I,tableId:S,cursor:E}=m,v=[],T={id:h.RichTextEditingMutation.id,params:{unitId:c,actions:[],textRanges:[{startOffset:E,endOffset:E,collapsed:!0}]}};f>0&&u.push({t:g.TextXActionType.RETAIN,len:f,segmentId:o}),u.push({t:g.TextXActionType.DELETE,len:I,line:0,segmentId:o});let C=J(s,o);return v.push(p.editOp(u.serialize(),C)),v.push(p.removeOp(["tableSource",S])),T.params.actions=v.reduce((e,t)=>(0,g.JSONX).compose(e,t),null),!!i.syncExecuteCommand(T.id,T.params)},"handler")},nt="doc.command.table-insert-row",nn="doc.command.table-insert-column",ni={id:"doc.command.table-insert-row-above",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async e=>e.get(g.ICommandService).executeCommand(nt,{position:ec.ABOVE}),"handler")},nr={id:"doc.command.table-insert-row-bellow",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async e=>e.get(g.ICommandService).executeCommand(nt,{position:ec.BELLOW}),"handler")},na={id:"doc.command.table-insert-column-left",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async e=>e.get(g.ICommandService).executeCommand(nn,{position:eu.LEFT}),"handler")},no={id:"doc.command.table-insert-column-right",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async e=>e.get(g.ICommandService).executeCommand(nn,{position:eu.RIGHT}),"handler")},ns={id:nt,type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>{let{position:n}=t,i=e.get(h.DocSelectionManagerService),r=e.get(g.IUniverInstanceService),a=e.get(g.ICommandService),o=i.getCurrentRectRanges(),s=eI(i.getActiveTextRange(),o);if(null==s)return!1;let{segmentId:l}=s,A=r.getCurrentUniverDocInstance(),d=null==A?void 0:A.getSelfOrHeaderFooterModel(l).getBody();if(null==A||null==d)return!1;let c=X(e,A.getUnitId());if(null==c)return!1;let u=c.getViewModel(),p=null==A?void 0:A.getUnitId(),m=new g.TextX,f=(0,g.JSONX).getInstance(),I=ev(s,n,u);if(null==I)return!1;let{offset:S,colCount:E,tableId:v,insertRowIndex:T}=I,C=[],y=S+2,b={id:h.RichTextEditingMutation.id,params:{unitId:p,actions:[],textRanges:[{startOffset:y,endOffset:y,collapsed:!0}]}};S>0&&m.push({t:g.TextXActionType.RETAIN,len:S,segmentId:l});let x=eS(E);m.push({t:g.TextXActionType.INSERT,body:x,len:x.dataStream.length,line:0,segmentId:l});let R=J(A,l);C.push(f.editOp(m.serialize(),R));let O=ep(E);return C.push(f.insertOp(["tableSource",v,"tableRows",T],O)),b.params.actions=C.reduce((e,t)=>(0,g.JSONX).compose(e,t),null),!!a.syncExecuteCommand(b.id,b.params)},"handler")},nl={id:nn,type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>{var n,i,r;let{position:a}=t,o=e.get(h.DocSelectionManagerService),s=e.get(g.IUniverInstanceService),l=e.get(g.ICommandService),A=o.getCurrentRectRanges(),d=eI(o.getActiveTextRange(),A);if(null==d)return!1;let{segmentId:c}=d,u=s.getCurrentUniverDocInstance(),p=null==u?void 0:u.getSelfOrHeaderFooterModel(c).getBody();if(null==u||null==p)return!1;let m=X(e,u.getUnitId());if(null==m)return!1;let f=m.getViewModel(),I=null==u?void 0:u.getUnitId(),S=new g.TextX,E=(0,g.JSONX).getInstance(),v=eT(d,a,f);if(null==v)return!1;let{offsets:T,columnIndex:C,tableId:y,rowCount:b}=v,x=[],R=T[0]+1,O={id:h.RichTextEditingMutation.id,params:{unitId:I,actions:[],textRanges:[{startOffset:R,endOffset:R,collapsed:!0}]}};for(let e of T){S.push({t:g.TextXActionType.RETAIN,len:e,segmentId:c});let t=eE();S.push({t:g.TextXActionType.INSERT,body:t,len:t.dataStream.length,line:0,segmentId:c})}let B=J(u,c);x.push(E.editOp(S.serialize(),B));for(let e=0;e<b;e++){let t=eh(),n=E.insertOp(["tableSource",y,"tableRows",e,"tableCells",C],t);x.push(n)}let M=u.getSnapshot(),D=M.documentStyle,{marginLeft:N=0,marginRight:P=0}=D,Q=(null!=(i=null==(n=D.pageSize)?void 0:n.width)?i:800)-N-P,U=null==(r=null==M?void 0:M.tableSource)?void 0:r[y].tableColumns,{newColWidth:_,widths:w}=eC(Q,U,C);for(let e=0;e<w.length;e++){let t=E.replaceOp(["tableSource",y,"tableColumns",e,"size","width","v"],U[e].size.width.v,w[e]);x.push(t)}let L=em(_),F=E.insertOp(["tableSource",y,"tableColumns",C],L);return x.push(F),O.params.actions=x.reduce((e,t)=>(0,g.JSONX).compose(e,t),null),!!l.syncExecuteCommand(O.id,O.params)},"handler")},nA={id:"doc.table.tab-in-table",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>{let{shift:n}=t,i=e.get(h.DocSelectionManagerService),r=i.getActiveTextRange(),a=e.get(g.ICommandService),o=e.get(g.IUniverInstanceService).getCurrentUniverDocInstance();if(!o)return!1;let s=X(e,o.getUnitId()),l=null==s?void 0:s.getSkeleton(),A=null==l?void 0:l.getViewModel().getSelfOrHeaderFooterViewModel(null==r?void 0:r.segmentId);if(null==A||null==r)return!1;let d=null;if(d=n?eB(A,r,eO.PREV):eB(A,r,eO.NEXT)){let{startOffset:e,endOffset:t}=d;return i.replaceTextRanges([{startOffset:e,endOffset:t}]),!0}return!1!==n||await a.executeCommand(ns.id,{position:ec.BELLOW})},"handler")},nd="COMPONENT_DOC_CREATE_TABLE_CONFIRM",nc="doc.component.create-table-confirm",nu={id:"doc.operation.create-table",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async e=>{let t=e.get(g.LocaleService),n=e.get(m.IConfirmService),i=e.get(g.ICommandService),r={rowCount:3,colCount:5},a=/* @__PURE__ */_((e,t)=>{r.rowCount=e,r.colCount=t},"handleRowColChange");return await n.open({id:nc,children:{label:{name:nd,props:{handleRowColChange:a,tableCreateParams:r}}},width:400,title:{title:t.t("toolbar.table.insert")},onConfirm:/* @__PURE__ */_(()=>{i.executeCommand(t6.id,r),n.close(nc)},"onConfirm"),onClose:/* @__PURE__ */_(()=>{n.close(nc)},"onClose")}),!0},"handler")},ng={id:"doc.operation.move-cursor",type:g.CommandType.OPERATION,handler:/* @__PURE__ */_((e,t)=>!!t,"handler")},nh={id:"doc.operation.move-selection",type:g.CommandType.OPERATION,handler:/* @__PURE__ */_((e,t)=>!!t,"handler")},np={id:"doc.operation.select-all",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async e=>{let t=e.get(g.IUniverInstanceService),n=e.get(h.DocSelectionManagerService),i=t.getCurrentUniverDocInstance(),r=n.getActiveTextRange();if(null==i||null==r)return!1;let{segmentId:a}=r,o=i.getSelfOrHeaderFooterModel(a).getSnapshot().body;if(null==o)return!1;let s=[{startOffset:0,endOffset:o.dataStream.length-2}];return n.replaceTextRanges(s,!1),!0},"handler")};var nm=function(){return(nm=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},nf=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)0>t.indexOf(i[r])&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n},nI=(0,M.forwardRef)(function(e,t){var n=e.icon,i=e.id,r=e.className,a=e.extend,o=nf(e,["icon","id","className","extend"]),s="univerjs-icon univerjs-icon-".concat(i," ").concat(r||"").trim(),l=(0,M.useRef)("_".concat(nT()));return nS(n,"".concat(i),{defIds:n.defIds,idSuffix:l.current},nm({ref:t,className:s},o),a)});function nS(e,t,n,i,r){return(0,M.createElement)(e.tag,nm(nm({key:t},nE(e,n,r)),i),(nv(e,n).children||[]).map(function(i,a){return nS(i,"".concat(t,"-").concat(e.tag,"-").concat(a),n,void 0,r)}))}function nE(e,t,n){var i=nm({},e.attrs);null!=n&&n.colorChannel1&&"colorChannel1"===i.fill&&(i.fill=n.colorChannel1);var r=t.defIds;return r&&0!==r.length&&("use"===e.tag&&i["xlink:href"]&&(i["xlink:href"]=i["xlink:href"]+t.idSuffix),Object.entries(i).forEach(function(e){var n=e[0],r=e[1];"string"==typeof r&&(i[n]=r.replace(/url\(#(.*)\)/,"url(#$1".concat(t.idSuffix,")")))})),i}function nv(e,t){var n,i=t.defIds;return i&&0!==i.length&&"defs"===e.tag&&!(null===(n=e.children)||void 0===n)&&n.length?nm(nm({},e),{children:e.children.map(function(e){return"string"==typeof e.attrs.id&&i&&i.indexOf(e.attrs.id)>-1?nm(nm({},e),{attrs:nm(nm({},e.attrs),{id:e.attrs.id+t.idSuffix})}):e})}):e}function nT(){return Math.random().toString(36).substring(2,8)}_(nS,"render"),_(nE,"replaceRuntimeIdsAndExtInAttrs"),_(nv,"replaceRuntimeIdsInDefs"),_(nT,"generateShortUuid"),nI.displayName="UniverIcon";var nC={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941 1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941 14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999zM1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641 1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H13.9999C14.3313 6.76641 14.5999 6.49778 14.5999 6.16641 14.5999 5.83504 14.3313 5.56641 13.9999 5.56641H1.9999zM1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334 14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334zM1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004 1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H13.9999C14.3313 14.1004 14.5999 13.8318 14.5999 13.5004 14.5999 13.169 14.3313 12.9004 13.9999 12.9004H1.9999z"}}]},ny=(0,M.forwardRef)(function(e,t){return(0,M.createElement)(nI,Object.assign({},e,{id:"align-text-both-single",ref:t,icon:nC}))});ny.displayName="AlignTextBothSingle";var nb={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941 1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941 14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999zM3.33315 5.56641C3.00178 5.56641 2.73315 5.83504 2.73315 6.16641 2.73315 6.49778 3.00178 6.76641 3.33315 6.76641H12.6665C12.9979 6.76641 13.2665 6.49778 13.2665 6.16641 13.2665 5.83504 12.9979 5.56641 12.6665 5.56641H3.33315zM1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334 14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334zM3.33315 12.9004C3.00178 12.9004 2.73315 13.169 2.73315 13.5004 2.73315 13.8318 3.00178 14.1004 3.33315 14.1004H12.6665C12.9979 14.1004 13.2665 13.8318 13.2665 13.5004 13.2665 13.169 12.9979 12.9004 12.6665 12.9004H3.33315z"}}]},nx=(0,M.forwardRef)(function(e,t){return(0,M.createElement)(nI,Object.assign({},e,{id:"horizontally-single",ref:t,icon:nb}))});nx.displayName="HorizontallySingle";var nR={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941 1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941 14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999zM1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641 1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H11.3332C11.6646 6.76641 11.9332 6.49778 11.9332 6.16641 11.9332 5.83504 11.6646 5.56641 11.3332 5.56641H1.9999zM1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334 14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334zM1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004 1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H11.3332C11.6646 14.1004 11.9332 13.8318 11.9332 13.5004 11.9332 13.169 11.6646 12.9004 11.3332 12.9004H1.9999z"}}]},nO=(0,M.forwardRef)(function(e,t){return(0,M.createElement)(nI,Object.assign({},e,{id:"left-justifying-single",ref:t,icon:nR}))});nO.displayName="LeftJustifyingSingle";var nB={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941 1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941 14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999zM4.66665 5.56641C4.33528 5.56641 4.06665 5.83504 4.06665 6.16641 4.06665 6.49778 4.33528 6.76641 4.66665 6.76641H14C14.3314 6.76641 14.6 6.49778 14.6 6.16641 14.6 5.83504 14.3314 5.56641 14 5.56641H4.66665zM1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334 14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334zM4.66665 12.9004C4.33528 12.9004 4.06665 13.169 4.06665 13.5004 4.06665 13.8318 4.33528 14.1004 4.66665 14.1004H14C14.3314 14.1004 14.6 13.8318 14.6 13.5004 14.6 13.169 14.3314 12.9004 14 12.9004H4.66665z"}}]},nM=(0,M.forwardRef)(function(e,t){return(0,M.createElement)(nI,Object.assign({},e,{id:"right-justifying-single",ref:t,icon:nB}))});nM.displayName="RightJustifyingSingle";var nD={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.96372 2.59116C5.19803 2.35684 5.19803 1.97695 4.96372 1.74263 4.7294 1.50832 4.3495 1.50832 4.11519 1.74263L2.53945 3.31837 1.96372 2.74263C1.7294 2.50832 1.3495 2.50832 1.11519 2.74263.880874 2.97695.880874 3.35684 1.11519 3.59116L2.11519 4.59116C2.3495 4.82547 2.7294 4.82547 2.96372 4.59116L4.96372 2.59116zM14.4605 2.56689H6.8981C6.56672 2.56689 6.2981 2.83552 6.2981 3.16689 6.2981 3.49827 6.56672 3.76689 6.8981 3.76689H14.4605C14.7918 3.76689 15.0605 3.49827 15.0605 3.16689 15.0605 2.83552 14.7918 2.56689 14.4605 2.56689zM6.8981 7.2334C6.56672 7.2334 6.2981 7.50203 6.2981 7.8334 6.2981 8.16477 6.56672 8.4334 6.8981 8.4334H14.4605C14.7918 8.4334 15.0605 8.16477 15.0605 7.8334 15.0605 7.50203 14.7918 7.2334 14.4605 7.2334H6.8981zM6.2981 12.4999C6.2981 12.1685 6.56672 11.8999 6.8981 11.8999H14.4605C14.7918 11.8999 15.0605 12.1685 15.0605 12.4999 15.0605 12.8313 14.7918 13.0999 14.4605 13.0999H6.8981C6.56672 13.0999 6.2981 12.8313 6.2981 12.4999z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.87279 5.8999C1.80504 5.8999.939453 6.76549.939453 7.83324.939453 8.90099 1.80504 9.76657 2.87279 9.76657 3.94054 9.76657 4.80612 8.90099 4.80612 7.83324 4.80612 6.76549 3.94054 5.8999 2.87279 5.8999zM2.13945 7.83324C2.13945 7.42823 2.46778 7.0999 2.87279 7.0999 3.2778 7.0999 3.60612 7.42823 3.60612 7.83324 3.60612 8.23824 3.2778 8.56657 2.87279 8.56657 2.46778 8.56657 2.13945 8.23824 2.13945 7.83324zM.939453 12.5002C.939453 11.4325 1.80504 10.5669 2.87279 10.5669 3.94054 10.5669 4.80612 11.4325 4.80612 12.5002 4.80612 13.568 3.94054 14.4336 2.87279 14.4336 1.80504 14.4336.939453 13.568.939453 12.5002zM2.87279 11.7669C2.46778 11.7669 2.13945 12.0952 2.13945 12.5002 2.13945 12.9052 2.46778 13.2336 2.87279 13.2336 3.2778 13.2336 3.60612 12.9052 3.60612 12.5002 3.60612 12.0952 3.2778 11.7669 2.87279 11.7669z",fillRule:"evenodd",clipRule:"evenodd"}}]},nN=(0,M.forwardRef)(function(e,t){return(0,M.createElement)(nI,Object.assign({},e,{id:"todo-list",ref:t,icon:nD}))});nN.displayName="TodoList";var nP=((c=nP||{})[c.page=0]="page",c[c.section=1]="section",c[c.column=2]="column",c[c.line=3]="line",c[c.divide=4]="divide",c[c.glyph=5]="glyph",c);let nQ={page:0,section:1,column:2,line:3,divide:4,glyph:5};function nU(e,t){return!(e.page>t.page)&&(e.page<t.page||!(e.section>t.section)&&(e.section<t.section||!(e.column>t.column)&&(e.column<t.column||!(e.line>t.line)&&(e.line<t.line||!(e.divide>t.divide)&&(e.divide<t.divide||!(e.glyph>t.glyph)&&(e.glyph,t.glyph,!0))))))}function n_(e,t){return nU(e,t)?{start:e,end:t}:{start:t,end:e}}function nw(e){let t=e.length;if(0===t)return;let n=e[0],i=e[t-1],r=1===e.length&&n.collapsed;return{startOffset:n.startOffset,endOffset:i.endOffset,collapsed:r}}function nL(e,t,n,i){let r=i,a=i;for(let i=0;i<e.length;i++){let o=e[i].count;i<t&&(r+=o),i<n&&(a+=o)}return{startOffset:r,endOffset:a}}function nF(e){let{startX:t,startY:n,endX:i,endY:r}=e,a=[];return a.push({x:t,y:n}),a.push({x:i,y:n}),a.push({x:i,y:r}),a.push({x:t,y:r}),a.push({x:t,y:n}),a}_(nU,"compareNodePositionLogic"),_(n_,"compareNodePosition"),_(nw,"getOneTextSelectionRange"),_(nL,"getOffsetInDivide"),_(nF,"pushToPoints");let nk=class{constructor(e,t){w(this,"_liquid",new p.Liquid),w(this,"_currentStartState",{page:0,section:0,column:0,line:0,divide:0,glyph:0}),w(this,"_currentEndState",{page:0,section:0,column:0,line:0,divide:0,glyph:0}),this._documentOffsetConfig=e,this._docSkeleton=t}getRangePointData(e,t){let n=[],i=[],r=[];if(null==e||null==t)return{borderBoxPointGroup:n,contentBoxPointGroup:i,cursorList:r};if(!this._isValidPosition(e,t))throw Error(`
                Invalid positions in NodePositionConvertToCursor,
                they are not in the same segment page when in header or footer.`);let{start:a,end:o}=n_(e,t);return this._selectionIterator(a,o,(e,t,s,l,A,d)=>{let c,u;let{lineHeight:g,asc:h,paddingTop:m,marginTop:f,marginBottom:I}=d,{glyphGroup:S,st:E}=A;if(0===S.length)return;let{x:v,y:T}=this._liquid,C=S[e],y=S[t],b=S[e-1],x=(null==C?void 0:C.left)||0,R=(null==C?void 0:C.width)||0,O=(null==y?void 0:y.left)||0,B=(null==y?void 0:y.width)||0,M=(null==C?void 0:C.glyphType)===p.GlyphType.LIST,{startOffset:D,endOffset:N}=nL(S,e,t,E),P=a.glyph!==e||!s||a.isBack,Q=o.glyph===t&&!!l&&o.isBack,U=a===o,_=P&&null!=b?b:C;if(0===e&&t===S.length-1)c={startX:v+x+(M?R:0),startY:T,endX:v+O+(Q?0:B),endY:T+g-f-I},u={startX:v+x+(M?R:0),startY:T+m+h-_.bBox.ba,endX:v+O+(Q?0:B),endY:T+m+h+_.bBox.bd};else{let e=P&&!M;c={startX:v+x+(e?0:R),startY:T,endX:v+O+(Q?0:B),endY:T+g-f-I},u={startX:v+x+(e?0:R),startY:T+m+h-_.bBox.ba,endX:v+O+(Q?0:B),endY:T+m+h+_.bBox.bd}}n.push(nF(c)),i.push(nF(u)),r.push({startOffset:P?D:D+C.count,endOffset:Q?N:N+y.count,collapsed:U})}),{borderBoxPointGroup:n,contentBoxPointGroup:i,cursorList:r}}_isValidPosition(e,t){let{segmentPage:n,pageType:i}=e,{segmentPage:r,pageType:a}=t;return i===a&&(i!==p.DocumentSkeletonPageType.HEADER&&i!==p.DocumentSkeletonPageType.FOOTER||n===r)}_resetCurrentNodePositionState(){this._currentStartState={page:0,section:0,column:0,line:0,divide:0,glyph:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,glyph:0}}_setNodePositionState(e=0,t,n,i){i===t?this._currentStartState[e]=1:this._currentStartState[e]=0,i===n?this._currentEndState[e]=2:this._currentEndState[e]=0}_checkPreviousNodePositionState(e,t=!0){let n=e,i;for(;n>=0;){let e;let r=nP[n];if(void 0===(e=t?this._currentStartState[r]:this._currentEndState[r]))return;if(void 0===i&&(i=e),e!==i)return 0;n--}return i}_getSelectionRuler(e,t,n,i,r){let a=0,o=i,s=nP[e],l=nP[e+1];if(null===l||null===s)return{start_next:a,end_next:o};let A=t[s],d=n[s];this._setNodePositionState(s,A,d,r);let c=this._checkPreviousNodePositionState(e),u=this._checkPreviousNodePositionState(e,!1);return 1===c&&(a=t[l]),2===u&&(o=n[l]),{start_next:a,end_next:o}}_selectionIterator(e,t,n){var i,r;let a=this._docSkeleton;if(!a)return[];let{pageType:o,path:s}=e;this._liquid.reset();let l=a.getSkeletonData();if(null==l)return[];let{pages:A,skeHeaders:d,skeFooters:c}=l,{page:u,segmentPage:g}=e,{page:h,segmentPage:m}=t;if(this._resetCurrentNodePositionState(),null==this._documentOffsetConfig)return[];let{pageLayoutType:f,pageMarginLeft:I,pageMarginTop:S}=this._documentOffsetConfig,E=o===p.DocumentSkeletonPageType.BODY||o===p.DocumentSkeletonPageType.CELL?u:g;for(let e=0;e<E;e++){let t=A[e];this._liquid.translatePage(t,f,I,S)}let v=o===p.DocumentSkeletonPageType.BODY||o===p.DocumentSkeletonPageType.CELL?h:m;for(let a=E;a<=v;a++){let u=A[a],{headerId:g,footerId:h,pageWidth:m}=u,T=u;if(o===p.DocumentSkeletonPageType.HEADER?T=null==(i=d.get(g))?void 0:i.get(m):o===p.DocumentSkeletonPageType.FOOTER?T=null==(r=c.get(h))?void 0:r.get(m):o===p.DocumentSkeletonPageType.CELL&&(T=(0,p.getPageFromPath)(l,s)),null==T){this._liquid.translatePage(u,f,I,S);continue}let C=T.sections,{start_next:y,end_next:b}=this._getSelectionRuler(nQ.page,e,t,C.length-1,o===p.DocumentSkeletonPageType.BODY||o===p.DocumentSkeletonPageType.CELL?a:0);switch(this._liquid.translateSave(),o){case p.DocumentSkeletonPageType.HEADER:this._liquid.translatePagePadding({...T,marginLeft:u.marginLeft});break;case p.DocumentSkeletonPageType.FOOTER:{let e=u.pageHeight-T.height-T.marginBottom;this._liquid.translate(u.marginLeft,e);break}case p.DocumentSkeletonPageType.CELL:{this._liquid.translatePagePadding(u);let e=T.parent,t=e.parent,{left:n}=T,{top:i,left:r}=t,{top:a}=e;this._liquid.translate(r+n,i+a),this._liquid.translatePagePadding(T);break}default:this._liquid.translatePagePadding(u)}for(let i=y;i<=b;i++){let r=C[i],o=r.columns,{start_next:s,end_next:l}=this._getSelectionRuler(nQ.section,e,t,o.length-1,i);this._liquid.translateSection(r);for(let A=s;A<=l;A++){let d=o[A],c=d.lines,{start_next:u,end_next:g}=this._getSelectionRuler(nQ.column,e,t,c.length-1,A);this._liquid.translateColumn(d);for(let o=u;o<=g;o++){let h=c[o],{divides:p}=h,{start_next:m,end_next:f}=this._getSelectionRuler(nQ.line,e,t,p.length-1,o);this._liquid.translateSave(),this._liquid.translateLine(h,!0,!1);for(let c=m;c<=f;c++){let I=p[c];this._liquid.translateSave(),this._liquid.translateDivide(I);let{glyphGroup:S}=I,{start_next:C,end_next:x}=this._getSelectionRuler(nQ.divide,e,t,S.length-1,c),R=!1,O=!1;a===E&&i===y&&A===s&&o===u&&c===m&&(R=!0),a===v&&i===b&&A===l&&o===g&&c===f&&(O=!0),n&&n(C,x,R,O,I,h,d,r,T),this._liquid.translateRestore()}this._liquid.translateRestore()}}}this._liquid.translateRestore(),this._liquid.translatePage(u,f,I,S)}}};_(nk,"NodePositionConvertToCursor");let nH=nk;function nV(e,t){let{path:n}=e,{path:i}=t;if(n.length!==i.length||-1===n.indexOf("cells"))return!1;let r=n.indexOf("skeTables")+1,a=n.indexOf("rows")+1,o=n.indexOf("cells")+1;if((0,p.getTableIdAndSliceIndex)(n[r]).tableId!==(0,p.getTableIdAndSliceIndex)(i[r]).tableId)return!1;let s=n[a],l=i[a],A=n[o],d=i[o];return!(s===l&&A===d)}function nj(e,t){let{path:n}=e,{path:i}=t;return -1!==n.indexOf("cells")&&-1!==i.indexOf("cells")&&(0,g.Tools).diffValue(n,i)}function nW(e,t){if(nj(e,t))return nU(e,t);let{path:n}=e,{path:i}=t,r=n[n.length-5],a=i[i.length-5];if(r!==a&&"string"==typeof r&&"string"==typeof a)return+r.split("#-#")[1]<+a.split("#-#")[1];let o=n[n.length-3],s=i[i.length-3],l=n[n.length-1],A=i[i.length-1];return o<s||!(o>s)&&l<=A}function nz(e){return e.sections[0].columns[0].lines[0].divides[0].glyphGroup[0]}function nG(e){let{sections:t}=e,n=t[t.length-1],i=n.columns[n.columns.length-1],r=i.lines[i.lines.length-1],a=r.divides[r.divides.length-1].glyphGroup;return a[a.length-2]}_(nV,"isValidRectRange"),_(nj,"isInSameTableCell"),_(nW,"compareNodePositionInTable"),_(nz,"firstGlyphInCellPage"),_(nG,"lastGlyphInCellPage");let nY=class{constructor(e,t){w(this,"_liquid",new p.Liquid),this._documentOffsetConfig=e,this._docSkeleton=t}getRangePointData(e,t){let n=[],i=this._docSkeleton.getSkeletonData();if(null==i)return;let{pages:r}=i,{segmentPage:a,page:o,pageType:s}=e,{segmentPage:l,page:A}=t,d=this._getTableRectRangeInfo(e,t);if(null==d)return;let{tableId:c,startRowIndex:u,startColumnIndex:g,endRowIndex:h,endColumnIndex:m}=d;this._liquid.reset();let{pageLayoutType:f,pageMarginLeft:I,pageMarginTop:S}=this._documentOffsetConfig,E=s===p.DocumentSkeletonPageType.BODY||s===p.DocumentSkeletonPageType.CELL?o:a;for(let e=0;e<E;e++){let t=r[e];this._liquid.translatePage(t,f,I,S)}let v=s===p.DocumentSkeletonPageType.BODY||s===p.DocumentSkeletonPageType.CELL?A:l;for(let e=E;e<=v;e++){let t=r[e];this._liquid.translatePagePadding(t);let{skeTables:i}=t,a=null;for(let[e,t]of i.entries())e.startsWith(c)&&(a=t);if(null==a){this._liquid.restorePagePadding(t),this._liquid.translatePage(t,f,I,S);continue}this._liquid.translateSave(),this._liquid.translate(0,a.top);let{x:o,y:s}=this._liquid;for(let e of a.rows)if(e.index>=u&&e.index<=h){let t=e.cells[g],i=e.cells[m],r={startX:o+t.left,startY:s+e.top,endX:o+i.left+i.pageWidth,endY:s+e.top+e.height};n.push(nF(r))}this._liquid.translateRestore(),this._liquid.restorePagePadding(t),this._liquid.translatePage(t,f,I,S)}return{pointGroup:n,startRow:u,startColumn:g,endRow:h,endColumn:m,tableId:c}}getNodePositionGroup(e,t){let n=[],i=nW(e,t),r=i?e:t,a=i?t:e,{segmentPage:o}=r,s=this._getTableRectRangeInfo(r,a);if(null==s)return;let{tableId:l,pages:A,startRowIndex:d,startColumnIndex:c,endRowIndex:u,endColumnIndex:g}=s,h=[];for(let e of A){let{skeTables:t}=e;for(let[e,n]of t.entries())e.startsWith(l)&&h.push(n)}if(0===h.length)return;let p=h[0].rows[0].cells.length;if(0===c&&g===p-1)return n.push({anchor:e,focus:t}),n;for(let e of h)this._collectPositionGroup(e,n,d,u,c,g,o,i);return n}_collectPositionGroup(e,t,n,i,r,a,o,s){for(let l=0;l<e.rows.length;l++){let A=e.rows[l];if(A.index<n)continue;if(A.index>i)break;let d=A.cells[r],c=A.cells[a],u=nz(d),g=nG(c);if(null==u||null==g)continue;let h=this._docSkeleton.findPositionByGlyph(u,o),p=this._docSkeleton.findPositionByGlyph(g,o);if(null==h||null==p)continue;let m=s?h:p,f=s?p:h;t.push({anchor:{...m,isBack:!0},focus:{...f,isBack:!0}})}}_getTableRectRangeInfo(e,t){let n=this._docSkeleton.getSkeletonData();if(null==n)return;let{pages:i}=n,{path:r}=e,{path:a}=t,o=(0,p.getPageFromPath)(n,r),s=(0,p.getPageFromPath)(n,a);if(null==o||null==s)return;let l=o.segmentId,A=o.parent.index,d=o.parent.cells.indexOf(o),c=(null==s?void 0:s.parent).index,u=(null==s?void 0:s.parent).cells.indexOf(s);return{pages:i,tableId:l,startCell:o,endCell:s,startRowIndex:A,startColumnIndex:d,endRowIndex:c,endColumnIndex:u}}};function nK(e){let t=e[0],n=t[0],i=t[2],{x:r,y:a}=n,{x:o,y:s}=i;return{left:r,top:a,width:o-r,height:s-a}}function nq(e){return e.map(e=>{let t=1/0,n=-1/0,i=1/0,r=-1/0;return e.forEach(e=>{t=Math.min(e.x,t),n=Math.max(e.x,n),r=Math.max(e.y,r),i=Math.min(e.y,i)}),{left:t,right:n,top:i,bottom:r}})}_(nY,"NodePositionConvertToRectRange"),_(nK,"getAnchorBounding"),_(nq,"getLineBounding");let nX=class{constructor(e,t,n,i,r,a=p.NORMAL_TEXT_SELECTION_PLUGIN_STYLE,o="",s=-1){w(this,"rangeType",g.DOC_RANGE_TYPE.TEXT),w(this,"_current",!1),w(this,"_rangeShape"),w(this,"_anchorShape"),w(this,"_cursorList",[]),w(this,"_anchorBlinkTimer",null),this._scene=e,this._document=t,this._docSkeleton=n,this.anchorNodePosition=i,this.focusNodePosition=r,this.style=a,this._segmentId=o,this._segmentPage=s,this._anchorBlink(),this.refresh()}_anchorBlink(){setTimeout(()=>{this._anchorShape&&this._anchorShape.visible&&this.deactivateStatic()},500),this._anchorBlinkTimer=setInterval(()=>{this._anchorShape&&this._anchorShape.visible&&(this.activeStatic(),setTimeout(()=>{this.deactivateStatic()},500))},1e3)}get startOffset(){var e;let{startOffset:t}=null!=(e=nw(this._cursorList))?e:{},n=this._docSkeleton.getViewModel().getDataModel().getSelfOrHeaderFooterModel(this._segmentId).getBody();return null==t||null==n?t:Math.min(n.dataStream.length-2,t)}get endOffset(){var e;let{endOffset:t}=null!=(e=nw(this._cursorList))?e:{},n=this._docSkeleton.getViewModel().getDataModel().getSelfOrHeaderFooterModel(this._segmentId).getBody();return null==t||null==n?t:Math.min(t,n.dataStream.length-2)}get collapsed(){let{startOffset:e,endOffset:t}=this;return null!=e&&e===t}get startNodePosition(){if(null==this.anchorNodePosition)return null;if(null==this.focusNodePosition)return this.anchorNodePosition;let{start:e}=n_(this.anchorNodePosition,this.focusNodePosition);return e}get endNodePosition(){if(null==this.anchorNodePosition)return this.focusNodePosition;if(null==this.focusNodePosition)return null;let{end:e}=n_(this.anchorNodePosition,this.focusNodePosition);return e}get direction(){let{collapsed:e,anchorNodePosition:t,focusNodePosition:n}=this;return e||null==t||null==n?g.RANGE_DIRECTION.NONE:nU(t,n)?g.RANGE_DIRECTION.FORWARD:g.RANGE_DIRECTION.BACKWARD}get segmentId(){return this._segmentId}get segmentPage(){return this._segmentPage}getAbsolutePosition(){let e=this.anchorNodePosition,t=this.focusNodePosition;if(this._isEmpty())return;let n=this._document.getOffsetConfig(),{docsLeft:i,docsTop:r}=n,a=new nH(n,this._docSkeleton);if(this._isCollapsed()){let{contentBoxPointGroup:t,cursorList:n}=a.getRangePointData(e,e);if(this._setCursorList(n),0===t.length)return;let o=nK(t);return{...o,left:o.left+i,top:o.top+r}}let{borderBoxPointGroup:o,cursorList:s}=a.getRangePointData(e,t);if(this._setCursorList(s),0===o.length)return;let l=nK(o);return{...l,left:l.left+i,top:l.top+r}}getAnchor(){return this._anchorShape}activeStatic(){var e,t;null==(t=this._anchorShape)||t.setProps({stroke:(null==(e=this.style)?void 0:e.strokeActive)||(0,p.getColor)(g.COLORS.black,1)})}deactivateStatic(){var e,t;null==(t=this._anchorShape)||t.setProps({stroke:(null==(e=this.style)?void 0:e.stroke)||(0,p.getColor)(g.COLORS.black,0)})}isActive(){return!0===this._current}activate(){this._current=!0}deactivate(){this._current=!1}dispose(){var e,t;null==(e=this._rangeShape)||e.dispose(),this._rangeShape=null,null==(t=this._anchorShape)||t.dispose(),this._anchorShape=null,this._anchorBlinkTimer&&(clearInterval(this._anchorBlinkTimer),this._anchorBlinkTimer=null)}isIntersection(e){let{startOffset:t,endOffset:n}=this,{startOffset:i,endOffset:r}=e;return null!=t&&null!=n&&null!=i&&null!=r&&t<=r&&n>=i}refresh(){var e,t;let{_document:n,_docSkeleton:i}=this,r=this.anchorNodePosition,a=this.focusNodePosition;if(null==(e=this._anchorShape)||e.hide(),null==(t=this._rangeShape)||t.hide(),this._isEmpty())return;let o=n.getOffsetConfig(),{docsLeft:s,docsTop:l}=o,A=new nH(o,i);if(this._isCollapsed()){let{contentBoxPointGroup:e,cursorList:t}=A.getRangePointData(r,r);if(this._setCursorList(t),e.length>0){let t=i.findGlyphByPosition(r);this._createOrUpdateAnchor(e,s,l,t)}return}let{borderBoxPointGroup:d,cursorList:c}=A.getRangePointData(r,a);this._setCursorList(c),d.length>0&&this._createOrUpdateRange(d,s,l)}_isEmpty(){return null==this.anchorNodePosition&&null==this.focusNodePosition}_isCollapsed(){let e=this.anchorNodePosition,t=this.focusNodePosition;if(null!=e&&null==t)return!0;if(null==e||null==t)return!1;for(let n of Object.keys(nQ))if(e[n]!==t[n])return!1;return e.isBack===t.isBack}_createOrUpdateRange(e,t,n){var i;if(this._rangeShape){this._rangeShape.translate(t,n),this._rangeShape.updatePointGroup(e),this._rangeShape.show();return}let r=new p.RegularPolygon("__TestSelectionRange__"+(0,g.Tools).generateRandomId(6),{pointsGroup:e,fill:(null==(i=this.style)?void 0:i.fill)||(0,p.getColor)(g.COLORS.black,.3),left:t,top:n,evented:!1,debounceParentDirty:!1});this._rangeShape=r,this._scene.addObject(r,3)}_createOrUpdateAnchor(e,t,n,i){var r,a,o;let s=nK(e),{left:l}=s,{top:A,height:d}=s;d<14&&(A-=14-d,d=14);let c=l+t,u=A+n,h=(null==(r=null==i?void 0:i.ts)?void 0:r.it)===g.BooleanNumber.TRUE;if(h&&(c+=d*Math.tan(12*Math.PI/180)/2),this._anchorShape){this._anchorShape.transformByState({left:c,top:u,height:d}),this._anchorShape.show(),h?this._anchorShape.skew(-12,0):this._anchorShape.skew(0,0);return}let m=new p.Rect("__TestSelectionAnchor__"+(0,g.Tools).generateRandomId(6),{left:c,top:u,height:d,strokeWidth:(null==(a=this.style)?void 0:a.strokeWidth)||1.5,stroke:(null==(o=this.style)?void 0:o.strokeActive)||(0,p.getColor)(g.COLORS.black,1),evented:!1});h&&m.skew(-12,0),this._anchorShape=m,this._scene.addObject(m,3)}_setCursorList(e){0!==e.length&&(this._cursorList=e)}};function nJ(e,t,n,i,r,a=p.NORMAL_TEXT_SELECTION_PLUGIN_STYLE,o="",s=-1){let l=new nY(t.getOffsetConfig(),n).getNodePositionGroup(i,r);return(null!=l?l:[]).map(i=>new n$(e,t,n,i.anchor,i.focus,a,o,s))}_(nX,"TextRange"),_(nJ,"convertPositionsToRectRanges");let nZ=class{constructor(e,t,n,i,r,a=p.NORMAL_TEXT_SELECTION_PLUGIN_STYLE,o="",s=-1){w(this,"rangeType",g.DOC_RANGE_TYPE.RECT),w(this,"_rangeShape"),w(this,"_current",!1),w(this,"_startRow"),w(this,"_startCol"),w(this,"_endRow"),w(this,"_endCol"),w(this,"_tableId"),this._scene=e,this._document=t,this._docSkeleton=n,this.anchorNodePosition=i,this.focusNodePosition=r,this.style=a,this._segmentId=o,this._segmentPage=s,this.refresh()}get startOffset(){let{startNodePosition:e}=this;return this._docSkeleton.findCharIndexByPosition(e)}get endOffset(){let{endNodePosition:e}=this;return this._docSkeleton.findCharIndexByPosition(e)}get collapsed(){return!1}get startRow(){return this._startRow}get startColumn(){return this._startCol}get endRow(){return this._endRow}get endColumn(){return this._endCol}get tableId(){return this._tableId}get segmentId(){return this._segmentId}get segmentPage(){return this._segmentPage}get spanEntireRow(){var e;let t=null==(e=this._docSkeleton.getViewModel().getSnapshot().tableSource)?void 0:e[this._tableId],{_startCol:n,_endCol:i}=this;if(null==t)throw Error("Table is not found.");let{tableColumns:r}=t;return 0===n&&i===r.length-1}get spanEntireColumn(){var e;let t=null==(e=this._docSkeleton.getViewModel().getSnapshot().tableSource)?void 0:e[this._tableId],{_startRow:n,_endRow:i}=this;if(null==t)throw Error("Table is not found.");let{tableRows:r}=t;return 0===n&&i===r.length-1}get spanEntireTable(){return this.spanEntireRow&&this.spanEntireColumn}get startNodePosition(){let{anchorNodePosition:e,focusNodePosition:t}=this;return nW(e,t)?e:t}get endNodePosition(){let{anchorNodePosition:e,focusNodePosition:t}=this;return nW(e,t)?t:e}get direction(){let{anchorNodePosition:e,focusNodePosition:t}=this;return nW(e,t)?g.RANGE_DIRECTION.FORWARD:g.RANGE_DIRECTION.BACKWARD}isActive(){return!0===this._current}activate(){this._current=!0}deactivate(){this._current=!1}dispose(){var e;null==(e=this._rangeShape)||e.dispose(),this._rangeShape=null}isIntersection(e){let{startRow:t,startColumn:n,endRow:i,endColumn:r}=this,{startRow:a,startColumn:o,endRow:s,endColumn:l}=e;return(0,g.Rectangle).hasIntersectionBetweenTwoRect({left:n,top:t,right:r,bottom:i},{left:o,top:a,right:l,bottom:s})}refresh(){var e;null==(e=this._rangeShape)||e.hide();let{startNodePosition:t,endNodePosition:n,_document:i,_docSkeleton:r}=this,a=i.getOffsetConfig(),{docsLeft:o,docsTop:s}=a,l=new nY(a,r).getRangePointData(t,n);if(null==l)return;let{pointGroup:A=[],startRow:d,endRow:c,startColumn:u,endColumn:g,tableId:h}=l;(null==A?void 0:A.length)>0&&this._createOrUpdateRange(A,o,s),this._updateTableInfo(d,c,u,g,h)}_updateTableInfo(e,t,n,i,r){this._startRow=e,this._endRow=t,this._startCol=n,this._endCol=i,this._tableId=r}_createOrUpdateRange(e,t,n){var i;if(this._rangeShape){this._rangeShape.translate(t,n),this._rangeShape.updatePointGroup(e),this._rangeShape.show();return}let r=new p.RegularPolygon("__DocTableRectRange__"+(0,g.Tools).generateRandomId(6),{pointsGroup:e,fill:(null==(i=this.style)?void 0:i.fill)||(0,p.getColor)(g.COLORS.black,.3),left:t,top:n,evented:!1,debounceParentDirty:!1});this._rangeShape=r,this._scene.addObject(r,3)}};_(nZ,"RectRange");let n$=nZ;function n0(e,t,n,i,r,a,o,s){let l=r.findNodePositionByCharIndex(e,!0,o,s),A=r.findNodePositionByCharIndex(t,!0,o,s);if(!(null==l||null==A))return new nX(n,i,r,l,A,a,o,s)}function n1(e,t,n,i,r,a,o,s){let l=r.findNodePositionByCharIndex(e,!0,o,s),A=r.findNodePositionByCharIndex(t,!0,o,s);if(!(null==l||null==A))return new n$(n,i,r,l,A,a,o,s)}function n9(e,t,n,i,r,a,o,s){let l=r.findNodePositionByCharIndex(e,!0,o,s),A=r.findNodePositionByCharIndex(t,!0,o,s);if(!(null==l||null==A))return n3(l,A,n,i,r,a,o,s)}function n3(e,t,n,i,r,a,o,s){let l=[],A=[],d=[n,i,r,e,t,a,o,s];if(nj(e,t))return l.push(new nX(...d)),{textRanges:l,rectRanges:A};if(nV(e,t)){let e=nJ(...d);return A.push(...e),{textRanges:l,rectRanges:A}}let c=r.getViewModel().getSelfOrHeaderFooterViewModel(o),u=r.findCharIndexByPosition(e),h=r.findCharIndexByPosition(t);if(null==u||null==h)return;let p=u<=h?g.RANGE_DIRECTION.FORWARD:g.RANGE_DIRECTION.BACKWARD,m=Math.min(u,h),f=Math.max(u,h),I=m,S=f;for(let e of c.children)for(let t of e.children){let{startIndex:e,endIndex:d,children:c}=t,u=c[0],h=!1;if(u){let{startIndex:e,endIndex:t,children:d}=u,c=null,E=null,v=d.find(e=>e.startIndex<=m&&e.endIndex>=m),T=d.find(e=>e.startIndex<=f&&e.endIndex>=f);if(m>e&&m<t)c=r.findNodePositionByCharIndex(v.startIndex+2,!0,o,s),E=r.findNodePositionByCharIndex(t-4,!0,o,s),I=t+1;else if(f>e&&f<t)c=r.findNodePositionByCharIndex(e+3,!0,o,s),E=r.findNodePositionByCharIndex(T.endIndex-3,!0,o,s),S=e-1,h=!0;else if(e>m&&t<f){if(c=r.findNodePositionByCharIndex(e+3,!0,o,s),E=r.findNodePositionByCharIndex(t-4,!0,o,s),I<=e-1){let t=r.findNodePositionByCharIndex(I,!0,o,s),A=r.findNodePositionByCharIndex(e-1,!1,o,s),d=p===g.RANGE_DIRECTION.FORWARD?t:A,c=p===g.RANGE_DIRECTION.FORWARD?A:t;l.push(new nX(n,i,r,d,c,a,o,s))}I=t+1}if(c&&E){let e=p===g.RANGE_DIRECTION.FORWARD?c:E,t=p===g.RANGE_DIRECTION.FORWARD?E:c;A.push(...nJ(n,i,r,e,t,a,o,s))}}if(S>=e&&S<=d||h){let e=r.findNodePositionByCharIndex(I,!0,o,s),t=r.findNodePositionByCharIndex(S,!h,o,s),d=p===g.RANGE_DIRECTION.FORWARD?e:t,c=p===g.RANGE_DIRECTION.FORWARD?t:e;if(A.length&&(0,g.Tools).diffValue(d,c))continue;l.push(new nX(n,i,r,d,c,a,o,s))}}return{textRanges:l,rectRanges:A}}function n2(e){let t=null==e?void 0:e.getCanvasElement();if(!t)return{left:0,top:0};let{top:n,left:i}=(0,p.getOffsetRectForDom)(t);return{left:i,top:n}}function n4(e){var t;let n=null==(t=e.parent)?void 0:t.parent,i=null==n?void 0:n.parent;if(null==n||null==i)return;let{paragraphIndex:r}=n,a=i.lines.filter(e=>e.paragraphIndex===r),o=-1,s="",l=!1;for(let t of a)for(let n of t.divides)for(let t of n.glyphGroup)l||(o+=t.count),t===e&&(l=!0),s+=t.count>0?t.content:"";return{st:a[0].st,ed:r,content:s,nodeIndex:o}}function n8(e){let{startOffset:t,endOffset:n,collapsed:i,rangeType:r,startNodePosition:a,endNodePosition:o,direction:s,segmentId:l,segmentPage:A}=e;return{startOffset:t,endOffset:n,collapsed:i,rangeType:r,startNodePosition:a,endNodePosition:o,direction:s,segmentId:l,segmentPage:A,isActive:e.isActive()}}function n6(e){let t=n8(e),{startRow:n,startColumn:i,endRow:r,endColumn:a,tableId:o,spanEntireRow:s,spanEntireColumn:l,spanEntireTable:A}=e;return{...t,startRow:n,startColumn:i,endRow:r,endColumn:a,tableId:o,spanEntireRow:s,spanEntireColumn:l,spanEntireTable:A}}_(n0,"getTextRangeFromCharIndex"),_(n1,"getRectRangeFromCharIndex"),_(n9,"getRangeListFromCharIndex"),_(n3,"getRangeListFromSelection"),_(n2,"getCanvasOffsetByEngine"),_(n4,"getParagraphInfoByGlyph"),_(n8,"serializeTextRange"),_(n6,"serializeRectRange");var n5,n7,ie,it=Object.defineProperty,ii=Object.getOwnPropertyDescriptor,ir=/* @__PURE__ */_((e,t,n,i)=>{for(var r,a=i>1?void 0:i?ii(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&it(t,n,a),a},"__decorateClass$o"),ia=/* @__PURE__ */_((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$o");let io=(_(ie=class extends g.RxDisposable{constructor(e,t,n,i){super(),w(this,"_onInputBefore$",new x.Subject),w(this,"onInputBefore$",this._onInputBefore$.asObservable()),w(this,"_onKeydown$",new I.BehaviorSubject(null)),w(this,"onKeydown$",this._onKeydown$.asObservable()),w(this,"_onInput$",new I.BehaviorSubject(null)),w(this,"onInput$",this._onInput$.asObservable()),w(this,"_onCompositionstart$",new I.BehaviorSubject(null)),w(this,"onCompositionstart$",this._onCompositionstart$.asObservable()),w(this,"_onCompositionupdate$",new I.BehaviorSubject(null)),w(this,"onCompositionupdate$",this._onCompositionupdate$.asObservable()),w(this,"_onCompositionend$",new I.BehaviorSubject(null)),w(this,"onCompositionend$",this._onCompositionend$.asObservable()),w(this,"_onSelectionStart$",new I.BehaviorSubject(null)),w(this,"onSelectionStart$",this._onSelectionStart$.asObservable()),w(this,"_onPaste$",new x.Subject),w(this,"onPaste$",this._onPaste$.asObservable()),w(this,"_textSelectionInner$",new I.BehaviorSubject(null)),w(this,"textSelectionInner$",this._textSelectionInner$.asObservable()),w(this,"_onFocus$",new x.Subject),w(this,"onFocus$",this._onFocus$.asObservable()),w(this,"_onBlur$",new x.Subject),w(this,"onBlur$",this._onBlur$.asObservable()),w(this,"_onPointerDown$",new x.Subject),w(this,"onPointerDown$",this._onPointerDown$.asObservable()),w(this,"_container"),w(this,"_inputParent"),w(this,"_input"),w(this,"_scrollTimers",[]),w(this,"_rangeList",[]),w(this,"_rangeListCache",[]),w(this,"_rectRangeList",[]),w(this,"_rectRangeListCache",[]),w(this,"_anchorNodePosition",null),w(this,"_focusNodePosition",null),w(this,"_currentSegmentId",""),w(this,"_currentSegmentPage",-1),w(this,"_selectionStyle",p.NORMAL_TEXT_SELECTION_PLUGIN_STYLE),w(this,"_viewPortObserverMap",/* @__PURE__ */new Map),w(this,"_isIMEInputApply",!1),w(this,"_scenePointerMoveSubs",[]),w(this,"_scenePointerUpSubs",[]),w(this,"_editorFocusing",!0),this._context=e,this._layoutService=t,this._logService=n,this._docSkeletonManagerService=i,this._initDOM(),this._registerContainer(),this._setSystemHighlightColorToStyle()}get activeViewPort(){return this._context.scene.getViewports()[0]}setSegment(e){this._currentSegmentId=e}getSegment(){return this._currentSegmentId}setSegmentPage(e){this._currentSegmentPage=e}getSegmentPage(){return this._currentSegmentPage}_setRangeStyle(e=p.NORMAL_TEXT_SELECTION_PLUGIN_STYLE){this._selectionStyle=e}addDocRanges(e,t=!0,n){let{_currentSegmentId:i,_currentSegmentPage:r,_selectionStyle:a}=this,{scene:o,mainComponent:s}=this._context,l=this._docSkeletonManagerService.getSkeleton();for(let t of e){let{startOffset:e,endOffset:n,rangeType:A}=t;if(A===g.DOC_RANGE_TYPE.RECT){let t=n1(e,n,o,s,l,a,i,r);t&&this._addRectRanges([t])}else if(A===g.DOC_RANGE_TYPE.TEXT){let t=n0(e,n,o,s,l,a,i,r);t&&this._addTextRange(t)}else{let t=n9(e,n,o,s,l,a,i,r);if(null==t)continue;let{textRanges:A,rectRanges:d}=t;for(let e of A)this._addTextRange(e);this._addRectRanges(d)}}this._textSelectionInner$.next({textRanges:this._getAllTextRanges(),rectRanges:this._getAllRectRanges(),segmentId:i,segmentPage:r,style:a,isEditing:t,options:n}),this._updateInputPosition(null==n?void 0:n.forceFocus)}setCursorManually(e,t){let n=this._findNodeByCoord(e,t,{strict:!0,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage}),i=this._getNodePosition(n);if(null==i){this._removeAllRanges();return}(null==n?void 0:n.node.streamType)===g.DataStreamTreeTokenType.PARAGRAPH&&(i.isBack=!0),this._createTextRangeByAnchorPosition(i),this._textSelectionInner$.next({textRanges:this._getAllTextRanges(),rectRanges:this._getAllRectRanges(),segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage,style:this._selectionStyle,isEditing:!1})}sync(){this._updateInputPosition()}activate(e,t,n=!1){let i=this._input===document.activeElement;this._container.style.left=`${e}px`,this._container.style.top=`${t}px`,this._container.style.zIndex="1000",(i||n)&&this.focus()}hasFocus(){return document.activeElement===this._input}focus(){this._editorFocusing&&this._input.focus()}blur(){this._input.blur()}focusEditor(){this._editorFocusing=!0,this.focus()}blurEditor(){this._editorFocusing=!1,this.blur()}deactivate(){this._container.style.left="0px",this._container.style.top="0px"}__handleDblClick(e){let{offsetX:t,offsetY:n}=e,i=this._findNodeByCoord(t,n,{strict:!1,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage});if(null==i||null==i.node)return;let r=n4(i.node);if(null==r)return;let{content:a,st:o,nodeIndex:s}=r;if(-1===s||null==Intl.Segmenter)return;let l=new Intl.Segmenter(void 0,{granularity:"word"}).segment(a),A=Number.NEGATIVE_INFINITY,d=Number.NEGATIVE_INFINITY;for(let{segment:e,index:t,isWordLike:n}of l)if(t<=s&&s<t+e.length&&n){A=t+o,d=t+o+e.length;break}if(Number.isFinite(A)&&Number.isFinite(d)){this.removeAllRanges();let e=[{startOffset:A,endOffset:d}];this.addDocRanges(e,!1,{forceFocus:!0})}}__handleTripleClick(e){let{offsetX:t,offsetY:n}=e,i=this._findNodeByCoord(t,n,{strict:!1,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage});if(null==i||null==i.node)return;let r=n4(i.node);if(null==r)return;this.removeAllRanges();let{st:a,ed:o}=r;this.addDocRanges([{startOffset:a,endOffset:o}],!1,{forceFocus:!0})}__onPointDown(e){var t,n;this._editorFocusing=!0;let{scene:i,mainComponent:r}=this._context,a=this._docSkeletonManagerService.getSkeleton(),{offsetX:o,offsetY:s}=e,l=this._findNodeByCoord(o,s,{strict:!1,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage}),A=this._getNodePosition(l);if(null==A||null==l){this._removeAllRanges();return}(null==l?void 0:l.node.streamType)===g.DataStreamTreeTokenType.PARAGRAPH&&(A.isBack=!0);let d=this._textSelectionInner$.value;if(l&&2===e.button&&d){let e=a.findCharIndexByPosition(A);if("number"==typeof e&&d.textRanges.some(t=>t.startOffset<=e&&t.endOffset>e)||"number"==typeof e&&d.rectRanges.some(t=>t.startOffset<=e&&t.endOffset>=e))return}let{segmentId:c,segmentPage:u}=l;c&&this._currentSegmentId&&c!==this._currentSegmentId&&this.setSegment(c),c&&u!==this._currentSegmentPage&&this.setSegmentPage(u),this._anchorNodePosition=A,e.shiftKey&&this._getActiveRangeInstance()?this._updateActiveRangePosition(A):e.ctrlKey||this._isEmpty()||this._removeAllRanges(),i.disableObjectsEvent();let h=(0,p.ScrollTimer).create(i);this._scrollTimers.push(h),h.startScroll(o,s),this._onSelectionStart$.next(null==(t=this._getActiveRangeInstance())?void 0:t.startNodePosition),null==(n=i.getTransformer())||n.clearSelectedObjects();let m=o,f=s;this._scenePointerMoveSubs.push(i.onPointerMove$.subscribeEvent(e=>{let{offsetX:t,offsetY:n}=e;i.setCursor(p.CURSOR_TYPE.TEXT),3>Math.sqrt((t-m)**2+(n-f)**2)||(this._moving(t,n),h.scrolling(t,n,()=>{this._moving(t,n)}),m=t,f=n)})),this._scenePointerUpSubs.push(i.onPointerUp$.subscribeEvent(()=>{if([...this._scenePointerMoveSubs,...this._scenePointerUpSubs].forEach(e=>{e.unsubscribe()}),i.enableObjectsEvent(),this._anchorNodePosition&&!this._focusNodePosition){let e=new nX(i,r,a,this._anchorNodePosition,void 0,this._selectionStyle,this._currentSegmentId,this._currentSegmentPage);this._addTextRange(e)}else if(this._anchorNodePosition&&this._focusNodePosition){for(let e of this._rangeListCache)this._addTextRange(e);this._addRectRanges(this._rectRangeListCache),this._rangeListCache=[],this._rectRangeListCache=[]}this._anchorNodePosition=null,this._focusNodePosition=null;let e={textRanges:this._getAllTextRanges(),rectRanges:this._getAllRectRanges(),segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage,style:this._selectionStyle,isEditing:!1};this._textSelectionInner$.next(e),this._scrollTimers.forEach(e=>{null==e||e.dispose()}),this._scrollTimers=[],this._updateInputPosition(!0)}))}removeAllRanges(){this._removeAllRanges(),this.deactivate()}getActiveTextRange(){return this._getActiveRangeInstance()}_setSystemHighlightColorToStyle(){let{r:e,g:t,b:n,a:i}=(0,p.getSystemHighlightColor)(),r={strokeWidth:1.5,stroke:"rgba(0, 0, 0, 0)",strokeActive:"rgba(0, 0, 0, 1)",fill:`rgba(${e}, ${t}, ${n}, ${null!=i?i:.3})`};this._setRangeStyle(r)}_getAllTextRanges(){return this._rangeList.map(n8)}_getAllRectRanges(){return this._rectRangeList.map(n6)}_getActiveRange(){let e=this._rangeList.find(e=>e.isActive());if(null==e)return null;let{startOffset:t,endOffset:n}=e;return null==t||null==n?null:n8(e)}_getActiveRangeInstance(){return this._rangeList.find(e=>e.isActive())}dispose(){super.dispose(),this._detachEvent(),this._removeAllRanges(),this._container.remove()}_initDOM(){let{unitId:e}=this._context,t=document.createElement("div");t.style.position="fixed",t.style.left="0px",t.style.top="0px",t.id=`univer-doc-selection-container-${e}`;let n=document.createElement("div"),i=document.createElement("div");n.appendChild(i),t.appendChild(n),this._container=t,this._inputParent=n,this._input=i,this._initInput(),this._initInputEvents(),document.body.appendChild(t)}_registerContainer(){this.disposeWithMe(this._layoutService.registerContainerElement(this._container))}_initInput(){this._inputParent.style.cssText=`
            position:absolute;
            height:1px;
            width:1px;
            overflow: hidden;
        `,this._input.contentEditable="true",this._input.classList.add("univer-editor"),this._input.style.cssText=`
            position: absolute;
            overflow: hidden;
            opacity: 1;
            background: #000;
            color: transparent;
            outline: none;
            z-index: -2;
            caret-color: transparent;
            white-space: pre-wrap;
            user-select: text;
        `}_getNodePosition(e){if(null==e)return;let{node:t,ratioX:n,segmentPage:i}=e,r=this._docSkeletonManagerService.getSkeleton().findPositionByGlyph(t,i);if(null!=r)return{...r,isBack:n<.5}}_interactTextRanges(e){let t=[];for(let n of this._rangeList){if(e.some(e=>e.isIntersection(n))){n.dispose();continue}t.push(n)}this._rangeList=t}_interactRectRanges(e){let t=[];for(let n of this._rectRangeList){if(e.some(e=>e.isIntersection(n))){n.dispose();continue}t.push(n)}this._rectRangeList=t}_removeAllRanges(){this._removeAllTextRanges(),this._removeAllRectRanges()}_removeAllCacheRanges(){this._rangeListCache.forEach(e=>{e.dispose()}),this._rectRangeListCache.forEach(e=>{e.dispose()}),this._rangeListCache=[],this._rectRangeListCache=[]}_removeAllTextRanges(){this._rangeList.forEach(e=>{e.dispose()}),this._rangeList=[]}_removeAllRectRanges(){this._rectRangeList.forEach(e=>{e.dispose()}),this._rectRangeList=[]}_deactivateAllTextRanges(){this._rangeList.forEach(e=>{e.deactivate()})}_deactivateAllRectRanges(){this._rectRangeList.forEach(e=>{e.deactivate()})}_addTextRangesToCache(e){this._rangeListCache.push(...e)}_addTextRange(e){this._deactivateAllTextRanges(),e.activate(),this._rangeList.push(e)}_addRectRangesToCache(e){this._rectRangeListCache.push(...e)}_addRectRanges(e){0!==e.length&&(this._deactivateAllRectRanges(),e[e.length-1].activate(),this._rectRangeList.push(...e))}_createTextRangeByAnchorPosition(e){this._removeAllRanges();let{scene:t,mainComponent:n}=this._context,i=new nX(t,n,this._docSkeletonManagerService.getSkeleton(),e,void 0,this._selectionStyle,this._currentSegmentId,this._currentSegmentPage);this._addTextRange(i)}_updateActiveRangePosition(e){let t=this._getActiveRangeInstance();if(null==t||null==t.anchorNodePosition){this._logService.error("[DocSelectionRenderService] _updateActiveRangeFocusPosition: active range has no anchor");return}this._removeAllRanges(),this._anchorNodePosition=t.anchorNodePosition,this._focusNodePosition=e;let{scene:n,mainComponent:i}=this._context,r=this._docSkeletonManagerService.getSkeleton(),{_anchorNodePosition:a,_focusNodePosition:o,_selectionStyle:s,_currentSegmentId:l,_currentSegmentPage:A}=this;if(null==a||null==o||null==i)return;let d=n3(a,o,n,i,r,s,l,A);if(null==d)return;let{textRanges:c,rectRanges:u}=d;this._addTextRangesToCache(c),this._addRectRangesToCache(u),this.deactivate()}_isEmpty(){return 0===this._rangeList.length&&0===this._rectRangeList.length}_getCanvasOffset(){var e;return n2(null==(e=this._context.scene)?void 0:e.getEngine())}_updateInputPosition(e=!1){let t=this._getActiveRangeInstance(),n=null==t?void 0:t.getAnchor();if(!n||n&&!n.visible||null==this.activeViewPort){this.focus();return}let{left:i,top:r}=n,{x:a,y:o}=this.activeViewPort.getAbsoluteVector((0,p.Vector2).FromArray([i,r])),{left:s,top:l}=this._getCanvasOffset();s+=a,l+=o,this.activate(s,l,e)}_moving(e,t){var n,i;let r=this._findNodeByCoord(e,t,{strict:!0,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage}),a=this._getNodePosition(r);if(!a||null==r)return;let o=null==r?void 0:r.node.parent,s=null==o?void 0:o.glyphGroup[o.glyphGroup.indexOf(r.node)+1];(null==r?void 0:r.node.streamType)===g.DataStreamTreeTokenType.PARAGRAPH&&(null==s?void 0:s.streamType)===g.DataStreamTreeTokenType.SECTION_BREAK&&(a.isBack=!0),this._focusNodePosition=a,this._removeAllCacheRanges();let{_anchorNodePosition:l,_focusNodePosition:A,_selectionStyle:d,_currentSegmentId:c,_currentSegmentPage:u}=this,{scene:h,mainComponent:p}=this._context,m=this._docSkeletonManagerService.getSkeleton();if(null==l||null==A||null==p)return;let f=n3(l,A,h,p,m,d,c,u);if(null==f)return;let{textRanges:I,rectRanges:S}=f;this._rangeList.length>0&&I.length>0&&this._interactTextRanges(I),this._rectRangeList.length>0&&S.length>0&&this._interactRectRanges(S),this._addTextRangesToCache(I),this._addRectRangesToCache(S),this.deactivate(),null==(i=null==(n=this._context.scene)?void 0:n.getEngine())||i.setRemainCapture()}__attachScrollEvent(){let e=this.activeViewPort;if(!e)return;let{unitId:t}=this._context;if(this._viewPortObserverMap.has(t))return;let n=e.onScrollAfter$.subscribeEvent(e=>{if(!e.viewport)return;let t=this._getActiveRangeInstance();null==t||t.activeStatic()}),i=e.onScrollEnd$.subscribeEvent(e=>{let t=e.viewport;if(!t)return;let n=t.getBounding(),i=this._getActiveRangeInstance(),r=null==i?void 0:i.getAnchor();if(!(!r||r&&!r.visible)){if(n){let{left:e,top:t,right:a,bottom:o}=n.viewBound;if(r.left<e||r.left>a||r.top<t||r.top>o){null==i||i.deactivateStatic();return}}this._updateInputPosition()}});this._viewPortObserverMap.set(t,{scrollBefore:n,scrollStop:i})}_initInputEvents(){this.disposeWithMe((0,T.fromEvent)(this._input,"keydown").subscribe(e=>{this._isIMEInputApply||this._eventHandle(e,e=>{this._onKeydown$.next(e)})})),this.disposeWithMe((0,T.fromEvent)(this._input,"input").subscribe(e=>{if(!("historyUndo"===e.inputType||"historyRedo"===e.inputType)){if(this._rectRangeList.length>0)return e.stopPropagation(),e.preventDefault();this._isIMEInputApply||this._eventHandle(e,e=>{this._onInputBefore$.next(e),this._onInput$.next(e)})}})),this.disposeWithMe((0,T.fromEvent)(this._input,"compositionstart").subscribe(e=>{if(this._rectRangeList.length>0)return e.stopPropagation(),e.preventDefault();this._isIMEInputApply=!0,this._eventHandle(e,e=>{this._onCompositionstart$.next(e)})})),this.disposeWithMe((0,T.fromEvent)(this._input,"compositionend").subscribe(e=>{this._isIMEInputApply=!1,this._eventHandle(e,e=>{this._onCompositionend$.next(e)})})),this.disposeWithMe((0,T.fromEvent)(this._input,"compositionupdate").subscribe(e=>{this._eventHandle(e,e=>{this._onInputBefore$.next(e),this._onCompositionupdate$.next(e)})})),this.disposeWithMe((0,T.fromEvent)(this._input,"paste").subscribe(e=>{this._eventHandle(e,e=>{this._onPaste$.next(e)})})),this.disposeWithMe((0,T.fromEvent)(this._input,"focus").subscribe(e=>{this._eventHandle(e,e=>{this._onFocus$.next(e)})})),this.disposeWithMe((0,T.fromEvent)(this._input,"pointerdown").subscribe(e=>{this._eventHandle(e,()=>{this._onBlur$.next()})})),this.disposeWithMe((0,T.fromEvent)(this._input,"blur").subscribe(e=>{this._eventHandle(e,e=>{this._onBlur$.next(e)})}))}_eventHandle(e,t){let n=this._input.textContent||"";this._input.innerHTML="",t({event:e,content:n,activeRange:this._getActiveRange(),rangeList:this._getAllTextRanges()})}_getTransformCoordForDocumentOffset(e,t){let{documentTransform:n}=this._context.mainComponent.getOffsetConfig();if(null==this.activeViewPort||null==n)return;let i=this.activeViewPort.transformVector2SceneCoord((0,p.Vector2).FromArray([e,t]));if(i)return n.clone().invert().applyPoint(i)}_findNodeByCoord(e,t,n){let i=this._getTransformCoordForDocumentOffset(e,t);if(null==i)return;let r=this._context.mainComponent,a=this._docSkeletonManagerService.getSkeleton(),{pageLayoutType:o=p.PageLayoutType.VERTICAL,pageMarginLeft:s,pageMarginTop:l}=r.getOffsetConfig();return a.findNodeByCoord(i,o,s,l,n)}_detachEvent(){this._onInputBefore$.complete(),this._onKeydown$.complete(),this._onInput$.complete(),this._onCompositionstart$.complete(),this._onCompositionupdate$.complete(),this._onCompositionend$.complete(),this._onSelectionStart$.complete(),this._textSelectionInner$.complete(),this._onPaste$.complete(),this._onFocus$.complete(),this._onBlur$.complete(),this._onPointerDown$.complete()}},"DocSelectionRenderService"),ie);io=ir([ia(1,m.ILayoutService),ia(2,g.ILogService),ia(3,(0,g.Inject)(h.DocSkeletonManagerService))],io);let is="COMPONENT_DOC_HEADER_FOOTER_PANEL";var il={exports:{}},iA={},id=M&&M.__esModule?M.default:M,ic=Symbol.for("react.element"),iu=Symbol.for("react.fragment"),ig=Object.prototype.hasOwnProperty,ih=id.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ip={key:!0,ref:!0,__self:!0,__source:!0};function im(e,t,n){var i,r={},a=null,o=null;for(i in void 0!==n&&(a=""+n),void 0!==t.key&&(a=""+t.key),void 0!==t.ref&&(o=t.ref),t)ig.call(t,i)&&!ip.hasOwnProperty(i)&&(r[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===r[i]&&(r[i]=t[i]);return{$$typeof:ic,type:e,key:a,ref:o,props:r,_owner:ih.current}}_(im,"q"),iA.Fragment=iu,iA.jsx=im,iA.jsxs=im,il.exports=iA;var iI=il.exports;let iS={panel:"univer-panel",optionsSection:"univer-options-section",optionsFormItem:"univer-options-form-item",optionsInput:"univer-options-input",optionsMarginSetting:"univer-options-margin-setting"},iE=/* @__PURE__ */_(e=>{let t=(0,g.useDependency)(g.LocaleService),n=(0,g.useDependency)(g.IUniverInstanceService),i=(0,g.useDependency)(p.IRenderManagerService),r=(0,g.useDependency)(g.ICommandService),a=(0,g.useDependency)(h.DocSelectionManagerService),{unitId:o}=e,s=i.getRenderById(o).with(io),[l,A]=(0,M.useState)({}),d=/* @__PURE__ */_((e,t)=>{var a;A(n=>({...n,[t]:e?g.BooleanNumber.TRUE:g.BooleanNumber.FALSE}));let l=n.getUniverDocInstance(o),d=null==l?void 0:l.getSnapshot().documentStyle,c=null==(a=i.getRenderById(o))?void 0:a.with(h.DocSkeletonManagerService),u=null==c?void 0:c.getViewModel();if(null==d||null==u)return;let m=u.getEditArea(),f=!1,I=s.getSegmentPage(),S=!1;if("useFirstPageHeaderFooter"===t&&!0===e&&((m!==p.DocumentEditArea.HEADER||d.firstPageHeaderId)&&(m!==p.DocumentEditArea.FOOTER||d.firstPageFooterId)||(f=!0),f&&0===I&&(S=!0)),"evenAndOddHeaders"===t&&!0===e&&((m!==p.DocumentEditArea.HEADER||d.evenPageHeaderId)&&(m!==p.DocumentEditArea.FOOTER||d.evenPageFooterId)||(f=!0),f&&I%2==1&&(S=!0)),f){let n=(0,g.Tools).generateRandomId(6);S&&s.setSegment(n),r.executeCommand(i_,{unitId:o,segmentId:n,headerFooterProps:{[t]:e?g.BooleanNumber.TRUE:g.BooleanNumber.FALSE}})}else r.executeCommand(i_,{unitId:o,headerFooterProps:{[t]:e?g.BooleanNumber.TRUE:g.BooleanNumber.FALSE}})},"handleCheckboxChange"),c=/* @__PURE__ */_(async(e,t)=>{A(n=>({...n,[t]:e})),await r.executeCommand(i_,{unitId:o,headerFooterProps:{[t]:e}}),s.removeAllRanges(),s.blur()},"handleMarginChange"),u=/* @__PURE__ */_(()=>{var e;let t=i.getRenderById(o);if(null==t)return;let{scene:n}=t,r=n.getTransformerByCreate(),l=t.with(h.DocSkeletonManagerService),A=null==l?void 0:l.getSkeleton(),d=null==l?void 0:l.getViewModel(),c=i.getRenderById(o);null==c||null==d||null==A||(a.replaceTextRanges([]),r.clearSelectedObjects(),s.setSegment(""),s.setSegmentPage(-1),d.setEditArea(p.DocumentEditArea.BODY),A.calculate(),null==(e=c.mainComponent)||e.makeDirty(!0))},"closeHeaderFooter");return(0,M.useEffect)(()=>{let e=n.getUniverDocInstance(o),t=null==e?void 0:e.getSnapshot().documentStyle;if(t){let{marginHeader:e=0,marginFooter:n=0,useFirstPageHeaderFooter:i=g.BooleanNumber.FALSE,evenAndOddHeaders:r=g.BooleanNumber.FALSE}=t;A({marginHeader:e,marginFooter:n,useFirstPageHeaderFooter:i,evenAndOddHeaders:r})}},[o]),/* @__PURE__ */iI.jsxs("div",{className:iS.options,children:[/* @__PURE__ */iI.jsxs("div",{className:iS.optionsSection,children:[/* @__PURE__ */iI.jsx("div",{className:iS.optionsFormItem,children:/* @__PURE__ */iI.jsx(D.Checkbox,{checked:l.useFirstPageHeaderFooter===g.BooleanNumber.TRUE,onChange:/* @__PURE__ */_(e=>{d(e,"useFirstPageHeaderFooter")},"onChange"),children:t.t("headerFooter.firstPageCheckBox")})}),/* @__PURE__ */iI.jsx("div",{className:iS.optionsFormItem,children:/* @__PURE__ */iI.jsx(D.Checkbox,{checked:l.evenAndOddHeaders===g.BooleanNumber.TRUE,onChange:/* @__PURE__ */_(e=>{d(e,"evenAndOddHeaders")},"onChange"),children:t.t("headerFooter.oddEvenCheckBox")})})]}),/* @__PURE__ */iI.jsxs("div",{className:(0,N.default)(iS.optionsSection,iS.optionsMarginSetting),children:[/* @__PURE__ */iI.jsxs("div",{className:iS.optionsMarginItem,children:[/* @__PURE__ */iI.jsx("span",{children:t.t("headerFooter.headerTopMargin")}),/* @__PURE__ */iI.jsx(D.InputNumber,{min:0,max:200,precision:1,value:l.marginHeader,onChange:/* @__PURE__ */_(e=>{c(e,"marginHeader")},"onChange"),className:iS.optionsInput})]}),/* @__PURE__ */iI.jsxs("div",{className:iS.optionsMarginItem,children:[/* @__PURE__ */iI.jsx("span",{children:t.t("headerFooter.footerBottomMargin")}),/* @__PURE__ */iI.jsx(D.InputNumber,{min:0,max:200,precision:1,value:l.marginFooter,onChange:/* @__PURE__ */_(e=>{c(e,"marginFooter")},"onChange"),className:iS.optionsInput})]})]}),/* @__PURE__ */iI.jsx("div",{className:iS.optionsSection,children:/* @__PURE__ */iI.jsx(D.Button,{onClick:u,children:t.t("headerFooter.closeHeaderFooter")})})]})},"DocHeaderFooterOptions"),iv=/* @__PURE__ */_(()=>{var e;let t=(0,g.useDependency)(g.LocaleService),n=(0,g.useDependency)(p.IRenderManagerService),i=(0,g.useDependency)(g.IUniverInstanceService).getCurrentUniverDocInstance().getUnitId(),r=(null==(e=n.getRenderById(i))?void 0:e.with(h.DocSkeletonManagerService)).getViewModel(),[a,o]=(0,M.useState)(!0);return(0,M.useEffect)(()=>{o(r.getEditArea()!==p.DocumentEditArea.BODY);let e=r.editAreaChange$.subscribe(e=>{null!=e&&o(e!==p.DocumentEditArea.BODY)});return()=>{e.unsubscribe()}},[]),/* @__PURE__ */iI.jsx("div",{className:iS.panel,children:a?/* @__PURE__ */iI.jsx(iE,{unitId:i}):/* @__PURE__ */iI.jsx("div",{className:iS.panelDisableText,children:t.t("headerFooter.disableText")})})},"DocHeaderFooterPanel");function iT(e,t){let{radius:n,width:i,height:r}=t,a=0;a=Math.min(n=null!=n?n:0,(i=null!=i?i:30)/2,(r=null!=r?r:30)/2),e.beginPath(),e.moveTo(0,0),e.lineTo(i,0),e.lineTo(i,r-a),e.arc(i-a,r-a,a,0,Math.PI/2,!1),e.lineTo(0,r),e.lineTo(0,0),e.closePath(),t.fill&&(e.save(),e.fillStyle=t.fill,"evenodd"===t.fillRule?e.fill("evenodd"):e.fill(),e.restore())}_(iT,"drawBubble");let iC=class e extends p.Shape{constructor(e,t){super(e,t),w(this,"color"),w(this,"text"),this.color=null==t?void 0:t.color,this.text=null==t?void 0:t.text}static drawWith(e,t){let{text:n,color:i}=t;e.save(),e.font="13px Source Han Sans CN";let r=e.measureText(n).width;if(iT(e,{height:18,width:Math.min(r+12,200),radius:4,fill:i,evented:!1}),e.fillStyle="rgba(58, 96, 247, 1)",r>188){let t="",i=0;for(let r of n){let n=e.measureText(r).width;if(i+n<=188-e.measureText("...").width)t+=r,i+=n;else{t+="...";break}}e.fillText(t,6,14)}else e.fillText(n,6,14);e.restore()}_draw(t){e.drawWith(t,this)}};_(iC,"TextBubbleShape");var iy=Object.defineProperty,ib=Object.getOwnPropertyDescriptor,ix=/* @__PURE__ */_((e,t,n,i)=>{for(var r,a=i>1?void 0:i?ib(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&iy(t,n,a),a},"__decorateClass$n"),iR=/* @__PURE__ */_((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$n");let iO="rgba(58, 96, 247, 1)",iB="rgba(58, 96, 247, 0.08)";var iM=((u=iM||{})[u.FIRST_PAGE_HEADER=0]="FIRST_PAGE_HEADER",u[u.FIRST_PAGE_FOOTER=1]="FIRST_PAGE_FOOTER",u[u.DEFAULT_HEADER=2]="DEFAULT_HEADER",u[u.DEFAULT_FOOTER=3]="DEFAULT_FOOTER",u[u.EVEN_PAGE_HEADER=4]="EVEN_PAGE_HEADER",u[u.EVEN_PAGE_FOOTER=5]="EVEN_PAGE_FOOTER",u);function iD(e,t,n){let{documentStyle:i}=e.getDataModel().getSnapshot(),{defaultHeaderId:r,defaultFooterId:a,evenPageHeaderId:o,evenPageFooterId:s,firstPageHeaderId:l,firstPageFooterId:A,evenAndOddHeaders:d,useFirstPageHeaderFooter:c}=i;switch(t){case p.DocumentEditArea.BODY:return{createType:null,headerFooterId:null};case p.DocumentEditArea.HEADER:return c!==g.BooleanNumber.TRUE||l?d!==g.BooleanNumber.TRUE||n%2!=0||o?r?{createType:null,headerFooterId:r}:{createType:2,headerFooterId:null}:{createType:4,headerFooterId:null}:{createType:0,headerFooterId:null};case p.DocumentEditArea.FOOTER:return c!==g.BooleanNumber.TRUE||A?d!==g.BooleanNumber.TRUE||n%2!=0||s?a?{createType:null,headerFooterId:a}:{createType:3,headerFooterId:null}:{createType:5,headerFooterId:null}:{createType:1,headerFooterId:null};default:throw Error(`Invalid editArea: ${t}`)}}_(iD,"checkCreateHeaderFooterType");let iN=(_(aI=class extends g.Disposable{constructor(e,t,n,i,r,a,o,s,l){super(),w(this,"_loadedMap",/* @__PURE__ */new WeakSet),this._context=e,this._commandService=t,this._editorService=n,this._instanceSrv=i,this._renderManagerService=r,this._docSkeletonManagerService=a,this._docSelectionRenderService=o,this._localeService=s,this._componentManager=l,this._initialize()}_initialize(){this._context.unit.getSnapshot().documentStyle.documentFlavor===g.DocumentFlavor.TRADITIONAL&&(this._init(),this._drawHeaderFooterLabel(),this._initCustomComponents())}_initCustomComponents(){let e=this._componentManager;this.disposeWithMe(e.register(is,iv))}_init(){let{unitId:e}=this._context,t=Y(this._context);null==t||null==t.document||this._loadedMap.has(t.document)||(this._initialMain(e),this._loadedMap.add(t.document))}_initialMain(e){let{document:t}=Y(this._context);this.disposeWithMe(t.onDblclick$.subscribeEvent(async n=>{if(this._isEditorReadOnly(e))return;let{offsetX:i,offsetY:r}=n,{pageLayoutType:a=p.PageLayoutType.VERTICAL,pageMarginLeft:o,pageMarginTop:s}=t.getOffsetConfig(),l=this._getTransformCoordForDocumentOffset(i,r);if(null==l)return;let A=this._docSkeletonManagerService.getViewModel(),d=this._docSkeletonManagerService.getSkeleton(),c=A.getEditArea(),{editArea:u,pageNumber:h}=d.findEditAreaByCoord(l,a,o,s);if(c===u)return;A.setEditArea(u);let{createType:m,headerFooterId:f}=iD(A,u,h);if(u===p.DocumentEditArea.BODY)this._docSelectionRenderService.setSegment(""),this._docSelectionRenderService.setSegmentPage(-1),this._docSelectionRenderService.setCursorManually(i,r);else if(null!=m){let t=(0,g.Tools).generateRandomId(6);this._docSelectionRenderService.setSegment(t),this._docSelectionRenderService.setSegmentPage(h),await this._commandService.executeCommand(iw.id,{unitId:e,createType:m,segmentId:t})}else null!=f&&(this._docSelectionRenderService.setSegment(f),this._docSelectionRenderService.setSegmentPage(h),this._docSelectionRenderService.setCursorManually(i,r))}))}_getTransformCoordForDocumentOffset(e,t){let{document:n,scene:i}=Y(this._context),{documentTransform:r}=n.getOffsetConfig(),a=i.getViewports()[0];if(null==a)return;let o=a.transformVector2SceneCoord((0,p.Vector2).FromArray([e,t]));return r.clone().invert().applyPoint(o)}_drawHeaderFooterLabel(){let e=this._localeService;this._renderManagerService.currentRender$.subscribe(t=>{if(null==t)return;let n=this._renderManagerService.getRenderById(t);if(this._editorService.isEditor(t)||null==this._instanceSrv.getUniverDocInstance(t)||null==n)return;let{mainComponent:i}=n;this.disposeWithMe((0,g.toDisposable)(i.pageRender$.subscribe(n=>{if(this._editorService.isEditor(t))return;let i=this._docSkeletonManagerService.getViewModel().getEditArea()===p.DocumentEditArea.BODY,{page:r,pageLeft:a,pageTop:o,ctx:s}=n,{pageWidth:l,pageHeight:A,marginTop:d,marginBottom:c}=r;s.save(),s.translate(a-.5,o-.5),i?((0,p.Rect).drawWith(s,{left:0,top:0,width:l,height:d,fill:"rgba(255, 255, 255, 0.5)"}),s.save(),s.translate(0,A-c),(0,p.Rect).drawWith(s,{left:0,top:0,width:l,height:c,fill:"rgba(255, 255, 255, 0.5)"})):(s.save(),s.translate(0,d),(0,p.Rect).drawWith(s,{left:0,top:d,width:l,height:A-d-c,fill:"rgba(255, 255, 255, 0.5)"})),s.restore(),i||((0,p.Path).drawWith(s,{dataArray:[{command:"M",points:[0,d]},{command:"L",points:[l,d]}],strokeWidth:1,stroke:iO}),(0,p.Path).drawWith(s,{dataArray:[{command:"M",points:[0,A-c]},{command:"L",points:[l,A-c]}],strokeWidth:1,stroke:iO}),s.translate(0,d+1),iC.drawWith(s,{text:e.t("headerFooter.header"),color:iB}),s.translate(0,A-d-c),iC.drawWith(s,{text:e.t("headerFooter.footer"),color:iB})),s.restore()})))})}_isEditorReadOnly(e){let t=this._editorService.getEditor(e);return!!t&&t.isReadOnly()}_getDocDataModel(){return this._context.unit}},"DocHeaderFooterController"),aI);iN=ix([iR(1,g.ICommandService),iR(2,m.IEditorService),iR(3,g.IUniverInstanceService),iR(4,p.IRenderManagerService),iR(5,(0,g.Inject)(h.DocSkeletonManagerService)),iR(6,(0,g.Inject)(io)),iR(7,(0,g.Inject)(g.LocaleService)),iR(8,(0,g.Inject)(m.ComponentManager))],iN);let iP={id:"sidebar.operation.doc-header-footer-panel",type:g.CommandType.OPERATION,handler:/* @__PURE__ */_(async(e,t)=>{let n=e.get(m.ISidebarService),i=e.get(g.LocaleService);return"open"===t.value?n.open({header:{title:i.t("headerFooter.panel")},children:{label:is},onClose:/* @__PURE__ */_(()=>{},"onClose"),width:400}):n.close(),!0},"handler")};function iQ(){return{dataStream:`\r
`,textRuns:[{st:0,ed:0,ts:{fs:9}}],customBlocks:[],paragraphs:[{startIndex:0,paragraphStyle:{spaceAbove:{v:0},lineSpacing:1.5,spaceBelow:{v:0}}}],sectionBreaks:[{startIndex:1}]}}function iU(e,t,n,i){let r=(0,g.JSONX).getInstance(),a=null!=e?e:(0,g.Tools).generateRandomId(6),o=t===iM.DEFAULT_HEADER||t===iM.FIRST_PAGE_HEADER||t===iM.EVEN_PAGE_HEADER,s=r.insertOp([o?"headers":"footers",a],{[o?"headerId":"footerId"]:a,body:iQ()});i.push(s);let l=(0,g.Tools).generateRandomId(6),A=r.insertOp([o?"footers":"headers",l],{[o?"footerId":"headerId"]:l,body:iQ()});i.push(A);let d="defaultHeaderId",c="defaultFooterId";switch(t){case iM.DEFAULT_HEADER:d="defaultHeaderId",c="defaultFooterId";break;case iM.DEFAULT_FOOTER:d="defaultFooterId",c="defaultHeaderId";break;case iM.FIRST_PAGE_HEADER:d="firstPageHeaderId",c="firstPageFooterId";break;case iM.FIRST_PAGE_FOOTER:d="firstPageFooterId",c="firstPageHeaderId";break;case iM.EVEN_PAGE_HEADER:d="evenPageHeaderId",c="evenPageFooterId";break;case iM.EVEN_PAGE_FOOTER:d="evenPageFooterId",c="evenPageHeaderId";break;default:throw Error(`Unknown header footer type: ${t}`)}for(let[e,t]of[[d,a],[c,l]])if(null!=n[e]){let a=r.replaceOp(["documentStyle",e],n[e],t);i.push(a)}else{let n=r.insertOp(["documentStyle",e],t);i.push(n)}return i}_(iQ,"getEmptyHeaderFooterBody"),_(iU,"createHeaderFooterAction");let i_="doc.command.core-header-footer",iw={id:i_,type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>{var n;let i=e.get(g.ICommandService),r=e.get(g.IUniverInstanceService),a=e.get(p.IRenderManagerService),{unitId:o,segmentId:s,createType:l,headerFooterProps:A}=t,d=null==(n=a.getRenderById(o))?void 0:n.with(h.DocSkeletonManagerService),c=r.getUniverDocInstance(o),u=null==d?void 0:d.getViewModel();if(null==c||null==u)return!1;let m=u.getEditArea(),{documentStyle:f}=c.getSnapshot(),I=(null==A?void 0:A.marginFooter)!=null||(null==A?void 0:A.marginHeader)!=null,S={id:h.RichTextEditingMutation.id,params:{unitId:o,actions:[],textRanges:[{startOffset:0,endOffset:0,collapsed:!0}],debounce:!0}};I&&(S.params.noNeedSetTextRange=!0);let E=(0,g.JSONX).getInstance(),v=[];return null!=l&&iU(s,l,f,v),null!=A&&Object.keys(A).forEach(e=>{let t;let n=A[e],i=f[e];n===i||((t=void 0===i?E.insertOp(["documentStyle",e],n):E.replaceOp(["documentStyle",e],i,n),v.push(t),"useFirstPageHeaderFooter"!==e||n!==g.BooleanNumber.TRUE||f.firstPageHeaderId)?"evenAndOddHeaders"!==e||n!==g.BooleanNumber.TRUE||f.evenPageHeaderId||iU(s,m===p.DocumentEditArea.HEADER?iM.EVEN_PAGE_HEADER:iM.EVEN_PAGE_FOOTER,f,v):iU(s,m===p.DocumentEditArea.HEADER?iM.FIRST_PAGE_HEADER:iM.FIRST_PAGE_FOOTER,f,v))}),0!==v.length&&(S.params.actions=v.reduce((e,t)=>(0,g.JSONX).compose(e,t),null),!!i.syncExecuteCommand(S.id,S.params))},"handler")},iL={id:"doc.command.open-header-footer-panel",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>e.get(g.ICommandService).executeCommand(iP.id,{value:"open"}),"handler")},iF="UI_PLUGIN_DOCS",ik=`${iF}_COLOR_PICKER_COMPONENT`,iH=`${iF}_FONT_FAMILY_COMPONENT`,iV=`${iF}_FONT_FAMILY_ITEM_COMPONENT`,ij=`${iF}_FONT_SIZE_COMPONENT`,iW={docListTypePicker:"univer-doc-list-type-picker",docListTypePickerItem:"univer-doc-list-type-picker-item",docListTypePickerItemActive:"univer-doc-list-type-picker-item-active"},iz=/* @__PURE__ */_(e=>{let{value:t,onChange:n,options:i}=e;return /* @__PURE__ */iI.jsx("div",{className:iW.docListTypePicker,children:i.map(e=>/* @__PURE__ */iI.jsx("img",{className:iW.docListTypePickerItem+(t===e.value?` ${iW.docListTypePickerItemActive}`:""),onClick:/* @__PURE__ */_(()=>{n(e.value)},"onClick"),src:e.img},e.value))})},"ListTypePicker"),iG=[{value:g.PresetListType.ORDER_LIST,img:"data:image/jpeg;base64,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"},{value:g.PresetListType.ORDER_LIST_1,img:"data:image/jpeg;base64,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"},{value:g.PresetListType.ORDER_LIST_2,img:"data:image/jpeg;base64,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"},{value:g.PresetListType.ORDER_LIST_3,img:"data:image/jpeg;base64,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"},{value:g.PresetListType.ORDER_LIST_4,img:"data:image/jpeg;base64,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"},{value:g.PresetListType.ORDER_LIST_5,img:"data:image/jpeg;base64,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"}],iY=/* @__PURE__ */_(e=>/* @__PURE__ */iI.jsx(iz,{...e,options:iG}),"OrderListTypePicker"),iK=[{value:g.PresetListType.BULLET_LIST,img:"data:image/jpeg;base64,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"},{value:g.PresetListType.BULLET_LIST_1,img:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAgEA2ADYAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/CABEIAPQA2AMBEQACEQEDEQH/xAA0AAEAAgMBAQEAAAAAAAAAAAAABwoGCAkFCwQBAQADAQEBAAAAAAAAAAAAAAACBAUDAQb/2gAMAwEAAhADEAAAAL/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAPPPQAAAAAAAAAAAANbpx+Wlv5/1QMDQn6EgAAAAAAAAAANY+kfly72fd/wAm3SZ1an1IcHQnyEhqSAAAAAAAZcbEAAHAO3xoza1O+Bk3e6tTqBhYAAAAAAB+0ycAAHHqzy7C1uoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGsXSPAG3xsg0u8tR9AAAAAAAAAAAArLXq/Am5xsL0+9kij3GMEFAAAAAGTk6gAAAHy0N/P6W8J3e8q3sPCQ8wwQAAAAA9QzoAAAGvE46u9I9KeHQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYt75WQv8AAdI+E+utbqAAAAAAAAAABCM4/GE+myxcGzbN+PIujHyHQADISYQAAAAAAQjOPxhPpssXBs2zfjyLo8UjEAA9ok4AAAAAAHh+uMNnkNwect+eMwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMP8AfKeWlWuM5trJPAAAAAAAAAAAGH++UrNSrrBOO3vOV0HMt5J4ELgAAAAAAHtEnAAhSXlEDXp7C85QpON7jJuSxH0a+gAAAAAAGQkwgAEMy8ola1O+Lk3JWj6AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/EACwQAAEEAQIFAgYDAQAAAAAAAAYABwgXBQQJAgMKEBYaQAEVIDA4YBgZOVD/2gAIAQEAAQgA/wC18Mti+LKczB8PuZWPSbMgwb0uGz2H3XJ14idfNnvwxjeAse9iWhcxyfbzLfE9jZF96HybAW3bZ04SdPMn5yP4Lxn/ANrFrt4KeXPnl8J98UWncNH6juz7yOJ28kIl5IRLyQiXkhEvJCJeSES8kIl5IRLyQiXkhEvJCJeSES8kIl5IRLyQiQLm8zrCrF6fV/TI/axhdEx4nx3bG+4d5OeHHPDh3AOCNu1vDuQb3M3uyOB3rwPVeB6rwPVeB6rwPVeB6rwPVeB6rwPVeB6rwPVeB6rwPVeB6rwPWODRvFazk6/QfViNjmBeGnpq59aP9tmQwWWkvHBz2lE4I7u0429YrjPdw1kX4ZmSTd4Z2WF9zP6VuB2QpzZaV2pe7efhNpHIycloA7OnUBYXcTJ8THl3uxlkdZihvJa/QWGYKwzBWGYKwzBWGYKwzBWGYKwzBWGYKwzBWGYINMiTKkmN0Gv+zvdTVJNyvcWJ8e0W3B0sjzO58cE6M+40RPjrDxutG1UbO2ZxOnzmN1OL1dUDqqgdVUDqqgdVUDqqgdVUDqqgdVUDqqgdVUDqwzfYbB5LTZTSfYla17lvdH5y2caeAm05DDbnH9NymK/cDkuxrfhJieZn1cu28vVy7by23t6GLm6GbOSBsD7eTP43yC79H5+SEw+5VltRg8Dr8ppLXIla5ErXIla5ErXIkKuDmc5ntBi9X96TP43yC79H5+SEw+5Dh/n2H1mJVQqoVUKqFVCh5uPkOY0eW++TDmFMRsgESP05GzMvTkbMyh9tgQZgQSGJdE39fcFwQhqAgqcpysN1Yodqp76kfygcYijhig4dgnt3BcEIagIKnKcpyOpWjlJ2T7jxokL6ZnJ/yr8oTQdSrF2N8oAGLLIhxiKOGKDh2CdreVvK3lbyt5W8reVvK3lbyt5W8reVvK3kPOP8+zGjxP0yLjy0crWXPo/vpzel6dgHmcVj7s/33QIsz+uZYHpcnEOpojeLb9i2Oa2NbRATFMr2qgiVUESqgiVUESqgiVUESqgiVUESqgiVUESqgiVUESqgiVUESqgiQq32Zwee0GU1f0yFYBqpSsu4LAPbhulVkRxz31LQZljWRbCNzRgTGMx+zf/EAEYQAAEDAwEEBgYECwcFAAAAAAQDBQYBAgcAERITpQgUFZTU1RAWF5XT5QkjM0AYGSAhIiQmMFdgtiUnN5eo19g0NUVGUP/aAAgBAQAJPwD/AO05N9z2i3ouyrPQwerok1kkLhjuSjfRTrdjeuWKUKiZcjQdUgZdCxS5VFS237zi47pAZjxxjoyaxbBcbdgBJTLlOOqGEraKot2je1IXjObiQi1iGvj4MwujLEm55lCje0k5Vdi+kKW7dnubYUgbWDucHqbbS7CBEGTKsRsxdYjZY3ixVBVI4E5JGTBuaM5RSk1uLH3AuSch4/aJlJsJzE9vKlsHKNpamSIbYIrQjqd6lyJYVXIJqfBAjwQpQxxySpubA3/d8MybpATvG8LPkUdxTElEE3aRloXpJXrqUvUoaszsI6q0hkAzEK6yQlja3BCOs7q8KBhLZWcXjOzw42AvDORYYpj9/wAfqGWX2YUVhaBdELMYWIUTEbI+Isme2npoSkB0SmyVskr0Asi/hm+wP23/AIBnaMV/x0/672jep/A/xF/8n1vqnbf/ALT7J/b9/ZOsnnC5sFOuZEIlRJwpjQXGlHDi34Kug9xtLbsZ3W04JDOoT22q97Zpc9UyBS2UWYglWBJvkWENEnkmIZosKvJIQ5HWXVUbjrxbqX0QKssTdWtJ0EaJEg0ngoSiPxuRpujA2+h/eveh3x9P7170O+Pp/eveh3x9P7170O+Pp/eveh3x9P7170O+Pp/eveh3x9P7170O+Pp/eveh3x9P7170O+Pp/eveh3x9P7170O+Pp/eveh3x9P7170O+Pp/eveh3x9O7oUOp17iIEHlro37jcZfZvpKq3WXbt9tt9u9bXduttupsrSlfyui1MM5Zix3CHHJMX6LsDTZboKdmUQxQs7L7BElw98aTJ2Kpvjom3WPQ7GqA+TqJQV7yJc02UygTfl68mjNZDbaH3YsuxZcf1i3BtsModVO7GtydaUoDQqr7V9r670e/X79ptdFWUYK6QOQYG0ZDknRqnNzMpDYhmpwJtOty48RAUPduyHRKztNuvcuyaVLObptKIHHMuIOSrf6WjmDp43TRzB08bpo5g6eN00cwdPG6aOYOnjdNHMHTxumjmDp43TRzB08bpo5g6eN00cwdPG6aOYOnjdNHMHTxumjmDp43TRzB08bpo5g6eN028AtDicJXrh6u5xUr0VPq1ilErt5JS+39KyuzbtpsupStPysdW0mStqcjAxPVFu9jrRmKriqaXmoGK9U2WS5alUSRG2q3qw2SehM3EaKStURzb/5tnEhxdkZ3YlXTE2U4k+O0Zk2Nsrx+tHjH8wan9gXEe29JvkQoaD8m2FILu0XMfGFW+ojqSnfg1xzHiPHuRZbhbN/ST6P7CGZlHow5Lx1IVI1MY90ruj7H0RzVgW1O5vlxGSsRtPYgkPdGmi0YdJQ4VA1kyH5Yxy/8SxtlkJehXlsqWhanUxrO6vfUhpfG6qqaTswuyAL00kXdWcgBSKVSp95iDvPejt9IdBlRsnYnhjwwNkoYuk7gj1ebwssx9rfTAgbmWZY3lQrLNuzkrVDJM3iPb841MJZhDcU9KboFdKM9dY+SuuPFsYPnR/zZdwFraMudOj2bK0ILIEClFVuHKGEFokLQecvJ62Pj+A0Kh4RlsB6RaLAQ4ky3GMakszwbJ6NiVVTHBxIEReH3DKhaVqtwaE4LdYeqsIoHTIiT25skeN9C3ALQ6nwleGkrucU8VFT6taxRK7eSUvt/Ssrs27abLqUrR35e1+C078va/Bad+XtfgtO/L2vwWnfl7X4LTvy9r8Fp35e1+C078va/Bad+XtfgtO/L2vwWnfl7X4LTlxxF+ucVLqYCW/wgClk/rERU1bd1VOy79G+m3ZsrttrWlf3KL5P8a4uOvwJ0do3EAT5EVMEGR0JskcvjrOzolEvR2SZlc5OjOQEDVyOhw8NbiUlFWmylH5xwNjxbqjkJhKKkN5maJKLW9Je0aWO11jhH8Yglj1pRYSicimNtty4JrXFHBOwqzE0SxPDB+AoWJHQa9qSA5BKqNrxLZIaoXIpc+XJ1usueJG6Obhwq0QsItQtsSt9F66Y5XB4l49ydi1OAukRZuXKprWU23o20u3k7tttbqU2VrS6hr13gHy7Rr13gHy7Rr13gHy7Rr13gHy7Rr13gHy7Rr13gHy7Rr13gHy7Rr13gHy7Rr13gHy7Rr13gHy7Rr13gHy7RLooQLxuHYQsJejXjoKj379qQSN9dli11bd1S3ZdS2tdtKVtr+4yKLiKV5SYFYGRlFVtKeXKCxOTKptc4fYs0ClNtx00tiJDyFD1FXllHZ5Ea3SBU++jRQA3HCDlktZuoDJM6T2gckyzI+KlRM5NN+uEHFijObs2LRyGAMDKvZYlceIeXZcYp/OCBxLPCYtIZc6jNiaCzkQ2xtpLeTkG9EokIVU5UUJVMRMkwRBRe5O1YlBOtytmE+m7/AJb4H/5J6wn03f8ALfA//JPUCz5EHjFsWaZdICcwRfHjA2mNrw7XMwqDOtC8p5AKIOTKsqoumaG3oWobLkyVVPqqfd/4I5X/AKDfvT/BGC/14t6bEVCBeq8Owi1S9GvHMHHv37UlEb67LFrq27qluy6lta7aUrbUJl7ud5joJl7ud5joJl7ud5joJl7ud5joJl7ud5joZsTHK61xLx0S7FqcAMgizcuVNWsptvRtpdvJ3bba3UpsrWl1P338Ecr/ANBv3p/gjBf68W9JHVOt9X/WODx+HwCkCfsuKjvb3B3PtLd3e3vz7N2sh5T8z1IeU/M9SHlPzPUh5T8z1IeU/M9PPW+qdY/V+zuBxOOKuN9r15bd3eNv/Z3b27u/m271P3wfaMelTG7Rx+b+sFh9fZXwAhsdA+tgLinC9aBKXQ6wGSOWhv8AEHXRWtsUt6HH+oXpU/7466HH+oXpU/746wf7KJDPmMCOS1w9peX512syth9zmEH1TJU/mIIHAOuqv1hsGDLU28NZdRHYn/MEqY4RAYQxnySWy2SHoNbGwMbWhcSc4uJxN1iSKCKVldlNtVFlK2IIWKLqJp3Y36j9HyXwYK3TmrW43ZgbXRJyVtpnNwaE1b+NDzuLagbjZFuvlAEXRHkApREpRLhjhI2WXwuXsrdI4tKY44iu7DIGF3FSNbHdocwlVhDm84RZIgYkdW9JVK+26277xKmOEQGEMZ8klstkh6DWxsDG1oXEnOLicTdYkigilZXZTbVRZStiCFii6iad2CmqUfRXZYY08Sujy9tLrfk5EtN4qSNnVzbRCLSw472km3OAEWZxkZ9DBWZjnbA6WzZtWihefof+Kr9T/b3+Fr64RLtP2PbnbPqRxOP2P64dj/Xe0vqns39Uv26/7t/d3rB7ZC/otMZMSWI41NWdtfPaSE5put6q2b02QhdUxxgxZ65pTzG3EAnJkiFcXLIzm5EzAxSBKyNll8Ll7K3SOLSmOOIruwyBhdxUjWx3aHMJVYQ5vOEWSIGJHVvSVSvtutu9Me5t8s1HubfLNR7m3yzUe5t8s1HubfLNR7m3yzUe5t8s1HubfLNR7m3yzUe5t8s1HubfLNR7m3yzUe5t8s1HubfLNR7m3yzTN1TrfWP1jtHj8PgCrk/ZdRR3t7g7n2lu7vb359m7X8iJizXF+SGfseSMZKig61tUCh3Fqd2k9CtpTS/x94DAfGB4DvsLa3hvDNQuoojSlcpssU+jsx+0lZXknSpdXqOMbwpi9vWKKLghbUetaMwZOACCJQkUmPBpAWVkSum6ahSxAEHJ6M8d/E2+oP4PnbHZ8j9et7tXj+2rsvrfbHqf2x/bXV+B7YOu/wB7nbfrz+xOsuM8p+jemTODlqN9JlhfY48ylzxs6LoFN2NmltCvWDdckuIZSCTXORm5THhcbUpOd2rnZfjm6JAQbF+NGJKPRGMt1VlEQQrV1zCySSiVFjHJ2d3Ms55fXlwXIcnp7cHB2ciSTzSF1PQay94O8u0ay94O8u0ay94O8u0ay94O8u0ay94O8u0ay94O8u0ay94O8u0ay94O8u0ay94O8u0ay94O8u0ay94O8u0ay94O8u0ay94O8u0ay94O8u0ay94O8u0S2KDi9a4lg6xd61eOGQPZuWqhI2V2XrW1u3lLdltLq021pS2v5MZSl2McmsSjBKGW8hcJe5Gi6BwDi2uAt6ZbY9MjqIC8sjoKpaQ3OoAZiVa3I0trMd3oQN/BnFekeOq0WS13gyzkqkhjEOL3cTq+aLuCo2uDko2qQhtbaUm9Kk3EN8HMigMJxhjRgHjcQjQFy6yQICKixK65JZSq5rk6ujgSY7vbu4LkOLw8HnOjiSQaYQtf/M3/xAA7EQACAQEEBgQLCAMAAAAAAAABAhEDABIhMQQTQVFSYRQiMkAFQmBxcoGRobHS8BAVIzRTkqLxUGKC/9oACAECAQE/AP8ANRt2ZT3qmoZ1DtcRmguRgPrDkJBOFjo9E0dTdFyMDtB454ue3I4YWdQrsqsHUEgMMj9ezcSMe8UkV6iozBFYwWOz+8hOEnHCx0akaWpuwgyO0Hini3nbllhbWv8Aldcuqv3dbj2N08Pu2XrmNujUdTqbvVzveNe454vdGERhaooR2UMHCkgMMj9esbiRj3hNIq1FTRzUCKTdNQzN3hJ3eycASFt0WjqdTd6ud7xr3HO/3RhEYWevVRG0cVA6AkBxMleEHh/oEr3rpVY0dTewyveNd4Z3e+MJjDyupPq3ViAyzDKRIZTgwIPLLnBtV0akzxRe6xUOtNz1aikSDTc+sXWMyDjFnRkYq6lWGwiPXzG4jA96o0zpVIU5AeieqxmDTeeqSNoYSOWA22TRa0BKzU61PZJYOvNHuz6iYOWAm2k6GaAvq4KTkxAcfAN6seUSe86LSFCgL0Bm67k4ROQJ2XR75tX8IKsrRF9uM9geba3uHns9R6jXnYseezzDIDkO8U2VHVmW8FM3cpIyBO6YnPDC1bSKtc9dursQYKPVtPMyfLECSAMyQPaYt93V+Ol+5/kt93V+Ol+5/ktX0Wpo4UuUIYkC6WOQnGVXvCdtPTX4j7fCXYpemfh3hO2npr8R9vhLsUvTPw7wCQQRmDI84t03Sv1f4U/kt03Sv1f4U/ktVr1awAqPeAMjqqIP/IHlAqliFUEsTAAzJsfBx1MhprZkeKf9BzGxsicMsQQQSCCCDBBwII2HvCqWIVQSxMADMmw0F6dNXRyNIU3oB6uXYHPmcDJBwxt0/wDDi4ekTc1cGL2U74nxc5wyxs2g1HpmozTXY3ipiI4Z4tx7I7OWNiCCQQQQYIOBBGw93R2psHQwymQfrMEYEbRbp6mkCqk1ibopwSL3FzXcMycOduh1ruvvnpM34wj0Z3xhw+LEY26eBSN5SK4N0oQQL3FyG8Zzhzs7s7F2Msxkn69gGwd4R2psHUwymQfrYdosfCCam8B+LlcxieKeHlns52dmdi7GWYyT9e7yn//EADYRAAECAwQFCgYDAQAAAAAAAAECEQAhMQMSUWETQEFxoRQiMlJgcoGRwfEEEKKx0fAz0uFC/9oACAEDAQE/AOyiiQkkC8QHA2n94swnGkXfvvzuDYNhl6wkkpBIukh2NR++7HWFEpSSBeIEhjAtFhd9+dwIwbD3rOLif5rhvs9yXSxbHjtu3o0q79958G6rYe9ZwkkpBIKSRMHZ++eLHWFWaEk2oSVEBwkUfFsfcAmNKu/feeGxuq2Hu7zhNmkkWhSUqIe6aA4tj7kBWtaJF++08Nj4tjwedZ9rlpvJIBY7CJMRQ+fCEWqwl1hwCQpSapIreTxcbM4BCg6SCMRrS1aFd5nTaCYHWTt8QZ5zMG1Q95AUhWTMe8mh3+M4sra+bpDKycg/jxlnrNsvSLlMDmpbbn4ng0I+HJmvmjAdL8DichCUpSGSABl6mp8dYUCUkAsTJ8Aatm1M4RZoRQT6xr/nh2xJYE4AnyjlNngvyH9o5TZ4L8h/aLO1TaEhIUGDzA9CdYX0Vd0/Y/P4bpK7vqNYX0Vd0/Y/P4bpK7vqNYIcEGhlGgsur9SvzGgsur9SvzCbNCCSkMTKpP3J7QEgAklgKmOU8+nMpnv/AMwzgEEOJg0OsEgAklgKmDbpUopUl7Myz73tMVE5Hk/O6Q0bXrzimG/OjTygW6UqCUpazEn2793E1M5QCCHEwaHV1JCgUkODWOTkLLlrMTKpUw350aeUaZD6O6NE13a+/d9X/TvKOTkrkXszO9J2w350aeUABIAAYCg1hSQoFJDg1jkyr7PzK3trYNjnTblAASAAGAoO0/8A/9k="},{value:g.PresetListType.BULLET_LIST_2,img:"data:image/jpeg;base64,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"},{value:g.PresetListType.BULLET_LIST_3,img:"data:image/jpeg;base64,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"},{value:g.PresetListType.BULLET_LIST_4,img:"data:image/jpeg;base64,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"},{value:g.PresetListType.BULLET_LIST_5,img:"data:image/jpeg;base64,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"}],iq=/* @__PURE__ */_(e=>/* @__PURE__ */iI.jsx(iz,{...e,options:iK}),"BulletListTypePicker"),iX=`${iF}_ORDER_LIST_TYPE_COMPONENT`,iJ=`${iF}_BULLET_LIST_TYPE_COMPONENT`;function iZ(e){return e.getContextValue(g.FOCUSING_DOC)&&e.getContextValue(g.FOCUSING_UNIVER_EDITOR)&&!e.getContextValue(g.FOCUSING_COMMON_DRAWINGS)}function i$(e){return e.getContextValue(g.FOCUSING_DOC)&&e.getContextValue(g.FOCUSING_UNIVER_EDITOR)&&!e.getContextValue(g.FOCUSING_UNIVER_EDITOR_STANDALONE_SINGLE_MODE)&&!e.getContextValue(g.FOCUSING_COMMON_DRAWINGS)}_(iZ,"whenDocAndEditorFocused"),_(i$,"whenDocAndEditorFocusedWithBreakLine");let i0={id:en.id,binding:m.KeyCode.TAB,preconditions:iZ},i1={id:en.id,binding:m.KeyCode.TAB|m.MetaKeys.SHIFT,preconditions:iZ,staticParameters:{shift:!0}},i9={id:tu.id,binding:m.KeyCode.B|m.MetaKeys.CTRL_COMMAND,preconditions:iZ},i3={id:th.id,binding:m.KeyCode.I|m.MetaKeys.CTRL_COMMAND,preconditions:iZ},i2={id:tm.id,binding:m.KeyCode.U|m.MetaKeys.CTRL_COMMAND,preconditions:iZ},i4={id:tI.id,binding:m.KeyCode.X|m.MetaKeys.SHIFT|m.MetaKeys.CTRL_COMMAND,preconditions:iZ},i8={id:tE.id,binding:m.KeyCode.COMMA|m.MetaKeys.CTRL_COMMAND,preconditions:iZ},i6={id:tT.id,binding:m.KeyCode.PERIOD|m.MetaKeys.CTRL_COMMAND,preconditions:iZ},i5={id:tJ.id,binding:m.KeyCode.L|m.MetaKeys.CTRL_COMMAND|m.MetaKeys.SHIFT,preconditions:iZ},i7={id:t$.id,binding:m.KeyCode.R|m.MetaKeys.CTRL_COMMAND|m.MetaKeys.SHIFT,preconditions:iZ},re={id:tZ.id,binding:m.KeyCode.E|m.MetaKeys.CTRL_COMMAND|m.MetaKeys.SHIFT,preconditions:iZ},rt={id:t0.id,binding:m.KeyCode.J|m.MetaKeys.CTRL_COMMAND|m.MetaKeys.SHIFT,preconditions:iZ},rn={id:tW.id,binding:m.KeyCode.Digit7|m.MetaKeys.CTRL_COMMAND|m.MetaKeys.SHIFT,preconditions:iZ},ri={id:tH.id,binding:m.KeyCode.Digit8|m.MetaKeys.CTRL_COMMAND|m.MetaKeys.SHIFT,preconditions:iZ},rr=[50,80,100,130,150,170,200,400];function ra(){let e=(0,g.useDependency)(g.ICommandService),t=(0,g.useDependency)(g.IUniverInstanceService),n=(0,M.useMemo)(()=>t.getCurrentTypeOfUnit$(g.UniverInstanceType.UNIVER_DOC),[]),i=(0,g.useObservable)(n),r=(0,M.useCallback)(()=>{var e,t;return i?Math.round((null!=(t=null==(e=i.getSettings())?void 0:e.zoomRatio)?t:1)*100):100},[i]),[a,o]=(0,M.useState)(()=>r());function s(t){o(t),null!=i&&e.executeCommand(t4.id,{unitId:i.getUnitId(),zoomRatio:t/100})}return(0,M.useEffect)(()=>(o(r()),e.onCommandExecuted(e=>{e.id===t4.id&&o(r())}).dispose),[e,r]),_(s,"handleChange"),/* @__PURE__ */iI.jsx(D.Slider,{min:10,value:a,shortcuts:rr,onChange:s})}function ro(e){return /* @__PURE__ */iI.jsx("section",{className:"univer-doc-count-bar",children:/* @__PURE__ */iI.jsx(ra,{})})}_(ra,"ZoomSlider"),_(ro,"CountBar");let rs=/* @__PURE__ */_(()=>/* @__PURE__ */iI.jsxs("div",{className:"univer-doc-footer-container",children:[/* @__PURE__ */iI.jsx("div",{}),/* @__PURE__ */iI.jsx(ro,{})]}),"DocFooter"),rl="docs-ui.config",rA={layout:{docContainerConfig:{outerLeft:!1,outerRight:!1,header:!0,footer:!0,innerLeft:!1,innerRight:!1,frozenHeaderLT:!1,frozenHeaderRT:!1,frozenHeaderLM:!1,frozenContent:!1,infoBar:!0,toolbar:!0},toolbarConfig:{undo:!0,redo:!0,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!0}}},rd={id:"doc-paragraph-setting.command",type:g.CommandType.COMMAND,handler:/* @__PURE__ */_(async(e,t)=>{var n,i,r;let a=e.get(h.DocSelectionManagerService),o=e.get(g.IUniverInstanceService),s=e.get(g.ICommandService),l=o.getCurrentUnitForType(g.UniverInstanceType.UNIVER_DOC),A=a.getDocRanges();if(!l||0===A.length||!t)return!1;let d=A[0].segmentId,c=l.getUnitId(),u=null!=(r=tK(A,null!=(i=null==(n=l.getSelfOrHeaderFooterModel(d).getBody())?void 0:n.paragraphs)?i:[]))?r:[],p={id:h.RichTextEditingMutation.id,params:{unitId:c,actions:[],textRanges:A}},m=new g.MemoryCursor;m.reset();let f=new g.TextX,I=(0,g.JSONX).getInstance();for(let e of u){let{startIndex:n}=e;f.push({t:g.TextXActionType.RETAIN,len:n-m.cursor,segmentId:d});let i={...e.paragraphStyle,...t.paragraph};f.push({t:g.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...e,paragraphStyle:i,startIndex:0}]},segmentId:d,coverType:g.UpdateDocsAttributeType.REPLACE}),m.moveCursorTo(n+1)}let S=J(l,d);return p.params.actions=I.editOp(f.serialize(),S),!!s.syncExecuteCommand(p.id,p.params)},"handler")},rc=/* @__PURE__ */_(()=>{let e=(0,g.useDependency)(h.DocSelectionManagerService),t=(0,g.useDependency)(rN),n=(0,M.useMemo)(()=>e.getDocRanges(),[]);return(0,M.useEffect)(()=>{n.length||t.closePanel()},[n]),n},"useDocRanges"),ru=/* @__PURE__ */_(()=>{var e,t,n;let i=(0,g.useDependency)(g.IUniverInstanceService).getCurrentUnitForType(g.UniverInstanceType.UNIVER_DOC),r=rc();if(!i||0===r.length)return[];let a=r[0].segmentId;return null!=(n=tK(r,null!=(t=null==(e=i.getSelfOrHeaderFooterModel(a).getBody())?void 0:e.paragraphs)?t:[]))?n:[]},"useCurrentParagraph"),rg=/* @__PURE__ */_((e,t)=>{let n=(0,g.useDependency)(g.ICommandService),[i,r]=(0,M.useState)(()=>{var n,i;let r=e[0];return r?String(null!=(i=null==(n=r.paragraphStyle)?void 0:n.horizontalAlign)?i:t):t});return[i,/* @__PURE__ */_(e=>(r(e),n.executeCommand(rd.id,{paragraph:{horizontalAlign:Number(e)}})),"horizontalAlignSet")]},"useFirstParagraphHorizontalAlign"),rh=/* @__PURE__ */_(e=>{let t=(0,g.useDependency)(g.ICommandService),[n,i]=(0,M.useState)(()=>{var t;let n=e[0];return n?(0,p.getNumberUnitValue)(null==(t=n.paragraphStyle)?void 0:t.indentStart,0):0});return[n,/* @__PURE__ */_(e=>(i(e),t.executeCommand(rd.id,{paragraph:{indentStart:{v:e}}})),"indentStartSet")]},"useFirstParagraphIndentStart"),rp=/* @__PURE__ */_(e=>{let t=(0,g.useDependency)(g.ICommandService),[n,i]=(0,M.useState)(()=>{var t;let n=e[0];return n?(0,p.getNumberUnitValue)(null==(t=n.paragraphStyle)?void 0:t.indentEnd,0):0});return[n,/* @__PURE__ */_(e=>(i(e),t.executeCommand(rd.id,{paragraph:{indentEnd:{v:e}}})),"indentEndSet")]},"useFirstParagraphIndentEnd"),rm=/* @__PURE__ */_(e=>{let t=(0,g.useDependency)(g.ICommandService),[n,i]=(0,M.useState)(()=>{var t;let n=e[0];return n?(0,p.getNumberUnitValue)(null==(t=n.paragraphStyle)?void 0:t.indentFirstLine,0):0});return[n,/* @__PURE__ */_(e=>(i(e),t.executeCommand(rd.id,{paragraph:{indentFirstLine:{v:e}}})),"indentFirstLineSet")]},"useFirstParagraphIndentFirstLine"),rf=/* @__PURE__ */_(e=>{let t=(0,g.useDependency)(g.ICommandService),[n,i]=(0,M.useState)(()=>{var t;let n=e[0];return n?(0,p.getNumberUnitValue)(null==(t=n.paragraphStyle)?void 0:t.hanging,0):0});return[n,/* @__PURE__ */_(e=>(i(e),t.executeCommand(rd.id,{paragraph:{hanging:{v:e}}})),"hangingSet")]},"useFirstParagraphIndentHanging"),rI=/* @__PURE__ */_(e=>{let t=(0,g.useDependency)(g.ICommandService),[n,i]=(0,M.useState)(()=>{var t;let n=e[0];return n?(0,p.getNumberUnitValue)(null==(t=n.paragraphStyle)?void 0:t.spaceAbove,0):0});return[n,/* @__PURE__ */_(e=>(i(e),t.executeCommand(rd.id,{paragraph:{spaceAbove:{v:e}}})),"spaceAboveSet")]},"useFirstParagraphIndentSpaceAbove"),rS=/* @__PURE__ */_(e=>{let t=(0,g.useDependency)(g.ICommandService),[n,i]=(0,M.useState)(()=>{var t;let n=e[0];return n?(0,p.getNumberUnitValue)(null==(t=n.paragraphStyle)?void 0:t.spaceBelow,0):0});return[n,/* @__PURE__ */_(e=>(i(e),t.executeCommand(rd.id,{paragraph:{spaceBelow:{v:e}}})),"spaceBelowSet")]},"useFirstParagraphSpaceBelow"),rE=/* @__PURE__ */_(e=>{let t=(0,g.useDependency)(g.ICommandService),n=(0,g.useDependency)(p.IRenderManagerService),i=(0,g.useDependency)(g.IUniverInstanceService),r=(0,M.useMemo)(()=>{var e;let t=i.getCurrentUnitForType(g.UniverInstanceType.UNIVER_DOC);if(t)return null==(e=n.getRenderById(null==t?void 0:t.getUnitId()))?void 0:e.with(h.DocSkeletonManagerService).getSkeleton()},[]),a=(0,M.useMemo)(()=>new I.BehaviorSubject({}),[]),[o,s]=(0,M.useState)(()=>{var t,n;let i=e[0];return i&&null!=(n=null==(t=i.paragraphStyle)?void 0:t.lineSpacing)?n:1}),l=(0,M.useRef)(o),[A,d]=(0,M.useState)(()=>{var t,n;let i=e[0];return i&&null!=(n=null==(t=i.paragraphStyle)?void 0:t.spacingRule)?n:g.SpacingRule.AUTO}),c=/* @__PURE__ */_(async e=>{s(e),a.next({lineSpacing:e,spacingRule:A})},"lineSpacingSet"),u=/* @__PURE__ */_(async t=>{if(t!==A){let n=l.current;if(t===g.SpacingRule.AT_LEAST){let t=null==r?void 0:r.findNodeByCharIndex(e[0].startIndex),i=null==t?void 0:t.parent,a=null==i?void 0:i.parent;(null==a?void 0:a.contentHeight)!==void 0&&(n=Math.max(a.contentHeight,n))}else n>5&&(n=2);l.current=o,c(n),d(t),a.next({spacingRule:t})}},"spacingRuleSet");return(0,M.useEffect)(()=>{let e=a.pipe((0,v.filter)(e=>!!Object.keys(e).length),(0,P.bufferTime)(16),(0,v.filter)(e=>!!e.length),(0,C.map)(e=>e.reduce((e,t)=>(Object.keys(t).forEach(n=>{e[n]=t[n]}),e),{}))).subscribe(e=>t.executeCommand(rd.id,{paragraph:{...e}}));return()=>e.unsubscribe()},[]),{lineSpacing:[o,c],spacingRule:[A,u]}},"useFirstParagraphLineSpacing"),rv={paragraphSettingIconList:"univer-paragraph-setting-icon-list",paragraphSettingIconListItem:"univer-paragraph-setting-icon-list-item",paragraphSettingIconListActive:"univer-paragraph-setting-icon-list-active",paragraphSettingTitle:"univer-paragraph-setting-title",paragraphSettingLabel:"univer-paragraph-setting-label",paragraphSettingMtBase:"univer-paragraph-setting-mt-base",paragraphSettingFlexCol:"univer-paragraph-setting-flex-col",paragraphSettingSpaceLine:"univer-paragraph-setting-space-line"},rT=/* @__PURE__ */_(e=>{let{value:t,onChange:n,className:i="",min:r=0,max:a=100,step:o=1}=e,s=M.useRef(null);return /* @__PURE__ */iI.jsx(D.InputNumber,{step:o,ref:s,min:r,max:a,value:t,onChange:/* @__PURE__ */_(e=>{n(null!=e?e:0).finally(()=>{setTimeout(()=>{var e;null==(e=s.current)||e.focus()},30)})},"onChange"),className:i})},"AutoFocusInputNumber");function rC(){let e=(0,g.useDependency)(g.LocaleService),t=(0,M.useMemo)(()=>[{label:e.t("toolbar.alignLeft"),value:String(g.HorizontalAlign.LEFT),icon:/* @__PURE__ */iI.jsx(nO,{})},{label:e.t("toolbar.alignCenter"),value:String(g.HorizontalAlign.CENTER),icon:/* @__PURE__ */iI.jsx(nx,{})},{label:e.t("toolbar.alignRight"),value:String(g.HorizontalAlign.RIGHT),icon:/* @__PURE__ */iI.jsx(nM,{})},{label:e.t("toolbar.alignJustify"),value:String(g.HorizontalAlign.JUSTIFIED),icon:/* @__PURE__ */iI.jsx(ny,{})}],[]),n=ru(),[i,r]=rg(n,t[0].value),[a,o]=rh(n),[s,l]=rp(n),[A,d]=rm(n),[c,u]=rf(n),[h,p]=rI(n),[m,f]=rS(n),{lineSpacing:[I,S],spacingRule:[E,v]}=rE(n),T=(0,M.useMemo)(()=>E===g.SpacingRule.AUTO?{min:1,max:5,step:I<2?.5:1}:{min:1,max:100},[E,I]);return /* @__PURE__ */iI.jsxs("div",{className:rv.paragraphSetting,children:[/* @__PURE__ */iI.jsx("div",{className:rv.paragraphSettingTitle,children:e.t("doc.paragraphSetting.alignment")}),/* @__PURE__ */iI.jsx("div",{className:`${rv.paragraphSettingIconList} ${rv.paragraphSettingMtBase}`,children:t.map(e=>/* @__PURE__ */iI.jsx(D.Tooltip,{title:e.label,placement:"bottom",children:/* @__PURE__ */iI.jsx("span",{className:(0,N.default)(rv.paragraphSettingIconListItem,{[rv.paragraphSettingIconListActive]:i===e.value}),onClick:/* @__PURE__ */_(()=>r(e.value),"onClick"),children:e.icon})},e.value))}),/* @__PURE__ */iI.jsx("div",{className:rv.paragraphSettingTitle,children:e.t("doc.paragraphSetting.indentation")}),/* @__PURE__ */iI.jsxs("div",{children:[/* @__PURE__ */iI.jsxs("div",{className:rv.paragraphSettingFlexCol,children:[/* @__PURE__ */iI.jsxs("div",{className:rv.paragraphSettingLabel,children:[e.t("doc.paragraphSetting.left"),"(px)"]}),/* @__PURE__ */iI.jsx(rT,{className:rv.paragraphSettingMtBase,value:a,onChange:/* @__PURE__ */_(e=>o(null!=e?e:0),"onChange")})]}),/* @__PURE__ */iI.jsxs("div",{className:rv.paragraphSettingFlexCol,children:[/* @__PURE__ */iI.jsxs("div",{className:rv.paragraphSettingLabel,children:[e.t("doc.paragraphSetting.right"),"(px)"]}),/* @__PURE__ */iI.jsx(rT,{className:rv.paragraphSettingMtBase,value:s,onChange:/* @__PURE__ */_(e=>l(null!=e?e:0),"onChange")})]}),/* @__PURE__ */iI.jsxs("div",{className:rv.paragraphSettingFlexCol,children:[/* @__PURE__ */iI.jsxs("div",{className:rv.paragraphSettingLabel,children:[e.t("doc.paragraphSetting.firstLine"),"(px)"]}),/* @__PURE__ */iI.jsx(rT,{className:rv.paragraphSettingMtBase,value:A,onChange:/* @__PURE__ */_(e=>d(null!=e?e:0),"onChange")})]}),/* @__PURE__ */iI.jsxs("div",{className:rv.paragraphSettingFlexCol,children:[/* @__PURE__ */iI.jsxs("div",{className:rv.paragraphSettingLabel,children:[e.t("doc.paragraphSetting.hanging"),"(px)"]}),/* @__PURE__ */iI.jsx(rT,{className:rv.paragraphSettingMtBase,value:c,onChange:/* @__PURE__ */_(e=>u(null!=e?e:0),"onChange")})]})]}),/* @__PURE__ */iI.jsx("div",{className:rv.paragraphSettingTitle,children:e.t("doc.paragraphSetting.spacing")}),/* @__PURE__ */iI.jsxs("div",{children:[/* @__PURE__ */iI.jsxs("div",{className:rv.paragraphSettingFlexCol,children:[/* @__PURE__ */iI.jsxs("div",{className:rv.paragraphSettingLabel,children:[e.t("doc.paragraphSetting.before"),"(px)"]}),/* @__PURE__ */iI.jsx(rT,{className:rv.paragraphSettingMtBase,value:h,onChange:/* @__PURE__ */_(e=>p(null!=e?e:0),"onChange")})]}),/* @__PURE__ */iI.jsxs("div",{className:rv.paragraphSettingFlexCol,children:[/* @__PURE__ */iI.jsxs("div",{className:rv.paragraphSettingLabel,children:[e.t("doc.paragraphSetting.after"),"(px)"]}),/* @__PURE__ */iI.jsx(rT,{className:rv.paragraphSettingMtBase,value:m,onChange:/* @__PURE__ */_(e=>f(null!=e?e:0),"onChange")})]}),/* @__PURE__ */iI.jsxs("div",{className:rv.paragraphSettingFlexCol,children:[/* @__PURE__ */iI.jsx("div",{className:rv.paragraphSettingLabel,children:e.t("doc.paragraphSetting.lineSpace")}),/* @__PURE__ */iI.jsxs("div",{className:`${rv.paragraphSettingMtBase} ${rv.paragraphSettingSpaceLine}`,style:{width:162},children:[/* @__PURE__ */iI.jsx(D.Select,{value:`${E}`,options:[{label:e.t("doc.paragraphSetting.multiSpace"),value:`${g.SpacingRule.AUTO}`},{label:e.t("doc.paragraphSetting.fixedValue"),value:`${g.SpacingRule.AT_LEAST}`}],onChange:/* @__PURE__ */_(e=>v(Number(e)),"onChange")}),/* @__PURE__ */iI.jsx(rT,{...T,value:I,onChange:/* @__PURE__ */_(e=>S(null!=e?e:0),"onChange")})]})]})]})]})}_(rC,"ParagraphSetting");let ry=/* @__PURE__ */_((e,t)=>t.length===e.length&&e.some(e=>t.some(t=>t.startOffset===e.startOffset&&t.endOffset===e.endOffset)),"isRangesEqual"),rb=/* @__PURE__ */_((e,t)=>e.some(e=>t.some(t=>{let{startOffset:n,endOffset:i}=e,{startOffset:r,endOffset:a}=t;return null!=n&&null!=i&&null!=r&&null!=a&&n<=a&&i>=r})),"isRangesIntersection");function rx(){let e=(0,g.useDependency)(g.ICommandService),t=(0,g.useDependency)(g.LocaleService),n=(0,g.useObservable)(t.currentLocale$),[i,r]=(0,M.useState)(""),a=(0,M.useRef)([]);return(0,M.useEffect)(()=>{let t=e.onCommandExecuted(e=>{var t;if(h.SetTextSelectionsOperation.id===e.id){let t=e.params.ranges;ry(t,a.current)||r((0,g.generateRandomId)(4)),a.current=t}if(h.RichTextEditingMutation.id===e.id){let n=e.params,i=null!=(t=n.textRanges)?t:[];n.trigger!==rd.id&&rb(i,a.current)&&r((0,g.generateRandomId)(4))}});return()=>t.dispose()},[]),(0,M.useEffect)(()=>{r((0,g.generateRandomId)(4))},[n]),/* @__PURE__ */iI.jsx(rC,{},i)}_(rx,"ParagraphSettingIndex");var rR=Object.defineProperty,rO=Object.getOwnPropertyDescriptor,rB=/* @__PURE__ */_((e,t,n,i)=>{for(var r,a=i>1?void 0:i?rO(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&rR(t,n,a),a},"__decorateClass$m"),rM=/* @__PURE__ */_((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$m");let rD="doc_ui_paragraph-setting-panel",rN=(_(aS=class extends g.Disposable{constructor(e,t,n){super(),w(this,"_id"),this._commandService=e,this._componentManager=t,this._sidebarService=n,this._init()}_init(){this.disposeWithMe(this._componentManager.register(rD,rx))}openPanel(){let e={header:{title:"doc.slider.paragraphSetting"},id:this._id,children:{label:rD},width:300};this._sidebarService.open(e)}closePanel(){this._sidebarService.close(this._id)}},"DocParagraphSettingController"),aS);rN=rB([(0,g.OnLifecycle)(g.LifecycleStages.Rendered,rN),rM(0,g.ICommandService),rM(1,(0,g.Inject)(m.ComponentManager)),rM(2,(0,g.Inject)(m.ISidebarService))],rN);let rP={id:"sidebar.operation.doc-paragraph-setting-panel",type:g.CommandType.OPERATION,handler:/* @__PURE__ */_(e=>(e.get(rN).openPanel(),!0),"handler")},rQ=/* @__PURE__ */_(e=>{let t=e.get(h.DocSelectionManagerService);return new b.Observable(e=>{let n=t.textSelection$.subscribe(()=>{let n=t.getActiveTextRange();n&&!n.collapsed?e.next(!1):e.next(!0)});return()=>n.unsubscribe()})},"getDisableOnCollapsedObservable");function rU(e){if(e.length<2)return!0;let t=e.map(e=>e.tableId);return t.every(e=>e===t[0])}_(rU,"inSameTable");let r_=/* @__PURE__ */_(e=>{let t=e.get(h.DocSelectionManagerService),n=e.get(g.IUniverInstanceService);return new b.Observable(e=>{let i=t.textSelection$.subscribe(()=>{var i;let r=t.getCurrentRectRanges(),a=t.getActiveTextRange();if(r&&r.length&&rU(r)){e.next(!1);return}if(a&&(null==r||0===r.length)){let{segmentId:t,startOffset:r,endOffset:o}=a,s=n.getCurrentUniverDocInstance(),l=null==(i=null==s?void 0:s.getSelfOrHeaderFooterModel(t).getBody())?void 0:i.tables;if(l&&l.length&&l.some(e=>{let{startIndex:t,endIndex:n}=e;return r>t&&r<n||o>t&&o<n})){e.next(!1);return}}e.next(!0)});return()=>i.unsubscribe()})},"getDisableWhenSelectionNotInTableObservable"),rw=/* @__PURE__ */_(e=>({id:ta.name,commandId:ta.id,type:m.MenuItemType.BUTTON,icon:"Copy",title:"rightClick.copy",disabled$:rQ(e),hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC)}),"CopyMenuFactory"),rL=/* @__PURE__ */_(e=>({id:rP.id,type:m.MenuItemType.BUTTON,icon:"MenuSingle24",title:"doc.menu.paragraphSetting",hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC)}),"ParagraphSettingMenuFactory"),rF=/* @__PURE__ */_(e=>({id:to.id,type:m.MenuItemType.BUTTON,icon:"Copy",title:"rightClick.cut",disabled$:rQ(e),hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC)}),"CutMenuFactory"),rk=/* @__PURE__ */_(e=>({id:ts.id,type:m.MenuItemType.BUTTON,icon:"PasteSpecial",title:"rightClick.paste",hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC)}),"PasteMenuFactory"),rH=/* @__PURE__ */_(e=>({id:eH.id,type:m.MenuItemType.BUTTON,icon:"PasteSpecial",title:"rightClick.delete",disabled$:rQ(e),hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC)}),"DeleteMenuFactory"),rV="doc.menu.table-insert";function rj(e){return{id:rV,type:m.MenuItemType.SUBITEMS,title:"table.insert",icon:"Insert",hidden$:(0,S.combineLatest)((0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC),r_(e),(e,t)=>e||t)}}function rW(e){return{id:ni.id,type:m.MenuItemType.BUTTON,title:"table.insertRowAbove",icon:"InsertRowAbove",disabled$:r_(e),hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC)}}function rz(e){return{id:nr.id,type:m.MenuItemType.BUTTON,title:"table.insertRowBelow",icon:"InsertRowBelow",disabled$:r_(e),hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC)}}function rG(e){return{id:na.id,type:m.MenuItemType.BUTTON,title:"table.insertColumnLeft",icon:"LeftInsertColumn",disabled$:r_(e),hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC)}}function rY(e){return{id:no.id,type:m.MenuItemType.BUTTON,title:"table.insertColumnRight",icon:"RightInsertColumn",disabled$:r_(e),hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC)}}_(rj,"TableInsertMenuItemFactory"),_(rW,"InsertRowBeforeMenuItemFactory"),_(rz,"InsertRowAfterMenuItemFactory"),_(rG,"InsertColumnLeftMenuItemFactory"),_(rY,"InsertColumnRightMenuItemFactory");let rK="doc.menu.table-delete";function rq(e){return{id:rK,type:m.MenuItemType.SUBITEMS,title:"table.delete",icon:"Reduce",hidden$:(0,S.combineLatest)((0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC),r_(e),(e,t)=>e||t)}}function rX(e){return{id:t5.id,type:m.MenuItemType.BUTTON,title:"table.deleteRows",icon:"DeleteRow",disabled$:r_(e),hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC)}}function rJ(e){return{id:t7.id,type:m.MenuItemType.BUTTON,title:"table.deleteColumns",icon:"DeleteColumn",disabled$:r_(e),hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC)}}function rZ(e){return{id:ne.id,type:m.MenuItemType.BUTTON,title:"table.deleteTable",icon:"GridSingle",disabled$:r_(e),hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC)}}function r$(e){let t=e.get(g.IUniverInstanceService),n=e.get(p.IRenderManagerService);return new b.Observable(e=>{let i=t.focused$.subscribe(i=>{if(null==i||t.getUnitType(i)!==g.UniverInstanceType.UNIVER_DOC)return e.next(!0);let r=n.getRenderById(i);if(null==r)return e.next(!0);r.with(h.DocSkeletonManagerService).getViewModel().editAreaChange$.subscribe(t=>{e.next(t===p.DocumentEditArea.HEADER||t===p.DocumentEditArea.FOOTER)})}),r=n.getCurrentTypeOfRenderer(g.UniverInstanceType.UNIVER_DOC);if(null==r)return e.next(!0);let a=r.with(h.DocSkeletonManagerService).getViewModel();return e.next(a.getEditArea()!==p.DocumentEditArea.BODY),()=>i.unsubscribe()})}function r0(e){let t=e.get(h.DocSelectionManagerService),n=e.get(g.IUniverInstanceService);return new b.Observable(i=>{let r=t.textSelection$.subscribe(t=>{if(null==t){i.next(!0);return}let{textRanges:r}=t;if(1!==r.length){i.next(!0);return}let{collapsed:a,startNodePosition:o,startOffset:s}=r[0];if(!a||null==s){i.next(!0);return}let l=n.getCurrentUniverDocInstance();if(null==l){i.next(!0);return}let A=X(e,l.getUnitId());if(null==A||A.getViewModel().getCustomRangeRaw(s)){i.next(!0);return}if(null!=o){let{path:e}=o;if(-1!==e.indexOf("cells")){i.next(!0);return}}i.next(!1)});return()=>r.unsubscribe()})}function r1(e){let t=e.get(h.DocSelectionManagerService);return new b.Observable(e=>{let n=t.textSelection$.subscribe(t=>{if(null==t){e.next(!0);return}let{textRanges:n,rectRanges:i}=t;if(0===n.length&&0===i.length){e.next(!0);return}e.next(!1)});return()=>n.unsubscribe()})}function r9(e){let t=e.get(g.ICommandService);return{id:tu.id,type:m.MenuItemType.BUTTON,icon:"BoldSingle",title:"Set bold",tooltip:"toolbar.bold",activated$:new b.Observable(n=>{let i=t.onCommandExecuted(t=>{var i;let r=t.id;if(r===h.SetTextSelectionsOperation.id||r===tQ.id){let t=ap(e);if(null==t){n.next(!1);return}let r=null==(i=t.ts)?void 0:i.bl;n.next(r===g.BooleanNumber.TRUE)}});return n.next(!1),i.dispose}),disabled$:r1(e),hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC)}}function r3(e){let t=e.get(g.ICommandService);return{id:th.id,type:m.MenuItemType.BUTTON,icon:"ItalicSingle",title:"Set italic",tooltip:"toolbar.italic",activated$:new b.Observable(n=>{let i=t.onCommandExecuted(t=>{var i;let r=t.id;if(r===h.SetTextSelectionsOperation.id||r===tQ.id){let t=ap(e);if(null==t){n.next(!1);return}let r=null==(i=t.ts)?void 0:i.it;n.next(r===g.BooleanNumber.TRUE)}});return n.next(!1),i.dispose}),disabled$:r1(e),hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC)}}function r2(e){let t=e.get(g.ICommandService);return{id:tm.id,type:m.MenuItemType.BUTTON,icon:"UnderlineSingle",title:"Set underline",tooltip:"toolbar.underline",activated$:new b.Observable(n=>{let i=t.onCommandExecuted(t=>{var i;let r=t.id;if(r===h.SetTextSelectionsOperation.id||r===tQ.id){let t=ap(e);if(null==t){n.next(!1);return}let r=null==(i=t.ts)?void 0:i.ul;n.next((null==r?void 0:r.s)===g.BooleanNumber.TRUE)}});return n.next(!1),i.dispose}),disabled$:r1(e),hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC)}}function r4(e){let t=e.get(g.ICommandService);return{id:tI.id,type:m.MenuItemType.BUTTON,icon:"StrikethroughSingle",title:"Set strike through",tooltip:"toolbar.strikethrough",activated$:new b.Observable(n=>{let i=t.onCommandExecuted(t=>{var i;let r=t.id;if(r===h.SetTextSelectionsOperation.id||r===tQ.id){let t=ap(e);if(null==t){n.next(!1);return}let r=null==(i=t.ts)?void 0:i.st;n.next((null==r?void 0:r.s)===g.BooleanNumber.TRUE)}});return n.next(!1),i.dispose}),disabled$:r1(e),hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC)}}function r8(e){let t=e.get(g.ICommandService);return{id:tE.id,type:m.MenuItemType.BUTTON,icon:"SubscriptSingle",tooltip:"toolbar.subscript",activated$:new b.Observable(n=>{let i=t.onCommandExecuted(t=>{var i;let r=t.id;if(r===h.SetTextSelectionsOperation.id||r===tQ.id){let t=ap(e);if(null==t){n.next(!1);return}let r=null==(i=t.ts)?void 0:i.va;n.next(r===g.BaselineOffset.SUBSCRIPT)}});return n.next(!1),i.dispose}),disabled$:r1(e),hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC)}}function r6(e){let t=e.get(g.ICommandService);return{id:tT.id,type:m.MenuItemType.BUTTON,icon:"SuperscriptSingle",tooltip:"toolbar.superscript",activated$:new b.Observable(n=>{let i=t.onCommandExecuted(t=>{var i;let r=t.id;if(r===h.SetTextSelectionsOperation.id||r===tQ.id){let t=ap(e);if(null==t){n.next(!1);return}let r=null==(i=t.ts)?void 0:i.va;n.next(r===g.BaselineOffset.SUPERSCRIPT)}});return n.next(!1),i.dispose}),disabled$:r1(e),hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC)}}function r5(e){let t=e.get(g.ICommandService);return{id:tx.id,tooltip:"toolbar.font",type:m.MenuItemType.SELECTOR,label:iH,selections:(0,m.FONT_FAMILY_LIST).map(e=>({label:{name:iV,hoverable:!0},value:e.value})),value$:new b.Observable(n=>{let i=m.FONT_FAMILY_LIST[0].value,r=t.onCommandExecuted(t=>{var r;let a=t.id;if(a===h.SetTextSelectionsOperation.id||a===tx.id){let t=ap(e);if(null==t){n.next(i);return}let a=null==(r=t.ts)?void 0:r.ff;n.next(null!=a?a:i)}});return n.next(i),r.dispose}),disabled$:r1(e),hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC)}}function r7(e){let t=e.get(g.ICommandService);return{id:ty.id,type:m.MenuItemType.SELECTOR,tooltip:"toolbar.fontSize",label:{name:ij,props:{min:1,max:400}},selections:m.FONT_SIZE_LIST,value$:new b.Observable(n=>{let i=t.onCommandExecuted(t=>{var i;let r=t.id;if(r===h.SetTextSelectionsOperation.id||r===ty.id){let t=ap(e);if(null==t){n.next(14);return}let r=null==(i=t.ts)?void 0:i.fs;n.next(null!=r?r:14)}});return n.next(14),i.dispose}),disabled$:r1(e),hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC)}}function ae(e){let t=e.get(g.ICommandService),n=e.get(g.ThemeService);return{id:tO.id,icon:"FontColor",tooltip:"toolbar.textColor.main",type:m.MenuItemType.BUTTON_SELECTOR,selections:[{label:{name:ik,hoverable:!1}}],value$:new b.Observable(e=>{let i=n.getCurrentTheme().textColor,r=t.onCommandExecuted(t=>{if(t.id===tO.id){let n=t.params.value;e.next(null!=n?n:i)}});return e.next(i),r.dispose}),disabled$:r1(e),hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC)}}function at(e){return{id:iL.id,type:m.MenuItemType.BUTTON,icon:"FreezeRowSingle",tooltip:"toolbar.headerFooter",hidden$:(0,S.combineLatest)((0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC),(0,m.getHeaderFooterMenuHiddenObservable)(e),(e,t)=>e||t)}}_(rq,"TableDeleteMenuItemFactory"),_(rX,"DeleteRowsMenuItemFactory"),_(rJ,"DeleteColumnsMenuItemFactory"),_(rZ,"DeleteTableMenuItemFactory"),_(r$,"getInsertTableHiddenObservable"),_(r0,"getTableDisabledObservable"),_(r1,"disableMenuWhenNoDocRange"),_(r9,"BoldMenuItemFactory"),_(r3,"ItalicMenuItemFactory"),_(r2,"UnderlineMenuItemFactory"),_(r4,"StrikeThroughMenuItemFactory"),_(r8,"SubscriptMenuItemFactory"),_(r6,"SuperscriptMenuItemFactory"),_(r5,"FontFamilySelectorMenuItemFactory"),_(r7,"FontSizeSelectorMenuItemFactory"),_(ae,"TextColorSelectorMenuItemFactory"),_(at,"HeaderFooterMenuItemFactory");let an="doc.menu.table";function ai(e){return{id:an,type:m.MenuItemType.SUBITEMS,icon:"GridSingle",tooltip:"toolbar.table.main",disabled$:r0(e),hidden$:(0,S.combineLatest)((0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC),r$(e),(0,m.getHeaderFooterMenuHiddenObservable)(e),(e,t,n)=>e||t||n)}}function ar(e){return{id:nu.id,title:"toolbar.table.insert",type:m.MenuItemType.BUTTON,hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC)}}function aa(e){let t=e.get(g.ICommandService);return{id:tJ.id,type:m.MenuItemType.BUTTON,icon:"LeftJustifyingSingle",tooltip:"toolbar.alignLeft",disabled$:r1(e),activated$:new b.Observable(n=>{let i=t.onCommandExecuted(t=>{var i;let r=t.id;if(r===h.SetTextSelectionsOperation.id||r===tX.id){let t=am(e);if(null==t)return;let r=null==(i=t.paragraphStyle)?void 0:i.horizontalAlign;n.next(r===g.HorizontalAlign.LEFT)}});return n.next(!1),i.dispose}),hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC)}}function ao(e){let t=e.get(g.ICommandService);return{id:tZ.id,type:m.MenuItemType.BUTTON,icon:"HorizontallySingle",tooltip:"toolbar.alignCenter",activated$:new b.Observable(n=>{let i=t.onCommandExecuted(t=>{var i;let r=t.id;if(r===h.SetTextSelectionsOperation.id||r===tX.id){let t=am(e);if(null==t)return;let r=null==(i=t.paragraphStyle)?void 0:i.horizontalAlign;n.next(r===g.HorizontalAlign.CENTER)}});return n.next(!1),i.dispose}),disabled$:r1(e),hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC)}}function as(e){let t=e.get(g.ICommandService);return{id:t$.id,type:m.MenuItemType.BUTTON,icon:"RightJustifyingSingle",tooltip:"toolbar.alignRight",activated$:new b.Observable(n=>{let i=t.onCommandExecuted(t=>{var i;let r=t.id;if(r===h.SetTextSelectionsOperation.id||r===tX.id){let t=am(e);if(null==t)return;let r=null==(i=t.paragraphStyle)?void 0:i.horizontalAlign;n.next(r===g.HorizontalAlign.RIGHT)}});return n.next(!1),i.dispose}),disabled$:r1(e),hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC)}}function al(e){let t=e.get(g.ICommandService);return{id:t0.id,type:m.MenuItemType.BUTTON,icon:"AlignTextBothSingle",tooltip:"toolbar.alignJustify",activated$:new b.Observable(n=>{let i=t.onCommandExecuted(t=>{var i;let r=t.id;if(r===h.SetTextSelectionsOperation.id||r===tX.id){let t=am(e);if(null==t)return;let r=null==(i=t.paragraphStyle)?void 0:i.horizontalAlign;n.next(r===g.HorizontalAlign.JUSTIFIED)}});return n.next(!1),i.dispose}),disabled$:r1(e),hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC)}}_(ai,"TableMenuFactory"),_(ar,"InsertTableMenuFactory"),_(aa,"AlignLeftMenuItemFactory"),_(ao,"AlignCenterMenuItemFactory"),_(as,"AlignRightMenuItemFactory"),_(al,"AlignJustifyMenuItemFactory");let aA=/* @__PURE__ */_(e=>new b.Observable(t=>{let n;let i=e.get(g.IUniverInstanceService),r=e.get(h.DocSelectionManagerService),a=i.focused$.subscribe(e=>{if(null==n||n.unsubscribe(),null==e)return;let a=i.getUniverDocInstance(e);null!=a&&(n=r.textSelection$.subscribe(()=>{var e,n;let i=r.getActiveTextRange();if(i){let r;let o=a.getSelfOrHeaderFooterModel(null==i?void 0:i.segmentId);if(tG(i,null!=(n=null==(e=o.getBody())?void 0:e.paragraphs)?n:[]).every(e=>{var t;return r||(r=null==(t=e.bullet)?void 0:t.listType),e.bullet&&e.bullet.listType===r})){t.next(r);return}}t.next(void 0)}))});return()=>{a.unsubscribe(),null==n||n.unsubscribe()}}),"listValueFactory$");function ad(e){return{id:tW.id,type:m.MenuItemType.BUTTON_SELECTOR,selections:[{label:{name:iX,hoverable:!1},value$:aA(e)}],icon:"OrderSingle",tooltip:"toolbar.order",hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC),disabled$:r1(e),activated$:aA(e).pipe((0,C.map)(e=>e&&0===e.indexOf("ORDER_LIST")))}}function ac(e){return{id:tH.id,type:m.MenuItemType.BUTTON_SELECTOR,selections:[{label:{name:iJ,hoverable:!1},value$:aA(e)}],icon:"UnorderSingle",tooltip:"toolbar.unorder",disabled$:r1(e),hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC),activated$:aA(e).pipe((0,C.map)(e=>e&&0===e.indexOf("BULLET_LIST")))}}function au(e){return{id:tV.id,type:m.MenuItemType.BUTTON,icon:"TodoList",tooltip:"toolbar.checklist",disabled$:r1(e),hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC),activated$:aA(e).pipe((0,C.map)(e=>e&&0===e.indexOf("CHECK_LIST")))}}function ag(e){return{id:tN.id,type:m.MenuItemType.BUTTON,title:"toolbar.resetColor",icon:"NoColor"}}function ah(e){let t=e.get(g.ICommandService),n=e.get(g.ThemeService);return{id:tM.id,tooltip:"toolbar.fillColor.main",type:m.MenuItemType.BUTTON_SELECTOR,icon:"PaintBucket",selections:[{label:{name:ik,hoverable:!1}}],value$:new b.Observable(e=>{let i=n.getCurrentTheme().primaryColor,r=t.onCommandExecuted(t=>{if(t.id===tM.id){let n=t.params.value;e.next(null!=n?n:i)}});return e.next(i),r.dispose}),disabled$:r1(e),hidden$:(0,m.getMenuHiddenObservable)(e,g.UniverInstanceType.UNIVER_DOC)}}function ap(e){var t;let n;let i=e.get(g.IUniverInstanceService),r=e.get(h.DocSelectionManagerService),a=i.getCurrentUniverDocInstance(),o=r.getActiveTextRange();if(null==a||null==o)return;let{startOffset:s,segmentId:l}=o,A=null==(t=a.getSelfOrHeaderFooterModel(l).getBody())?void 0:t.textRuns;if(null!=A){for(let e=A.length-1;e>=0;e--){let t=A[e];if(t.st<=s&&s<=t.ed){n=t;break}}return n}}function am(e){var t;let n=e.get(g.IUniverInstanceService),i=e.get(h.DocSelectionManagerService),r=n.getCurrentUniverDocInstance(),a=i.getActiveTextRange();if(null==r||null==a)return;let{startOffset:o,segmentId:s}=a,l=null==(t=r.getSelfOrHeaderFooterModel(s).getBody())?void 0:t.paragraphs;if(null==l)return;let A=-1;for(let e of l){let{startIndex:t}=e;if(o>A&&o<=t)return e;A=t}return null}_(ad,"OrderListMenuItemFactory"),_(ac,"BulletListMenuItemFactory"),_(au,"CheckListMenuItemFactory"),_(ag,"ResetBackgroundColorMenuItemFactory"),_(ah,"BackgroundColorSelectorMenuItemFactory"),_(ap,"getFontStyleAtCursor"),_(am,"getParagraphStyleAtCursor");let af={[m.RibbonStartGroup.FORMAT]:{[tu.id]:{order:0,menuItemFactory:r9},[th.id]:{order:1,menuItemFactory:r3},[tm.id]:{order:2,menuItemFactory:r2},[tI.id]:{order:3,menuItemFactory:r4},[tE.id]:{order:4,menuItemFactory:r8},[tT.id]:{order:5,menuItemFactory:r6},[ty.id]:{order:6,menuItemFactory:r7},[tx.id]:{order:7,menuItemFactory:r5},[tO.id]:{order:8,menuItemFactory:ae},[tM.id]:{order:9,menuItemFactory:ah,[tN.id]:{order:0,menuItemFactory:ag}}},[m.RibbonStartGroup.LAYOUT]:{[an]:{order:1,menuItemFactory:ai,[nu.id]:{order:0,menuItemFactory:ar}},[tJ.id]:{order:2,menuItemFactory:aa},[tZ.id]:{order:3,menuItemFactory:ao},[t$.id]:{order:4,menuItemFactory:as},[t0.id]:{order:5,menuItemFactory:al},[tW.id]:{order:6,menuItemFactory:ad},[tH.id]:{order:7,menuItemFactory:ac},[tV.id]:{order:8,menuItemFactory:au},[iL.id]:{order:9,menuItemFactory:at}},[m.ContextMenuPosition.MAIN_AREA]:{[m.ContextMenuGroup.FORMAT]:{[ta.name]:{order:0,menuItemFactory:rw},[to.id]:{order:1,menuItemFactory:rF},[ts.id]:{order:2,menuItemFactory:rk},[eH.id]:{order:3,menuItemFactory:rH}},[m.ContextMenuGroup.LAYOUT]:{[rP.id]:{order:0,menuItemFactory:rL},[rV]:{order:1,menuItemFactory:rj,[ni.id]:{order:1,menuItemFactory:rW},[nr.id]:{order:2,menuItemFactory:rz},[na.id]:{order:3,menuItemFactory:rG},[no.id]:{order:4,menuItemFactory:rY}},[rK]:{order:2,menuItemFactory:rq,[t5.id]:{order:1,menuItemFactory:rX},[t7.id]:{order:2,menuItemFactory:rJ},[ne.id]:{order:3,menuItemFactory:rZ}}}}};var aI,aS,aE,av=Object.defineProperty,aT=Object.getOwnPropertyDescriptor,aC=/* @__PURE__ */_((e,t,n,i)=>{for(var r,a=i>1?void 0:i?aT(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&av(t,n,a),a},"__decorateClass$l"),ay=/* @__PURE__ */_((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$l");let ab=(_(aE=class extends g.Disposable{constructor(e,t,n,i,r,a,o,s,l){super(),this._injector=e,this._componentManager=t,this._commandService=n,this._layoutService=i,this._menuManagerService=r,this._uiPartsService=a,this._univerInstanceService=o,this._shortcutService=s,this._configService=l,this._init()}_initCustomComponents(){let e=this._componentManager;this.disposeWithMe(e.register(ik,D.ColorPicker)),this.disposeWithMe(e.register(iH,m.FontFamily)),this.disposeWithMe(e.register(iV,m.FontFamilyItem)),this.disposeWithMe(e.register(ij,m.FontSize)),this.disposeWithMe(e.register(iJ,iq)),this.disposeWithMe(e.register(iX,iY)),this.disposeWithMe(e.register("TodoList",nN))}_initUiParts(){var e,t;let n=this._univerInstanceService.getCurrentUnitForType(g.UniverInstanceType.UNIVER_SHEET),i=this._configService.getConfig(rl);null!=(t=null==(e=null==i?void 0:i.layout)?void 0:e.docContainerConfig)&&t.footer&&!n&&this.disposeWithMe(this._uiPartsService.registerComponent(m.BuiltInUIPart.FOOTER,()=>(0,g.connectInjector)(rs,this._injector)))}_initMenus(){this._menuManagerService.mergeMenu(af)}_initShortCut(){[i9,i3,i2,i4,i8,i6,re,rt,i7,i5,rn,ri,i0].forEach(e=>{this.disposeWithMe(this._shortcutService.registerShortcut(e))})}_init(){this._initCustomComponents(),this._initMenus(),this._initFocusHandler(),this._initCommands(),this._initUiParts(),this._initShortCut()}_initCommands(){[iw,iL,iP].forEach(e=>this.disposeWithMe(this._commandService.registerCommand(e)))}_initFocusHandler(){this.disposeWithMe(this._layoutService.registerFocusHandler(g.UniverInstanceType.UNIVER_DOC,e=>{this._injector.get(p.IRenderManagerService).getRenderById(e).with(io).focus()}))}},"DocUIController"),aE);ab=aC([(0,g.OnLifecycle)(g.LifecycleStages.Rendered,ab),ay(0,(0,g.Inject)(g.Injector)),ay(1,(0,g.Inject)(m.ComponentManager)),ay(2,g.ICommandService),ay(3,m.ILayoutService),ay(4,m.IMenuManagerService),ay(5,m.IUIPartsService),ay(6,g.IUniverInstanceService),ay(7,m.IShortcutService),ay(8,g.IConfigService)],ab);var ax=Object.defineProperty,aR=Object.getOwnPropertyDescriptor,aO=/* @__PURE__ */_((e,t,n,i)=>{for(var r,a=i>1?void 0:i?aR(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&ax(t,n,a),a},"__decorateClass$k"),aB=/* @__PURE__ */_((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$k");let aM=(_(aD=class extends g.RxDisposable{constructor(e,t,n,i){super(),this._context=e,this._textSelectionManagerService=t,this._editorService=n,this._docSkeletonManagerService=i,this._init()}_init(){this._textSelectionManagerService.textSelection$.pipe((0,O.takeUntil)(this.dispose$)).subscribe(e=>{if(null==e)return;let{isEditing:t,unitId:n}=e;n===this._context.unitId&&t&&this._scrollToSelection()})}scrollToRange(e){let t=this._docSkeletonManagerService.getSkeleton();if(!t)return;let{startOffset:n}=e,i=t.findNodePositionByCharIndex(n);this.scrollToNode(i)}scrollToNode(e){let{unitId:t,scene:n,mainComponent:i}=this._context,r=this._docSkeletonManagerService.getSkeleton();if(null==i||null==r)return;let a=i.getOffsetConfig(),{docsLeft:o,docsTop:s}=a,{contentBoxPointGroup:l}=new nH(a,r).getRangePointData(e,e),{left:A,top:d,height:c}=nK(l),u=A+o,g=d+s,h=n.getViewport(z.VIEW_MAIN),p=!!this._editorService.getEditor(t);if(null==h)return;let{left:m,top:f,right:I,bottom:S}=h.getBounding().viewBound,E=0,v=0,T=p?0:100;g<f?E=g-f-T:g>S-c&&(E=g-S+c+T),u<m?v=u-m:u>I-1.5&&(v=u-I+1.5);let C=h.transViewportScroll2ScrollValue(v,E);h.scrollByBarDeltaValue(C)}_scrollToSelection(){let e=this._textSelectionManagerService.getActiveTextRange();if(null==e)return;let{collapsed:t,startNodePosition:n}=e;t&&this.scrollToNode(n)}},"DocBackScrollRenderController"),aD);aM=aO([aB(1,(0,g.Inject)(h.DocSelectionManagerService)),aB(2,m.IEditorService),aB(3,(0,g.Inject)(h.DocSkeletonManagerService))],aM);var aD,aN,aP=Object.defineProperty,aQ=Object.getOwnPropertyDescriptor,aU=/* @__PURE__ */_((e,t,n,i)=>{for(var r,a=i>1?void 0:i?aQ(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&aP(t,n,a),a},"__decorateClass$j"),a_=/* @__PURE__ */_((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$j");let aw=(_(aN=class extends g.RxDisposable{constructor(e,t,n,i,r,a,o){super(),this._context=e,this._contextService=t,this._commandService=n,this._docSelectionRenderService=i,this._docSkeletonManagerService=r,this._editorService=a,this._renderManagerService=o,this._addNewRender(),this._initRenderRefresh(),this._initCommandListener()}reRender(e){var t,n;let i=null==(t=this._renderManagerService.getRenderById(e))?void 0:t.with(h.DocSkeletonManagerService),r=null==i?void 0:i.getSkeleton();if(!(!r||r.getViewModel().getDataModel().getSnapshot().disabled)){if(r.calculate(),this._editorService.isEditor(e)){null==(n=this._context.mainComponent)||n.makeDirty();return}this._recalculateSizeBySkeleton(r)}}_addNewRender(){let{scene:e,engine:t}=this._context,n=new p.Viewport(z.VIEW_MAIN,e,{left:0,top:0,bottom:0,right:0,explicitViewportWidthSet:!1,explicitViewportHeightSet:!1,isWheelPreventDefaultX:!0});e.attachControl(),e.onMouseWheel$.subscribeEvent((t,i)=>{if(this._contextService.getContextValue(g.FOCUSING_DOC)){if(t.ctrlKey){let n=Math.abs(t.deltaX),i=n<40?.2:n<80?.4:.2;i*=t.deltaY>0?-1:1,e.scaleX<1&&(i/=2),e.scaleX+i>4?e.scale(4,4):e.scaleX+i<.1?e.scale(.1,.1):t.preventDefault()}else n.onMouseWheel(t,i)}}),new p.ScrollBar(n),e.addLayer(new p.Layer(e,[],G),new p.Layer(e,[],4)),this._addComponent(),t.runRenderLoop(()=>{e.render()}),this._docSelectionRenderService.__attachScrollEvent()}_addComponent(){let{scene:e,unit:t,components:n}=this._context,i={pageMarginLeft:t.documentStyle.marginLeft||0,pageMarginTop:t.documentStyle.marginTop||0},r=new p.Documents(W.MAIN,void 0,i);r.zIndex=10;let a=new p.DocBackground(W.BACKGROUND,void 0,i);a.zIndex=10,this._context.mainComponent=r,n.set(W.MAIN,r),n.set(W.BACKGROUND,a),e.addObjects([r],G),e.addObjects([a],0),null==this._editorService.getEditor(t.getUnitId())&&e.enableLayerCache(G)}_initRenderRefresh(){this._docSkeletonManagerService.currentSkeletonBefore$.pipe((0,O.takeUntil)(this.dispose$)).subscribe(e=>{this._create(e)})}_create(e){if(!e)return;let{mainComponent:t,components:n}=this._context,i=n.get(W.BACKGROUND);t.changeSkeleton(e),i.changeSkeleton(e),this._recalculateSizeBySkeleton(e)}_initCommandListener(){let e=[h.RichTextEditingMutation.id];this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(e.includes(t.id)){let{unitId:e}=t.params;this.reRender(e)}}))}_recalculateSizeBySkeleton(e){var t;let{mainComponent:n,scene:i,unitId:r,components:a}=this._context,o=a.get(W.BACKGROUND),s=null==(t=e.getSkeletonData())?void 0:t.pages;if(null==s)return;let l=0,A=0;for(let e=0,t=s.length;e<t;e++){let{pageWidth:i,pageHeight:r}=s[e];n.pageLayoutType===p.PageLayoutType.VERTICAL?(A+=r+n.pageMarginTop,e===t-1&&(A+=n.pageMarginTop),l=Math.max(l,i)):n.pageLayoutType===p.PageLayoutType.HORIZONTAL&&(l+=i,e!==t-1&&(l+=n.pageMarginLeft),A=Math.max(A,r))}n.resize(l,A),o.resize(l,A),this._editorService.isEditor(r)||i.resize(l,A)}},"DocRenderController"),aN);aw=aU([a_(1,g.IContextService),a_(2,g.ICommandService),a_(3,(0,g.Inject)(io)),a_(4,(0,g.Inject)(h.DocSkeletonManagerService)),a_(5,m.IEditorService),a_(6,p.IRenderManagerService)],aw);var aL,aF=Object.defineProperty,ak=Object.getOwnPropertyDescriptor,aH=/* @__PURE__ */_((e,t,n,i)=>{for(var r,a=i>1?void 0:i?ak(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&aF(t,n,a),a},"__decorateClass$i"),aV=/* @__PURE__ */_((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$i");let aj=(aL=class{constructor(e,t,n){w(this,"_docContainer"),w(this,"getComponent",/* @__PURE__ */_(e=>{if(this._docContainer=e,!e.getContentRef().current)throw Error("container is not ready")},"getComponent")),w(this,"changeLocale",/* @__PURE__ */_(e=>{this._localeService.setLocale(e)},"changeLocale")),this._localeService=e,this._injector=t,this._configService=n}getUIConfig(){return{injector:this._injector,config:this._configService.getConfig(rl),changeLocale:this.changeLocale,getComponent:this.getComponent}}getContentRef(){return this._docContainer.getContentRef()}UIDidMount(e){if(this._docContainer)return e(this._docContainer)}getDocContainer(){return this._docContainer}},_(aL,"DocContainerUIController"),aL);aj=aH([aV(0,(0,g.Inject)(g.LocaleService)),aV(1,(0,g.Inject)(g.Injector)),aV(2,g.IConfigService)],aj);var aW,az=Object.defineProperty,aG=Object.getOwnPropertyDescriptor,aY=/* @__PURE__ */_((e,t,n,i)=>{for(var r,a=i>1?void 0:i?aG(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&az(t,n,a),a},"__decorateClass$h"),aK=/* @__PURE__ */_((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$h");let aq=(_(aW=class extends g.RxDisposable{constructor(e){super(),w(this,"_docContainerController"),this._injector=e,this._docContainerController=this._injector.createInstance(aj)}},"AppUIController"),aW);aq=aY([aK(0,(0,g.Inject)(g.Injector))],aq);var aX,aJ=Object.defineProperty,aZ=Object.getOwnPropertyDescriptor,a$=/* @__PURE__ */_((e,t,n,i)=>{for(var r,a=i>1?void 0:i?aZ(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&aJ(t,n,a),a},"__decorateClass$g"),a0=/* @__PURE__ */_((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$g");let a1=(aX=class extends g.Disposable{constructor(e){super(),this._docAutoFormatService=e,this._initListTabAutoFormat(),this._initListSpaceAutoFormat(),this._initDefaultEnterFormat(),this._initExitListAutoFormat()}_initListTabAutoFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:en.id,match:/* @__PURE__ */_(e=>{var t;let{selection:n,paragraphs:i,unit:r}=e;if(1===i.length&&n.startOffset===i[0].paragraphStart&&i[0].bullet){let e=null==(t=r.getBody())?void 0:t.paragraphs,n=null==e?void 0:e.filter(e=>{var t;return(null==(t=e.bullet)?void 0:t.listId)===i[0].bullet.listId});return(null==n?void 0:n.findIndex(e=>e.startIndex===i[0].startIndex))!==0}return!!(i.length>1&&i.some(e=>e.bullet))},"match"),getMutations(e){let t=e.commandParams;return[{id:tk.id,params:{type:null!=t&&t.shift?tF.decrease:tF.increase}}]},priority:100})),this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:en.id,match:/* @__PURE__ */_(e=>{let{selection:t}=e,{startNodePosition:n,endNodePosition:i}=t;return!!(n&&i&&nj(n,i)||n&&!i&&n.path.indexOf("cells")>-1)},"match"),getMutations(e){let t=e.commandParams;return[{id:nA.id,params:{shift:!!(null!=t&&t.shift)}}]},priority:99}))}_initListSpaceAutoFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:ei.id,match:/* @__PURE__ */_(e=>{var t;let{selection:n,paragraphs:i,unit:r}=e;if(!n.collapsed||1!==i.length)return!1;let a=null==(t=r.getBody())?void 0:t.dataStream.slice(i[0].paragraphStart,i[0].paragraphEnd-1);return!!(a&&Object.keys(g.QuickListTypeMap).includes(a))},"match"),getMutations(e){var t;let{paragraphs:n,unit:i}=e,r=null==(t=i.getBody())?void 0:t.dataStream.slice(n[0].paragraphStart,n[0].paragraphEnd-1);if(r&&Object.keys(g.QuickListTypeMap).includes(r)){let e=g.QuickListTypeMap[r];return[{id:tz.id,params:{listType:e,paragraph:n[0]}}]}return[]}}))}_initExitListAutoFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:er.id,match:/* @__PURE__ */_(e=>{let{paragraphs:t}=e;return!!(1===t.length&&t[0].bullet&&t[0].paragraphStart===t[0].paragraphEnd)},"match"),getMutations:/* @__PURE__ */_(e=>{let t=e.paragraphs[0].bullet;return t?t.nestingLevel>0?[{id:tk.id,params:{type:tF.decrease}}]:[{id:tw.id,params:{listType:e.paragraphs[0].bullet.listType}}]:[]},"getMutations")}))}_initDefaultEnterFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:er.id,match:/* @__PURE__ */_(()=>!0,"match"),getMutations:()=>[{id:ed.id}],priority:-9999}))}},_(aX,"DocAutoFormatController"),aX);function a9(e){return e.rows[0].cells[0].sections[0].columns[0].lines[0]}function a3(e){let t=e.rows[e.rows.length-1],n=t.cells[t.cells.length-1];return(0,p.getLastLine)(n)}function a2(e,t){let{ed:n}=e,{skeTables:i}=t,r=null;for(let e of i.values())if(e.st===n+1){r=e;break}return r}function a4(e){let t=null==e?void 0:e.parent,n=null,i=null;if(null==e||null==t)return{lineBeforeTable:n,lineAfterTable:i};let{st:r,ed:a}=e,o=t.type===p.DocumentSkeletonPageType.CELL?[t]:t.parent.pages;return(0,p.lineIterator)(o,e=>{e.st===a+1?i=e:e.ed===r-1&&(n=e)}),{lineBeforeTable:n,lineAfterTable:i}}function a8(e){let t=e.parent,n=null==t?void 0:t.parent;if(null==t||null==n)return;let i=n.rows[n.rows.indexOf(t)+1];if(null==i)return;let r=t.cells.indexOf(e);return i.cells[r]}function a6(e){let t=e.parent,n=null==t?void 0:t.parent;if(null==t||null==n)return;let i=n.rows[n.rows.indexOf(t)-1];if(null==i)return;let r=t.cells.indexOf(e);return i.cells[r]}function a5(e,t){let{st:n}=e,{skeTables:i}=t,r=null;for(let e of i.values())if(e.ed===n-1){r=e;break}return r}function a7(e){return e.sections[0].columns[0].lines[0]}function oe(e){return(0,p.getLastLine)(e)}a1=a$([(0,g.OnLifecycle)(g.LifecycleStages.Rendered,a1),a0(0,(0,g.Inject)(j))],a1),_(a9,"firstLineInTable"),_(a3,"lastLineInTable"),_(a2,"findTableAfterLine"),_(a4,"findLineBeforeAndAfterTable"),_(a8,"findBellowCell"),_(a6,"findAboveCell"),_(a5,"findTableBeforeLine"),_(a7,"firstLineInCell"),_(oe,"lastLineInCell");var ot,on=Object.defineProperty,oi=Object.getOwnPropertyDescriptor,or=/* @__PURE__ */_((e,t,n,i)=>{for(var r,a=i>1?void 0:i?oi(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&on(t,n,a),a},"__decorateClass$f"),oa=/* @__PURE__ */_((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$f");let oo=(_(ot=class extends g.Disposable{constructor(e,t,n,i){super(),w(this,"_onInputSubscription"),this._univerInstanceService=e,this._renderManagerService=t,this._textSelectionManagerService=n,this._commandService=i,this._commandExecutedListener()}dispose(){var e;super.dispose(),null==(e=this._onInputSubscription)||e.unsubscribe()}_commandExecutedListener(){let e=[ng.id,nh.id];this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(!e.includes(t.id))return;let n=t.params;switch(t.id){case ng.id:return this._handleMoveCursor(n.direction);case nh.id:return this._handleShiftMoveSelection(n.direction);default:throw Error("Unknown command")}}))}_handleShiftMoveSelection(e){var t,n,i;let r=this._textSelectionManagerService.getActiveTextRange(),a=this._textSelectionManagerService.getCurrentTextRanges(),o=this._univerInstanceService.getCurrentUniverDocInstance();if(null==o)return;let s=null==(t=this._renderManagerService.getRenderById(o.getUnitId()))?void 0:t.with(h.DocSkeletonManagerService).getSkeleton(),l=this._getDocObject();if(null==r||null==s||null==l)return;let{startOffset:A,endOffset:d,style:c,collapsed:u,direction:p,segmentId:m,startNodePosition:f,endNodePosition:I,segmentPage:S}=r;if(a.length>1){let t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;for(let e of a)t=Math.min(t,e.startOffset),n=Math.max(n,e.endOffset);this._textSelectionManagerService.replaceTextRanges([{startOffset:e===g.Direction.LEFT||e===g.Direction.UP?n:t,endOffset:e===g.Direction.LEFT||e===g.Direction.UP?t:n,style:c}],!1);return}let E=u||p===g.RANGE_DIRECTION.FORWARD?A:d,v=u||p===g.RANGE_DIRECTION.FORWARD?d:A,T=null!=(n=o.getSelfOrHeaderFooterModel(m).getBody().dataStream.length)?n:Number.POSITIVE_INFINITY;if(e===g.Direction.LEFT||e===g.Direction.RIGHT){let t=s.findNodeByCharIndex(v-1,m,S),n=s.findNodeByCharIndex(v,m,S);v=Math.min(T-2,Math.max(0,v=e===g.Direction.RIGHT?v+n.count:v-(null!=(i=null==t?void 0:t.count)?i:0))),this._textSelectionManagerService.replaceTextRanges([{startOffset:E,endOffset:v,style:c}],!1),this._scrollToFocusNodePosition(o.getUnitId(),v)}else{let t=s.findNodeByCharIndex(v,m,S),n=l.document.getOffsetConfig(),i=u?f:p===g.RANGE_DIRECTION.FORWARD?I:f,r=this._getTopOrBottomPosition(s,t,i,e===g.Direction.DOWN,!0);if(null==r){let t=e===g.Direction.UP?0:T-2;if(t===v)return;this._textSelectionManagerService.replaceTextRanges([{startOffset:E,endOffset:t,style:c}],!1);return}let a=new nH(n,s).getRangePointData(r,r).cursorList[0];this._textSelectionManagerService.replaceTextRanges([{startOffset:E,endOffset:a.endOffset,style:c}],!1),this._scrollToFocusNodePosition(o.getUnitId(),a.endOffset)}}_handleMoveCursor(e){var t,n,i,r;let a=this._textSelectionManagerService.getActiveTextRange(),o=this._textSelectionManagerService.getCurrentTextRanges(),s=this._univerInstanceService.getCurrentUniverDocInstance();if(null==s)return!1;let l=null==(t=this._renderManagerService.getRenderById(s.getUnitId()))?void 0:t.with(h.DocSkeletonManagerService).getSkeleton(),A=this._getDocObject();if(null==a||null==l||null==A||null==o)return;let{startOffset:d,endOffset:c,style:u,collapsed:p,segmentId:m,startNodePosition:f,endNodePosition:I,segmentPage:S}=a,E=s.getSelfOrHeaderFooterModel(m).getBody();if(null==E)return;let v=null!=(n=E.dataStream.length)?n:Number.POSITIVE_INFINITY,T=null!=(i=s.getCustomRanges())?i:[];if(e===g.Direction.LEFT||e===g.Direction.RIGHT){let t;if(!a.collapsed||o.length>1){let n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;for(let e of o)n=Math.min(n,e.startOffset),i=Math.max(i,e.endOffset);t=e===g.Direction.LEFT?n:i}else{let n=l.findNodeByCharIndex(d-1,m,S),i=l.findNodeByCharIndex(d,m,S),a=l.findNodeByCharIndex(d+1,m,S);t=e===g.Direction.LEFT?Math.max(0,d-(null!=(r=null==n?void 0:n.count)?r:1)):Math.min(v-2,c+i.count+((null==a?void 0:a.streamType)===g.DataStreamTreeTokenType.SECTION_BREAK?1:0))}let n=[g.DataStreamTreeTokenType.CUSTOM_RANGE_START,g.DataStreamTreeTokenType.CUSTOM_RANGE_END,g.DataStreamTreeTokenType.TABLE_START,g.DataStreamTreeTokenType.TABLE_END,g.DataStreamTreeTokenType.TABLE_ROW_START,g.DataStreamTreeTokenType.TABLE_ROW_END,g.DataStreamTreeTokenType.TABLE_CELL_START,g.DataStreamTreeTokenType.TABLE_CELL_END,g.DataStreamTreeTokenType.SECTION_BREAK];if(e===g.Direction.LEFT)for(;n.includes(E.dataStream[t]);)t--;else for(;n.includes(E.dataStream[t]);)t++;T.filter(e=>e.wholeEntity&&e.startIndex<t&&e.endIndex>=t).forEach(n=>{t=e===g.Direction.LEFT?Math.min(n.startIndex,t):Math.max(n.endIndex+1,t)}),this._textSelectionManagerService.replaceTextRanges([{startOffset:t,endOffset:t,style:u}],!1),this._scrollToFocusNodePosition(s.getUnitId(),t)}else{let t=l.findNodeByCharIndex(d,m,S),n=l.findNodeByCharIndex(c,m,S),i=A.document.getOffsetConfig(),r=this._getTopOrBottomPosition(l,e===g.Direction.UP||p?t:n,e===g.Direction.UP||p?f:I,e===g.Direction.DOWN);if(null==r){let t;t=p?e===g.Direction.UP?0:v-2:e===g.Direction.UP?d:c,this._textSelectionManagerService.replaceTextRanges([{startOffset:t,endOffset:t,style:u}],!1);return}let a=new nH(i,l).getRangePointData(r,r).cursorList[0];this._textSelectionManagerService.replaceTextRanges([{...a,style:u}],!1),this._scrollToFocusNodePosition(s.getUnitId(),a.endOffset)}}_getTopOrBottomPosition(e,t,n,i,r=!1){if(null==t||null==n)return;let a=this._getGlyphLeftOffsetInLine(t),o=this._getNextOrPrevLine(t,i,r);if(null==o)return;let s=this._matchPositionByLeftOffset(e,o,a,n);if(null!=s)return{...s,isBack:!0}}_getGlyphLeftOffsetInLine(e){let t=e.parent;if(null==t)return Number.NEGATIVE_INFINITY;let n=t.left,{left:i}=e;return n+i}_matchPositionByLeftOffset(e,t,n,i){let r={distance:Number.POSITIVE_INFINITY};for(let e of t.divides){let t=e.left;for(let i of e.glyphGroup){if(i.streamType===g.DataStreamTreeTokenType.SECTION_BREAK)continue;let{left:e}=i,a=Math.abs(n-(t+e));a<r.distance&&(r.glyph=i,r.distance=a)}}if(null==r.glyph)return;let{segmentPage:a}=i;return e.findPositionByGlyph(r.glyph,a)}_getNextOrPrevLine(e,t,n=!1){var i,r,a,o,s,l,A,d,c,u,g,h;let m;let f=e.parent,I=null==f?void 0:f.parent,S=null==I?void 0:I.parent,E=null==S?void 0:S.parent,v=null==E?void 0:E.parent;if(null==f||null==I||null==S||null==E||null==v)return;let T=S.lines.indexOf(I);if(-1===T)return;if(v.type===p.DocumentSkeletonPageType.CELL&&n){let e=os(v,t);if(e)return e}if(!0===t){m=S.lines[T+1];let e=a2(I,v);if(e){let t=a9(e);t&&(m=t)}}else{m=S.lines[T-1];let e=a5(I,v);if(e){let t=a3(e);t&&(m=t)}}if(null!=m)return m;let C=E.columns.indexOf(S);if(-1===C)return;if(!0===t)m=null==(i=E.columns[C+1])?void 0:i.lines[0];else{let e=null==(a=null==(r=E.columns)?void 0:r[C-1])?void 0:a.lines;m=null==e?void 0:e[e.length-1]}if(null!=m)return m;let y=v.sections.indexOf(E);if(-1===y)return;if(!0===t)m=null==(s=null==(o=v.sections[y-1])?void 0:o.columns[0])?void 0:s.lines[0];else{let e=null==(A=null==(l=v.sections)?void 0:l[y-1])?void 0:A.columns,t=null==e?void 0:e[e.length-1],n=null==t?void 0:t.lines;m=null==n?void 0:n[n.length-1]}if(null!=m)return m;if(v.type===p.DocumentSkeletonPageType.CELL)return os(v,t);let b=v.parent;if(null==b)return;let x=b.pages.indexOf(v);if(-1!==x){if(!0===t)m=null==(u=null==(c=null==(d=b.pages[x+1])?void 0:d.sections[0])?void 0:c.columns[0])?void 0:u.lines[0];else{let e=null==(g=b.pages[x-1])?void 0:g.sections;if(null==e)return;let t=null==(h=e[e.length-1])?void 0:h.columns,n=t[t.length-1],i=null==n?void 0:n.lines;m=i[i.length-1]}if(null!=m)return m}}_scrollToFocusNodePosition(e,t){var n;let i=null==(n=this._renderManagerService.getRenderById(e))?void 0:n.with(aM);null!=i&&i.scrollToRange({startOffset:t,endOffset:t,collapsed:!0})}_getDocObject(){return K(this._univerInstanceService,this._renderManagerService)}},"DocMoveCursorController"),ot);function os(e,t){var n,i;let r=null;if(!0===t){let t=a8(e);if(t)r=a7(t);else{let{lineAfterTable:t}=a4(null==(n=e.parent)?void 0:n.parent);t&&(r=t)}}else{let t=a6(e);if(t)r=oe(t);else{let{lineBeforeTable:t}=a4(null==(i=e.parent)?void 0:i.parent);t&&(r=t)}}return r}oo=or([(0,g.OnLifecycle)(g.LifecycleStages.Rendered,oo),oa(0,g.IUniverInstanceService),oa(1,p.IRenderManagerService),oa(2,(0,g.Inject)(h.DocSelectionManagerService)),oa(3,g.ICommandService)],oo),_(os,"findAboveOrBellowCellLine");let ol="univer-create-item",oA="univer-create-label",od="univer-create-input",oc=/* @__PURE__ */_(({handleRowColChange:e,tableCreateParams:t})=>{let n=(0,g.useDependency)(g.LocaleService),[i,r]=(0,M.useState)(3),[a,o]=(0,M.useState)(5);function s(t,n){r(t),o(n),e(t,n)}return _(s,"handleInputChange"),(0,M.useEffect)(()=>{r(t.rowCount),o(t.colCount)},[t]),/* @__PURE__ */iI.jsxs("div",{className:"univer-create",children:[/* @__PURE__ */iI.jsxs("div",{className:ol,children:[/* @__PURE__ */iI.jsx("span",{className:oA,children:n.t("toolbar.table.rowCount")}),/* @__PURE__ */iI.jsx(D.InputNumber,{min:1,max:20,precision:0,value:i,onChange:/* @__PURE__ */_(e=>{s(e,a)},"onChange"),className:od})]}),/* @__PURE__ */iI.jsxs("div",{className:ol,children:[/* @__PURE__ */iI.jsx("span",{className:oA,children:n.t("toolbar.table.colCount")}),/* @__PURE__ */iI.jsx(D.InputNumber,{min:1,max:20,precision:0,value:a,onChange:/* @__PURE__ */_(e=>{s(i,e)},"onChange"),className:od})]})]})},"DocCreateTableConfirm");var ou,og=Object.defineProperty,oh=Object.getOwnPropertyDescriptor,op=/* @__PURE__ */_((e,t,n,i)=>{for(var r,a=i>1?void 0:i?oh(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&og(t,n,a),a},"__decorateClass$e"),om=/* @__PURE__ */_((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$e");let of=(_(ou=class extends g.Disposable{constructor(e,t){super(),this._commandService=e,this._componentManager=t,this._initialize()}_initialize(){this._init(),this._registerCommands(),this._initCustomComponents()}_registerCommands(){[nu].forEach(e=>this.disposeWithMe(this._commandService.registerCommand(e)))}_initCustomComponents(){let e=this._componentManager;this.disposeWithMe(e.register(nd,oc))}_init(){}},"DocTableController"),ou);of=op([(0,g.OnLifecycle)(g.LifecycleStages.Rendered,of),om(0,g.ICommandService),om(1,(0,g.Inject)(m.ComponentManager))],of);let oI=4;var oS=Object.defineProperty,oE=Object.getOwnPropertyDescriptor,ov=/* @__PURE__ */_((e,t,n,i)=>{for(var r,a=i>1?void 0:i?oE(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&oS(t,n,a),a},"__decorateClass$d"),oT=/* @__PURE__ */_((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$d");function oC(e,t){let n=oy(e.left,e.top,t),i=oy(e.right,e.bottom,t);return{left:n.x,top:n.y,right:i.x,bottom:i.y}}function oy(e,t,n){let{scaleX:i,scaleY:r}=n.getAncestorScale(),a=n.getViewport(z.VIEW_MAIN);if(!a)return{x:e,y:t};let{viewportScrollX:o,viewportScrollY:s}=a;return{x:(e-o)*i,y:(t-s)*r}}function ob(e,t,n){let{scaleX:i,scaleY:r}=n.getAncestorScale(),a=n.getViewport(z.VIEW_MAIN);if(!a)return{x:e,y:t};let{viewportScrollX:o,viewportScrollY:s}=a;return{x:e/i+o,y:t/r+s}}_(oC,"transformBound2OffsetBound"),_(oy,"transformPosition2Offset"),_(ob,"transformOffset2Bound");let ox=/* @__PURE__ */_((e,t)=>{let{scene:n,mainComponent:i,engine:r}=t,a=t.with(h.DocSkeletonManagerService).getSkeleton(),o=a.findNodePositionByCharIndex(e.startOffset,!1,e.segmentId,e.segmentPage),s=a.findNodePositionByCharIndex(e.endOffset,!1,e.segmentId,e.segmentPage);if(!s||!o)return;let l=i.getOffsetConfig(),{docsLeft:A,docsTop:d}=l,c=r.getCanvasElement(),u=c.getBoundingClientRect(),g=(0,p.pxToNum)(c.style.width),{top:m,left:f,width:I}=u,S=I/g,{scaleX:E,scaleY:v}=n.getAncestorScale(),{borderBoxPointGroup:T}=new nH(l,a).getRangePointData(o,s);return nq(T).map(e=>oC(e,n)).map(e=>({left:(e.left+A*E)*S+f,right:(e.right+A*E)*S+f,top:(e.top+d*v)*S+m,bottom:(e.bottom+d*v)*S+m}))},"calcDocRangePositions$1"),oR=(oU=class extends g.Disposable{constructor(e,t,n,i){super(),this._globalPopupManagerService=e,this._renderManagerService=t,this._univerInstanceService=n,this._commandService=i}_createObjectPositionObserver(e,t){let n=/* @__PURE__ */_(()=>{let{scene:n,engine:i}=t,{left:r,top:a,width:o,height:s}=e,l=i.getCanvasElement(),A=l.getBoundingClientRect(),d=(0,p.pxToNum)(l.style.width),c=oC({left:r,right:r+o,top:a,bottom:a+s},n),{top:u,left:g,width:h}=A,m=h/d;return{left:c.left*m+g,right:c.right*m+g,top:c.top*m+u,bottom:c.bottom*m+u}},"calc"),i=n(),r=new I.BehaviorSubject(i),a=new g.DisposableCollection;a.add(this._commandService.onCommandExecuted(e=>{e.id===t4.id&&r.next(n())}));let o=t.scene.getViewport(z.VIEW_MAIN);return o&&a.add(o.onScrollAfter$.subscribeEvent(()=>{r.next(n())})),{position:i,position$:r,disposable:a}}_createRangePositionObserver(e,t){var n;let i=null!=(n=ox(e,t))?n:[],r=new I.BehaviorSubject(i),a=new g.DisposableCollection;a.add(this._commandService.onCommandExecuted(n=>{if(n.id===t4.id){let n=ox(e,t);n&&r.next(n)}}));let o=t.scene.getViewport(z.VIEW_MAIN);return o&&a.add(o.onScrollAfter$.subscribeEvent(()=>{let n=ox(e,t);n&&r.next(n)})),{positions:i,positions$:r,disposable:a}}attachPopupToObject(e,t,n){let i=this._renderManagerService.getRenderById(n);if(!i)throw Error(`Current render not found, unitId: ${n}`);let{position:r,position$:a,disposable:o}=this._createObjectPositionObserver(e,i),s=this._globalPopupManagerService.addPopup({...t,unitId:n,subUnitId:"default",anchorRect:r,anchorRect$:a,canvasElement:i.engine.getCanvasElement()});return{dispose:/* @__PURE__ */_(()=>{this._globalPopupManagerService.removePopup(s),a.complete(),o.dispose()},"dispose")}}attachPopupToRange(e,t,n){if(!this._univerInstanceService.getUnit(n))throw Error(`Document not found, unitId: ${n}`);let{direction:i="top",multipleDirection:r}=t,a=this._renderManagerService.getRenderById(n);if(!a)throw Error(`Current render not found, unitId: ${n}`);let{positions:o,positions$:s,disposable:l}=this._createRangePositionObserver(e,a),A=s.pipe((0,C.map)(e=>i.includes("top")?e[0]:e[e.length-1])),d=this._globalPopupManagerService.addPopup({...t,unitId:n,subUnitId:"default",anchorRect:i.includes("top")?o[0]:o[o.length-1],anchorRect$:A,excludeRects:o,excludeRects$:s,direction:i.includes("top")||i.includes("bottom")?o.length>1?r:i:"bottom",canvasElement:a.engine.getCanvasElement()});return{dispose:/* @__PURE__ */_(()=>{this._globalPopupManagerService.removePopup(d),s.complete(),l.dispose()},"dispose"),canDispose:/* @__PURE__ */_(()=>this._globalPopupManagerService.activePopupId!==d,"canDispose")}}},_(oU,"DocCanvasPopManagerService"),oU);oR=ov([oT(0,(0,g.Inject)(m.ICanvasPopupService)),oT(1,p.IRenderManagerService),oT(2,g.IUniverInstanceService),oT(3,g.ICommandService)],oR);var oO=Object.defineProperty,oB=Object.getOwnPropertyDescriptor,oM=/* @__PURE__ */_((e,t,n,i)=>{for(var r,a=i>1?void 0:i?oB(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&oO(t,n,a),a},"__decorateClass$c"),oD=/* @__PURE__ */_((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$c");let oN=/* @__PURE__ */_((e,t,n,i)=>{var r,a,o,s,l;let A=n.findNodePositionByCharIndex(e.startOffset,!1,e.segmentId,i),d=n.getSkeletonData(),c=e.endOffset;if(e.segmentId){let t=null!=(l=Array.from(null!=(a=null==(r=null==d?void 0:d.skeFooters.get(e.segmentId))?void 0:r.values())?a:[])[0])?l:Array.from(null!=(s=null==(o=null==d?void 0:d.skeHeaders.get(e.segmentId))?void 0:o.values())?s:[])[0];t&&(c=Math.min(t.ed,c))}let u=n.findNodePositionByCharIndex(c,!1,e.segmentId,i);if(!u||!A)return;let g=t.getOffsetConfig(),{borderBoxPointGroup:h}=new nH(g,n).getRangePointData(A,u);return nq(h).map(e=>({top:e.top+g.docsTop-oI,bottom:e.bottom+g.docsTop+oI,left:e.left+g.docsLeft,right:e.right+g.docsLeft}))},"calcDocRangePositions"),oP=/* @__PURE__ */_((e,t,n,i=-1)=>{let r=n.findPositionByGlyph(e,i);if(!r)return;let a=t.getOffsetConfig(),o={...r,isBack:!0},{borderBoxPointGroup:s}=new nH(a,n).getRangePointData(o,o),l=nq(s)[0];return{top:l.top+a.docsTop,bottom:l.bottom+a.docsTop,left:l.left+a.docsLeft,right:l.left+a.docsLeft+e.width}},"calcDocGlyphPosition"),oQ=(o_=class extends g.Disposable{constructor(e,t){super(),w(this,"_hoverCustomRanges$",new I.BehaviorSubject([])),w(this,"hoverCustomRanges$",this._hoverCustomRanges$.pipe((0,E.distinctUntilChanged)((e,t)=>e.length===t.length&&e.every((e,n)=>t[n].range.rangeId===e.range.rangeId&&t[n].segmentId===e.segmentId&&t[n].segmentPageIndex===e.segmentPageIndex)))),w(this,"_clickCustomRanges$",new x.Subject),w(this,"clickCustomRanges$",this._clickCustomRanges$.asObservable()),w(this,"_hoverBullet$",new x.Subject),w(this,"hoverBullet$",this._hoverBullet$.pipe((0,E.distinctUntilChanged)((e,t)=>(null==e?void 0:e.paragraph.startIndex)===(null==t?void 0:t.paragraph.startIndex)&&(null==e?void 0:e.segmentId)===(null==t?void 0:t.segmentId)&&(null==e?void 0:e.segmentPageIndex)===(null==t?void 0:t.segmentPageIndex)))),w(this,"_clickBullet$",new x.Subject),w(this,"clickBullets$",this._clickBullet$.asObservable()),w(this,"_customRangeDirty",!0),w(this,"_bulletDirty",!0),w(this,"_customRangeBounds",[]),w(this,"_bulletBounds",[]),this._context=e,this._docSkeletonManagerService=t,this._initResetDirty(),this._initEvents(),this._initPointer()}get _skeleton(){return this._docSkeletonManagerService.getSkeleton()}get _documents(){return this._context.mainComponent}dispose(){this._hoverCustomRanges$.complete(),this._clickCustomRanges$.complete(),super.dispose()}_initPointer(){let e=p.CURSOR_TYPE.TEXT;this.disposeWithMe(this.hoverCustomRanges$.subscribe(t=>{t.length?(e=this._context.scene.getCursor(),this._context.scene.setCursor(p.CURSOR_TYPE.POINTER)):this._context.scene.setCursor(e)}))}_initResetDirty(){this.disposeWithMe(this._skeleton.dirty$.subscribe(()=>{this._customRangeDirty=!0,this._bulletDirty=!0})),this.disposeWithMe((0,g.fromEventSubject)(this._context.engine.onTransformChange$).pipe((0,v.filter)(e=>e.type===p.TRANSFORM_CHANGE_OBSERVABLE_TYPE.resize)).subscribe(()=>{this._customRangeDirty=!0,this._bulletDirty=!0}))}_initEvents(){this.disposeWithMe((0,g.fromEventSubject)(this._context.scene.onPointerMove$).pipe((0,B.throttleTime)(30)).subscribe(e=>{this._hoverCustomRanges$.next(this._calcActiveRanges(e)),this._hoverBullet$.next(this._calcActiveBullet(e))})),this.disposeWithMe(this._context.scene.onPointerEnter$.subscribeEvent(()=>{this._hoverBullet$.next(null),this._hoverCustomRanges$.next([])}));let e=(0,g.fromEventSubject)(this._context.mainComponent.onPointerDown$),t=(0,g.fromEventSubject)(this._context.scene.onPointerUp$);this.disposeWithMe(e.pipe((0,y.mergeMap)(e=>t.pipe((0,R.take)(1),(0,C.map)(t=>({down:e,up:t})))),(0,v.filter)(({down:e,up:t})=>e.target===t.target&&t.timeStamp-e.timeStamp<300)).subscribe(({down:e})=>{if(2===e.button)return;let t=this._calcActiveRanges(e);t.length&&this._clickCustomRanges$.next(t.pop());let n=this._calcActiveBullet(e);n&&this._clickBullet$.next(n)}))}_buildCustomRangeBoundsBySegment(e,t=-1){var n,i,r;let a=null!=(r=null==(i=null==(n=this._context.unit.getSelfOrHeaderFooterModel(e))?void 0:n.getBody())?void 0:i.customRanges)?r:[],o=[];return a.forEach(n=>{let i=oN({startOffset:n.startIndex,endOffset:n.endIndex,collapsed:!1,segmentId:e},this._documents,this._skeleton,t);if(!i)return null;o.push({customRange:n,rects:i,segmentId:e,segmentPageIndex:t})}),o}_buildCustomRangeBounds(){var e;if(!this._customRangeDirty)return;this._customRangeDirty=!1;let t=[];t.push(...this._buildCustomRangeBoundsBySegment()),null==(e=this._skeleton.getSkeletonData())||e.pages.forEach((e,n)=>{e.headerId&&t.push(...this._buildCustomRangeBoundsBySegment(e.headerId,n)),e.footerId&&t.push(...this._buildCustomRangeBoundsBySegment(e.footerId,n))}),this._customRangeBounds=t}_calcActiveRanges(e){this._buildCustomRangeBounds();let{offsetX:t,offsetY:n}=e,{x:i,y:r}=ob(t,n,this._context.scene);return this._customRangeBounds.filter(e=>e.rects.some(e=>{let{left:t,right:n,top:a,bottom:o}=e;return i>=t&&i<=n&&r>=a&&r<=o})).map(e=>({segmentId:e.segmentId,range:e.customRange,segmentPageIndex:e.segmentPageIndex,rects:e.rects}))}_buildBulletBoundsBySegment(e,t=-1){var n,i,r,a,o;let s=null==(n=this._context.unit.getSelfOrHeaderFooterModel(e))?void 0:n.getBody(),l=(null!=(i=null==s?void 0:s.paragraphs)?i:[]).filter(e=>e.bullet&&0===e.bullet.listType.indexOf("CHECK_LIST")),A=[],d=this._skeleton.getSkeletonData();if(!d)return A;let c=/* @__PURE__ */_(n=>{var i,r,a;for(let o of n){let n=[...o.sections];if(o.skeTables){let e=Array.from(o.skeTables.values());n.push(...e.map(e=>e.rows.map(e=>e.cells.map(e=>e.sections))).flat(4))}for(let o of n)for(let n of o.columns)for(let o of n.lines)if(o.paragraphStart){let n=l.find(e=>e.startIndex===o.paragraphIndex);if(n){let s=null==(a=null==(r=null==(i=null==o?void 0:o.divides)?void 0:i[0])?void 0:r.glyphGroup)?void 0:a[0];if(!s)continue;let l=oP(s,this._documents,this._skeleton,t);if(!l)continue;A.push({rect:l,segmentId:e,segmentPageIndex:t,paragraph:n})}}}return A},"calc");if(e){let t=null!=(o=null==(r=d.skeFooters.get(e))?void 0:r.values())?o:null==(a=d.skeHeaders.get(e))?void 0:a.values();return t?c(Array.from(t)):A}return c(d.pages)}_buildBulletBounds(){var e;this._bulletDirty&&(this._bulletDirty=!1,this._bulletBounds=[],this._bulletBounds.push(...this._buildBulletBoundsBySegment()),null==(e=this._skeleton.getSkeletonData())||e.pages.forEach((e,t)=>{e.headerId&&this._bulletBounds.push(...this._buildBulletBoundsBySegment(e.headerId,t)),e.footerId&&this._bulletBounds.push(...this._buildBulletBoundsBySegment(e.footerId,t))}))}_calcActiveBullet(e){this._buildBulletBounds();let{offsetX:t,offsetY:n}=e,{x:i,y:r}=ob(t,n,this._context.scene);return this._bulletBounds.find(e=>{let{left:t,right:n,top:a,bottom:o}=e.rect;return i>=t&&i<=n&&r>=a&&r<=o})}},_(o_,"DocEventManagerService"),o_);oQ=oM([oD(1,(0,g.Inject)(h.DocSkeletonManagerService))],oQ);var oU,o_,ow,oL=Object.defineProperty,oF=Object.getOwnPropertyDescriptor,ok=/* @__PURE__ */_((e,t,n,i)=>{for(var r,a=i>1?void 0:i?oF(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&oL(t,n,a),a},"__decorateClass$b"),oH=/* @__PURE__ */_((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$b");let oV=(_(ow=class extends g.Disposable{constructor(e,t,n,i,r){super(),this._context=e,this._docSkeletonManagerService=t,this._commandService=n,this._docEventManagerService=i,this._textSelectionManagerService=r,this._initPointerDownObserver(),this._initHoverCursor()}_initPointerDownObserver(){this._docEventManagerService.clickBullets$.subscribe(e=>{this._commandService.executeCommand(tj.id,{index:e.paragraph.startIndex,segmentId:e.segmentId})})}_initHoverCursor(){this.disposeWithMe(this._docEventManagerService.hoverBullet$.subscribe(e=>{e?this._context.mainComponent.setCursor(p.CURSOR_TYPE.POINTER):this._context.mainComponent.setCursor(p.CURSOR_TYPE.TEXT)}))}_getTransformCoordForDocumentOffset(e,t,n,i){let{documentTransform:r}=e.getOffsetConfig(),a=t.transformVector2SceneCoord((0,p.Vector2).FromArray([n,i]));if(a)return r.clone().invert().applyPoint(a)}},"DocChecklistRenderController"),ow);oV=ok([oH(1,(0,g.Inject)(h.DocSkeletonManagerService)),oH(2,g.ICommandService),oH(3,(0,g.Inject)(oQ)),oH(4,(0,g.Inject)(h.DocSelectionManagerService))],oV);var oj,oW=Object.defineProperty,oz=Object.getOwnPropertyDescriptor,oG=/* @__PURE__ */_((e,t,n,i)=>{for(var r,a=i>1?void 0:i?oz(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&oW(t,n,a),a},"__decorateClass$a"),oY=/* @__PURE__ */_((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$a");let oK=(_(oj=class extends g.RxDisposable{constructor(e,t,n,i,r){super(),this._context=e,this._commandService=t,this._docClipboardService=n,this._docSelectionRenderService=i,this._contextService=r,this._init()}_init(){this._initLegacyPasteCommand()}_initLegacyPasteCommand(){var e;null==(e=this._docSelectionRenderService)||e.onPaste$.pipe((0,O.takeUntil)(this.dispose$)).subscribe(e=>{var t,n;if(!ti(this._contextService))return;e.event.preventDefault();let i=e.event,r=null==(t=i.clipboardData)?void 0:t.getData("text/html"),a=null==(n=i.clipboardData)?void 0:n.getData("text/plain");tr(this._contextService)&&(null!=r?r:"").indexOf("</table>")>-1&&(r=""),this._docClipboardService.legacyPaste(r,a)})}},"DocClipboardController"),oj);oK=oG([oY(1,g.ICommandService),oY(2,tt),oY(3,(0,g.Inject)(io)),oY(4,g.IContextService)],oK);var oq=Object.defineProperty,oX=Object.getOwnPropertyDescriptor,oJ=/* @__PURE__ */_((e,t,n,i)=>{for(var r,a=i>1?void 0:i?oX(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&oq(t,n,a),a},"__decorateClass$9"),oZ=/* @__PURE__ */_((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$9");let o$=[g.DEFAULT_EMPTY_DOCUMENT_VALUE,g.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY,g.DOCS_NORMAL_EDITOR_UNIT_ID_KEY,g.DOCS_ZEN_EDITOR_UNIT_ID_KEY],o0=(_(o1=class extends g.Disposable{constructor(e,t,n){super(),this._context=e,this._contextMenuService=t,this._commandService=n,o$.includes(this._context.unitId)||(this._initPointerDown(),this._initEditChange())}_initPointerDown(){var e,t;let n=(null==(t=null==(e=this._context)?void 0:e.mainComponent)?void 0:t.onPointerDown$).subscribeEvent(e=>{2===e.button&&this._contextMenuService.triggerContextMenu(e,m.ContextMenuPosition.MAIN_AREA)});this.disposeWithMe(n)}_initEditChange(){this.disposeWithMe(this._commandService.onCommandExecuted(e=>{e.id===h.RichTextEditingMutation.id&&this._contextMenuService.visible&&this._contextMenuService.hideContextMenu()}))}},"DocContextMenuRenderController"),o1);o0=oJ([oZ(1,m.IContextMenuService),oZ(2,g.ICommandService)],o0);var o1,o9,o3=Object.defineProperty,o2=Object.getOwnPropertyDescriptor,o4=/* @__PURE__ */_((e,t,n,i)=>{for(var r,a=i>1?void 0:i?o2(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&o3(t,n,a),a},"__decorateClass$8"),o8=/* @__PURE__ */_((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$8");let o6=(_(o9=class extends g.Disposable{constructor(e,t,n,i,r,a,o){super(),w(this,"_initialEditors",/* @__PURE__ */new Set),this._context=e,this._univerInstanceService=t,this._editorService=n,this._commandService=i,this._docSelectionRenderService=r,this._docSkeletonManagerService=a,this._renderManagerService=o,this._initialize()}_initialize(){this.disposeWithMe(this._editorService.resize$.subscribe(e=>{e===this._context.unitId&&this._resize(e)})),this._editorService.getAllEditor().forEach(e=>{let t=e.editorUnitId;t===this._context.unitId&&(this._initialEditors.has(t)||(this._initialEditors.add(t),this._resize(t)))}),this._commandExecutedListener(),this._initialSetValue(),this._initialBlur(),this._initialFocus(),this._initialValueChange()}_resize(e){var t,n;if(null==e)return;let i=this._editorService.getEditor(e);if((null==i?void 0:i.cancelDefaultResizeListener)===!0)return;let r=this._univerInstanceService.getUniverDocInstance(e);if(!r)return;let a=this._docSkeletonManagerService.getSkeleton();if(null==i||null==i.render||null==a||null==r)return;a.calculate();let{marginTop:o=0,marginBottom:s=0,marginLeft:l=0,marginRight:A=0}=r.getSnapshot().documentStyle,{scene:d,mainComponent:c}=i.render,{actualHeight:u,actualWidth:g}=a.getActualSize();u+=o+s,g+=l+A;let{width:h,height:m}=i.getBoundingClientRect(),f=d.getViewport(z.VIEW_MAIN),I=null==f?void 0:f.getScrollBar(),S=Math.max(g,h),E=Math.max(u,m);d.transformByState({width:S,height:E}),null==c||c.resize(S,E),i.isSingle()?g>h?null==I?f&&new p.ScrollBar(f,{barSize:8,enableVertical:!1}):null==f||f.resetCanvasSizeAndUpdateScroll():(I=null,null==f||f.scrollToBarPos({x:0,y:0}),null==(n=null==f?void 0:f.getScrollBar())||n.dispose()):u>m?null==I?f&&new p.ScrollBar(f,{enableHorizontal:!1,barSize:8}):null==f||f.resetCanvasSizeAndUpdateScroll():(I=null,null==f||f.scrollToBarPos({x:0,y:0}),null==(t=null==f?void 0:f.getScrollBar())||t.dispose())}_initialSetValue(){this.disposeWithMe(this._editorService.setValue$.subscribe(e=>{e.editorUnitId===this._context.unitId&&this._commandService.executeCommand(t9.id,{unitId:e.editorUnitId,body:e.body,segmentId:null})}))}_initialBlur(){this.disposeWithMe(this._editorService.blur$.subscribe(()=>{this._docSelectionRenderService.removeAllRanges(),this._docSelectionRenderService.blur()})),this.disposeWithMe(this._docSelectionRenderService.onBlur$.subscribe(()=>{let{unitId:e}=this._context,t=this._editorService.getEditor(e),n=this._editorService.getFocusEditor();null==t||t.isSheetEditor()||n&&n.editorUnitId===e||this._editorService.blur()}))}_initialFocus(){this.disposeWithMe(this._editorService.focus$.subscribe(e=>{var t;(null==(t=this._editorService.getFocusEditor())?void 0:t.editorUnitId)===this._context.unitId&&(this._docSelectionRenderService.removeAllRanges(),this._docSelectionRenderService.addDocRanges([e]))}));let e=["univer-formula-search","univer-formula-help","formula-help-decorator","univer-formula-help-param"];this.disposeWithMe((0,T.fromEvent)(window,"mousedown").subscribe(t=>{let n=t.target.classList[0]||"";if((0,g.checkForSubstrings)(n,e)){this._editorService.changeSpreadsheetFocusState(!0),t.stopPropagation();return}this._editorService.changeSpreadsheetFocusState(!1)})),this._univerInstanceService.getAllUnitsForType(g.UniverInstanceType.UNIVER_SHEET).forEach(e=>{let t=e.getUnitId(),n=this._renderManagerService.getRenderById(t),i=null==n?void 0:n.engine.getCanvas().getCanvasEle();null!=i&&(0,T.fromEvent)(i,"mousedown").subscribe(e=>{this._editorService.changeSpreadsheetFocusState(!0),e.stopPropagation()})})}_initialValueChange(){this.disposeWithMe(this._docSelectionRenderService.onCompositionupdate$.subscribe(this._valueChange.bind(this))),this.disposeWithMe(this._docSelectionRenderService.onInput$.subscribe(this._valueChange.bind(this))),this.disposeWithMe(this._docSelectionRenderService.onKeydown$.subscribe(this._valueChange.bind(this))),this.disposeWithMe(this._docSelectionRenderService.onPaste$.subscribe(this._valueChange.bind(this)))}_valueChange(){let{unitId:e}=this._context,t=this._editorService.getEditor(e);null==t||t.isSheetEditor()||this._editorService.refreshValueChange(e)}_commandExecutedListener(){let e=[h.RichTextEditingMutation.id,m.SetEditorResizeOperation.id];this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(e.includes(t.id)){let{unitId:e}=t.params;this._editorService.isSheetEditor(e)||e!==this._context.unitId||(this._resize(e),this._valueChange())}}))}},"DocEditorBridgeController"),o9);o6=o4([o8(1,g.IUniverInstanceService),o8(2,m.IEditorService),o8(3,g.ICommandService),o8(4,(0,g.Inject)(io)),o8(5,(0,g.Inject)(h.DocSkeletonManagerService)),o8(6,p.IRenderManagerService)],o6);var o5,o7=Object.defineProperty,se=Object.getOwnPropertyDescriptor,st=/* @__PURE__ */_((e,t,n,i)=>{for(var r,a=i>1?void 0:i?se(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&o7(t,n,a),a},"__decorateClass$7"),sn=/* @__PURE__ */_((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$7");let si=(_(o5=class extends g.Disposable{constructor(e,t,n,i,r,a){super(),w(this,"_previousIMEContent",""),w(this,"_isCompositionStart",!0),w(this,"_onStartSubscription"),w(this,"_onUpdateSubscription"),w(this,"_onEndSubscription"),this._context=e,this._univerInstanceService=t,this._renderManagerSrv=n,this._docSelectionRenderService=i,this._docImeInputManagerService=r,this._commandService=a,this._initialize()}dispose(){var e,t,n;null==(e=this._onStartSubscription)||e.unsubscribe(),null==(t=this._onUpdateSubscription)||t.unsubscribe(),null==(n=this._onEndSubscription)||n.unsubscribe()}_initialize(){this._initialOnCompositionstart(),this._initialOnCompositionUpdate(),this._initialOnCompositionend()}_initialOnCompositionstart(){this._onStartSubscription=this._docSelectionRenderService.onCompositionstart$.subscribe(e=>{if(null==e)return;this._resetIME();let{activeRange:t}=e;null!=t&&this._docImeInputManagerService.setActiveRange((0,g.Tools).deepClone(t))})}_initialOnCompositionUpdate(){this._onUpdateSubscription=this._docSelectionRenderService.onCompositionupdate$.subscribe(e=>{this._updateContent(e,!0)})}_initialOnCompositionend(){this._onEndSubscription=this._docSelectionRenderService.onCompositionend$.subscribe(e=>{this._updateContent(e,!1)})}async _updateContent(e,t){var n;if(null==e)return;let i=this._univerInstanceService.getCurrentUniverDocInstance();if(!i)return;let r=null==(n=this._renderManagerSrv.getRenderById(i.getUnitId()))?void 0:n.with(h.DocSkeletonManagerService).getSkeleton(),{event:a,activeRange:o}=e;if(null==r||null==o)return;let s=a.data;s===this._previousIMEContent&&t||(await this._commandService.executeCommand(tA.id,{unitId:i.getUnitId(),newText:s,oldTextLen:this._previousIMEContent.length,isCompositionStart:this._isCompositionStart,isCompositionEnd:!t}),t?(this._isCompositionStart&&(this._isCompositionStart=!1),this._previousIMEContent=s):this._resetIME())}_resetIME(){this._previousIMEContent="",this._isCompositionStart=!0,this._docImeInputManagerService.clearUndoRedoMutationParamsCache(),this._docImeInputManagerService.setActiveRange(null)}},"DocIMEInputController"),o5);si=st([sn(1,g.IUniverInstanceService),sn(2,p.IRenderManagerService),sn(3,(0,g.Inject)(io)),sn(4,(0,g.Inject)(tl)),sn(5,g.ICommandService)],si);var sr,sa=Object.defineProperty,so=Object.getOwnPropertyDescriptor,ss=/* @__PURE__ */_((e,t,n,i)=>{for(var r,a=i>1?void 0:i?so(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&sa(t,n,a),a},"__decorateClass$6"),sl=/* @__PURE__ */_((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$6");let sA=(_(sr=class extends g.Disposable{constructor(e,t,n,i){super(),w(this,"_onInputSubscription"),this._context=e,this._docSelectionRenderService=t,this._docSkeletonManagerService=n,this._commandService=i,this._init()}dispose(){var e;super.dispose(),null==(e=this._onInputSubscription)||e.unsubscribe()}_init(){this._initialNormalInput()}_initialNormalInput(){this._onInputSubscription=this._docSelectionRenderService.onInput$.subscribe(async e=>{if(null==e)return;let t=this._context.unitId,{event:n,content:i="",activeRange:r}=e,a=this._docSkeletonManagerService.getSkeleton();if(null==n.data||null==a||!a||!r)return;let{segmentId:o}=r,s=[g.DOCS_NORMAL_EDITOR_UNIT_ID_KEY,g.DOCS_ZEN_EDITOR_UNIT_ID_KEY,g.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY];await this._commandService.executeCommand(eo.id,{unitId:t,body:{dataStream:i},range:r,segmentId:o,extendLastRange:s.includes(t)})," "===i&&await this._commandService.executeCommand(ei.id)})}},"DocInputController"),sr);sA=ss([sl(1,(0,g.Inject)(io)),sl(2,(0,g.Inject)(h.DocSkeletonManagerService)),sl(3,g.ICommandService)],sA);let sd=class extends g.Disposable{constructor(e){super(),this._context=e}calculatePagePosition(){var e,t;let n=Y(this._context),i=null!=(t=null==(e=this._context.unit.getSettings())?void 0:e.zoomRatio)?t:1,{document:r,scene:a,docBackground:o}=n,s=null==a?void 0:a.getParent(),{width:l,height:A,pageMarginLeft:d,pageMarginTop:c}=r;if(null==s||l===Number.POSITIVE_INFINITY||A===Number.POSITIVE_INFINITY)return;let{width:u,height:g}=s,h=0,p=0,m=0,f=0,I=Number.POSITIVE_INFINITY;u>(l+2*d)*i?(h=(u/2-l*i/2)/i,m=(u-2*d)/i,I=0):(h=d,I=((m=l+2*d)-u/i)/2),g>A?(p=g/2-A/2,f=(g-2*c)/i):(p=c,f=A+2*c),a.resize(m,f+200),r.translate(h,p),o.translate(h,p);let S=a.getViewport(z.VIEW_MAIN);return I!==Number.POSITIVE_INFINITY&&null!=S&&S.scrollToViewportPos({viewportScrollX:I}),this}};_(sd,"DocPageLayoutService");var sc,su=Object.defineProperty,sg=Object.getOwnPropertyDescriptor,sh=/* @__PURE__ */_((e,t,n,i)=>{for(var r,a=i>1?void 0:i?sg(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&su(t,n,a),a},"__decorateClass$5"),sp=/* @__PURE__ */_((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$5");let sm=(_(sc=class extends g.Disposable{constructor(e,t,n){super(),this._context=e,this._docPageLayoutService=t,this._textSelectionManagerService=n;let i=this._context.unitId;if((0,g.isInternalEditorID)(i)&&i!==g.DOCS_ZEN_EDITOR_UNIT_ID_KEY)return this;this._initResize()}_initResize(){this.disposeWithMe((0,g.fromEventSubject)(this._context.engine.onTransformChange$).pipe((0,v.filter)(e=>e.type===p.TRANSFORM_CHANGE_OBSERVABLE_TYPE.resize),(0,B.throttleTime)(0,f.animationFrameScheduler)).subscribe(()=>{this._docPageLayoutService.calculatePagePosition(),this._textSelectionManagerService.refreshSelection()}))}},"DocResizeRenderController"),sc);sm=sh([sp(1,(0,g.Inject)(sd)),sp(2,(0,g.Inject)(h.DocSelectionManagerService))],sm);var sf,sI=Object.defineProperty,sS=Object.getOwnPropertyDescriptor,sE=/* @__PURE__ */_((e,t,n,i)=>{for(var r,a=i>1?void 0:i?sS(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&sI(t,n,a),a},"__decorateClass$4"),sv=/* @__PURE__ */_((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$4");let sT=(_(sf=class extends g.Disposable{constructor(e,t,n,i,r,a,o){super(),w(this,"_loadedMap",/* @__PURE__ */new WeakSet),this._context=e,this._commandService=t,this._editorService=n,this._instanceSrv=i,this._docSelectionRenderService=r,this._docSkeletonManagerService=a,this._docSelectionManagerService=o,this._initialize()}_initialize(){this._init(),this._skeletonListener(),this._commandExecutedListener(),this._refreshListener(),this._syncSelection()}_init(){let{unitId:e}=this._context,t=Y(this._context);null==t||null==t.document||this._loadedMap.has(t.document)||(this._initialMain(e),this._loadedMap.add(t.document))}_refreshListener(){this.disposeWithMe(this._docSelectionManagerService.refreshSelection$.subscribe(e=>{if(null==e)return;let{unitId:t,docRanges:n,isEditing:i,options:r}=e;t===this._context.unitId&&(this._docSelectionRenderService.removeAllRanges(),n.length&&this._docSelectionRenderService.addDocRanges(n,i,r))}))}_syncSelection(){this.disposeWithMe(this._docSelectionRenderService.textSelectionInner$.subscribe(e=>{null!=e&&this._docSelectionManagerService.__replaceTextRangesWithNoRefresh(e)}))}_initialMain(e){let{document:t,scene:n}=Y(this._context);this.disposeWithMe(t.onPointerEnter$.subscribeEvent(()=>{this._isEditorReadOnly(e)||(t.cursor=p.CURSOR_TYPE.TEXT)})),this.disposeWithMe(t.onPointerLeave$.subscribeEvent(()=>{t.cursor=p.CURSOR_TYPE.DEFAULT,n.resetCursor()})),this.disposeWithMe(t.onPointerDown$.subscribeEvent((n,i)=>{if(this._isEditorReadOnly(e))return;let r=this._instanceSrv.getCurrentUnitForType(g.UniverInstanceType.UNIVER_DOC);(null==r?void 0:r.getUnitId())!==e&&this._instanceSrv.setCurrentUnitForType(e);let a=this._docSkeletonManagerService.getSkeleton(),{offsetX:o,offsetY:s}=n,l=this._getTransformCoordForDocumentOffset(o,s);if(null!=l){let{pageLayoutType:e=p.PageLayoutType.VERTICAL,pageMarginLeft:n,pageMarginTop:i}=t.getOffsetConfig(),{editArea:r}=a.findEditAreaByCoord(l,e,n,i),o=this._docSkeletonManagerService.getViewModel(),s=o.getEditArea();s!==p.DocumentEditArea.BODY&&r!==p.DocumentEditArea.BODY&&r!==s&&o.setEditArea(r)}if(this._docSelectionRenderService.__onPointDown(n),this._editorService.getEditor(e)){this._setEditorFocus(e);let{offsetX:t,offsetY:i}=n;setTimeout(()=>{e!==this._editorService.getFocusId()&&(this._setEditorFocus(e),this._docSelectionRenderService.setCursorManually(t,i))},0)}2!==n.button&&i.stopPropagation()})),this.disposeWithMe(t.onDblclick$.subscribeEvent(t=>{this._isEditorReadOnly(e)||this._docSelectionRenderService.__handleDblClick(t)})),this.disposeWithMe(t.onTripleClick$.subscribeEvent(t=>{this._isEditorReadOnly(e)||this._docSelectionRenderService.__handleTripleClick(t)}))}_getTransformCoordForDocumentOffset(e,t){let{document:n,scene:i}=Y(this._context),{documentTransform:r}=n.getOffsetConfig(),a=i.getViewports()[0];if(null==a)return;let o=a.transformVector2SceneCoord((0,p.Vector2).FromArray([e,t]));return r.clone().invert().applyPoint(o)}_isEditorReadOnly(e){let t=this._editorService.getEditor(e);return!!t&&t.isReadOnly()}_setEditorFocus(e){this._editorService.focusStyle(e)}_commandExecutedListener(){let e=[t4.id];this.disposeWithMe(this._commandService.onCommandExecuted(t=>{var n;if(e.includes(t.id)){let{unitId:e}=t.params;if(e!==(null==(n=this._docSelectionManagerService.getCurrentSelection())?void 0:n.unitId))return;this._docSelectionManagerService.refreshSelection()}}))}_skeletonListener(){let e=!1;this.disposeWithMe(this._docSkeletonManagerService.currentSkeleton$.subscribe(t=>{if(!t)return;let{unitId:n}=this._context,i=(0,g.isInternalEditorID)(n);(e||!(0,g.isInternalEditorID)(this._context.unitId))&&(i||this._docSelectionManagerService.replaceTextRanges([{startOffset:0,endOffset:0}],!1)),e=!0}))}},"DocSelectionRenderController"),sf);sT=sE([sv(1,g.ICommandService),sv(2,m.IEditorService),sv(3,g.IUniverInstanceService),sv(4,(0,g.Inject)(io)),sv(5,(0,g.Inject)(h.DocSkeletonManagerService)),sv(6,(0,g.Inject)(h.DocSelectionManagerService))],sT);var sC,sy=Object.defineProperty,sb=Object.getOwnPropertyDescriptor,sx=/* @__PURE__ */_((e,t,n,i)=>{for(var r,a=i>1?void 0:i?sb(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&sy(t,n,a),a},"__decorateClass$3"),sR=/* @__PURE__ */_((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$3");let sO=(_(sC=class extends g.Disposable{constructor(e,t,n,i,r,a,o,s){super(),this._context=e,this._contextService=t,this._docSkeletonManagerService=n,this._univerInstanceService=i,this._commandService=r,this._textSelectionManagerService=a,this._editorService=o,this._docPageLayoutService=s,this._initSkeletonListener(),this._initCommandExecutedListener(),this._initRenderRefresher(),setTimeout(()=>this.updateViewZoom(1,!0),20)}_initRenderRefresher(){this._docSkeletonManagerService.currentSkeleton$.subscribe(e=>{if(null==e)return;let{unitId:t,scene:n}=this._context;this._editorService.isEditor(t)||this.disposeWithMe(n.onMouseWheel$.subscribeEvent(e=>{if(!e.ctrlKey||!this._contextService.getContextValue(g.FOCUSING_DOC))return;let t=this._univerInstanceService.getCurrentUniverDocInstance();if(!t)return;let i=Math.abs(e.deltaX),r=i<40?.2:i<80?.4:.2;r*=e.deltaY>0?-1:1,n.scaleX<1&&(r/=2);let a=t.zoomRatio,o=+Number.parseFloat(`${a+r}`).toFixed(1);o=o>=4?4:o<=.1?.1:o,this._commandService.executeCommand(t8.id,{zoomRatio:o,unitId:t.getUnitId()}),e.preventDefault()}))})}_initSkeletonListener(){this.disposeWithMe(this._docSkeletonManagerService.currentSkeleton$.subscribe(e=>{if(null==e)return;let t=this._univerInstanceService.getCurrentUniverDocInstance();if(!t)return;let n=t.zoomRatio||1;this.updateViewZoom(n,!1)}))}_initCommandExecutedListener(){let e=[t4.id];this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(e.includes(t.id)&&t.params.unitId===this._context.unitId){let e=this._context.unit.zoomRatio||1;this.updateViewZoom(e)}}))}updateViewZoom(e,t=!0){var n;let i=Y(this._context);i.scene.scale(e,e),this._docPageLayoutService.calculatePagePosition(),t&&!this._editorService.isEditor(this._context.unitId)&&this._textSelectionManagerService.refreshSelection(),null==(n=i.scene.getTransformer())||n.clearSelectedObjects()}},"DocZoomRenderController"),sC);sO=sx([sR(1,g.IContextService),sR(2,(0,g.Inject)(h.DocSkeletonManagerService)),sR(3,g.IUniverInstanceService),sR(4,g.ICommandService),sR(5,(0,g.Inject)(h.DocSelectionManagerService)),sR(6,m.IEditorService),sR(7,(0,g.Inject)(sd))],sO);var sB=Object.defineProperty,sM=Object.getOwnPropertyDescriptor,sD=/* @__PURE__ */_((e,t,n,i)=>{for(var r,a=i>1?void 0:i?sM(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&sB(t,n,a),a},"__decorateClass$2"),sN=/* @__PURE__ */_((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$2");let sP=(_(sQ=class extends g.RxDisposable{constructor(e,t,n,i,r){super(),w(this,"_docStateChange$",new I.BehaviorSubject(null)),w(this,"docStateChange$",this._docStateChange$.asObservable()),w(this,"_historyStateCache",/* @__PURE__ */new Map),w(this,"_changeStateCache",/* @__PURE__ */new Map),w(this,"_historyTimer",null),w(this,"_changeStateCacheTimer",null),this._undoRedoService=e,this._commandService=t,this._univerInstanceService=n,this._docStateEmitService=i,this._renderManagerService=r,this._initialize(),this._listenDocStateChange()}_setChangeState(e){this._cacheChangeState(e,"history"),this._cacheChangeState(e,"collaboration")}_initialize(){this.disposeWithMe(this._commandService.beforeCommandExecuted(e=>{if(e.id===g.UndoCommandId||e.id===g.RedoCommandId){let e=this._univerInstanceService.getCurrentUniverDocInstance();if(null==e)return;let t=e.getUnitId();this._pushHistory(t),this._emitChangeState(t)}}))}_listenDocStateChange(){this._docStateEmitService.docStateChangeParams$.pipe((0,O.takeUntil)(this.dispose$)).subscribe(e=>{var t;if(null==e)return;let{isCompositionEnd:n,...i}=e,r=null==(t=this._renderManagerService.getRenderById(e.unitId))?void 0:t.with(tl);if(null!=r){if(n){let e=r.fetchComposedUndoRedoMutationParams();if(null==e)throw Error("historyParams is null in RichTextEditingMutation");let{undoMutationParams:t,redoMutationParams:n,previousActiveRange:a}=e;i.redoState.actions=n.actions,i.undoState.actions=t.actions,i.undoState.textRanges=[a]}this._setChangeState(i)}})}_cacheChangeState(e,t="history"){let{trigger:n,unitId:i,noHistory:r,debounce:a=!1}=e;if(r||null==n||"history"===t&&(n===g.RedoCommandId||n===g.UndoCommandId))return;let o="history"===t?this._historyStateCache:this._changeStateCache,s="history"===t?this._pushHistory.bind(this):this._emitChangeState.bind(this);if(o.has(i)){let t=o.get(i);null==t||t.push(e)}else o.set(i,[e]);a?"history"===t?(this._historyTimer&&clearTimeout(this._historyTimer),this._historyTimer=setTimeout(()=>{s(i)},300)):(this._changeStateCacheTimer&&clearTimeout(this._changeStateCacheTimer),this._changeStateCacheTimer=setTimeout(()=>{s(i)},300)):s(i)}_pushHistory(e){let t=this._undoRedoService,n=this._historyStateCache.get(e);if(!Array.isArray(n)||0===n.length)return;let i=n.length,r=n[0].commandId,a=n[0],o=n[i-1],s={unitId:e,actions:n.reduce((e,t)=>(0,g.JSONX).compose(e,t.redoState.actions),null),textRanges:o.redoState.textRanges},l={unitId:e,actions:n.reverse().reduce((e,t)=>(0,g.JSONX).compose(e,t.undoState.actions),null),textRanges:a.undoState.textRanges};t.pushUndoRedo({unitID:e,undoMutations:[{id:r,params:l}],redoMutations:[{id:r,params:s}]}),n.length=0}_emitChangeState(e){let t=this._changeStateCache.get(e);if(!Array.isArray(t)||0===t.length)return;let n=t.length,{commandId:i,trigger:r,segmentId:a,noHistory:o,debounce:s}=t[0],l=t[0],A=t[n-1],d={unitId:e,actions:t.reduce((e,t)=>(0,g.JSONX).compose(e,t.redoState.actions),null),textRanges:A.redoState.textRanges},c={unitId:e,actions:t.reverse().reduce((e,t)=>(0,g.JSONX).compose(e,t.undoState.actions),null),textRanges:l.undoState.textRanges};t.length=0,this._docStateChange$.next({commandId:i,unitId:e,trigger:r,redoState:d,undoState:c,segmentId:a,noHistory:o,debounce:s})}},"DocStateChangeManagerService"),sQ);sP=sD([(0,g.OnLifecycle)(g.LifecycleStages.Ready,sP),sN(0,(0,g.Inject)(g.IUndoRedoService)),sN(1,g.ICommandService),sN(2,g.IUniverInstanceService),sN(3,(0,g.Inject)(h.DocStateEmitService)),sN(4,p.IRenderManagerService)],sP);var sQ,sU,s_=Object.defineProperty,sw=Object.getOwnPropertyDescriptor,sL=/* @__PURE__ */_((e,t,n,i)=>{for(var r,a=i>1?void 0:i?sw(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&s_(t,n,a),a},"__decorateClass$1"),sF=/* @__PURE__ */_((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$1");let sk=(_(sU=class extends g.RxDisposable{constructor(e,t){super(),this._instanceSrv=e,this._renderManagerService=t,this._init()}_init(){this._renderManagerService.createRender$.pipe((0,O.takeUntil)(this.dispose$)).subscribe(e=>this._createRenderWithId(e)),this._instanceSrv.getAllUnitsForType(g.UniverInstanceType.UNIVER_DOC).forEach(e=>this._createRenderer(e)),this._instanceSrv.getTypeOfUnitAdded$(g.UniverInstanceType.UNIVER_DOC).pipe((0,O.takeUntil)(this.dispose$)).subscribe(e=>this._createRenderer(e)),this._instanceSrv.getTypeOfUnitDisposed$(g.UniverInstanceType.UNIVER_DOC).pipe((0,O.takeUntil)(this.dispose$)).subscribe(e=>this._disposeRenderer(e))}_createRenderer(e){let t=e.getUnitId();this._renderManagerService.has(t)||(this._createRenderWithId(t),this._renderManagerService.setCurrent(t))}_createRenderWithId(e){this._renderManagerService.createRender(e)}_disposeRenderer(e){let t=e.getUnitId();this._renderManagerService.removeRender(t)}},"DocsRenderService"),sU);sk=sL([(0,g.OnLifecycle)(g.LifecycleStages.Ready,sk),sF(0,g.IUniverInstanceService),sF(1,p.IRenderManagerService)],sk);let sH={id:er.id,preconditions:i$,binding:m.KeyCode.ENTER},sV={id:eH.id,preconditions:iZ,binding:m.KeyCode.BACKSPACE},sj={id:eV.id,preconditions:iZ,binding:m.KeyCode.DELETE},sW={id:ng.id,binding:m.KeyCode.ARROW_UP,preconditions:iZ,staticParameters:{direction:g.Direction.UP}},sz={id:ng.id,binding:m.KeyCode.ARROW_DOWN,preconditions:iZ,staticParameters:{direction:g.Direction.DOWN}},sG={id:ng.id,binding:m.KeyCode.ARROW_LEFT,preconditions:iZ,staticParameters:{direction:g.Direction.LEFT}},sY={id:ng.id,binding:m.KeyCode.ARROW_RIGHT,preconditions:iZ,staticParameters:{direction:g.Direction.RIGHT}},sK={id:nh.id,binding:m.KeyCode.ARROW_UP|m.MetaKeys.SHIFT,preconditions:iZ,staticParameters:{direction:g.Direction.UP}},sq={id:nh.id,binding:m.KeyCode.ARROW_DOWN|m.MetaKeys.SHIFT,preconditions:iZ,staticParameters:{direction:g.Direction.DOWN}},sX={id:nh.id,binding:m.KeyCode.ARROW_LEFT|m.MetaKeys.SHIFT,preconditions:iZ,staticParameters:{direction:g.Direction.LEFT}},sJ={id:nh.id,binding:m.KeyCode.ARROW_RIGHT|m.MetaKeys.SHIFT,preconditions:iZ,staticParameters:{direction:g.Direction.RIGHT}},sZ={id:np.id,binding:m.KeyCode.A|m.MetaKeys.CTRL_COMMAND,preconditions:/* @__PURE__ */_(e=>e.getContextValue(g.FOCUSING_UNIVER_EDITOR)&&(e.getContextValue(g.FOCUSING_DOC)||e.getContextValue(g.EDITOR_ACTIVATED)),"preconditions")};var s$,s0=Object.defineProperty,s1=Object.getOwnPropertyDescriptor,s9=/* @__PURE__ */_((e,t,n,i)=>{for(var r,a=i>1?void 0:i?s1(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&s0(t,n,a),a},"__decorateClass"),s3=/* @__PURE__ */_((e,t)=>(n,i)=>t(n,i,e),"__decorateParam");let s2=(_(s$=class extends g.Plugin{constructor(e=rA,t,n,i,r,a){super(),this._config=e,this._injector=t,this._renderManagerSrv=n,this._commandService=i,this._logService=r,this._configService=a;let{menu:o,...s}=this._config;o&&this._configService.setConfig("menu",o,{merge:!0}),this._configService.setConfig(rl,s),this._initDependencies(t),this._initializeShortcut(),this._initCommand()}onReady(){this._initRenderBasics(),this._markDocAsFocused()}onRendered(){this._initUI(),this._initRenderModules()}_initCommand(){[eH,eV,tu,th,tm,tI,tE,tT,ty,tx,tO,tN,tM,tQ,ed,eo,es,eL,el,eF,t4,tW,tH,tw,tJ,tZ,t$,tX,t0,t6,ns,ni,nr,nl,na,no,t5,t7,ne,nA,en,ei,er,tk,tL,tV,tj,tz,tA,rd,eN,e_,t1,t9,t8,np,rP,ng,nh].forEach(e=>{this._commandService.registerCommand(e)}),[ta,to,ts].forEach(e=>this.disposeWithMe(this._commandService.registerMultipleCommand(e)))}_initializeShortcut(){[sW,sz,sY,sG,sK,sq,sX,sJ,sZ,sV,sj,sH,i1].forEach(e=>{this._injector.get(m.IShortcutService).registerShortcut(e)})}_initDependencies(e){(0,g.mergeOverrideWithDependencies)([[oK],[o6],[ab],[a1],[of],[oo],[aq],[rN],[tt,{useClass:tn}],[oR],[sk],[sP],[j]],this._config.override).forEach(t=>e.add(t))}_markDocAsFocused(){let e=this._injector.get(g.IUniverInstanceService),t=this._injector.get(m.IEditorService);try{let n=e.getCurrentUnitForType(g.UniverInstanceType.UNIVER_DOC);if(!n)return;let i=n.getUnitId();t.isEditor(i)||e.focusUnit(n.getUnitId())}catch(e){this._logService.warn(e)}}_initUI(){this._injector.get(aq)}_initRenderBasics(){[[(0,h.DocSkeletonManagerService)],[io],[(0,h.DocInterceptorService)],[sd],[tl],[aw],[sO]].forEach(e=>{this._renderManagerSrv.registerRenderModule(g.UniverInstanceType.UNIVER_DOC,e)})}_initRenderModules(){[[oQ],[aM],[sT],[iN],[sm],[o0],[oV],[oK],[sA],[si],[o6]].forEach(e=>{this._renderManagerSrv.registerRenderModule(g.UniverInstanceType.UNIVER_DOC,e)})}},"UniverDocsUIPlugin"),w(s$,"pluginName","DOC_UI_PLUGIN"),w(s$,"type",g.UniverInstanceType.UNIVER_DOC),s$);s2=s9([s3(1,(0,g.Inject)(g.Injector)),s3(2,p.IRenderManagerService),s3(3,g.ICommandService),s3(4,g.ILogService),s3(5,g.IConfigService)],s2)}),n("binOv",function(n,i){e(n.exports,"bufferTime",function(){return u});var r=t("1a7ft"),a=t("e1VZ5"),o=t("jSzwf"),s=t("iNetn"),l=t("hFN8R"),A=t("jaZjQ"),d=t("4xvfD"),c=t("99A8K");function u(e){for(var t,n,i=[],u=1;u<arguments.length;u++)i[u-1]=arguments[u];var g=null!==(t=(0,d.popScheduler)(i))&&void 0!==t?t:A.asyncScheduler,h=null!==(n=i[0])&&void 0!==n?n:null,p=i[1]||1/0;return(0,o.operate)(function(t,n){var i=[],o=!1,A=function(e){var t=e.buffer;e.subs.unsubscribe(),(0,l.arrRemove)(i,e),n.next(t),o&&d()},d=function(){if(i){var t=new a.Subscription;n.add(t);var r={buffer:[],subs:t};i.push(r),(0,c.executeSchedule)(t,g,function(){return A(r)},e)}};null!==h&&h>=0?(0,c.executeSchedule)(n,g,d,h,!0):o=!0,d();var u=(0,s.createOperatorSubscriber)(n,function(e){var t,n,a=i.slice();try{for(var o=(0,r.__values)(a),s=o.next();!s.done;s=o.next()){var l=s.value,d=l.buffer;d.push(e),p<=d.length&&A(l)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},function(){for(;null==i?void 0:i.length;)n.next(i.shift().buffer);null==u||u.unsubscribe(),n.complete(),n.unsubscribe()},void 0,function(){return i=null});t.subscribe(u)})}});
//# sourceMappingURL=es.917821ab.js.map
