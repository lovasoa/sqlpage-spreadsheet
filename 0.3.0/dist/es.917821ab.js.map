{"mappings":"A,S,E,C,C,C,C,C,C,C,E,O,c,C,E,E,C,I,E,I,E,W,C,E,a,C,C,E,C,I,E,A,C,A,a,O,W,W,A,a,O,K,K,A,a,O,O,O,A,a,O,O,O,C,C,E,iB,C,E,E,Q,C,E,Q,S,C,C,C,MC0HsC,EAA4M,EA2T1M,EAoMI,EAA0P,EAqajQ,EAy5Dc,EAy7BV,EAy3DA,E,E,E,O,C,gB,W,O,C,G,E,E,O,C,e,W,O,C,G,E,E,O,C,kC,W,O,C,G,E,E,O,C,mC,W,O,C,G,E,E,O,C,2B,W,O,C,G,E,E,O,C,0B,W,O,E,G,E,E,O,C,gB,W,O,E,G,E,E,O,C,mB,W,O,E,G,E,E,O,C,oB,W,O,E,G,E,E,O,C,kB,W,O,E,G,E,E,O,C,yB,W,O,E,G,E,E,O,C,6B,W,O,E,G,E,E,O,C,+B,W,O,E,G,E,E,O,C,kC,W,O,E,G,E,E,O,C,sC,W,O,E,G,E,E,O,C,kC,W,O,E,G,E,E,O,C,oC,W,O,E,G,E,E,O,C,iC,W,O,E,G,E,E,O,C,mC,W,O,E,G,E,E,O,C,kC,W,O,E,G,E,E,O,C,wB,W,O,E,G,E,E,O,C,sB,W,O,E,G,E,E,O,C,sB,W,O,E,G,E,E,O,C,yB,W,O,E,G,E,E,O,C,8B,W,O,E,G,E,E,O,C,kB,W,O,E,G,E,E,O,C,0B,W,O,E,G,E,E,O,C,4B,W,O,E,G,E,E,O,C,uB,W,O,E,G,E,E,O,C,6B,W,O,E,G,E,E,O,C,yB,W,O,E,G,E,E,O,C,qB,W,O,E,G,I,E,E,S,E,E,S,E,E,S,E,E,S,E,E,S,E,E,S,E,E,S,E,E,S,E,E,S,E,E,S,E,E,S,E,E,S,E,E,S,E,E,S,E,E,S,E,E,S,E,E,S,E,E,S,E,E,S,E,E,S,E,E,S,E,E,S,E,E,SAzuLrC,EAAY,OAAO,cAAc,CACjC,EAAkB,CAAC,EAAK,EAAK,IAAU,KAAO,EAAM,EAAU,EAAK,EAAK,CAAE,WAAY,CAAC,EAAG,aAAc,CAAC,EAAG,SAAU,CAAC,EAAG,MAAA,CAAM,GAAK,CAAG,CAAC,EAAI,CAAG,EAChJ,EAAS,CAAC,EAAQ,IAAU,EAAU,EAAQ,OAAQ,CAAE,MAAA,EAAO,aAAc,CAAC,CAAE,GAChF,EAAgB,CAAC,EAA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","sources":["<anon>","node_modules/@univerjs/docs-ui/lib/es/index.js","node_modules/rxjs/dist/esm5/internal/operators/bufferTime.js","node_modules/rxjs/src/internal/operators/bufferTime.ts"],"sourcesContent":["\nfunction $parcel$interopDefault(a) {\n  return a && a.__esModule ? a.default : a;\n}\n\nfunction $parcel$export(e, n, v, s) {\n  Object.defineProperty(e, n, {get: v, set: s, enumerable: true, configurable: true});\n}\n\n      var $parcel$global =\n        typeof globalThis !== 'undefined'\n          ? globalThis\n          : typeof self !== 'undefined'\n          ? self\n          : typeof window !== 'undefined'\n          ? window\n          : typeof global !== 'undefined'\n          ? global\n          : {};\n  var parcelRequire = $parcel$global[\"parcelRequire26fc\"];\nvar parcelRegister = parcelRequire.register;\nparcelRegister(\"g6Cit\", function(module, exports) {\n\n$parcel$export(module.exports, \"DOCS_VIEW_KEY\", function () { return $bb9ae9d90429a70d$export$9e0654286d987857; });\n$parcel$export(module.exports, \"VIEWPORT_KEY\", function () { return $bb9ae9d90429a70d$export$691aac3130b48bd9; });\n$parcel$export(module.exports, \"DOCS_COMPONENT_MAIN_LAYER_INDEX\", function () { return $bb9ae9d90429a70d$export$71efbe292af93edf; });\n$parcel$export(module.exports, \"addCustomRangeBySelectionFactory\", function () { return $bb9ae9d90429a70d$export$8d914703313ba357; });\n$parcel$export(module.exports, \"deleteCustomRangeFactory\", function () { return $bb9ae9d90429a70d$export$7fbaae6acc82e724; });\n$parcel$export(module.exports, \"replaceSelectionFactory\", function () { return $bb9ae9d90429a70d$export$8dc77b63959478b2; });\n$parcel$export(module.exports, \"InsertCommand\", function () { return $bb9ae9d90429a70d$export$f0cad0406ddcd4fa; });\n$parcel$export(module.exports, \"BreakLineCommand\", function () { return $bb9ae9d90429a70d$export$d58fc04233d01bfb; });\n$parcel$export(module.exports, \"DeleteLeftCommand\", function () { return $bb9ae9d90429a70d$export$b83c33c82ff96791; });\n$parcel$export(module.exports, \"IMEInputCommand\", function () { return $bb9ae9d90429a70d$export$e6da9cc4b65a2183; });\n$parcel$export(module.exports, \"SetInlineFormatCommand\", function () { return $bb9ae9d90429a70d$export$d752bba5c1df9b30; });\n$parcel$export(module.exports, \"SetInlineFormatBoldCommand\", function () { return $bb9ae9d90429a70d$export$2ac5c6b1b1b0feee; });\n$parcel$export(module.exports, \"SetInlineFormatItalicCommand\", function () { return $bb9ae9d90429a70d$export$6f96a39ba8cb4fb2; });\n$parcel$export(module.exports, \"SetInlineFormatUnderlineCommand\", function () { return $bb9ae9d90429a70d$export$64d38e2980266dfc; });\n$parcel$export(module.exports, \"SetInlineFormatStrikethroughCommand\", function () { return $bb9ae9d90429a70d$export$e70c98b3ed3cca1c; });\n$parcel$export(module.exports, \"SetInlineFormatSubscriptCommand\", function () { return $bb9ae9d90429a70d$export$73eebc63961c6386; });\n$parcel$export(module.exports, \"SetInlineFormatSuperscriptCommand\", function () { return $bb9ae9d90429a70d$export$eced467326987bcd; });\n$parcel$export(module.exports, \"SetInlineFormatFontSizeCommand\", function () { return $bb9ae9d90429a70d$export$6723c87fd3465f36; });\n$parcel$export(module.exports, \"SetInlineFormatFontFamilyCommand\", function () { return $bb9ae9d90429a70d$export$b6aad3c88c8d5d81; });\n$parcel$export(module.exports, \"SetInlineFormatTextColorCommand\", function () { return $bb9ae9d90429a70d$export$61b23f520937a12f; });\n$parcel$export(module.exports, \"ReplaceContentCommand\", function () { return $bb9ae9d90429a70d$export$6a8c10d8a8594492; });\n$parcel$export(module.exports, \"CoverContentCommand\", function () { return $bb9ae9d90429a70d$export$ba4bc2e8402f82b3; });\n$parcel$export(module.exports, \"MoveCursorOperation\", function () { return $bb9ae9d90429a70d$export$12633081beeab12c; });\n$parcel$export(module.exports, \"MoveSelectionOperation\", function () { return $bb9ae9d90429a70d$export$bb98a1a9da56437b; });\n$parcel$export(module.exports, \"NodePositionConvertToCursor\", function () { return $bb9ae9d90429a70d$export$37b489d6b2152f0f; });\n$parcel$export(module.exports, \"getLineBounding\", function () { return $bb9ae9d90429a70d$export$18c799e465d2606c; });\n$parcel$export(module.exports, \"getCanvasOffsetByEngine\", function () { return $bb9ae9d90429a70d$export$dba4bbd052c086b8; });\n$parcel$export(module.exports, \"DocSelectionRenderService\", function () { return $bb9ae9d90429a70d$export$6dc2db33d8a277cd; });\n$parcel$export(module.exports, \"DOC_VERTICAL_PADDING\", function () { return $bb9ae9d90429a70d$export$923355e3fc8db131; });\n$parcel$export(module.exports, \"DocCanvasPopManagerService\", function () { return $bb9ae9d90429a70d$export$928598871e94e5df; });\n$parcel$export(module.exports, \"DocEventManagerService\", function () { return $bb9ae9d90429a70d$export$1e5a6f8f312f65d4; });\n$parcel$export(module.exports, \"UniverDocsUIPlugin\", function () { return $bb9ae9d90429a70d$export$d5808d819c51512a; });\n\nvar $7yNYd = parcelRequire(\"7yNYd\");\n\nvar $7AR1b = parcelRequire(\"7AR1b\");\n\nvar $3e0Iz = parcelRequire(\"3e0Iz\");\n\nvar $fL2Ug = parcelRequire(\"fL2Ug\");\n\nvar $6nOkr = parcelRequire(\"6nOkr\");\nvar $5LPkb = parcelRequire(\"5LPkb\");\nvar $5K4WI = parcelRequire(\"5K4WI\");\nvar $arCqp = parcelRequire(\"arCqp\");\nvar $lMvMU = parcelRequire(\"lMvMU\");\nvar $5HvWP = parcelRequire(\"5HvWP\");\nvar $hciHF = parcelRequire(\"hciHF\");\nvar $97m73 = parcelRequire(\"97m73\");\nvar $1O3Nt = parcelRequire(\"1O3Nt\");\nvar $1mjSk = parcelRequire(\"1mjSk\");\nvar $9z4na = parcelRequire(\"9z4na\");\nvar $2jrJe = parcelRequire(\"2jrJe\");\nvar $gv2K9 = parcelRequire(\"gv2K9\");\n\nvar $5gqvu = parcelRequire(\"5gqvu\");\n\nvar $1UDbf = parcelRequire(\"1UDbf\");\n\nvar $aFl3s = parcelRequire(\"aFl3s\");\n\nvar $binOv = parcelRequire(\"binOv\");\nvar $lMvMU = parcelRequire(\"lMvMU\");\nvar $hciHF = parcelRequire(\"hciHF\");\nvar $bb9ae9d90429a70d$var$__defProp = Object.defineProperty;\nvar $bb9ae9d90429a70d$var$__defNormalProp = (obj, key, value)=>key in obj ? $bb9ae9d90429a70d$var$__defProp(obj, key, {\n        enumerable: !0,\n        configurable: !0,\n        writable: !0,\n        value: value\n    }) : obj[key] = value;\nvar $bb9ae9d90429a70d$var$__name = (target, value)=>$bb9ae9d90429a70d$var$__defProp(target, \"name\", {\n        value: value,\n        configurable: !0\n    });\nvar $bb9ae9d90429a70d$var$__publicField = (obj, key, value)=>$bb9ae9d90429a70d$var$__defNormalProp(obj, typeof key != \"symbol\" ? key + \"\" : key, value);\nvar $bb9ae9d90429a70d$var$__defProp$q = Object.defineProperty, $bb9ae9d90429a70d$var$__getOwnPropDesc$q = Object.getOwnPropertyDescriptor, $bb9ae9d90429a70d$var$__decorateClass$q = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((decorators, target, key, kind)=>{\n    for(var result = kind > 1 ? void 0 : kind ? $bb9ae9d90429a70d$var$__getOwnPropDesc$q(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)(decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n    return kind && result && $bb9ae9d90429a70d$var$__defProp$q(target, key, result), result;\n}, \"__decorateClass$q\"), $bb9ae9d90429a70d$var$__decorateParam$q = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((index, decorator)=>(target, key)=>decorator(target, key, index), \"__decorateParam$q\");\nfunction $bb9ae9d90429a70d$var$getParagraphsInRange$1(activeRange, paragraphs) {\n    var _a28, _b;\n    const { startOffset: startOffset, endOffset: endOffset } = activeRange, results = [];\n    let start = -1;\n    for(let i = 0; i < paragraphs.length; i++){\n        const paragraph = paragraphs[i], prevParagraph = paragraphs[i - 1], { startIndex: startIndex } = paragraph;\n        startOffset > start && startOffset <= startIndex || endOffset > start && endOffset <= startIndex ? results.push({\n            ...paragraph,\n            paragraphStart: ((_a28 = prevParagraph == null ? void 0 : prevParagraph.startIndex) != null ? _a28 : -1) + 1,\n            paragraphEnd: paragraph.startIndex\n        }) : startIndex >= startOffset && startIndex <= endOffset && results.push({\n            ...paragraph,\n            paragraphStart: ((_b = prevParagraph == null ? void 0 : prevParagraph.startIndex) != null ? _b : -1) + 1,\n            paragraphEnd: paragraph.startIndex\n        }), start = startIndex;\n    }\n    return results;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getParagraphsInRange$1, \"getParagraphsInRange$1\");\nvar $bb9ae9d90429a70d$var$_a;\nlet $bb9ae9d90429a70d$export$a1c6e22fe3cdf060 = ($bb9ae9d90429a70d$var$_a = class extends (0, $7yNYd.Disposable) {\n    constructor(_univerInstanceService, _textSelectionManagerService){\n        super();\n        $bb9ae9d90429a70d$var$__publicField(this, \"_matches\", /* @__PURE__ */ new Map());\n        this._univerInstanceService = _univerInstanceService, this._textSelectionManagerService = _textSelectionManagerService;\n    }\n    registerAutoFormat(match) {\n        const matchList = this._matches.get(match.id);\n        return matchList ? (matchList.push(match), matchList.sort((a, b)=>{\n            var _a28, _b;\n            return ((_a28 = b.priority) != null ? _a28 : 0) - ((_b = a.priority) != null ? _b : 0);\n        })) : this._matches.set(match.id, [\n            match\n        ]), (0, $7yNYd.toDisposable)(()=>{\n            const matchList2 = this._matches.get(match.id);\n            if (matchList2) {\n                const index = matchList2.findIndex((i)=>i === match);\n                index >= 0 && matchList2.splice(index, 1);\n            }\n        });\n    }\n    onAutoFormat(id, params) {\n        var _a28, _b, _c, _d, _e, _f;\n        const autoFormats = (_a28 = this._matches.get(id)) != null ? _a28 : [], unit = this._univerInstanceService.getCurrentUnitForType((0, $7yNYd.UniverInstanceType).UNIVER_DOC), selection = this._textSelectionManagerService.getActiveTextRange();\n        if (unit && selection) {\n            const doc = unit.getSelfOrHeaderFooterModel(selection.segmentId), context = {\n                unit: doc,\n                selection: selection,\n                isBody: !selection.segmentId,\n                paragraphs: $bb9ae9d90429a70d$var$getParagraphsInRange$1(selection, (_c = (_b = doc.getBody()) == null ? void 0 : _b.paragraphs) != null ? _c : []),\n                customRanges: (0, $7yNYd.BuildTextUtils).customRange.getCustomRangesInterestsWithRange(selection, (_e = (_d = doc.getBody()) == null ? void 0 : _d.customRanges) != null ? _e : []),\n                commandId: id,\n                commandParams: params\n            }, matched = autoFormats.find((i)=>i.match(context));\n            return (_f = matched == null ? void 0 : matched.getMutations(context)) != null ? _f : [];\n        }\n        return [];\n    }\n}, $bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_a, \"DocAutoFormatService\"), $bb9ae9d90429a70d$var$_a);\n$bb9ae9d90429a70d$export$a1c6e22fe3cdf060 = $bb9ae9d90429a70d$var$__decorateClass$q([\n    $bb9ae9d90429a70d$var$__decorateParam$q(0, (0, $7yNYd.IUniverInstanceService)),\n    $bb9ae9d90429a70d$var$__decorateParam$q(1, (0, $7yNYd.Inject)((0, $7AR1b.DocSelectionManagerService)))\n], $bb9ae9d90429a70d$export$a1c6e22fe3cdf060);\nconst $bb9ae9d90429a70d$export$a74edb128854c2d2 = {\n    undo: !0,\n    redo: !0,\n    // Undo redo\n    font: !0,\n    // 'font'\n    fontSize: !0,\n    // 'Font size'\n    bold: !0,\n    // 'Bold (Ctrl+B)'\n    italic: !0,\n    // 'Italic (Ctrl+I)'\n    strikethrough: !0,\n    // 'Strikethrough (Alt+Shift+5)'\n    underline: !0,\n    // 'Underline (Alt+Shift+6)'\n    textColor: !0,\n    // 'Text color'\n    fillColor: !0,\n    // 'Cell color'\n    horizontalAlignMode: !0,\n    // 'Horizontal alignment'\n    verticalAlignMode: !0,\n    // 'Vertical alignment'\n    textWrapMode: !0,\n    // 'Wrap mode'\n    textRotateMode: !0\n}, $bb9ae9d90429a70d$export$3eb8ad4b14461ffd = {\n    outerLeft: !1,\n    outerRight: !1,\n    header: !0,\n    footer: !0,\n    innerLeft: !1,\n    innerRight: !1,\n    frozenHeaderLT: !1,\n    frozenHeaderRT: !1,\n    frozenHeaderLM: !1,\n    frozenContent: !1,\n    infoBar: !0,\n    toolbar: !0\n}, $bb9ae9d90429a70d$export$aacb7588171917ce = \"DOC_UI_PLUGIN\";\nvar $bb9ae9d90429a70d$export$9e0654286d987857 = /* @__PURE__ */ ((DOCS_VIEW_KEY2)=>(DOCS_VIEW_KEY2.MAIN = \"__Document_Render_Main__\", DOCS_VIEW_KEY2.BACKGROUND = \"__Document_Render_Background__\", DOCS_VIEW_KEY2))($bb9ae9d90429a70d$export$9e0654286d987857 || {}), $bb9ae9d90429a70d$export$691aac3130b48bd9 = /* @__PURE__ */ ((VIEWPORT_KEY2)=>(VIEWPORT_KEY2.VIEW_MAIN = \"viewMain\", VIEWPORT_KEY2.VIEW_TOP = \"viewTop\", VIEWPORT_KEY2.VIEW_LEFT = \"viewLeft\", VIEWPORT_KEY2.VIEW_LEFT_TOP = \"viewLeftTop\", VIEWPORT_KEY2))($bb9ae9d90429a70d$export$691aac3130b48bd9 || {});\nconst $bb9ae9d90429a70d$export$f22f28902a63806f = 0, $bb9ae9d90429a70d$export$71efbe292af93edf = 2, $bb9ae9d90429a70d$export$4eda460c535b75e3 = 4, $bb9ae9d90429a70d$export$87e8cb3bbd02cbdb = 10, $bb9ae9d90429a70d$export$81fd9f17ca0eebcd = \"normalTextSelectionPluginName\";\nfunction $bb9ae9d90429a70d$export$ea0dbb208e4826e2(renderContext) {\n    const { mainComponent: mainComponent, scene: scene, engine: engine, components: components } = renderContext, document2 = mainComponent, docBackground = components.get($bb9ae9d90429a70d$export$9e0654286d987857.BACKGROUND);\n    return {\n        document: document2,\n        docBackground: docBackground,\n        scene: scene,\n        engine: engine\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$ea0dbb208e4826e2, \"neoGetDocObject\");\nfunction $bb9ae9d90429a70d$export$33c9206ff2745b13(univerInstanceService, renderManagerService) {\n    const documentModel = univerInstanceService.getCurrentUnitForType((0, $7yNYd.UniverInstanceType).UNIVER_DOC);\n    if (!documentModel) return null;\n    const unitId = documentModel.getUnitId(), currentRender = renderManagerService.getRenderById(unitId);\n    if (currentRender == null) return;\n    const { mainComponent: mainComponent, scene: scene, engine: engine, components: components } = currentRender, document2 = mainComponent, docBackground = components.get($bb9ae9d90429a70d$export$9e0654286d987857.BACKGROUND);\n    return {\n        document: document2,\n        docBackground: docBackground,\n        scene: scene,\n        engine: engine\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$33c9206ff2745b13, \"getDocObject\");\nfunction $bb9ae9d90429a70d$export$86fe1c322965e740(unitId, renderManagerService) {\n    const currentRender = renderManagerService.getRenderById(unitId);\n    if (currentRender == null) return;\n    const { mainComponent: mainComponent, scene: scene, engine: engine, components: components } = currentRender, document2 = mainComponent, docBackground = components.get($bb9ae9d90429a70d$export$9e0654286d987857.BACKGROUND);\n    return {\n        document: document2,\n        docBackground: docBackground,\n        scene: scene,\n        engine: engine\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$86fe1c322965e740, \"getDocObjectById\");\nfunction $bb9ae9d90429a70d$export$e028dd204d1996d9(param) {\n    const { unitId: unitId, ranges: ranges, id: id, type: type, segmentId: segmentId } = param, doMutation = {\n        id: (0, $7AR1b.RichTextEditingMutation).id,\n        params: {\n            unitId: unitId,\n            actions: [],\n            textRanges: void 0\n        }\n    }, textX = new (0, $7yNYd.TextX)(), jsonX = (0, $7yNYd.JSONX).getInstance();\n    let cursor = 0;\n    for(let i = 0; i < ranges.length; i++){\n        const range = ranges[i], { startOffset: start, endOffset: end } = range;\n        start > 0 && textX.push({\n            t: (0, $7yNYd.TextXActionType).RETAIN,\n            len: start - cursor,\n            segmentId: segmentId\n        }), textX.push({\n            t: (0, $7yNYd.TextXActionType).RETAIN,\n            body: {\n                dataStream: \"\",\n                customDecorations: [\n                    {\n                        id: id,\n                        type: type,\n                        startIndex: 0,\n                        endIndex: end - start - 1\n                    }\n                ]\n            },\n            len: end - start,\n            segmentId: segmentId\n        }), cursor = end;\n    }\n    return doMutation.params.actions = jsonX.editOp(textX.serialize()), doMutation;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$e028dd204d1996d9, \"addCustomDecorationFactory\");\nfunction $bb9ae9d90429a70d$export$b2bfb4d0134ae9(accessor, param) {\n    const { segmentId: segmentId, id: id, type: type } = param, docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), selections = docSelectionManagerService.getCurrentTextRanges();\n    if (!selections) return !1;\n    const documentDataModel = univerInstanceService.getCurrentUnitForType((0, $7yNYd.UniverInstanceType).UNIVER_DOC);\n    if (!documentDataModel) return !1;\n    const body = documentDataModel.getBody(), unitId = documentDataModel.getUnitId();\n    return body ? $bb9ae9d90429a70d$export$e028dd204d1996d9({\n        unitId: unitId,\n        ranges: selections,\n        id: id,\n        type: type,\n        segmentId: segmentId\n    }) : !1;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$b2bfb4d0134ae9, \"addCustomDecorationBySelectionFactory\");\nfunction $bb9ae9d90429a70d$export$5904a91c8d872bd(accessor, params) {\n    var _a28, _b;\n    const { unitId: unitId, id: id, segmentId: segmentId } = params, documentDataModel = accessor.get((0, $7yNYd.IUniverInstanceService)).getUnit(unitId), body = documentDataModel == null ? void 0 : documentDataModel.getBody();\n    if (!documentDataModel || !body) return !1;\n    const decorations = (_b = (_a28 = documentDataModel.getBody()) == null ? void 0 : _a28.customDecorations) == null ? void 0 : _b.filter((d)=>d.id === id);\n    if (!(decorations != null && decorations.length)) return !1;\n    const oldBodySlices = decorations.map((i)=>(0, $7yNYd.getBodySlice)(body, i.startIndex, i.endIndex + 1)), bodySlices = oldBodySlices.map((bodySlice)=>{\n        var _a29;\n        const copy = (0, $7yNYd.Tools).deepClone(bodySlice);\n        return copy.customDecorations = (_a29 = copy.customDecorations) == null ? void 0 : _a29.filter((decoration)=>decoration.id !== id), copy;\n    }), doMutation = {\n        id: (0, $7AR1b.RichTextEditingMutation).id,\n        params: {\n            unitId: unitId,\n            actions: [],\n            textRanges: void 0\n        }\n    }, textX = new (0, $7yNYd.TextX)(), jsonX = (0, $7yNYd.JSONX).getInstance();\n    let cursor = 0;\n    return decorations.forEach((decoration, i)=>{\n        const bodySlice = bodySlices[i], oldBody = oldBodySlices[i];\n        decoration.startIndex !== cursor && textX.push({\n            t: (0, $7yNYd.TextXActionType).RETAIN,\n            len: decoration.startIndex - cursor,\n            segmentId: segmentId\n        }), cursor = decoration.startIndex, textX.push({\n            t: (0, $7yNYd.TextXActionType).RETAIN,\n            len: decoration.endIndex - decoration.startIndex + 1,\n            segmentId: segmentId,\n            body: bodySlice,\n            oldBody: oldBody,\n            coverType: (0, $7yNYd.UpdateDocsAttributeType).REPLACE\n        }), cursor = cursor + (decoration.endIndex - decoration.startIndex + 1);\n    }), doMutation.params.actions = jsonX.editOp(textX.serialize()), doMutation;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$5904a91c8d872bd, \"deleteCustomDecorationFactory\");\nfunction $bb9ae9d90429a70d$export$aca1be174465426e(accessor, unitId) {\n    var _a28;\n    return (_a28 = accessor.get((0, $3e0Iz.IRenderManagerService)).getRenderById(unitId)) == null ? void 0 : _a28.with((0, $7AR1b.DocSkeletonManagerService));\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$aca1be174465426e, \"getCommandSkeleton\");\nfunction $bb9ae9d90429a70d$export$abad77f79f46bb97(docDataModel, segmentId = \"\") {\n    if (!segmentId) return [\n        \"body\"\n    ];\n    const { headers: headers, footers: footers } = docDataModel.getSnapshot();\n    if (headers == null && footers == null) throw new Error(\"Document data model must have headers or footers when update by segment id\");\n    if ((headers == null ? void 0 : headers[segmentId]) != null) return [\n        \"headers\",\n        segmentId,\n        \"body\"\n    ];\n    if ((footers == null ? void 0 : footers[segmentId]) != null) return [\n        \"footers\",\n        segmentId,\n        \"body\"\n    ];\n    throw new Error(\"Segment id not found in headers or footers\");\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$abad77f79f46bb97, \"getRichTextEditPath\");\nfunction $bb9ae9d90429a70d$export$e69777f864ca2c89(accessor, param, body) {\n    const { unitId: unitId, segmentId: segmentId } = param, documentDataModel = accessor.get((0, $7yNYd.IUniverInstanceService)).getUnit(unitId);\n    if (!documentDataModel) return !1;\n    const doMutation = {\n        id: (0, $7AR1b.RichTextEditingMutation).id,\n        params: {\n            unitId: param.unitId,\n            actions: [],\n            textRanges: void 0\n        }\n    }, jsonX = (0, $7yNYd.JSONX).getInstance(), textX = (0, $7yNYd.BuildTextUtils).customRange.add({\n        ...param,\n        body: body\n    });\n    if (!textX) return !1;\n    const path = $bb9ae9d90429a70d$export$abad77f79f46bb97(documentDataModel, segmentId);\n    return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), doMutation;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$e69777f864ca2c89, \"addCustomRangeFactory\");\nfunction $bb9ae9d90429a70d$export$8d914703313ba357(accessor, param) {\n    const { rangeId: rangeId, rangeType: rangeType, wholeEntity: wholeEntity, properties: properties, unitId: unitId, selection: propSelection } = param, docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), selection = propSelection != null ? propSelection : docSelectionManagerService.getActiveTextRange(), segmentId = selection == null ? void 0 : selection.segmentId;\n    if (!selection) return !1;\n    const documentDataModel = univerInstanceService.getUnit(unitId, (0, $7yNYd.UniverInstanceType).UNIVER_DOC);\n    if (!documentDataModel) return !1;\n    const body = documentDataModel.getSelfOrHeaderFooterModel(selection.segmentId).getBody();\n    if (!body) return !1;\n    const { startOffset: startOffset, endOffset: endOffset } = (0, $7yNYd.BuildTextUtils).selection.normalizeSelection(selection), textX = (0, $7yNYd.BuildTextUtils).customRange.add({\n        range: {\n            startOffset: startOffset,\n            endOffset: endOffset,\n            collapsed: startOffset === endOffset\n        },\n        rangeId: rangeId,\n        rangeType: rangeType,\n        segmentId: segmentId,\n        wholeEntity: wholeEntity,\n        properties: properties,\n        body: body\n    });\n    if (!textX) return !1;\n    const jsonX = (0, $7yNYd.JSONX).getInstance(), doMutation = {\n        id: (0, $7AR1b.RichTextEditingMutation).id,\n        params: {\n            unitId: unitId,\n            actions: [],\n            textRanges: void 0\n        },\n        textX: textX\n    }, path = $bb9ae9d90429a70d$export$abad77f79f46bb97(documentDataModel, segmentId);\n    return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), doMutation;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$8d914703313ba357, \"addCustomRangeBySelectionFactory\");\nfunction $bb9ae9d90429a70d$export$7fbaae6acc82e724(accessor, params) {\n    const { unitId: unitId, segmentId: segmentId, insert: insert } = params, documentDataModel = accessor.get((0, $7yNYd.IUniverInstanceService)).getUnit(unitId);\n    if (!documentDataModel) return !1;\n    const doMutation = {\n        id: (0, $7AR1b.RichTextEditingMutation).id,\n        params: {\n            unitId: params.unitId,\n            actions: [],\n            textRanges: void 0,\n            segmentId: segmentId\n        }\n    }, jsonX = (0, $7yNYd.JSONX).getInstance(), textX = (0, $7yNYd.BuildTextUtils).customRange.delete(accessor, {\n        documentDataModel: documentDataModel,\n        rangeId: params.rangeId,\n        insert: insert,\n        segmentId: segmentId\n    });\n    if (!textX) return !1;\n    const path = $bb9ae9d90429a70d$export$abad77f79f46bb97(documentDataModel, segmentId);\n    return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), doMutation;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$7fbaae6acc82e724, \"deleteCustomRangeFactory\");\nfunction $bb9ae9d90429a70d$export$f26f7ddc67950305(paragraph, tables) {\n    return tables.some((table)=>paragraph.startIndex > table.startIndex && paragraph.startIndex < table.endIndex);\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$f26f7ddc67950305, \"hasParagraphInTable\");\nfunction $bb9ae9d90429a70d$export$8dc77b63959478b2(accessor, params) {\n    var _a28, _b, _c, _d;\n    const { unitId: unitId, body: insertBody, doc: doc } = params;\n    let docDataModel = doc;\n    if (docDataModel || (docDataModel = accessor.get((0, $7yNYd.IUniverInstanceService)).getUnit(unitId)), !docDataModel) return !1;\n    const segmentId = (_a28 = params.selection) == null ? void 0 : _a28.segmentId, body = (_b = docDataModel.getSelfOrHeaderFooterModel(segmentId)) == null ? void 0 : _b.getBody();\n    if (!body) return !1;\n    const docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), selection = (_c = params.selection) != null ? _c : docSelectionManagerService.getActiveTextRange();\n    if (!selection || !body) return !1;\n    const textRanges = (_d = params.textRanges) != null ? _d : [\n        {\n            startOffset: selection.startOffset + insertBody.dataStream.length,\n            endOffset: selection.startOffset + insertBody.dataStream.length,\n            collapsed: !0,\n            segmentId: segmentId\n        }\n    ], textX = (0, $7yNYd.BuildTextUtils).selection.replace({\n        selection: selection,\n        body: insertBody,\n        doc: docDataModel\n    });\n    if (!textX) return !1;\n    const doMutation = {\n        id: (0, $7AR1b.RichTextEditingMutation).id,\n        params: {\n            unitId: unitId,\n            actions: [],\n            textRanges: textRanges,\n            debounce: !0,\n            segmentId: segmentId\n        },\n        textX: textX\n    }, jsonX = (0, $7yNYd.JSONX).getInstance(), path = $bb9ae9d90429a70d$export$abad77f79f46bb97(docDataModel, segmentId);\n    return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), doMutation;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$8dc77b63959478b2, \"replaceSelectionFactory\");\nfunction $bb9ae9d90429a70d$export$38be7a4920ed64dd(position) {\n    return {\n        left: position.positionH.posOffset,\n        top: position.positionV.posOffset,\n        width: position.size.width,\n        height: position.size.height\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$38be7a4920ed64dd, \"docDrawingPositionToTransform\");\nfunction $bb9ae9d90429a70d$export$621c6bda20c10273(transform, marginLeft = 0, marginTop = 0) {\n    return {\n        size: {\n            width: transform.width,\n            height: transform.height\n        },\n        positionH: {\n            relativeFrom: (0, $7yNYd.ObjectRelativeFromH).MARGIN,\n            posOffset: (transform.left || 0) - marginLeft\n        },\n        positionV: {\n            relativeFrom: (0, $7yNYd.ObjectRelativeFromV).PAGE,\n            posOffset: (transform.top || 0) - marginTop\n        },\n        angle: transform.angle || 0\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$621c6bda20c10273, \"transformToDocDrawingPosition\");\nconst $bb9ae9d90429a70d$var$TabCommandId = \"doc.command.tab\", $bb9ae9d90429a70d$export$e2fd85e54fa7b941 = {\n    id: $bb9ae9d90429a70d$var$TabCommandId,\n    type: (0, $7yNYd.CommandType).COMMAND,\n    async handler (accessor, params) {\n        const mutations = accessor.get($bb9ae9d90429a70d$export$a1c6e22fe3cdf060).onAutoFormat($bb9ae9d90429a70d$export$e2fd85e54fa7b941.id, params);\n        return (await (0, $7yNYd.sequenceExecuteAsync)(mutations, accessor.get((0, $7yNYd.ICommandService)))).result;\n    }\n}, $bb9ae9d90429a70d$var$AfterSpaceCommandId = \"doc.command.after-space\", $bb9ae9d90429a70d$export$57d0a1299f7f4db8 = {\n    id: $bb9ae9d90429a70d$var$AfterSpaceCommandId,\n    type: (0, $7yNYd.CommandType).COMMAND,\n    async handler (accessor) {\n        const mutations = accessor.get($bb9ae9d90429a70d$export$a1c6e22fe3cdf060).onAutoFormat($bb9ae9d90429a70d$export$57d0a1299f7f4db8.id);\n        return (await (0, $7yNYd.sequenceExecuteAsync)(mutations, accessor.get((0, $7yNYd.ICommandService)))).result;\n    }\n}, $bb9ae9d90429a70d$export$94e417ac7df3c302 = {\n    id: \"doc.command.enter\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    async handler (accessor) {\n        const mutations = accessor.get($bb9ae9d90429a70d$export$a1c6e22fe3cdf060).onAutoFormat($bb9ae9d90429a70d$export$94e417ac7df3c302.id);\n        return (await (0, $7yNYd.sequenceExecuteAsync)(mutations, accessor.get((0, $7yNYd.ICommandService)))).result;\n    }\n};\nvar $bb9ae9d90429a70d$var$DeleteDirection = /* @__PURE__ */ ((DeleteDirection2)=>(DeleteDirection2[DeleteDirection2.LEFT = 0] = \"LEFT\", DeleteDirection2[DeleteDirection2.RIGHT = 1] = \"RIGHT\", DeleteDirection2))($bb9ae9d90429a70d$var$DeleteDirection || {});\nconst $bb9ae9d90429a70d$export$a039776b9c5dbe82 = \"doc.command.insert-text\", $bb9ae9d90429a70d$export$f0cad0406ddcd4fa = {\n    id: $bb9ae9d90429a70d$export$a039776b9c5dbe82,\n    type: (0, $7yNYd.CommandType).COMMAND,\n    // eslint-disable-next-line max-lines-per-function\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        var _a28;\n        const commandService = accessor.get((0, $7yNYd.ICommandService)), { range: range, segmentId: segmentId, body: body, unitId: unitId, cursorOffset: cursorOffset, extendLastRange: extendLastRange } = params, docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), docDataModel = accessor.get((0, $7yNYd.IUniverInstanceService)).getUnit(unitId, (0, $7yNYd.UniverInstanceType).UNIVER_DOC);\n        if (docDataModel == null) return !1;\n        const activeRange = docSelectionManagerService.getActiveTextRange(), originBody = docDataModel.getSelfOrHeaderFooterModel((_a28 = activeRange == null ? void 0 : activeRange.segmentId) != null ? _a28 : \"\").getBody();\n        if (!originBody) return !1;\n        const actualRange = extendLastRange ? (0, $7yNYd.BuildTextUtils).selection.getDeleteSelection(range, originBody) : (0, $7yNYd.BuildTextUtils).selection.getInsertSelection(range, originBody), { startOffset: startOffset, collapsed: collapsed } = actualRange, cursorMove = cursorOffset != null ? cursorOffset : body.dataStream.length, textRanges = [\n            {\n                startOffset: startOffset + cursorMove,\n                endOffset: startOffset + cursorMove,\n                style: activeRange == null ? void 0 : activeRange.style,\n                collapsed: collapsed\n            }\n        ], doMutation = {\n            id: (0, $7AR1b.RichTextEditingMutation).id,\n            params: {\n                unitId: unitId,\n                actions: [],\n                textRanges: textRanges,\n                debounce: !0\n            }\n        }, textX = new (0, $7yNYd.TextX)(), jsonX = (0, $7yNYd.JSONX).getInstance();\n        if (collapsed) startOffset > 0 && textX.push({\n            t: (0, $7yNYd.TextXActionType).RETAIN,\n            len: startOffset,\n            segmentId: segmentId\n        });\n        else {\n            const { dos: dos, retain: retain } = (0, $7yNYd.BuildTextUtils).selection.getDeleteActions(actualRange, segmentId, 0, originBody);\n            textX.push(...dos), doMutation.params.textRanges = [\n                {\n                    startOffset: startOffset + cursorMove + retain,\n                    endOffset: startOffset + cursorMove + retain,\n                    collapsed: collapsed\n                }\n            ];\n        }\n        textX.push({\n            t: (0, $7yNYd.TextXActionType).INSERT,\n            body: body,\n            len: body.dataStream.length,\n            line: 0,\n            segmentId: segmentId\n        });\n        const path = $bb9ae9d90429a70d$export$abad77f79f46bb97(docDataModel, segmentId);\n        return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$export$bcbb37853c82bc7a = {\n    id: \"doc.command.delete-text\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        var _a28;\n        const commandService = accessor.get((0, $7yNYd.ICommandService)), univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), { range: range, segmentId: segmentId, unitId: unitId, direction: direction, len: len = 1 } = params, docDataModel = univerInstanceService.getUnit(unitId, (0, $7yNYd.UniverInstanceType).UNIVER_DOC), body = docDataModel == null ? void 0 : docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n        if (docDataModel == null || body == null) return !1;\n        const { startOffset: startOffset } = range, dataStream = body.dataStream, start = direction === $bb9ae9d90429a70d$var$DeleteDirection.LEFT ? startOffset - len : startOffset, end = start + len - 1, relativeCustomRanges = (_a28 = body.customRanges) == null ? void 0 : _a28.filter((customRange)=>(0, $7yNYd.BuildTextUtils).customRange.isIntersecting(customRange.startIndex, customRange.endIndex, start, end)), toDeleteRanges = relativeCustomRanges == null ? void 0 : relativeCustomRanges.filter((customRange)=>(0, $7yNYd.BuildTextUtils).customRange.shouldDeleteCustomRange(start, len, customRange, dataStream)), deleteIndexes = [];\n        for(let i = 0; i < len; i++)deleteIndexes.push(start + i);\n        toDeleteRanges == null || toDeleteRanges.forEach((range2)=>{\n            deleteIndexes.push(range2.startIndex, range2.endIndex);\n        }), deleteIndexes.sort((pre, aft)=>pre - aft);\n        const deleteStart = deleteIndexes[0], doMutation = {\n            id: (0, $7AR1b.RichTextEditingMutation).id,\n            params: {\n                unitId: unitId,\n                actions: [],\n                textRanges: [\n                    {\n                        startOffset: deleteStart,\n                        endOffset: deleteStart,\n                        collapsed: !0\n                    }\n                ],\n                debounce: !0\n            }\n        }, textX = new (0, $7yNYd.TextX)(), jsonX = (0, $7yNYd.JSONX).getInstance();\n        let cursor = 0;\n        for(let i = 0; i < deleteIndexes.length; i++){\n            const deleteIndex = deleteIndexes[i];\n            deleteIndex - cursor > 0 && textX.push({\n                t: (0, $7yNYd.TextXActionType).RETAIN,\n                len: deleteIndex - cursor,\n                segmentId: segmentId\n            }), textX.push({\n                t: (0, $7yNYd.TextXActionType).DELETE,\n                len: 1,\n                segmentId: segmentId,\n                line: 0\n            }), cursor = deleteIndex + 1;\n        }\n        const path = $bb9ae9d90429a70d$export$abad77f79f46bb97(docDataModel, segmentId);\n        return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$export$19ae6d3f93acfd2e = {\n    id: \"doc.command.update-text\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        const { range: range, segmentId: segmentId, updateBody: updateBody, coverType: coverType, unitId: unitId, textRanges: textRanges } = params, commandService = accessor.get((0, $7yNYd.ICommandService)), docDataModel = accessor.get((0, $7yNYd.IUniverInstanceService)).getCurrentUniverDocInstance();\n        if (docDataModel == null) return !1;\n        const doMutation = {\n            id: (0, $7AR1b.RichTextEditingMutation).id,\n            params: {\n                unitId: unitId,\n                actions: [],\n                textRanges: textRanges\n            }\n        }, textX = new (0, $7yNYd.TextX)(), jsonX = (0, $7yNYd.JSONX).getInstance(), { startOffset: startOffset, endOffset: endOffset } = range;\n        textX.push({\n            t: (0, $7yNYd.TextXActionType).RETAIN,\n            len: startOffset,\n            segmentId: segmentId\n        }), textX.push({\n            t: (0, $7yNYd.TextXActionType).RETAIN,\n            body: updateBody,\n            len: endOffset - startOffset,\n            segmentId: segmentId,\n            coverType: coverType\n        });\n        const path = $bb9ae9d90429a70d$export$abad77f79f46bb97(docDataModel, segmentId);\n        return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n    }, \"handler\")\n};\nfunction $bb9ae9d90429a70d$export$d16c599b5109b812(dataStream, prevParagraph) {\n    var _a28, _b;\n    const paragraphs = [];\n    for(let i = 0, len = dataStream.length; i < len; i++)dataStream[i] === (0, $7yNYd.DataStreamTreeTokenType).PARAGRAPH && paragraphs.push({\n        startIndex: i\n    });\n    if (prevParagraph) for (const paragraph of paragraphs)prevParagraph.bullet && (paragraph.bullet = (0, $7yNYd.Tools).deepClone(prevParagraph.bullet), paragraph.bullet.listType === (0, $7yNYd.PresetListType).CHECK_LIST_CHECKED && (paragraph.bullet.listType = (0, $7yNYd.PresetListType).CHECK_LIST)), prevParagraph.paragraphStyle && (paragraph.paragraphStyle = (0, $7yNYd.Tools).deepClone(prevParagraph.paragraphStyle), ((_a28 = prevParagraph.bullet) == null ? void 0 : _a28.listType) === (0, $7yNYd.PresetListType).CHECK_LIST_CHECKED && (_b = paragraph.paragraphStyle) != null && _b.textStyle && (paragraph.paragraphStyle.textStyle.st = {\n        s: (0, $7yNYd.BooleanNumber).FALSE\n    }));\n    return paragraphs;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$d16c599b5109b812, \"generateParagraphs\");\nconst $bb9ae9d90429a70d$export$d58fc04233d01bfb = {\n    id: \"doc.command.break-line\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor)=>{\n        var _a28, _b;\n        const docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), commandService = accessor.get((0, $7yNYd.ICommandService)), activeTextRange = docSelectionManagerService.getActiveTextRange(), rectRanges = docSelectionManagerService.getCurrentRectRanges();\n        if (activeTextRange == null) return !1;\n        if (rectRanges && rectRanges.length) {\n            const { startOffset: startOffset2 } = activeTextRange;\n            return docSelectionManagerService.replaceTextRanges([\n                {\n                    startOffset: startOffset2,\n                    endOffset: startOffset2\n                }\n            ]), !0;\n        }\n        const { segmentId: segmentId } = activeTextRange, docDataModel = univerInstanceService.getCurrentUniverDocInstance(), body = docDataModel == null ? void 0 : docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n        if (!docDataModel || !body) return !1;\n        const unitId = docDataModel.getUnitId(), { startOffset: startOffset, endOffset: endOffset } = (0, $7yNYd.BuildTextUtils).selection.getInsertSelection(activeTextRange, body), prevParagraph = ((_a28 = body.paragraphs) != null ? _a28 : []).find((p2)=>p2.startIndex >= startOffset);\n        if (prevParagraph && prevParagraph.startIndex > endOffset) {\n            const bodyAfter = (0, $7yNYd.normalizeBody)((0, $7yNYd.getBodySlice)(body, endOffset, prevParagraph.startIndex + 1));\n            bodyAfter.customRanges = (_b = bodyAfter.customRanges) == null ? void 0 : _b.map((0, $7yNYd.BuildTextUtils).customRange.copyCustomRange);\n            const deleteRange = {\n                startOffset: startOffset,\n                endOffset: prevParagraph.startIndex + 1,\n                collapsed: !1\n            };\n            return (0, $7yNYd.updateAttributeByInsert)(bodyAfter, {\n                dataStream: (0, $7yNYd.DataStreamTreeTokenType).PARAGRAPH,\n                paragraphs: $bb9ae9d90429a70d$export$d16c599b5109b812((0, $7yNYd.DataStreamTreeTokenType).PARAGRAPH, prevParagraph)\n            }, 1, 0), await commandService.executeCommand($bb9ae9d90429a70d$export$f0cad0406ddcd4fa.id, {\n                unitId: unitId,\n                body: bodyAfter,\n                range: deleteRange,\n                segmentId: segmentId,\n                cursorOffset: 1\n            });\n        } else return await commandService.executeCommand($bb9ae9d90429a70d$export$f0cad0406ddcd4fa.id, {\n            unitId: unitId,\n            body: {\n                dataStream: (0, $7yNYd.DataStreamTreeTokenType).PARAGRAPH,\n                paragraphs: $bb9ae9d90429a70d$export$d16c599b5109b812((0, $7yNYd.DataStreamTreeTokenType).PARAGRAPH, prevParagraph)\n            },\n            range: activeTextRange,\n            segmentId: segmentId\n        });\n    }, \"handler\")\n};\nvar $bb9ae9d90429a70d$var$INSERT_ROW_POSITION = /* @__PURE__ */ ((INSERT_ROW_POSITION2)=>(INSERT_ROW_POSITION2[INSERT_ROW_POSITION2.ABOVE = 0] = \"ABOVE\", INSERT_ROW_POSITION2[INSERT_ROW_POSITION2.BELLOW = 1] = \"BELLOW\", INSERT_ROW_POSITION2))($bb9ae9d90429a70d$var$INSERT_ROW_POSITION || {}), $bb9ae9d90429a70d$var$INSERT_COLUMN_POSITION = /* @__PURE__ */ ((INSERT_COLUMN_POSITION2)=>(INSERT_COLUMN_POSITION2[INSERT_COLUMN_POSITION2.LEFT = 0] = \"LEFT\", INSERT_COLUMN_POSITION2[INSERT_COLUMN_POSITION2.RIGHT = 1] = \"RIGHT\", INSERT_COLUMN_POSITION2))($bb9ae9d90429a70d$var$INSERT_COLUMN_POSITION || {});\nfunction $bb9ae9d90429a70d$var$genEmptyTable(rowCount, colCount) {\n    let dataStream = (0, $7yNYd.DataStreamTreeTokenType).TABLE_START;\n    const paragraphs = [], sectionBreaks = [];\n    for(let i = 0; i < rowCount; i++){\n        dataStream += (0, $7yNYd.DataStreamTreeTokenType).TABLE_ROW_START;\n        for(let j = 0; j < colCount; j++)dataStream += `${(0, $7yNYd.DataStreamTreeTokenType).TABLE_CELL_START}\\r\n${(0, $7yNYd.DataStreamTreeTokenType).TABLE_CELL_END}`, paragraphs.push({\n            startIndex: dataStream.length - 3,\n            paragraphStyle: {\n                spaceAbove: {\n                    v: 3\n                },\n                lineSpacing: 2,\n                spaceBelow: {\n                    v: 0\n                }\n            }\n        }), sectionBreaks.push({\n            startIndex: dataStream.length - 2\n        });\n        dataStream += (0, $7yNYd.DataStreamTreeTokenType).TABLE_ROW_END;\n    }\n    return dataStream += (0, $7yNYd.DataStreamTreeTokenType).TABLE_END, {\n        dataStream: dataStream,\n        paragraphs: paragraphs,\n        sectionBreaks: sectionBreaks\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$genEmptyTable, \"genEmptyTable\");\nfunction $bb9ae9d90429a70d$export$ba2e502f47d52b71() {\n    return {\n        margin: {\n            start: {\n                v: 10\n            },\n            end: {\n                v: 10\n            },\n            top: {\n                v: 5\n            },\n            bottom: {\n                v: 5\n            }\n        }\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$ba2e502f47d52b71, \"getEmptyTableCell\");\nfunction $bb9ae9d90429a70d$export$ff17ef97bed31451(col) {\n    const tableCell = $bb9ae9d90429a70d$export$ba2e502f47d52b71();\n    return {\n        tableCells: [\n            ...new Array(col).fill(null).map(()=>(0, $7yNYd.Tools).deepClone(tableCell))\n        ],\n        trHeight: {\n            val: {\n                v: 30\n            },\n            hRule: (0, $7yNYd.TableCellHeightRule).AUTO\n        }\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$ff17ef97bed31451, \"getEmptyTableRow\");\nfunction $bb9ae9d90429a70d$export$4959bf4a22b5891f(width) {\n    return {\n        size: {\n            type: (0, $7yNYd.TableSizeType).SPECIFIED,\n            width: {\n                v: width\n            }\n        }\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$4959bf4a22b5891f, \"getTableColumn\");\nfunction $bb9ae9d90429a70d$export$438ea56a96e58332(rowCount, colCount, pageContentWidth) {\n    const tableColumn = $bb9ae9d90429a70d$export$4959bf4a22b5891f(pageContentWidth / colCount), tableRow = $bb9ae9d90429a70d$export$ff17ef97bed31451(colCount), tableRows = [\n        ...new Array(rowCount).fill(null).map(()=>(0, $7yNYd.Tools).deepClone(tableRow))\n    ], tableColumns = [\n        ...new Array(colCount).fill(null).map(()=>(0, $7yNYd.Tools).deepClone(tableColumn))\n    ], tableId = (0, $7yNYd.generateRandomId)(6);\n    return {\n        tableRows: tableRows,\n        tableColumns: tableColumns,\n        tableId: tableId,\n        align: (0, $7yNYd.TableAlignmentType).START,\n        indent: {\n            v: 0\n        },\n        textWrap: (0, $7yNYd.TableTextWrapType).NONE,\n        position: {\n            positionH: {\n                relativeFrom: (0, $7yNYd.ObjectRelativeFromH).PAGE,\n                posOffset: 0\n            },\n            positionV: {\n                relativeFrom: (0, $7yNYd.ObjectRelativeFromV).PAGE,\n                posOffset: 0\n            }\n        },\n        dist: {\n            distB: 0,\n            distL: 0,\n            distR: 0,\n            distT: 0\n        },\n        cellMargin: {\n            start: {\n                v: 10\n            },\n            end: {\n                v: 10\n            },\n            top: {\n                v: 5\n            },\n            bottom: {\n                v: 5\n            }\n        },\n        size: {\n            type: (0, $7yNYd.TableSizeType).UNSPECIFIED,\n            width: {\n                v: pageContentWidth\n            }\n        }\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$438ea56a96e58332, \"genTableSource\");\nfunction $bb9ae9d90429a70d$var$getRangeInfoFromRanges(textRange, rectRanges) {\n    if (!textRange && !rectRanges) return null;\n    if (rectRanges && rectRanges.length > 0) {\n        let startOffset = Number.POSITIVE_INFINITY, endOffset = Number.NEGATIVE_INFINITY;\n        const segmentId = \"\";\n        for (const rectRange of rectRanges){\n            const { startOffset: st, endOffset: ed, segmentId: sid } = rectRange;\n            st == null || ed == null || sid == null || (startOffset = Math.min(startOffset, st), endOffset = Math.max(endOffset, ed));\n        }\n        if (Number.isFinite(startOffset) && Number.isFinite(endOffset)) return {\n            startOffset: startOffset,\n            endOffset: endOffset,\n            segmentId: segmentId\n        };\n    } else if (textRange) {\n        const { startOffset: startOffset, endOffset: endOffset, segmentId: segmentId } = textRange;\n        return startOffset == null || endOffset == null || segmentId == null ? null : {\n            startOffset: startOffset,\n            endOffset: endOffset,\n            segmentId: segmentId\n        };\n    }\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getRangeInfoFromRanges, \"getRangeInfoFromRanges\");\nfunction $bb9ae9d90429a70d$var$getInsertRowBody(col) {\n    let dataStream = (0, $7yNYd.DataStreamTreeTokenType).TABLE_ROW_START;\n    const paragraphs = [], sectionBreaks = [];\n    for(let i = 0; i < col; i++)dataStream += `${(0, $7yNYd.DataStreamTreeTokenType).TABLE_CELL_START}\\r\n${(0, $7yNYd.DataStreamTreeTokenType).TABLE_CELL_END}`, paragraphs.push({\n        startIndex: dataStream.length - 3,\n        paragraphStyle: {\n            spaceAbove: {\n                v: 3\n            },\n            lineSpacing: 2,\n            spaceBelow: {\n                v: 0\n            }\n        }\n    }), sectionBreaks.push({\n        startIndex: dataStream.length - 2\n    });\n    return dataStream += (0, $7yNYd.DataStreamTreeTokenType).TABLE_ROW_END, {\n        dataStream: dataStream,\n        paragraphs: paragraphs,\n        sectionBreaks: sectionBreaks\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getInsertRowBody, \"getInsertRowBody\");\nfunction $bb9ae9d90429a70d$var$getInsertColumnBody() {\n    const dataStream = `${(0, $7yNYd.DataStreamTreeTokenType).TABLE_CELL_START}\\r\n${(0, $7yNYd.DataStreamTreeTokenType).TABLE_CELL_END}`, paragraphs = [], sectionBreaks = [];\n    return paragraphs.push({\n        startIndex: 1,\n        paragraphStyle: {\n            spaceAbove: {\n                v: 3\n            },\n            lineSpacing: 2,\n            spaceBelow: {\n                v: 0\n            }\n        }\n    }), sectionBreaks.push({\n        startIndex: 2\n    }), {\n        dataStream: dataStream,\n        paragraphs: paragraphs,\n        sectionBreaks: sectionBreaks\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getInsertColumnBody, \"getInsertColumnBody\");\nfunction $bb9ae9d90429a70d$var$getInsertRowActionsParams(rangeInfo, position, viewModel) {\n    var _a28, _b, _c;\n    const { startOffset: startOffset, endOffset: endOffset, segmentId: segmentId } = rangeInfo, vm = viewModel.getSelfOrHeaderFooterViewModel(segmentId), index = position === 0 ? startOffset : endOffset;\n    let tableRow = null;\n    const tableId = (_c = (_b = (_a28 = viewModel.getBody()) == null ? void 0 : _a28.tables) == null ? void 0 : _b.find((t)=>index >= t.startIndex && index <= t.endIndex)) == null ? void 0 : _c.tableId;\n    let rowIndex = 0;\n    for (const section of vm.children){\n        for (const paragraph of section.children){\n            const { children: children } = paragraph, table = children[0];\n            if (table) {\n                for (const row of table.children)if (row.startIndex <= index && index <= row.endIndex) {\n                    rowIndex = table.children.indexOf(row), tableRow = row;\n                    break;\n                }\n            }\n            if (tableRow) break;\n        }\n        if (tableRow) break;\n    }\n    return tableRow == null || tableId == null ? null : {\n        offset: position === 0 ? tableRow.startIndex : tableRow.endIndex + 1,\n        colCount: tableRow.children.length,\n        tableId: tableId,\n        insertRowIndex: position === 0 ? rowIndex : rowIndex + 1\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getInsertRowActionsParams, \"getInsertRowActionsParams\");\nfunction $bb9ae9d90429a70d$var$getInsertColumnActionsParams(rangeInfo, position, viewModel) {\n    var _a28, _b, _c;\n    const { startOffset: startOffset, endOffset: endOffset, segmentId: segmentId } = rangeInfo, vm = viewModel.getSelfOrHeaderFooterViewModel(segmentId), index = position === 0 ? startOffset : endOffset, tableId = (_c = (_b = (_a28 = viewModel.getBody()) == null ? void 0 : _a28.tables) == null ? void 0 : _b.find((t)=>index >= t.startIndex && index <= t.endIndex)) == null ? void 0 : _c.tableId, offsets = [];\n    let table = null, columnIndex = -1;\n    for (const section of vm.children){\n        for (const paragraph of section.children){\n            const { children: children } = paragraph, tableNode = children[0];\n            if (tableNode) {\n                if (index < tableNode.startIndex || index > tableNode.endIndex) continue;\n                table = tableNode;\n                for (const row of tableNode.children){\n                    for (const cell of row.children){\n                        const cellIndex = row.children.indexOf(cell);\n                        if (index >= cell.startIndex && index <= cell.endIndex) {\n                            columnIndex = cellIndex;\n                            break;\n                        }\n                    }\n                    if (columnIndex !== -1) break;\n                }\n            }\n            if (table) break;\n        }\n        if (table) break;\n    }\n    if (table == null || tableId == null || columnIndex === -1) return null;\n    let cursor = 0;\n    for (const row of table.children){\n        const cell = row.children[columnIndex], insertIndex = position === 0 ? cell.startIndex : cell.endIndex + 1;\n        offsets.push(insertIndex - cursor), cursor = insertIndex;\n    }\n    return {\n        offsets: offsets,\n        tableId: tableId,\n        columnIndex: columnIndex,\n        rowCount: table.children.length\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getInsertColumnActionsParams, \"getInsertColumnActionsParams\");\nfunction $bb9ae9d90429a70d$var$getColumnWidths(pageWidth, tableColumns, insertColumnIndex) {\n    const widths = [];\n    let newColWidth = tableColumns[insertColumnIndex].size.width.v, totalWidth = 0;\n    for(let i = 0; i < tableColumns.length; i++)totalWidth += tableColumns[i].size.width.v;\n    totalWidth += newColWidth;\n    for(let i = 0; i < tableColumns.length; i++)widths.push(tableColumns[i].size.width.v / totalWidth * pageWidth);\n    return newColWidth = newColWidth / totalWidth * pageWidth, {\n        widths: widths,\n        newColWidth: newColWidth\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getColumnWidths, \"getColumnWidths\");\nfunction $bb9ae9d90429a70d$var$getDeleteRowsActionsParams(rangeInfo, viewModel) {\n    var _a28, _b, _c;\n    const { startOffset: startOffset, endOffset: endOffset, segmentId: segmentId } = rangeInfo, vm = viewModel.getSelfOrHeaderFooterViewModel(segmentId), tableId = (_c = (_b = (_a28 = viewModel.getBody()) == null ? void 0 : _a28.tables) == null ? void 0 : _b.find((t)=>startOffset >= t.startIndex && endOffset <= t.endIndex)) == null ? void 0 : _c.tableId, rowIndexes = [];\n    let offset = -1, len = 0, cursor = -1, selectWholeTable = !1;\n    for (const section of vm.children){\n        for (const paragraph of section.children){\n            const { children: children } = paragraph, table = children[0];\n            if (table) {\n                if (startOffset < table.startIndex || endOffset > table.endIndex) continue;\n                cursor = table.startIndex + 3;\n                for (const row of table.children){\n                    const rowIndex = table.children.indexOf(row), { startIndex: startIndex, endIndex: endIndex } = row;\n                    startOffset >= startIndex && startOffset <= endIndex ? (offset = startIndex, rowIndexes.push(rowIndex), len += endIndex - startIndex + 1) : (startIndex > startOffset && endIndex < endOffset || endOffset >= startIndex && endOffset <= endIndex) && (rowIndexes.push(rowIndex), len += endIndex - startIndex + 1), rowIndexes.length === table.children.length && (selectWholeTable = !0);\n                }\n            }\n            if (rowIndexes.length) break;\n        }\n        if (rowIndexes.length) break;\n    }\n    return tableId == null || rowIndexes.length === 0 ? null : {\n        tableId: tableId,\n        rowIndexes: rowIndexes,\n        offset: offset,\n        len: len,\n        cursor: cursor,\n        selectWholeTable: selectWholeTable\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getDeleteRowsActionsParams, \"getDeleteRowsActionsParams\");\nfunction $bb9ae9d90429a70d$var$getDeleteColumnsActionParams(rangeInfo, viewModel) {\n    var _a28, _b, _c;\n    const { startOffset: startOffset, endOffset: endOffset, segmentId: segmentId } = rangeInfo, vm = viewModel.getSelfOrHeaderFooterViewModel(segmentId), tableId = (_c = (_b = (_a28 = viewModel.getBody()) == null ? void 0 : _a28.tables) == null ? void 0 : _b.find((t)=>startOffset >= t.startIndex && endOffset <= t.endIndex)) == null ? void 0 : _c.tableId, offsets = [];\n    let table = null;\n    const columnIndexes = [];\n    let cursor = -1, startColumnIndex = -1, endColumnIndex = -1;\n    for (const section of vm.children){\n        for (const paragraph of section.children){\n            const { children: children } = paragraph, tableNode = children[0];\n            if (tableNode) {\n                if (startOffset < tableNode.startIndex || endOffset > tableNode.endIndex) continue;\n                table = tableNode;\n                for (const row of tableNode.children)for (const cell of row.children){\n                    const cellIndex = row.children.indexOf(cell);\n                    startOffset >= cell.startIndex && startOffset <= cell.endIndex && (startColumnIndex = cellIndex), endOffset >= cell.startIndex && endOffset <= cell.endIndex && (endColumnIndex = cellIndex);\n                }\n            }\n            if (table) break;\n        }\n        if (table) break;\n    }\n    if (table == null || tableId == null) return null;\n    for(let i = startColumnIndex; i <= endColumnIndex; i++)columnIndexes.push(i);\n    let delta = 0;\n    for (const row of table.children){\n        const startCell = row.children[startColumnIndex], endCell = row.children[endColumnIndex];\n        offsets.push({\n            retain: startCell.startIndex - delta,\n            delete: endCell.endIndex - startCell.startIndex + 1\n        }), delta = endCell.endIndex + 1;\n    }\n    return cursor = table.startIndex + 3, {\n        offsets: offsets,\n        tableId: tableId,\n        columnIndexes: columnIndexes,\n        cursor: cursor,\n        selectWholeTable: columnIndexes.length === table.children[0].children.length,\n        rowCount: table.children.length\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getDeleteColumnsActionParams, \"getDeleteColumnsActionParams\");\nfunction $bb9ae9d90429a70d$var$getDeleteTableActionParams(rangeInfo, viewModel) {\n    var _a28, _b, _c;\n    const { startOffset: startOffset, endOffset: endOffset, segmentId: segmentId } = rangeInfo, vm = viewModel.getSelfOrHeaderFooterViewModel(segmentId), tableId = (_c = (_b = (_a28 = viewModel.getBody()) == null ? void 0 : _a28.tables) == null ? void 0 : _b.find((t)=>startOffset >= t.startIndex && endOffset <= t.endIndex)) == null ? void 0 : _c.tableId;\n    let offset = -1, len = 0, cursor = -1;\n    for (const section of vm.children){\n        for (const paragraph of section.children){\n            const { children: children } = paragraph, table = children[0];\n            if (table) {\n                if (startOffset < table.startIndex || endOffset > table.endIndex) continue;\n                offset = table.startIndex, len = table.endIndex - table.startIndex + 1, cursor = table.startIndex;\n            }\n            if (table) break;\n        }\n        if (len > 0) break;\n    }\n    return tableId == null ? null : {\n        tableId: tableId,\n        offset: offset,\n        len: len,\n        cursor: cursor\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getDeleteTableActionParams, \"getDeleteTableActionParams\");\nfunction $bb9ae9d90429a70d$var$getDeleteRowContentActionParams(rangeInfo, viewModel) {\n    var _a28, _b, _c;\n    const { startOffset: startOffset, endOffset: endOffset, segmentId: segmentId } = rangeInfo, vm = viewModel.getSelfOrHeaderFooterViewModel(segmentId), tableId = (_c = (_b = (_a28 = viewModel.getBody()) == null ? void 0 : _a28.tables) == null ? void 0 : _b.find((t)=>startOffset >= t.startIndex && endOffset <= t.endIndex)) == null ? void 0 : _c.tableId, offsets = [];\n    let table = null, cursor = -1, rowIndex = -1, startColumnIndex = -1, endColumnIndex = -1;\n    for (const section of vm.children){\n        for (const paragraph of section.children){\n            const { children: children } = paragraph, tableNode = children[0];\n            if (tableNode) {\n                if (startOffset < tableNode.startIndex || endOffset > tableNode.endIndex) continue;\n                table = tableNode;\n                for (const row2 of tableNode.children){\n                    const rIndex = tableNode.children.indexOf(row2);\n                    for (const cell of row2.children){\n                        const cellIndex = row2.children.indexOf(cell);\n                        startOffset >= cell.startIndex && startOffset <= cell.endIndex && (rowIndex = rIndex, startColumnIndex = cellIndex), endOffset >= cell.startIndex && endOffset <= cell.endIndex && (endColumnIndex = cellIndex);\n                    }\n                }\n            }\n            if (table) break;\n        }\n        if (table) break;\n    }\n    if (table == null || tableId == null || rowIndex === -1) return null;\n    const row = table.children[rowIndex];\n    for(let i = startColumnIndex; i <= endColumnIndex; i++){\n        const cell = row.children[i];\n        offsets.push({\n            retain: cell.startIndex + 1,\n            delete: cell.endIndex - cell.startIndex - 3\n        });\n    }\n    return cursor = table.startIndex + 3, {\n        offsets: offsets,\n        tableId: tableId,\n        cursor: cursor,\n        rowCount: table.children.length\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getDeleteRowContentActionParams, \"getDeleteRowContentActionParams\");\nvar $bb9ae9d90429a70d$var$CellPosition = /* @__PURE__ */ ((CellPosition2)=>(CellPosition2[CellPosition2.NEXT = 0] = \"NEXT\", CellPosition2[CellPosition2.PREV = 1] = \"PREV\", CellPosition2))($bb9ae9d90429a70d$var$CellPosition || {});\nfunction $bb9ae9d90429a70d$var$getCellOffsets(viewModel, range, position) {\n    const { startOffset: startOffset } = range;\n    let targetTable = null;\n    for (const section of viewModel.children){\n        for (const paragraph of section.children){\n            const table = paragraph.children[0];\n            if (table && startOffset > table.startIndex && startOffset < table.endIndex) {\n                targetTable = table;\n                break;\n            }\n        }\n        if (targetTable) break;\n    }\n    if (targetTable == null) return null;\n    let cellIndex = -1, rowIndex = -1, targetRow = null;\n    for (const row of targetTable.children){\n        for (const cell of row.children)if (startOffset > cell.startIndex && startOffset < cell.endIndex) {\n            cellIndex = row.children.indexOf(cell), rowIndex = targetTable.children.indexOf(row), targetRow = row;\n            break;\n        }\n        if (cellIndex > -1) break;\n    }\n    if (cellIndex === -1 || rowIndex === -1 || targetRow == null) return null;\n    let newCell = null;\n    if (position === 0) {\n        if (newCell = targetRow.children[cellIndex + 1], !newCell) {\n            const nextRow = targetTable.children[rowIndex + 1];\n            nextRow && (newCell = nextRow.children[0]);\n        }\n    } else if (newCell = targetRow.children[cellIndex - 1], !newCell) {\n        const prevRow = targetTable.children[rowIndex - 1];\n        prevRow && (newCell = prevRow.children[prevRow.children.length - 1]);\n    }\n    if (newCell) {\n        const { startIndex: startIndex, endIndex: endIndex } = newCell;\n        return {\n            startOffset: startIndex + 1,\n            endOffset: endIndex - 2\n        };\n    }\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getCellOffsets, \"getCellOffsets\");\nfunction $bb9ae9d90429a70d$export$aa9bc8623aab3a9c(body, selections) {\n    const customBlockIds = [], { customBlocks: customBlocks = [] } = body;\n    for (const selection of selections){\n        const { startOffset: startOffset, endOffset: endOffset } = selection;\n        if (!(startOffset == null || endOffset == null)) for (const customBlock of customBlocks){\n            const { startIndex: startIndex } = customBlock;\n            startIndex >= startOffset && startIndex < endOffset && customBlockIds.push(customBlock.blockId);\n        }\n    }\n    return customBlockIds;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$aa9bc8623aab3a9c, \"getCustomBlockIdsInSelections\");\nfunction $bb9ae9d90429a70d$var$hasRangeInTable(ranges) {\n    return ranges.some((range)=>{\n        const { startNodePosition: startNodePosition } = range;\n        return startNodePosition ? (startNodePosition == null ? void 0 : startNodePosition.path.indexOf(\"cells\")) > -1 : !1;\n    });\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$hasRangeInTable, \"hasRangeInTable\");\nconst $bb9ae9d90429a70d$export$b23e7be54cecd122 = {\n    id: \"doc.command.inner-paste\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    // eslint-disable-next-line max-lines-per-function, complexity\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        var _a28, _b, _c, _d;\n        const { segmentId: segmentId, textRanges: textRanges, doc: doc } = params, commandService = accessor.get((0, $7yNYd.ICommandService)), docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), selections = docSelectionManagerService.getCurrentTextRanges(), { body: body, tableSource: tableSource, drawings: drawings } = doc;\n        if (!Array.isArray(selections) || selections.length === 0 || body == null) return !1;\n        const docDataModel = univerInstanceService.getCurrentUniverDocInstance(), originBody = docDataModel == null ? void 0 : docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n        if (docDataModel == null || originBody == null) return !1;\n        const unitId = docDataModel.getUnitId(), doMutation = {\n            id: (0, $7AR1b.RichTextEditingMutation).id,\n            params: {\n                unitId: unitId,\n                actions: [],\n                textRanges: textRanges,\n                segmentId: segmentId\n            }\n        }, memoryCursor = new (0, $7yNYd.MemoryCursor)();\n        memoryCursor.reset();\n        const textX = new (0, $7yNYd.TextX)(), jsonX = (0, $7yNYd.JSONX).getInstance(), rawActions = [], hasTable = !!((_a28 = body.tables) != null && _a28.length), hasCustomBlock = !!((_b = body.customBlocks) != null && _b.length);\n        if (hasTable && segmentId || hasTable && $bb9ae9d90429a70d$var$hasRangeInTable(selections)) return !1;\n        for (const selection of selections){\n            const { startOffset: startOffset, endOffset: endOffset, collapsed: collapsed } = selection, len = startOffset - memoryCursor.cursor, cloneBody = (0, $7yNYd.Tools).deepClone(body);\n            if (hasTable) for (const t of cloneBody.tables){\n                const { tableId: oldTableId } = t, tableId = (0, $7yNYd.Tools).generateRandomId(6);\n                t.tableId = tableId;\n                const table = (0, $7yNYd.Tools).deepClone(tableSource[oldTableId]);\n                table.tableId = tableId;\n                const action = jsonX.insertOp([\n                    \"tableSource\",\n                    tableId\n                ], table);\n                rawActions.push(action);\n            }\n            if (hasCustomBlock && drawings) {\n                const drawingLen = (_d = (_c = docDataModel.getSnapshot().drawingsOrder) == null ? void 0 : _c.length) != null ? _d : 0;\n                for (const block of cloneBody.customBlocks){\n                    const { blockId: blockId } = block, drawingId = (0, $7yNYd.Tools).generateRandomId(6);\n                    block.blockId = drawingId;\n                    const drawing = (0, $7yNYd.Tools).deepClone(drawings[blockId]);\n                    drawing.drawingId = drawingId;\n                    const action = jsonX.insertOp([\n                        \"drawings\",\n                        drawingId\n                    ], drawing), orderAction = jsonX.insertOp([\n                        \"drawingsOrder\",\n                        drawingLen\n                    ], drawingId);\n                    rawActions.push(action), rawActions.push(orderAction);\n                }\n            }\n            if (collapsed) textX.push({\n                t: (0, $7yNYd.TextXActionType).RETAIN,\n                len: len,\n                segmentId: segmentId\n            });\n            else {\n                const { dos: dos } = (0, $7yNYd.BuildTextUtils).selection.getDeleteActions(selection, segmentId, memoryCursor.cursor, originBody);\n                textX.push(...dos);\n            }\n            textX.push({\n                t: (0, $7yNYd.TextXActionType).INSERT,\n                body: cloneBody,\n                len: body.dataStream.length,\n                line: 0,\n                segmentId: segmentId\n            }), memoryCursor.reset(), memoryCursor.moveCursor(endOffset);\n        }\n        const path = $bb9ae9d90429a70d$export$abad77f79f46bb97(docDataModel, segmentId);\n        return rawActions.push(jsonX.editOp(textX.serialize(), path)), doMutation.params.actions = rawActions.reduce((acc, cur)=>(0, $7yNYd.JSONX).compose(acc, cur), null), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n    }, \"handler\")\n};\nfunction $bb9ae9d90429a70d$var$getCutActionsFromTextRanges(selections, docDataModel, segmentId) {\n    var _a28, _b;\n    const originBody = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody(), textX = new (0, $7yNYd.TextX)(), jsonX = (0, $7yNYd.JSONX).getInstance(), rawActions = [];\n    if (originBody == null) return rawActions;\n    const memoryCursor = new (0, $7yNYd.MemoryCursor)();\n    memoryCursor.reset();\n    for (const selection of selections){\n        const { startOffset: startOffset, endOffset: endOffset, collapsed: collapsed } = selection;\n        if (startOffset == null || endOffset == null) continue;\n        const len = startOffset - memoryCursor.cursor;\n        collapsed ? textX.push({\n            t: (0, $7yNYd.TextXActionType).RETAIN,\n            len: len,\n            segmentId: segmentId\n        }) : textX.push(...(0, $7yNYd.BuildTextUtils).selection.getDeleteExculdeLastLineBreakActions(selection, originBody, segmentId, memoryCursor.cursor, !1)), memoryCursor.reset(), memoryCursor.moveCursor(endOffset);\n    }\n    const path = $bb9ae9d90429a70d$export$abad77f79f46bb97(docDataModel, segmentId);\n    rawActions.push(jsonX.editOp(textX.serialize(), path));\n    const removedCustomBlockIds = $bb9ae9d90429a70d$export$aa9bc8623aab3a9c(originBody, selections), drawings = (_a28 = docDataModel.getDrawings()) != null ? _a28 : {}, drawingOrder = (_b = docDataModel.getDrawingsOrder()) != null ? _b : [], sortedRemovedCustomBlockIds = removedCustomBlockIds.sort((a, b)=>drawingOrder.indexOf(a) > drawingOrder.indexOf(b) ? -1 : drawingOrder.indexOf(a) < drawingOrder.indexOf(b) ? 1 : 0);\n    if (sortedRemovedCustomBlockIds.length > 0) for (const blockId of sortedRemovedCustomBlockIds){\n        const drawing = drawings[blockId], drawingIndex = drawingOrder.indexOf(blockId);\n        if (drawing == null || drawingIndex < 0) continue;\n        const removeDrawingAction = jsonX.removeOp([\n            \"drawings\",\n            blockId\n        ], drawing), removeDrawingOrderAction = jsonX.removeOp([\n            \"drawingsOrder\",\n            drawingIndex\n        ], blockId);\n        rawActions.push(removeDrawingAction), rawActions.push(removeDrawingOrderAction);\n    }\n    return rawActions.reduce((acc, cur)=>(0, $7yNYd.JSONX).compose(acc, cur), null);\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getCutActionsFromTextRanges, \"getCutActionsFromTextRanges\");\nfunction $bb9ae9d90429a70d$var$getCutActionsFromRectRanges(ranges, docDataModel, viewModel, segmentId) {\n    const rawActions = [];\n    if (docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody() == null) return rawActions;\n    const textX = new (0, $7yNYd.TextX)(), jsonX = (0, $7yNYd.JSONX).getInstance(), memoryCursor = new (0, $7yNYd.MemoryCursor)();\n    memoryCursor.reset();\n    for (const range of ranges){\n        const { startOffset: startOffset, endOffset: endOffset, spanEntireRow: spanEntireRow, spanEntireTable: spanEntireTable } = range;\n        if (!(startOffset == null || endOffset == null)) {\n            if (spanEntireTable) {\n                const actionParams = $bb9ae9d90429a70d$var$getDeleteTableActionParams({\n                    startOffset: startOffset,\n                    endOffset: endOffset,\n                    segmentId: segmentId\n                }, viewModel);\n                if (actionParams == null) continue;\n                const { offset: offset, len: len, tableId: tableId } = actionParams;\n                offset - memoryCursor.cursor > 0 && textX.push({\n                    t: (0, $7yNYd.TextXActionType).RETAIN,\n                    len: offset - memoryCursor.cursor,\n                    segmentId: segmentId\n                }), textX.push({\n                    t: (0, $7yNYd.TextXActionType).DELETE,\n                    len: len,\n                    line: 0,\n                    segmentId: segmentId\n                });\n                const action = jsonX.removeOp([\n                    \"tableSource\",\n                    tableId\n                ]);\n                rawActions.push(action), memoryCursor.moveCursorTo(offset + len);\n            } else if (spanEntireRow) {\n                const actionParams = $bb9ae9d90429a70d$var$getDeleteRowsActionsParams({\n                    startOffset: startOffset,\n                    endOffset: endOffset,\n                    segmentId: segmentId\n                }, viewModel);\n                if (actionParams == null) continue;\n                const { offset: offset, rowIndexes: rowIndexes, len: len, tableId: tableId } = actionParams;\n                offset - memoryCursor.cursor > 0 && textX.push({\n                    t: (0, $7yNYd.TextXActionType).RETAIN,\n                    len: offset - memoryCursor.cursor,\n                    segmentId: segmentId\n                }), textX.push({\n                    t: (0, $7yNYd.TextXActionType).DELETE,\n                    len: len,\n                    line: 0,\n                    segmentId: segmentId\n                });\n                for (const index of rowIndexes.reverse()){\n                    const action = jsonX.removeOp([\n                        \"tableSource\",\n                        tableId,\n                        \"tableRows\",\n                        index\n                    ]);\n                    rawActions.push(action);\n                }\n                memoryCursor.moveCursorTo(offset + len);\n            } else {\n                const actionParams = $bb9ae9d90429a70d$var$getDeleteRowContentActionParams({\n                    startOffset: startOffset,\n                    endOffset: endOffset,\n                    segmentId: segmentId\n                }, viewModel);\n                if (actionParams == null) continue;\n                const { offsets: offsets } = actionParams;\n                for (const offset of offsets){\n                    const { retain: retain, delete: delLen } = offset;\n                    retain - memoryCursor.cursor > 0 && textX.push({\n                        t: (0, $7yNYd.TextXActionType).RETAIN,\n                        len: retain - memoryCursor.cursor,\n                        segmentId: segmentId\n                    }), textX.push({\n                        t: (0, $7yNYd.TextXActionType).DELETE,\n                        len: delLen,\n                        line: 0,\n                        segmentId: segmentId\n                    }), memoryCursor.moveCursorTo(retain + delLen);\n                }\n            }\n        }\n    }\n    const path = $bb9ae9d90429a70d$export$abad77f79f46bb97(docDataModel, segmentId);\n    return rawActions.push(jsonX.editOp(textX.serialize(), path)), rawActions.reduce((acc, cur)=>(0, $7yNYd.JSONX).compose(acc, cur), null);\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getCutActionsFromRectRanges, \"getCutActionsFromRectRanges\");\nfunction $bb9ae9d90429a70d$export$55e7786fece24ca1(textRanges, rectRanges, docDataModel, viewModel, segmentId) {\n    let rawActions = [];\n    if (Array.isArray(textRanges) && (textRanges == null ? void 0 : textRanges.length) !== 0 && (rawActions = $bb9ae9d90429a70d$var$getCutActionsFromTextRanges(textRanges, docDataModel, segmentId)), Array.isArray(rectRanges) && (rectRanges == null ? void 0 : rectRanges.length) !== 0) {\n        const actions = $bb9ae9d90429a70d$var$getCutActionsFromRectRanges(rectRanges, docDataModel, viewModel, segmentId);\n        rawActions == null || rawActions.length === 0 ? rawActions = actions : rawActions = (0, $7yNYd.JSONX).compose(rawActions, (0, $7yNYd.JSONX).transform(actions, rawActions, \"right\"));\n    }\n    return rawActions;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$55e7786fece24ca1, \"getCutActionsFromDocRanges\");\nconst $bb9ae9d90429a70d$var$INNER_CUT_COMMAND_ID = \"doc.command.inner-cut\", $bb9ae9d90429a70d$export$c235cac640c1f2b3 = {\n    id: $bb9ae9d90429a70d$var$INNER_CUT_COMMAND_ID,\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        var _a28, _b;\n        const { segmentId: segmentId, textRanges: textRanges } = params, commandService = accessor.get((0, $7yNYd.ICommandService)), docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), selections = (_a28 = params.selections) != null ? _a28 : docSelectionManagerService.getCurrentTextRanges(), rectRanges = docSelectionManagerService.getCurrentRectRanges();\n        if ((!Array.isArray(selections) || selections.length === 0) && (!Array.isArray(rectRanges) || rectRanges.length === 0)) return !1;\n        const unitId = (_b = univerInstanceService.getCurrentUniverDocInstance()) == null ? void 0 : _b.getUnitId();\n        if (!unitId) return !1;\n        const docDataModel = univerInstanceService.getUniverDocInstance(unitId);\n        if (docDataModel == null) return !1;\n        const docSkeletonManagerService = $bb9ae9d90429a70d$export$aca1be174465426e(accessor, unitId);\n        if (docSkeletonManagerService == null) return !1;\n        const viewModel = docSkeletonManagerService.getViewModel(), doMutation = {\n            id: (0, $7AR1b.RichTextEditingMutation).id,\n            params: {\n                unitId: unitId,\n                actions: [],\n                textRanges: textRanges\n            }\n        };\n        return doMutation.params.actions = $bb9ae9d90429a70d$export$55e7786fece24ca1(selections, rectRanges, docDataModel, viewModel, segmentId), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$var$getDeleteSelection = (0, $7yNYd.BuildTextUtils).selection.getDeleteSelection, $bb9ae9d90429a70d$export$6d896186514a9d62 = {\n    id: \"doc.command.delete-custom-block\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        var _a28;\n        const docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), commandService = accessor.get((0, $7yNYd.ICommandService)), activeRange = docSelectionManagerService.getActiveTextRange(), documentDataModel = univerInstanceService.getCurrentUniverDocInstance();\n        if (activeRange == null || documentDataModel == null) return !1;\n        const { direction: direction, range: range, unitId: unitId, drawingId: drawingId } = params, { startOffset: startOffset, segmentId: segmentId, style: style } = activeRange, cursor = direction === $bb9ae9d90429a70d$var$DeleteDirection.LEFT ? startOffset - 1 : startOffset, textRanges = [\n            {\n                startOffset: cursor,\n                endOffset: cursor,\n                style: style\n            }\n        ], doMutation = {\n            id: (0, $7AR1b.RichTextEditingMutation).id,\n            params: {\n                unitId: unitId,\n                actions: [],\n                textRanges: textRanges,\n                prevTextRanges: [\n                    range\n                ]\n            }\n        }, textX = new (0, $7yNYd.TextX)(), jsonX = (0, $7yNYd.JSONX).getInstance(), rawActions = [];\n        startOffset > 0 && textX.push({\n            t: (0, $7yNYd.TextXActionType).RETAIN,\n            len: direction === $bb9ae9d90429a70d$var$DeleteDirection.LEFT ? startOffset - 1 : startOffset,\n            segmentId: segmentId\n        }), textX.push({\n            t: (0, $7yNYd.TextXActionType).DELETE,\n            len: 1,\n            line: 0,\n            segmentId: segmentId\n        });\n        const path = $bb9ae9d90429a70d$export$abad77f79f46bb97(documentDataModel, segmentId);\n        rawActions.push(jsonX.editOp(textX.serialize(), path));\n        const drawing = ((_a28 = documentDataModel.getDrawings()) != null ? _a28 : {})[drawingId], drawingIndex = documentDataModel.getDrawingsOrder().indexOf(drawingId), removeDrawingAction = jsonX.removeOp([\n            \"drawings\",\n            drawingId\n        ], drawing), removeDrawingOrderAction = jsonX.removeOp([\n            \"drawingsOrder\",\n            drawingIndex\n        ], drawingId);\n        return rawActions.push(removeDrawingAction), rawActions.push(removeDrawingOrderAction), doMutation.params.actions = rawActions.reduce((acc, cur)=>(0, $7yNYd.JSONX).compose(acc, cur), null), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$export$d11f1a7d3b7026a9 = {\n    id: \"doc.command.merge-two-paragraph\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    // eslint-disable-next-line max-lines-per-function\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        const docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), commandService = accessor.get((0, $7yNYd.ICommandService)), { direction: direction, range: range } = params, activeRange = docSelectionManagerService.getActiveTextRange(), ranges = docSelectionManagerService.getCurrentTextRanges();\n        if (activeRange == null || ranges == null) return !1;\n        const { segmentId: segmentId, style: style } = activeRange, docDataModel = univerInstanceService.getCurrentUniverDocInstance(), originBody = docDataModel == null ? void 0 : docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n        if (!docDataModel || !originBody) return !1;\n        const actualRange = $bb9ae9d90429a70d$var$getDeleteSelection(activeRange, originBody), unitId = docDataModel.getUnitId(), { startOffset: startOffset, collapsed: collapsed } = actualRange;\n        if (!collapsed) return !1;\n        const startIndex = direction === $bb9ae9d90429a70d$var$DeleteDirection.LEFT ? startOffset : startOffset + 1, endIndex = originBody.paragraphs.find((p2)=>p2.startIndex >= startIndex).startIndex, body = $bb9ae9d90429a70d$var$getParagraphBody(accessor, unitId, originBody, startIndex, endIndex), cursor = direction === $bb9ae9d90429a70d$var$DeleteDirection.LEFT ? startOffset - 1 : startOffset, textRanges = [\n            {\n                startOffset: cursor,\n                endOffset: cursor,\n                style: style\n            }\n        ], doMutation = {\n            id: (0, $7AR1b.RichTextEditingMutation).id,\n            params: {\n                unitId: unitId,\n                actions: [],\n                textRanges: textRanges,\n                prevTextRanges: [\n                    range\n                ]\n            }\n        }, textX = new (0, $7yNYd.TextX)(), jsonX = (0, $7yNYd.JSONX).getInstance();\n        textX.push({\n            t: (0, $7yNYd.TextXActionType).RETAIN,\n            len: direction === $bb9ae9d90429a70d$var$DeleteDirection.LEFT ? startOffset - 1 : startOffset,\n            segmentId: segmentId\n        }), body.dataStream.length && textX.push({\n            t: (0, $7yNYd.TextXActionType).INSERT,\n            body: body,\n            len: body.dataStream.length,\n            line: 0,\n            segmentId: segmentId\n        }), textX.push({\n            t: (0, $7yNYd.TextXActionType).RETAIN,\n            len: 1,\n            segmentId: segmentId\n        }), textX.push({\n            t: (0, $7yNYd.TextXActionType).DELETE,\n            len: endIndex + 1 - startIndex,\n            line: 0,\n            segmentId: segmentId\n        });\n        const path = $bb9ae9d90429a70d$export$abad77f79f46bb97(docDataModel, segmentId);\n        return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n    }, \"handler\")\n};\nfunction $bb9ae9d90429a70d$export$9d7b3e913f0b01bc(textRanges, rectRanges) {\n    let cursor = 0;\n    if (textRanges == null || textRanges.length === 0) {\n        if (typeof rectRanges[0].startOffset == \"number\") {\n            const rectRange = rectRanges[0], { spanEntireRow: spanEntireRow, spanEntireTable: spanEntireTable } = rectRange;\n            spanEntireTable ? cursor = rectRange.startOffset - 3 : spanEntireRow ? rectRange.startRow > 0 ? cursor = rectRange.startOffset - 6 : cursor = rectRange.startOffset : cursor = rectRanges[0].startOffset;\n        }\n    } else if (textRanges.length > 0 && rectRanges.length > 0) {\n        const textRange = textRanges[0], rectRange = rectRanges[0];\n        if (textRange.startOffset != null && rectRange.startOffset != null) {\n            if (textRange.startOffset < rectRange.startOffset) cursor = textRange.startOffset;\n            else if (textRange.startOffset >= rectRange.startOffset) {\n                const { spanEntireRow: spanEntireRow, spanEntireTable: spanEntireTable } = rectRange;\n                spanEntireTable ? cursor = rectRange.startOffset - 3 : spanEntireRow && (cursor = rectRange.startOffset - 6);\n            }\n        }\n    }\n    return cursor;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$9d7b3e913f0b01bc, \"getCursorWhenDelete\");\nconst $bb9ae9d90429a70d$export$b83c33c82ff96791 = {\n    id: \"doc.command.delete-left\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    // eslint-disable-next-line max-lines-per-function, complexity\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor)=>{\n        var _a28, _b;\n        const docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), commandService = accessor.get((0, $7yNYd.ICommandService));\n        let result = !0;\n        const docDataModel = univerInstanceService.getCurrentUniverDocInstance();\n        if (!docDataModel) return !1;\n        const unitId = docDataModel.getUnitId(), docSkeletonManagerService = $bb9ae9d90429a70d$export$aca1be174465426e(accessor, unitId), activeRange = docSelectionManagerService.getActiveTextRange(), rectRanges = docSelectionManagerService.getCurrentRectRanges(), ranges = docSelectionManagerService.getCurrentTextRanges(), skeleton = docSkeletonManagerService == null ? void 0 : docSkeletonManagerService.getSkeleton();\n        if (skeleton == null) return !1;\n        if (rectRanges != null && rectRanges.length) {\n            const cursor2 = $bb9ae9d90429a70d$export$9d7b3e913f0b01bc(ranges, rectRanges), segmentId2 = rectRanges[0].segmentId, textRanges = [\n                {\n                    startOffset: cursor2,\n                    endOffset: cursor2\n                }\n            ];\n            return commandService.executeCommand($bb9ae9d90429a70d$export$c235cac640c1f2b3.id, {\n                segmentId: segmentId2,\n                textRanges: textRanges\n            });\n        }\n        if (activeRange == null || ranges == null) return !1;\n        const { segmentId: segmentId, style: style, segmentPage: segmentPage } = activeRange, body = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n        if (body == null) return !1;\n        const actualRange = $bb9ae9d90429a70d$var$getDeleteSelection(activeRange, body), { startOffset: startOffset, collapsed: collapsed } = actualRange, curGlyph = skeleton.findNodeByCharIndex(startOffset, segmentId, segmentPage), isBullet = (0, $3e0Iz.hasListGlyph)(curGlyph), isIndent = (0, $3e0Iz.isIndentByGlyph)(curGlyph, body);\n        let cursor = startOffset;\n        const preGlyph = skeleton.findNodeByCharIndex(startOffset - 1, segmentId, segmentPage);\n        if ((0, $3e0Iz.isFirstGlyph)(curGlyph) && preGlyph !== curGlyph && (isBullet === !0 || isIndent === !0) && collapsed) {\n            const paragraph = (0, $3e0Iz.getParagraphByGlyph)(curGlyph, body);\n            if (paragraph == null) return !1;\n            const paragraphIndex = paragraph == null ? void 0 : paragraph.startIndex, updateParagraph = {\n                startIndex: 0\n            }, paragraphStyle = paragraph.paragraphStyle;\n            if (isBullet === !0) {\n                const paragraphStyle2 = paragraph.paragraphStyle;\n                if (paragraphStyle2) {\n                    updateParagraph.paragraphStyle = paragraphStyle2;\n                    const { hanging: hanging } = paragraphStyle2;\n                    hanging && (updateParagraph.paragraphStyle.indentStart = hanging, updateParagraph.paragraphStyle.hanging = void 0);\n                }\n            } else if (isIndent === !0) {\n                const bullet = paragraph.bullet;\n                bullet && (updateParagraph.bullet = bullet), paragraphStyle != null && (updateParagraph.paragraphStyle = {\n                    ...paragraphStyle\n                }, delete updateParagraph.paragraphStyle.hanging, delete updateParagraph.paragraphStyle.indentStart);\n            }\n            const textRanges = [\n                {\n                    startOffset: cursor,\n                    endOffset: cursor,\n                    style: style\n                }\n            ];\n            result = await commandService.executeCommand($bb9ae9d90429a70d$export$19ae6d3f93acfd2e.id, {\n                unitId: docDataModel.getUnitId(),\n                updateBody: {\n                    dataStream: \"\",\n                    paragraphs: [\n                        {\n                            ...updateParagraph\n                        }\n                    ]\n                },\n                range: {\n                    startOffset: paragraphIndex,\n                    endOffset: paragraphIndex + 1\n                },\n                textRanges: textRanges,\n                coverType: (0, $7yNYd.UpdateDocsAttributeType).REPLACE,\n                segmentId: segmentId\n            });\n        } else if (collapsed === !0) {\n            if (preGlyph == null) return !0;\n            if (preGlyph.content === \"\\r\") result = await commandService.executeCommand($bb9ae9d90429a70d$export$d11f1a7d3b7026a9.id, {\n                direction: $bb9ae9d90429a70d$var$DeleteDirection.LEFT,\n                range: actualRange\n            });\n            else if (preGlyph.streamType === \"\\b\") {\n                const drawing = (_b = docDataModel.getSnapshot().drawings) == null ? void 0 : _b[(_a28 = preGlyph.drawingId) != null ? _a28 : \"\"];\n                if (drawing == null) return !0;\n                if (drawing.layoutType === (0, $7yNYd.PositionedObjectLayoutType).INLINE) {\n                    const unitId2 = docDataModel.getUnitId();\n                    result = await commandService.executeCommand($bb9ae9d90429a70d$export$6d896186514a9d62.id, {\n                        direction: $bb9ae9d90429a70d$var$DeleteDirection.LEFT,\n                        range: activeRange,\n                        unitId: unitId2,\n                        drawingId: preGlyph.drawingId\n                    });\n                } else {\n                    const prePreGlyph = skeleton.findNodeByCharIndex(startOffset - 2);\n                    if (prePreGlyph == null) return !0;\n                    cursor -= preGlyph.count, cursor -= prePreGlyph.count;\n                    const textRanges = [\n                        {\n                            startOffset: cursor,\n                            endOffset: cursor,\n                            style: style\n                        }\n                    ];\n                    result = await commandService.executeCommand($bb9ae9d90429a70d$export$bcbb37853c82bc7a.id, {\n                        unitId: docDataModel.getUnitId(),\n                        range: {\n                            ...activeRange,\n                            startOffset: activeRange.startOffset - 1,\n                            endOffset: activeRange.endOffset - 1\n                        },\n                        segmentId: segmentId,\n                        direction: $bb9ae9d90429a70d$var$DeleteDirection.LEFT,\n                        len: prePreGlyph.count,\n                        textRanges: textRanges\n                    });\n                }\n            } else cursor -= preGlyph.count, result = await commandService.executeCommand($bb9ae9d90429a70d$export$bcbb37853c82bc7a.id, {\n                unitId: docDataModel.getUnitId(),\n                range: actualRange,\n                segmentId: segmentId,\n                direction: $bb9ae9d90429a70d$var$DeleteDirection.LEFT,\n                len: preGlyph.count\n            });\n        } else {\n            const textRanges = $bb9ae9d90429a70d$var$getTextRangesWhenDelete(actualRange, [\n                actualRange\n            ]);\n            result = await commandService.executeCommand($bb9ae9d90429a70d$export$c235cac640c1f2b3.id, {\n                segmentId: segmentId,\n                textRanges: textRanges,\n                selections: [\n                    actualRange\n                ]\n            });\n        }\n        return result;\n    }, \"handler\")\n}, $bb9ae9d90429a70d$export$887646cf81f0174e = {\n    id: \"doc.command.delete-right\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    // eslint-disable-next-line max-lines-per-function, complexity\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor)=>{\n        var _a28, _b;\n        const docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), docDataModel = accessor.get((0, $7yNYd.IUniverInstanceService)).getCurrentUniverDocInstance();\n        if (!docDataModel) return !1;\n        const docSkeletonManagerService = $bb9ae9d90429a70d$export$aca1be174465426e(accessor, docDataModel.getUnitId()), commandService = accessor.get((0, $7yNYd.ICommandService)), activeRange = docSelectionManagerService.getActiveTextRange(), rectRanges = docSelectionManagerService.getCurrentRectRanges(), ranges = docSelectionManagerService.getCurrentTextRanges(), skeleton = docSkeletonManagerService == null ? void 0 : docSkeletonManagerService.getSkeleton();\n        if (rectRanges != null && rectRanges.length) {\n            const cursor = $bb9ae9d90429a70d$export$9d7b3e913f0b01bc(ranges, rectRanges), segmentId2 = rectRanges[0].segmentId, textRanges = [\n                {\n                    startOffset: cursor,\n                    endOffset: cursor\n                }\n            ];\n            return commandService.executeCommand($bb9ae9d90429a70d$export$c235cac640c1f2b3.id, {\n                segmentId: segmentId2,\n                textRanges: textRanges\n            });\n        }\n        if (activeRange == null || skeleton == null || ranges == null) return !1;\n        const { segmentId: segmentId, style: style, segmentPage: segmentPage } = activeRange, body = docDataModel == null ? void 0 : docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n        if (!docDataModel || !body) return !1;\n        const actualRange = $bb9ae9d90429a70d$var$getDeleteSelection(activeRange, body, $bb9ae9d90429a70d$var$DeleteDirection.RIGHT), { startOffset: startOffset, endOffset: endOffset, collapsed: collapsed } = actualRange;\n        if (startOffset === body.dataStream.length - 2 && collapsed) return !0;\n        let result = !1;\n        if (collapsed === !0) {\n            const needDeleteGlyph = skeleton.findNodeByCharIndex(startOffset, segmentId, segmentPage), nextGlyph = skeleton.findNodeByCharIndex(startOffset + 1);\n            if (needDeleteGlyph.streamType === (0, $7yNYd.DataStreamTreeTokenType).PARAGRAPH && (nextGlyph == null ? void 0 : nextGlyph.streamType) === (0, $7yNYd.DataStreamTreeTokenType).SECTION_BREAK) return !1;\n            if (needDeleteGlyph.content === \"\\r\") result = await commandService.executeCommand($bb9ae9d90429a70d$export$d11f1a7d3b7026a9.id, {\n                direction: $bb9ae9d90429a70d$var$DeleteDirection.RIGHT,\n                range: activeRange\n            });\n            else if (needDeleteGlyph.streamType === \"\\b\") {\n                const drawing = (_b = docDataModel.getSnapshot().drawings) == null ? void 0 : _b[(_a28 = needDeleteGlyph.drawingId) != null ? _a28 : \"\"];\n                if (drawing == null) return !0;\n                if (drawing.layoutType === (0, $7yNYd.PositionedObjectLayoutType).INLINE) {\n                    const unitId = docDataModel.getUnitId();\n                    result = await commandService.executeCommand($bb9ae9d90429a70d$export$6d896186514a9d62.id, {\n                        direction: $bb9ae9d90429a70d$var$DeleteDirection.RIGHT,\n                        range: activeRange,\n                        unitId: unitId,\n                        drawingId: needDeleteGlyph.drawingId\n                    });\n                } else {\n                    if (nextGlyph == null) return !0;\n                    const textRanges = [\n                        {\n                            startOffset: startOffset + 1,\n                            endOffset: startOffset + 1,\n                            style: style\n                        }\n                    ];\n                    result = await commandService.executeCommand($bb9ae9d90429a70d$export$bcbb37853c82bc7a.id, {\n                        unitId: docDataModel.getUnitId(),\n                        range: {\n                            ...activeRange,\n                            startOffset: startOffset + 1,\n                            endOffset: endOffset + 1\n                        },\n                        segmentId: segmentId,\n                        direction: $bb9ae9d90429a70d$var$DeleteDirection.RIGHT,\n                        textRanges: textRanges,\n                        len: nextGlyph.count\n                    });\n                }\n            } else {\n                const textRanges = [\n                    {\n                        startOffset: startOffset,\n                        endOffset: startOffset,\n                        style: style\n                    }\n                ];\n                result = await commandService.executeCommand($bb9ae9d90429a70d$export$bcbb37853c82bc7a.id, {\n                    unitId: docDataModel.getUnitId(),\n                    range: actualRange,\n                    segmentId: segmentId,\n                    direction: $bb9ae9d90429a70d$var$DeleteDirection.RIGHT,\n                    textRanges: textRanges,\n                    len: needDeleteGlyph.count\n                });\n            }\n        } else {\n            const textRanges = $bb9ae9d90429a70d$var$getTextRangesWhenDelete(actualRange, [\n                actualRange\n            ]);\n            result = await commandService.executeCommand($bb9ae9d90429a70d$export$c235cac640c1f2b3.id, {\n                segmentId: segmentId,\n                textRanges: textRanges,\n                selections: [\n                    actualRange\n                ]\n            });\n        }\n        return result;\n    }, \"handler\")\n};\nfunction $bb9ae9d90429a70d$var$getParagraphBody(accessor, unitId, body, start, end) {\n    const { textRuns: originTextRuns = [], customBlocks: originCustomBlocks = [] } = body, bodySlice = {\n        dataStream: body.dataStream.substring(start, end),\n        customRanges: (0, $7yNYd.getCustomRangeSlice)(body, start, end).customRanges.map((range)=>({\n                ...(0, $7yNYd.Tools).deepClone(range),\n                rangeId: (0, $7yNYd.generateRandomId)()\n            })),\n        customDecorations: (0, $7yNYd.getCustomDecorationSlice)(body, start, end)\n    }, textRuns = [];\n    for (const textRun of originTextRuns){\n        const { st: st, ed: ed } = textRun;\n        ed <= start || st >= end || (st < start ? textRuns.push({\n            ...textRun,\n            st: 0,\n            ed: ed - start\n        }) : ed > end ? textRuns.push({\n            ...textRun,\n            st: st - start,\n            ed: end - start\n        }) : textRuns.push({\n            ...textRun,\n            st: st - start,\n            ed: ed - start\n        }));\n    }\n    textRuns.length > 0 && (bodySlice.textRuns = textRuns);\n    const customBlocks = [];\n    for (const block of originCustomBlocks){\n        const { startIndex: startIndex } = block;\n        startIndex >= start && startIndex <= end && customBlocks.push({\n            ...block,\n            startIndex: startIndex - start\n        });\n    }\n    return customBlocks.length > 0 && (bodySlice.customBlocks = customBlocks), bodySlice;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getParagraphBody, \"getParagraphBody\");\nfunction $bb9ae9d90429a70d$var$getTextRangesWhenDelete(activeRange, ranges) {\n    let cursor = activeRange.endOffset;\n    for (const range of ranges){\n        const { startOffset: startOffset, endOffset: endOffset } = range;\n        startOffset == null || endOffset == null || endOffset <= activeRange.endOffset && (cursor -= endOffset - startOffset);\n    }\n    return [\n        {\n            startOffset: cursor,\n            endOffset: cursor,\n            style: activeRange.style\n        }\n    ];\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getTextRangesWhenDelete, \"getTextRangesWhenDelete\");\nconst $bb9ae9d90429a70d$var$COPY_CONTENT_CACHE_LIMIT = 10, $bb9ae9d90429a70d$var$ID_LENGTH$2 = 6;\nfunction $bb9ae9d90429a70d$var$genId() {\n    return (0, $7yNYd.Tools).generateRandomId($bb9ae9d90429a70d$var$ID_LENGTH$2);\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$genId, \"genId\");\nfunction $bb9ae9d90429a70d$var$extractId(html) {\n    const match = html.match(/data-copy-id=\"([^\\s]+)\"/);\n    return match && match[1] ? match[1] : null;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$extractId, \"extractId\");\nconst $bb9ae9d90429a70d$var$_CopyContentCache = class _CopyContentCache {\n    constructor(){\n        $bb9ae9d90429a70d$var$__publicField(this, \"_cache\", new (0, $7yNYd.LRUMap)($bb9ae9d90429a70d$var$COPY_CONTENT_CACHE_LIMIT));\n    }\n    set(id, clipboardData) {\n        this._cache.set(id, clipboardData);\n    }\n    get(id) {\n        return this._cache.get(id);\n    }\n    clear() {\n        this._cache.clear();\n    }\n};\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_CopyContentCache, \"CopyContentCache\");\nlet $bb9ae9d90429a70d$var$CopyContentCache = $bb9ae9d90429a70d$var$_CopyContentCache;\nconst $bb9ae9d90429a70d$var$copyContentCache = new $bb9ae9d90429a70d$var$CopyContentCache();\nfunction $bb9ae9d90429a70d$var$extractNodeStyle(node) {\n    const styles2 = node.style, docStyles = {}, tagName = node.tagName.toLowerCase();\n    switch(tagName){\n        case \"b\":\n        case \"em\":\n        case \"strong\":\n            docStyles.bl = (0, $7yNYd.BooleanNumber).TRUE;\n            break;\n        case \"s\":\n            docStyles.st = {\n                s: (0, $7yNYd.BooleanNumber).TRUE\n            };\n            break;\n        case \"u\":\n            docStyles.ul = {\n                s: (0, $7yNYd.BooleanNumber).TRUE\n            };\n            break;\n        case \"i\":\n            docStyles.it = (0, $7yNYd.BooleanNumber).TRUE;\n            break;\n        case \"sub\":\n        case \"sup\":\n            docStyles.va = tagName === \"sup\" ? (0, $7yNYd.BaselineOffset).SUPERSCRIPT : (0, $7yNYd.BaselineOffset).SUBSCRIPT;\n            break;\n    }\n    for(let i = 0; i < styles2.length; i++){\n        const cssRule = styles2[i], cssValue = styles2.getPropertyValue(cssRule);\n        switch(cssRule){\n            case \"font-family\":\n                docStyles.ff = cssValue.replace(/^\"/g, \"\").replace(/\"$/g, \"\");\n                break;\n            case \"font-size\":\n                {\n                    const fontSize = Number.parseInt(cssValue);\n                    Number.isNaN(fontSize) || (cssValue.endsWith(\"pt\") ? docStyles.fs = fontSize : cssValue.endsWith(\"px\") && (docStyles.fs = (0, $3e0Iz.pixelToPt)(fontSize)));\n                    break;\n                }\n            case \"font-style\":\n                cssValue === \"italic\" && (docStyles.it = (0, $7yNYd.BooleanNumber).TRUE);\n                break;\n            case \"font-weight\":\n                (Number(cssValue) > 400 || String(cssValue) === \"bold\") && (docStyles.bl = (0, $7yNYd.BooleanNumber).TRUE);\n                break;\n            case \"text-decoration\":\n                /underline/.test(cssValue) ? docStyles.ul = {\n                    s: (0, $7yNYd.BooleanNumber).TRUE\n                } : /overline/.test(cssValue) ? docStyles.ol = {\n                    s: (0, $7yNYd.BooleanNumber).TRUE\n                } : /line-through/.test(cssValue) && (docStyles.st = {\n                    s: (0, $7yNYd.BooleanNumber).TRUE\n                });\n                break;\n            case \"color\":\n                try {\n                    const color = new (0, $7yNYd.ColorKit)(cssValue);\n                    color.isValid && (docStyles.cl = {\n                        rgb: color.toRgbString()\n                    });\n                } catch  {}\n                break;\n            case \"background-color\":\n                {\n                    const color = new (0, $7yNYd.ColorKit)(cssValue);\n                    color.isValid && (docStyles.bg = {\n                        rgb: color.toRgbString()\n                    });\n                    break;\n                }\n        }\n    }\n    return docStyles;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$extractNodeStyle, \"extractNodeStyle\");\nfunction $bb9ae9d90429a70d$var$parseToDom(rawHtml) {\n    const parser = new DOMParser(), html = `<x-univer id=\"univer-root\">${rawHtml}</x-univer>`;\n    return parser.parseFromString(html, \"text/html\").querySelector(\"#univer-root\");\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$parseToDom, \"parseToDom\");\nfunction $bb9ae9d90429a70d$var$matchFilter(node, filter2) {\n    const tagName = node.tagName.toLowerCase();\n    return typeof filter2 == \"string\" ? tagName === filter2 : Array.isArray(filter2) ? filter2.some((name)=>name === tagName) : filter2(node);\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$matchFilter, \"matchFilter\");\nconst $bb9ae9d90429a70d$var$DEFAULT_TABLE_WIDTH = 600, $bb9ae9d90429a70d$var$_HtmlToUDMService = class _HtmlToUDMService {\n    constructor(){\n        $bb9ae9d90429a70d$var$__publicField(this, \"_tableCache\", []);\n        $bb9ae9d90429a70d$var$__publicField(this, \"_styleCache\", /* @__PURE__ */ new Map());\n        $bb9ae9d90429a70d$var$__publicField(this, \"_styleRules\", []);\n        $bb9ae9d90429a70d$var$__publicField(this, \"_afterProcessRules\", []);\n    }\n    static use(plugin) {\n        if (this._pluginList.includes(plugin)) throw new Error(`Univer paste plugin ${plugin.name} already added`);\n        this._pluginList.push(plugin);\n    }\n    convert(html) {\n        const pastePlugin = _HtmlToUDMService._pluginList.find((plugin)=>plugin.checkPasteType(html)), dom = $bb9ae9d90429a70d$var$parseToDom(html), docData = {\n            body: {\n                dataStream: \"\",\n                paragraphs: [],\n                sectionBreaks: [],\n                tables: [],\n                textRuns: []\n            },\n            tableSource: {}\n        };\n        return pastePlugin && (this._styleRules = [\n            ...pastePlugin.stylesRules\n        ], this._afterProcessRules = [\n            ...pastePlugin.afterProcessRules\n        ]), this._tableCache = [], this._styleCache.clear(), this._process(null, dom.childNodes, docData), this._styleCache.clear(), this._styleRules = [], this._afterProcessRules = [], docData;\n    }\n    _process(parent, nodes, doc) {\n        var _a28, _b;\n        const body = doc.body;\n        for (const node of nodes)if (node.nodeType === Node.TEXT_NODE) {\n            if (((_a28 = node.nodeValue) == null ? void 0 : _a28.trim()) === \"\") continue;\n            const text = (_b = node.nodeValue) == null ? void 0 : _b.replace(/[\\r\\n]/g, \"\");\n            let style;\n            parent && this._styleCache.has(parent) && (style = this._styleCache.get(parent)), body.dataStream += text, style && Object.getOwnPropertyNames(style).length && body.textRuns.push({\n                st: body.dataStream.length - text.length,\n                ed: body.dataStream.length,\n                ts: style\n            });\n        } else {\n            if ((0, $7yNYd.skipParseTagNames).includes(node.nodeName.toLowerCase())) continue;\n            if (node.nodeType === Node.ELEMENT_NODE) {\n                const element2 = node, linkStart = this._processBeforeLink(element2, doc), parentStyles = parent ? this._styleCache.get(parent) : {}, styleRule = this._styleRules.find(({ filter: filter2 })=>$bb9ae9d90429a70d$var$matchFilter(node, filter2)), nodeStyles = styleRule ? styleRule.getStyle(node) : $bb9ae9d90429a70d$var$extractNodeStyle(node);\n                this._styleCache.set(node, {\n                    ...parentStyles,\n                    ...nodeStyles\n                });\n                const { childNodes: childNodes } = node;\n                this._processBeforeTable(node, doc), this._process(node, childNodes, doc), this._processAfterTable(node, doc);\n                const afterProcessRule = this._afterProcessRules.find(({ filter: filter2 })=>$bb9ae9d90429a70d$var$matchFilter(node, filter2));\n                afterProcessRule && afterProcessRule.handler(doc, node), this._processAfterLink(element2, doc, linkStart);\n            }\n        }\n    }\n    _processBeforeTable(node, doc) {\n        var _a28;\n        const tagName = node.tagName.toUpperCase(), body = doc.body;\n        switch(tagName){\n            case \"TABLE\":\n                {\n                    body.dataStream[body.dataStream.length - 1] !== \"\\r\" && (body.dataStream += \"\\r\", body.paragraphs == null && (body.paragraphs = []), (_a28 = body.paragraphs) == null || _a28.push({\n                        startIndex: body.dataStream.length - 1\n                    }));\n                    const table = $bb9ae9d90429a70d$export$438ea56a96e58332(0, 0, $bb9ae9d90429a70d$var$DEFAULT_TABLE_WIDTH);\n                    this._tableCache.push({\n                        table: table,\n                        startIndex: body.dataStream.length\n                    }), body.dataStream += (0, $7yNYd.DataStreamTreeTokenType).TABLE_START;\n                    break;\n                }\n            case \"TR\":\n                {\n                    const row = $bb9ae9d90429a70d$export$ff17ef97bed31451(0);\n                    this._tableCache[this._tableCache.length - 1].table.tableRows.push(row), body.dataStream += (0, $7yNYd.DataStreamTreeTokenType).TABLE_ROW_START;\n                    break;\n                }\n            case \"TD\":\n                {\n                    const cell = $bb9ae9d90429a70d$export$ba2e502f47d52b71(), lastTable = this._tableCache[this._tableCache.length - 1].table;\n                    lastTable.tableRows[lastTable.tableRows.length - 1].tableCells.push(cell), body.dataStream += (0, $7yNYd.DataStreamTreeTokenType).TABLE_CELL_START;\n                    break;\n                }\n        }\n    }\n    _processAfterTable(node, doc) {\n        var _a28, _b;\n        const tagName = node.tagName.toUpperCase(), body = doc.body;\n        doc.tableSource == null && (doc.tableSource = {}), body.tables == null && (body.tables = []), body.sectionBreaks == null && (body.sectionBreaks = []);\n        const { tableSource: tableSource } = doc;\n        switch(tagName){\n            case \"TABLE\":\n                {\n                    const tableCache = this._tableCache.pop(), { startIndex: startIndex, table: table } = tableCache, colCount = table.tableRows[0].tableCells.length, tableColumn = $bb9ae9d90429a70d$export$4959bf4a22b5891f($bb9ae9d90429a70d$var$DEFAULT_TABLE_WIDTH / colCount), tableColumns = [\n                        ...new Array(colCount).fill(null).map(()=>(0, $7yNYd.Tools).deepClone(tableColumn))\n                    ];\n                    table.tableColumns = tableColumns, tableSource[table.tableId] = table, body.dataStream += (0, $7yNYd.DataStreamTreeTokenType).TABLE_END, body.tables.push({\n                        startIndex: startIndex,\n                        endIndex: body.dataStream.length - 1,\n                        tableId: table.tableId\n                    });\n                    break;\n                }\n            case \"TR\":\n                body.dataStream += (0, $7yNYd.DataStreamTreeTokenType).TABLE_ROW_END;\n                break;\n            case \"TD\":\n                body.dataStream[body.dataStream.length - 1] !== \"\\r\" && ((_a28 = body.paragraphs) == null || _a28.push({\n                    startIndex: body.dataStream.length\n                }), body.dataStream += \"\\r\"), (_b = body.sectionBreaks) == null || _b.push({\n                    startIndex: body.dataStream.length\n                }), body.dataStream += `\n${(0, $7yNYd.DataStreamTreeTokenType).TABLE_CELL_END}`;\n                break;\n        }\n    }\n    _processBeforeLink(node, doc) {\n        const body = doc.body, element2 = node, start = body.dataStream.length;\n        return element2.tagName.toUpperCase() === \"A\" && (body.dataStream += (0, $7yNYd.DataStreamTreeTokenType).CUSTOM_RANGE_START), start;\n    }\n    _processAfterLink(node, doc, start) {\n        var _a28, _b;\n        const body = doc.body, element2 = node;\n        element2.tagName.toUpperCase() === \"A\" && (body.dataStream += (0, $7yNYd.DataStreamTreeTokenType).CUSTOM_RANGE_END, body.customRanges = (_a28 = body.customRanges) != null ? _a28 : [], body.customRanges.push({\n            startIndex: start,\n            endIndex: body.dataStream.length - 1,\n            rangeId: (_b = element2.dataset.rangeid) != null ? _b : (0, $7yNYd.generateRandomId)(),\n            rangeType: (0, $7yNYd.CustomRangeType).HYPERLINK,\n            properties: {\n                url: element2.href\n            }\n        }));\n    }\n};\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_HtmlToUDMService, \"HtmlToUDMService\"), $bb9ae9d90429a70d$var$__publicField($bb9ae9d90429a70d$var$_HtmlToUDMService, \"_pluginList\", []);\nlet $bb9ae9d90429a70d$var$HtmlToUDMService = $bb9ae9d90429a70d$var$_HtmlToUDMService;\nconst $bb9ae9d90429a70d$var$wordPastePlugin$1 = {\n    name: \"univer-doc-paste-plugin-lark\",\n    checkPasteType (html) {\n        return /lark-record-clipboard/i.test(html);\n    },\n    // TODO: @JOCS, support inline code copy from lark.\n    stylesRules: [\n        {\n            filter: [\n                \"s\"\n            ],\n            getStyle (node) {\n                const inlineStyle = $bb9ae9d90429a70d$var$extractNodeStyle(node);\n                return {\n                    st: {\n                        s: (0, $7yNYd.BooleanNumber).TRUE\n                    },\n                    ...inlineStyle\n                };\n            }\n        }\n    ],\n    afterProcessRules: [\n        {\n            filter (el) {\n                return el.tagName === \"DIV\" && /ace-line/i.test(el.className);\n            },\n            handler (doc) {\n                const body = doc.body;\n                body.paragraphs == null && (body.paragraphs = []), body.paragraphs.push({\n                    startIndex: body.dataStream.length\n                }), body.dataStream += \"\\r\";\n            }\n        }\n    ]\n}, $bb9ae9d90429a70d$export$42e49d92e65ef2ee = $bb9ae9d90429a70d$var$wordPastePlugin$1;\nfunction $bb9ae9d90429a70d$var$getParagraphStyle(el) {\n    const styles2 = el.style, paragraphStyle = {};\n    for(let i = 0; i < styles2.length; i++){\n        const cssRule = styles2[i], cssValue = styles2.getPropertyValue(cssRule);\n        switch(cssRule){\n            case \"margin-top\":\n                {\n                    const marginTopValue = Number.parseInt(cssValue);\n                    paragraphStyle.spaceAbove = {\n                        v: /pt/.test(cssValue) ? (0, $3e0Iz.ptToPixel)(marginTopValue) : marginTopValue\n                    };\n                    break;\n                }\n            case \"margin-bottom\":\n                {\n                    const marginBottomValue = Number.parseInt(cssValue);\n                    paragraphStyle.spaceBelow = {\n                        v: /pt/.test(cssValue) ? (0, $3e0Iz.ptToPixel)(marginBottomValue) : marginBottomValue\n                    };\n                    break;\n                }\n            case \"line-height\":\n                {\n                    let lineHeightValue = Number.parseFloat(cssValue);\n                    cssValue.endsWith(\"%\") && (lineHeightValue /= 100), paragraphStyle.lineSpacing = lineHeightValue;\n                    break;\n                }\n        }\n    }\n    return Object.getOwnPropertyNames(paragraphStyle).length ? paragraphStyle : null;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getParagraphStyle, \"getParagraphStyle\");\nconst $bb9ae9d90429a70d$var$univerPastePlugin = {\n    name: \"univer-doc-paste-plugin-univer\",\n    checkPasteType (html) {\n        return /UniverNormal/i.test(html);\n    },\n    stylesRules: [],\n    afterProcessRules: [\n        {\n            filter (el) {\n                return el.tagName === \"P\" && /UniverNormal/i.test(el.className);\n            },\n            handler (doc, el) {\n                const body = doc.body;\n                body.paragraphs == null && (body.paragraphs = []);\n                const paragraph = {\n                    startIndex: body.dataStream.length\n                }, paragraphStyle = $bb9ae9d90429a70d$var$getParagraphStyle(el);\n                paragraphStyle && (paragraph.paragraphStyle = paragraphStyle), body.paragraphs.push(paragraph), body.dataStream += \"\\r\";\n            }\n        }\n    ]\n}, $bb9ae9d90429a70d$export$ad5e9369ccccfa8d = $bb9ae9d90429a70d$var$univerPastePlugin, $bb9ae9d90429a70d$var$wordPastePlugin = {\n    name: \"univer-doc-paste-plugin-word\",\n    checkPasteType (html) {\n        return /word|mso/i.test(html);\n    },\n    stylesRules: [\n        {\n            filter: [\n                \"b\"\n            ],\n            getStyle (node) {\n                const inlineStyle = $bb9ae9d90429a70d$var$extractNodeStyle(node);\n                return {\n                    bl: (0, $7yNYd.BooleanNumber).TRUE,\n                    ...inlineStyle\n                };\n            }\n        }\n    ],\n    afterProcessRules: [\n        {\n            filter (el) {\n                return el.tagName === \"P\";\n            },\n            handler (doc, el) {\n                const body = doc.body;\n                body.paragraphs == null && (body.paragraphs = []);\n                const paragraph = {\n                    startIndex: body.dataStream.length\n                }, paragraphStyle = $bb9ae9d90429a70d$var$getParagraphStyle(el);\n                paragraphStyle && (paragraph.paragraphStyle = paragraphStyle), body.paragraphs.push(paragraph), body.dataStream += \"\\r\";\n            }\n        }\n    ]\n}, $bb9ae9d90429a70d$export$2235e965a988e893 = $bb9ae9d90429a70d$var$wordPastePlugin;\nfunction $bb9ae9d90429a70d$var$covertTextRunToHtml(dataStream, textRun) {\n    const { st: start, ed: ed, ts: ts = {} } = textRun, { ff: ff, fs: fs, it: it, bl: bl, ul: ul, st: st, ol: ol, bg: bg, cl: cl, va: va } = ts;\n    let html = dataStream.slice(start, ed);\n    const style = [];\n    return it === (0, $7yNYd.BooleanNumber).TRUE && (html = `<i>${html}</i>`), va === (0, $7yNYd.BaselineOffset).SUPERSCRIPT ? html = `<sup>${html}</sup>` : va === (0, $7yNYd.BaselineOffset).SUBSCRIPT && (html = `<sub>${html}</sub>`), (ul == null ? void 0 : ul.s) === (0, $7yNYd.BooleanNumber).TRUE && (html = `<u>${html}</u>`), (st == null ? void 0 : st.s) === (0, $7yNYd.BooleanNumber).TRUE && (html = `<s>${html}</s>`), bl === (0, $7yNYd.BooleanNumber).TRUE && (html = `<strong>${html}</strong>`), ff && style.push(`font-family: ${ff}`), cl && style.push(`color: ${cl.rgb}`), fs && style.push(`font-size: ${fs}pt`), ol && style.push(\"text-decoration: overline\"), bg && style.push(`background: ${bg.rgb}`), style.length ? `<span style=\"${style.join(\"; \")};\">${html}</span>` : html;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$covertTextRunToHtml, \"covertTextRunToHtml\");\nfunction $bb9ae9d90429a70d$var$getBodyInlineSlice(body, startIndex, endIndex) {\n    const { dataStream: dataStream, textRuns: textRuns = [] } = body;\n    let cursorIndex = startIndex;\n    const spanList = [];\n    for (const textRun of textRuns){\n        const { st: st, ed: ed } = textRun;\n        (0, $7yNYd.Tools).hasIntersectionBetweenTwoRanges(startIndex, endIndex, st, ed) && (st > cursorIndex ? (spanList.push(dataStream.slice(cursorIndex, st)), spanList.push($bb9ae9d90429a70d$var$covertTextRunToHtml(dataStream, {\n            ...textRun,\n            ed: Math.min(ed, endIndex)\n        }))) : spanList.push($bb9ae9d90429a70d$var$covertTextRunToHtml(dataStream, {\n            ...textRun,\n            st: cursorIndex,\n            ed: Math.min(ed, endIndex)\n        }))), cursorIndex = Math.max(startIndex, Math.min(ed, endIndex));\n    }\n    return cursorIndex !== endIndex && spanList.push(dataStream.slice(cursorIndex, endIndex)), spanList.join(\"\");\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getBodyInlineSlice, \"getBodyInlineSlice\");\nfunction $bb9ae9d90429a70d$var$getBodySliceHtml(body, startIndex, endIndex) {\n    const { customRanges: customRanges = [] } = body, customRangesInRange = customRanges.filter((range)=>range.startIndex >= startIndex && range.endIndex <= endIndex);\n    let cursorIndex = startIndex, html = \"\";\n    customRangesInRange.forEach((range)=>{\n        var _a28, _b;\n        const { startIndex: startIndex2, endIndex: endIndex2, rangeType: rangeType, rangeId: rangeId } = range, preHtml = $bb9ae9d90429a70d$var$getBodyInlineSlice(body, cursorIndex, startIndex2);\n        html += preHtml;\n        const sliceHtml = $bb9ae9d90429a70d$var$getBodyInlineSlice(body, startIndex2 + 1, endIndex2);\n        switch(rangeType){\n            case (0, $7yNYd.CustomRangeType).HYPERLINK:\n                html += `<a data-rangeid=\"${rangeId}\" href=\"${(_b = (_a28 = range.properties) == null ? void 0 : _a28.url) != null ? _b : \"\"}\">${sliceHtml}</a>`;\n                break;\n            default:\n                html += sliceHtml;\n                break;\n        }\n        cursorIndex = endIndex2 + 1;\n    });\n    const endHtml = $bb9ae9d90429a70d$var$getBodyInlineSlice(body, cursorIndex, endIndex);\n    return html += endHtml, html;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getBodySliceHtml, \"getBodySliceHtml\");\nfunction $bb9ae9d90429a70d$var$convertBodyToHtml(body) {\n    const { paragraphs: paragraphs = [], sectionBreaks: sectionBreaks = [] } = body;\n    let { dataStream: dataStream } = body;\n    dataStream.endsWith(`\\r\n`) || (dataStream += `\\r\n`, paragraphs.push({\n        startIndex: dataStream.length - 2\n    }), sectionBreaks.push({\n        startIndex: dataStream.length - 1\n    }), body.dataStream = dataStream, body.paragraphs = paragraphs, body.sectionBreaks = sectionBreaks);\n    const result = {\n        html: \"\"\n    }, nodeList = (0, $3e0Iz.parseDataStreamToTree)(dataStream);\n    for (const node of nodeList)$bb9ae9d90429a70d$var$processNode(node, body, result);\n    return result.html;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$convertBodyToHtml, \"convertBodyToHtml\");\nfunction $bb9ae9d90429a70d$var$processNode(node, body, result) {\n    var _a28;\n    switch(node.nodeType){\n        case (0, $7yNYd.DataStreamTreeNodeType).SECTION_BREAK:\n            for (const n2 of node.children)$bb9ae9d90429a70d$var$processNode(n2, body, result);\n            break;\n        case (0, $7yNYd.DataStreamTreeNodeType).PARAGRAPH:\n            {\n                const { children: children, startIndex: startIndex, endIndex: endIndex } = node, paragraph = (_a28 = body.paragraphs.find((p2)=>p2.startIndex === endIndex)) != null ? _a28 : {}, { paragraphStyle: paragraphStyle = {} } = paragraph, { spaceAbove: spaceAbove, spaceBelow: spaceBelow, lineSpacing: lineSpacing } = paragraphStyle, style = [];\n                if (spaceAbove != null && (typeof spaceAbove == \"number\" ? style.push(`margin-top: ${spaceAbove}px`) : style.push(`margin-top: ${spaceAbove.v}px`)), spaceBelow != null && (typeof spaceBelow == \"number\" ? style.push(`margin-bottom: ${spaceBelow}px`) : style.push(`margin-bottom: ${spaceBelow.v}px`)), lineSpacing != null && style.push(`line-height: ${lineSpacing}`), result.html += `<p class=\"UniverNormal\" ${style.length ? `style=\"${style.join(\"; \")};\"` : \"\"}>`, children.length) for (const table of children)$bb9ae9d90429a70d$var$processNode(table, body, result);\n                result.html += `${$bb9ae9d90429a70d$var$getBodySliceHtml(body, startIndex, endIndex)}</p>`;\n                break;\n            }\n        case (0, $7yNYd.DataStreamTreeNodeType).TABLE:\n            {\n                const { children: children } = node;\n                result.html += '<table class=\"UniverTable\" style=\"width: 100%; border-collapse: collapse;\"><tbody>';\n                for (const row of children)$bb9ae9d90429a70d$var$processNode(row, body, result);\n                result.html += \"</tbody></table>\";\n                break;\n            }\n        case (0, $7yNYd.DataStreamTreeNodeType).TABLE_ROW:\n            {\n                const { children: children } = node;\n                result.html += '<tr class=\"UniverTableRow\">';\n                for (const cell of children)$bb9ae9d90429a70d$var$processNode(cell, body, result);\n                result.html += \"</tr>\";\n                break;\n            }\n        case (0, $7yNYd.DataStreamTreeNodeType).TABLE_CELL:\n            {\n                const { children: children } = node;\n                result.html += '<td class=\"UniverTableCell\">';\n                for (const n2 of children)$bb9ae9d90429a70d$var$processNode(n2, body, result);\n                result.html += \"</td>\";\n                break;\n            }\n        default:\n            throw new Error(`Unknown node type: ${node.nodeType}`);\n    }\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$processNode, \"processNode\");\nconst $bb9ae9d90429a70d$var$_UDMToHtmlService = class _UDMToHtmlService {\n    convert(bodyList) {\n        if (bodyList.length === 0) throw new Error(\"The bodyList length at least to be 1\");\n        let html = \"\";\n        for (const body of (0, $7yNYd.Tools).deepClone(bodyList))html += $bb9ae9d90429a70d$var$convertBodyToHtml(body);\n        return html;\n    }\n};\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_UDMToHtmlService, \"UDMToHtmlService\");\nlet $bb9ae9d90429a70d$var$UDMToHtmlService = $bb9ae9d90429a70d$var$_UDMToHtmlService;\nvar $bb9ae9d90429a70d$var$__defProp$p = Object.defineProperty, $bb9ae9d90429a70d$var$__getOwnPropDesc$p = Object.getOwnPropertyDescriptor, $bb9ae9d90429a70d$var$__decorateClass$p = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((decorators, target, key, kind)=>{\n    for(var result = kind > 1 ? void 0 : kind ? $bb9ae9d90429a70d$var$__getOwnPropDesc$p(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)(decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n    return kind && result && $bb9ae9d90429a70d$var$__defProp$p(target, key, result), result;\n}, \"__decorateClass$p\"), $bb9ae9d90429a70d$var$__decorateParam$p = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((index, decorator)=>(target, key)=>decorator(target, key, index), \"__decorateParam$p\");\n$bb9ae9d90429a70d$var$HtmlToUDMService.use($bb9ae9d90429a70d$export$2235e965a988e893);\n$bb9ae9d90429a70d$var$HtmlToUDMService.use($bb9ae9d90429a70d$export$42e49d92e65ef2ee);\n$bb9ae9d90429a70d$var$HtmlToUDMService.use($bb9ae9d90429a70d$export$ad5e9369ccccfa8d);\nfunction $bb9ae9d90429a70d$var$getTableSlice(body, start, end) {\n    var _a28, _b, _c;\n    const bodySlice = (0, $7yNYd.getBodySlice)(body, start, end + 2), dataStream = (0, $7yNYd.DataStreamTreeTokenType).TABLE_START + (0, $7yNYd.DataStreamTreeTokenType).TABLE_ROW_START + (0, $7yNYd.DataStreamTreeTokenType).TABLE_CELL_START + bodySlice.dataStream + (0, $7yNYd.DataStreamTreeTokenType).TABLE_CELL_END + (0, $7yNYd.DataStreamTreeTokenType).TABLE_ROW_END + (0, $7yNYd.DataStreamTreeTokenType).TABLE_END;\n    return bodySlice.dataStream = dataStream, (_a28 = bodySlice.textRuns) == null || _a28.forEach((textRun)=>{\n        const { st: st, ed: ed } = textRun;\n        textRun.st = st + 3, textRun.ed = ed + 3;\n    }), (_b = bodySlice.tables) == null || _b.forEach((table)=>{\n        const { startIndex: startIndex, endIndex: endIndex } = table;\n        table.startIndex = startIndex + 3, table.endIndex = endIndex + 3;\n    }), (_c = bodySlice.paragraphs) == null || _c.forEach((paragraph)=>{\n        const { startIndex: startIndex } = paragraph;\n        paragraph.startIndex = startIndex + 3;\n    }), bodySlice;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getTableSlice, \"getTableSlice\");\nconst $bb9ae9d90429a70d$export$6b47ccaaccf9c11f = (0, $7yNYd.createIdentifier)(\"doc.clipboard-service\");\nvar $bb9ae9d90429a70d$var$_a2;\nlet $bb9ae9d90429a70d$var$DocClipboardService = ($bb9ae9d90429a70d$var$_a2 = class extends (0, $7yNYd.Disposable) {\n    constructor(_univerInstanceService, _logService, _commandService, _clipboardInterfaceService, _docSelectionManagerService){\n        super();\n        $bb9ae9d90429a70d$var$__publicField(this, \"_clipboardHooks\", []);\n        $bb9ae9d90429a70d$var$__publicField(this, \"_htmlToUDM\", new $bb9ae9d90429a70d$var$HtmlToUDMService());\n        $bb9ae9d90429a70d$var$__publicField(this, \"_umdToHtml\", new $bb9ae9d90429a70d$var$UDMToHtmlService());\n        this._univerInstanceService = _univerInstanceService, this._logService = _logService, this._commandService = _commandService, this._clipboardInterfaceService = _clipboardInterfaceService, this._docSelectionManagerService = _docSelectionManagerService;\n    }\n    async copy(sliceType = (0, $7yNYd.SliceBodyType).copy) {\n        var _a28;\n        const { bodyList: bodyList = [], needCache: needCache = !1, snapshot: snapshot } = (_a28 = this._getDocumentBodyInRanges(sliceType)) != null ? _a28 : {};\n        if (bodyList.length === 0 || snapshot == null) return !1;\n        try {\n            const activeRange = this._docSelectionManagerService.getActiveTextRange(), isCopyInHeaderFooter = !!(activeRange != null && activeRange.segmentId);\n            this._setClipboardData(bodyList, snapshot, !isCopyInHeaderFooter && needCache);\n        } catch (e) {\n            return this._logService.error(\"[DocClipboardService] copy failed\", e), !1;\n        }\n        return !0;\n    }\n    async cut() {\n        return this._cut();\n    }\n    async paste(items) {\n        const partDocData = await this._genDocDataFromClipboardItems(items);\n        return this._paste(partDocData);\n    }\n    async legacyPaste(html, text) {\n        var _a28;\n        const partDocData = this._genDocDataFromHtmlAndText(html, text);\n        if (((_a28 = this._univerInstanceService.getCurrentUnitForType((0, $7yNYd.UniverInstanceType).UNIVER_DOC)) == null ? void 0 : _a28.getUnitId()) === (0, $7yNYd.DOCS_NORMAL_EDITOR_UNIT_ID_KEY)) {\n            if (text) {\n                const textDocData = (0, $7yNYd.BuildTextUtils).transform.fromPlainText(text);\n                return this._paste({\n                    body: textDocData\n                });\n            } else partDocData.body.textRuns = [];\n        }\n        return this._paste(partDocData);\n    }\n    async _cut() {\n        var _a28, _b, _c;\n        const { segmentId: segmentId, endOffset: activeEndOffset, style: style } = (_a28 = this._docSelectionManagerService.getActiveTextRange()) != null ? _a28 : {}, textRanges = (_b = this._docSelectionManagerService.getCurrentTextRanges()) != null ? _b : [], rectRanges = (_c = this._docSelectionManagerService.getCurrentRectRanges()) != null ? _c : [];\n        if (segmentId == null && this._logService.error(\"[DocClipboardController] segmentId is not existed\"), textRanges.length === 0 && rectRanges.length === 0) return !1;\n        this.copy((0, $7yNYd.SliceBodyType).cut);\n        try {\n            let cursor = 0;\n            if (rectRanges.length > 0) cursor = $bb9ae9d90429a70d$export$9d7b3e913f0b01bc(textRanges, rectRanges);\n            else if (activeEndOffset != null) {\n                cursor = activeEndOffset;\n                for (const range of textRanges){\n                    const { startOffset: startOffset, endOffset: endOffset } = range;\n                    startOffset == null || endOffset == null || endOffset <= activeEndOffset && (cursor -= endOffset - startOffset);\n                }\n            }\n            const newTextRanges = [\n                {\n                    startOffset: cursor,\n                    endOffset: cursor,\n                    style: style\n                }\n            ];\n            return this._commandService.executeCommand($bb9ae9d90429a70d$export$c235cac640c1f2b3.id, {\n                segmentId: segmentId,\n                textRanges: newTextRanges\n            });\n        } catch  {\n            return this._logService.error(\"[DocClipboardController] cut content failed\"), !1;\n        }\n    }\n    async _paste(docData) {\n        var _a28, _b;\n        const { body: _body } = docData;\n        if (_body == null) return !1;\n        let body = (0, $7yNYd.normalizeBody)(_body);\n        if (!((_a28 = this._univerInstanceService.getCurrentUnitForType((0, $7yNYd.UniverInstanceType).UNIVER_DOC)) == null ? void 0 : _a28.getUnitId())) return !1;\n        this._clipboardHooks.forEach((hook)=>{\n            hook.onBeforePaste && (body = hook.onBeforePaste(body));\n        }), body.customRanges = (_b = body.customRanges) == null ? void 0 : _b.map((0, $7yNYd.BuildTextUtils).customRange.copyCustomRange);\n        const activeRange = this._docSelectionManagerService.getActiveTextRange(), { segmentId: segmentId, endOffset: activeEndOffset, style: style } = activeRange || {}, ranges = this._docSelectionManagerService.getCurrentTextRanges();\n        if (segmentId == null && this._logService.error(\"[DocClipboardController] segmentId does not exist!\"), activeEndOffset == null || ranges == null) return !1;\n        try {\n            let cursor = activeEndOffset;\n            for (const range of ranges){\n                const { startOffset: startOffset, endOffset: endOffset } = range;\n                startOffset == null || endOffset == null || endOffset <= activeEndOffset && (cursor += body.dataStream.length - (endOffset - startOffset));\n            }\n            const textRanges = [\n                {\n                    startOffset: cursor,\n                    endOffset: cursor,\n                    style: style\n                }\n            ];\n            return this._commandService.executeCommand($bb9ae9d90429a70d$export$b23e7be54cecd122.id, {\n                doc: {\n                    ...docData,\n                    body: body\n                },\n                segmentId: segmentId,\n                textRanges: textRanges\n            });\n        } catch  {\n            return this._logService.error(\"[DocClipboardController]\", \"clipboard is empty.\"), !1;\n        }\n    }\n    async _setClipboardData(documentBodyList, snapshot, needCache = !0) {\n        var _a28, _b;\n        const copyId = $bb9ae9d90429a70d$var$genId(), text = (documentBodyList.length > 1 ? documentBodyList.map((body)=>body.dataStream).join(`\n`) : documentBodyList[0].dataStream).replaceAll((0, $7yNYd.DataStreamTreeTokenType).CUSTOM_RANGE_START, \"\").replaceAll((0, $7yNYd.DataStreamTreeTokenType).CUSTOM_RANGE_END, \"\");\n        let html = this._umdToHtml.convert(documentBodyList);\n        if (documentBodyList.length === 1 && needCache) {\n            html = html.replace(/(<[a-z]+)/, (_p0, p1)=>`${p1} data-copy-id=\"${copyId}\"`);\n            const body = documentBodyList[0], cache = {\n                body: body\n            };\n            if ((_a28 = body.customBlocks) != null && _a28.length) {\n                cache.drawings = {};\n                for (const block of body.customBlocks){\n                    const { blockId: blockId } = block, drawing = (_b = snapshot.drawings) == null ? void 0 : _b[blockId];\n                    if (drawing) {\n                        const id = (0, $7yNYd.Tools).generateRandomId(6);\n                        block.blockId = id, cache.drawings[id] = {\n                            ...(0, $7yNYd.Tools).deepClone(drawing),\n                            drawingId: id\n                        };\n                    }\n                }\n            }\n            $bb9ae9d90429a70d$var$copyContentCache.set(copyId, cache);\n        }\n        return this._clipboardInterfaceService.write(text, html);\n    }\n    addClipboardHook(hook) {\n        return this._clipboardHooks.push(hook), (0, $7yNYd.toDisposable)(()=>{\n            const index = this._clipboardHooks.indexOf(hook);\n            index > -1 && this._clipboardHooks.splice(index, 1);\n        });\n    }\n    _getDocumentBodyInRanges(sliceType) {\n        var _a28;\n        const docDataModel = this._univerInstanceService.getCurrentUniverDocInstance(), allRanges = this._docSelectionManagerService.getDocRanges(), results = [];\n        let needCache = !0;\n        if (docDataModel == null || allRanges.length === 0) return;\n        const segmentId = allRanges[0].segmentId, body = (_a28 = docDataModel == null ? void 0 : docDataModel.getSelfOrHeaderFooterModel(segmentId)) == null ? void 0 : _a28.getBody(), snapshot = docDataModel.getSnapshot();\n        if (body != null) {\n            for (const range of allRanges){\n                const { startOffset: startOffset, endOffset: endOffset, collapsed: collapsed, rangeType: rangeType } = range;\n                if (collapsed || startOffset == null || endOffset == null) continue;\n                if (rangeType === (0, $7yNYd.DOC_RANGE_TYPE).RECT) {\n                    needCache = !1;\n                    const { spanEntireRow: spanEntireRow } = range;\n                    let bodySlice;\n                    bodySlice = $bb9ae9d90429a70d$var$getTableSlice(body, startOffset, endOffset), results.push(bodySlice);\n                    continue;\n                }\n                const deleteRange = (0, $7yNYd.BuildTextUtils).selection.getDeleteSelection({\n                    startOffset: startOffset,\n                    endOffset: endOffset,\n                    collapsed: collapsed\n                }, body), docBody = docDataModel.getSelfOrHeaderFooterModel(segmentId).sliceBody(deleteRange.startOffset, deleteRange.endOffset, sliceType);\n                docBody != null && results.push(docBody);\n            }\n            return {\n                bodyList: results,\n                needCache: needCache,\n                snapshot: snapshot\n            };\n        }\n    }\n    async _genDocDataFromClipboardItems(items) {\n        try {\n            let html = \"\", text = \"\";\n            for (const clipboardItem of items)for (const type of clipboardItem.types)type === (0, $fL2Ug.PLAIN_TEXT_CLIPBOARD_MIME_TYPE) ? text = await clipboardItem.getType(type).then((blob)=>blob && blob.text()) : type === (0, $fL2Ug.HTML_CLIPBOARD_MIME_TYPE) && (html = await clipboardItem.getType(type).then((blob)=>blob && blob.text()));\n            return this._genDocDataFromHtmlAndText(html, text);\n        } catch (e) {\n            return Promise.reject(e);\n        }\n    }\n    _genDocDataFromHtmlAndText(html, text) {\n        if (!html) {\n            if (text) return {\n                body: (0, $7yNYd.BuildTextUtils).transform.fromPlainText(text)\n            };\n            throw new Error(\"[DocClipboardService] html and text cannot be both empty!\");\n        }\n        const copyId = $bb9ae9d90429a70d$var$extractId(html);\n        if (copyId) {\n            const copyCache = $bb9ae9d90429a70d$var$copyContentCache.get(copyId);\n            if (copyCache) return copyCache;\n        }\n        return this._htmlToUDM.convert(html);\n    }\n}, $bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_a2, \"DocClipboardService\"), $bb9ae9d90429a70d$var$_a2);\n$bb9ae9d90429a70d$var$DocClipboardService = $bb9ae9d90429a70d$var$__decorateClass$p([\n    $bb9ae9d90429a70d$var$__decorateParam$p(0, (0, $7yNYd.IUniverInstanceService)),\n    $bb9ae9d90429a70d$var$__decorateParam$p(1, (0, $7yNYd.ILogService)),\n    $bb9ae9d90429a70d$var$__decorateParam$p(2, (0, $7yNYd.ICommandService)),\n    $bb9ae9d90429a70d$var$__decorateParam$p(3, (0, $fL2Ug.IClipboardInterfaceService)),\n    $bb9ae9d90429a70d$var$__decorateParam$p(4, (0, $7yNYd.Inject)((0, $7AR1b.DocSelectionManagerService)))\n], $bb9ae9d90429a70d$var$DocClipboardService);\nfunction $bb9ae9d90429a70d$var$whenDocOrEditor(contextService) {\n    return contextService.getContextValue((0, $7yNYd.FOCUSING_DOC)) || contextService.getContextValue((0, $7yNYd.EDITOR_ACTIVATED));\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$whenDocOrEditor, \"whenDocOrEditor\");\nfunction $bb9ae9d90429a70d$var$whenFocusEditor(contextService) {\n    return contextService.getContextValue((0, $7yNYd.EDITOR_ACTIVATED));\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$whenFocusEditor, \"whenFocusEditor\");\nconst $bb9ae9d90429a70d$var$DOC_CLIPBOARD_PRIORITY = 999, $bb9ae9d90429a70d$export$9f1a20871184dbfd = {\n    id: (0, $fL2Ug.CopyCommand).id,\n    name: \"doc.command.copy\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    multi: !0,\n    priority: $bb9ae9d90429a70d$var$DOC_CLIPBOARD_PRIORITY,\n    preconditions: $bb9ae9d90429a70d$var$whenDocOrEditor,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor)=>accessor.get($bb9ae9d90429a70d$export$6b47ccaaccf9c11f).copy(), \"handler\")\n}, $bb9ae9d90429a70d$export$f23b9559f1e5cf86 = {\n    id: (0, $fL2Ug.CutCommand).id,\n    name: \"doc.command.cut\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    multi: !0,\n    priority: $bb9ae9d90429a70d$var$DOC_CLIPBOARD_PRIORITY,\n    preconditions: $bb9ae9d90429a70d$var$whenDocOrEditor,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor)=>accessor.get($bb9ae9d90429a70d$export$6b47ccaaccf9c11f).cut(), \"handler\")\n}, $bb9ae9d90429a70d$export$c2cb6d04fe50d389 = {\n    id: (0, $fL2Ug.PasteCommand).id,\n    name: \"doc.command.paste\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    multi: !0,\n    priority: $bb9ae9d90429a70d$var$DOC_CLIPBOARD_PRIORITY,\n    preconditions: $bb9ae9d90429a70d$var$whenDocOrEditor,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor)=>{\n        const docClipboardService = accessor.get($bb9ae9d90429a70d$export$6b47ccaaccf9c11f), clipboardItems = await accessor.get((0, $fL2Ug.IClipboardInterfaceService)).read();\n        return clipboardItems.length === 0 ? !1 : docClipboardService.paste(clipboardItems);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$var$_DocIMEInputManagerService = class _DocIMEInputManagerService extends (0, $7yNYd.RxDisposable) {\n    constructor(_context){\n        super();\n        $bb9ae9d90429a70d$var$__publicField(this, \"_previousActiveRange\", null);\n        $bb9ae9d90429a70d$var$__publicField(this, \"_undoMutationParamsCache\", []);\n        $bb9ae9d90429a70d$var$__publicField(this, \"_redoMutationParamsCache\", []);\n        this._context = _context;\n    }\n    clearUndoRedoMutationParamsCache() {\n        this._undoMutationParamsCache = [], this._redoMutationParamsCache = [];\n    }\n    getUndoRedoMutationParamsCache() {\n        return {\n            undoCache: this._undoMutationParamsCache,\n            redoCache: this._redoMutationParamsCache\n        };\n    }\n    setUndoRedoMutationParamsCache({ undoCache: undoCache = [], redoCache: redoCache = [] }) {\n        this._undoMutationParamsCache = undoCache, this._redoMutationParamsCache = redoCache;\n    }\n    getActiveRange() {\n        return this._previousActiveRange;\n    }\n    setActiveRange(range) {\n        this._previousActiveRange = range;\n    }\n    pushUndoRedoMutationParams(undoParams, redoParams) {\n        this._undoMutationParamsCache.push(undoParams), this._redoMutationParamsCache.push(redoParams);\n    }\n    fetchComposedUndoRedoMutationParams() {\n        if (this._undoMutationParamsCache.length === 0 || this._previousActiveRange == null || this._redoMutationParamsCache.length === 0) return null;\n        const { unitId: unitId } = this._undoMutationParamsCache[0], undoMutationParams = {\n            unitId: unitId,\n            actions: this._undoMutationParamsCache.reverse().reduce((acc, cur)=>(0, $7yNYd.JSONX).compose(acc, cur.actions), null),\n            textRanges: []\n        };\n        return {\n            redoMutationParams: {\n                unitId: unitId,\n                actions: this._redoMutationParamsCache.reduce((acc, cur)=>(0, $7yNYd.JSONX).compose(acc, cur.actions), null),\n                textRanges: []\n            },\n            undoMutationParams: undoMutationParams,\n            previousActiveRange: this._previousActiveRange\n        };\n    }\n    dispose() {\n        this._undoMutationParamsCache = [], this._redoMutationParamsCache = [], this._previousActiveRange = null;\n    }\n};\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_DocIMEInputManagerService, \"DocIMEInputManagerService\");\nlet $bb9ae9d90429a70d$export$72a0cb80dc10dcf = $bb9ae9d90429a70d$var$_DocIMEInputManagerService;\nconst $bb9ae9d90429a70d$export$e6da9cc4b65a2183 = {\n    id: \"doc.command.ime-input\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    // eslint-disable-next-line max-lines-per-function\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        var _a28;\n        const { unitId: unitId, newText: newText, oldTextLen: oldTextLen, isCompositionEnd: isCompositionEnd, isCompositionStart: isCompositionStart } = params, commandService = accessor.get((0, $7yNYd.ICommandService)), imeInputManagerService = (_a28 = accessor.get((0, $3e0Iz.IRenderManagerService)).getRenderById(unitId)) == null ? void 0 : _a28.with($bb9ae9d90429a70d$export$72a0cb80dc10dcf), docDataModel = accessor.get((0, $7yNYd.IUniverInstanceService)).getCurrentUniverDocInstance();\n        if (docDataModel == null || imeInputManagerService == null) return !1;\n        const previousActiveRange = imeInputManagerService.getActiveRange();\n        if (!previousActiveRange) return !1;\n        const { style: style, segmentId: segmentId } = previousActiveRange, body = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n        if (body == null) return !1;\n        const insertRange = (0, $7yNYd.BuildTextUtils).selection.getInsertSelection(previousActiveRange, body);\n        Object.assign(previousActiveRange, insertRange);\n        const { startOffset: startOffset } = previousActiveRange, len = newText.length, textRanges = [\n            {\n                startOffset: startOffset + len,\n                endOffset: startOffset + len,\n                collapsed: !0,\n                style: style\n            }\n        ], doMutation = {\n            id: (0, $7AR1b.RichTextEditingMutation).id,\n            params: {\n                unitId: unitId,\n                actions: [],\n                textRanges: textRanges\n            }\n        }, textX = new (0, $7yNYd.TextX)(), jsonX = (0, $7yNYd.JSONX).getInstance();\n        if (!previousActiveRange.collapsed && isCompositionStart) {\n            const { dos: dos, retain: retain, cursor: cursor } = (0, $7yNYd.BuildTextUtils).selection.getDeleteActions(previousActiveRange, segmentId, 0, body);\n            textX.push(...dos), doMutation.params.textRanges = [\n                {\n                    startOffset: startOffset + len + retain,\n                    endOffset: startOffset + len + retain,\n                    collapsed: !0\n                }\n            ];\n        } else textX.push({\n            t: (0, $7yNYd.TextXActionType).RETAIN,\n            len: startOffset,\n            segmentId: segmentId\n        });\n        oldTextLen > 0 && textX.push({\n            t: (0, $7yNYd.TextXActionType).DELETE,\n            len: oldTextLen,\n            line: 0,\n            segmentId: segmentId\n        }), textX.push({\n            t: (0, $7yNYd.TextXActionType).INSERT,\n            body: {\n                dataStream: newText\n            },\n            len: newText.length,\n            line: 0,\n            segmentId: segmentId\n        });\n        const path = $bb9ae9d90429a70d$export$abad77f79f46bb97(docDataModel, segmentId);\n        doMutation.params.actions = jsonX.editOp(textX.serialize(), path), doMutation.params.noHistory = !isCompositionEnd, doMutation.params.isCompositionEnd = isCompositionEnd;\n        const result = commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n        return imeInputManagerService.pushUndoRedoMutationParams(result, doMutation.params), !!result;\n    }, \"handler\")\n};\nfunction $bb9ae9d90429a70d$var$handleInlineFormat(preCommandId, params, commandService) {\n    return commandService.executeCommand($bb9ae9d90429a70d$export$d752bba5c1df9b30.id, {\n        preCommandId: preCommandId,\n        ...params != null ? params : {}\n    });\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$handleInlineFormat, \"handleInlineFormat\");\nconst $bb9ae9d90429a70d$var$SetInlineFormatBoldCommandId = \"doc.command.set-inline-format-bold\", $bb9ae9d90429a70d$export$2ac5c6b1b1b0feee = {\n    id: $bb9ae9d90429a70d$var$SetInlineFormatBoldCommandId,\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        const commandService = accessor.get((0, $7yNYd.ICommandService));\n        return $bb9ae9d90429a70d$var$handleInlineFormat($bb9ae9d90429a70d$var$SetInlineFormatBoldCommandId, params, commandService);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$var$SetInlineFormatItalicCommandId = \"doc.command.set-inline-format-italic\", $bb9ae9d90429a70d$export$6f96a39ba8cb4fb2 = {\n    id: $bb9ae9d90429a70d$var$SetInlineFormatItalicCommandId,\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        const commandService = accessor.get((0, $7yNYd.ICommandService));\n        return $bb9ae9d90429a70d$var$handleInlineFormat($bb9ae9d90429a70d$var$SetInlineFormatItalicCommandId, params, commandService);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$var$SetInlineFormatUnderlineCommandId = \"doc.command.set-inline-format-underline\", $bb9ae9d90429a70d$export$64d38e2980266dfc = {\n    id: $bb9ae9d90429a70d$var$SetInlineFormatUnderlineCommandId,\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        const commandService = accessor.get((0, $7yNYd.ICommandService));\n        return $bb9ae9d90429a70d$var$handleInlineFormat($bb9ae9d90429a70d$var$SetInlineFormatUnderlineCommandId, params, commandService);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$var$SetInlineFormatStrikethroughCommandId = \"doc.command.set-inline-format-strikethrough\", $bb9ae9d90429a70d$export$e70c98b3ed3cca1c = {\n    id: $bb9ae9d90429a70d$var$SetInlineFormatStrikethroughCommandId,\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        const commandService = accessor.get((0, $7yNYd.ICommandService));\n        return $bb9ae9d90429a70d$var$handleInlineFormat($bb9ae9d90429a70d$var$SetInlineFormatStrikethroughCommandId, params, commandService);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$var$SetInlineFormatSubscriptCommandId = \"doc.command.set-inline-format-subscript\", $bb9ae9d90429a70d$export$73eebc63961c6386 = {\n    id: $bb9ae9d90429a70d$var$SetInlineFormatSubscriptCommandId,\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        const commandService = accessor.get((0, $7yNYd.ICommandService));\n        return $bb9ae9d90429a70d$var$handleInlineFormat($bb9ae9d90429a70d$var$SetInlineFormatSubscriptCommandId, params, commandService);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$var$SetInlineFormatSuperscriptCommandId = \"doc.command.set-inline-format-superscript\", $bb9ae9d90429a70d$export$eced467326987bcd = {\n    id: $bb9ae9d90429a70d$var$SetInlineFormatSuperscriptCommandId,\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        const commandService = accessor.get((0, $7yNYd.ICommandService));\n        return $bb9ae9d90429a70d$var$handleInlineFormat($bb9ae9d90429a70d$var$SetInlineFormatSuperscriptCommandId, params, commandService);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$var$SetInlineFormatFontSizeCommandId = \"doc.command.set-inline-format-fontsize\", $bb9ae9d90429a70d$export$6723c87fd3465f36 = {\n    id: $bb9ae9d90429a70d$var$SetInlineFormatFontSizeCommandId,\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        const commandService = accessor.get((0, $7yNYd.ICommandService));\n        return $bb9ae9d90429a70d$var$handleInlineFormat($bb9ae9d90429a70d$var$SetInlineFormatFontSizeCommandId, params, commandService);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$var$SetInlineFormatFontFamilyCommandId = \"doc.command.set-inline-format-font-family\", $bb9ae9d90429a70d$export$b6aad3c88c8d5d81 = {\n    id: $bb9ae9d90429a70d$var$SetInlineFormatFontFamilyCommandId,\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        const commandService = accessor.get((0, $7yNYd.ICommandService));\n        return $bb9ae9d90429a70d$var$handleInlineFormat($bb9ae9d90429a70d$var$SetInlineFormatFontFamilyCommandId, params, commandService);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$var$SetInlineFormatTextColorCommandId = \"doc.command.set-inline-format-text-color\", $bb9ae9d90429a70d$export$61b23f520937a12f = {\n    id: $bb9ae9d90429a70d$var$SetInlineFormatTextColorCommandId,\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        const commandService = accessor.get((0, $7yNYd.ICommandService));\n        return $bb9ae9d90429a70d$var$handleInlineFormat($bb9ae9d90429a70d$var$SetInlineFormatTextColorCommandId, params, commandService);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$var$SetInlineFormatTextBackgroundColorCommandId = \"doc.command.set-inline-format-text-background-color\", $bb9ae9d90429a70d$export$7787f0bdf26d2ee3 = {\n    id: $bb9ae9d90429a70d$var$SetInlineFormatTextBackgroundColorCommandId,\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        const commandService = accessor.get((0, $7yNYd.ICommandService));\n        return $bb9ae9d90429a70d$var$handleInlineFormat($bb9ae9d90429a70d$var$SetInlineFormatTextBackgroundColorCommandId, params, commandService);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$var$ResetInlineFormatTextBackgroundColorCommandId = \"doc.command.reset-inline-format-text-background-color\", $bb9ae9d90429a70d$export$78c2c1a989d143a9 = {\n    id: $bb9ae9d90429a70d$var$ResetInlineFormatTextBackgroundColorCommandId,\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        const commandService = accessor.get((0, $7yNYd.ICommandService));\n        return $bb9ae9d90429a70d$var$handleInlineFormat($bb9ae9d90429a70d$var$ResetInlineFormatTextBackgroundColorCommandId, params, commandService);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$var$COMMAND_ID_TO_FORMAT_KEY_MAP = {\n    [$bb9ae9d90429a70d$export$2ac5c6b1b1b0feee.id]: \"bl\",\n    [$bb9ae9d90429a70d$export$6f96a39ba8cb4fb2.id]: \"it\",\n    [$bb9ae9d90429a70d$export$64d38e2980266dfc.id]: \"ul\",\n    [$bb9ae9d90429a70d$export$e70c98b3ed3cca1c.id]: \"st\",\n    [$bb9ae9d90429a70d$export$6723c87fd3465f36.id]: \"fs\",\n    [$bb9ae9d90429a70d$export$b6aad3c88c8d5d81.id]: \"ff\",\n    [$bb9ae9d90429a70d$export$61b23f520937a12f.id]: \"cl\",\n    [$bb9ae9d90429a70d$export$7787f0bdf26d2ee3.id]: \"bg\",\n    [$bb9ae9d90429a70d$export$78c2c1a989d143a9.id]: \"bg\",\n    [$bb9ae9d90429a70d$export$73eebc63961c6386.id]: \"va\",\n    [$bb9ae9d90429a70d$export$eced467326987bcd.id]: \"va\"\n}, $bb9ae9d90429a70d$export$d752bba5c1df9b30 = {\n    id: \"doc.command.set-inline-format\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    // eslint-disable-next-line max-lines-per-function\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        const { value: value, preCommandId: preCommandId } = params, commandService = accessor.get((0, $7yNYd.ICommandService)), docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), docRanges = docSelectionManagerService.getDocRanges();\n        if (docRanges.length === 0) return !1;\n        const segmentId = docRanges[0].segmentId, docDataModel = univerInstanceService.getCurrentUniverDocInstance();\n        if (docDataModel == null) return !1;\n        const unitId = docDataModel.getUnitId();\n        let formatValue;\n        switch(preCommandId){\n            case $bb9ae9d90429a70d$export$2ac5c6b1b1b0feee.id:\n            case $bb9ae9d90429a70d$export$6f96a39ba8cb4fb2.id:\n            case $bb9ae9d90429a70d$export$64d38e2980266dfc.id:\n            case $bb9ae9d90429a70d$export$e70c98b3ed3cca1c.id:\n            case $bb9ae9d90429a70d$export$73eebc63961c6386.id:\n            case $bb9ae9d90429a70d$export$eced467326987bcd.id:\n                formatValue = $bb9ae9d90429a70d$var$getReverseFormatValueInSelection(docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody().textRuns, preCommandId, docRanges);\n                break;\n            case $bb9ae9d90429a70d$export$6723c87fd3465f36.id:\n            case $bb9ae9d90429a70d$export$b6aad3c88c8d5d81.id:\n                formatValue = value;\n                break;\n            case $bb9ae9d90429a70d$export$61b23f520937a12f.id:\n            case $bb9ae9d90429a70d$export$7787f0bdf26d2ee3.id:\n                formatValue = {\n                    rgb: value\n                };\n                break;\n            case $bb9ae9d90429a70d$export$78c2c1a989d143a9.id:\n                formatValue = {\n                    rgb: null\n                };\n                break;\n            default:\n                throw new Error(`Unknown command: ${preCommandId} in handleInlineFormat`);\n        }\n        const doMutation = {\n            id: (0, $7AR1b.RichTextEditingMutation).id,\n            params: {\n                unitId: unitId,\n                actions: [],\n                textRanges: docRanges\n            }\n        }, textX = new (0, $7yNYd.TextX)(), jsonX = (0, $7yNYd.JSONX).getInstance(), memoryCursor = new (0, $7yNYd.MemoryCursor)();\n        memoryCursor.reset();\n        for (const range of docRanges){\n            const { startOffset: startOffset, endOffset: endOffset } = range;\n            if (startOffset == null || endOffset == null) continue;\n            const body = {\n                dataStream: \"\",\n                textRuns: [\n                    {\n                        st: 0,\n                        ed: endOffset - startOffset,\n                        ts: {\n                            [$bb9ae9d90429a70d$var$COMMAND_ID_TO_FORMAT_KEY_MAP[preCommandId]]: formatValue\n                        }\n                    }\n                ]\n            }, len = startOffset - memoryCursor.cursor;\n            len !== 0 && textX.push({\n                t: (0, $7yNYd.TextXActionType).RETAIN,\n                len: len,\n                segmentId: segmentId\n            }), textX.push({\n                t: (0, $7yNYd.TextXActionType).RETAIN,\n                body: body,\n                len: endOffset - startOffset,\n                segmentId: segmentId\n            }), memoryCursor.reset(), memoryCursor.moveCursor(endOffset);\n        }\n        const path = $bb9ae9d90429a70d$export$abad77f79f46bb97(docDataModel, segmentId);\n        return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n    }, \"handler\")\n};\nfunction $bb9ae9d90429a70d$var$isTextDecoration(value) {\n    return value !== null && typeof value == \"object\";\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$isTextDecoration, \"isTextDecoration\");\nfunction $bb9ae9d90429a70d$var$getReverseFormatValueInSelection(textRuns, preCommandId, docRanges) {\n    let ti = 0, si = 0;\n    const key = $bb9ae9d90429a70d$var$COMMAND_ID_TO_FORMAT_KEY_MAP[preCommandId];\n    for(; ti !== textRuns.length && si !== docRanges.length;){\n        const { startOffset: startOffset, endOffset: endOffset } = docRanges[si], { st: st, ed: ed, ts: ts } = textRuns[ti];\n        if (endOffset <= st) si++;\n        else if (ed <= startOffset) ti++;\n        else {\n            if (/bl|it/.test(key)) return (ts == null ? void 0 : ts[key]) === (0, $7yNYd.BooleanNumber).TRUE ? (0, $7yNYd.BooleanNumber).FALSE : (0, $7yNYd.BooleanNumber).TRUE;\n            if (/ul|st/.test(key)) return $bb9ae9d90429a70d$var$isTextDecoration(ts == null ? void 0 : ts[key]) && (ts == null ? void 0 : ts[key]).s === (0, $7yNYd.BooleanNumber).TRUE ? {\n                s: (0, $7yNYd.BooleanNumber).FALSE\n            } : {\n                s: (0, $7yNYd.BooleanNumber).TRUE\n            };\n            if (/va/.test(key)) return preCommandId === $bb9ae9d90429a70d$export$73eebc63961c6386.id ? (ts == null ? void 0 : ts[key]) === (0, $7yNYd.BaselineOffset).SUBSCRIPT ? (0, $7yNYd.BaselineOffset).NORMAL : (0, $7yNYd.BaselineOffset).SUBSCRIPT : (ts == null ? void 0 : ts[key]) === (0, $7yNYd.BaselineOffset).SUPERSCRIPT ? (0, $7yNYd.BaselineOffset).NORMAL : (0, $7yNYd.BaselineOffset).SUPERSCRIPT;\n            ti++;\n        }\n    }\n    return /bl|it/.test(key) ? (0, $7yNYd.BooleanNumber).TRUE : /ul|st/.test(key) ? {\n        s: (0, $7yNYd.BooleanNumber).TRUE\n    } : preCommandId === $bb9ae9d90429a70d$export$73eebc63961c6386.id ? (0, $7yNYd.BaselineOffset).SUBSCRIPT : (0, $7yNYd.BaselineOffset).SUPERSCRIPT;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getReverseFormatValueInSelection, \"getReverseFormatValueInSelection\");\nconst $bb9ae9d90429a70d$export$7ae277bfd4e4bfd6 = {\n    id: \"doc.command.list-operation\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    // eslint-disable-next-line max-lines-per-function, complexity\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((accessor, params)=>{\n        var _a28, _b, _c, _d, _e, _f;\n        const docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), commandService = accessor.get((0, $7yNYd.ICommandService));\n        let listType = params.listType;\n        const docDataModel = univerInstanceService.getCurrentUniverDocInstance(), docRanges = (_a28 = docSelectionManagerService.getDocRanges()) != null ? _a28 : [];\n        if (docDataModel == null || docRanges.length === 0) return !1;\n        const segmentId = docRanges[0].segmentId, paragraphs = (_b = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()) == null ? void 0 : _b.paragraphs;\n        if (paragraphs == null) return !1;\n        const sectionBreaks = (_d = (_c = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()) == null ? void 0 : _c.sectionBreaks) != null ? _d : [], currentParagraphs = $bb9ae9d90429a70d$export$a2d7677ab44ff1ca(docRanges, paragraphs), unitId = docDataModel.getUnitId(), isAlreadyList = currentParagraphs.every((paragraph)=>{\n            var _a29;\n            return ((_a29 = paragraph.bullet) == null ? void 0 : _a29.listType.indexOf(listType)) === 0;\n        });\n        let listId = (0, $7yNYd.Tools).generateRandomId(6);\n        if (currentParagraphs.length === 1) {\n            const curIndex = paragraphs.indexOf(currentParagraphs[0]), prevParagraph = paragraphs[curIndex - 1], nextParagraph = paragraphs[curIndex + 1];\n            prevParagraph && prevParagraph.bullet && prevParagraph.bullet.listType.indexOf(listType) === 0 ? (listId = prevParagraph.bullet.listId, listType !== (0, $7yNYd.PresetListType).CHECK_LIST && (listType = prevParagraph.bullet.listType)) : nextParagraph && nextParagraph.bullet && nextParagraph.bullet.listType.indexOf(listType) === 0 && (listId = nextParagraph.bullet.listId, listType !== (0, $7yNYd.PresetListType).CHECK_LIST && (listType = nextParagraph.bullet.listType));\n        }\n        const doMutation = {\n            id: (0, $7AR1b.RichTextEditingMutation).id,\n            params: {\n                unitId: unitId,\n                actions: [],\n                textRanges: docRanges\n            }\n        }, memoryCursor = new (0, $7yNYd.MemoryCursor)();\n        memoryCursor.reset();\n        const textX = new (0, $7yNYd.TextX)(), jsonX = (0, $7yNYd.JSONX).getInstance(), customLists = (_e = docDataModel.getSnapshot().lists) != null ? _e : {}, lists = {\n            ...(0, $7yNYd.PRESET_LIST_TYPE),\n            ...customLists\n        }, { defaultTabStop: defaultTabStop = 36 } = docDataModel.getSnapshot().documentStyle;\n        for (const paragraph of currentParagraphs){\n            const { startIndex: startIndex, paragraphStyle: paragraphStyle = {}, bullet: bullet } = paragraph, { indentFirstLine: indentFirstLine, snapToGrid: snapToGrid, indentStart: indentStart } = paragraphStyle, paragraphProperties = lists[listType].nestingLevel[0].paragraphProperties || {}, { hanging: listHanging, indentStart: listIndentStart } = paragraphProperties, { charSpace: charSpace, gridType: gridType } = $bb9ae9d90429a70d$var$findNearestSectionBreak(startIndex, sectionBreaks) || {\n                charSpace: 0,\n                gridType: (0, $7yNYd.GridType).LINES\n            }, charSpaceApply = (0, $3e0Iz.getCharSpaceApply)(charSpace, defaultTabStop, gridType, snapToGrid);\n            textX.push({\n                t: (0, $7yNYd.TextXActionType).RETAIN,\n                len: startIndex - memoryCursor.cursor,\n                segmentId: segmentId\n            }), textX.push({\n                t: (0, $7yNYd.TextXActionType).RETAIN,\n                len: 1,\n                body: {\n                    dataStream: \"\",\n                    paragraphs: [\n                        isAlreadyList ? {\n                            paragraphStyle: {\n                                ...paragraphStyle,\n                                hanging: void 0,\n                                indentStart: indentStart ? {\n                                    v: Math.max(0, (0, $3e0Iz.getNumberUnitValue)(indentStart, charSpaceApply) + (0, $3e0Iz.getNumberUnitValue)(listHanging, charSpaceApply) - (0, $3e0Iz.getNumberUnitValue)(listIndentStart, charSpaceApply))\n                                } : void 0\n                            },\n                            startIndex: 0\n                        } : {\n                            startIndex: 0,\n                            paragraphStyle: {\n                                ...paragraphStyle,\n                                indentFirstLine: void 0,\n                                hanging: listHanging,\n                                indentStart: {\n                                    v: (0, $3e0Iz.getNumberUnitValue)(listIndentStart, charSpaceApply) - (0, $3e0Iz.getNumberUnitValue)(listHanging, charSpaceApply) + (0, $3e0Iz.getNumberUnitValue)(indentFirstLine, charSpaceApply) + (0, $3e0Iz.getNumberUnitValue)(indentStart, charSpaceApply)\n                                }\n                            },\n                            bullet: {\n                                nestingLevel: (_f = bullet == null ? void 0 : bullet.nestingLevel) != null ? _f : 0,\n                                textStyle: {\n                                    fs: 20\n                                },\n                                listType: listType,\n                                listId: listId\n                            }\n                        }\n                    ]\n                },\n                segmentId: segmentId,\n                coverType: (0, $7yNYd.UpdateDocsAttributeType).REPLACE\n            }), memoryCursor.moveCursorTo(startIndex + 1);\n        }\n        const path = $bb9ae9d90429a70d$export$abad77f79f46bb97(docDataModel, segmentId);\n        return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$export$a2a53bf26cf288dd = {\n    id: \"doc.command.change-list-type\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    // eslint-disable-next-line max-lines-per-function\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((accessor, params)=>{\n        var _a28, _b, _c, _d, _e, _f;\n        const docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), commandService = accessor.get((0, $7yNYd.ICommandService)), { listType: listType } = params, docDataModel = univerInstanceService.getCurrentUniverDocInstance(), activeRanges = docSelectionManagerService.getDocRanges();\n        if (docDataModel == null || activeRanges == null || !activeRanges.length) return !1;\n        const { segmentId: segmentId } = activeRanges[0], selections = (_a28 = docSelectionManagerService.getDocRanges()) != null ? _a28 : [], paragraphs = (_b = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()) == null ? void 0 : _b.paragraphs;\n        if (paragraphs == null) return !1;\n        const sectionBreaks = (_d = (_c = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()) == null ? void 0 : _c.sectionBreaks) != null ? _d : [], currentParagraphs = $bb9ae9d90429a70d$var$getParagraphsRelative(activeRanges, paragraphs), unitId = docDataModel.getUnitId(), listId = (0, $7yNYd.Tools).generateRandomId(6), doMutation = {\n            id: (0, $7AR1b.RichTextEditingMutation).id,\n            params: {\n                unitId: unitId,\n                actions: [],\n                textRanges: selections\n            }\n        }, memoryCursor = new (0, $7yNYd.MemoryCursor)();\n        memoryCursor.reset();\n        const textX = new (0, $7yNYd.TextX)(), jsonX = (0, $7yNYd.JSONX).getInstance(), customLists = (_e = docDataModel.getSnapshot().lists) != null ? _e : {}, lists = {\n            ...(0, $7yNYd.PRESET_LIST_TYPE),\n            ...customLists\n        }, { defaultTabStop: defaultTabStop = 36 } = docDataModel.getSnapshot().documentStyle;\n        for (const paragraph of currentParagraphs){\n            const { startIndex: startIndex, paragraphStyle: paragraphStyle = {}, bullet: bullet } = paragraph, { indentFirstLine: indentFirstLine, snapToGrid: snapToGrid, indentStart: indentStart } = paragraphStyle, paragraphProperties = lists[listType].nestingLevel[0].paragraphProperties || {}, { hanging: listHanging, indentStart: listIndentStart } = paragraphProperties, { charSpace: charSpace, gridType: gridType } = $bb9ae9d90429a70d$var$findNearestSectionBreak(startIndex, sectionBreaks) || {\n                charSpace: 0,\n                gridType: (0, $7yNYd.GridType).LINES\n            }, charSpaceApply = (0, $3e0Iz.getCharSpaceApply)(charSpace, defaultTabStop, gridType, snapToGrid);\n            textX.push({\n                t: (0, $7yNYd.TextXActionType).RETAIN,\n                len: startIndex - memoryCursor.cursor,\n                segmentId: segmentId\n            }), textX.push({\n                t: (0, $7yNYd.TextXActionType).RETAIN,\n                len: 1,\n                body: {\n                    dataStream: \"\",\n                    paragraphs: [\n                        {\n                            startIndex: 0,\n                            paragraphStyle: {\n                                ...paragraphStyle,\n                                indentFirstLine: void 0,\n                                hanging: listHanging,\n                                indentStart: {\n                                    v: (0, $3e0Iz.getNumberUnitValue)(listIndentStart, charSpaceApply) - (0, $3e0Iz.getNumberUnitValue)(listHanging, charSpaceApply) + (0, $3e0Iz.getNumberUnitValue)(indentFirstLine, charSpaceApply) + (0, $3e0Iz.getNumberUnitValue)(indentStart, charSpaceApply)\n                                }\n                            },\n                            bullet: {\n                                nestingLevel: (_f = bullet == null ? void 0 : bullet.nestingLevel) != null ? _f : 0,\n                                textStyle: (bullet == null ? void 0 : bullet.listType) === listType ? bullet.textStyle : {\n                                    fs: 20\n                                },\n                                listType: listType,\n                                listId: listId\n                            }\n                        }\n                    ]\n                },\n                segmentId: segmentId,\n                coverType: (0, $7yNYd.UpdateDocsAttributeType).REPLACE\n            }), memoryCursor.moveCursorTo(startIndex + 1);\n        }\n        const path = $bb9ae9d90429a70d$export$abad77f79f46bb97(docDataModel, segmentId);\n        return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n    }, \"handler\")\n};\nvar $bb9ae9d90429a70d$export$dc1a06c250f0dd7 = /* @__PURE__ */ ((ChangeListNestingLevelType2)=>(ChangeListNestingLevelType2[ChangeListNestingLevelType2.increase = 1] = \"increase\", ChangeListNestingLevelType2[ChangeListNestingLevelType2.decrease = -1] = \"decrease\", ChangeListNestingLevelType2))($bb9ae9d90429a70d$export$dc1a06c250f0dd7 || {});\nconst $bb9ae9d90429a70d$export$1f6473f08b3bd4f = {\n    id: \"doc.command.change-list-nesting-level\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    // eslint-disable-next-line max-lines-per-function\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((accessor, params)=>{\n        var _a28, _b, _c, _d, _e;\n        if (!params) return !1;\n        const { type: type } = params, docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), commandService = accessor.get((0, $7yNYd.ICommandService)), docDataModel = univerInstanceService.getCurrentUniverDocInstance(), activeRange = docSelectionManagerService.getActiveTextRange();\n        if (docDataModel == null || activeRange == null) return !1;\n        const { segmentId: segmentId } = activeRange, tables = (_b = (_a28 = docDataModel.getBody()) == null ? void 0 : _a28.tables) != null ? _b : [], selections = (_c = docSelectionManagerService.getDocRanges()) != null ? _c : [], paragraphs = (_d = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()) == null ? void 0 : _d.paragraphs;\n        if (paragraphs == null) return !1;\n        const currentParagraphs = $bb9ae9d90429a70d$export$36fe13a9a4b57a90(activeRange, paragraphs), unitId = docDataModel.getUnitId(), doMutation = {\n            id: (0, $7AR1b.RichTextEditingMutation).id,\n            params: {\n                unitId: unitId,\n                actions: [],\n                textRanges: selections\n            }\n        }, memoryCursor = new (0, $7yNYd.MemoryCursor)();\n        memoryCursor.reset();\n        const textX = new (0, $7yNYd.TextX)(), jsonX = (0, $7yNYd.JSONX).getInstance(), customLists = (_e = docDataModel.getSnapshot().lists) != null ? _e : {}, lists = {\n            ...(0, $7yNYd.PRESET_LIST_TYPE),\n            ...customLists\n        };\n        for (const paragraph of currentParagraphs){\n            const { startIndex: startIndex, paragraphStyle: paragraphStyle = {}, bullet: bullet } = paragraph, isInTable = $bb9ae9d90429a70d$export$f26f7ddc67950305(paragraph, tables);\n            if (textX.push({\n                t: (0, $7yNYd.TextXActionType).RETAIN,\n                len: startIndex - memoryCursor.cursor,\n                segmentId: segmentId\n            }), bullet) {\n                const listType = bullet.listType;\n                let maxLevel = lists[listType].nestingLevel.length - 1;\n                isInTable && (maxLevel = Math.min(maxLevel, 2)), textX.push({\n                    t: (0, $7yNYd.TextXActionType).RETAIN,\n                    len: 1,\n                    body: {\n                        dataStream: \"\",\n                        paragraphs: [\n                            {\n                                startIndex: 0,\n                                paragraphStyle: {\n                                    ...paragraphStyle\n                                },\n                                bullet: {\n                                    ...bullet,\n                                    nestingLevel: Math.max(Math.min(bullet.nestingLevel + type, maxLevel), 0)\n                                }\n                            }\n                        ]\n                    },\n                    segmentId: segmentId,\n                    coverType: (0, $7yNYd.UpdateDocsAttributeType).REPLACE\n                });\n            } else textX.push({\n                t: (0, $7yNYd.TextXActionType).RETAIN,\n                len: 1\n            });\n            memoryCursor.moveCursorTo(startIndex + 1);\n        }\n        const path = $bb9ae9d90429a70d$export$abad77f79f46bb97(docDataModel, segmentId);\n        return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$export$baa537c1cdd3ac5a = {\n    id: \"doc.command.bullet-list\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((accessor, params)=>{\n        const commandService = accessor.get((0, $7yNYd.ICommandService));\n        return params != null && params.value ? commandService.syncExecuteCommand($bb9ae9d90429a70d$export$a2a53bf26cf288dd.id, {\n            listType: params.value\n        }) : commandService.syncExecuteCommand($bb9ae9d90429a70d$export$7ae277bfd4e4bfd6.id, {\n            listType: (0, $7yNYd.PresetListType).BULLET_LIST\n        });\n    }, \"handler\")\n}, $bb9ae9d90429a70d$export$dfb9f80f41464abe = {\n    id: \"doc.command.check-list\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((accessor, params)=>{\n        const commandService = accessor.get((0, $7yNYd.ICommandService));\n        return params != null && params.value ? commandService.syncExecuteCommand($bb9ae9d90429a70d$export$a2a53bf26cf288dd.id, {\n            listType: params.value\n        }) : commandService.syncExecuteCommand($bb9ae9d90429a70d$export$7ae277bfd4e4bfd6.id, {\n            listType: (0, $7yNYd.PresetListType).CHECK_LIST\n        });\n    }, \"handler\")\n}, $bb9ae9d90429a70d$export$29ccf42ee2e09c85 = {\n    id: \"doc.command.toggle-check-list\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    // eslint-disable-next-line max-lines-per-function\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((accessor, params)=>{\n        var _a28;\n        if (!params) return !1;\n        const univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), commandService = accessor.get((0, $7yNYd.ICommandService)), { index: index, segmentId: segmentId } = params, docDataModel = univerInstanceService.getCurrentUniverDocInstance();\n        if (docDataModel == null) return !1;\n        const paragraphs = (_a28 = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()) == null ? void 0 : _a28.paragraphs;\n        if (paragraphs == null) return !1;\n        const currentParagraph = paragraphs.find((p2)=>p2.startIndex === index), unitId = docDataModel.getUnitId();\n        if (!(currentParagraph != null && currentParagraph.bullet) || currentParagraph.bullet.listType.indexOf((0, $7yNYd.PresetListType).CHECK_LIST) === -1) return !1;\n        const doMutation = {\n            id: (0, $7AR1b.RichTextEditingMutation).id,\n            params: {\n                unitId: unitId,\n                actions: [],\n                textRanges: [],\n                segmentId: segmentId\n            }\n        }, memoryCursor = new (0, $7yNYd.MemoryCursor)();\n        memoryCursor.reset();\n        const textX = new (0, $7yNYd.TextX)(), jsonX = (0, $7yNYd.JSONX).getInstance(), { startIndex: startIndex, paragraphStyle: paragraphStyle = {} } = currentParagraph, listType = currentParagraph.bullet.listType === (0, $7yNYd.PresetListType).CHECK_LIST ? (0, $7yNYd.PresetListType).CHECK_LIST_CHECKED : (0, $7yNYd.PresetListType).CHECK_LIST;\n        textX.push({\n            t: (0, $7yNYd.TextXActionType).RETAIN,\n            len: startIndex - memoryCursor.cursor,\n            segmentId: segmentId\n        }), textX.push({\n            t: (0, $7yNYd.TextXActionType).RETAIN,\n            len: 1,\n            body: {\n                dataStream: \"\",\n                paragraphs: [\n                    {\n                        ...currentParagraph,\n                        paragraphStyle: paragraphStyle,\n                        startIndex: 0,\n                        bullet: {\n                            ...currentParagraph.bullet,\n                            listType: listType\n                        }\n                    }\n                ]\n            },\n            coverType: (0, $7yNYd.UpdateDocsAttributeType).REPLACE,\n            segmentId: segmentId\n        }), memoryCursor.moveCursorTo(startIndex + 1);\n        const path = $bb9ae9d90429a70d$export$abad77f79f46bb97(docDataModel, segmentId);\n        return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$export$e87051556a6af02d = {\n    id: \"doc.command.order-list\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((accessor, params)=>{\n        const commandService = accessor.get((0, $7yNYd.ICommandService));\n        return params != null && params.value ? commandService.syncExecuteCommand($bb9ae9d90429a70d$export$a2a53bf26cf288dd.id, {\n            listType: params.value\n        }) : commandService.syncExecuteCommand($bb9ae9d90429a70d$export$7ae277bfd4e4bfd6.id, {\n            listType: (0, $7yNYd.PresetListType).ORDER_LIST\n        });\n    }, \"handler\")\n}, $bb9ae9d90429a70d$export$234148d9524301cf = {\n    id: \"doc.command.quick-list\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    // eslint-disable-next-line max-lines-per-function\n    handler (accessor, params) {\n        var _a28, _b, _c, _d, _e;\n        if (!params) return !1;\n        const docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), commandService = accessor.get((0, $7yNYd.ICommandService)), docDataModel = univerInstanceService.getCurrentUniverDocInstance(), activeRange = docSelectionManagerService.getActiveTextRange();\n        if (docDataModel == null || activeRange == null) return !1;\n        const { segmentId: segmentId } = activeRange, { listType: listType, paragraph: paragraph } = params, { paragraphStart: paragraphStart, paragraphEnd: paragraphEnd } = paragraph, textX = new (0, $7yNYd.TextX)(), jsonX = (0, $7yNYd.JSONX).getInstance(), { defaultTabStop: defaultTabStop = 36 } = docDataModel.getSnapshot().documentStyle, sectionBreaks = (_b = (_a28 = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()) == null ? void 0 : _a28.sectionBreaks) != null ? _b : [], { startIndex: startIndex, paragraphStyle: paragraphStyle = {} } = paragraph, { indentFirstLine: indentFirstLine, snapToGrid: snapToGrid, indentStart: indentStart } = paragraphStyle, paragraphProperties = (0, $7yNYd.PRESET_LIST_TYPE)[listType].nestingLevel[0].paragraphProperties || {}, { hanging: listHanging, indentStart: listIndentStart } = paragraphProperties, bulletParagraphTextStyle = paragraphProperties.textStyle, { charSpace: charSpace, gridType: gridType } = $bb9ae9d90429a70d$var$findNearestSectionBreak(startIndex, sectionBreaks) || {\n            charSpace: 0,\n            gridType: (0, $7yNYd.GridType).LINES\n        }, charSpaceApply = (0, $3e0Iz.getCharSpaceApply)(charSpace, defaultTabStop, gridType, snapToGrid);\n        let listId = (0, $7yNYd.Tools).generateRandomId(6);\n        const paragraphs = (_d = (_c = docDataModel.getBody()) == null ? void 0 : _c.paragraphs) != null ? _d : [], curIndex = paragraphs.findIndex((i)=>i.startIndex === paragraph.startIndex), prevParagraph = paragraphs[curIndex - 1], nextParagraph = paragraphs[curIndex + 1];\n        prevParagraph && prevParagraph.bullet && prevParagraph.bullet.listType.indexOf(listType) === 0 ? listId = prevParagraph.bullet.listId : nextParagraph && nextParagraph.bullet && nextParagraph.bullet.listType.indexOf(listType) === 0 && (listId = nextParagraph.bullet.listId);\n        const doMutation = {\n            id: (0, $7AR1b.RichTextEditingMutation).id,\n            params: {\n                unitId: docDataModel.getUnitId(),\n                actions: [],\n                textRanges: [\n                    {\n                        startOffset: paragraphStart,\n                        endOffset: paragraphStart,\n                        collapsed: !0\n                    }\n                ]\n            }\n        };\n        textX.push({\n            t: (0, $7yNYd.TextXActionType).RETAIN,\n            len: paragraphStart\n        }), textX.push({\n            t: (0, $7yNYd.TextXActionType).DELETE,\n            len: paragraphEnd - paragraphStart,\n            line: 1\n        }), textX.push({\n            t: (0, $7yNYd.TextXActionType).RETAIN,\n            len: 1,\n            body: {\n                dataStream: \"\",\n                paragraphs: [\n                    {\n                        startIndex: 0,\n                        paragraphStyle: {\n                            ...paragraphStyle,\n                            textStyle: {\n                                ...paragraphStyle.textStyle,\n                                ...bulletParagraphTextStyle\n                            },\n                            indentFirstLine: void 0,\n                            hanging: listHanging,\n                            indentStart: {\n                                v: (0, $3e0Iz.getNumberUnitValue)(listIndentStart, charSpaceApply) - (0, $3e0Iz.getNumberUnitValue)(listHanging, charSpaceApply) + (0, $3e0Iz.getNumberUnitValue)(indentFirstLine, charSpaceApply) + (0, $3e0Iz.getNumberUnitValue)(indentStart, charSpaceApply)\n                            }\n                        },\n                        bullet: {\n                            ...(_e = paragraph.bullet) != null ? _e : {\n                                nestingLevel: 0,\n                                textStyle: {\n                                    fs: 20\n                                }\n                            },\n                            listType: listType,\n                            listId: listId\n                        }\n                    }\n                ]\n            }\n        });\n        const path = $bb9ae9d90429a70d$export$abad77f79f46bb97(docDataModel, segmentId);\n        return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n    }\n};\nfunction $bb9ae9d90429a70d$export$36fe13a9a4b57a90(activeRange, paragraphs) {\n    const { startOffset: startOffset, endOffset: endOffset } = activeRange, results = [];\n    let start = -1;\n    for (const paragraph of paragraphs){\n        const { startIndex: startIndex } = paragraph;\n        (startOffset > start && startOffset <= startIndex || endOffset > start && endOffset <= startIndex || startIndex >= startOffset && startIndex <= endOffset) && results.push(paragraph), start = startIndex;\n    }\n    return results;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$36fe13a9a4b57a90, \"getParagraphsInRange\");\nfunction $bb9ae9d90429a70d$var$getParagraphsRelative(ranges, paragraphs) {\n    const selectionParagraphs = $bb9ae9d90429a70d$export$a2d7677ab44ff1ca(ranges, paragraphs), startIndex = paragraphs.indexOf(selectionParagraphs[0]), endIndex = paragraphs.indexOf(selectionParagraphs[selectionParagraphs.length - 1]);\n    if (selectionParagraphs[0].bullet) for(let i = startIndex - 1; i >= 0; i--){\n        const prevParagraph = paragraphs[i];\n        prevParagraph.bullet && prevParagraph.bullet.listId === selectionParagraphs[0].bullet.listId && selectionParagraphs.unshift(prevParagraph);\n    }\n    const lastParagraph = selectionParagraphs[selectionParagraphs.length - 1];\n    if (lastParagraph.bullet) for(let i = endIndex + 1; i < paragraphs.length; i++){\n        const nextParagraph = paragraphs[i];\n        nextParagraph.bullet && nextParagraph.bullet.listId === lastParagraph.bullet.listId && selectionParagraphs.push(nextParagraph);\n    }\n    return selectionParagraphs;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getParagraphsRelative, \"getParagraphsRelative\");\nfunction $bb9ae9d90429a70d$export$a2d7677ab44ff1ca(ranges, paragraphs) {\n    const results = [];\n    for (const range of ranges){\n        const ps = $bb9ae9d90429a70d$export$36fe13a9a4b57a90(range, paragraphs);\n        results.push(...ps);\n    }\n    return results;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$a2d7677ab44ff1ca, \"getParagraphsInRanges\");\nfunction $bb9ae9d90429a70d$var$findNearestSectionBreak(currentIndex, sectionBreaks) {\n    const sortedSectionBreaks = sectionBreaks.sort((0, $7yNYd.sortRulesFactory)(\"startIndex\"));\n    for(let i = 0; i < sortedSectionBreaks.length; i++){\n        const sectionBreak = sectionBreaks[i];\n        if (sectionBreak.startIndex >= currentIndex) return sectionBreak;\n    }\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$findNearestSectionBreak, \"findNearestSectionBreak\");\nconst $bb9ae9d90429a70d$export$662c5ab3bad17c14 = {\n    id: \"doc.command.align-action\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    // eslint-disable-next-line max-lines-per-function\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((accessor, params)=>{\n        var _a28;\n        const docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), commandService = accessor.get((0, $7yNYd.ICommandService)), { alignType: alignType } = params, docDataModel = univerInstanceService.getCurrentUniverDocInstance();\n        if (docDataModel == null) return !1;\n        const allRanges = docSelectionManagerService.getDocRanges();\n        if (allRanges.length === 0) return !1;\n        const segmentId = allRanges[0].segmentId, paragraphs = (_a28 = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()) == null ? void 0 : _a28.paragraphs;\n        if (paragraphs == null) return !1;\n        const currentParagraphs = $bb9ae9d90429a70d$export$a2d7677ab44ff1ca(allRanges, paragraphs), unitId = docDataModel.getUnitId(), isAlreadyAligned = currentParagraphs.every((paragraph)=>{\n            var _a29;\n            return ((_a29 = paragraph.paragraphStyle) == null ? void 0 : _a29.horizontalAlign) === alignType;\n        }), doMutation = {\n            id: (0, $7AR1b.RichTextEditingMutation).id,\n            params: {\n                unitId: unitId,\n                actions: [],\n                textRanges: allRanges\n            }\n        }, memoryCursor = new (0, $7yNYd.MemoryCursor)();\n        memoryCursor.reset();\n        const textX = new (0, $7yNYd.TextX)(), jsonX = (0, $7yNYd.JSONX).getInstance();\n        for (const paragraph of currentParagraphs){\n            const { startIndex: startIndex } = paragraph;\n            textX.push({\n                t: (0, $7yNYd.TextXActionType).RETAIN,\n                len: startIndex - memoryCursor.cursor,\n                segmentId: segmentId\n            });\n            const paragraphStyle = {\n                ...paragraph.paragraphStyle,\n                horizontalAlign: isAlreadyAligned ? (0, $7yNYd.HorizontalAlign).UNSPECIFIED : alignType\n            };\n            textX.push({\n                t: (0, $7yNYd.TextXActionType).RETAIN,\n                len: 1,\n                body: {\n                    dataStream: \"\",\n                    paragraphs: [\n                        {\n                            ...paragraph,\n                            paragraphStyle: paragraphStyle,\n                            startIndex: 0\n                        }\n                    ]\n                },\n                segmentId: segmentId,\n                coverType: (0, $7yNYd.UpdateDocsAttributeType).REPLACE\n            }), memoryCursor.moveCursorTo(startIndex + 1);\n        }\n        const path = $bb9ae9d90429a70d$export$abad77f79f46bb97(docDataModel, segmentId);\n        return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$export$7a3dedab32c2d5a9 = {\n    id: \"doc.command.align-left\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((accessor)=>accessor.get((0, $7yNYd.ICommandService)).syncExecuteCommand($bb9ae9d90429a70d$export$662c5ab3bad17c14.id, {\n            alignType: (0, $7yNYd.HorizontalAlign).LEFT\n        }), \"handler\")\n}, $bb9ae9d90429a70d$export$d6d3a31584e4793b = {\n    id: \"doc.command.align-center\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((accessor)=>accessor.get((0, $7yNYd.ICommandService)).syncExecuteCommand($bb9ae9d90429a70d$export$662c5ab3bad17c14.id, {\n            alignType: (0, $7yNYd.HorizontalAlign).CENTER\n        }), \"handler\")\n}, $bb9ae9d90429a70d$export$6e9dd45d49710046 = {\n    id: \"doc.command.align-right\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((accessor)=>accessor.get((0, $7yNYd.ICommandService)).syncExecuteCommand($bb9ae9d90429a70d$export$662c5ab3bad17c14.id, {\n            alignType: (0, $7yNYd.HorizontalAlign).RIGHT\n        }), \"handler\")\n}, $bb9ae9d90429a70d$export$8812c7b8ff337c70 = {\n    id: \"doc.command.align-justify\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((accessor)=>accessor.get((0, $7yNYd.ICommandService)).syncExecuteCommand($bb9ae9d90429a70d$export$662c5ab3bad17c14.id, {\n            alignType: (0, $7yNYd.HorizontalAlign).JUSTIFIED\n        }), \"handler\")\n}, $bb9ae9d90429a70d$export$6a8c10d8a8594492 = {\n    id: \"doc.command-replace-content\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        const { unitId: unitId, body: body, textRanges: textRanges, segmentId: segmentId = \"\", options: options } = params, univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), commandService = accessor.get((0, $7yNYd.ICommandService)), docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), docDataModel = univerInstanceService.getUniverDocInstance(unitId), prevBody = docDataModel == null ? void 0 : docDataModel.getSnapshot().body, selections = docSelectionManagerService.getCurrentTextRanges();\n        if (docDataModel == null || prevBody == null || !Array.isArray(selections) || selections.length === 0) return !1;\n        const doMutation = $bb9ae9d90429a70d$var$getMutationParams(unitId, segmentId, docDataModel, prevBody, body);\n        return doMutation.params.textRanges = textRanges, options && (doMutation.params.options = options), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$export$ba4bc2e8402f82b3 = {\n    id: \"doc.command-cover-content\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        const { unitId: unitId, body: body, segmentId: segmentId = \"\" } = params, univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), commandService = accessor.get((0, $7yNYd.ICommandService)), undoRedoService = accessor.get((0, $7yNYd.IUndoRedoService)), docDatModel = univerInstanceService.getUniverDocInstance(unitId), prevBody = docDatModel == null ? void 0 : docDatModel.getSnapshot().body;\n        if (docDatModel == null || prevBody == null) return !1;\n        const doMutation = $bb9ae9d90429a70d$var$getMutationParams(unitId, segmentId, docDatModel, prevBody, body);\n        return doMutation.params.noNeedSetTextRange = !0, doMutation.params.noHistory = !0, commandService.syncExecuteCommand(doMutation.id, doMutation.params), undoRedoService.clearUndoRedo(unitId), !0;\n    }, \"handler\")\n};\nfunction $bb9ae9d90429a70d$var$getMutationParams(unitId, segmentId, docDatModel, prevBody, body) {\n    const doMutation = {\n        id: (0, $7AR1b.RichTextEditingMutation).id,\n        params: {\n            unitId: unitId,\n            actions: [],\n            textRanges: []\n        }\n    }, textX = new (0, $7yNYd.TextX)(), jsonX = (0, $7yNYd.JSONX).getInstance(), deleteLen = (prevBody == null ? void 0 : prevBody.dataStream.length) - 2;\n    deleteLen > 0 && textX.push({\n        t: (0, $7yNYd.TextXActionType).DELETE,\n        len: deleteLen,\n        line: 0,\n        segmentId: segmentId\n    }), body.dataStream.length > 0 && textX.push({\n        t: (0, $7yNYd.TextXActionType).INSERT,\n        body: body,\n        len: body.dataStream.length,\n        line: 0,\n        segmentId: segmentId\n    });\n    const path = $bb9ae9d90429a70d$export$abad77f79f46bb97(docDatModel, segmentId);\n    return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), doMutation;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getMutationParams, \"getMutationParams\");\n(0, $7yNYd.CommandType).COMMAND;\nconst $bb9ae9d90429a70d$var$SetDocZoomRatioUndoMutationFactory = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((accessor, params)=>{\n    const documentModel = accessor.get((0, $7yNYd.IUniverInstanceService)).getUniverDocInstance(params.unitId), old = (documentModel == null ? void 0 : documentModel.zoomRatio) || 1;\n    return {\n        ...(0, $7yNYd.Tools).deepClone(params),\n        zoomRatio: old\n    };\n}, \"SetDocZoomRatioUndoMutationFactory\"), $bb9ae9d90429a70d$export$324478118aea2b96 = {\n    id: \"doc.operation.set-zoom-ratio\",\n    type: (0, $7yNYd.CommandType).OPERATION,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((accessor, params)=>{\n        const documentModel = accessor.get((0, $7yNYd.IUniverInstanceService)).getUniverDocInstance(params.unitId);\n        if (!documentModel) return !1;\n        const documentData = documentModel.getSnapshot();\n        return documentData.settings == null ? documentData.settings = {\n            zoomRatio: params.zoomRatio\n        } : documentData.settings.zoomRatio = params.zoomRatio, !0;\n    }, \"handler\")\n}, $bb9ae9d90429a70d$export$fdc76f9b34e96863 = {\n    type: (0, $7yNYd.CommandType).COMMAND,\n    id: \"doc.command.set-zoom-ratio\",\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        var _a28, _b, _c;\n        const commandService = accessor.get((0, $7yNYd.ICommandService)), undoRedoService = accessor.get((0, $7yNYd.IUndoRedoService)), univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService));\n        let documentId = (_a28 = univerInstanceService.getCurrentUniverDocInstance()) == null ? void 0 : _a28.getUnitId();\n        if (!documentId) return !1;\n        let zoomRatio = 1;\n        if (params && (documentId = (_b = params.documentId) != null ? _b : documentId, zoomRatio = (_c = params.zoomRatio) != null ? _c : zoomRatio), !univerInstanceService.getUniverDocInstance(documentId)) return !1;\n        const setZoomRatioMutationParams = {\n            zoomRatio: zoomRatio,\n            unitId: documentId\n        }, undoMutationParams = $bb9ae9d90429a70d$var$SetDocZoomRatioUndoMutationFactory(accessor, setZoomRatioMutationParams);\n        return commandService.syncExecuteCommand($bb9ae9d90429a70d$export$324478118aea2b96.id, setZoomRatioMutationParams) ? (undoRedoService.pushUndoRedo({\n            unitID: documentId,\n            undoMutations: [\n                {\n                    id: $bb9ae9d90429a70d$export$324478118aea2b96.id,\n                    params: undoMutationParams\n                }\n            ],\n            redoMutations: [\n                {\n                    id: $bb9ae9d90429a70d$export$324478118aea2b96.id,\n                    params: setZoomRatioMutationParams\n                }\n            ]\n        }), !0) : !1;\n    }, \"handler\")\n}, $bb9ae9d90429a70d$var$CreateDocTableCommandId = \"doc.command.create-table\", $bb9ae9d90429a70d$export$4e832bb83534614c = {\n    id: $bb9ae9d90429a70d$var$CreateDocTableCommandId,\n    type: (0, $7yNYd.CommandType).COMMAND,\n    // eslint-disable-next-line max-lines-per-function, complexity\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        var _a28, _b, _c, _d, _e, _f;\n        const { rowCount: rowCount, colCount: colCount } = params, docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), commandService = accessor.get((0, $7yNYd.ICommandService)), activeRange = docSelectionManagerService.getActiveTextRange();\n        if (activeRange == null) return !1;\n        const { segmentId: segmentId, segmentPage: segmentPage } = activeRange, docDataModel = univerInstanceService.getCurrentUniverDocInstance(), body = docDataModel == null ? void 0 : docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n        if (docDataModel == null || body == null) return !1;\n        const unitId = docDataModel.getUnitId(), docSkeletonManagerService = $bb9ae9d90429a70d$export$aca1be174465426e(accessor, unitId), skeleton = docSkeletonManagerService == null ? void 0 : docSkeletonManagerService.getSkeleton();\n        if (skeleton == null) return !1;\n        const { startOffset: startOffset } = (0, $7yNYd.BuildTextUtils).selection.getInsertSelection(activeRange, body), prevParagraph = ((_a28 = body.paragraphs) != null ? _a28 : []).find((p2)=>p2.startIndex >= startOffset), curGlyph = skeleton.findNodeByCharIndex(startOffset, segmentId, segmentPage), line = (_b = curGlyph == null ? void 0 : curGlyph.parent) == null ? void 0 : _b.parent, preGlyph = skeleton.findNodeByCharIndex(startOffset - 1, segmentId, segmentPage), isInParagraph = preGlyph && preGlyph.content !== \"\\r\";\n        if (curGlyph == null || line == null) return !1;\n        const needCreateParagraph = isInParagraph || line.isBehindTable, textX = new (0, $7yNYd.TextX)(), jsonX = (0, $7yNYd.JSONX).getInstance(), rawActions = [], cursor = startOffset + (needCreateParagraph ? 4 : 3), textRanges = [\n            {\n                startOffset: cursor,\n                endOffset: cursor,\n                collapsed: !0\n            }\n        ], doMutation = {\n            id: (0, $7AR1b.RichTextEditingMutation).id,\n            params: {\n                unitId: unitId,\n                actions: [],\n                textRanges: textRanges\n            }\n        };\n        startOffset > 0 && textX.push({\n            t: (0, $7yNYd.TextXActionType).RETAIN,\n            len: startOffset,\n            segmentId: segmentId\n        }), needCreateParagraph && textX.push({\n            t: (0, $7yNYd.TextXActionType).INSERT,\n            body: {\n                dataStream: (0, $7yNYd.DataStreamTreeTokenType).PARAGRAPH,\n                paragraphs: $bb9ae9d90429a70d$export$d16c599b5109b812((0, $7yNYd.DataStreamTreeTokenType).PARAGRAPH, prevParagraph)\n            },\n            len: 1,\n            line: 0,\n            segmentId: segmentId\n        });\n        const { dataStream: tableDataStream, paragraphs: tableParagraphs, sectionBreaks: sectionBreaks } = $bb9ae9d90429a70d$var$genEmptyTable(rowCount, colCount), page = (_f = (_e = (_d = (_c = curGlyph.parent) == null ? void 0 : _c.parent) == null ? void 0 : _d.parent) == null ? void 0 : _e.parent) == null ? void 0 : _f.parent;\n        if (page == null) return !1;\n        const { pageWidth: pageWidth, marginLeft: marginLeft, marginRight: marginRight } = page, tableSource = $bb9ae9d90429a70d$export$438ea56a96e58332(rowCount, colCount, pageWidth - marginLeft - marginRight);\n        textX.push({\n            t: (0, $7yNYd.TextXActionType).INSERT,\n            body: {\n                dataStream: tableDataStream,\n                paragraphs: tableParagraphs,\n                sectionBreaks: sectionBreaks,\n                tables: [\n                    {\n                        startIndex: 0,\n                        endIndex: tableDataStream.length,\n                        tableId: tableSource.tableId\n                    }\n                ]\n            },\n            len: tableDataStream.length,\n            line: 0,\n            segmentId: segmentId\n        });\n        const path = $bb9ae9d90429a70d$export$abad77f79f46bb97(docDataModel, segmentId);\n        rawActions.push(jsonX.editOp(textX.serialize(), path));\n        const insertTableSource = jsonX.insertOp([\n            \"tableSource\",\n            tableSource.tableId\n        ], tableSource);\n        return rawActions.push(insertTableSource), doMutation.params.actions = rawActions.reduce((acc, cur)=>(0, $7yNYd.JSONX).compose(acc, cur), null), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$export$a24cf2b8bfb8aa0d = {\n    id: \"doc.table.delete-rows\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    // eslint-disable-next-line max-lines-per-function\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor)=>{\n        const docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), commandService = accessor.get((0, $7yNYd.ICommandService)), activeRectRanges = docSelectionManagerService.getCurrentRectRanges(), activeTextRange = docSelectionManagerService.getActiveTextRange(), rangeInfo = $bb9ae9d90429a70d$var$getRangeInfoFromRanges(activeTextRange, activeRectRanges);\n        if (rangeInfo == null) return !1;\n        const { segmentId: segmentId } = rangeInfo, docDataModel = univerInstanceService.getCurrentUniverDocInstance(), body = docDataModel == null ? void 0 : docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n        if (docDataModel == null || body == null) return !1;\n        const docSkeletonManagerService = $bb9ae9d90429a70d$export$aca1be174465426e(accessor, docDataModel.getUnitId());\n        if (docSkeletonManagerService == null) return !1;\n        const viewModel = docSkeletonManagerService.getViewModel(), unitId = docDataModel == null ? void 0 : docDataModel.getUnitId(), textX = new (0, $7yNYd.TextX)(), jsonX = (0, $7yNYd.JSONX).getInstance(), actionParams = $bb9ae9d90429a70d$var$getDeleteRowsActionsParams(rangeInfo, viewModel);\n        if (actionParams == null) return !1;\n        const { offset: offset, rowIndexes: rowIndexes, len: len, tableId: tableId, cursor: cursor, selectWholeTable: selectWholeTable } = actionParams;\n        if (selectWholeTable) return commandService.executeCommand($bb9ae9d90429a70d$export$ec800041f6d17822.id);\n        const rawActions = [], textRanges = [\n            {\n                startOffset: cursor,\n                endOffset: cursor,\n                collapsed: !0\n            }\n        ], doMutation = {\n            id: (0, $7AR1b.RichTextEditingMutation).id,\n            params: {\n                unitId: unitId,\n                actions: [],\n                textRanges: textRanges\n            }\n        };\n        offset > 0 && textX.push({\n            t: (0, $7yNYd.TextXActionType).RETAIN,\n            len: offset,\n            segmentId: segmentId\n        }), textX.push({\n            t: (0, $7yNYd.TextXActionType).DELETE,\n            len: len,\n            line: 0,\n            segmentId: segmentId\n        });\n        const path = $bb9ae9d90429a70d$export$abad77f79f46bb97(docDataModel, segmentId);\n        rawActions.push(jsonX.editOp(textX.serialize(), path));\n        for (const index of rowIndexes.reverse()){\n            const action = jsonX.removeOp([\n                \"tableSource\",\n                tableId,\n                \"tableRows\",\n                index\n            ]);\n            rawActions.push(action);\n        }\n        return doMutation.params.actions = rawActions.reduce((acc, cur)=>(0, $7yNYd.JSONX).compose(acc, cur), null), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$export$9460cec99108a171 = {\n    id: \"doc.table.delete-columns\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    // eslint-disable-next-line max-lines-per-function\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor)=>{\n        const docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), commandService = accessor.get((0, $7yNYd.ICommandService)), activeRectRanges = docSelectionManagerService.getCurrentRectRanges(), activeTextRange = docSelectionManagerService.getActiveTextRange(), rangeInfo = $bb9ae9d90429a70d$var$getRangeInfoFromRanges(activeTextRange, activeRectRanges);\n        if (rangeInfo == null) return !1;\n        const { segmentId: segmentId } = rangeInfo, docDataModel = univerInstanceService.getCurrentUniverDocInstance(), body = docDataModel == null ? void 0 : docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n        if (docDataModel == null || body == null) return !1;\n        const docSkeletonManagerService = $bb9ae9d90429a70d$export$aca1be174465426e(accessor, docDataModel.getUnitId());\n        if (docSkeletonManagerService == null) return !1;\n        const viewModel = docSkeletonManagerService.getViewModel(), unitId = docDataModel == null ? void 0 : docDataModel.getUnitId(), textX = new (0, $7yNYd.TextX)(), jsonX = (0, $7yNYd.JSONX).getInstance(), actionParams = $bb9ae9d90429a70d$var$getDeleteColumnsActionParams(rangeInfo, viewModel);\n        if (actionParams == null) return !1;\n        const { offsets: offsets, columnIndexes: columnIndexes, tableId: tableId, cursor: cursor, rowCount: rowCount, selectWholeTable: selectWholeTable } = actionParams;\n        if (selectWholeTable) return commandService.executeCommand($bb9ae9d90429a70d$export$ec800041f6d17822.id);\n        const rawActions = [], textRanges = [\n            {\n                startOffset: cursor,\n                endOffset: cursor,\n                collapsed: !0\n            }\n        ], doMutation = {\n            id: (0, $7AR1b.RichTextEditingMutation).id,\n            params: {\n                unitId: unitId,\n                actions: [],\n                textRanges: textRanges\n            }\n        };\n        for (const offset of offsets){\n            const { retain: retain, delete: deleteLen } = offset;\n            retain > 0 && textX.push({\n                t: (0, $7yNYd.TextXActionType).RETAIN,\n                len: retain,\n                segmentId: segmentId\n            }), textX.push({\n                t: (0, $7yNYd.TextXActionType).DELETE,\n                len: deleteLen,\n                line: 0,\n                segmentId: segmentId\n            });\n        }\n        const path = $bb9ae9d90429a70d$export$abad77f79f46bb97(docDataModel, segmentId);\n        rawActions.push(jsonX.editOp(textX.serialize(), path)), columnIndexes.reverse();\n        for(let i = 0; i < rowCount; i++)for (const index of columnIndexes){\n            const action = jsonX.removeOp([\n                \"tableSource\",\n                tableId,\n                \"tableRows\",\n                i,\n                \"tableCells\",\n                index\n            ]);\n            rawActions.push(action);\n        }\n        for (const index of columnIndexes){\n            const action = jsonX.removeOp([\n                \"tableSource\",\n                tableId,\n                \"tableColumns\",\n                index\n            ]);\n            rawActions.push(action);\n        }\n        return doMutation.params.actions = rawActions.reduce((acc, cur)=>(0, $7yNYd.JSONX).compose(acc, cur), null), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$export$ec800041f6d17822 = {\n    id: \"doc.table.delete-table\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    // eslint-disable-next-line max-lines-per-function\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor)=>{\n        const docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), commandService = accessor.get((0, $7yNYd.ICommandService)), activeRectRanges = docSelectionManagerService.getCurrentRectRanges(), activeTextRange = docSelectionManagerService.getActiveTextRange(), rangeInfo = $bb9ae9d90429a70d$var$getRangeInfoFromRanges(activeTextRange, activeRectRanges);\n        if (rangeInfo == null) return !1;\n        const { segmentId: segmentId } = rangeInfo, docDataModel = univerInstanceService.getCurrentUniverDocInstance(), body = docDataModel == null ? void 0 : docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n        if (docDataModel == null || body == null) return !1;\n        const docSkeletonManagerService = $bb9ae9d90429a70d$export$aca1be174465426e(accessor, docDataModel.getUnitId());\n        if (docSkeletonManagerService == null) return !1;\n        const viewModel = docSkeletonManagerService.getViewModel(), unitId = docDataModel == null ? void 0 : docDataModel.getUnitId(), textX = new (0, $7yNYd.TextX)(), jsonX = (0, $7yNYd.JSONX).getInstance(), actionParams = $bb9ae9d90429a70d$var$getDeleteTableActionParams(rangeInfo, viewModel);\n        if (actionParams == null) return !1;\n        const { offset: offset, len: len, tableId: tableId, cursor: cursor } = actionParams, rawActions = [], textRanges = [\n            {\n                startOffset: cursor,\n                endOffset: cursor,\n                collapsed: !0\n            }\n        ], doMutation = {\n            id: (0, $7AR1b.RichTextEditingMutation).id,\n            params: {\n                unitId: unitId,\n                actions: [],\n                textRanges: textRanges\n            }\n        };\n        offset > 0 && textX.push({\n            t: (0, $7yNYd.TextXActionType).RETAIN,\n            len: offset,\n            segmentId: segmentId\n        }), textX.push({\n            t: (0, $7yNYd.TextXActionType).DELETE,\n            len: len,\n            line: 0,\n            segmentId: segmentId\n        });\n        const path = $bb9ae9d90429a70d$export$abad77f79f46bb97(docDataModel, segmentId);\n        rawActions.push(jsonX.editOp(textX.serialize(), path));\n        const action = jsonX.removeOp([\n            \"tableSource\",\n            tableId\n        ]);\n        return rawActions.push(action), doMutation.params.actions = rawActions.reduce((acc, cur)=>(0, $7yNYd.JSONX).compose(acc, cur), null), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$var$DocTableInsertRowCommandId = \"doc.command.table-insert-row\", $bb9ae9d90429a70d$var$DocTableInsertColumnCommandId = \"doc.command.table-insert-column\", $bb9ae9d90429a70d$var$DocTableInsertRowAboveCommandId = \"doc.command.table-insert-row-above\", $bb9ae9d90429a70d$var$DocTableInsertRowBellowCommandId = \"doc.command.table-insert-row-bellow\", $bb9ae9d90429a70d$var$DocTableInsertColumnLeftCommandId = \"doc.command.table-insert-column-left\", $bb9ae9d90429a70d$var$DocTableInsertColumnRightCommandId = \"doc.command.table-insert-column-right\", $bb9ae9d90429a70d$export$d24aed1c729ddbeb = {\n    id: $bb9ae9d90429a70d$var$DocTableInsertRowAboveCommandId,\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor)=>accessor.get((0, $7yNYd.ICommandService)).executeCommand($bb9ae9d90429a70d$var$DocTableInsertRowCommandId, {\n            position: $bb9ae9d90429a70d$var$INSERT_ROW_POSITION.ABOVE\n        }), \"handler\")\n}, $bb9ae9d90429a70d$export$5c48014be93c9100 = {\n    id: $bb9ae9d90429a70d$var$DocTableInsertRowBellowCommandId,\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor)=>accessor.get((0, $7yNYd.ICommandService)).executeCommand($bb9ae9d90429a70d$var$DocTableInsertRowCommandId, {\n            position: $bb9ae9d90429a70d$var$INSERT_ROW_POSITION.BELLOW\n        }), \"handler\")\n}, $bb9ae9d90429a70d$export$e0b51bcab3a3cf9c = {\n    id: $bb9ae9d90429a70d$var$DocTableInsertColumnLeftCommandId,\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor)=>accessor.get((0, $7yNYd.ICommandService)).executeCommand($bb9ae9d90429a70d$var$DocTableInsertColumnCommandId, {\n            position: $bb9ae9d90429a70d$var$INSERT_COLUMN_POSITION.LEFT\n        }), \"handler\")\n}, $bb9ae9d90429a70d$export$f1900f4bfa5f38e0 = {\n    id: $bb9ae9d90429a70d$var$DocTableInsertColumnRightCommandId,\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor)=>accessor.get((0, $7yNYd.ICommandService)).executeCommand($bb9ae9d90429a70d$var$DocTableInsertColumnCommandId, {\n            position: $bb9ae9d90429a70d$var$INSERT_COLUMN_POSITION.RIGHT\n        }), \"handler\")\n}, $bb9ae9d90429a70d$export$c84c1b77b54bc20c = {\n    id: $bb9ae9d90429a70d$var$DocTableInsertRowCommandId,\n    type: (0, $7yNYd.CommandType).COMMAND,\n    // eslint-disable-next-line max-lines-per-function\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        const { position: position } = params, docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), commandService = accessor.get((0, $7yNYd.ICommandService)), activeRectRanges = docSelectionManagerService.getCurrentRectRanges(), activeTextRange = docSelectionManagerService.getActiveTextRange(), rangeInfo = $bb9ae9d90429a70d$var$getRangeInfoFromRanges(activeTextRange, activeRectRanges);\n        if (rangeInfo == null) return !1;\n        const { segmentId: segmentId } = rangeInfo, docDataModel = univerInstanceService.getCurrentUniverDocInstance(), body = docDataModel == null ? void 0 : docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n        if (docDataModel == null || body == null) return !1;\n        const docSkeletonManagerService = $bb9ae9d90429a70d$export$aca1be174465426e(accessor, docDataModel.getUnitId());\n        if (docSkeletonManagerService == null) return !1;\n        const viewModel = docSkeletonManagerService.getViewModel(), unitId = docDataModel == null ? void 0 : docDataModel.getUnitId(), textX = new (0, $7yNYd.TextX)(), jsonX = (0, $7yNYd.JSONX).getInstance(), actionParams = $bb9ae9d90429a70d$var$getInsertRowActionsParams(rangeInfo, position, viewModel);\n        if (actionParams == null) return !1;\n        const { offset: offset, colCount: colCount, tableId: tableId, insertRowIndex: insertRowIndex } = actionParams, rawActions = [], cursor = offset + 2, textRanges = [\n            {\n                startOffset: cursor,\n                endOffset: cursor,\n                collapsed: !0\n            }\n        ], doMutation = {\n            id: (0, $7AR1b.RichTextEditingMutation).id,\n            params: {\n                unitId: unitId,\n                actions: [],\n                textRanges: textRanges\n            }\n        };\n        offset > 0 && textX.push({\n            t: (0, $7yNYd.TextXActionType).RETAIN,\n            len: offset,\n            segmentId: segmentId\n        });\n        const insertBody = $bb9ae9d90429a70d$var$getInsertRowBody(colCount);\n        textX.push({\n            t: (0, $7yNYd.TextXActionType).INSERT,\n            body: insertBody,\n            len: insertBody.dataStream.length,\n            line: 0,\n            segmentId: segmentId\n        });\n        const path = $bb9ae9d90429a70d$export$abad77f79f46bb97(docDataModel, segmentId);\n        rawActions.push(jsonX.editOp(textX.serialize(), path));\n        const insertRow = $bb9ae9d90429a70d$export$ff17ef97bed31451(colCount), insertTableSource = jsonX.insertOp([\n            \"tableSource\",\n            tableId,\n            \"tableRows\",\n            insertRowIndex\n        ], insertRow);\n        return rawActions.push(insertTableSource), doMutation.params.actions = rawActions.reduce((acc, cur)=>(0, $7yNYd.JSONX).compose(acc, cur), null), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$export$59ad16502cefbbfe = {\n    id: $bb9ae9d90429a70d$var$DocTableInsertColumnCommandId,\n    type: (0, $7yNYd.CommandType).COMMAND,\n    // eslint-disable-next-line max-lines-per-function\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        var _a28, _b, _c;\n        const { position: position } = params, docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), commandService = accessor.get((0, $7yNYd.ICommandService)), activeRectRanges = docSelectionManagerService.getCurrentRectRanges(), activeTextRange = docSelectionManagerService.getActiveTextRange(), rangeInfo = $bb9ae9d90429a70d$var$getRangeInfoFromRanges(activeTextRange, activeRectRanges);\n        if (rangeInfo == null) return !1;\n        const { segmentId: segmentId } = rangeInfo, docDataModel = univerInstanceService.getCurrentUniverDocInstance(), body = docDataModel == null ? void 0 : docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n        if (docDataModel == null || body == null) return !1;\n        const docSkeletonManagerService = $bb9ae9d90429a70d$export$aca1be174465426e(accessor, docDataModel.getUnitId());\n        if (docSkeletonManagerService == null) return !1;\n        const viewModel = docSkeletonManagerService.getViewModel(), unitId = docDataModel == null ? void 0 : docDataModel.getUnitId(), textX = new (0, $7yNYd.TextX)(), jsonX = (0, $7yNYd.JSONX).getInstance(), actionParams = $bb9ae9d90429a70d$var$getInsertColumnActionsParams(rangeInfo, position, viewModel);\n        if (actionParams == null) return !1;\n        const { offsets: offsets, columnIndex: columnIndex, tableId: tableId, rowCount: rowCount } = actionParams, rawActions = [], cursor = offsets[0] + 1, textRanges = [\n            {\n                startOffset: cursor,\n                endOffset: cursor,\n                collapsed: !0\n            }\n        ], doMutation = {\n            id: (0, $7AR1b.RichTextEditingMutation).id,\n            params: {\n                unitId: unitId,\n                actions: [],\n                textRanges: textRanges\n            }\n        };\n        for (const offset of offsets){\n            textX.push({\n                t: (0, $7yNYd.TextXActionType).RETAIN,\n                len: offset,\n                segmentId: segmentId\n            });\n            const insertBody = $bb9ae9d90429a70d$var$getInsertColumnBody();\n            textX.push({\n                t: (0, $7yNYd.TextXActionType).INSERT,\n                body: insertBody,\n                len: insertBody.dataStream.length,\n                line: 0,\n                segmentId: segmentId\n            });\n        }\n        const path = $bb9ae9d90429a70d$export$abad77f79f46bb97(docDataModel, segmentId);\n        rawActions.push(jsonX.editOp(textX.serialize(), path));\n        for(let i = 0; i < rowCount; i++){\n            const insertCell = $bb9ae9d90429a70d$export$ba2e502f47d52b71(), insertTableSource = jsonX.insertOp([\n                \"tableSource\",\n                tableId,\n                \"tableRows\",\n                i,\n                \"tableCells\",\n                columnIndex\n            ], insertCell);\n            rawActions.push(insertTableSource);\n        }\n        const snapshot = docDataModel.getSnapshot(), documentStyle = snapshot.documentStyle, { marginLeft: marginLeft = 0, marginRight: marginRight = 0 } = documentStyle, pageWidth = ((_b = (_a28 = documentStyle.pageSize) == null ? void 0 : _a28.width) != null ? _b : 800) - marginLeft - marginRight, tableColumns = (_c = snapshot == null ? void 0 : snapshot.tableSource) == null ? void 0 : _c[tableId].tableColumns, { newColWidth: newColWidth, widths: widths } = $bb9ae9d90429a70d$var$getColumnWidths(pageWidth, tableColumns, columnIndex);\n        for(let i = 0; i < widths.length; i++){\n            const action = jsonX.replaceOp([\n                \"tableSource\",\n                tableId,\n                \"tableColumns\",\n                i,\n                \"size\",\n                \"width\",\n                \"v\"\n            ], tableColumns[i].size.width.v, widths[i]);\n            rawActions.push(action);\n        }\n        const insertCol = $bb9ae9d90429a70d$export$4959bf4a22b5891f(newColWidth), insertTableColumn = jsonX.insertOp([\n            \"tableSource\",\n            tableId,\n            \"tableColumns\",\n            columnIndex\n        ], insertCol);\n        return rawActions.push(insertTableColumn), doMutation.params.actions = rawActions.reduce((acc, cur)=>(0, $7yNYd.JSONX).compose(acc, cur), null), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$export$d60059992825479d = {\n    id: \"doc.table.tab-in-table\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        const { shift: shift } = params, textSelectionManager = accessor.get((0, $7AR1b.DocSelectionManagerService)), activeTextRange = textSelectionManager.getActiveTextRange(), commandService = accessor.get((0, $7yNYd.ICommandService)), docDataModel = accessor.get((0, $7yNYd.IUniverInstanceService)).getCurrentUniverDocInstance();\n        if (!docDataModel) return !1;\n        const unitId = docDataModel.getUnitId(), docSkeletonManagerService = $bb9ae9d90429a70d$export$aca1be174465426e(accessor, unitId), skeleton = docSkeletonManagerService == null ? void 0 : docSkeletonManagerService.getSkeleton(), viewModel = skeleton == null ? void 0 : skeleton.getViewModel().getSelfOrHeaderFooterViewModel(activeTextRange == null ? void 0 : activeTextRange.segmentId);\n        if (viewModel == null || activeTextRange == null) return !1;\n        let offsets = null;\n        if (shift ? offsets = $bb9ae9d90429a70d$var$getCellOffsets(viewModel, activeTextRange, $bb9ae9d90429a70d$var$CellPosition.PREV) : offsets = $bb9ae9d90429a70d$var$getCellOffsets(viewModel, activeTextRange, $bb9ae9d90429a70d$var$CellPosition.NEXT), offsets) {\n            const { startOffset: startOffset, endOffset: endOffset } = offsets, textRanges = [\n                {\n                    startOffset: startOffset,\n                    endOffset: endOffset\n                }\n            ];\n            return textSelectionManager.replaceTextRanges(textRanges), !0;\n        }\n        return shift === !1 ? await commandService.executeCommand($bb9ae9d90429a70d$export$c84c1b77b54bc20c.id, {\n            position: $bb9ae9d90429a70d$var$INSERT_ROW_POSITION.BELLOW\n        }) : !0;\n    }, \"handler\")\n}, $bb9ae9d90429a70d$var$COMPONENT_DOC_CREATE_TABLE_CONFIRM = \"COMPONENT_DOC_CREATE_TABLE_CONFIRM\", $bb9ae9d90429a70d$var$COMPONENT_DOC_CREATE_TABLE_CONFIRM_ID = \"doc.component.create-table-confirm\", $bb9ae9d90429a70d$export$1e0acf08c78e9a29 = {\n    id: \"doc.operation.create-table\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor)=>{\n        const localeService = accessor.get((0, $7yNYd.LocaleService)), confirmService = accessor.get((0, $fL2Ug.IConfirmService)), commandService = accessor.get((0, $7yNYd.ICommandService)), tableCreateParams = {\n            rowCount: 3,\n            colCount: 5\n        }, handleRowColChange = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((rowCount, colCount)=>{\n            tableCreateParams.rowCount = rowCount, tableCreateParams.colCount = colCount;\n        }, \"handleRowColChange\");\n        return await confirmService.open({\n            id: $bb9ae9d90429a70d$var$COMPONENT_DOC_CREATE_TABLE_CONFIRM_ID,\n            children: {\n                label: {\n                    name: $bb9ae9d90429a70d$var$COMPONENT_DOC_CREATE_TABLE_CONFIRM,\n                    props: {\n                        handleRowColChange: handleRowColChange,\n                        tableCreateParams: tableCreateParams\n                    }\n                }\n            },\n            width: 400,\n            title: {\n                title: localeService.t(\"toolbar.table.insert\")\n            },\n            onConfirm: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(()=>{\n                commandService.executeCommand($bb9ae9d90429a70d$export$4e832bb83534614c.id, tableCreateParams), confirmService.close($bb9ae9d90429a70d$var$COMPONENT_DOC_CREATE_TABLE_CONFIRM_ID);\n            }, \"onConfirm\"),\n            onClose: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(()=>{\n                confirmService.close($bb9ae9d90429a70d$var$COMPONENT_DOC_CREATE_TABLE_CONFIRM_ID);\n            }, \"onClose\")\n        }), !0;\n    }, \"handler\")\n}, $bb9ae9d90429a70d$export$12633081beeab12c = {\n    id: \"doc.operation.move-cursor\",\n    type: (0, $7yNYd.CommandType).OPERATION,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((accessor, params)=>!!params, \"handler\")\n}, $bb9ae9d90429a70d$export$bb98a1a9da56437b = {\n    id: \"doc.operation.move-selection\",\n    type: (0, $7yNYd.CommandType).OPERATION,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((accessor, params)=>!!params, \"handler\")\n}, $bb9ae9d90429a70d$export$b1260f52284457c5 = {\n    id: \"doc.operation.select-all\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor)=>{\n        const univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), docDataModel = univerInstanceService.getCurrentUniverDocInstance(), activeTextRange = docSelectionManagerService.getActiveTextRange();\n        if (docDataModel == null || activeTextRange == null) return !1;\n        const { segmentId: segmentId } = activeTextRange, prevBody = docDataModel.getSelfOrHeaderFooterModel(segmentId).getSnapshot().body;\n        if (prevBody == null) return !1;\n        const textRanges = [\n            {\n                startOffset: 0,\n                endOffset: prevBody.dataStream.length - 2\n            }\n        ];\n        return docSelectionManagerService.replaceTextRanges(textRanges, !1), !0;\n    }, \"handler\")\n};\nvar $bb9ae9d90429a70d$var$__assign = function() {\n    return $bb9ae9d90429a70d$var$__assign = Object.assign || function(t) {\n        for(var s, i = 1, n2 = arguments.length; i < n2; i++){\n            s = arguments[i];\n            for(var p2 in s)Object.prototype.hasOwnProperty.call(s, p2) && (t[p2] = s[p2]);\n        }\n        return t;\n    }, $bb9ae9d90429a70d$var$__assign.apply(this, arguments);\n}, $bb9ae9d90429a70d$var$__rest = function(s, e) {\n    var t = {};\n    for(var p2 in s)Object.prototype.hasOwnProperty.call(s, p2) && e.indexOf(p2) < 0 && (t[p2] = s[p2]);\n    if (s != null && typeof Object.getOwnPropertySymbols == \"function\") for(var i = 0, p2 = Object.getOwnPropertySymbols(s); i < p2.length; i++)e.indexOf(p2[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p2[i]) && (t[p2[i]] = s[p2[i]]);\n    return t;\n}, $bb9ae9d90429a70d$var$IconBase = (0, $5gqvu.forwardRef)(function(props, ref) {\n    var icon = props.icon, id = props.id, className = props.className, extend = props.extend, restProps = $bb9ae9d90429a70d$var$__rest(props, [\n        \"icon\",\n        \"id\",\n        \"className\",\n        \"extend\"\n    ]), cls = \"univerjs-icon univerjs-icon-\".concat(id, \" \").concat(className || \"\").trim(), idSuffix = (0, $5gqvu.useRef)(\"_\".concat($bb9ae9d90429a70d$var$generateShortUuid()));\n    return $bb9ae9d90429a70d$var$render(icon, \"\".concat(id), {\n        defIds: icon.defIds,\n        idSuffix: idSuffix.current\n    }, $bb9ae9d90429a70d$var$__assign({\n        ref: ref,\n        className: cls\n    }, restProps), extend);\n});\nfunction $bb9ae9d90429a70d$var$render(node, id, runtimeProps, rootProps, extend) {\n    return (0, $5gqvu.createElement)(node.tag, $bb9ae9d90429a70d$var$__assign($bb9ae9d90429a70d$var$__assign({\n        key: id\n    }, $bb9ae9d90429a70d$var$replaceRuntimeIdsAndExtInAttrs(node, runtimeProps, extend)), rootProps), ($bb9ae9d90429a70d$var$replaceRuntimeIdsInDefs(node, runtimeProps).children || []).map(function(child, index) {\n        return $bb9ae9d90429a70d$var$render(child, \"\".concat(id, \"-\").concat(node.tag, \"-\").concat(index), runtimeProps, void 0, extend);\n    }));\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$render, \"render\");\nfunction $bb9ae9d90429a70d$var$replaceRuntimeIdsAndExtInAttrs(node, runtimeProps, extend) {\n    var attrs = $bb9ae9d90429a70d$var$__assign({}, node.attrs);\n    extend != null && extend.colorChannel1 && attrs.fill === \"colorChannel1\" && (attrs.fill = extend.colorChannel1);\n    var defIds = runtimeProps.defIds;\n    return !defIds || defIds.length === 0 || (node.tag === \"use\" && attrs[\"xlink:href\"] && (attrs[\"xlink:href\"] = attrs[\"xlink:href\"] + runtimeProps.idSuffix), Object.entries(attrs).forEach(function(_a28) {\n        var key = _a28[0], value = _a28[1];\n        typeof value == \"string\" && (attrs[key] = value.replace(/url\\(#(.*)\\)/, \"url(#$1\".concat(runtimeProps.idSuffix, \")\")));\n    })), attrs;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$replaceRuntimeIdsAndExtInAttrs, \"replaceRuntimeIdsAndExtInAttrs\");\nfunction $bb9ae9d90429a70d$var$replaceRuntimeIdsInDefs(node, runtimeProps) {\n    var _a28, defIds = runtimeProps.defIds;\n    return !defIds || defIds.length === 0 ? node : node.tag === \"defs\" && !((_a28 = node.children) === null || _a28 === void 0) && _a28.length ? $bb9ae9d90429a70d$var$__assign($bb9ae9d90429a70d$var$__assign({}, node), {\n        children: node.children.map(function(child) {\n            return typeof child.attrs.id == \"string\" && defIds && defIds.indexOf(child.attrs.id) > -1 ? $bb9ae9d90429a70d$var$__assign($bb9ae9d90429a70d$var$__assign({}, child), {\n                attrs: $bb9ae9d90429a70d$var$__assign($bb9ae9d90429a70d$var$__assign({}, child.attrs), {\n                    id: child.attrs.id + runtimeProps.idSuffix\n                })\n            }) : child;\n        })\n    }) : node;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$replaceRuntimeIdsInDefs, \"replaceRuntimeIdsInDefs\");\nfunction $bb9ae9d90429a70d$var$generateShortUuid() {\n    return Math.random().toString(36).substring(2, 8);\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$generateShortUuid, \"generateShortUuid\");\n$bb9ae9d90429a70d$var$IconBase.displayName = \"UniverIcon\";\nvar $bb9ae9d90429a70d$var$element$4 = {\n    tag: \"svg\",\n    attrs: {\n        fill: \"none\",\n        viewBox: \"0 0 16 16\",\n        width: \"1em\",\n        height: \"1em\"\n    },\n    children: [\n        {\n            tag: \"path\",\n            attrs: {\n                fill: \"currentColor\",\n                d: \"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941 1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941 14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999zM1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641 1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H13.9999C14.3313 6.76641 14.5999 6.49778 14.5999 6.16641 14.5999 5.83504 14.3313 5.56641 13.9999 5.56641H1.9999zM1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334 14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334zM1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004 1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H13.9999C14.3313 14.1004 14.5999 13.8318 14.5999 13.5004 14.5999 13.169 14.3313 12.9004 13.9999 12.9004H1.9999z\"\n            }\n        }\n    ]\n}, $bb9ae9d90429a70d$var$AlignTextBothSingle = (0, $5gqvu.forwardRef)(function(props, ref) {\n    return (0, $5gqvu.createElement)($bb9ae9d90429a70d$var$IconBase, Object.assign({}, props, {\n        id: \"align-text-both-single\",\n        ref: ref,\n        icon: $bb9ae9d90429a70d$var$element$4\n    }));\n});\n$bb9ae9d90429a70d$var$AlignTextBothSingle.displayName = \"AlignTextBothSingle\";\nvar $bb9ae9d90429a70d$var$element$3 = {\n    tag: \"svg\",\n    attrs: {\n        fill: \"none\",\n        viewBox: \"0 0 16 16\",\n        width: \"1em\",\n        height: \"1em\"\n    },\n    children: [\n        {\n            tag: \"path\",\n            attrs: {\n                fill: \"currentColor\",\n                d: \"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941 1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941 14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999zM3.33315 5.56641C3.00178 5.56641 2.73315 5.83504 2.73315 6.16641 2.73315 6.49778 3.00178 6.76641 3.33315 6.76641H12.6665C12.9979 6.76641 13.2665 6.49778 13.2665 6.16641 13.2665 5.83504 12.9979 5.56641 12.6665 5.56641H3.33315zM1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334 14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334zM3.33315 12.9004C3.00178 12.9004 2.73315 13.169 2.73315 13.5004 2.73315 13.8318 3.00178 14.1004 3.33315 14.1004H12.6665C12.9979 14.1004 13.2665 13.8318 13.2665 13.5004 13.2665 13.169 12.9979 12.9004 12.6665 12.9004H3.33315z\"\n            }\n        }\n    ]\n}, $bb9ae9d90429a70d$var$HorizontallySingle = (0, $5gqvu.forwardRef)(function(props, ref) {\n    return (0, $5gqvu.createElement)($bb9ae9d90429a70d$var$IconBase, Object.assign({}, props, {\n        id: \"horizontally-single\",\n        ref: ref,\n        icon: $bb9ae9d90429a70d$var$element$3\n    }));\n});\n$bb9ae9d90429a70d$var$HorizontallySingle.displayName = \"HorizontallySingle\";\nvar $bb9ae9d90429a70d$var$element$2 = {\n    tag: \"svg\",\n    attrs: {\n        fill: \"none\",\n        viewBox: \"0 0 16 16\",\n        width: \"1em\",\n        height: \"1em\"\n    },\n    children: [\n        {\n            tag: \"path\",\n            attrs: {\n                fill: \"currentColor\",\n                d: \"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941 1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941 14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999zM1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641 1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H11.3332C11.6646 6.76641 11.9332 6.49778 11.9332 6.16641 11.9332 5.83504 11.6646 5.56641 11.3332 5.56641H1.9999zM1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334 14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334zM1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004 1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H11.3332C11.6646 14.1004 11.9332 13.8318 11.9332 13.5004 11.9332 13.169 11.6646 12.9004 11.3332 12.9004H1.9999z\"\n            }\n        }\n    ]\n}, $bb9ae9d90429a70d$var$LeftJustifyingSingle = (0, $5gqvu.forwardRef)(function(props, ref) {\n    return (0, $5gqvu.createElement)($bb9ae9d90429a70d$var$IconBase, Object.assign({}, props, {\n        id: \"left-justifying-single\",\n        ref: ref,\n        icon: $bb9ae9d90429a70d$var$element$2\n    }));\n});\n$bb9ae9d90429a70d$var$LeftJustifyingSingle.displayName = \"LeftJustifyingSingle\";\nvar $bb9ae9d90429a70d$var$element$1 = {\n    tag: \"svg\",\n    attrs: {\n        fill: \"none\",\n        viewBox: \"0 0 16 16\",\n        width: \"1em\",\n        height: \"1em\"\n    },\n    children: [\n        {\n            tag: \"path\",\n            attrs: {\n                fill: \"currentColor\",\n                d: \"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941 1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941 14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999zM4.66665 5.56641C4.33528 5.56641 4.06665 5.83504 4.06665 6.16641 4.06665 6.49778 4.33528 6.76641 4.66665 6.76641H14C14.3314 6.76641 14.6 6.49778 14.6 6.16641 14.6 5.83504 14.3314 5.56641 14 5.56641H4.66665zM1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334 14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334zM4.66665 12.9004C4.33528 12.9004 4.06665 13.169 4.06665 13.5004 4.06665 13.8318 4.33528 14.1004 4.66665 14.1004H14C14.3314 14.1004 14.6 13.8318 14.6 13.5004 14.6 13.169 14.3314 12.9004 14 12.9004H4.66665z\"\n            }\n        }\n    ]\n}, $bb9ae9d90429a70d$var$RightJustifyingSingle = (0, $5gqvu.forwardRef)(function(props, ref) {\n    return (0, $5gqvu.createElement)($bb9ae9d90429a70d$var$IconBase, Object.assign({}, props, {\n        id: \"right-justifying-single\",\n        ref: ref,\n        icon: $bb9ae9d90429a70d$var$element$1\n    }));\n});\n$bb9ae9d90429a70d$var$RightJustifyingSingle.displayName = \"RightJustifyingSingle\";\nvar $bb9ae9d90429a70d$var$element = {\n    tag: \"svg\",\n    attrs: {\n        fill: \"none\",\n        viewBox: \"0 0 16 16\",\n        width: \"1em\",\n        height: \"1em\"\n    },\n    children: [\n        {\n            tag: \"path\",\n            attrs: {\n                fill: \"currentColor\",\n                d: \"M4.96372 2.59116C5.19803 2.35684 5.19803 1.97695 4.96372 1.74263 4.7294 1.50832 4.3495 1.50832 4.11519 1.74263L2.53945 3.31837 1.96372 2.74263C1.7294 2.50832 1.3495 2.50832 1.11519 2.74263.880874 2.97695.880874 3.35684 1.11519 3.59116L2.11519 4.59116C2.3495 4.82547 2.7294 4.82547 2.96372 4.59116L4.96372 2.59116zM14.4605 2.56689H6.8981C6.56672 2.56689 6.2981 2.83552 6.2981 3.16689 6.2981 3.49827 6.56672 3.76689 6.8981 3.76689H14.4605C14.7918 3.76689 15.0605 3.49827 15.0605 3.16689 15.0605 2.83552 14.7918 2.56689 14.4605 2.56689zM6.8981 7.2334C6.56672 7.2334 6.2981 7.50203 6.2981 7.8334 6.2981 8.16477 6.56672 8.4334 6.8981 8.4334H14.4605C14.7918 8.4334 15.0605 8.16477 15.0605 7.8334 15.0605 7.50203 14.7918 7.2334 14.4605 7.2334H6.8981zM6.2981 12.4999C6.2981 12.1685 6.56672 11.8999 6.8981 11.8999H14.4605C14.7918 11.8999 15.0605 12.1685 15.0605 12.4999 15.0605 12.8313 14.7918 13.0999 14.4605 13.0999H6.8981C6.56672 13.0999 6.2981 12.8313 6.2981 12.4999z\"\n            }\n        },\n        {\n            tag: \"path\",\n            attrs: {\n                fill: \"currentColor\",\n                d: \"M2.87279 5.8999C1.80504 5.8999.939453 6.76549.939453 7.83324.939453 8.90099 1.80504 9.76657 2.87279 9.76657 3.94054 9.76657 4.80612 8.90099 4.80612 7.83324 4.80612 6.76549 3.94054 5.8999 2.87279 5.8999zM2.13945 7.83324C2.13945 7.42823 2.46778 7.0999 2.87279 7.0999 3.2778 7.0999 3.60612 7.42823 3.60612 7.83324 3.60612 8.23824 3.2778 8.56657 2.87279 8.56657 2.46778 8.56657 2.13945 8.23824 2.13945 7.83324zM.939453 12.5002C.939453 11.4325 1.80504 10.5669 2.87279 10.5669 3.94054 10.5669 4.80612 11.4325 4.80612 12.5002 4.80612 13.568 3.94054 14.4336 2.87279 14.4336 1.80504 14.4336.939453 13.568.939453 12.5002zM2.87279 11.7669C2.46778 11.7669 2.13945 12.0952 2.13945 12.5002 2.13945 12.9052 2.46778 13.2336 2.87279 13.2336 3.2778 13.2336 3.60612 12.9052 3.60612 12.5002 3.60612 12.0952 3.2778 11.7669 2.87279 11.7669z\",\n                fillRule: \"evenodd\",\n                clipRule: \"evenodd\"\n            }\n        }\n    ]\n}, $bb9ae9d90429a70d$var$TodoList = (0, $5gqvu.forwardRef)(function(props, ref) {\n    return (0, $5gqvu.createElement)($bb9ae9d90429a70d$var$IconBase, Object.assign({}, props, {\n        id: \"todo-list\",\n        ref: ref,\n        icon: $bb9ae9d90429a70d$var$element\n    }));\n});\n$bb9ae9d90429a70d$var$TodoList.displayName = \"TodoList\";\nvar $bb9ae9d90429a70d$var$NodePositionType = /* @__PURE__ */ ((NodePositionType2)=>(NodePositionType2[NodePositionType2.page = 0] = \"page\", NodePositionType2[NodePositionType2.section = 1] = \"section\", NodePositionType2[NodePositionType2.column = 2] = \"column\", NodePositionType2[NodePositionType2.line = 3] = \"line\", NodePositionType2[NodePositionType2.divide = 4] = \"divide\", NodePositionType2[NodePositionType2.glyph = 5] = \"glyph\", NodePositionType2))($bb9ae9d90429a70d$var$NodePositionType || {});\nconst $bb9ae9d90429a70d$var$NodePositionMap = {\n    page: 0,\n    section: 1,\n    column: 2,\n    line: 3,\n    divide: 4,\n    glyph: 5\n};\nfunction $bb9ae9d90429a70d$var$compareNodePositionLogic(pos1, pos2) {\n    return pos1.page > pos2.page ? !1 : pos1.page < pos2.page ? !0 : pos1.section > pos2.section ? !1 : pos1.section < pos2.section ? !0 : pos1.column > pos2.column ? !1 : pos1.column < pos2.column ? !0 : pos1.line > pos2.line ? !1 : pos1.line < pos2.line ? !0 : pos1.divide > pos2.divide ? !1 : pos1.divide < pos2.divide ? !0 : pos1.glyph > pos2.glyph ? !1 : (pos1.glyph, pos2.glyph, !0);\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$compareNodePositionLogic, \"compareNodePositionLogic\");\nfunction $bb9ae9d90429a70d$var$compareNodePosition(pos1, pos2) {\n    return $bb9ae9d90429a70d$var$compareNodePositionLogic(pos1, pos2) ? {\n        start: pos1,\n        end: pos2\n    } : {\n        start: pos2,\n        end: pos1\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$compareNodePosition, \"compareNodePosition\");\nfunction $bb9ae9d90429a70d$export$7c80d2a14b5c99ad(rangeList) {\n    const rangeCount = rangeList.length;\n    if (rangeCount === 0) return;\n    const firstCursor = rangeList[0], lastCursor = rangeList[rangeCount - 1], collapsed = rangeList.length === 1 && firstCursor.collapsed;\n    return {\n        startOffset: firstCursor.startOffset,\n        endOffset: lastCursor.endOffset,\n        collapsed: collapsed\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$7c80d2a14b5c99ad, \"getOneTextSelectionRange\");\nfunction $bb9ae9d90429a70d$var$getOffsetInDivide(glyphGroup, startGlyphIndex, endGlyphIndex, st) {\n    let startOffset = st, endOffset = st;\n    for(let i = 0; i < glyphGroup.length; i++){\n        const contentLength = glyphGroup[i].count;\n        i < startGlyphIndex && (startOffset += contentLength), i < endGlyphIndex && (endOffset += contentLength);\n    }\n    return {\n        startOffset: startOffset,\n        endOffset: endOffset\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getOffsetInDivide, \"getOffsetInDivide\");\nfunction $bb9ae9d90429a70d$var$pushToPoints(position) {\n    const { startX: startX, startY: startY, endX: endX, endY: endY } = position, points = [];\n    return points.push({\n        x: startX,\n        y: startY\n    }), points.push({\n        x: endX,\n        y: startY\n    }), points.push({\n        x: endX,\n        y: endY\n    }), points.push({\n        x: startX,\n        y: endY\n    }), points.push({\n        x: startX,\n        y: startY\n    }), points;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$pushToPoints, \"pushToPoints\");\nconst $bb9ae9d90429a70d$var$_NodePositionConvertToCursor = class _NodePositionConvertToCursor {\n    constructor(_documentOffsetConfig, _docSkeleton){\n        $bb9ae9d90429a70d$var$__publicField(this, \"_liquid\", new (0, $3e0Iz.Liquid)());\n        $bb9ae9d90429a70d$var$__publicField(this, \"_currentStartState\", {\n            page: 0,\n            section: 0,\n            column: 0,\n            line: 0,\n            divide: 0,\n            glyph: 0\n        });\n        $bb9ae9d90429a70d$var$__publicField(this, \"_currentEndState\", {\n            page: 0,\n            section: 0,\n            column: 0,\n            line: 0,\n            divide: 0,\n            glyph: 0\n        });\n        this._documentOffsetConfig = _documentOffsetConfig, this._docSkeleton = _docSkeleton;\n    }\n    // eslint-disable-next-line max-lines-per-function\n    getRangePointData(startOrigin, endOrigin) {\n        const borderBoxPointGroup = [], contentBoxPointGroup = [], cursorList = [];\n        if (startOrigin == null || endOrigin == null) return {\n            borderBoxPointGroup: borderBoxPointGroup,\n            contentBoxPointGroup: contentBoxPointGroup,\n            cursorList: cursorList\n        };\n        if (!this._isValidPosition(startOrigin, endOrigin)) throw new Error(`\n                Invalid positions in NodePositionConvertToCursor,\n                they are not in the same segment page when in header or footer.`);\n        const { start: start, end: end } = $bb9ae9d90429a70d$var$compareNodePosition(startOrigin, endOrigin);\n        return this._selectionIterator(start, end, (start_sp, end_sp, isFirst, isLast, divide, line)=>{\n            const { lineHeight: lineHeight, asc: asc, paddingTop: paddingTop, marginTop: marginTop, marginBottom: marginBottom } = line, { glyphGroup: glyphGroup, st: st } = divide;\n            if (glyphGroup.length === 0) return;\n            const { x: startX, y: startY } = this._liquid;\n            let borderBoxPosition, contentBoxPosition;\n            const firstGlyph = glyphGroup[start_sp], lastGlyph = glyphGroup[end_sp], preGlyph = glyphGroup[start_sp - 1], firstGlyphLeft = (firstGlyph == null ? void 0 : firstGlyph.left) || 0, firstGlyphWidth = (firstGlyph == null ? void 0 : firstGlyph.width) || 0, lastGlyphLeft = (lastGlyph == null ? void 0 : lastGlyph.left) || 0, lastGlyphWidth = (lastGlyph == null ? void 0 : lastGlyph.width) || 0, isCurrentList = (firstGlyph == null ? void 0 : firstGlyph.glyphType) === (0, $3e0Iz.GlyphType).LIST, { startOffset: startOffset, endOffset: endOffset } = $bb9ae9d90429a70d$var$getOffsetInDivide(glyphGroup, start_sp, end_sp, st), isStartBack = start.glyph === start_sp && isFirst ? start.isBack : !0, isEndBack = end.glyph === end_sp && isLast ? end.isBack : !1, collapsed = start === end, anchorGlyph = isStartBack && preGlyph != null ? preGlyph : firstGlyph;\n            if (start_sp === 0 && end_sp === glyphGroup.length - 1) borderBoxPosition = {\n                startX: startX + firstGlyphLeft + (isCurrentList ? firstGlyphWidth : 0),\n                startY: startY,\n                endX: startX + lastGlyphLeft + (isEndBack ? 0 : lastGlyphWidth),\n                endY: startY + lineHeight - marginTop - marginBottom\n            }, contentBoxPosition = {\n                startX: startX + firstGlyphLeft + (isCurrentList ? firstGlyphWidth : 0),\n                startY: startY + paddingTop + asc - anchorGlyph.bBox.ba,\n                endX: startX + lastGlyphLeft + (isEndBack ? 0 : lastGlyphWidth),\n                endY: startY + paddingTop + asc + anchorGlyph.bBox.bd\n            };\n            else {\n                const isStartBackFin = isStartBack && !isCurrentList;\n                borderBoxPosition = {\n                    startX: startX + firstGlyphLeft + (isStartBackFin ? 0 : firstGlyphWidth),\n                    startY: startY,\n                    endX: startX + lastGlyphLeft + (isEndBack ? 0 : lastGlyphWidth),\n                    endY: startY + lineHeight - marginTop - marginBottom\n                }, contentBoxPosition = {\n                    startX: startX + firstGlyphLeft + (isStartBackFin ? 0 : firstGlyphWidth),\n                    startY: startY + paddingTop + asc - anchorGlyph.bBox.ba,\n                    endX: startX + lastGlyphLeft + (isEndBack ? 0 : lastGlyphWidth),\n                    endY: startY + paddingTop + asc + anchorGlyph.bBox.bd\n                };\n            }\n            borderBoxPointGroup.push($bb9ae9d90429a70d$var$pushToPoints(borderBoxPosition)), contentBoxPointGroup.push($bb9ae9d90429a70d$var$pushToPoints(contentBoxPosition)), cursorList.push({\n                startOffset: isStartBack ? startOffset : startOffset + firstGlyph.count,\n                endOffset: isEndBack ? endOffset : endOffset + lastGlyph.count,\n                collapsed: collapsed\n            });\n        }), {\n            borderBoxPointGroup: borderBoxPointGroup,\n            contentBoxPointGroup: contentBoxPointGroup,\n            cursorList: cursorList\n        };\n    }\n    _isValidPosition(startOrigin, endOrigin) {\n        const { segmentPage: startPage, pageType: startPageType } = startOrigin, { segmentPage: endPage, pageType: endPageType } = endOrigin;\n        return startPageType !== endPageType ? !1 : startPageType === (0, $3e0Iz.DocumentSkeletonPageType).HEADER || startPageType === (0, $3e0Iz.DocumentSkeletonPageType).FOOTER ? startPage === endPage : !0;\n    }\n    _resetCurrentNodePositionState() {\n        this._currentStartState = {\n            page: 0,\n            section: 0,\n            column: 0,\n            line: 0,\n            divide: 0,\n            glyph: 0\n        }, this._currentEndState = {\n            page: 0,\n            section: 0,\n            column: 0,\n            line: 0,\n            divide: 0,\n            glyph: 0\n        };\n    }\n    _setNodePositionState(type = 0, start, end, current) {\n        current === start ? this._currentStartState[type] = 1 : this._currentStartState[type] = 0, current === end ? this._currentEndState[type] = 2 : this._currentEndState[type] = 0;\n    }\n    _checkPreviousNodePositionState(typeIndex, isStart = !0) {\n        let index = typeIndex, resultState;\n        for(; index >= 0;){\n            const type = $bb9ae9d90429a70d$var$NodePositionType[index];\n            let state;\n            if (isStart ? state = this._currentStartState[type] : state = this._currentEndState[type], state === void 0) return;\n            if (resultState === void 0 && (resultState = state), state !== resultState) return 0;\n            index--;\n        }\n        return resultState;\n    }\n    _getSelectionRuler(typeIndex, startPosition, endPosition, nextLength, current) {\n        let start_next = 0, end_next = nextLength;\n        const type = $bb9ae9d90429a70d$var$NodePositionType[typeIndex], nextType = $bb9ae9d90429a70d$var$NodePositionType[typeIndex + 1];\n        if (nextType === null || type === null) return {\n            start_next: start_next,\n            end_next: end_next\n        };\n        const start = startPosition[type], end = endPosition[type];\n        this._setNodePositionState(type, start, end, current);\n        const preStartNestType = this._checkPreviousNodePositionState(typeIndex), preEndNestType = this._checkPreviousNodePositionState(typeIndex, !1);\n        return preStartNestType === 1 && (start_next = startPosition[nextType]), preEndNestType === 2 && (end_next = endPosition[nextType]), {\n            start_next: start_next,\n            end_next: end_next\n        };\n    }\n    // eslint-disable-next-line max-lines-per-function, complexity\n    _selectionIterator(startPosition, endPosition, func) {\n        var _a28, _b;\n        const skeleton = this._docSkeleton;\n        if (!skeleton) return [];\n        const { pageType: pageType, path: path } = startPosition;\n        this._liquid.reset();\n        const skeletonData = skeleton.getSkeletonData();\n        if (skeletonData == null) return [];\n        const { pages: pages, skeHeaders: skeHeaders, skeFooters: skeFooters } = skeletonData, { page: pageIndex, segmentPage: segmentPage } = startPosition, { page: endPageIndex, segmentPage: endSegmentPage } = endPosition;\n        if (this._resetCurrentNodePositionState(), this._documentOffsetConfig == null) return [];\n        const { pageLayoutType: pageLayoutType, pageMarginLeft: pageMarginLeft, pageMarginTop: pageMarginTop } = this._documentOffsetConfig, skipPageIndex = pageType === (0, $3e0Iz.DocumentSkeletonPageType).BODY || pageType === (0, $3e0Iz.DocumentSkeletonPageType).CELL ? pageIndex : segmentPage;\n        for(let p2 = 0; p2 < skipPageIndex; p2++){\n            const page = pages[p2];\n            this._liquid.translatePage(page, pageLayoutType, pageMarginLeft, pageMarginTop);\n        }\n        const endIndex = pageType === (0, $3e0Iz.DocumentSkeletonPageType).BODY || pageType === (0, $3e0Iz.DocumentSkeletonPageType).CELL ? endPageIndex : endSegmentPage;\n        for(let p2 = skipPageIndex; p2 <= endIndex; p2++){\n            const page = pages[p2], { headerId: headerId, footerId: footerId, pageWidth: pageWidth } = page;\n            let segmentPage2 = page;\n            if (pageType === (0, $3e0Iz.DocumentSkeletonPageType).HEADER ? segmentPage2 = (_a28 = skeHeaders.get(headerId)) == null ? void 0 : _a28.get(pageWidth) : pageType === (0, $3e0Iz.DocumentSkeletonPageType).FOOTER ? segmentPage2 = (_b = skeFooters.get(footerId)) == null ? void 0 : _b.get(pageWidth) : pageType === (0, $3e0Iz.DocumentSkeletonPageType).CELL && (segmentPage2 = (0, $3e0Iz.getPageFromPath)(skeletonData, path)), segmentPage2 == null) {\n                this._liquid.translatePage(page, pageLayoutType, pageMarginLeft, pageMarginTop);\n                continue;\n            }\n            const sections = segmentPage2.sections, { start_next: start_s, end_next: end_s } = this._getSelectionRuler($bb9ae9d90429a70d$var$NodePositionMap.page, startPosition, endPosition, sections.length - 1, pageType === (0, $3e0Iz.DocumentSkeletonPageType).BODY || pageType === (0, $3e0Iz.DocumentSkeletonPageType).CELL ? p2 : 0);\n            switch(this._liquid.translateSave(), pageType){\n                case (0, $3e0Iz.DocumentSkeletonPageType).HEADER:\n                    this._liquid.translatePagePadding({\n                        ...segmentPage2,\n                        marginLeft: page.marginLeft\n                    });\n                    break;\n                case (0, $3e0Iz.DocumentSkeletonPageType).FOOTER:\n                    {\n                        const footerTop = page.pageHeight - segmentPage2.height - segmentPage2.marginBottom;\n                        this._liquid.translate(page.marginLeft, footerTop);\n                        break;\n                    }\n                case (0, $3e0Iz.DocumentSkeletonPageType).CELL:\n                    {\n                        this._liquid.translatePagePadding(page);\n                        const rowSke = segmentPage2.parent, tableSke = rowSke.parent, { left: cellLeft } = segmentPage2, { top: tableTop, left: tableLeft } = tableSke, { top: rowTop } = rowSke;\n                        this._liquid.translate(tableLeft + cellLeft, tableTop + rowTop), this._liquid.translatePagePadding(segmentPage2);\n                        break;\n                    }\n                default:\n                    this._liquid.translatePagePadding(page);\n                    break;\n            }\n            for(let s = start_s; s <= end_s; s++){\n                const section = sections[s], columns = section.columns, { start_next: start_c, end_next: end_c } = this._getSelectionRuler($bb9ae9d90429a70d$var$NodePositionMap.section, startPosition, endPosition, columns.length - 1, s);\n                this._liquid.translateSection(section);\n                for(let c = start_c; c <= end_c; c++){\n                    const column = columns[c], lines = column.lines, { start_next: start_l, end_next: end_l } = this._getSelectionRuler($bb9ae9d90429a70d$var$NodePositionMap.column, startPosition, endPosition, lines.length - 1, c);\n                    this._liquid.translateColumn(column);\n                    for(let l2 = start_l; l2 <= end_l; l2++){\n                        const line = lines[l2], { divides: divides } = line, { start_next: start_d, end_next: end_d } = this._getSelectionRuler($bb9ae9d90429a70d$var$NodePositionMap.line, startPosition, endPosition, divides.length - 1, l2);\n                        this._liquid.translateSave(), this._liquid.translateLine(line, !0, !1);\n                        for(let d = start_d; d <= end_d; d++){\n                            const divide = divides[d];\n                            this._liquid.translateSave(), this._liquid.translateDivide(divide);\n                            const { glyphGroup: glyphGroup } = divide, { start_next: start_sp, end_next: end_sp } = this._getSelectionRuler($bb9ae9d90429a70d$var$NodePositionMap.divide, startPosition, endPosition, glyphGroup.length - 1, d);\n                            let isFirst = !1, isLast = !1;\n                            p2 === skipPageIndex && s === start_s && c === start_c && l2 === start_l && d === start_d && (isFirst = !0), p2 === endIndex && s === end_s && c === end_c && l2 === end_l && d === end_d && (isLast = !0), func && func(start_sp, end_sp, isFirst, isLast, divide, line, column, section, segmentPage2), this._liquid.translateRestore();\n                        }\n                        this._liquid.translateRestore();\n                    }\n                }\n            }\n            this._liquid.translateRestore(), this._liquid.translatePage(page, pageLayoutType, pageMarginLeft, pageMarginTop);\n        }\n    }\n};\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_NodePositionConvertToCursor, \"NodePositionConvertToCursor\");\nlet $bb9ae9d90429a70d$export$37b489d6b2152f0f = $bb9ae9d90429a70d$var$_NodePositionConvertToCursor;\nfunction $bb9ae9d90429a70d$export$d6b48af136414a10(anchorNodePosition, focusNodePosition) {\n    const { path: anchorPath } = anchorNodePosition, { path: focusPath } = focusNodePosition;\n    if (anchorPath.length !== focusPath.length || anchorPath.indexOf(\"cells\") === -1) return !1;\n    const tableIdIndex = anchorPath.indexOf(\"skeTables\") + 1, rowIndex = anchorPath.indexOf(\"rows\") + 1, cellIndex = anchorPath.indexOf(\"cells\") + 1, anchorTableId = (0, $3e0Iz.getTableIdAndSliceIndex)(anchorPath[tableIdIndex]).tableId, focusTableId = (0, $3e0Iz.getTableIdAndSliceIndex)(focusPath[tableIdIndex]).tableId;\n    if (anchorTableId !== focusTableId) return !1;\n    const anchorRowIndex = anchorPath[rowIndex], focusRowIndex = focusPath[rowIndex], anchorCellIndex = anchorPath[cellIndex], focusCellIndex = focusPath[cellIndex];\n    return !(anchorRowIndex === focusRowIndex && anchorCellIndex === focusCellIndex);\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$d6b48af136414a10, \"isValidRectRange\");\nfunction $bb9ae9d90429a70d$export$57d2e8d2118a89(anchorNodePosition, focusNodePosition) {\n    const { path: anchorPath } = anchorNodePosition, { path: focusPath } = focusNodePosition;\n    return anchorPath.indexOf(\"cells\") === -1 || focusPath.indexOf(\"cells\") === -1 ? !1 : (0, $7yNYd.Tools).diffValue(anchorPath, focusPath);\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$57d2e8d2118a89, \"isInSameTableCell\");\nfunction $bb9ae9d90429a70d$var$compareNodePositionInTable(a, b) {\n    if ($bb9ae9d90429a70d$export$57d2e8d2118a89(a, b)) return $bb9ae9d90429a70d$var$compareNodePositionLogic(a, b);\n    const { path: aPath } = a, { path: bPath } = b, aTableId = aPath[aPath.length - 5], bTableId = bPath[bPath.length - 5];\n    if (aTableId !== bTableId && typeof aTableId == \"string\" && typeof bTableId == \"string\") {\n        const aSlideId = aTableId.split(\"#-#\")[1], bSlideId = bTableId.split(\"#-#\")[1];\n        return +aSlideId < +bSlideId;\n    }\n    const aRowCount = aPath[aPath.length - 3], bRowCount = bPath[bPath.length - 3], aCellCount = aPath[aPath.length - 1], bCellCount = bPath[bPath.length - 1];\n    return aRowCount < bRowCount ? !0 : aRowCount > bRowCount ? !1 : aCellCount <= bCellCount;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$compareNodePositionInTable, \"compareNodePositionInTable\");\nfunction $bb9ae9d90429a70d$var$firstGlyphInCellPage(cellPage) {\n    return cellPage.sections[0].columns[0].lines[0].divides[0].glyphGroup[0];\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$firstGlyphInCellPage, \"firstGlyphInCellPage\");\nfunction $bb9ae9d90429a70d$var$lastGlyphInCellPage(cellPage) {\n    const { sections: sections } = cellPage, lastSection = sections[sections.length - 1], lastColumn = lastSection.columns[lastSection.columns.length - 1], lastLine = lastColumn.lines[lastColumn.lines.length - 1], lastGlyphGroup = lastLine.divides[lastLine.divides.length - 1].glyphGroup;\n    return lastGlyphGroup[lastGlyphGroup.length - 2];\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$lastGlyphInCellPage, \"lastGlyphInCellPage\");\nconst $bb9ae9d90429a70d$var$_NodePositionConvertToRectRange = class _NodePositionConvertToRectRange {\n    constructor(_documentOffsetConfig, _docSkeleton){\n        $bb9ae9d90429a70d$var$__publicField(this, \"_liquid\", new (0, $3e0Iz.Liquid)());\n        this._documentOffsetConfig = _documentOffsetConfig, this._docSkeleton = _docSkeleton;\n    }\n    // eslint-disable-next-line max-lines-per-function\n    getRangePointData(startNodePosition, endNodePosition) {\n        const pointGroup = [], skeletonData = this._docSkeleton.getSkeletonData();\n        if (skeletonData == null) return;\n        const { pages: pages } = skeletonData, { segmentPage: startSegmentPage, page: startPage, pageType: pageType } = startNodePosition, { segmentPage: endSegmentPage, page: endPage } = endNodePosition, rectInfo = this._getTableRectRangeInfo(startNodePosition, endNodePosition);\n        if (rectInfo == null) return;\n        const { tableId: tableId, startRowIndex: startRow, startColumnIndex: startColumn, endRowIndex: endRow, endColumnIndex: endColumn } = rectInfo;\n        this._liquid.reset();\n        const { pageLayoutType: pageLayoutType, pageMarginLeft: pageMarginLeft, pageMarginTop: pageMarginTop } = this._documentOffsetConfig, skipPageIndex = pageType === (0, $3e0Iz.DocumentSkeletonPageType).BODY || pageType === (0, $3e0Iz.DocumentSkeletonPageType).CELL ? startPage : startSegmentPage;\n        for(let p2 = 0; p2 < skipPageIndex; p2++){\n            const page = pages[p2];\n            this._liquid.translatePage(page, pageLayoutType, pageMarginLeft, pageMarginTop);\n        }\n        const endIndex = pageType === (0, $3e0Iz.DocumentSkeletonPageType).BODY || pageType === (0, $3e0Iz.DocumentSkeletonPageType).CELL ? endPage : endSegmentPage;\n        for(let p2 = skipPageIndex; p2 <= endIndex; p2++){\n            const page = pages[p2];\n            this._liquid.translatePagePadding(page);\n            const { skeTables: skeTables } = page;\n            let table = null;\n            for (const [id, tableSke] of skeTables.entries())id.startsWith(tableId) && (table = tableSke);\n            if (table == null) {\n                this._liquid.restorePagePadding(page), this._liquid.translatePage(page, pageLayoutType, pageMarginLeft, pageMarginTop);\n                continue;\n            }\n            this._liquid.translateSave(), this._liquid.translate(0, table.top);\n            const { x: x, y: y } = this._liquid;\n            for (const row of table.rows)if (row.index >= startRow && row.index <= endRow) {\n                const rowStartCell = row.cells[startColumn], rowEndCell = row.cells[endColumn], position = {\n                    startX: x + rowStartCell.left,\n                    startY: y + row.top,\n                    endX: x + rowEndCell.left + rowEndCell.pageWidth,\n                    endY: y + row.top + row.height\n                };\n                pointGroup.push($bb9ae9d90429a70d$var$pushToPoints(position));\n            }\n            this._liquid.translateRestore(), this._liquid.restorePagePadding(page), this._liquid.translatePage(page, pageLayoutType, pageMarginLeft, pageMarginTop);\n        }\n        return {\n            pointGroup: pointGroup,\n            startRow: startRow,\n            startColumn: startColumn,\n            endRow: endRow,\n            endColumn: endColumn,\n            tableId: tableId\n        };\n    }\n    getNodePositionGroup(anchorNodePosition, focusNodePosition) {\n        const nodePositionGroup = [], compare = $bb9ae9d90429a70d$var$compareNodePositionInTable(anchorNodePosition, focusNodePosition), startNodePosition = compare ? anchorNodePosition : focusNodePosition, endNodePosition = compare ? focusNodePosition : anchorNodePosition, { segmentPage: segmentPage } = startNodePosition, rectInfo = this._getTableRectRangeInfo(startNodePosition, endNodePosition);\n        if (rectInfo == null) return;\n        const { tableId: tableId, pages: pages, startRowIndex: startRowIndex, startColumnIndex: startColumnIndex, endRowIndex: endRowIndex, endColumnIndex: endColumnIndex } = rectInfo, tables = [];\n        for (const page of pages){\n            const { skeTables: skeTables } = page;\n            for (const [id, table] of skeTables.entries())id.startsWith(tableId) && tables.push(table);\n        }\n        if (tables.length === 0) return;\n        const totalColumns = tables[0].rows[0].cells.length;\n        if (startColumnIndex === 0 && endColumnIndex === totalColumns - 1) return nodePositionGroup.push({\n            anchor: anchorNodePosition,\n            focus: focusNodePosition\n        }), nodePositionGroup;\n        for (const table of tables)this._collectPositionGroup(table, nodePositionGroup, startRowIndex, endRowIndex, startColumnIndex, endColumnIndex, segmentPage, compare);\n        return nodePositionGroup;\n    }\n    _collectPositionGroup(table, nodePositionGroup, startRowIndex, endRowIndex, startColumnIndex, endColumnIndex, segmentPage, compare) {\n        for(let i = 0; i < table.rows.length; i++){\n            const row = table.rows[i];\n            if (row.index < startRowIndex) continue;\n            if (row.index > endRowIndex) break;\n            const startCellInRow = row.cells[startColumnIndex], endCellInRow = row.cells[endColumnIndex], startCellGlyph = $bb9ae9d90429a70d$var$firstGlyphInCellPage(startCellInRow), endCellGlyph = $bb9ae9d90429a70d$var$lastGlyphInCellPage(endCellInRow);\n            if (startCellGlyph == null || endCellGlyph == null) continue;\n            const startPosition = this._docSkeleton.findPositionByGlyph(startCellGlyph, segmentPage), endPosition = this._docSkeleton.findPositionByGlyph(endCellGlyph, segmentPage);\n            if (startPosition == null || endPosition == null) continue;\n            const anchor = compare ? startPosition : endPosition, focus = compare ? endPosition : startPosition;\n            nodePositionGroup.push({\n                anchor: {\n                    ...anchor,\n                    isBack: !0\n                },\n                focus: {\n                    ...focus,\n                    isBack: !0\n                }\n            });\n        }\n    }\n    _getTableRectRangeInfo(startNodePosition, endNodePosition) {\n        const skeletonData = this._docSkeleton.getSkeletonData();\n        if (skeletonData == null) return;\n        const { pages: pages } = skeletonData, { path: startPath } = startNodePosition, { path: endPath } = endNodePosition, startCell = (0, $3e0Iz.getPageFromPath)(skeletonData, startPath), endCell = (0, $3e0Iz.getPageFromPath)(skeletonData, endPath);\n        if (startCell == null || endCell == null) return;\n        const tableId = startCell.segmentId, startRow = startCell.parent.index, startColumn = startCell.parent.cells.indexOf(startCell), endRow = (endCell == null ? void 0 : endCell.parent).index, endColumn = (endCell == null ? void 0 : endCell.parent).cells.indexOf(endCell);\n        return {\n            pages: pages,\n            tableId: tableId,\n            startCell: startCell,\n            endCell: endCell,\n            startRowIndex: startRow,\n            startColumnIndex: startColumn,\n            endRowIndex: endRow,\n            endColumnIndex: endColumn\n        };\n    }\n};\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_NodePositionConvertToRectRange, \"NodePositionConvertToRectRange\");\nlet $bb9ae9d90429a70d$export$ecdcda536fc542e6 = $bb9ae9d90429a70d$var$_NodePositionConvertToRectRange;\nconst $bb9ae9d90429a70d$var$TEXT_RANGE_KEY_PREFIX = \"__TestSelectionRange__\", $bb9ae9d90429a70d$var$TEXT_ANCHOR_KEY_PREFIX = \"__TestSelectionAnchor__\", $bb9ae9d90429a70d$var$ID_LENGTH$1 = 6, $bb9ae9d90429a70d$var$BLINK_ON = 500, $bb9ae9d90429a70d$var$BLINK_OFF = 500, $bb9ae9d90429a70d$export$273888e43d78d7e4 = 3;\nfunction $bb9ae9d90429a70d$export$ea37786f3b0c02f2(pointsGroup) {\n    const points = pointsGroup[0], startPoint = points[0], endPoint = points[2], { x: startX, y: startY } = startPoint, { x: endX, y: endY } = endPoint;\n    return {\n        left: startX,\n        top: startY,\n        width: endX - startX,\n        height: endY - startY\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$ea37786f3b0c02f2, \"getAnchorBounding\");\nfunction $bb9ae9d90429a70d$export$18c799e465d2606c(pointsGroup) {\n    return pointsGroup.map((line)=>{\n        let xMin = 1 / 0, xMax = -1 / 0, yMin = 1 / 0, yMax = -1 / 0;\n        return line.forEach((point)=>{\n            xMin = Math.min(point.x, xMin), xMax = Math.max(point.x, xMax), yMax = Math.max(point.y, yMax), yMin = Math.min(point.y, yMin);\n        }), {\n            left: xMin,\n            right: xMax,\n            top: yMin,\n            bottom: yMax\n        };\n    });\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$18c799e465d2606c, \"getLineBounding\");\nconst $bb9ae9d90429a70d$var$_TextRange = class _TextRange {\n    constructor(_scene, _document, _docSkeleton, anchorNodePosition, focusNodePosition, style = (0, $3e0Iz.NORMAL_TEXT_SELECTION_PLUGIN_STYLE), _segmentId = \"\", _segmentPage = -1){\n        $bb9ae9d90429a70d$var$__publicField(this, \"rangeType\", (0, $7yNYd.DOC_RANGE_TYPE).TEXT);\n        // Identifies whether the range is the current one, most of which is the last range.\n        $bb9ae9d90429a70d$var$__publicField(this, \"_current\", !1);\n        // The rendered range graphic when collapsed is false\n        $bb9ae9d90429a70d$var$__publicField(this, \"_rangeShape\");\n        // The rendered range graphic when collapsed is true\n        $bb9ae9d90429a70d$var$__publicField(this, \"_anchorShape\");\n        $bb9ae9d90429a70d$var$__publicField(this, \"_cursorList\", []);\n        $bb9ae9d90429a70d$var$__publicField(this, \"_anchorBlinkTimer\", null);\n        this._scene = _scene, this._document = _document, this._docSkeleton = _docSkeleton, this.anchorNodePosition = anchorNodePosition, this.focusNodePosition = focusNodePosition, this.style = style, this._segmentId = _segmentId, this._segmentPage = _segmentPage, this._anchorBlink(), this.refresh();\n    }\n    _anchorBlink() {\n        setTimeout(()=>{\n            this._anchorShape && this._anchorShape.visible && this.deactivateStatic();\n        }, $bb9ae9d90429a70d$var$BLINK_ON), this._anchorBlinkTimer = setInterval(()=>{\n            this._anchorShape && this._anchorShape.visible && (this.activeStatic(), setTimeout(()=>{\n                this.deactivateStatic();\n            }, $bb9ae9d90429a70d$var$BLINK_ON));\n        }, $bb9ae9d90429a70d$var$BLINK_OFF + $bb9ae9d90429a70d$var$BLINK_ON);\n    }\n    // The start position of the range\n    get startOffset() {\n        var _a28;\n        const { startOffset: startOffset } = (_a28 = $bb9ae9d90429a70d$export$7c80d2a14b5c99ad(this._cursorList)) != null ? _a28 : {}, body = this._docSkeleton.getViewModel().getDataModel().getSelfOrHeaderFooterModel(this._segmentId).getBody();\n        if (startOffset == null || body == null) return startOffset;\n        const maxLength = body.dataStream.length - 2;\n        return Math.min(maxLength, startOffset);\n    }\n    // The end position of the range\n    get endOffset() {\n        var _a28;\n        const { endOffset: endOffset } = (_a28 = $bb9ae9d90429a70d$export$7c80d2a14b5c99ad(this._cursorList)) != null ? _a28 : {}, body = this._docSkeleton.getViewModel().getDataModel().getSelfOrHeaderFooterModel(this._segmentId).getBody();\n        if (endOffset == null || body == null) return endOffset;\n        const maxLength = body.dataStream.length - 2;\n        return Math.min(endOffset, maxLength);\n    }\n    get collapsed() {\n        const { startOffset: startOffset, endOffset: endOffset } = this;\n        return startOffset != null && startOffset === endOffset;\n    }\n    get startNodePosition() {\n        if (this.anchorNodePosition == null) return null;\n        if (this.focusNodePosition == null) return this.anchorNodePosition;\n        const { start: start } = $bb9ae9d90429a70d$var$compareNodePosition(this.anchorNodePosition, this.focusNodePosition);\n        return start;\n    }\n    get endNodePosition() {\n        if (this.anchorNodePosition == null) return this.focusNodePosition;\n        if (this.focusNodePosition == null) return null;\n        const { end: end } = $bb9ae9d90429a70d$var$compareNodePosition(this.anchorNodePosition, this.focusNodePosition);\n        return end;\n    }\n    get direction() {\n        const { collapsed: collapsed, anchorNodePosition: anchorNodePosition, focusNodePosition: focusNodePosition } = this;\n        return collapsed || anchorNodePosition == null || focusNodePosition == null ? (0, $7yNYd.RANGE_DIRECTION).NONE : $bb9ae9d90429a70d$var$compareNodePositionLogic(anchorNodePosition, focusNodePosition) ? (0, $7yNYd.RANGE_DIRECTION).FORWARD : (0, $7yNYd.RANGE_DIRECTION).BACKWARD;\n    }\n    get segmentId() {\n        return this._segmentId;\n    }\n    get segmentPage() {\n        return this._segmentPage;\n    }\n    getAbsolutePosition() {\n        const anchor = this.anchorNodePosition, focus = this.focusNodePosition;\n        if (this._isEmpty()) return;\n        const documentOffsetConfig = this._document.getOffsetConfig(), { docsLeft: docsLeft, docsTop: docsTop } = documentOffsetConfig, convertor = new $bb9ae9d90429a70d$export$37b489d6b2152f0f(documentOffsetConfig, this._docSkeleton);\n        if (this._isCollapsed()) {\n            const { contentBoxPointGroup: contentBoxPointGroup, cursorList: cursorList2 } = convertor.getRangePointData(anchor, anchor);\n            if (this._setCursorList(cursorList2), contentBoxPointGroup.length === 0) return;\n            const pos2 = $bb9ae9d90429a70d$export$ea37786f3b0c02f2(contentBoxPointGroup);\n            return {\n                ...pos2,\n                left: pos2.left + docsLeft,\n                top: pos2.top + docsTop\n            };\n        }\n        const { borderBoxPointGroup: borderBoxPointGroup, cursorList: cursorList } = convertor.getRangePointData(anchor, focus);\n        if (this._setCursorList(cursorList), borderBoxPointGroup.length === 0) return;\n        const pos = $bb9ae9d90429a70d$export$ea37786f3b0c02f2(borderBoxPointGroup);\n        return {\n            ...pos,\n            left: pos.left + docsLeft,\n            top: pos.top + docsTop\n        };\n    }\n    getAnchor() {\n        return this._anchorShape;\n    }\n    activeStatic() {\n        var _a28, _b;\n        (_b = this._anchorShape) == null || _b.setProps({\n            stroke: ((_a28 = this.style) == null ? void 0 : _a28.strokeActive) || (0, $3e0Iz.getColor)((0, $7yNYd.COLORS).black, 1)\n        });\n    }\n    deactivateStatic() {\n        var _a28, _b;\n        (_b = this._anchorShape) == null || _b.setProps({\n            stroke: ((_a28 = this.style) == null ? void 0 : _a28.stroke) || (0, $3e0Iz.getColor)((0, $7yNYd.COLORS).black, 0)\n        });\n    }\n    isActive() {\n        return this._current === !0;\n    }\n    activate() {\n        this._current = !0;\n    }\n    deactivate() {\n        this._current = !1;\n    }\n    dispose() {\n        var _a28, _b;\n        (_a28 = this._rangeShape) == null || _a28.dispose(), this._rangeShape = null, (_b = this._anchorShape) == null || _b.dispose(), this._anchorShape = null, this._anchorBlinkTimer && (clearInterval(this._anchorBlinkTimer), this._anchorBlinkTimer = null);\n    }\n    isIntersection(compareRange) {\n        const { startOffset: activeStart, endOffset: activeEnd } = this, { startOffset: compareStart, endOffset: compareEnd } = compareRange;\n        return activeStart == null || activeEnd == null || compareStart == null || compareEnd == null ? !1 : activeStart <= compareEnd && activeEnd >= compareStart;\n    }\n    // render cursor and selection.\n    refresh() {\n        var _a28, _b;\n        const { _document: _document, _docSkeleton: _docSkeleton } = this, anchor = this.anchorNodePosition, focus = this.focusNodePosition;\n        if ((_a28 = this._anchorShape) == null || _a28.hide(), (_b = this._rangeShape) == null || _b.hide(), this._isEmpty()) return;\n        const documentOffsetConfig = _document.getOffsetConfig(), { docsLeft: docsLeft, docsTop: docsTop } = documentOffsetConfig, convertor = new $bb9ae9d90429a70d$export$37b489d6b2152f0f(documentOffsetConfig, _docSkeleton);\n        if (this._isCollapsed()) {\n            const { contentBoxPointGroup: contentBoxPointGroup, cursorList: cursorList2 } = convertor.getRangePointData(anchor, anchor);\n            if (this._setCursorList(cursorList2), contentBoxPointGroup.length > 0) {\n                const glyphAtCursor = _docSkeleton.findGlyphByPosition(anchor);\n                this._createOrUpdateAnchor(contentBoxPointGroup, docsLeft, docsTop, glyphAtCursor);\n            }\n            return;\n        }\n        const { borderBoxPointGroup: borderBoxPointGroup, cursorList: cursorList } = convertor.getRangePointData(anchor, focus);\n        this._setCursorList(cursorList), borderBoxPointGroup.length > 0 && this._createOrUpdateRange(borderBoxPointGroup, docsLeft, docsTop);\n    }\n    _isEmpty() {\n        return this.anchorNodePosition == null && this.focusNodePosition == null;\n    }\n    _isCollapsed() {\n        const anchor = this.anchorNodePosition, focus = this.focusNodePosition;\n        if (anchor != null && focus == null) return !0;\n        if (anchor == null || focus == null) return !1;\n        const keys = Object.keys($bb9ae9d90429a70d$var$NodePositionMap);\n        for (const key of keys){\n            const startNodeValue = anchor[key], endNodeValue = focus[key];\n            if (startNodeValue !== endNodeValue) return !1;\n        }\n        return anchor.isBack === focus.isBack;\n    }\n    _createOrUpdateRange(pointsGroup, left, top) {\n        var _a28;\n        if (this._rangeShape) {\n            this._rangeShape.translate(left, top), this._rangeShape.updatePointGroup(pointsGroup), this._rangeShape.show();\n            return;\n        }\n        const OPACITY = 0.3, polygon = new (0, $3e0Iz.RegularPolygon)($bb9ae9d90429a70d$var$TEXT_RANGE_KEY_PREFIX + (0, $7yNYd.Tools).generateRandomId($bb9ae9d90429a70d$var$ID_LENGTH$1), {\n            pointsGroup: pointsGroup,\n            fill: ((_a28 = this.style) == null ? void 0 : _a28.fill) || (0, $3e0Iz.getColor)((0, $7yNYd.COLORS).black, OPACITY),\n            left: left,\n            top: top,\n            evented: !1,\n            debounceParentDirty: !1\n        });\n        this._rangeShape = polygon, this._scene.addObject(polygon, $bb9ae9d90429a70d$export$273888e43d78d7e4);\n    }\n    _createOrUpdateAnchor(pointsGroup, docsLeft, docsTop, glyph) {\n        var _a28, _b, _c;\n        const bounding = $bb9ae9d90429a70d$export$ea37786f3b0c02f2(pointsGroup), { left: boundingLeft } = bounding;\n        let { top: boundingTop, height: height } = bounding;\n        const MIN_CURSOR_HEIGHT = 14;\n        height < MIN_CURSOR_HEIGHT && (boundingTop -= MIN_CURSOR_HEIGHT - height, height = MIN_CURSOR_HEIGHT);\n        const ITALIC_DEGREE = 12;\n        let left = boundingLeft + docsLeft;\n        const top = boundingTop + docsTop, isItalic = ((_a28 = glyph == null ? void 0 : glyph.ts) == null ? void 0 : _a28.it) === (0, $7yNYd.BooleanNumber).TRUE;\n        if (isItalic && (left += height * Math.tan(ITALIC_DEGREE * Math.PI / 180) / 2), this._anchorShape) {\n            this._anchorShape.transformByState({\n                left: left,\n                top: top,\n                height: height\n            }), this._anchorShape.show(), isItalic ? this._anchorShape.skew(-ITALIC_DEGREE, 0) : this._anchorShape.skew(0, 0);\n            return;\n        }\n        const anchor = new (0, $3e0Iz.Rect)($bb9ae9d90429a70d$var$TEXT_ANCHOR_KEY_PREFIX + (0, $7yNYd.Tools).generateRandomId($bb9ae9d90429a70d$var$ID_LENGTH$1), {\n            left: left,\n            top: top,\n            height: height,\n            strokeWidth: ((_b = this.style) == null ? void 0 : _b.strokeWidth) || 1.5,\n            stroke: ((_c = this.style) == null ? void 0 : _c.strokeActive) || (0, $3e0Iz.getColor)((0, $7yNYd.COLORS).black, 1),\n            evented: !1\n        });\n        isItalic && anchor.skew(-ITALIC_DEGREE, 0), this._anchorShape = anchor, this._scene.addObject(anchor, $bb9ae9d90429a70d$export$273888e43d78d7e4);\n    }\n    _setCursorList(cursorList) {\n        cursorList.length !== 0 && (this._cursorList = cursorList);\n    }\n};\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_TextRange, \"TextRange\");\nlet $bb9ae9d90429a70d$export$3ff5a799cbdf15f8 = $bb9ae9d90429a70d$var$_TextRange;\nconst $bb9ae9d90429a70d$var$RECT_RANGE_KEY_PREFIX = \"__DocTableRectRange__\", $bb9ae9d90429a70d$var$ID_LENGTH = 6;\nfunction $bb9ae9d90429a70d$export$6d3a9dd6e58ad5f9(scene, document2, docSkeleton, anchorNodePosition, focusNodePosition, style = (0, $3e0Iz.NORMAL_TEXT_SELECTION_PLUGIN_STYLE), segmentId = \"\", segmentPage = -1) {\n    const documentOffsetConfig = document2.getOffsetConfig(), nodePositionGroup = new $bb9ae9d90429a70d$export$ecdcda536fc542e6(documentOffsetConfig, docSkeleton).getNodePositionGroup(anchorNodePosition, focusNodePosition);\n    return (nodePositionGroup != null ? nodePositionGroup : []).map((position)=>new $bb9ae9d90429a70d$export$89d6d93b0018901c(scene, document2, docSkeleton, position.anchor, position.focus, style, segmentId, segmentPage));\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$6d3a9dd6e58ad5f9, \"convertPositionsToRectRanges\");\nconst $bb9ae9d90429a70d$var$_RectRange = class _RectRange {\n    constructor(_scene, _document, _docSkeleton, anchorNodePosition, focusNodePosition, style = (0, $3e0Iz.NORMAL_TEXT_SELECTION_PLUGIN_STYLE), _segmentId = \"\", _segmentPage = -1){\n        $bb9ae9d90429a70d$var$__publicField(this, \"rangeType\", (0, $7yNYd.DOC_RANGE_TYPE).RECT);\n        // The rendered rect range\n        $bb9ae9d90429a70d$var$__publicField(this, \"_rangeShape\");\n        // Identifies whether the range is the current one, most of which is the last range.\n        $bb9ae9d90429a70d$var$__publicField(this, \"_current\", !1);\n        // Rect Range start row.\n        $bb9ae9d90429a70d$var$__publicField(this, \"_startRow\");\n        // Rect Range start column.\n        $bb9ae9d90429a70d$var$__publicField(this, \"_startCol\");\n        // Rect Range end row.\n        $bb9ae9d90429a70d$var$__publicField(this, \"_endRow\");\n        // Rect Range end column.\n        $bb9ae9d90429a70d$var$__publicField(this, \"_endCol\");\n        // table id in view model.\n        $bb9ae9d90429a70d$var$__publicField(this, \"_tableId\");\n        this._scene = _scene, this._document = _document, this._docSkeleton = _docSkeleton, this.anchorNodePosition = anchorNodePosition, this.focusNodePosition = focusNodePosition, this.style = style, this._segmentId = _segmentId, this._segmentPage = _segmentPage, this.refresh();\n    }\n    get startOffset() {\n        const { startNodePosition: startNodePosition } = this;\n        return this._docSkeleton.findCharIndexByPosition(startNodePosition);\n    }\n    get endOffset() {\n        const { endNodePosition: endNodePosition } = this;\n        return this._docSkeleton.findCharIndexByPosition(endNodePosition);\n    }\n    get collapsed() {\n        return !1;\n    }\n    get startRow() {\n        return this._startRow;\n    }\n    get startColumn() {\n        return this._startCol;\n    }\n    get endRow() {\n        return this._endRow;\n    }\n    get endColumn() {\n        return this._endCol;\n    }\n    get tableId() {\n        return this._tableId;\n    }\n    get segmentId() {\n        return this._segmentId;\n    }\n    get segmentPage() {\n        return this._segmentPage;\n    }\n    get spanEntireRow() {\n        var _a28;\n        const table = (_a28 = this._docSkeleton.getViewModel().getSnapshot().tableSource) == null ? void 0 : _a28[this._tableId], { _startCol: _startCol, _endCol: _endCol } = this;\n        if (table == null) throw new Error(\"Table is not found.\");\n        const { tableColumns: tableColumns } = table;\n        return _startCol === 0 && _endCol === tableColumns.length - 1;\n    }\n    get spanEntireColumn() {\n        var _a28;\n        const table = (_a28 = this._docSkeleton.getViewModel().getSnapshot().tableSource) == null ? void 0 : _a28[this._tableId], { _startRow: _startRow, _endRow: _endRow } = this;\n        if (table == null) throw new Error(\"Table is not found.\");\n        const { tableRows: tableRows } = table;\n        return _startRow === 0 && _endRow === tableRows.length - 1;\n    }\n    get spanEntireTable() {\n        return this.spanEntireRow && this.spanEntireColumn;\n    }\n    get startNodePosition() {\n        const { anchorNodePosition: anchorNodePosition, focusNodePosition: focusNodePosition } = this;\n        return $bb9ae9d90429a70d$var$compareNodePositionInTable(anchorNodePosition, focusNodePosition) ? anchorNodePosition : focusNodePosition;\n    }\n    get endNodePosition() {\n        const { anchorNodePosition: anchorNodePosition, focusNodePosition: focusNodePosition } = this;\n        return $bb9ae9d90429a70d$var$compareNodePositionInTable(anchorNodePosition, focusNodePosition) ? focusNodePosition : anchorNodePosition;\n    }\n    get direction() {\n        const { anchorNodePosition: anchorNodePosition, focusNodePosition: focusNodePosition } = this;\n        return $bb9ae9d90429a70d$var$compareNodePositionInTable(anchorNodePosition, focusNodePosition) ? (0, $7yNYd.RANGE_DIRECTION).FORWARD : (0, $7yNYd.RANGE_DIRECTION).BACKWARD;\n    }\n    isActive() {\n        return this._current === !0;\n    }\n    activate() {\n        this._current = !0;\n    }\n    deactivate() {\n        this._current = !1;\n    }\n    dispose() {\n        var _a28;\n        (_a28 = this._rangeShape) == null || _a28.dispose(), this._rangeShape = null;\n    }\n    isIntersection(compareRange) {\n        const { startRow: startRow, startColumn: startColumn, endRow: endRow, endColumn: endColumn } = this, { startRow: cStartRow, startColumn: cStartColumn, endRow: cEndRow, endColumn: cEndColumn } = compareRange, rect1 = {\n            left: startColumn,\n            top: startRow,\n            right: endColumn,\n            bottom: endRow\n        }, rect2 = {\n            left: cStartColumn,\n            top: cStartRow,\n            right: cEndColumn,\n            bottom: cEndRow\n        };\n        return (0, $7yNYd.Rectangle).hasIntersectionBetweenTwoRect(rect1, rect2);\n    }\n    refresh() {\n        var _a28;\n        (_a28 = this._rangeShape) == null || _a28.hide();\n        const { startNodePosition: startNodePosition, endNodePosition: endNodePosition, _document: _document, _docSkeleton: _docSkeleton } = this, documentOffsetConfig = _document.getOffsetConfig(), { docsLeft: docsLeft, docsTop: docsTop } = documentOffsetConfig, rectInfo = new $bb9ae9d90429a70d$export$ecdcda536fc542e6(documentOffsetConfig, _docSkeleton).getRangePointData(startNodePosition, endNodePosition);\n        if (rectInfo == null) return;\n        const { pointGroup: pointGroup = [], startRow: startRow, endRow: endRow, startColumn: startColumn, endColumn: endColumn, tableId: tableId } = rectInfo;\n        (pointGroup == null ? void 0 : pointGroup.length) > 0 && this._createOrUpdateRange(pointGroup, docsLeft, docsTop), this._updateTableInfo(startRow, endRow, startColumn, endColumn, tableId);\n    }\n    _updateTableInfo(startRow, endRow, startCol, endCol, tableId) {\n        this._startRow = startRow, this._endRow = endRow, this._startCol = startCol, this._endCol = endCol, this._tableId = tableId;\n    }\n    _createOrUpdateRange(pointsGroup, left, top) {\n        var _a28;\n        if (this._rangeShape) {\n            this._rangeShape.translate(left, top), this._rangeShape.updatePointGroup(pointsGroup), this._rangeShape.show();\n            return;\n        }\n        const OPACITY = 0.3, polygon = new (0, $3e0Iz.RegularPolygon)($bb9ae9d90429a70d$var$RECT_RANGE_KEY_PREFIX + (0, $7yNYd.Tools).generateRandomId($bb9ae9d90429a70d$var$ID_LENGTH), {\n            pointsGroup: pointsGroup,\n            fill: ((_a28 = this.style) == null ? void 0 : _a28.fill) || (0, $3e0Iz.getColor)((0, $7yNYd.COLORS).black, OPACITY),\n            left: left,\n            top: top,\n            evented: !1,\n            debounceParentDirty: !1\n        });\n        this._rangeShape = polygon, this._scene.addObject(polygon, $bb9ae9d90429a70d$export$273888e43d78d7e4);\n    }\n};\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_RectRange, \"RectRange\");\nlet $bb9ae9d90429a70d$export$89d6d93b0018901c = $bb9ae9d90429a70d$var$_RectRange;\nfunction $bb9ae9d90429a70d$var$getTextRangeFromCharIndex(startOffset, endOffset, scene, document2, skeleton, style, segmentId, segmentPage) {\n    const startNodePosition = skeleton.findNodePositionByCharIndex(startOffset, !0, segmentId, segmentPage), endNodePosition = skeleton.findNodePositionByCharIndex(endOffset, !0, segmentId, segmentPage);\n    if (!(startNodePosition == null || endNodePosition == null)) return new $bb9ae9d90429a70d$export$3ff5a799cbdf15f8(scene, document2, skeleton, startNodePosition, endNodePosition, style, segmentId, segmentPage);\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getTextRangeFromCharIndex, \"getTextRangeFromCharIndex\");\nfunction $bb9ae9d90429a70d$var$getRectRangeFromCharIndex(startOffset, endOffset, scene, document2, skeleton, style, segmentId, segmentPage) {\n    const startNodePosition = skeleton.findNodePositionByCharIndex(startOffset, !0, segmentId, segmentPage), endNodePosition = skeleton.findNodePositionByCharIndex(endOffset, !0, segmentId, segmentPage);\n    if (!(startNodePosition == null || endNodePosition == null)) return new $bb9ae9d90429a70d$export$89d6d93b0018901c(scene, document2, skeleton, startNodePosition, endNodePosition, style, segmentId, segmentPage);\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getRectRangeFromCharIndex, \"getRectRangeFromCharIndex\");\nfunction $bb9ae9d90429a70d$var$getRangeListFromCharIndex(startOffset, endOffset, scene, document2, skeleton, style, segmentId, segmentPage) {\n    const startNodePosition = skeleton.findNodePositionByCharIndex(startOffset, !0, segmentId, segmentPage), endNodePosition = skeleton.findNodePositionByCharIndex(endOffset, !0, segmentId, segmentPage);\n    if (!(startNodePosition == null || endNodePosition == null)) return $bb9ae9d90429a70d$var$getRangeListFromSelection(startNodePosition, endNodePosition, scene, document2, skeleton, style, segmentId, segmentPage);\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getRangeListFromCharIndex, \"getRangeListFromCharIndex\");\nfunction $bb9ae9d90429a70d$var$getRangeListFromSelection(anchorPosition, focusPosition, scene, document2, skeleton, style, segmentId, segmentPage) {\n    const textRanges = [], rectRanges = [], rangeParams = [\n        scene,\n        document2,\n        skeleton,\n        anchorPosition,\n        focusPosition,\n        style,\n        segmentId,\n        segmentPage\n    ];\n    if ($bb9ae9d90429a70d$export$57d2e8d2118a89(anchorPosition, focusPosition)) return textRanges.push(new $bb9ae9d90429a70d$export$3ff5a799cbdf15f8(...rangeParams)), {\n        textRanges: textRanges,\n        rectRanges: rectRanges\n    };\n    if ($bb9ae9d90429a70d$export$d6b48af136414a10(anchorPosition, focusPosition)) {\n        const ranges = $bb9ae9d90429a70d$export$6d3a9dd6e58ad5f9(...rangeParams);\n        return rectRanges.push(...ranges), {\n            textRanges: textRanges,\n            rectRanges: rectRanges\n        };\n    }\n    const viewModel = skeleton.getViewModel().getSelfOrHeaderFooterViewModel(segmentId), anchorOffset = skeleton.findCharIndexByPosition(anchorPosition), focusOffset = skeleton.findCharIndexByPosition(focusPosition);\n    if (anchorOffset == null || focusOffset == null) return;\n    const direction = anchorOffset <= focusOffset ? (0, $7yNYd.RANGE_DIRECTION).FORWARD : (0, $7yNYd.RANGE_DIRECTION).BACKWARD, startOffset = Math.min(anchorOffset, focusOffset), endOffset = Math.max(anchorOffset, focusOffset);\n    let start = startOffset, end = endOffset;\n    for (const section of viewModel.children)for (const paragraph of section.children){\n        const { startIndex: startIndex, endIndex: endIndex, children: children } = paragraph, table = children[0];\n        let endInTable = !1;\n        if (table) {\n            const { startIndex: tableStart, endIndex: tableEnd, children: children2 } = table;\n            let tableStartPosition = null, tableEndPosition = null;\n            const startRow = children2.find((row)=>row.startIndex <= startOffset && row.endIndex >= startOffset), endRow = children2.find((row)=>row.startIndex <= endOffset && row.endIndex >= endOffset);\n            if (startOffset > tableStart && startOffset < tableEnd) tableStartPosition = skeleton.findNodePositionByCharIndex(startRow.startIndex + 2, !0, segmentId, segmentPage), tableEndPosition = skeleton.findNodePositionByCharIndex(tableEnd - 4, !0, segmentId, segmentPage), start = tableEnd + 1;\n            else if (endOffset > tableStart && endOffset < tableEnd) tableStartPosition = skeleton.findNodePositionByCharIndex(tableStart + 3, !0, segmentId, segmentPage), tableEndPosition = skeleton.findNodePositionByCharIndex(endRow.endIndex - 3, !0, segmentId, segmentPage), end = tableStart - 1, endInTable = !0;\n            else if (tableStart > startOffset && tableEnd < endOffset) {\n                if (tableStartPosition = skeleton.findNodePositionByCharIndex(tableStart + 3, !0, segmentId, segmentPage), tableEndPosition = skeleton.findNodePositionByCharIndex(tableEnd - 4, !0, segmentId, segmentPage), start <= tableStart - 1) {\n                    const sp = skeleton.findNodePositionByCharIndex(start, !0, segmentId, segmentPage), ep = skeleton.findNodePositionByCharIndex(tableStart - 1, !1, segmentId, segmentPage), ap = direction === (0, $7yNYd.RANGE_DIRECTION).FORWARD ? sp : ep, fp = direction === (0, $7yNYd.RANGE_DIRECTION).FORWARD ? ep : sp;\n                    textRanges.push(new $bb9ae9d90429a70d$export$3ff5a799cbdf15f8(scene, document2, skeleton, ap, fp, style, segmentId, segmentPage));\n                }\n                start = tableEnd + 1;\n            }\n            if (tableStartPosition && tableEndPosition) {\n                const ap = direction === (0, $7yNYd.RANGE_DIRECTION).FORWARD ? tableStartPosition : tableEndPosition, fp = direction === (0, $7yNYd.RANGE_DIRECTION).FORWARD ? tableEndPosition : tableStartPosition;\n                rectRanges.push(...$bb9ae9d90429a70d$export$6d3a9dd6e58ad5f9(scene, document2, skeleton, ap, fp, style, segmentId, segmentPage));\n            }\n        }\n        if (end >= startIndex && end <= endIndex || endInTable) {\n            const sp = skeleton.findNodePositionByCharIndex(start, !0, segmentId, segmentPage), ep = skeleton.findNodePositionByCharIndex(end, !endInTable, segmentId, segmentPage), ap = direction === (0, $7yNYd.RANGE_DIRECTION).FORWARD ? sp : ep, fp = direction === (0, $7yNYd.RANGE_DIRECTION).FORWARD ? ep : sp;\n            if (rectRanges.length && (0, $7yNYd.Tools).diffValue(ap, fp)) continue;\n            textRanges.push(new $bb9ae9d90429a70d$export$3ff5a799cbdf15f8(scene, document2, skeleton, ap, fp, style, segmentId, segmentPage));\n        }\n    }\n    return {\n        textRanges: textRanges,\n        rectRanges: rectRanges\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getRangeListFromSelection, \"getRangeListFromSelection\");\nfunction $bb9ae9d90429a70d$export$dba4bbd052c086b8(engine) {\n    const canvas = engine == null ? void 0 : engine.getCanvasElement();\n    if (!canvas) return {\n        left: 0,\n        top: 0\n    };\n    const { top: top, left: left } = (0, $3e0Iz.getOffsetRectForDom)(canvas);\n    return {\n        left: left,\n        top: top\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$dba4bbd052c086b8, \"getCanvasOffsetByEngine\");\nfunction $bb9ae9d90429a70d$var$getParagraphInfoByGlyph(node) {\n    var _a28;\n    const line = (_a28 = node.parent) == null ? void 0 : _a28.parent, column = line == null ? void 0 : line.parent;\n    if (line == null || column == null) return;\n    const { paragraphIndex: paragraphIndex } = line, lines = column.lines.filter((line2)=>line2.paragraphIndex === paragraphIndex);\n    let nodeIndex = -1, content = \"\", hasFound = !1;\n    for (const line2 of lines)for (const divide of line2.divides)for (const glyph of divide.glyphGroup)hasFound || (nodeIndex += glyph.count), glyph === node && (hasFound = !0), content += glyph.count > 0 ? glyph.content : \"\";\n    return {\n        st: lines[0].st,\n        ed: paragraphIndex,\n        content: content,\n        nodeIndex: nodeIndex\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getParagraphInfoByGlyph, \"getParagraphInfoByGlyph\");\nfunction $bb9ae9d90429a70d$var$serializeTextRange(textRange) {\n    const { startOffset: startOffset, endOffset: endOffset, collapsed: collapsed, rangeType: rangeType, startNodePosition: startNodePosition, endNodePosition: endNodePosition, direction: direction, segmentId: segmentId, segmentPage: segmentPage } = textRange;\n    return {\n        startOffset: startOffset,\n        endOffset: endOffset,\n        collapsed: collapsed,\n        rangeType: rangeType,\n        startNodePosition: startNodePosition,\n        endNodePosition: endNodePosition,\n        direction: direction,\n        segmentId: segmentId,\n        segmentPage: segmentPage,\n        isActive: textRange.isActive()\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$serializeTextRange, \"serializeTextRange\");\nfunction $bb9ae9d90429a70d$var$serializeRectRange(rectRange) {\n    const serializedTextRange = $bb9ae9d90429a70d$var$serializeTextRange(rectRange), { startRow: startRow, startColumn: startColumn, endRow: endRow, endColumn: endColumn, tableId: tableId, spanEntireRow: spanEntireRow, spanEntireColumn: spanEntireColumn, spanEntireTable: spanEntireTable } = rectRange;\n    return {\n        ...serializedTextRange,\n        startRow: startRow,\n        startColumn: startColumn,\n        endRow: endRow,\n        endColumn: endColumn,\n        tableId: tableId,\n        spanEntireRow: spanEntireRow,\n        spanEntireColumn: spanEntireColumn,\n        spanEntireTable: spanEntireTable\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$serializeRectRange, \"serializeRectRange\");\nvar $bb9ae9d90429a70d$var$__defProp$o = Object.defineProperty, $bb9ae9d90429a70d$var$__getOwnPropDesc$o = Object.getOwnPropertyDescriptor, $bb9ae9d90429a70d$var$__decorateClass$o = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((decorators, target, key, kind)=>{\n    for(var result = kind > 1 ? void 0 : kind ? $bb9ae9d90429a70d$var$__getOwnPropDesc$o(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)(decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n    return kind && result && $bb9ae9d90429a70d$var$__defProp$o(target, key, result), result;\n}, \"__decorateClass$o\"), $bb9ae9d90429a70d$var$__decorateParam$o = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((index, decorator)=>(target, key)=>decorator(target, key, index), \"__decorateParam$o\"), $bb9ae9d90429a70d$var$_a3;\nlet $bb9ae9d90429a70d$export$6dc2db33d8a277cd = ($bb9ae9d90429a70d$var$_a3 = class extends (0, $7yNYd.RxDisposable) {\n    constructor(_context, _layoutService, _logService, _docSkeletonManagerService){\n        super();\n        $bb9ae9d90429a70d$var$__publicField(this, \"_onInputBefore$\", new (0, $1mjSk.Subject)());\n        $bb9ae9d90429a70d$var$__publicField(this, \"onInputBefore$\", this._onInputBefore$.asObservable());\n        $bb9ae9d90429a70d$var$__publicField(this, \"_onKeydown$\", new (0, $5LPkb.BehaviorSubject)(null));\n        $bb9ae9d90429a70d$var$__publicField(this, \"onKeydown$\", this._onKeydown$.asObservable());\n        $bb9ae9d90429a70d$var$__publicField(this, \"_onInput$\", new (0, $5LPkb.BehaviorSubject)(null));\n        $bb9ae9d90429a70d$var$__publicField(this, \"onInput$\", this._onInput$.asObservable());\n        $bb9ae9d90429a70d$var$__publicField(this, \"_onCompositionstart$\", new (0, $5LPkb.BehaviorSubject)(null));\n        $bb9ae9d90429a70d$var$__publicField(this, \"onCompositionstart$\", this._onCompositionstart$.asObservable());\n        $bb9ae9d90429a70d$var$__publicField(this, \"_onCompositionupdate$\", new (0, $5LPkb.BehaviorSubject)(null));\n        $bb9ae9d90429a70d$var$__publicField(this, \"onCompositionupdate$\", this._onCompositionupdate$.asObservable());\n        $bb9ae9d90429a70d$var$__publicField(this, \"_onCompositionend$\", new (0, $5LPkb.BehaviorSubject)(null));\n        $bb9ae9d90429a70d$var$__publicField(this, \"onCompositionend$\", this._onCompositionend$.asObservable());\n        $bb9ae9d90429a70d$var$__publicField(this, \"_onSelectionStart$\", new (0, $5LPkb.BehaviorSubject)(null));\n        $bb9ae9d90429a70d$var$__publicField(this, \"onSelectionStart$\", this._onSelectionStart$.asObservable());\n        $bb9ae9d90429a70d$var$__publicField(this, \"_onPaste$\", new (0, $1mjSk.Subject)());\n        $bb9ae9d90429a70d$var$__publicField(this, \"onPaste$\", this._onPaste$.asObservable());\n        $bb9ae9d90429a70d$var$__publicField(this, \"_textSelectionInner$\", new (0, $5LPkb.BehaviorSubject)(null));\n        $bb9ae9d90429a70d$var$__publicField(this, \"textSelectionInner$\", this._textSelectionInner$.asObservable());\n        $bb9ae9d90429a70d$var$__publicField(this, \"_onFocus$\", new (0, $1mjSk.Subject)());\n        $bb9ae9d90429a70d$var$__publicField(this, \"onFocus$\", this._onFocus$.asObservable());\n        $bb9ae9d90429a70d$var$__publicField(this, \"_onBlur$\", new (0, $1mjSk.Subject)());\n        $bb9ae9d90429a70d$var$__publicField(this, \"onBlur$\", this._onBlur$.asObservable());\n        $bb9ae9d90429a70d$var$__publicField(this, \"_onPointerDown$\", new (0, $1mjSk.Subject)());\n        $bb9ae9d90429a70d$var$__publicField(this, \"onPointerDown$\", this._onPointerDown$.asObservable());\n        $bb9ae9d90429a70d$var$__publicField(this, \"_container\");\n        $bb9ae9d90429a70d$var$__publicField(this, \"_inputParent\");\n        $bb9ae9d90429a70d$var$__publicField(this, \"_input\");\n        $bb9ae9d90429a70d$var$__publicField(this, \"_scrollTimers\", []);\n        $bb9ae9d90429a70d$var$__publicField(this, \"_rangeList\", []);\n        // Use to cache range list in moving.\n        $bb9ae9d90429a70d$var$__publicField(this, \"_rangeListCache\", []);\n        // Rect range list.\n        $bb9ae9d90429a70d$var$__publicField(this, \"_rectRangeList\", []);\n        // Use to cache rect range list in moving.\n        $bb9ae9d90429a70d$var$__publicField(this, \"_rectRangeListCache\", []);\n        $bb9ae9d90429a70d$var$__publicField(this, \"_anchorNodePosition\", null);\n        $bb9ae9d90429a70d$var$__publicField(this, \"_focusNodePosition\", null);\n        $bb9ae9d90429a70d$var$__publicField(this, \"_currentSegmentId\", \"\");\n        $bb9ae9d90429a70d$var$__publicField(this, \"_currentSegmentPage\", -1);\n        $bb9ae9d90429a70d$var$__publicField(this, \"_selectionStyle\", (0, $3e0Iz.NORMAL_TEXT_SELECTION_PLUGIN_STYLE));\n        $bb9ae9d90429a70d$var$__publicField(this, \"_viewPortObserverMap\", /* @__PURE__ */ new Map());\n        $bb9ae9d90429a70d$var$__publicField(this, \"_isIMEInputApply\", !1);\n        $bb9ae9d90429a70d$var$__publicField(this, \"_scenePointerMoveSubs\", []);\n        $bb9ae9d90429a70d$var$__publicField(this, \"_scenePointerUpSubs\", []);\n        $bb9ae9d90429a70d$var$__publicField(this, \"_editorFocusing\", !0);\n        this._context = _context, this._layoutService = _layoutService, this._logService = _logService, this._docSkeletonManagerService = _docSkeletonManagerService, this._initDOM(), this._registerContainer(), this._setSystemHighlightColorToStyle();\n    }\n    get activeViewPort() {\n        return this._context.scene.getViewports()[0];\n    }\n    setSegment(id) {\n        this._currentSegmentId = id;\n    }\n    getSegment() {\n        return this._currentSegmentId;\n    }\n    setSegmentPage(pageIndex) {\n        this._currentSegmentPage = pageIndex;\n    }\n    getSegmentPage() {\n        return this._currentSegmentPage;\n    }\n    _setRangeStyle(style = (0, $3e0Iz.NORMAL_TEXT_SELECTION_PLUGIN_STYLE)) {\n        this._selectionStyle = style;\n    }\n    addDocRanges(ranges, isEditing = !0, options) {\n        const { _currentSegmentId: segmentId, _currentSegmentPage: segmentPage, _selectionStyle: style } = this, { scene: scene, mainComponent: mainComponent } = this._context, document2 = mainComponent, docSkeleton = this._docSkeletonManagerService.getSkeleton();\n        for (const range of ranges){\n            const { startOffset: startOffset, endOffset: endOffset, rangeType: rangeType } = range;\n            if (rangeType === (0, $7yNYd.DOC_RANGE_TYPE).RECT) {\n                const rectRange = $bb9ae9d90429a70d$var$getRectRangeFromCharIndex(startOffset, endOffset, scene, document2, docSkeleton, style, segmentId, segmentPage);\n                rectRange && this._addRectRanges([\n                    rectRange\n                ]);\n            } else if (rangeType === (0, $7yNYd.DOC_RANGE_TYPE).TEXT) {\n                const textRange = $bb9ae9d90429a70d$var$getTextRangeFromCharIndex(startOffset, endOffset, scene, document2, docSkeleton, style, segmentId, segmentPage);\n                textRange && this._addTextRange(textRange);\n            } else {\n                const rangeList = $bb9ae9d90429a70d$var$getRangeListFromCharIndex(startOffset, endOffset, scene, document2, docSkeleton, style, segmentId, segmentPage);\n                if (rangeList == null) continue;\n                const { textRanges: textRanges, rectRanges: rectRanges } = rangeList;\n                for (const textRange of textRanges)this._addTextRange(textRange);\n                this._addRectRanges(rectRanges);\n            }\n        }\n        this._textSelectionInner$.next({\n            textRanges: this._getAllTextRanges(),\n            rectRanges: this._getAllRectRanges(),\n            segmentId: segmentId,\n            segmentPage: segmentPage,\n            style: style,\n            isEditing: isEditing,\n            options: options\n        }), this._updateInputPosition(options == null ? void 0 : options.forceFocus);\n    }\n    setCursorManually(evtOffsetX, evtOffsetY) {\n        const startNode = this._findNodeByCoord(evtOffsetX, evtOffsetY, {\n            strict: !0,\n            segmentId: this._currentSegmentId,\n            segmentPage: this._currentSegmentPage\n        }), position = this._getNodePosition(startNode);\n        if (position == null) {\n            this._removeAllRanges();\n            return;\n        }\n        (startNode == null ? void 0 : startNode.node.streamType) === (0, $7yNYd.DataStreamTreeTokenType).PARAGRAPH && (position.isBack = !0), this._createTextRangeByAnchorPosition(position), this._textSelectionInner$.next({\n            textRanges: this._getAllTextRanges(),\n            rectRanges: this._getAllRectRanges(),\n            segmentId: this._currentSegmentId,\n            segmentPage: this._currentSegmentPage,\n            style: this._selectionStyle,\n            isEditing: !1\n        });\n    }\n    // Sync canvas selection to dom selection.\n    sync() {\n        this._updateInputPosition();\n    }\n    activate(x, y, force = !1) {\n        const isFocusing = this._input === document.activeElement;\n        this._container.style.left = `${x}px`, this._container.style.top = `${y}px`, this._container.style.zIndex = \"1000\", (isFocusing || force) && this.focus();\n    }\n    hasFocus() {\n        return document.activeElement === this._input;\n    }\n    focus() {\n        this._editorFocusing && this._input.focus();\n    }\n    blur() {\n        this._input.blur();\n    }\n    focusEditor() {\n        this._editorFocusing = !0, this.focus();\n    }\n    blurEditor() {\n        this._editorFocusing = !1, this.blur();\n    }\n    // FIXME: for editor cell editor we don't need to blur the input element\n    deactivate() {\n        this._container.style.left = \"0px\", this._container.style.top = \"0px\";\n    }\n    // Handler double click.\n    __handleDblClick(evt) {\n        const { offsetX: evtOffsetX, offsetY: evtOffsetY } = evt, startNode = this._findNodeByCoord(evtOffsetX, evtOffsetY, {\n            strict: !1,\n            segmentId: this._currentSegmentId,\n            segmentPage: this._currentSegmentPage\n        });\n        if (startNode == null || startNode.node == null) return;\n        const paragraphInfo = $bb9ae9d90429a70d$var$getParagraphInfoByGlyph(startNode.node);\n        if (paragraphInfo == null) return;\n        const { content: content, st: st, nodeIndex: nodeIndex } = paragraphInfo;\n        if (nodeIndex === -1 || Intl.Segmenter == null) return;\n        const segments = new Intl.Segmenter(void 0, {\n            granularity: \"word\"\n        }).segment(content);\n        let startOffset = Number.NEGATIVE_INFINITY, endOffset = Number.NEGATIVE_INFINITY;\n        for (const { segment: segment, index: index, isWordLike: isWordLike } of segments)if (index <= nodeIndex && nodeIndex < index + segment.length && isWordLike) {\n            startOffset = index + st, endOffset = index + st + segment.length;\n            break;\n        }\n        if (Number.isFinite(startOffset) && Number.isFinite(endOffset)) {\n            this.removeAllRanges();\n            const textRanges = [\n                {\n                    startOffset: startOffset,\n                    endOffset: endOffset\n                }\n            ];\n            this.addDocRanges(textRanges, !1, {\n                forceFocus: !0\n            });\n        }\n    }\n    __handleTripleClick(evt) {\n        const { offsetX: evtOffsetX, offsetY: evtOffsetY } = evt, startNode = this._findNodeByCoord(evtOffsetX, evtOffsetY, {\n            strict: !1,\n            segmentId: this._currentSegmentId,\n            segmentPage: this._currentSegmentPage\n        });\n        if (startNode == null || startNode.node == null) return;\n        const paragraphInfo = $bb9ae9d90429a70d$var$getParagraphInfoByGlyph(startNode.node);\n        if (paragraphInfo == null) return;\n        this.removeAllRanges();\n        const { st: st, ed: ed } = paragraphInfo, textRanges = [\n            {\n                startOffset: st,\n                endOffset: ed\n            }\n        ];\n        this.addDocRanges(textRanges, !1, {\n            forceFocus: !0\n        });\n    }\n    // Handle pointer down.\n    // eslint-disable-next-line max-lines-per-function, complexity\n    __onPointDown(evt) {\n        var _a28, _b;\n        this._editorFocusing = !0;\n        const { scene: scene, mainComponent: mainComponent } = this._context, skeleton = this._docSkeletonManagerService.getSkeleton(), { offsetX: evtOffsetX, offsetY: evtOffsetY } = evt, startNode = this._findNodeByCoord(evtOffsetX, evtOffsetY, {\n            strict: !1,\n            segmentId: this._currentSegmentId,\n            segmentPage: this._currentSegmentPage\n        }), position = this._getNodePosition(startNode);\n        if (position == null || startNode == null) {\n            this._removeAllRanges();\n            return;\n        }\n        (startNode == null ? void 0 : startNode.node.streamType) === (0, $7yNYd.DataStreamTreeTokenType).PARAGRAPH && (position.isBack = !0);\n        const docSelection = this._textSelectionInner$.value;\n        if (startNode && evt.button === 2 && docSelection) {\n            const nodeCharIndex = skeleton.findCharIndexByPosition(position);\n            if (typeof nodeCharIndex == \"number\" && docSelection.textRanges.some((textRange)=>textRange.startOffset <= nodeCharIndex && textRange.endOffset > nodeCharIndex) || typeof nodeCharIndex == \"number\" && docSelection.rectRanges.some((rectRange)=>rectRange.startOffset <= nodeCharIndex && rectRange.endOffset >= nodeCharIndex)) return;\n        }\n        const { segmentId: segmentId, segmentPage: segmentPage } = startNode;\n        segmentId && this._currentSegmentId && segmentId !== this._currentSegmentId && this.setSegment(segmentId), segmentId && segmentPage !== this._currentSegmentPage && this.setSegmentPage(segmentPage), this._anchorNodePosition = position, evt.shiftKey && this._getActiveRangeInstance() ? this._updateActiveRangePosition(position) : !evt.ctrlKey && !this._isEmpty() && this._removeAllRanges(), scene.disableObjectsEvent();\n        const scrollTimer = (0, $3e0Iz.ScrollTimer).create(scene);\n        this._scrollTimers.push(scrollTimer), scrollTimer.startScroll(evtOffsetX, evtOffsetY), this._onSelectionStart$.next((_a28 = this._getActiveRangeInstance()) == null ? void 0 : _a28.startNodePosition), (_b = scene.getTransformer()) == null || _b.clearSelectedObjects();\n        let preMoveOffsetX = evtOffsetX, preMoveOffsetY = evtOffsetY;\n        this._scenePointerMoveSubs.push(scene.onPointerMove$.subscribeEvent((moveEvt)=>{\n            const { offsetX: moveOffsetX, offsetY: moveOffsetY } = moveEvt;\n            scene.setCursor((0, $3e0Iz.CURSOR_TYPE).TEXT), !(Math.sqrt((moveOffsetX - preMoveOffsetX) ** 2 + (moveOffsetY - preMoveOffsetY) ** 2) < 3) && (this._moving(moveOffsetX, moveOffsetY), scrollTimer.scrolling(moveOffsetX, moveOffsetY, ()=>{\n                this._moving(moveOffsetX, moveOffsetY);\n            }), preMoveOffsetX = moveOffsetX, preMoveOffsetY = moveOffsetY);\n        })), this._scenePointerUpSubs.push(scene.onPointerUp$.subscribeEvent(()=>{\n            if ([\n                ...this._scenePointerMoveSubs,\n                ...this._scenePointerUpSubs\n            ].forEach((e)=>{\n                e.unsubscribe();\n            }), scene.enableObjectsEvent(), this._anchorNodePosition && !this._focusNodePosition) {\n                const textRange = new $bb9ae9d90429a70d$export$3ff5a799cbdf15f8(scene, mainComponent, skeleton, this._anchorNodePosition, void 0, this._selectionStyle, this._currentSegmentId, this._currentSegmentPage);\n                this._addTextRange(textRange);\n            } else if (this._anchorNodePosition && this._focusNodePosition) {\n                for (const textRange of this._rangeListCache)this._addTextRange(textRange);\n                this._addRectRanges(this._rectRangeListCache), this._rangeListCache = [], this._rectRangeListCache = [];\n            }\n            this._anchorNodePosition = null, this._focusNodePosition = null;\n            const selectionInfo = {\n                textRanges: this._getAllTextRanges(),\n                rectRanges: this._getAllRectRanges(),\n                segmentId: this._currentSegmentId,\n                segmentPage: this._currentSegmentPage,\n                style: this._selectionStyle,\n                isEditing: !1\n            };\n            this._textSelectionInner$.next(selectionInfo), this._scrollTimers.forEach((timer)=>{\n                timer == null || timer.dispose();\n            }), this._scrollTimers = [], this._updateInputPosition(!0);\n        }));\n    }\n    removeAllRanges() {\n        this._removeAllRanges(), this.deactivate();\n    }\n    getActiveTextRange() {\n        return this._getActiveRangeInstance();\n    }\n    _setSystemHighlightColorToStyle() {\n        const { r: r, g: g, b: b, a: a } = (0, $3e0Iz.getSystemHighlightColor)(), style = {\n            strokeWidth: 1.5,\n            stroke: \"rgba(0, 0, 0, 0)\",\n            strokeActive: \"rgba(0, 0, 0, 1)\",\n            fill: `rgba(${r}, ${g}, ${b}, ${a != null ? a : 0.3})`\n        };\n        this._setRangeStyle(style);\n    }\n    _getAllTextRanges() {\n        return this._rangeList.map($bb9ae9d90429a70d$var$serializeTextRange);\n    }\n    _getAllRectRanges() {\n        return this._rectRangeList.map($bb9ae9d90429a70d$var$serializeRectRange);\n    }\n    _getActiveRange() {\n        const activeRange = this._rangeList.find((range)=>range.isActive());\n        if (activeRange == null) return null;\n        const { startOffset: startOffset, endOffset: endOffset } = activeRange;\n        return startOffset == null || endOffset == null ? null : $bb9ae9d90429a70d$var$serializeTextRange(activeRange);\n    }\n    _getActiveRangeInstance() {\n        return this._rangeList.find((range)=>range.isActive());\n    }\n    dispose() {\n        super.dispose(), this._detachEvent(), this._removeAllRanges(), this._container.remove();\n    }\n    _initDOM() {\n        const { unitId: unitId } = this._context, container = document.createElement(\"div\");\n        container.style.position = \"fixed\", container.style.left = \"0px\", container.style.top = \"0px\", container.id = `univer-doc-selection-container-${unitId}`;\n        const inputParent = document.createElement(\"div\"), inputDom = document.createElement(\"div\");\n        inputParent.appendChild(inputDom), container.appendChild(inputParent), this._container = container, this._inputParent = inputParent, this._input = inputDom, this._initInput(), this._initInputEvents(), document.body.appendChild(container);\n    }\n    _registerContainer() {\n        this.disposeWithMe(// the content editable div should be regarded as part of the applications container\n        this._layoutService.registerContainerElement(this._container));\n    }\n    _initInput() {\n        this._inputParent.style.cssText = `\n            position:absolute;\n            height:1px;\n            width:1px;\n            overflow: hidden;\n        `, this._input.contentEditable = \"true\", this._input.classList.add(\"univer-editor\"), this._input.style.cssText = `\n            position: absolute;\n            overflow: hidden;\n            opacity: 1;\n            background: #000;\n            color: transparent;\n            outline: none;\n            z-index: -2;\n            caret-color: transparent;\n            white-space: pre-wrap;\n            user-select: text;\n        `;\n    }\n    _getNodePosition(node) {\n        if (node == null) return;\n        const { node: glyph, ratioX: ratioX, segmentPage: segmentPage } = node, position = this._docSkeletonManagerService.getSkeleton().findPositionByGlyph(glyph, segmentPage);\n        if (position == null) return;\n        const isBack = ratioX < 0.5;\n        return {\n            ...position,\n            isBack: isBack\n        };\n    }\n    _interactTextRanges(textRanges) {\n        const newTextRanges = [];\n        for (const range of this._rangeList){\n            if (textRanges.some((textRange)=>textRange.isIntersection(range))) {\n                range.dispose();\n                continue;\n            }\n            newTextRanges.push(range);\n        }\n        this._rangeList = newTextRanges;\n    }\n    _interactRectRanges(rectRanges) {\n        const newRanges = [];\n        for (const range of this._rectRangeList){\n            if (rectRanges.some((rectRange)=>rectRange.isIntersection(range))) {\n                range.dispose();\n                continue;\n            }\n            newRanges.push(range);\n        }\n        this._rectRangeList = newRanges;\n    }\n    _removeAllRanges() {\n        this._removeAllTextRanges(), this._removeAllRectRanges();\n    }\n    _removeAllCacheRanges() {\n        this._rangeListCache.forEach((range)=>{\n            range.dispose();\n        }), this._rectRangeListCache.forEach((range)=>{\n            range.dispose();\n        }), this._rangeListCache = [], this._rectRangeListCache = [];\n    }\n    _removeAllTextRanges() {\n        this._rangeList.forEach((range)=>{\n            range.dispose();\n        }), this._rangeList = [];\n    }\n    _removeAllRectRanges() {\n        this._rectRangeList.forEach((range)=>{\n            range.dispose();\n        }), this._rectRangeList = [];\n    }\n    _deactivateAllTextRanges() {\n        this._rangeList.forEach((range)=>{\n            range.deactivate();\n        });\n    }\n    _deactivateAllRectRanges() {\n        this._rectRangeList.forEach((range)=>{\n            range.deactivate();\n        });\n    }\n    _addTextRangesToCache(textRanges) {\n        this._rangeListCache.push(...textRanges);\n    }\n    _addTextRange(textRange) {\n        this._deactivateAllTextRanges(), textRange.activate(), this._rangeList.push(textRange);\n    }\n    _addRectRangesToCache(rectRanges) {\n        this._rectRangeListCache.push(...rectRanges);\n    }\n    _addRectRanges(rectRanges) {\n        rectRanges.length !== 0 && (this._deactivateAllRectRanges(), rectRanges[rectRanges.length - 1].activate(), this._rectRangeList.push(...rectRanges));\n    }\n    _createTextRangeByAnchorPosition(position) {\n        this._removeAllRanges();\n        const { scene: scene, mainComponent: mainComponent } = this._context, skeleton = this._docSkeletonManagerService.getSkeleton(), lastRange = new $bb9ae9d90429a70d$export$3ff5a799cbdf15f8(scene, mainComponent, skeleton, position, void 0, this._selectionStyle, this._currentSegmentId, this._currentSegmentPage);\n        this._addTextRange(lastRange);\n    }\n    _updateActiveRangePosition(position) {\n        const activeTextRange = this._getActiveRangeInstance();\n        if (activeTextRange == null || activeTextRange.anchorNodePosition == null) {\n            this._logService.error(\"[DocSelectionRenderService] _updateActiveRangeFocusPosition: active range has no anchor\");\n            return;\n        }\n        this._removeAllRanges(), this._anchorNodePosition = activeTextRange.anchorNodePosition, this._focusNodePosition = position;\n        const { scene: scene, mainComponent: mainComponent } = this._context, skeleton = this._docSkeletonManagerService.getSkeleton(), { _anchorNodePosition: _anchorNodePosition, _focusNodePosition: _focusNodePosition, _selectionStyle: _selectionStyle, _currentSegmentId: _currentSegmentId, _currentSegmentPage: _currentSegmentPage } = this;\n        if (_anchorNodePosition == null || _focusNodePosition == null || mainComponent == null) return;\n        const ranges = $bb9ae9d90429a70d$var$getRangeListFromSelection(_anchorNodePosition, _focusNodePosition, scene, mainComponent, skeleton, _selectionStyle, _currentSegmentId, _currentSegmentPage);\n        if (ranges == null) return;\n        const { textRanges: textRanges, rectRanges: rectRanges } = ranges;\n        this._addTextRangesToCache(textRanges), this._addRectRangesToCache(rectRanges), this.deactivate();\n    }\n    _isEmpty() {\n        return this._rangeList.length === 0 && this._rectRangeList.length === 0;\n    }\n    _getCanvasOffset() {\n        var _a28;\n        const engine = (_a28 = this._context.scene) == null ? void 0 : _a28.getEngine();\n        return $bb9ae9d90429a70d$export$dba4bbd052c086b8(engine);\n    }\n    _updateInputPosition(forceFocus = !1) {\n        const activeRangeInstance = this._getActiveRangeInstance(), anchor = activeRangeInstance == null ? void 0 : activeRangeInstance.getAnchor();\n        if (!anchor || anchor && !anchor.visible || this.activeViewPort == null) {\n            this.focus();\n            return;\n        }\n        const { left: left, top: top } = anchor, absoluteCoord = this.activeViewPort.getAbsoluteVector((0, $3e0Iz.Vector2).FromArray([\n            left,\n            top\n        ])), { x: x, y: y } = absoluteCoord;\n        let { left: canvasLeft, top: canvasTop } = this._getCanvasOffset();\n        canvasLeft += x, canvasTop += y, this.activate(canvasLeft, canvasTop, forceFocus);\n    }\n    _moving(moveOffsetX, moveOffsetY) {\n        var _a28, _b;\n        const focusNode = this._findNodeByCoord(moveOffsetX, moveOffsetY, {\n            strict: !0,\n            segmentId: this._currentSegmentId,\n            segmentPage: this._currentSegmentPage\n        }), focusNodePosition = this._getNodePosition(focusNode);\n        if (!focusNodePosition || focusNode == null) return;\n        const divide = focusNode == null ? void 0 : focusNode.node.parent, nextGlyph = divide == null ? void 0 : divide.glyphGroup[divide.glyphGroup.indexOf(focusNode.node) + 1];\n        (focusNode == null ? void 0 : focusNode.node.streamType) === (0, $7yNYd.DataStreamTreeTokenType).PARAGRAPH && (nextGlyph == null ? void 0 : nextGlyph.streamType) === (0, $7yNYd.DataStreamTreeTokenType).SECTION_BREAK && (focusNodePosition.isBack = !0), this._focusNodePosition = focusNodePosition, this._removeAllCacheRanges();\n        const { _anchorNodePosition: _anchorNodePosition, _focusNodePosition: _focusNodePosition, _selectionStyle: _selectionStyle, _currentSegmentId: _currentSegmentId, _currentSegmentPage: _currentSegmentPage } = this, { scene: scene, mainComponent: mainComponent } = this._context, skeleton = this._docSkeletonManagerService.getSkeleton();\n        if (_anchorNodePosition == null || _focusNodePosition == null || mainComponent == null) return;\n        const ranges = $bb9ae9d90429a70d$var$getRangeListFromSelection(_anchorNodePosition, _focusNodePosition, scene, mainComponent, skeleton, _selectionStyle, _currentSegmentId, _currentSegmentPage);\n        if (ranges == null) return;\n        const { textRanges: textRanges, rectRanges: rectRanges } = ranges;\n        this._rangeList.length > 0 && textRanges.length > 0 && this._interactTextRanges(textRanges), this._rectRangeList.length > 0 && rectRanges.length > 0 && this._interactRectRanges(rectRanges), this._addTextRangesToCache(textRanges), this._addRectRangesToCache(rectRanges), this.deactivate(), (_b = (_a28 = this._context.scene) == null ? void 0 : _a28.getEngine()) == null || _b.setRemainCapture();\n    }\n    __attachScrollEvent() {\n        const viewport = this.activeViewPort;\n        if (!viewport) return;\n        const { unitId: unitId } = this._context;\n        if (this._viewPortObserverMap.has(unitId)) return;\n        const scrollBefore = viewport.onScrollAfter$.subscribeEvent((param)=>{\n            if (!param.viewport) return;\n            const activeRangeInstance = this._getActiveRangeInstance();\n            activeRangeInstance == null || activeRangeInstance.activeStatic();\n        }), scrollStop = viewport.onScrollEnd$.subscribeEvent((param)=>{\n            const viewport2 = param.viewport;\n            if (!viewport2) return;\n            const bounds = viewport2.getBounding(), activeRangeInstance = this._getActiveRangeInstance(), anchor = activeRangeInstance == null ? void 0 : activeRangeInstance.getAnchor();\n            if (!(!anchor || anchor && !anchor.visible)) {\n                if (bounds) {\n                    const { left: left, top: top, right: right, bottom: bottom } = bounds.viewBound;\n                    if (anchor.left < left || anchor.left > right || anchor.top < top || anchor.top > bottom) {\n                        activeRangeInstance == null || activeRangeInstance.deactivateStatic();\n                        return;\n                    }\n                }\n                this._updateInputPosition();\n            }\n        });\n        this._viewPortObserverMap.set(unitId, {\n            scrollBefore: scrollBefore,\n            scrollStop: scrollStop\n        });\n    }\n    // FIXME: listeners here are not correctly disposed\n    // eslint-disable-next-line max-lines-per-function\n    _initInputEvents() {\n        this.disposeWithMe((0, $5HvWP.fromEvent)(this._input, \"keydown\").subscribe((e)=>{\n            this._isIMEInputApply || this._eventHandle(e, (config)=>{\n                this._onKeydown$.next(config);\n            });\n        })), this.disposeWithMe((0, $5HvWP.fromEvent)(this._input, \"input\").subscribe((e)=>{\n            if (!(e.inputType === \"historyUndo\" || e.inputType === \"historyRedo\")) {\n                if (this._rectRangeList.length > 0) return e.stopPropagation(), e.preventDefault();\n                this._isIMEInputApply || this._eventHandle(e, (config)=>{\n                    this._onInputBefore$.next(config), this._onInput$.next(config);\n                });\n            }\n        })), this.disposeWithMe((0, $5HvWP.fromEvent)(this._input, \"compositionstart\").subscribe((e)=>{\n            if (this._rectRangeList.length > 0) return e.stopPropagation(), e.preventDefault();\n            this._isIMEInputApply = !0, this._eventHandle(e, (config)=>{\n                this._onCompositionstart$.next(config);\n            });\n        })), this.disposeWithMe((0, $5HvWP.fromEvent)(this._input, \"compositionend\").subscribe((e)=>{\n            this._isIMEInputApply = !1, this._eventHandle(e, (config)=>{\n                this._onCompositionend$.next(config);\n            });\n        })), this.disposeWithMe((0, $5HvWP.fromEvent)(this._input, \"compositionupdate\").subscribe((e)=>{\n            this._eventHandle(e, (config)=>{\n                this._onInputBefore$.next(config), this._onCompositionupdate$.next(config);\n            });\n        })), this.disposeWithMe((0, $5HvWP.fromEvent)(this._input, \"paste\").subscribe((e)=>{\n            this._eventHandle(e, (config)=>{\n                this._onPaste$.next(config);\n            });\n        })), this.disposeWithMe((0, $5HvWP.fromEvent)(this._input, \"focus\").subscribe((e)=>{\n            this._eventHandle(e, (config)=>{\n                this._onFocus$.next(config);\n            });\n        })), this.disposeWithMe((0, $5HvWP.fromEvent)(this._input, \"pointerdown\").subscribe((e)=>{\n            this._eventHandle(e, ()=>{\n                this._onBlur$.next();\n            });\n        })), this.disposeWithMe((0, $5HvWP.fromEvent)(this._input, \"blur\").subscribe((e)=>{\n            this._eventHandle(e, (config)=>{\n                this._onBlur$.next(config);\n            });\n        }));\n    }\n    _eventHandle(e, func) {\n        const content = this._input.textContent || \"\";\n        this._input.innerHTML = \"\";\n        const activeRange = this._getActiveRange(), rangeList = this._getAllTextRanges();\n        func({\n            event: e,\n            content: content,\n            activeRange: activeRange,\n            rangeList: rangeList\n        });\n    }\n    _getTransformCoordForDocumentOffset(evtOffsetX, evtOffsetY) {\n        const document2 = this._context.mainComponent, { documentTransform: documentTransform } = document2.getOffsetConfig();\n        if (this.activeViewPort == null || documentTransform == null) return;\n        const originCoord = this.activeViewPort.transformVector2SceneCoord((0, $3e0Iz.Vector2).FromArray([\n            evtOffsetX,\n            evtOffsetY\n        ]));\n        if (originCoord) return documentTransform.clone().invert().applyPoint(originCoord);\n    }\n    _findNodeByCoord(evtOffsetX, evtOffsetY, restrictions) {\n        const coord = this._getTransformCoordForDocumentOffset(evtOffsetX, evtOffsetY);\n        if (coord == null) return;\n        const document2 = this._context.mainComponent, skeleton = this._docSkeletonManagerService.getSkeleton(), { pageLayoutType: pageLayoutType = (0, $3e0Iz.PageLayoutType).VERTICAL, pageMarginLeft: pageMarginLeft, pageMarginTop: pageMarginTop } = document2.getOffsetConfig();\n        return skeleton.findNodeByCoord(coord, pageLayoutType, pageMarginLeft, pageMarginTop, restrictions);\n    }\n    _detachEvent() {\n        this._onInputBefore$.complete(), this._onKeydown$.complete(), this._onInput$.complete(), this._onCompositionstart$.complete(), this._onCompositionupdate$.complete(), this._onCompositionend$.complete(), this._onSelectionStart$.complete(), this._textSelectionInner$.complete(), this._onPaste$.complete(), this._onFocus$.complete(), this._onBlur$.complete(), this._onPointerDown$.complete();\n    }\n}, $bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_a3, \"DocSelectionRenderService\"), $bb9ae9d90429a70d$var$_a3);\n$bb9ae9d90429a70d$export$6dc2db33d8a277cd = $bb9ae9d90429a70d$var$__decorateClass$o([\n    $bb9ae9d90429a70d$var$__decorateParam$o(1, (0, $fL2Ug.ILayoutService)),\n    $bb9ae9d90429a70d$var$__decorateParam$o(2, (0, $7yNYd.ILogService)),\n    $bb9ae9d90429a70d$var$__decorateParam$o(3, (0, $7yNYd.Inject)((0, $7AR1b.DocSkeletonManagerService)))\n], $bb9ae9d90429a70d$export$6dc2db33d8a277cd);\nconst $bb9ae9d90429a70d$var$COMPONENT_DOC_HEADER_FOOTER_PANEL = \"COMPONENT_DOC_HEADER_FOOTER_PANEL\";\nvar $bb9ae9d90429a70d$var$jsxRuntime = {\n    exports: {}\n}, $bb9ae9d90429a70d$var$reactJsxRuntime_production_min = {};\n/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */ var $bb9ae9d90429a70d$var$f = (0, (/*@__PURE__*/$parcel$interopDefault($5gqvu))), $bb9ae9d90429a70d$var$k = Symbol.for(\"react.element\"), $bb9ae9d90429a70d$var$l = Symbol.for(\"react.fragment\"), $bb9ae9d90429a70d$var$m = Object.prototype.hasOwnProperty, $bb9ae9d90429a70d$var$n = $bb9ae9d90429a70d$var$f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner, $bb9ae9d90429a70d$var$p = {\n    key: !0,\n    ref: !0,\n    __self: !0,\n    __source: !0\n};\nfunction $bb9ae9d90429a70d$var$q(c, a, g) {\n    var b, d = {}, e = null, h = null;\n    g !== void 0 && (e = \"\" + g), a.key !== void 0 && (e = \"\" + a.key), a.ref !== void 0 && (h = a.ref);\n    for(b in a)$bb9ae9d90429a70d$var$m.call(a, b) && !$bb9ae9d90429a70d$var$p.hasOwnProperty(b) && (d[b] = a[b]);\n    if (c && c.defaultProps) for(b in a = c.defaultProps, a)d[b] === void 0 && (d[b] = a[b]);\n    return {\n        $$typeof: $bb9ae9d90429a70d$var$k,\n        type: c,\n        key: e,\n        ref: h,\n        props: d,\n        _owner: $bb9ae9d90429a70d$var$n.current\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$q, \"q\");\n$bb9ae9d90429a70d$var$reactJsxRuntime_production_min.Fragment = $bb9ae9d90429a70d$var$l;\n$bb9ae9d90429a70d$var$reactJsxRuntime_production_min.jsx = $bb9ae9d90429a70d$var$q;\n$bb9ae9d90429a70d$var$reactJsxRuntime_production_min.jsxs = $bb9ae9d90429a70d$var$q;\n$bb9ae9d90429a70d$var$jsxRuntime.exports = $bb9ae9d90429a70d$var$reactJsxRuntime_production_min;\nvar $bb9ae9d90429a70d$var$jsxRuntimeExports = $bb9ae9d90429a70d$var$jsxRuntime.exports;\nconst $bb9ae9d90429a70d$var$panel = \"univer-panel\", $bb9ae9d90429a70d$var$optionsSection = \"univer-options-section\", $bb9ae9d90429a70d$var$optionsFormItem = \"univer-options-form-item\", $bb9ae9d90429a70d$var$optionsInput = \"univer-options-input\", $bb9ae9d90429a70d$var$optionsMarginSetting = \"univer-options-margin-setting\", $bb9ae9d90429a70d$var$styles$5 = {\n    panel: $bb9ae9d90429a70d$var$panel,\n    optionsSection: $bb9ae9d90429a70d$var$optionsSection,\n    optionsFormItem: $bb9ae9d90429a70d$var$optionsFormItem,\n    optionsInput: $bb9ae9d90429a70d$var$optionsInput,\n    optionsMarginSetting: $bb9ae9d90429a70d$var$optionsMarginSetting\n}, $bb9ae9d90429a70d$var$DocHeaderFooterOptions = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((props)=>{\n    const localeService = (0, $7yNYd.useDependency)((0, $7yNYd.LocaleService)), univerInstanceService = (0, $7yNYd.useDependency)((0, $7yNYd.IUniverInstanceService)), renderManagerService = (0, $7yNYd.useDependency)((0, $3e0Iz.IRenderManagerService)), commandService = (0, $7yNYd.useDependency)((0, $7yNYd.ICommandService)), docSelectionManagerService = (0, $7yNYd.useDependency)((0, $7AR1b.DocSelectionManagerService)), { unitId: unitId } = props, docSelectionRenderService = renderManagerService.getRenderById(unitId).with($bb9ae9d90429a70d$export$6dc2db33d8a277cd), [options, setOptions] = (0, $5gqvu.useState)({}), handleCheckboxChange = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((val, type)=>{\n        var _a28;\n        setOptions((prev)=>({\n                ...prev,\n                [type]: val ? (0, $7yNYd.BooleanNumber).TRUE : (0, $7yNYd.BooleanNumber).FALSE\n            }));\n        const docDataModel = univerInstanceService.getUniverDocInstance(unitId), documentStyle = docDataModel == null ? void 0 : docDataModel.getSnapshot().documentStyle, docSkeletonManagerService = (_a28 = renderManagerService.getRenderById(unitId)) == null ? void 0 : _a28.with((0, $7AR1b.DocSkeletonManagerService)), viewModel = docSkeletonManagerService == null ? void 0 : docSkeletonManagerService.getViewModel();\n        if (documentStyle == null || viewModel == null) return;\n        const editArea = viewModel.getEditArea();\n        let needCreateHeaderFooter = !1;\n        const segmentPage = docSelectionRenderService.getSegmentPage();\n        let needChangeSegmentId = !1;\n        if (type === \"useFirstPageHeaderFooter\" && val === !0 && ((editArea === (0, $3e0Iz.DocumentEditArea).HEADER && !documentStyle.firstPageHeaderId || editArea === (0, $3e0Iz.DocumentEditArea).FOOTER && !documentStyle.firstPageFooterId) && (needCreateHeaderFooter = !0), needCreateHeaderFooter && segmentPage === 0 && (needChangeSegmentId = !0)), type === \"evenAndOddHeaders\" && val === !0 && ((editArea === (0, $3e0Iz.DocumentEditArea).HEADER && !documentStyle.evenPageHeaderId || editArea === (0, $3e0Iz.DocumentEditArea).FOOTER && !documentStyle.evenPageFooterId) && (needCreateHeaderFooter = !0), needCreateHeaderFooter && segmentPage % 2 === 1 && (needChangeSegmentId = !0)), needCreateHeaderFooter) {\n            const segmentId = (0, $7yNYd.Tools).generateRandomId(6);\n            needChangeSegmentId && docSelectionRenderService.setSegment(segmentId), commandService.executeCommand($bb9ae9d90429a70d$var$CoreHeaderFooterCommandId, {\n                unitId: unitId,\n                segmentId: segmentId,\n                headerFooterProps: {\n                    [type]: val ? (0, $7yNYd.BooleanNumber).TRUE : (0, $7yNYd.BooleanNumber).FALSE\n                }\n            });\n        } else commandService.executeCommand($bb9ae9d90429a70d$var$CoreHeaderFooterCommandId, {\n            unitId: unitId,\n            headerFooterProps: {\n                [type]: val ? (0, $7yNYd.BooleanNumber).TRUE : (0, $7yNYd.BooleanNumber).FALSE\n            }\n        });\n    }, \"handleCheckboxChange\"), handleMarginChange = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (val, type)=>{\n        setOptions((prev)=>({\n                ...prev,\n                [type]: val\n            })), await commandService.executeCommand($bb9ae9d90429a70d$var$CoreHeaderFooterCommandId, {\n            unitId: unitId,\n            headerFooterProps: {\n                [type]: val\n            }\n        }), docSelectionRenderService.removeAllRanges(), docSelectionRenderService.blur();\n    }, \"handleMarginChange\"), closeHeaderFooter = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(()=>{\n        var _a28;\n        const renderObject = renderManagerService.getRenderById(unitId);\n        if (renderObject == null) return;\n        const { scene: scene } = renderObject, transformer = scene.getTransformerByCreate(), docSkeletonManagerService = renderObject.with((0, $7AR1b.DocSkeletonManagerService)), skeleton = docSkeletonManagerService == null ? void 0 : docSkeletonManagerService.getSkeleton(), viewModel = docSkeletonManagerService == null ? void 0 : docSkeletonManagerService.getViewModel(), render2 = renderManagerService.getRenderById(unitId);\n        render2 == null || viewModel == null || skeleton == null || (docSelectionManagerService.replaceTextRanges([]), transformer.clearSelectedObjects(), docSelectionRenderService.setSegment(\"\"), docSelectionRenderService.setSegmentPage(-1), viewModel.setEditArea((0, $3e0Iz.DocumentEditArea).BODY), skeleton.calculate(), (_a28 = render2.mainComponent) == null || _a28.makeDirty(!0));\n    }, \"closeHeaderFooter\");\n    return (0, $5gqvu.useEffect)(()=>{\n        const docDataModel = univerInstanceService.getUniverDocInstance(unitId), documentStyle = docDataModel == null ? void 0 : docDataModel.getSnapshot().documentStyle;\n        if (documentStyle) {\n            const { marginHeader: marginHeader = 0, marginFooter: marginFooter = 0, useFirstPageHeaderFooter: useFirstPageHeaderFooter = (0, $7yNYd.BooleanNumber).FALSE, evenAndOddHeaders: evenAndOddHeaders = (0, $7yNYd.BooleanNumber).FALSE } = documentStyle;\n            setOptions({\n                marginHeader: marginHeader,\n                marginFooter: marginFooter,\n                useFirstPageHeaderFooter: useFirstPageHeaderFooter,\n                evenAndOddHeaders: evenAndOddHeaders\n            });\n        }\n    }, [\n        unitId\n    ]), /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsxs(\"div\", {\n        className: $bb9ae9d90429a70d$var$styles$5.options,\n        children: [\n            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsxs(\"div\", {\n                className: $bb9ae9d90429a70d$var$styles$5.optionsSection,\n                children: [\n                    /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx(\"div\", {\n                        className: $bb9ae9d90429a70d$var$styles$5.optionsFormItem,\n                        children: /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx((0, $1UDbf.Checkbox), {\n                            checked: options.useFirstPageHeaderFooter === (0, $7yNYd.BooleanNumber).TRUE,\n                            onChange: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((val)=>{\n                                handleCheckboxChange(val, \"useFirstPageHeaderFooter\");\n                            }, \"onChange\"),\n                            children: localeService.t(\"headerFooter.firstPageCheckBox\")\n                        })\n                    }),\n                    /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx(\"div\", {\n                        className: $bb9ae9d90429a70d$var$styles$5.optionsFormItem,\n                        children: /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx((0, $1UDbf.Checkbox), {\n                            checked: options.evenAndOddHeaders === (0, $7yNYd.BooleanNumber).TRUE,\n                            onChange: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((val)=>{\n                                handleCheckboxChange(val, \"evenAndOddHeaders\");\n                            }, \"onChange\"),\n                            children: localeService.t(\"headerFooter.oddEvenCheckBox\")\n                        })\n                    })\n                ]\n            }),\n            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsxs(\"div\", {\n                className: (0, $aFl3s.default)($bb9ae9d90429a70d$var$styles$5.optionsSection, $bb9ae9d90429a70d$var$styles$5.optionsMarginSetting),\n                children: [\n                    /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsxs(\"div\", {\n                        className: $bb9ae9d90429a70d$var$styles$5.optionsMarginItem,\n                        children: [\n                            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx(\"span\", {\n                                children: localeService.t(\"headerFooter.headerTopMargin\")\n                            }),\n                            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx((0, $1UDbf.InputNumber), {\n                                min: 0,\n                                max: 200,\n                                precision: 1,\n                                value: options.marginHeader,\n                                onChange: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((val)=>{\n                                    handleMarginChange(val, \"marginHeader\");\n                                }, \"onChange\"),\n                                className: $bb9ae9d90429a70d$var$styles$5.optionsInput\n                            })\n                        ]\n                    }),\n                    /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsxs(\"div\", {\n                        className: $bb9ae9d90429a70d$var$styles$5.optionsMarginItem,\n                        children: [\n                            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx(\"span\", {\n                                children: localeService.t(\"headerFooter.footerBottomMargin\")\n                            }),\n                            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx((0, $1UDbf.InputNumber), {\n                                min: 0,\n                                max: 200,\n                                precision: 1,\n                                value: options.marginFooter,\n                                onChange: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((val)=>{\n                                    handleMarginChange(val, \"marginFooter\");\n                                }, \"onChange\"),\n                                className: $bb9ae9d90429a70d$var$styles$5.optionsInput\n                            })\n                        ]\n                    })\n                ]\n            }),\n            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx(\"div\", {\n                className: $bb9ae9d90429a70d$var$styles$5.optionsSection,\n                children: /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx((0, $1UDbf.Button), {\n                    onClick: closeHeaderFooter,\n                    children: localeService.t(\"headerFooter.closeHeaderFooter\")\n                })\n            })\n        ]\n    });\n}, \"DocHeaderFooterOptions\"), $bb9ae9d90429a70d$var$DocHeaderFooterPanel = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(()=>{\n    var _a28;\n    const localeService = (0, $7yNYd.useDependency)((0, $7yNYd.LocaleService)), renderManagerService = (0, $7yNYd.useDependency)((0, $3e0Iz.IRenderManagerService)), unitId = (0, $7yNYd.useDependency)((0, $7yNYd.IUniverInstanceService)).getCurrentUniverDocInstance().getUnitId(), viewModel = ((_a28 = renderManagerService.getRenderById(unitId)) == null ? void 0 : _a28.with((0, $7AR1b.DocSkeletonManagerService))).getViewModel(), [isEditHeaderFooter, setIsEditHeaderFooter] = (0, $5gqvu.useState)(!0);\n    return (0, $5gqvu.useEffect)(()=>{\n        const editArea = viewModel.getEditArea();\n        setIsEditHeaderFooter(editArea !== (0, $3e0Iz.DocumentEditArea).BODY);\n        const subscription = viewModel.editAreaChange$.subscribe((editArea2)=>{\n            editArea2 != null && setIsEditHeaderFooter(editArea2 !== (0, $3e0Iz.DocumentEditArea).BODY);\n        });\n        return ()=>{\n            subscription.unsubscribe();\n        };\n    }, []), /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx(\"div\", {\n        className: $bb9ae9d90429a70d$var$styles$5.panel,\n        children: isEditHeaderFooter ? /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx($bb9ae9d90429a70d$var$DocHeaderFooterOptions, {\n            unitId: unitId\n        }) : /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx(\"div\", {\n            className: $bb9ae9d90429a70d$var$styles$5.panelDisableText,\n            children: localeService.t(\"headerFooter.disableText\")\n        })\n    });\n}, \"DocHeaderFooterPanel\"), $bb9ae9d90429a70d$var$COLLAB_CURSOR_LABEL_HEIGHT = 18, $bb9ae9d90429a70d$var$COLLAB_CURSOR_LABEL_MAX_WIDTH = 200, $bb9ae9d90429a70d$var$COLLAB_CURSOR_LABEL_TEXT_PADDING_LR = 6, $bb9ae9d90429a70d$var$COLLAB_CURSOR_LABEL_TEXT_PADDING_TB = 4;\nfunction $bb9ae9d90429a70d$var$drawBubble(ctx, props) {\n    let { radius: radius, width: width, height: height } = props;\n    radius = radius != null ? radius : 0, width = width != null ? width : 30, height = height != null ? height : 30;\n    let bottomRight = 0;\n    bottomRight = Math.min(radius, width / 2, height / 2), ctx.beginPath(), ctx.moveTo(0, 0), ctx.lineTo(width, 0), ctx.lineTo(width, height - bottomRight), ctx.arc(width - bottomRight, height - bottomRight, bottomRight, 0, Math.PI / 2, !1), ctx.lineTo(0, height), ctx.lineTo(0, 0), ctx.closePath(), props.fill && (ctx.save(), ctx.fillStyle = props.fill, props.fillRule === \"evenodd\" ? ctx.fill(\"evenodd\") : ctx.fill(), ctx.restore());\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$drawBubble, \"drawBubble\");\nconst $bb9ae9d90429a70d$var$_TextBubbleShape = class _TextBubbleShape extends (0, $3e0Iz.Shape) {\n    constructor(key, props){\n        super(key, props);\n        $bb9ae9d90429a70d$var$__publicField(this, \"color\");\n        $bb9ae9d90429a70d$var$__publicField(this, \"text\");\n        this.color = props == null ? void 0 : props.color, this.text = props == null ? void 0 : props.text;\n    }\n    static drawWith(ctx, props) {\n        const { text: text, color: color } = props;\n        ctx.save(), ctx.font = \"13px Source Han Sans CN\";\n        const textWidth = ctx.measureText(text).width, realInfoWidth = Math.min(textWidth + 2 * $bb9ae9d90429a70d$var$COLLAB_CURSOR_LABEL_TEXT_PADDING_LR, $bb9ae9d90429a70d$var$COLLAB_CURSOR_LABEL_MAX_WIDTH);\n        $bb9ae9d90429a70d$var$drawBubble(ctx, {\n            height: $bb9ae9d90429a70d$var$COLLAB_CURSOR_LABEL_HEIGHT,\n            width: realInfoWidth,\n            radius: 4,\n            fill: color,\n            evented: !1\n        }), ctx.fillStyle = \"rgba(58, 96, 247, 1)\";\n        const offsetX = $bb9ae9d90429a70d$var$COLLAB_CURSOR_LABEL_TEXT_PADDING_LR, offsetY = $bb9ae9d90429a70d$var$COLLAB_CURSOR_LABEL_HEIGHT - $bb9ae9d90429a70d$var$COLLAB_CURSOR_LABEL_TEXT_PADDING_TB, maxTextWidth = $bb9ae9d90429a70d$var$COLLAB_CURSOR_LABEL_MAX_WIDTH - 2 * $bb9ae9d90429a70d$var$COLLAB_CURSOR_LABEL_TEXT_PADDING_LR;\n        if (textWidth > maxTextWidth) {\n            let truncatedText = \"\", currentWidth = 0;\n            for (const element2 of text){\n                const charWidth = ctx.measureText(element2).width;\n                if (currentWidth + charWidth <= maxTextWidth - ctx.measureText(\"...\").width) truncatedText += element2, currentWidth += charWidth;\n                else {\n                    truncatedText += \"...\";\n                    break;\n                }\n            }\n            ctx.fillText(truncatedText, offsetX, offsetY);\n        } else ctx.fillText(text, offsetX, offsetY);\n        ctx.restore();\n    }\n    _draw(ctx) {\n        _TextBubbleShape.drawWith(ctx, this);\n    }\n};\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_TextBubbleShape, \"TextBubbleShape\");\nlet $bb9ae9d90429a70d$var$TextBubbleShape = $bb9ae9d90429a70d$var$_TextBubbleShape;\nvar $bb9ae9d90429a70d$var$__defProp$n = Object.defineProperty, $bb9ae9d90429a70d$var$__getOwnPropDesc$n = Object.getOwnPropertyDescriptor, $bb9ae9d90429a70d$var$__decorateClass$n = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((decorators, target, key, kind)=>{\n    for(var result = kind > 1 ? void 0 : kind ? $bb9ae9d90429a70d$var$__getOwnPropDesc$n(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)(decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n    return kind && result && $bb9ae9d90429a70d$var$__defProp$n(target, key, result), result;\n}, \"__decorateClass$n\"), $bb9ae9d90429a70d$var$__decorateParam$n = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((index, decorator)=>(target, key)=>decorator(target, key, index), \"__decorateParam$n\");\nconst $bb9ae9d90429a70d$var$HEADER_FOOTER_STROKE_COLOR = \"rgba(58, 96, 247, 1)\", $bb9ae9d90429a70d$var$HEADER_FOOTER_FILL_COLOR = \"rgba(58, 96, 247, 0.08)\";\nvar $bb9ae9d90429a70d$var$HeaderFooterType = /* @__PURE__ */ ((HeaderFooterType2)=>(HeaderFooterType2[HeaderFooterType2.FIRST_PAGE_HEADER = 0] = \"FIRST_PAGE_HEADER\", HeaderFooterType2[HeaderFooterType2.FIRST_PAGE_FOOTER = 1] = \"FIRST_PAGE_FOOTER\", HeaderFooterType2[HeaderFooterType2.DEFAULT_HEADER = 2] = \"DEFAULT_HEADER\", HeaderFooterType2[HeaderFooterType2.DEFAULT_FOOTER = 3] = \"DEFAULT_FOOTER\", HeaderFooterType2[HeaderFooterType2.EVEN_PAGE_HEADER = 4] = \"EVEN_PAGE_HEADER\", HeaderFooterType2[HeaderFooterType2.EVEN_PAGE_FOOTER = 5] = \"EVEN_PAGE_FOOTER\", HeaderFooterType2))($bb9ae9d90429a70d$var$HeaderFooterType || {});\nfunction $bb9ae9d90429a70d$var$checkCreateHeaderFooterType(viewModel, editArea, segmentPage) {\n    const { documentStyle: documentStyle } = viewModel.getDataModel().getSnapshot(), { defaultHeaderId: defaultHeaderId, defaultFooterId: defaultFooterId, evenPageHeaderId: evenPageHeaderId, evenPageFooterId: evenPageFooterId, firstPageHeaderId: firstPageHeaderId, firstPageFooterId: firstPageFooterId, evenAndOddHeaders: evenAndOddHeaders, useFirstPageHeaderFooter: useFirstPageHeaderFooter } = documentStyle;\n    switch(editArea){\n        case (0, $3e0Iz.DocumentEditArea).BODY:\n            return {\n                createType: null,\n                headerFooterId: null\n            };\n        case (0, $3e0Iz.DocumentEditArea).HEADER:\n            return useFirstPageHeaderFooter === (0, $7yNYd.BooleanNumber).TRUE && !firstPageHeaderId ? {\n                createType: 0,\n                headerFooterId: null\n            } : evenAndOddHeaders === (0, $7yNYd.BooleanNumber).TRUE && segmentPage % 2 === 0 && !evenPageHeaderId ? {\n                createType: 4,\n                headerFooterId: null\n            } : defaultHeaderId ? {\n                createType: null,\n                headerFooterId: defaultHeaderId\n            } : {\n                createType: 2,\n                headerFooterId: null\n            };\n        case (0, $3e0Iz.DocumentEditArea).FOOTER:\n            return useFirstPageHeaderFooter === (0, $7yNYd.BooleanNumber).TRUE && !firstPageFooterId ? {\n                createType: 1,\n                headerFooterId: null\n            } : evenAndOddHeaders === (0, $7yNYd.BooleanNumber).TRUE && segmentPage % 2 === 0 && !evenPageFooterId ? {\n                createType: 5,\n                headerFooterId: null\n            } : defaultFooterId ? {\n                createType: null,\n                headerFooterId: defaultFooterId\n            } : {\n                createType: 3,\n                headerFooterId: null\n            };\n        default:\n            throw new Error(`Invalid editArea: ${editArea}`);\n    }\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$checkCreateHeaderFooterType, \"checkCreateHeaderFooterType\");\nvar $bb9ae9d90429a70d$var$_a4;\nlet $bb9ae9d90429a70d$var$DocHeaderFooterController = ($bb9ae9d90429a70d$var$_a4 = class extends (0, $7yNYd.Disposable) {\n    constructor(_context, _commandService, _editorService, _instanceSrv, _renderManagerService, _docSkeletonManagerService, _docSelectionRenderService, _localeService, _componentManager){\n        super();\n        $bb9ae9d90429a70d$var$__publicField(this, \"_loadedMap\", /* @__PURE__ */ new WeakSet());\n        this._context = _context, this._commandService = _commandService, this._editorService = _editorService, this._instanceSrv = _instanceSrv, this._renderManagerService = _renderManagerService, this._docSkeletonManagerService = _docSkeletonManagerService, this._docSelectionRenderService = _docSelectionRenderService, this._localeService = _localeService, this._componentManager = _componentManager, this._initialize();\n    }\n    _initialize() {\n        this._context.unit.getSnapshot().documentStyle.documentFlavor === (0, $7yNYd.DocumentFlavor).TRADITIONAL && (this._init(), this._drawHeaderFooterLabel(), this._initCustomComponents());\n    }\n    _initCustomComponents() {\n        const componentManager = this._componentManager;\n        this.disposeWithMe(componentManager.register($bb9ae9d90429a70d$var$COMPONENT_DOC_HEADER_FOOTER_PANEL, $bb9ae9d90429a70d$var$DocHeaderFooterPanel));\n    }\n    _init() {\n        const { unitId: unitId } = this._context, docObject = $bb9ae9d90429a70d$export$ea0dbb208e4826e2(this._context);\n        docObject == null || docObject.document == null || this._loadedMap.has(docObject.document) || (this._initialMain(unitId), this._loadedMap.add(docObject.document));\n    }\n    _initialMain(unitId) {\n        const docObject = $bb9ae9d90429a70d$export$ea0dbb208e4826e2(this._context), { document: document2 } = docObject;\n        this.disposeWithMe(document2.onDblclick$.subscribeEvent(async (evt)=>{\n            if (this._isEditorReadOnly(unitId)) return;\n            const { offsetX: offsetX, offsetY: offsetY } = evt, { pageLayoutType: pageLayoutType = (0, $3e0Iz.PageLayoutType).VERTICAL, pageMarginLeft: pageMarginLeft, pageMarginTop: pageMarginTop } = document2.getOffsetConfig(), coord = this._getTransformCoordForDocumentOffset(offsetX, offsetY);\n            if (coord == null) return;\n            const viewModel = this._docSkeletonManagerService.getViewModel(), skeleton = this._docSkeletonManagerService.getSkeleton(), preEditArea = viewModel.getEditArea(), { editArea: editArea, pageNumber: pageNumber } = skeleton.findEditAreaByCoord(coord, pageLayoutType, pageMarginLeft, pageMarginTop);\n            if (preEditArea === editArea) return;\n            viewModel.setEditArea(editArea);\n            const { createType: createType, headerFooterId: headerFooterId } = $bb9ae9d90429a70d$var$checkCreateHeaderFooterType(viewModel, editArea, pageNumber);\n            if (editArea === (0, $3e0Iz.DocumentEditArea).BODY) this._docSelectionRenderService.setSegment(\"\"), this._docSelectionRenderService.setSegmentPage(-1), this._docSelectionRenderService.setCursorManually(offsetX, offsetY);\n            else if (createType != null) {\n                const segmentId = (0, $7yNYd.Tools).generateRandomId(6);\n                this._docSelectionRenderService.setSegment(segmentId), this._docSelectionRenderService.setSegmentPage(pageNumber), await this._commandService.executeCommand($bb9ae9d90429a70d$var$CoreHeaderFooterCommand.id, {\n                    unitId: unitId,\n                    createType: createType,\n                    segmentId: segmentId\n                });\n            } else headerFooterId != null && (this._docSelectionRenderService.setSegment(headerFooterId), this._docSelectionRenderService.setSegmentPage(pageNumber), this._docSelectionRenderService.setCursorManually(offsetX, offsetY));\n        }));\n    }\n    _getTransformCoordForDocumentOffset(evtOffsetX, evtOffsetY) {\n        const docObject = $bb9ae9d90429a70d$export$ea0dbb208e4826e2(this._context), { document: document2, scene: scene } = docObject, { documentTransform: documentTransform } = document2.getOffsetConfig(), activeViewport = scene.getViewports()[0];\n        if (activeViewport == null) return;\n        const originCoord = activeViewport.transformVector2SceneCoord((0, $3e0Iz.Vector2).FromArray([\n            evtOffsetX,\n            evtOffsetY\n        ]));\n        return documentTransform.clone().invert().applyPoint(originCoord);\n    }\n    // eslint-disable-next-line max-lines-per-function\n    _drawHeaderFooterLabel() {\n        const localeService = this._localeService;\n        this._renderManagerService.currentRender$.subscribe((unitId)=>{\n            if (unitId == null) return;\n            const currentRender = this._renderManagerService.getRenderById(unitId);\n            if (this._editorService.isEditor(unitId) || this._instanceSrv.getUniverDocInstance(unitId) == null || currentRender == null) return;\n            const { mainComponent: mainComponent } = currentRender, docsComponent = mainComponent;\n            this.disposeWithMe((0, $7yNYd.toDisposable)(// eslint-disable-next-line max-lines-per-function\n            docsComponent.pageRender$.subscribe((config)=>{\n                if (this._editorService.isEditor(unitId)) return;\n                const isEditBody = this._docSkeletonManagerService.getViewModel().getEditArea() === (0, $3e0Iz.DocumentEditArea).BODY, { page: page, pageLeft: pageLeft, pageTop: pageTop, ctx: ctx } = config, { pageWidth: pageWidth, pageHeight: pageHeight, marginTop: marginTop, marginBottom: marginBottom } = page;\n                if (ctx.save(), ctx.translate(pageLeft - 0.5, pageTop - 0.5), isEditBody ? ((0, $3e0Iz.Rect).drawWith(ctx, {\n                    left: 0,\n                    top: 0,\n                    width: pageWidth,\n                    height: marginTop,\n                    fill: \"rgba(255, 255, 255, 0.5)\"\n                }), ctx.save(), ctx.translate(0, pageHeight - marginBottom), (0, $3e0Iz.Rect).drawWith(ctx, {\n                    left: 0,\n                    top: 0,\n                    width: pageWidth,\n                    height: marginBottom,\n                    fill: \"rgba(255, 255, 255, 0.5)\"\n                }), ctx.restore()) : (ctx.save(), ctx.translate(0, marginTop), (0, $3e0Iz.Rect).drawWith(ctx, {\n                    left: 0,\n                    top: marginTop,\n                    width: pageWidth,\n                    height: pageHeight - marginTop - marginBottom,\n                    fill: \"rgba(255, 255, 255, 0.5)\"\n                }), ctx.restore()), !isEditBody) {\n                    const headerPathConfigIPathProps = {\n                        dataArray: [\n                            {\n                                command: \"M\",\n                                points: [\n                                    0,\n                                    marginTop\n                                ]\n                            },\n                            {\n                                command: \"L\",\n                                points: [\n                                    pageWidth,\n                                    marginTop\n                                ]\n                            }\n                        ],\n                        strokeWidth: 1,\n                        stroke: $bb9ae9d90429a70d$var$HEADER_FOOTER_STROKE_COLOR\n                    }, footerPathConfigIPathProps = {\n                        dataArray: [\n                            {\n                                command: \"M\",\n                                points: [\n                                    0,\n                                    pageHeight - marginBottom\n                                ]\n                            },\n                            {\n                                command: \"L\",\n                                points: [\n                                    pageWidth,\n                                    pageHeight - marginBottom\n                                ]\n                            }\n                        ],\n                        strokeWidth: 1,\n                        stroke: $bb9ae9d90429a70d$var$HEADER_FOOTER_STROKE_COLOR\n                    };\n                    (0, $3e0Iz.Path).drawWith(ctx, headerPathConfigIPathProps), (0, $3e0Iz.Path).drawWith(ctx, footerPathConfigIPathProps), ctx.translate(0, marginTop + 1), $bb9ae9d90429a70d$var$TextBubbleShape.drawWith(ctx, {\n                        text: localeService.t(\"headerFooter.header\"),\n                        color: $bb9ae9d90429a70d$var$HEADER_FOOTER_FILL_COLOR\n                    }), ctx.translate(0, pageHeight - marginTop - marginBottom), $bb9ae9d90429a70d$var$TextBubbleShape.drawWith(ctx, {\n                        text: localeService.t(\"headerFooter.footer\"),\n                        color: $bb9ae9d90429a70d$var$HEADER_FOOTER_FILL_COLOR\n                    });\n                }\n                ctx.restore();\n            })));\n        });\n    }\n    _isEditorReadOnly(unitId) {\n        const editor = this._editorService.getEditor(unitId);\n        return editor ? editor.isReadOnly() : !1;\n    }\n    _getDocDataModel() {\n        return this._context.unit;\n    }\n}, $bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_a4, \"DocHeaderFooterController\"), $bb9ae9d90429a70d$var$_a4);\n$bb9ae9d90429a70d$var$DocHeaderFooterController = $bb9ae9d90429a70d$var$__decorateClass$n([\n    $bb9ae9d90429a70d$var$__decorateParam$n(1, (0, $7yNYd.ICommandService)),\n    $bb9ae9d90429a70d$var$__decorateParam$n(2, (0, $fL2Ug.IEditorService)),\n    $bb9ae9d90429a70d$var$__decorateParam$n(3, (0, $7yNYd.IUniverInstanceService)),\n    $bb9ae9d90429a70d$var$__decorateParam$n(4, (0, $3e0Iz.IRenderManagerService)),\n    $bb9ae9d90429a70d$var$__decorateParam$n(5, (0, $7yNYd.Inject)((0, $7AR1b.DocSkeletonManagerService))),\n    $bb9ae9d90429a70d$var$__decorateParam$n(6, (0, $7yNYd.Inject)($bb9ae9d90429a70d$export$6dc2db33d8a277cd)),\n    $bb9ae9d90429a70d$var$__decorateParam$n(7, (0, $7yNYd.Inject)((0, $7yNYd.LocaleService))),\n    $bb9ae9d90429a70d$var$__decorateParam$n(8, (0, $7yNYd.Inject)((0, $fL2Ug.ComponentManager)))\n], $bb9ae9d90429a70d$var$DocHeaderFooterController);\nconst $bb9ae9d90429a70d$var$SidebarDocHeaderFooterPanelOperation = {\n    id: \"sidebar.operation.doc-header-footer-panel\",\n    type: (0, $7yNYd.CommandType).OPERATION,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        const sidebarService = accessor.get((0, $fL2Ug.ISidebarService)), localeService = accessor.get((0, $7yNYd.LocaleService));\n        switch(params.value){\n            case \"open\":\n                sidebarService.open({\n                    header: {\n                        title: localeService.t(\"headerFooter.panel\")\n                    },\n                    children: {\n                        label: $bb9ae9d90429a70d$var$COMPONENT_DOC_HEADER_FOOTER_PANEL\n                    },\n                    onClose: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(()=>{}, \"onClose\"),\n                    width: 400\n                });\n                break;\n            case \"close\":\n            default:\n                sidebarService.close();\n                break;\n        }\n        return !0;\n    }, \"handler\")\n};\nfunction $bb9ae9d90429a70d$var$getEmptyHeaderFooterBody() {\n    return {\n        dataStream: `\\r\n`,\n        textRuns: [\n            {\n                st: 0,\n                ed: 0,\n                ts: {\n                    fs: 9\n                }\n            }\n        ],\n        customBlocks: [],\n        paragraphs: [\n            {\n                startIndex: 0,\n                paragraphStyle: {\n                    spaceAbove: {\n                        v: 0\n                    },\n                    lineSpacing: 1.5,\n                    spaceBelow: {\n                        v: 0\n                    }\n                }\n            }\n        ],\n        sectionBreaks: [\n            {\n                startIndex: 1\n            }\n        ]\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getEmptyHeaderFooterBody, \"getEmptyHeaderFooterBody\");\nfunction $bb9ae9d90429a70d$var$createHeaderFooterAction(segmentId, createType, documentStyle, actions) {\n    const jsonX = (0, $7yNYd.JSONX).getInstance(), ID_LEN = 6, firstSegmentId = segmentId != null ? segmentId : (0, $7yNYd.Tools).generateRandomId(ID_LEN), isHeader = createType === $bb9ae9d90429a70d$var$HeaderFooterType.DEFAULT_HEADER || createType === $bb9ae9d90429a70d$var$HeaderFooterType.FIRST_PAGE_HEADER || createType === $bb9ae9d90429a70d$var$HeaderFooterType.EVEN_PAGE_HEADER, insertAction = jsonX.insertOp([\n        isHeader ? \"headers\" : \"footers\",\n        firstSegmentId\n    ], {\n        [isHeader ? \"headerId\" : \"footerId\"]: firstSegmentId,\n        body: $bb9ae9d90429a70d$var$getEmptyHeaderFooterBody()\n    });\n    actions.push(insertAction);\n    const secondSegmentId = (0, $7yNYd.Tools).generateRandomId(ID_LEN), insertPairAction = jsonX.insertOp([\n        isHeader ? \"footers\" : \"headers\",\n        secondSegmentId\n    ], {\n        [isHeader ? \"footerId\" : \"headerId\"]: secondSegmentId,\n        body: $bb9ae9d90429a70d$var$getEmptyHeaderFooterBody()\n    });\n    actions.push(insertPairAction);\n    let key = \"defaultHeaderId\", pairKey = \"defaultFooterId\";\n    switch(createType){\n        case $bb9ae9d90429a70d$var$HeaderFooterType.DEFAULT_HEADER:\n            key = \"defaultHeaderId\", pairKey = \"defaultFooterId\";\n            break;\n        case $bb9ae9d90429a70d$var$HeaderFooterType.DEFAULT_FOOTER:\n            key = \"defaultFooterId\", pairKey = \"defaultHeaderId\";\n            break;\n        case $bb9ae9d90429a70d$var$HeaderFooterType.FIRST_PAGE_HEADER:\n            key = \"firstPageHeaderId\", pairKey = \"firstPageFooterId\";\n            break;\n        case $bb9ae9d90429a70d$var$HeaderFooterType.FIRST_PAGE_FOOTER:\n            key = \"firstPageFooterId\", pairKey = \"firstPageHeaderId\";\n            break;\n        case $bb9ae9d90429a70d$var$HeaderFooterType.EVEN_PAGE_HEADER:\n            key = \"evenPageHeaderId\", pairKey = \"evenPageFooterId\";\n            break;\n        case $bb9ae9d90429a70d$var$HeaderFooterType.EVEN_PAGE_FOOTER:\n            key = \"evenPageFooterId\", pairKey = \"evenPageHeaderId\";\n            break;\n        default:\n            throw new Error(`Unknown header footer type: ${createType}`);\n    }\n    for (const [k2, id] of [\n        [\n            key,\n            firstSegmentId\n        ],\n        [\n            pairKey,\n            secondSegmentId\n        ]\n    ])if (documentStyle[k2] != null) {\n        const replaceAction = jsonX.replaceOp([\n            \"documentStyle\",\n            k2\n        ], documentStyle[k2], id);\n        actions.push(replaceAction);\n    } else {\n        const insertAction2 = jsonX.insertOp([\n            \"documentStyle\",\n            k2\n        ], id);\n        actions.push(insertAction2);\n    }\n    return actions;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$createHeaderFooterAction, \"createHeaderFooterAction\");\nconst $bb9ae9d90429a70d$var$CoreHeaderFooterCommandId = \"doc.command.core-header-footer\", $bb9ae9d90429a70d$var$CoreHeaderFooterCommand = {\n    id: $bb9ae9d90429a70d$var$CoreHeaderFooterCommandId,\n    type: (0, $7yNYd.CommandType).COMMAND,\n    // eslint-disable-next-line max-lines-per-function\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, params)=>{\n        var _a28;\n        const commandService = accessor.get((0, $7yNYd.ICommandService)), univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), renderManagerService = accessor.get((0, $3e0Iz.IRenderManagerService)), { unitId: unitId, segmentId: segmentId, createType: createType, headerFooterProps: headerFooterProps } = params, docSkeletonManagerService = (_a28 = renderManagerService.getRenderById(unitId)) == null ? void 0 : _a28.with((0, $7AR1b.DocSkeletonManagerService)), docDataModel = univerInstanceService.getUniverDocInstance(unitId), docViewModel = docSkeletonManagerService == null ? void 0 : docSkeletonManagerService.getViewModel();\n        if (docDataModel == null || docViewModel == null) return !1;\n        const editArea = docViewModel.getEditArea(), { documentStyle: documentStyle } = docDataModel.getSnapshot(), isUpdateMargin = (headerFooterProps == null ? void 0 : headerFooterProps.marginFooter) != null || (headerFooterProps == null ? void 0 : headerFooterProps.marginHeader) != null, textRanges = [\n            {\n                startOffset: 0,\n                endOffset: 0,\n                collapsed: !0\n            }\n        ], doMutation = {\n            id: (0, $7AR1b.RichTextEditingMutation).id,\n            params: {\n                unitId: unitId,\n                actions: [],\n                textRanges: textRanges,\n                debounce: !0\n            }\n        };\n        isUpdateMargin && (doMutation.params.noNeedSetTextRange = !0);\n        const jsonX = (0, $7yNYd.JSONX).getInstance(), rawActions = [];\n        return createType != null && $bb9ae9d90429a70d$var$createHeaderFooterAction(segmentId, createType, documentStyle, rawActions), headerFooterProps != null && Object.keys(headerFooterProps).forEach((key)=>{\n            const value = headerFooterProps[key], oldValue = documentStyle[key];\n            if (value === oldValue) return;\n            let action;\n            if (oldValue === void 0 ? action = jsonX.insertOp([\n                \"documentStyle\",\n                key\n            ], value) : action = jsonX.replaceOp([\n                \"documentStyle\",\n                key\n            ], oldValue, value), rawActions.push(action), key === \"useFirstPageHeaderFooter\" && value === (0, $7yNYd.BooleanNumber).TRUE && !documentStyle.firstPageHeaderId) {\n                const headerFooterType = editArea === (0, $3e0Iz.DocumentEditArea).HEADER ? $bb9ae9d90429a70d$var$HeaderFooterType.FIRST_PAGE_HEADER : $bb9ae9d90429a70d$var$HeaderFooterType.FIRST_PAGE_FOOTER;\n                $bb9ae9d90429a70d$var$createHeaderFooterAction(segmentId, headerFooterType, documentStyle, rawActions);\n            } else if (key === \"evenAndOddHeaders\" && value === (0, $7yNYd.BooleanNumber).TRUE && !documentStyle.evenPageHeaderId) {\n                const headerFooterType = editArea === (0, $3e0Iz.DocumentEditArea).HEADER ? $bb9ae9d90429a70d$var$HeaderFooterType.EVEN_PAGE_HEADER : $bb9ae9d90429a70d$var$HeaderFooterType.EVEN_PAGE_FOOTER;\n                $bb9ae9d90429a70d$var$createHeaderFooterAction(segmentId, headerFooterType, documentStyle, rawActions);\n            }\n        }), rawActions.length === 0 ? !1 : (doMutation.params.actions = rawActions.reduce((acc, cur)=>(0, $7yNYd.JSONX).compose(acc, cur), null), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params));\n    }, \"handler\")\n}, $bb9ae9d90429a70d$var$OpenHeaderFooterPanelCommand = {\n    id: \"doc.command.open-header-footer-panel\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, _params)=>accessor.get((0, $7yNYd.ICommandService)).executeCommand($bb9ae9d90429a70d$var$SidebarDocHeaderFooterPanelOperation.id, {\n            value: \"open\"\n        }), \"handler\")\n}, $bb9ae9d90429a70d$var$COMPONENT_PREFIX = \"UI_PLUGIN_DOCS\", $bb9ae9d90429a70d$var$COLOR_PICKER_COMPONENT = `${$bb9ae9d90429a70d$var$COMPONENT_PREFIX}_COLOR_PICKER_COMPONENT`, $bb9ae9d90429a70d$var$FONT_FAMILY_COMPONENT = `${$bb9ae9d90429a70d$var$COMPONENT_PREFIX}_FONT_FAMILY_COMPONENT`, $bb9ae9d90429a70d$var$FONT_FAMILY_ITEM_COMPONENT = `${$bb9ae9d90429a70d$var$COMPONENT_PREFIX}_FONT_FAMILY_ITEM_COMPONENT`, $bb9ae9d90429a70d$var$FONT_SIZE_COMPONENT = `${$bb9ae9d90429a70d$var$COMPONENT_PREFIX}_FONT_SIZE_COMPONENT`, $bb9ae9d90429a70d$var$docListTypePicker = \"univer-doc-list-type-picker\", $bb9ae9d90429a70d$var$docListTypePickerItem = \"univer-doc-list-type-picker-item\", $bb9ae9d90429a70d$var$docListTypePickerItemActive = \"univer-doc-list-type-picker-item-active\", $bb9ae9d90429a70d$var$styles$4 = {\n    docListTypePicker: $bb9ae9d90429a70d$var$docListTypePicker,\n    docListTypePickerItem: $bb9ae9d90429a70d$var$docListTypePickerItem,\n    docListTypePickerItemActive: $bb9ae9d90429a70d$var$docListTypePickerItemActive\n}, $bb9ae9d90429a70d$var$ListTypePicker = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((props)=>{\n    const { value: value, onChange: onChange, options: options } = props;\n    return /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx(\"div\", {\n        className: $bb9ae9d90429a70d$var$styles$4.docListTypePicker,\n        children: options.map((item)=>/* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx(\"img\", {\n                className: $bb9ae9d90429a70d$var$styles$4.docListTypePickerItem + (value === item.value ? ` ${$bb9ae9d90429a70d$var$styles$4.docListTypePickerItemActive}` : \"\"),\n                onClick: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(()=>{\n                    onChange(item.value);\n                }, \"onClick\"),\n                src: item.img\n            }, item.value))\n    });\n}, \"ListTypePicker\"), $bb9ae9d90429a70d$var$orderListOptions = [\n    {\n        value: (0, $7yNYd.PresetListType).ORDER_LIST,\n        img: \"data:image/jpeg;base64,/9j/4AAQSkZJRgABAgEA2ADYAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/CABEIAPQA2AMBEQACEQEDEQH/xAAzAAEAAgMBAQEAAAAAAAAAAAAABwkGCAoFBAMBAQADAQEAAAAAAAAAAAAAAAACAwQBBf/aAAwDAQACEAMQAAAA7+AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACrPRXpvZDoUx3gAAAAAAAAAAAfgc027P0wYdAxI12AAAAAAAAMuNiAADmf3Z7hc1u7dU/iMYAAAAAAAAPtMnAAINnHyDYmEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANdZxpZ1VSZHt8mS4YwQUAAAAAZOTqAAAAVM6K9WLIaG3Q6j/P0zhHvmGCAAAAAHqGdAAAAESy5UDpqsJpnjnW+VMwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABVPortYz2AAAAAAAAAAAACnDTVcfmtGPkOgAGQkwgAAAAAAAHN1to6MMV/qnikYgAHtEnAAAAAAAAGgN0Isly1HPYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEcuUc66bn8tuwcJAAAAAAAAAAACn7TVaznt5wNufpnw6BhZhYAAAAAAAPaJOABBE488WynpNxXyPHoj4j4AAAAAAAGQkwgApU1Uw1LljdNkISjbJntAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH//EACoQAAEEAgIBAgYCAwAAAAAAAAYABQcXBAgJFgMKEAECFSBAYDA4FDpw/9oACAEBAAEIAP1PkJ5Ph/SMkjyEwngx3J3W2nknkmDt1/yfhi43wyfnzfhwP/3Z58vc6ycjDFXTIxOyES7IRLshEuyES7IRLshEuyES7IRLshEuyES7IRLshEuyES7IRLshEuyES7IRIFe3nMKmvHy/t4H/AO7PPkhPkT1GNtxzfQodTi3Ybrh+bAz68D1Xgeq8D1Xgeq8D1Xgeq8D1Xgeq8D1Xgeq8D1Xgeq8D1Xgeq8D1Xgeq8D03Bo21Znhz8D7Yl1pgeCSmXTaIGHUnWgX2CK9rB7/hO2x3OMaa3y4a60xnxR7+TrG7HLu3PD/tPs47TXvFx4bg+xk45jUNuWfgWGYKwzBWGYKwzBWGYKwzBWGYKwzBWGYKwzBWGYINMiR1JG3Az/4ebLdeTtCOPyTpyheNeEuDDuKhyWdx/T9/JAfh5OuVvD1djzZfXyWpGk+IoxTy047425LXl1QOqqB1VQOqqB1VQOqqB1VQOqqB1VQOqqB1VQOpmj5mY3LGdMT+GdYLijZeJTiDJwC/T5aei2A3BT9AmgmtGss5zHsDCut/GxqXqhsNsFs/Cv7gT8nWSO8p4Pxn/J+UW7rzkz84MYaHYXsVO2QxsOe6YlrkStciVrkStciVrkSFZBeXx+wGvL/BkH/aNgxZL6yYTo2MeYiFn+vM+Y0qoVUKqFVCqhQ9HH0F4w3b8J80CEHzkeDeRzy7D8U0X7EchGtPIY9/rs7TtE2s0TG05Tl4PUFYTqN3MNau7SwfuTC4rPuvX5HLVoZNvIJ8mm0YB7q6h0aBjg9PHpucPwPTdyYy7G/sXl/VPpyt5W8reVvK3lbyt5W8reVvK3lbyt5W8reVvIekf688YbT9uy+ykO6iQmdbBTy1RRvFz2+dmOthYiiKNIEjQMhyHPY7E3En+lf4FUESqgiVUESqgiVUESqgiVUESqgiVUESqgiVUESqgiVUESqgiVUESqgiQrHzyxv2A6Zf2c0HGjO/JqCwHHMU+LUT1Cvg8Xj8Ph0WirfyLmmRsfe/jH0S2j0yINqXrZH9m//EAD0QAAEDAgMGBAIIBAYDAAAAAAUCAwQBBgAHEggRExSUpZXU1eUV0wkQICIjM0BgISQwWRYXQkRit2Rwtv/aAAgBAQAJPwD9p5DZw7T21TngDKE8lMlsrQSnYZuo+ekS4SvG7NMxdsW5CIuN/E58AHcEuHF1TJMKKORIIxrsBlL22dNocNloNse1QlqDrRytJxC2aoO9bOtUvb41kpcoAeYtKLAGF7nOXOSkxBrMz4s+7NlyJP6mOxSY4w3Fcl0abpJXGZcddajrfoniqYadfecbaquraHHnVpTRTi61/uKXl/21tIfXIfiyG+R4b8d1xh5GsjDQvQ60pK06kKUhWlVNSVKTXfStaYPmvFJ3z8HzXik75+D5rxSd8/B814pO+fg+a8UnfPwfNeKTvn4PmvFJ3z8HzXik75+D5rxSd8/B814pO+fg+a8UnfPwfNeKTvn4PmvFJ3z8HzXik75+D5rxSd8/B814pO+fg+a8UnfPwXKSo7nPcRiRPlvsr0Dpi0a2nXVIVpWlK06k10qSlVN1aUr9r+4peX/bW0hjNFMzacy/BKP3BZC7cuWMOq1HFDTpQYLu2QKbtcsdChTIwoVEQirstiK/K4SH3gx5kVhnjxH+HxWuI61r4TqHm/xGVtup0utoV91dN+7dXemtaVEdwKedwI7gU87gR3Ap53AjuBTzuBHcCnncCO4FPO4EdwKedwI7gU87gR3Ap53AjuBTzuBHcCnncCO4FPO4EdwKedwI7gU87gR3Ap53AjuBTzuBHcCnncDeBLY4nCd5ye7o4rS2XPw3pTjStTTi0/eRXdv303KpStPs5YWzYN1593pJzEziOAWJDM7MG9phE2WlXIfU/JfQ8RfJXIcmLWwhhurxOTWjdKKTROSeX4jaLvgEzbV15vQgbDV4Gg7LECJViRN31abkyYYoXBnkozDBMlBHQYJCZKiRGGW//ROVf+defYe1loypy0XPHDolwXiVnwgwyQUklSwGGoJbqiK7oPQ6mhcokGCzx0CdGnyozqfpbtu/K/aTvkBAuorlzs55gwMqsmMoj5aJHnsWPNsK0VM2/en+E1qaFnnhMi2x5abGnMxZUyM58ZI5iIzuzZ2H70tKPZ+fKg0MGZzOyoveIQct167x45NYyLjGj4IIq5PlSiRmei63oBgsZn2++dLfU9wJbHJ8J3htO6OLPisufhvIcaVqacWn7yK7t++m5VKVoX7eL8lgv28X5LBft4vyWC/bxfksF+3i/JYL9vF+SwX7eL8lgv28X5LBft4vyWC/bxfksF+3i/JYJceI/wA5xWuTgNa+FAlPN/iMxW3U6XW0K+6um/durvTWtK/0YkOuac07Z+XFl3ATHNGBlkEr3KKhyb0liZLT0AjJCiYpH4DGKocDquiSDWXhlhyJIYjthbXe05mPctnDb/vnNIxtS3haWWcFwoGaPFZeXom1CQwVbeXUOO84+K5wwWjMikc2zMiD1MwolyH7wyDFhMpA2W113Lcpm8idyCAhMuJmG27quB6QXuAOSNQicu2ysp51My3XRTsZdYimMZzZcX7mfksQQKzWsS1brEGbmsIkqVJHuQrkFwpLsmBJhk4csSSaWmqhRiM+JJUikmlxaYW+3HlcHiLjqbQ9TgPtSEaFOtvIpvWymitTat6aqpTdWtFUmmuog+nYmmuog+nYmmuog+nYmmuog+nYmmuog+nYmmuog+nYmmuog+nYmmuog+nYmmuog+nYmmuog+nYmmuog+nYklHJEXjcNEh6ItmvHYdjr1pahMrruQ8qqdLidyqJrXfSlU1/o2WKzAytzFDqCXXaxejyY82NSQxNhy4suI7HnijAcnFhGAJwXKhlgZqBALipkQhDjSG889u3M/IcW6yqLsv5hbU1xO7PNI8Z2j0Uc7Y1ngrOnPDI7lK1TBcuBTLyVLblUfacWhVmv2TeOd9rZa2VdYITMbh2AJtfKW2htpWQGsyy4USKKtWCLBiYMWscemjLnCqqjaNW6ljFbezX2lJ06dmHPmXSaLhoqjVxO3hc0W1Ak6Q5EAwbmu1bdwFIieZajy4sSEDoHDMJGfvHZfzVJMXflw9fj20QzMo1aA3TaZi7G349t/AHkEbGZqHdtErfDt3jHR9/LrbDNsT9CJ736qfbadn66ti4hngXHOW7Hculd+R7ozDEtyGLmq9SSwMpDtsYmo1LNW6uJeXr3vVpT6kMuSIvK8NEhLi2a8eZHjr1pacZXXch5VU6XE7lUTWu+lKprCC9PO9RxCC9PO9RxCC9PO9RxCC9PO9RxCC9PO9RxGGNx5XNcRcdmWh6nAhyJCNCnZryKb1sporU2remqqU3VrRVP0P9s8v/APd5w4MCohs0iY6HDySERgoWaHNJeIODB7ryJc9EBlaXZi4rLqYrSkuP1QitK/VI5Tm+X/mODx+HwJTEn8ris6tXB0fmJ06tX8d2mtw9p9zxcPafc8XD2n3PFw9p9zxcPafc8Geb5TmP5f4dwOJx4r8b83nntOnja/y1atOn+G/VT9DmBcjF62bs9StnuNlu2MFqtaaGlGrqNKuF8qpXxZsmh26pDNIraeVq3EZVWupa8Zs5q2zfmzgJCCB9gApo5dnXMxapu57iAJW/MjuFLejSSN3F494QBrr0G6hHBhcATJdJkCX7dvYTl7lfl6JWZui6DK3asRWKutRYcKFDitSCBc0XISIooECFRZhc4XmQhQqFLny2GHPox/pH7i2U0sVKq2iIGTMFwI5acdt10he0QUwZlCHrSiMx35Xxx284w9MRCVzpA+SusRF6xb5y3u1D7cUg3HkjyYgvAUloxbVyBpzbJAHcYSSqkckNmNJVTUzMiOyxsyDNk/qDuX8XZ6sLahs3NjattO8j1wByd95cWzPFRagbYhiLYuAdcUytulL8rQLccwIKeMPW8+uZRTFZMGbb1jWBYdtyCBIhMdgW/a1o2lbQ1T8mTIdXWKMCggYmGpa1V5eEPgxq/lMtbqCFgtlzNrbyzENbNw1sVKCiq2pEnHJLkq34D0eHGQHYtc1YFvt8jEaaizLemiHtEgU5Fi/UO5/n+b/3fK8LleW/8aRxOJzH/DTo/wBWr7tvd29sxb3dvbMW93b2zFvd29sxb3dvbMW93b2zFvd29sxb3dvbMW93b2zFvd29sxb3dvbMW93b2zFvd29sxb3dvbMW93b2zFvd29swG5Tm+Y/mPiPH4fAivyfyuRZ1auDo/MTp1av47tNfsXbGs3LXL8ZSeYJOIVJnz5ch5EQRb1vjG60kGbkuEm9GFAxMb8WZOktUWtiOl+Qy/dOxN9FKQlwrgsfZ9t+e3C2gNqkFEkUm27c+ZRqkaQ1b1nmHW45iGxVPwb4fQau1rfuWXUXm21ZgXL7LLL4Kxb9n2fb7C2BgYYwtx5SEKecflzJkyW/JIlSpGTLKmSsuaWLTZpKbKlPfU9CZ5HnuLzjj7ermeT4fD4MaRv3cuvXq0bt6d2rfXTNC9RO9OxNC9RO9OxNC9RO9OxNC9RO9OxNC9RO9OxNC9RO9OxNC9RO9OxNC9RO9OxNC9RO9OxNC9RO9OxNC9RO9OxNC9RO9OxNC9RO9OxNC9RO9OxNC9RO9OxNC9RO9OxJGOR4vNcREd6Wt6vHhyI6NCXYTKK7lvJqrU4ncmiq031pRNfsZ4WNlPaWV2YB7Mq9QV/W0UuoJe9ysDBYnL958NCaegTo1tw5d9MzIRlp+DMZuSjKor6KvUT9K/s4sssoQ0001si5aNtNNNpohttttGWlEoQhNKJQhNKJSmlKUpSlKUxtS5e7TxYwRtt7LchYOVNvZWt2gOhxi6Llhk49v27bzZlZeTIDPxHpLclcNMCQhtbaZCkq2zLt2rWc8MyB902ANPv3S9BsQaPm3hLJF0R7pNm0hT96JuQUwbt+2FMW6MatQYhmaZouNUX+5v//EADkRAAICAAQDBAUJCQAAAAAAAAECAxESITFBAARREzJAYWBxc6HwFCIzgZGxssHRIzRCQ1NUcJPx/9oACAECAQE/APROGAyhnLrHGh+ezHTK8hufKx+XHNxRRrAYgadCxJJtu6QSCaBz2A93i+b+i5P2I/DH4vm/ouT9iPwx8GGQRCYr+zJoNY6kaXYFirr7x4ppHcKGYkIKUH+EZCh9g4MkhQRlzgBsLeQPxtp/gqMIzqHbAhPzmq6Gv2nQdLvhuYhRisfLRMgNBnGJmA3xHMXtrXuHMxoFimjXAsoNpdhWGteWo6CtBdeJ5WJZplRu7RYgZE1tfnvWdXXXhuacMVijjjAJAURgtrVMSDZ65DPjnMfYcv2gAe2xAACjQyoZA1r58FHVVZlYK3dJBAPqO/iEdo2DocLLmCPj7RweclOYWJX/AKixjH67JOf1cPM7oqMbCFiOpLGySdTZPDzySIkbm1Tu5AbUL60Mh+vpiIL5cz9ouTVg3OYGt5HO6ru534sRIeVabPGJcAzyqlOnXPxa/uD+3H4V4/LxQmIgMFCi+PFvdAV024TmGSF4QqkPeZ1FgA+vQV0PX0eRGdgiAszGgB8adToBx8jN4DPAJNMGLO+mmvlXEkbxMUcUw942IO4PXxPLTJD2rEHGYysZABAY9cxWdZja+MyazJJ9ZJP3knjnv5CsbkWECTc3lr53iP13v4mNGkcIgtjp+ZPQDc8FouUsJUvMaFz3IzuFG5H/AEju8MzOxZiWZjZJ3+PdoPE8rOkBdmQsWAUEEAgb5+eWnTjtOT/t5P8AYf14laFsPZRtHV4sTFr0rUmqz4nljlEeCIR4VokVnpllVgVkTnnt6T//xAA2EQACAQEFAwkGBwEAAAAAAAABAhEDABIhMUFAYYETMlFgcZGhsfAiQlJywdIjNENTcHOS4f/aAAgBAwEBPwDqm9QIQoBZjko+p08bUXdjUDnFWiBEDOQO7ftdHn1vnPm210efW+c+bWvqWKT7Q0/7l67dqCqpJAgsZO82urevQLxwnX+CmJCkqJaMBv8AWNhTciWquGOMKYA3QM+EWpM156bGShwPSN/hvx2mq5RCRngBunX1rYUVIl2ZiRJN7DhutRjlal0ysYHiLBlJIBBIzAOW0EBgQRIOYsKCZS5HwlvZ7hHnYIqsWAgkAbgBAEDhZaaqzMBBbPzw49ceU/EFO6cRN7TKe7SZzwjay7Csqe6Unjjrw2s/mF/r+7ayk1BUnJbsd+PjZqYZ1eTK6aYeWePT1eJCgkmAMzbl9RTqFfijx6I42Vg4DKZB9QdpqIXugRdDAsDOIHRh2+FsAOgDuAFqH6hHNLm72Y/SPQ2lmCgschaHrYtKU9F95uid2vlPOsAFAAEAZDaatNqgUAgAEkzqdO7Hvtdr/uL/AJH22QOJvsGyiBEdOgtTRkvXnLSZGeGeOJzOvZ1n/9k=\"\n    },\n    {\n        value: (0, $7yNYd.PresetListType).ORDER_LIST_1,\n        img: \"data:image/jpeg;base64,/9j/4AAQSkZJRgABAgEA2ADYAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/CABEIAPQA2AMBEQACEQEDEQH/xAAyAAEAAgMBAQEAAAAAAAAAAAAABwkGCAoFAwQBAQADAQAAAAAAAAAAAAAAAAACAwQB/9oADAMBAAIQAxAAAADv4AAAAAAAAAAAAAAAAAAAAAAAAAAAABB8+ThDoAAAAAAAAAAAqz0V6b2Q8ProwxXgAAAAAAAAAAD4HNNuzyjHt82S7Ked1gPIAAAAAAABlxsQAAcz+7PlvO9F2K/6mJHwAAAAAAAB+0ycAAg2cdIrY2n57AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABh/eZhzoAAAAAAAAAAAA50dtHRdivAAAAAAAAAAA11nGlnVVJkexTLnR1ivxggoAAAAAycnUAAAAqZ0V6sWQ0NuhuPVPo4xX+YYIAAAAAeoZ0AAAARLLlQOmqwmmem1kbmM1oAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGId5X1dDSa2HQbjvAAAAAAAAAAAHmFS2mrUGyPR1ivx8h0AAyEmEAAAAAAAHh9c+Wyjzjo6xX+KRiAAe0ScAAAAAAAD8ZofdDSy2F5+S4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACI5co5103P5battFd5mS4AAAAAAAAAACn7TVaznt5wNufK+d6PMV/wCIiQAAAAAAAHtEnAAgiceeLZT0m4r6CtdPR5iv88g0AAAAAAAGQkwgApU1Uw1Lli9Nlbt1fQ3jvAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH/8QAKRAAAAYCAQQCAgIDAAAAAAAAAAUGBwgXBAkDAQIKFhVAIGAwODY5UP/aAAgBAQABCAD/ALTfSSZF03SeJkkL9jYTs+T8I1I3jJonRjMma0p3J2TI6a+zPNy4ObQNdmxJNfY6YuN0ye/N6aH/AO7O/IeTqSYRhqhcBQcyGN81QIlHHxkFAoD7hPjvh4fZFEPZFEPZFEPZFEPZFEPZFEPZFEPZFEPZFEPZFEPZFEPZFEPZFEPZFEPZFEPZFEEKdnOYqivHy/x0P/3Z35DyJO7JexCwY19pbg4ODF4OHGxhkoVK5mRkZeRXiPFeI8V4jxXiPFeI8V4jxXiPFeI8V4jxXiPFeI8V4jxXiPFeI8V4jxXiPBcjU2VZnDn4H4tLGlh2JVLurZoEfBp0FTtEX8/5CfqyMcNAOPhmxi3n2isz5NeG9rkb4v8Ary2Xb4tpG93FrGls9Uc/H1bcjd2XOn+U8nDZ65xa8Jg+Qpz9EEYapH/LQsjHMKk2ZZ+BYawFhrAWGsBYawFhrAWGsBYawFhrAWGsBYawFhrAI1ZKQ1UhbgZ/8O7Ka7nQI1+Oc+TLtrpLYxdtUnHZmP4/fYwfDs62t4cXd1nbyv3NHThCJOg5Kcc8Lckry6oToqhOiqE6KoToqhOiqE6KoToqhOiqE6KoToqhOgmb4mIzLGNMT+F9WLaiS7SrhjHwRfj5Q9S2AXIo+YSAkaIyvm8cgWVipEx+VtsmldsRlx+3uCrOqBQS3XXTWFsA49oEbFW8xzqnXB3E6Zc1NQy7+wd5XLgkxvm4+j6Zj2zygen5AyB2B9ORn98unR6CUKo2yCMhzzTEtdRC11ELXUQtdRC11EEq4JyeH2AV5f0FP/jahHi4/wCqJIib3d1e/wAgXVIyxUFCT/PE+YUioRUIqEVCKhCebj4E4wzb6Jjh9piX5xf3674NIzWjFnHjukdVTGu04kiZp7QpK/rr7Ps00ZmmWz5PlweQVhGqbuZNRdlKx8yWXSr+x610SBdxr5wzZ1gyO+vtqgY9uwTshs2CPNTVHNojDA6OPG5w+A6LtmLutvsy6UZuj0vSRIgZZnx5dn54t4W8LeFvC3hbwt4W8LeFvC3hbwt4W8LeFvBPOP8APHGGU/jJeSjOxEZNdSCfkqaicW+3nJl1IVomibRhG0RjOM5tn6cbqbZNFzCkIN8TkzyozweGqFEKoUQqhRCqFEKoUQqhRCqFEKoUQqhRCqFEKoUQqhRCqFEKoUQqhRCqFEEq3xyRn2AaZf4boNaL77NUKwbctTxRE8hXg4uPh4YNtfPdpyRyu2euvkr5p27O5cbQsz9m/8QAPhAAAQQBAgMGBAMFBQkAAAAABAIDBQYBAAcIEhMRFJSl1NUVldPlCSFAICIjM2AWJDBZtxAXMkFQVVe0tf/aAAgBAQAJPwD/AK1fgJrdjYEyuhbvUN2OnYawU1dtCIkqwWSLOxcYmUiZ0AZ0yLnIJyUhix8suNHqSQPl39RsNvDxPcVO+EHKSeymy21sEp0ObzHnpiXJK42zlMXWK4FIuN/EzwIOwFhi8xhIQscgiRGtkHKXbh04h4bbSNo9VhKpHVHa2TElt1YO606qy9fjWZSywEfMVIUCMl7POWeSJEjWTPiz7ppZBOfhlF30n1cAXFehD2AYyWq16NxNbU2OXwwO7ksqrySp60GHP5SS4JtlU4NL/cVLSz+oHYwY4w2K4XhpvBKxmXHXWh1v4T1VMNOvvONtZXltDjzq0pwpxec/5ily/wBWuJDSktStC3j2Ot1ZJx+T4k6u6sVXvIi+dOWiURFolsYcThzOGlOp5MYVlxCOlIzdWr8ue3ytI6ZslEiGFI5GHXmEcj7zieVl51pPZ2NuuIxhWdTcu0y1LyTTTTUkY22222Y8lDbaEvYShCE4wlCE4wlKcYxjGMY1PzXzQ76+p+a+aHfX1PzXzQ76+p+a+aHfX1PzXzQ76+p+a+aHfX1PzXzQ76+p+a+aHfX1PzXzQ76+p+a+aHfX1PzXzQ76+p+a+aHfX1PzXzQ76+p+a+aHfX1PzXzQ76+p+a+aHfX1LyhQ7nfuowQeW+yvkjjFo52nXVIVyrSlaeZOeVSUqx2ZxjP7X+Ypcv8AVriQ0tb9440OMihxxYLGHHHB9qtuWXHdwbAS2ytp1kGuH3CozhhPeGFIjoyScZypbK1sMtDjDtNsDjsNoZYYYZRhtpllpvCW2mmm0pQ22hKUIQnCU4wnGMf7IvqEFPukPud+kUc7z7inXV8iDEoTzLUpXKhKUp7exKcYxjGojzCU9bqI8wlPW6iPMJT1uojzCU9bqI8wlPW6iPMJT1uojzCU9bqI8wlPW6iPMJT1uojzCU9bqI8wlPW6iPMJT1uojzCU9bqI8wlPW6iPMJT1uojzCU9bqN6BbHU6TvfD3eTqtLZc/hvFONK5mnFp/eRns7e3HYrGM4/Z2wrNBte/d0J3E3inIFghk7cG7GSM3LFWSfU+S+h6RfkrJOGLWwhhvL0mTnDeMKThM7t7J1vbfamM2U4KqLSpezS8nTK7OInHN075uQ3P1WvxsVe7CuWLiIoSqSNijEV2elAzz+8R4b5v9LXmn3yPgZ+Rqk6dTLNC2gOFtMQkdctWpYqDNOYjp+LQYIuRhzFsyISSh1EjNYfayr9UMqM4bfxdqGdeAgG0NiQVT4vdoAD82k6MZxleEqvcUoEuyuMISVNXPdaDWSpqPrwuMfp9q/8AfXv3D1ZaNqdtFnx0cJYLjKnhQ0YRKEystAhqhK6qRXaJ4PM1FlSUNCnxwBwx5QzqfxbuO/a/iTvMABapXbnhz3BA2q2Y2in5YQc9ijm0KoqZr90/smtTUXPPRJFbj5Y0Y5kUowZz4zI7iI3u3Z4H7pUh6fvyqGDg5nc7ai7iSDldet8fHJyMixxseDBSrh5RUlMnotbwExLTJ9ffnZbPTte1H4lOzsfEOIYQt1yKs7JVjngcvKdaV3WQVtxEimBcyWT2V8r60YZR26e6BbHc+k702neTqnisufw3kONK5mnFp/eRns7e3HYrGM4l/L4v0Wpfy+L9FqX8vi/Ral/L4v0Wpfy+L9FqX8vi/Ral/L4v0Wpfy+L9FqX8vi/Ral/L4v0Wpfy+L9FqS64j/fOq13MBrn6QBTzf8RkVt1PK62hX7q8dvZ2Z7U5zjP8AgiB53TNnaftxS7BJxzUxGUiSu8ooMm6FxJLTwEiTCxIsj8BGlUOQ6rQTBrlw5aOQTDSPGFxd8Tm49lp0bf7zulMcUtwqW2YLkpDNT0qXt7E1SSjIqt7dBjvOPxXfJiWGZikd7ZMEj1MhCWSfuGwcXCbSQ221rstlmblJ2SIhJOXiTJtu1WB4iXsEPJTQUmXW5Up51JlddinRl5EUxpCpWXtfFqjiZvkcKjrEQm2uw7IBklLGsuuIGQNKVo7cruLzrRGMPVo5tWE5U2Mfpb7Y5XR6ix1Noex0H2iEcinW3kY7VspwrmbV2pyrGOzOcKwbNeIB9u0bNeIB9u0bNeIB9u0bNeIB9u0bNeIB9u0bNeIB9u0bNeIB9u0bNeIB9u0bNeIB9u0bNeIB9u0bNeIB9u0TKOEC9bpoIeEWznrsOjr50tBMrz2IeVlPK4nsVhOc9uMZTn/BpcVuBtbuLDqhLXVpfDyRzRsEMGhliliOjnxUxDyYoUxAzkWUHLQc0ABLxRgkgGMQ3vnx27n7DxbrKheF/cLimsTvDzgcZ3Dwsc7RqfBU456MHcxnKQXLApl5KltlYfacWhVNfpNx3vq22tKtcFEmNh0CJq+0tajalSIamUsIQWKqoMXBxIIuR49OGXOllWG0c3Zih/2FLjYoLho4INu5G2026m0/YCCdeLsu5pDtMm7JDwE5uzMOOTQkS7JN2WsNWW91+TQuNkAHHf6vr1htuaXULLbMVSpApk7XZs1yGNmMV6sxq3h0SFhmu5/DYUFb7KS5IkZhTzeHMrTw7W3YePD3Ftu1ZNOusqm2RVsjYyKhy3ZuDnnqzUfjMUWLP5hZsVdeaYi5+PmYRB0rgJZapyYmK/tZNn8UXBvLT58nJku8OG68rHS81t61LTC+tIL23s1sjWMPNqIfmJ47cQ7HSCiMNtfqMpw+HGHlM5UnmTh0cV15vKk5/wCJOFoT2p/54/LR1ckdxZHczcarEk1avj1mJzE1mRDGi0IixnXmkPoaeXh57C+Z5XZnOMdmkuDm720viC4crh0kqbbm6xBRL5kOCY50VoeRE2DeNE40hC+qgkIPLqmmcoyvSGXCBe69NBCXFs565g46+dLTjK89iHlZTyuJ7FYTnPbjGU5ChfDne46ChfDne46ChfDne46ChfDne46ChfDne46GjGxyu9dRY7JaHsdAMghHIp015GO1bKcK5m1dqcqxjsznCsfoP+xy3/oEa/8AN28//wBmO0nviOG7Z7fbiYu7rXOQzCRlvj5qAr/eksN4wKUTaNsayNlJJKeRqbiiFMYQSKk/RHdO993/ALx0ev0+gUwT/K6rPNzdHk/mJ5ebm/Ps5c2Hyn7nqw+U/c9WHyn7nqw+U/c9WHyn7nqZ733TvH93+HdDqdcV8b+b357l5etz/wAtXNy8v5dvNj9AtTaDgyg1uJxjKm0lMLYUtOM/llScLyrGM/lnOPz/AC1erbuZW67ZrrfF2Obr7WLGQuxutSJoA0DVmTXj1jYE6YAkcMVInuLSwwO8QttpW2t72k3O4n7orafYnavc2sydKvW2fCjta/HRlSbs9RlRwJKBse4BcBByU7HSYOHVvVIOxAOqGtLynf6du0Tt7tft7ErmbRaJlbuWBWMutChhBBitESEvNS8gQLFQUFFCmS85LmBRUUEWeWww5+GP+I/YuFNLGZVXEQBsyC5COVMdt12QuwkUxMlRD1SEZHfK+OO3MaPSIhKziI8leREXUW87b21D7Ysg2OTHycRLgKS1MVqyQxzbMhB2OEJVgeSjTGkqxzMmCOlxpgJpO49p3SnNrZQTiJ4VtzdxbAdP3e6cN25OY0pymyk7NkLlLOVtJKTMRX/jLiijDj3LUytTEVBRqMfp53b8Xh6oXFDTd2OK2p3KesEPJ3vbisnxQuYGsBxFYsEdYjM12UvmcQtjMhIp6Yerz6zMKYySCbXqNQKHWyJCSkDHQK/VqjUq1GqfJJIdXkWMhYKDiQ1LWrPdwo8EbP8AKZa7MRC4Lhc3a48txJrhujW4oqFis1QQ6cJcKr4Dw4YyIdirzVAr7fcRGmhTK8bEPchEU4KK60Gfu7NbucJt6ypbrTcvXJ1uHjKjHmYR2tlJYm95Z6TAbcwnLctHxjmcrS2jLGm+t3EIozpc/T6vdmHHun1OVfJz8nLz8i+Xt7eVXZ2Zr3m32zVe82+2ar3m32zVe82+2ar3m32zVe82+2ar3m32zVe82+2ar3m32zVe82+2ar3m32zVe82+2ar3m32zVe82+2ar3m32zVe82+2ahu6d77x/ePiPX6fQFfJ/ldxZ5ubo8n8xPLzc359nLn9i2jU3bXb+MwfMSTiFEnnlkPIEiK9X4xvOCJmyWGTeGioOJG/imHEtYWtgdL5DL9p4JvwpZAsKwUfh9r57YXEBxUwQhGDa7Z9yprAxDVep8w62PMBsZT8G+H4jV1av2UvMXu21TIXb7bLb6FYr9Pp9fYWxGQ0Ywtx5SEKecfLMMMLfJkZWVkSS5WZlSzZaWNNkjSinsNGWat727qcQ9hGxlayIyq7dIoNuANU0w8hxI0gxtrd/476UsJehEpx3lHemE6UhLxseaI0p3KsNpcJGcZQpzKUrVhGFLxleUoWrCe3OEqz+WTYXxB3t2jYXxB3t2jYXxB3t2jYXxB3t2jYXxB3t2jYXxB3t2jYXxB3t2jYXxB3t2jYXxB3t2jYXxB3t2jYXxB3t2jYXxB3t2jYXxB3t2jYXxB3t2jYXxB3t2jYXxB3t2iYxwcXvXUQO8Wt7PXDIHRyJdCZRnsW8nKuZxPYnCs47c4wnP7G+FG2nqW124E9uVdYK/VqUtUJd7KxGRcTt+8/DBNPAHDVsMu9MmBTLT4JjNkwyoV9GXsJ/Ff4cWWWUIaaaa4RdtG2mmm04Q2222jbTCUIQnGEoQnGEpTjGMYxjGMa4qduuJiRkjq8Xt5K0bayubVDUuJjxJjFpHl24GvV1iV+KPvRBI5JaCFANx5KUuNIfVhSly2x20MUVwQ8F0k807iMsUHT5NT+7e6dXey6pkyHl7Q7YRK/LtY5Do26TYJDA5sWtkb+pv//EAD0RAAIBAQUEBgUJCQAAAAAAAAECEQMABBIhMUBBUWETIjJxkaEjQmCBsRQzNFNzgrLB8ENQUlRykpPR8f/aAAgBAgEBPwD99MjqquRCvOE5EGNdDkRwMHaaNA1Qzl1p00PXZjplOQ3nlI/K17pUqa0DSBh0LEkmW7JBIJgHPcB5Woelu9aidUHTU+MjtD35D7xO1Xv5q5/Yj8NO1w+kAbmVwe6J+IFjkSOBPx2m9/NXP7Efhp2uXVNWsdKVJv7m0Hvg7U1R3ChmJCCFB9UZCB4CxqqKAooGlmx1SYAJHZCwTkOcZjT2XKlYxAiRIkESDoRO7ntZ9NdMXr3Yx30208DpwCnjtFMIzqHbAhPWaJga+J0HCZs14ooxWndqTIDAZxiZgN+I5id2seQvNNAtKtTXAtUGUmQrDWOWo4CNBMWuefyhDo1BifdkPxbRdaS1qyo3ZgsQMiY3Tz3xnExxs16cMVpU6dMAkBRTBbWIYkGTxyGdr5j6C79IAHlsQAAgwMoGQMa87XXqUrzVOUU+jU8Wfd44fHw2dHamwdDhZcwR+vEWN8qnMLSV/rFpjH3ySc/dZ6zuioxkIWI4ksZJJ1Mk2qVEFCnRpmc8dVoIlzouYBIXugwCPbBRJAkCSBJyAkxJO4DfavR6CoFDh+qGkCIMnIiTBynXQg2vAFSnSvIAlh0dUD6xRkfvAeGHjtIteqSUaxRJw4VOZk52o9a6XlT6hRxyJOfiFjaRqO+1/wDpB/oX4WpdS53hv42RBziCfJj4eG01qpr1MZAUkAQDllzNrw6qlKhTYMtMYnZTIao2sHeBJiOMbvZ5EZ2CICzMYAH604nQC3yMzgNegKmmDFnPDTXlFqlN6TFHEMPMbiDvB42rIrUqVdFChupUVRAWou8AaYgCfDjtF2rJR6ViDjNMrTIAIDHjmIzjMbptmTGZJPeST8STa/fsFYzUWiBU3mctec4j7532ode63pD6oWoOREz5KNopo1RwiCWOn5k8AN5sWpXSQkVbxoXPYpneFG8j/pHZszM7FmJZmMknf+vLQWu/Vu97c6FVQcyZHliHjtF1rpQLsyFiwCgggEDfnzy04W6S5/y9T/If92qtRbD0NNk1xSxadIiSdM7Vj0NCnQ0ZvS1e89lT3CJ7h7T/AP/EADcRAAIBAgIGBwYFBQAAAAAAAAECEQMhAEESMUBRYXEiMoGRscHwE0JSYHKhBDNDktFQU4LS4f/aAAgBAwEBPwD+tBgSQDdYkbp1bS9QIQoBZjqUeZy++KLuxqBzdWiBEDXIHdxxU6FRKmR6DduqfHsG1UevW+s+LY/Efl8mGBcDltNHr1vrPi2K9wiDW7juGvxG1BVUkgQWMnicBCahdogCEAm28mwvyyPD5XBB1EHK2/a+pWj3aonkw/nxbhtDEhSVEtFhx9XwKbkS1VwxvCmAOEDX2RikzaT02MlDY7xx+3G+K9vZtmrj738toquUQka7AcJz9Z4FFSJdmYkSTpW7OGKMe1qaJlYse0Yq9J6Sb20jyH/J2ggMCCJB1jAoJqlyPhLdHuEeOAiqxYCCQBwAEAQOzCqxqM7CPdQWMLvtv77kfOBMAm5gTA1nlxxTf2izoxci958MUzou9I5dJfpOV90987VRcuktrkjdipatSbfK+v3bV+H/AC/8j5YfpV6a/CCx4eoG1U0FNdGZuTOKYJZ6jAgsYUGxCjhx5ZTn8vEhQSTAGs49vmKdQr8UffdHbhWDgMpkH1BxTYh3psSY6Sk6ypy4x/O0VEL6IEaIYFgZuButz+2LAbgO4AYofqEdUudHlfyj0MVLVaTb5U8vTHaGYKCx1DEPWu0pTyX3m3Twz8J62AAoAAgDUMVb1aIzBJ7BB8jtFWm1QKAQACSZzOXdfvxo1/7i/tH+uEDidNg26BEb8hhOnUapkOgnZrI8uZ+Z/wD/2Q==\"\n    },\n    {\n        value: (0, $7yNYd.PresetListType).ORDER_LIST_2,\n        img: \"data:image/jpeg;base64,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\"\n    },\n    {\n        value: (0, $7yNYd.PresetListType).ORDER_LIST_3,\n        img: \"data:image/jpeg;base64,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\"\n    },\n    {\n        value: (0, $7yNYd.PresetListType).ORDER_LIST_4,\n        img: \"data:image/jpeg;base64,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\"\n    },\n    {\n        value: (0, $7yNYd.PresetListType).ORDER_LIST_5,\n        img: \"data:image/jpeg;base64,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\"\n    }\n], $bb9ae9d90429a70d$var$OrderListTypePicker = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((props)=>/* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx($bb9ae9d90429a70d$var$ListTypePicker, {\n        ...props,\n        options: $bb9ae9d90429a70d$var$orderListOptions\n    }), \"OrderListTypePicker\"), $bb9ae9d90429a70d$var$bulletOptions = [\n    {\n        value: (0, $7yNYd.PresetListType).BULLET_LIST,\n        img: \"data:image/jpeg;base64,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\"\n    },\n    {\n        value: (0, $7yNYd.PresetListType).BULLET_LIST_1,\n        img: \"data:image/jpeg;base64,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\"\n    },\n    {\n        value: (0, $7yNYd.PresetListType).BULLET_LIST_2,\n        img: \"data:image/jpeg;base64,/9j/4AAQSkZJRgABAgEA2ADYAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/CABEIAPQA2AMBEQACEQEDEQH/xAA1AAEAAQUBAQEAAAAAAAAAAAAACgYHCAkLBQMEAQEAAwEBAQAAAAAAAAAAAAAAAwQFAgEG/9oADAMBAAIQAxAAAACfwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY8d832469EAAAAAAAAAAAGsueOJbo1p/8Aj3fuAAAAAAAAAACkPWuaeOJvoVp5OTcuPz6BiSAAAAAAAVcZEAAHO72aObsXc2fLtgCiwAAAAAAD9pU4ABaDry3vXmUMfQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAh26VXVVYjmyZdvYHD2AAAAAAAAAABq1sR8mD6HNEielP0wsO+KYLFAAAAAFTl9QAAAYrSc8hn6PMtL15MozLU8HJuDzChAAAAAD1CugAAADC6XjX9NxvBqTeiAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYRS8R1rsEwbNtAAAAAAAAAAADCmXjlk7+fhFLxN7y7c27KtinyzoABUJeEAAAAAAFg++eXXvZ+rSxH0Nsa9Klz7A8UtiAAe0XOAAAAAAALB986RbUUjalOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABaXryFlqVJx+Vc9jwAAAAAAAAAAAIXepVkMUptlkEgFlwAAAAAAD2i5wAKQ9c7Tao3j496C+PdAGPoAAAAAABUJeEAA1G2Yqb9blqsoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH/xAAoEAABBAMAAgEDBAMAAAAAAAAGAAUHFwQICQoWECBAYAIDFTABGFD/2gAIAQEAAQgA/wC3J+3ep8JEuMFzOzvDQQtDW/sH3HXTfTB516PyhO+DwK5Fue+8iP3RPenFxcbCxsfDw/tpAN2KMwM0kco0C7EaQ9H3MiFoE6yS4T9mOyMLc9oXh+JgKB4sj2GIt+fZCJeyES9kIl7IRL2QiXshEvZCJeyES9kIl7IRL2QiXshEvZCJeyES9kIkCvbzmFTXj5f099uZh1zk2VYt/NOvEf07/c/V+zsLvmYfRXgeq8D1Xgeq8D1Xgeq8D1Xgeq8D1Xgeq8D1Xgeq8D1Xgeq8D1Xgem4NG2rM/Zz8D6Z9gmMNm4bkOBpm0v1SAdIdYIg1djT8u6ZeUuzwrIhVB+hkS+WF0QEDDHc5V5y9Itf+mEIfql+Evt+104l+unLPciUwL48XubyqNOqILGLT8GTjmNQ25Z+BYZgrDMFYZgrDMFYZgrDMFYZgrDMFYZgrDMFYZgg0yJHUkbcDP/o3h1jZ9y9R9gdYXmdYMlPWuWjmD5qXinc8jpxlol6HSJ8PLTjvjbkteXVA6qoHVVA6qoHVVA6qoHVVA6qoHVVA6qoHVVA6maPmZjcsZ0xP6du+eOme9rPgte0cT+OHyZikoxSz/DOztA81NrEwfl+/m/kCc6YEep0nTk35MH+xc9ksGbz/AHG/W+UG87NeyDYCcd/N/J76LT29TpOi8f7vdk5uSBaF7tfBU7ZDGw57piWuRK1yJWuRK1yJWuRIVkF5fH7Aa8v+7ZvWSFtwIWM4Bn7q5yjmnl9NP6holbGxye3JvZmbg1wabdRW0b2828+CFn/nmfMaVUKqFVCqhVQoejj+BeMN2+w2b1khbcCFjOAZ+5XePFC3PmaTafpJ/IZ4m6O9bYakyepZ1X6x9pevW6mbHunY7gOTUPsbW8/ceUju2Sm5BDfKmB+UHPQO5u6hAsKt3zbyt5W8reVvK3lbyt5W8reVvK3lbyt5W8h6R/554w2n6ZADG+RwM0j52ZNod8/G/wB6TWAi/wAfuIj3pR1WmfojsP8ARVBEqoIlVBEqoIlVBEqoIlVBEqoIlVBEqoIlVBEqoIlVBEqoIlVBEhWPnljfsB0y/p7JcwxTppq05hmBwh0Ue9DefUfBUhfk/wD/xAA6EAABBAECAwYEAgkEAwAAAAAEAgMFBgEABxITpREUlNTV5QgVldMQIBYhIiMkMDNAYBc0VHIYUHP/2gAIAQEACT8A/wDd/E98PG0dxNQK6HU9z96ttqDZS2juHITg0Fa7LEyj6DMLR3VbQq0kcaeVlfFjtlI6cgpyOBmISbhzhpOImIiTGaNjZSLkgnXw5COkA32SwThHnhixnmn2HXGnELz/AHBEcrdKTQxtxsTESLbJTMtu5bxzW4It6PfzhqRjqdGBzV/mo91TTcjD1U2Mw8gg4fChpjcradq6S0lSYLcEouaJ+IzdgWUy9Y7ne3ZbvBFm26q8th8M0Mpx0G8XFsuFk3H4Ks2ODmx2BAxGGhRBBWmxxhRh20tMDjsNJQ0ywy0hLbTTaUtttpShCcJxjGP7bEvmtUGqWG52HEBAzNpnMwlYiS5qV+T1qugyc/YJPuIT/cYaFjjpSSJ5YYAhBLzbSrvOQW49b55T21O68ZFUzcOYgR+LmWqrRAk/PA2iAYwntkXYSVNkIDDgqrHHQ6T4/JVlKJ2U2lvatpFTMCS0bF/PhFLn/iX3eYay5mOkl0atV+Ur0Jh5To5qKE87FEYbtTiXoEasbd7X1CCpFOghu1aQIGux7EcCl8hfa8ce+2x3qTky1OnSsk+VJHvvmlPvOfjPzX1Q77+p+a+qHff1PzX1Q77+p+a+qHff1PzX1Q77+p+a+qHff1PzX1Q77+p+a+qHff1PzX1Q77+p+a+qHff1PzX1Q77+p+a+qHff1PzX1Q77+p+a+qHff1PzX1Q77+peUKHc79zGCDy32V8EcYtHG066pCuFaUrTxJzwqSlWOzOMZ/MRY9t9ndx7vibbkdsyTasd8OO+JaXjHwIQ6BfGIr9PvakyMzUXQlCx0PIrnqRhgCLRVxZQHnkHv/8Aj7tOWakYh7PAuJuW7lhbyQh41t8h5yiQEdKjuDcxCLlHOrKw68hj8kR1CU87qI6hKed1EdQlPO6iOoSnndRHUJTzuojqEp53UR1CU87qI6hKed1EdQlPO6iOoSnndRHUJTzuojqEp53UR1CU87qI6hKed1EdQlPO6jeQWxzOU73w93g5rS2XP3bxTjSuJpxaf2kZ7O3tx2KxjOPy1kO3ba7nVs6s2eGLaZWvu5SUuBysW+8y/wDLLDASLQc7W5phvvsHPR0dLgrbMCZcSSZJVbaetrisTskOKLKWeelZM+xWy1SQ4eMDjmWS0S8vMuCNLeQCgxsFsh9sZDqv8uodN3YmKcefX7PvzuI5Jn7bKsAD7Q54m3NXrspDSFyj455JwKrdJT8RCmSI3PhIuxwChJeRo3w/7wUl0ptUtU26lNbeTKAMP4ceYrNugZ49qIOW1jI7J1grVyGZQrjcjCHcYXomRh5ivHDwO6G11mUIm57aWYll18UKWwE46JJwc2OOQdVbRHKzHzoTBTS2o6ci52DiP7cwyNtgu3ETRoiVjlZbkYZW8F9qOz5k3HEJWhwM+Fj72XKBHsLSTHlCNGjZwQO3+Jbuax8Rm2u6+39ujFvv9yc/QuiTu80BM4ESru65aMkNuXYwE15GXRIywzorDiEyJCHvwe5BbHc+U7y2neDmnisufu3kONK4mnFp/aRns7e3HYrGM4l+nxfktS/T4vyWpfp8X5LUv0+L8lqX6fF+S1L9Pi/Jal+nxfktS/T4vyWpfp8X5LUv0+L8lqX6fF+S1Jc8R/vnNa7mA1x8oAp5v94yK26nhdbQr9leO3s7M9qc5xn+QULHJ3h22nK1CzBzbzwNfubKWpmg2Ywcf+IJFrF4i69YCBWex0pmNWO2pKnMKxT5Wi7l7dzhMDZq7LMLadZfZ7HBjwH8pwzJwcwE4PLQM2Ct6Nm4cwKUjiCAi2Hl6r0jA7d1Gq2PbvYR+TFeCVerlaeKDu9xg8vN4UZWahW2pmnuSDSe5SdhsxogRjhVUmRW/wAFvtjlcnmLHU2h7HIfaIRwKdbeRjtWynCuJtXanKsY7M5wrBs14gH07Rs14gH07Rs14gH07Rs14gH07Rs14gH07Rs14gH07Rs14gH07Rs14gH07Rs14gH07Rs14gH07Rs14gH07RMo4QLzuWgh4RbOeew6OvjS0EyvPYh5WU8LiexWE5z24xlOf5Ow9Q3LNhxnRa/b1Zk6xuFXB3cuOd1hNwakfB28OM7y5312CzMO180xtp6RijMt4xrYCY3JOAfUQBGbsbi2+5VdhxSeHCSqpmRj69OMITlXCLZI6ZGypXGtpbiGlNxcdBwcMCLGRENDgjRkVFRoLKBwo+NjgmmBAQRB222BRBWWmB2UIaabQhKU4/y+a/5EVt9t9FEDfpnunc+7KeCqlUCeV/0InJwhHyqtRXMkpJz/AGwxYlI2s/1Tu5ZPw+bhQSPlFMqvzclDMLszfDTXf/iPV9xZBbHzKVfejbIkTvcYUz/cST6gx3/kNFpEQppVq3MvhYRhkPTK0y72tNvlNBFGSkuXhMdAQwh0qcpSR2xyJr/kRW3u3sUQT+hm1lM7yp4Kq1UJ5X/QicnCEfNbLK8ySknP9qKJq2PlllvxVM+HHfiwFOEEkkkOMxte2i3Nk31LdefedWNFUG5mOKcccULWLC8pSouS/FDLhAvdeWghLi2c88wcdfGlpxleexDysp4XE9isJzntxjKchQvhzvUdBQvhzvUdBQvhzvUdBQvhzvUdBQvhzvUdDRjY5XeuYsdktD2OQGQQjgU6a8jHatlOFcTau1OVYx2ZzhWP51MBu+3F3ByOcCRjDMlDyTOFqirPWJVKFFQFpgClYNhZoLKSBCE5bcw+G+UKQk677E3c48jZTescDLMbZ41nOX11izoYwoWA3FgBVITNQqlpHkh0pnoFT8W+tAUedLzEucJGRUVGCEHyUnJHkNigx8eCK26UacaU60MIIM06QSQ62yy2txaU5rYMv8UsuC1J7cbcSbQ58b8PMaeP2tyEg3nmim7wmiu5QWWjLo9DHdci4txc4uQkGPwI7p3vu/8AEcnn8vkFME/0uazxcXJ4P6ieHi4v19nDmw9J9z1Yek+56sPSfc9WHpPuerD0n3PUz3vuneP4f5dyOZzxXxv6vfnuHh53H/TVxcPD+rt4sfz6YDd9uLuDkc4EjGGZKHkmcLVFWesSqUKKgLTAFKwbCzQWUkCEJy25h8N8oUi3g/EHuPE2mWH+HY6TgcARu19JXnKY6zyEURzRTd4TRXXAi5sTGYmuDtuOVlKDJJ4oX/IZn5BtztPT5q7W2SQ2kgvEZDCrI7jFh5cazIzksRhiJgYlpxJEtMnARo3aQU1jN5pPwp7FwRjViuhbW0u3G5sFtVtamT7qEbdrLuPVJ6bue4E+02sCIgKudSmrPMpOejw6rW4qbm4OdKtMxGw8YBLWY4KMjTrHJBhMDnTpkdCiAQwBUuU27IEBRIIUYK8QtgAQcVtplH9w2dY7tuLY6Jdd3oavPc+SnJidmEgbHbN90RngeOnLA+Dfzo8hTTqX2NtTB18osjGRIozdOcFDuu/t1BQl5227qSoA+ZgcaRU20QTVqejhqlNaU0K1mGjcTDoI8xOTLpP417q3tmq91b2zVe6t7ZqvdW9s1Xure2ar3VvbNV7q3tmq91b2zVe6t7ZqvdW9s1Xure2ar3VvbNV7q3tmq91b2zVe6t7ZqG7p3vvH8R8x5/L5Ar5P9LuLPFxcng/qJ4eLi/X2cOfySdkhYu81Sw1CSmKbYZSo26KBskSXDlyVXtUI+LMVuwgsGLJhpyLJYPipBoc4R1DzCM4mLDvr8Nk3L/paLSrhIGgVbejbiZeKRC7nbeTZ7E87t7uGMpJMTa8w+JGKXaYiTg7MBZQ4+DlWErsuNmpEvd2QKdEYcgSN7txHJGC2qrgQ5bmXB4fbusx1gnqsyBh5dbJo9HYdWwy4L3j8hsL4g707RsL4g707RsL4g707RsL4g707RsL4g707RsL4g707RsL4g707RsL4g707RsL4g707RsL4g707RsL4g707RsL4g707RsL4g707RsL4g707RsL4g707RMY4OL3rmIHeLW9nnhkDo4EuhMoz2LeTlXE4nsThWcducYTn8rMVD/EHtkiUt/w+3kxlpChLNkVtUnQZk7Lo62KfuQOEJDS7jjyx4WWYr9tUGe5XER5dbdrO9260vLby7yxZ7ISZeEsFnSKDWage6Mlb7btUosTWgZGLKKJ+W2l6z5a7v3p1hH+T/wD/xAA3EQACAQEFBQQIBQUAAAAAAAABAhEDBCExQVEAEkBhgSIycZEFEBNCYHKxwSNSodHwUGKCkuL/2gAIAQIBAT8A/ra06jCVpuw1VWI8wI2IIJBEEXEHEHQ8TZqPtqqp7vec6KMfO5RzM7Wy0iiooUey0AErduLFwGjEeQ5kEcOoLEKMWIAkgCSYEk3DxN21azVaEFwCp95ZKg6EwIPjjltZ1FlszVnHaYb0HGMEXqTJ8eWzMXYsxlmJJPM8TY64r0zRqwzKI7V++nOcSMD0Ou3pGr3KI+dvoo01PlxSO1NldTDKZH7HkcCMxtVqGrUao1xY4DIAQB0AA+L6FgLqHrErN4Qd6P7iZidImMSDcG9HUSIUup1kN5gi/oRtWoPQfdfA3qwwYcuYzGXhBPD2VA9opKcN4nx3QWjrHrt6BrOWzRlI6kKena/QcRSqeyqJU/KwJGowI6iRsjrUUOhlWEg/zAjMZH1ekKy7ooqZYkM/IC8DxJg+A58TTrVaR/DcrOIxU+KmR1idmttoYRv7vyqAfOJHQjbG8/GFGi9ZwiDxOSjU/YZ7Wiw7iB6UtujtqbyYxYfddMOJo0XrOETxJOCjMn9szdtRopQQIg+Zs2Op+wy9VssmNakNS6D9WX6kdRxFOo1Ng6GGH8g6g5jaz2hbQsi5x3l05jVTkcsDthebgMTta7X7WadMxTHeb8//AD9cTxNOo1Ng6GGH8g6g5ja0W16yhFG4sDfg946fLyzz+IkRnZUUSzEAdfsMSchtUs9ls1IGqDUc3DtMpZoyAIAUamYGMmATeSQIE3DTlffdz4mwUgA1oe4KCFJwAA7bdBd/ttaKxr1C57ouQaLl1OJ58gOIU7pDXGCDBEgwZvGY1Gexp0bbSDgBKgESMVYe6wzXMTfBkRftbGFCzrRS7e7PPdW9j/kYB1k8VZq5oVJ9xoDjlqOa4jW8Z7WuqK1ZiplFAVcYIGJ6mfER8Uf/xAAzEQEAAQICBwYFAwUAAAAAAAABAgMRITEAEkBBUWGRBHGBobHBECJg0fAyQlJQctLh8f/aAAgBAwEBPwD+tsomDKI80PXaqs9SDLfkd7l0z8NKNLXdeeJfC/7ni8Q83uTaFsLwx46QqwqYDjwcHvOP5fSotWqQHAbf5Phj00AiAZBY2mtTacteOAu7DVfs7unDTs0f1Tf7T1fbz2pCQiXHP89NIRIRImR/18/q+p2iykAbYMnK/Lj3+pmdpmONk4Wt0T3HSnUjULnibx/Mn3ubRVWNOSZ2t1Q9/j2dSoH8hHwL+20TjrxlHiee58HRGKiWTM+HZ4N9dMASPNyXuDDveTtMoQn+qI89/Ux0KFMb2v3tzp9/rGc4043fA3r+Zu7SlX1m07F35Xccn2eu0zmU46z4HF4aTnKctaXgbg4Hwo1soTeUX2fZ2iUSQxkXH866VKbTeI5Ps8/hRo6vzS/VuP4/79NplEkMZFx/OulOgQWS6zf5eR9/qJSIycgu6RqVas7RSJvwGxzuYvda/Iu6efPae0TvanHNstvKPo9NKcCnEN+cni/YyNoS4nHDDB8HdprToTYuMc7OScTOzx54Y6URqVGbux8XI8MU4WNqq0ypG37jGL7dz9ndpRhqQBLLi+x087/VH//Z\"\n    },\n    {\n        value: (0, $7yNYd.PresetListType).BULLET_LIST_3,\n        img: \"data:image/jpeg;base64,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\"\n    },\n    {\n        value: (0, $7yNYd.PresetListType).BULLET_LIST_4,\n        img: \"data:image/jpeg;base64,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\"\n    },\n    {\n        value: (0, $7yNYd.PresetListType).BULLET_LIST_5,\n        img: \"data:image/jpeg;base64,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\"\n    }\n], $bb9ae9d90429a70d$var$BulletListTypePicker = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((props)=>/* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx($bb9ae9d90429a70d$var$ListTypePicker, {\n        ...props,\n        options: $bb9ae9d90429a70d$var$bulletOptions\n    }), \"BulletListTypePicker\"), $bb9ae9d90429a70d$var$ORDER_LIST_TYPE_COMPONENT = `${$bb9ae9d90429a70d$var$COMPONENT_PREFIX}_ORDER_LIST_TYPE_COMPONENT`, $bb9ae9d90429a70d$var$BULLET_LIST_TYPE_COMPONENT = `${$bb9ae9d90429a70d$var$COMPONENT_PREFIX}_BULLET_LIST_TYPE_COMPONENT`;\nfunction $bb9ae9d90429a70d$export$9cb76b3207b29c5d(contextService) {\n    return contextService.getContextValue((0, $7yNYd.FOCUSING_DOC)) && contextService.getContextValue((0, $7yNYd.FOCUSING_UNIVER_EDITOR)) && !contextService.getContextValue((0, $7yNYd.FOCUSING_COMMON_DRAWINGS));\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$export$9cb76b3207b29c5d, \"whenDocAndEditorFocused\");\nfunction $bb9ae9d90429a70d$var$whenDocAndEditorFocusedWithBreakLine(contextService) {\n    return contextService.getContextValue((0, $7yNYd.FOCUSING_DOC)) && contextService.getContextValue((0, $7yNYd.FOCUSING_UNIVER_EDITOR)) && !contextService.getContextValue((0, $7yNYd.FOCUSING_UNIVER_EDITOR_STANDALONE_SINGLE_MODE)) && !contextService.getContextValue((0, $7yNYd.FOCUSING_COMMON_DRAWINGS));\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$whenDocAndEditorFocusedWithBreakLine, \"whenDocAndEditorFocusedWithBreakLine\");\nconst $bb9ae9d90429a70d$var$TabShortCut = {\n    id: $bb9ae9d90429a70d$export$e2fd85e54fa7b941.id,\n    binding: (0, $fL2Ug.KeyCode).TAB,\n    preconditions: $bb9ae9d90429a70d$export$9cb76b3207b29c5d\n}, $bb9ae9d90429a70d$var$ShiftTabShortCut = {\n    id: $bb9ae9d90429a70d$export$e2fd85e54fa7b941.id,\n    binding: (0, $fL2Ug.KeyCode).TAB | (0, $fL2Ug.MetaKeys).SHIFT,\n    preconditions: $bb9ae9d90429a70d$export$9cb76b3207b29c5d,\n    staticParameters: {\n        shift: !0\n    }\n}, $bb9ae9d90429a70d$var$BoldShortCut = {\n    id: $bb9ae9d90429a70d$export$2ac5c6b1b1b0feee.id,\n    binding: (0, $fL2Ug.KeyCode).B | (0, $fL2Ug.MetaKeys).CTRL_COMMAND,\n    preconditions: $bb9ae9d90429a70d$export$9cb76b3207b29c5d\n}, $bb9ae9d90429a70d$var$ItalicShortCut = {\n    id: $bb9ae9d90429a70d$export$6f96a39ba8cb4fb2.id,\n    binding: (0, $fL2Ug.KeyCode).I | (0, $fL2Ug.MetaKeys).CTRL_COMMAND,\n    preconditions: $bb9ae9d90429a70d$export$9cb76b3207b29c5d\n}, $bb9ae9d90429a70d$var$UnderlineShortCut = {\n    id: $bb9ae9d90429a70d$export$64d38e2980266dfc.id,\n    binding: (0, $fL2Ug.KeyCode).U | (0, $fL2Ug.MetaKeys).CTRL_COMMAND,\n    preconditions: $bb9ae9d90429a70d$export$9cb76b3207b29c5d\n}, $bb9ae9d90429a70d$var$StrikeThroughShortCut = {\n    id: $bb9ae9d90429a70d$export$e70c98b3ed3cca1c.id,\n    binding: (0, $fL2Ug.KeyCode).X | (0, $fL2Ug.MetaKeys).SHIFT | (0, $fL2Ug.MetaKeys).CTRL_COMMAND,\n    preconditions: $bb9ae9d90429a70d$export$9cb76b3207b29c5d\n}, $bb9ae9d90429a70d$var$SubscriptShortCut = {\n    id: $bb9ae9d90429a70d$export$73eebc63961c6386.id,\n    binding: (0, $fL2Ug.KeyCode).COMMA | (0, $fL2Ug.MetaKeys).CTRL_COMMAND,\n    preconditions: $bb9ae9d90429a70d$export$9cb76b3207b29c5d\n}, $bb9ae9d90429a70d$var$SuperscriptShortCut = {\n    id: $bb9ae9d90429a70d$export$eced467326987bcd.id,\n    binding: (0, $fL2Ug.KeyCode).PERIOD | (0, $fL2Ug.MetaKeys).CTRL_COMMAND,\n    preconditions: $bb9ae9d90429a70d$export$9cb76b3207b29c5d\n}, $bb9ae9d90429a70d$var$AlignLeftShortCut = {\n    id: $bb9ae9d90429a70d$export$7a3dedab32c2d5a9.id,\n    binding: (0, $fL2Ug.KeyCode).L | (0, $fL2Ug.MetaKeys).CTRL_COMMAND | (0, $fL2Ug.MetaKeys).SHIFT,\n    preconditions: $bb9ae9d90429a70d$export$9cb76b3207b29c5d\n}, $bb9ae9d90429a70d$var$AlignRightShortCut = {\n    id: $bb9ae9d90429a70d$export$6e9dd45d49710046.id,\n    binding: (0, $fL2Ug.KeyCode).R | (0, $fL2Ug.MetaKeys).CTRL_COMMAND | (0, $fL2Ug.MetaKeys).SHIFT,\n    preconditions: $bb9ae9d90429a70d$export$9cb76b3207b29c5d\n}, $bb9ae9d90429a70d$var$AlignCenterShortCut = {\n    id: $bb9ae9d90429a70d$export$d6d3a31584e4793b.id,\n    binding: (0, $fL2Ug.KeyCode).E | (0, $fL2Ug.MetaKeys).CTRL_COMMAND | (0, $fL2Ug.MetaKeys).SHIFT,\n    preconditions: $bb9ae9d90429a70d$export$9cb76b3207b29c5d\n}, $bb9ae9d90429a70d$var$AlignJustifyShortCut = {\n    id: $bb9ae9d90429a70d$export$8812c7b8ff337c70.id,\n    binding: (0, $fL2Ug.KeyCode).J | (0, $fL2Ug.MetaKeys).CTRL_COMMAND | (0, $fL2Ug.MetaKeys).SHIFT,\n    preconditions: $bb9ae9d90429a70d$export$9cb76b3207b29c5d\n}, $bb9ae9d90429a70d$var$OrderListShortCut = {\n    id: $bb9ae9d90429a70d$export$e87051556a6af02d.id,\n    binding: (0, $fL2Ug.KeyCode).Digit7 | (0, $fL2Ug.MetaKeys).CTRL_COMMAND | (0, $fL2Ug.MetaKeys).SHIFT,\n    preconditions: $bb9ae9d90429a70d$export$9cb76b3207b29c5d\n}, $bb9ae9d90429a70d$var$BulletListShortCut = {\n    id: $bb9ae9d90429a70d$export$baa537c1cdd3ac5a.id,\n    binding: (0, $fL2Ug.KeyCode).Digit8 | (0, $fL2Ug.MetaKeys).CTRL_COMMAND | (0, $fL2Ug.MetaKeys).SHIFT,\n    preconditions: $bb9ae9d90429a70d$export$9cb76b3207b29c5d\n}, $bb9ae9d90429a70d$var$docCountBar = \"univer-doc-count-bar\", $bb9ae9d90429a70d$var$styles$3 = {\n    docCountBar: $bb9ae9d90429a70d$var$docCountBar\n}, $bb9ae9d90429a70d$var$ZOOM_MAP = [\n    50,\n    80,\n    100,\n    130,\n    150,\n    170,\n    200,\n    400\n], $bb9ae9d90429a70d$var$DOC_ZOOM_RANGE = [\n    10,\n    400\n];\nfunction $bb9ae9d90429a70d$var$ZoomSlider() {\n    const commandService = (0, $7yNYd.useDependency)((0, $7yNYd.ICommandService)), univerInstanceService = (0, $7yNYd.useDependency)((0, $7yNYd.IUniverInstanceService)), currentDoc$ = (0, $5gqvu.useMemo)(()=>univerInstanceService.getCurrentTypeOfUnit$((0, $7yNYd.UniverInstanceType).UNIVER_DOC), []), documentDataModel = (0, $7yNYd.useObservable)(currentDoc$), getCurrentZoom = (0, $5gqvu.useCallback)(()=>{\n        var _a28, _b;\n        if (!documentDataModel) return 100;\n        const currentZoom = ((_b = (_a28 = documentDataModel.getSettings()) == null ? void 0 : _a28.zoomRatio) != null ? _b : 1) * 100;\n        return Math.round(currentZoom);\n    }, [\n        documentDataModel\n    ]), [zoom, setZoom] = (0, $5gqvu.useState)(()=>getCurrentZoom());\n    (0, $5gqvu.useEffect)(()=>(setZoom(getCurrentZoom()), commandService.onCommandExecuted((commandInfo)=>{\n            if (commandInfo.id === $bb9ae9d90429a70d$export$324478118aea2b96.id) {\n                const currentZoom = getCurrentZoom();\n                setZoom(currentZoom);\n            }\n        }).dispose), [\n        commandService,\n        getCurrentZoom\n    ]);\n    function handleChange(value) {\n        if (setZoom(value), documentDataModel == null) return;\n        const zoomRatio = value / 100;\n        commandService.executeCommand($bb9ae9d90429a70d$export$324478118aea2b96.id, {\n            unitId: documentDataModel.getUnitId(),\n            zoomRatio: zoomRatio\n        });\n    }\n    return $bb9ae9d90429a70d$var$__name(handleChange, \"handleChange\"), /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx((0, $1UDbf.Slider), {\n        min: $bb9ae9d90429a70d$var$DOC_ZOOM_RANGE[0],\n        value: zoom,\n        shortcuts: $bb9ae9d90429a70d$var$ZOOM_MAP,\n        onChange: handleChange\n    });\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$ZoomSlider, \"ZoomSlider\");\nfunction $bb9ae9d90429a70d$var$CountBar(props) {\n    return /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx(\"section\", {\n        className: $bb9ae9d90429a70d$var$styles$3.docCountBar,\n        children: /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx($bb9ae9d90429a70d$var$ZoomSlider, {})\n    });\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$CountBar, \"CountBar\");\nconst $bb9ae9d90429a70d$var$docFooterContainer = \"univer-doc-footer-container\", $bb9ae9d90429a70d$var$styles$2 = {\n    docFooterContainer: $bb9ae9d90429a70d$var$docFooterContainer\n}, $bb9ae9d90429a70d$var$DocFooter = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(()=>/* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsxs(\"div\", {\n        className: $bb9ae9d90429a70d$var$styles$2.docFooterContainer,\n        children: [\n            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx(\"div\", {}),\n            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx($bb9ae9d90429a70d$var$CountBar, {})\n        ]\n    }), \"DocFooter\"), $bb9ae9d90429a70d$var$PLUGIN_CONFIG_KEY = \"docs-ui.config\", $bb9ae9d90429a70d$var$defaultPluginConfig = {\n    layout: {\n        docContainerConfig: $bb9ae9d90429a70d$export$3eb8ad4b14461ffd,\n        toolbarConfig: $bb9ae9d90429a70d$export$a74edb128854c2d2\n    }\n}, $bb9ae9d90429a70d$var$DocParagraphSettingCommand = {\n    id: \"doc-paragraph-setting.command\",\n    type: (0, $7yNYd.CommandType).COMMAND,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (accessor, config)=>{\n        var _a28, _b, _c;\n        const docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), commandService = accessor.get((0, $7yNYd.ICommandService)), docDataModel = univerInstanceService.getCurrentUnitForType((0, $7yNYd.UniverInstanceType).UNIVER_DOC), docRanges = docSelectionManagerService.getDocRanges();\n        if (!docDataModel || docRanges.length === 0 || !config) return !1;\n        const segmentId = docRanges[0].segmentId, unitId = docDataModel.getUnitId(), allParagraphs = (_b = (_a28 = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()) == null ? void 0 : _a28.paragraphs) != null ? _b : [], paragraphs = (_c = $bb9ae9d90429a70d$export$a2d7677ab44ff1ca(docRanges, allParagraphs)) != null ? _c : [], doMutation = {\n            id: (0, $7AR1b.RichTextEditingMutation).id,\n            params: {\n                unitId: unitId,\n                actions: [],\n                textRanges: docRanges\n            }\n        }, memoryCursor = new (0, $7yNYd.MemoryCursor)();\n        memoryCursor.reset();\n        const textX = new (0, $7yNYd.TextX)(), jsonX = (0, $7yNYd.JSONX).getInstance();\n        for (const paragraph of paragraphs){\n            const { startIndex: startIndex } = paragraph;\n            textX.push({\n                t: (0, $7yNYd.TextXActionType).RETAIN,\n                len: startIndex - memoryCursor.cursor,\n                segmentId: segmentId\n            });\n            const paragraphStyle = {\n                ...paragraph.paragraphStyle,\n                ...config.paragraph\n            };\n            textX.push({\n                t: (0, $7yNYd.TextXActionType).RETAIN,\n                len: 1,\n                body: {\n                    dataStream: \"\",\n                    paragraphs: [\n                        {\n                            ...paragraph,\n                            paragraphStyle: paragraphStyle,\n                            startIndex: 0\n                        }\n                    ]\n                },\n                segmentId: segmentId,\n                coverType: (0, $7yNYd.UpdateDocsAttributeType).REPLACE\n            }), memoryCursor.moveCursorTo(startIndex + 1);\n        }\n        const path = $bb9ae9d90429a70d$export$abad77f79f46bb97(docDataModel, segmentId);\n        return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n    }, \"handler\")\n}, $bb9ae9d90429a70d$var$useDocRanges = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(()=>{\n    const docSelectionManagerService = (0, $7yNYd.useDependency)((0, $7AR1b.DocSelectionManagerService)), docParagraphSettingController = (0, $7yNYd.useDependency)($bb9ae9d90429a70d$var$DocParagraphSettingController), docRanges = (0, $5gqvu.useMemo)(()=>docSelectionManagerService.getDocRanges(), []);\n    return (0, $5gqvu.useEffect)(()=>{\n        docRanges.length || docParagraphSettingController.closePanel();\n    }, [\n        docRanges\n    ]), docRanges;\n}, \"useDocRanges\"), $bb9ae9d90429a70d$var$useCurrentParagraph = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(()=>{\n    var _a28, _b, _c;\n    const docDataModel = (0, $7yNYd.useDependency)((0, $7yNYd.IUniverInstanceService)).getCurrentUnitForType((0, $7yNYd.UniverInstanceType).UNIVER_DOC), docRanges = $bb9ae9d90429a70d$var$useDocRanges();\n    if (!docDataModel || docRanges.length === 0) return [];\n    const segmentId = docRanges[0].segmentId, paragraphs = (_b = (_a28 = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()) == null ? void 0 : _a28.paragraphs) != null ? _b : [];\n    return (_c = $bb9ae9d90429a70d$export$a2d7677ab44ff1ca(docRanges, paragraphs)) != null ? _c : [];\n}, \"useCurrentParagraph\"), $bb9ae9d90429a70d$var$useFirstParagraphHorizontalAlign = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((paragraph, defaultValue)=>{\n    const commandService = (0, $7yNYd.useDependency)((0, $7yNYd.ICommandService)), [horizontalAlign, _horizontalAlignSet] = (0, $5gqvu.useState)(()=>{\n        var _a28, _b;\n        const firstParagraph = paragraph[0];\n        return firstParagraph ? String((_b = (_a28 = firstParagraph.paragraphStyle) == null ? void 0 : _a28.horizontalAlign) != null ? _b : defaultValue) : defaultValue;\n    });\n    return [\n        horizontalAlign,\n        /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((v)=>(_horizontalAlignSet(v), commandService.executeCommand($bb9ae9d90429a70d$var$DocParagraphSettingCommand.id, {\n                paragraph: {\n                    horizontalAlign: Number(v)\n                }\n            })), \"horizontalAlignSet\")\n    ];\n}, \"useFirstParagraphHorizontalAlign\"), $bb9ae9d90429a70d$var$useFirstParagraphIndentStart = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((paragraph)=>{\n    const commandService = (0, $7yNYd.useDependency)((0, $7yNYd.ICommandService)), [indentStart, _indentStartSet] = (0, $5gqvu.useState)(()=>{\n        var _a28;\n        const firstParagraph = paragraph[0];\n        return firstParagraph ? (0, $3e0Iz.getNumberUnitValue)((_a28 = firstParagraph.paragraphStyle) == null ? void 0 : _a28.indentStart, 0) : 0;\n    });\n    return [\n        indentStart,\n        /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((v)=>(_indentStartSet(v), commandService.executeCommand($bb9ae9d90429a70d$var$DocParagraphSettingCommand.id, {\n                paragraph: {\n                    indentStart: {\n                        v: v\n                    }\n                }\n            })), \"indentStartSet\")\n    ];\n}, \"useFirstParagraphIndentStart\"), $bb9ae9d90429a70d$var$useFirstParagraphIndentEnd = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((paragraph)=>{\n    const commandService = (0, $7yNYd.useDependency)((0, $7yNYd.ICommandService)), [indentEnd, _indentEndSet] = (0, $5gqvu.useState)(()=>{\n        var _a28;\n        const firstParagraph = paragraph[0];\n        return firstParagraph ? (0, $3e0Iz.getNumberUnitValue)((_a28 = firstParagraph.paragraphStyle) == null ? void 0 : _a28.indentEnd, 0) : 0;\n    });\n    return [\n        indentEnd,\n        /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((v)=>(_indentEndSet(v), commandService.executeCommand($bb9ae9d90429a70d$var$DocParagraphSettingCommand.id, {\n                paragraph: {\n                    indentEnd: {\n                        v: v\n                    }\n                }\n            })), \"indentEndSet\")\n    ];\n}, \"useFirstParagraphIndentEnd\"), $bb9ae9d90429a70d$var$useFirstParagraphIndentFirstLine = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((paragraph)=>{\n    const commandService = (0, $7yNYd.useDependency)((0, $7yNYd.ICommandService)), [indentFirstLine, _indentFirstLineSet] = (0, $5gqvu.useState)(()=>{\n        var _a28;\n        const firstParagraph = paragraph[0];\n        return firstParagraph ? (0, $3e0Iz.getNumberUnitValue)((_a28 = firstParagraph.paragraphStyle) == null ? void 0 : _a28.indentFirstLine, 0) : 0;\n    });\n    return [\n        indentFirstLine,\n        /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((v)=>(_indentFirstLineSet(v), commandService.executeCommand($bb9ae9d90429a70d$var$DocParagraphSettingCommand.id, {\n                paragraph: {\n                    indentFirstLine: {\n                        v: v\n                    }\n                }\n            })), \"indentFirstLineSet\")\n    ];\n}, \"useFirstParagraphIndentFirstLine\"), $bb9ae9d90429a70d$var$useFirstParagraphIndentHanging = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((paragraph)=>{\n    const commandService = (0, $7yNYd.useDependency)((0, $7yNYd.ICommandService)), [hanging, _hangingSet] = (0, $5gqvu.useState)(()=>{\n        var _a28;\n        const firstParagraph = paragraph[0];\n        return firstParagraph ? (0, $3e0Iz.getNumberUnitValue)((_a28 = firstParagraph.paragraphStyle) == null ? void 0 : _a28.hanging, 0) : 0;\n    });\n    return [\n        hanging,\n        /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((v)=>(_hangingSet(v), commandService.executeCommand($bb9ae9d90429a70d$var$DocParagraphSettingCommand.id, {\n                paragraph: {\n                    hanging: {\n                        v: v\n                    }\n                }\n            })), \"hangingSet\")\n    ];\n}, \"useFirstParagraphIndentHanging\"), $bb9ae9d90429a70d$var$useFirstParagraphIndentSpaceAbove = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((paragraph)=>{\n    const commandService = (0, $7yNYd.useDependency)((0, $7yNYd.ICommandService)), [spaceAbove, _spaceAboveSet] = (0, $5gqvu.useState)(()=>{\n        var _a28;\n        const firstParagraph = paragraph[0];\n        return firstParagraph ? (0, $3e0Iz.getNumberUnitValue)((_a28 = firstParagraph.paragraphStyle) == null ? void 0 : _a28.spaceAbove, 0) : 0;\n    });\n    return [\n        spaceAbove,\n        /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((v)=>(_spaceAboveSet(v), commandService.executeCommand($bb9ae9d90429a70d$var$DocParagraphSettingCommand.id, {\n                paragraph: {\n                    spaceAbove: {\n                        v: v\n                    }\n                }\n            })), \"spaceAboveSet\")\n    ];\n}, \"useFirstParagraphIndentSpaceAbove\"), $bb9ae9d90429a70d$var$useFirstParagraphSpaceBelow = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((paragraph)=>{\n    const commandService = (0, $7yNYd.useDependency)((0, $7yNYd.ICommandService)), [spaceBelow, _spaceBelowSet] = (0, $5gqvu.useState)(()=>{\n        var _a28;\n        const firstParagraph = paragraph[0];\n        return firstParagraph ? (0, $3e0Iz.getNumberUnitValue)((_a28 = firstParagraph.paragraphStyle) == null ? void 0 : _a28.spaceBelow, 0) : 0;\n    });\n    return [\n        spaceBelow,\n        /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((v)=>(_spaceBelowSet(v), commandService.executeCommand($bb9ae9d90429a70d$var$DocParagraphSettingCommand.id, {\n                paragraph: {\n                    spaceBelow: {\n                        v: v\n                    }\n                }\n            })), \"spaceBelowSet\")\n    ];\n}, \"useFirstParagraphSpaceBelow\"), $bb9ae9d90429a70d$var$useFirstParagraphLineSpacing = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((paragraph)=>{\n    const commandService = (0, $7yNYd.useDependency)((0, $7yNYd.ICommandService)), renderManagerService = (0, $7yNYd.useDependency)((0, $3e0Iz.IRenderManagerService)), univerInstanceService = (0, $7yNYd.useDependency)((0, $7yNYd.IUniverInstanceService)), skeleton = (0, $5gqvu.useMemo)(()=>{\n        var _a28;\n        const docDataModel = univerInstanceService.getCurrentUnitForType((0, $7yNYd.UniverInstanceType).UNIVER_DOC);\n        if (docDataModel) return (_a28 = renderManagerService.getRenderById(docDataModel == null ? void 0 : docDataModel.getUnitId())) == null ? void 0 : _a28.with((0, $7AR1b.DocSkeletonManagerService)).getSkeleton();\n    }, []), stateChange$ = (0, $5gqvu.useMemo)(()=>new (0, $5LPkb.BehaviorSubject)({}), []), [lineSpacing, _lineSpacingSet] = (0, $5gqvu.useState)(()=>{\n        var _a28, _b;\n        const firstParagraph = paragraph[0];\n        return firstParagraph && (_b = (_a28 = firstParagraph.paragraphStyle) == null ? void 0 : _a28.lineSpacing) != null ? _b : 1;\n    }), lineSpacingCache = (0, $5gqvu.useRef)(lineSpacing), [spacingRule, _spacingRuleSet] = (0, $5gqvu.useState)(()=>{\n        var _a28, _b;\n        const firstParagraph = paragraph[0];\n        return firstParagraph ? (_b = (_a28 = firstParagraph.paragraphStyle) == null ? void 0 : _a28.spacingRule) != null ? _b : (0, $7yNYd.SpacingRule).AUTO : (0, $7yNYd.SpacingRule).AUTO;\n    }), lineSpacingSet = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (v)=>{\n        _lineSpacingSet(v), stateChange$.next({\n            lineSpacing: v,\n            spacingRule: spacingRule\n        });\n    }, \"lineSpacingSet\"), spacingRuleSet = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(async (v)=>{\n        if (v !== spacingRule) {\n            let cache = lineSpacingCache.current;\n            if (v === (0, $7yNYd.SpacingRule).AT_LEAST) {\n                const glyphNode = skeleton == null ? void 0 : skeleton.findNodeByCharIndex(paragraph[0].startIndex), divideNode = glyphNode == null ? void 0 : glyphNode.parent, lineNode = divideNode == null ? void 0 : divideNode.parent;\n                (lineNode == null ? void 0 : lineNode.contentHeight) !== void 0 && (cache = Math.max(lineNode.contentHeight, cache));\n            } else cache > 5 && (cache = 2);\n            lineSpacingCache.current = lineSpacing, lineSpacingSet(cache), _spacingRuleSet(v), stateChange$.next({\n                spacingRule: v\n            });\n        }\n    }, \"spacingRuleSet\");\n    return (0, $5gqvu.useEffect)(()=>{\n        const dispose = stateChange$.pipe((0, $lMvMU.filter)((obj)=>!!Object.keys(obj).length), (0, $binOv.bufferTime)(16), (0, $lMvMU.filter)((list)=>!!list.length), (0, $hciHF.map)((list)=>list.reduce((a, b)=>(Object.keys(b).forEach((key)=>{\n                    a[key] = b[key];\n                }), a), {}))).subscribe((v)=>commandService.executeCommand($bb9ae9d90429a70d$var$DocParagraphSettingCommand.id, {\n                paragraph: {\n                    ...v\n                }\n            }));\n        return ()=>dispose.unsubscribe();\n    }, []), {\n        lineSpacing: [\n            lineSpacing,\n            lineSpacingSet\n        ],\n        spacingRule: [\n            spacingRule,\n            spacingRuleSet\n        ]\n    };\n}, \"useFirstParagraphLineSpacing\"), $bb9ae9d90429a70d$var$paragraphSettingIconList = \"univer-paragraph-setting-icon-list\", $bb9ae9d90429a70d$var$paragraphSettingIconListItem = \"univer-paragraph-setting-icon-list-item\", $bb9ae9d90429a70d$var$paragraphSettingIconListActive = \"univer-paragraph-setting-icon-list-active\", $bb9ae9d90429a70d$var$paragraphSettingTitle = \"univer-paragraph-setting-title\", $bb9ae9d90429a70d$var$paragraphSettingLabel = \"univer-paragraph-setting-label\", $bb9ae9d90429a70d$var$paragraphSettingMtBase = \"univer-paragraph-setting-mt-base\", $bb9ae9d90429a70d$var$paragraphSettingFlexCol = \"univer-paragraph-setting-flex-col\", $bb9ae9d90429a70d$var$paragraphSettingSpaceLine = \"univer-paragraph-setting-space-line\", $bb9ae9d90429a70d$var$styles$1 = {\n    paragraphSettingIconList: $bb9ae9d90429a70d$var$paragraphSettingIconList,\n    paragraphSettingIconListItem: $bb9ae9d90429a70d$var$paragraphSettingIconListItem,\n    paragraphSettingIconListActive: $bb9ae9d90429a70d$var$paragraphSettingIconListActive,\n    paragraphSettingTitle: $bb9ae9d90429a70d$var$paragraphSettingTitle,\n    paragraphSettingLabel: $bb9ae9d90429a70d$var$paragraphSettingLabel,\n    paragraphSettingMtBase: $bb9ae9d90429a70d$var$paragraphSettingMtBase,\n    paragraphSettingFlexCol: $bb9ae9d90429a70d$var$paragraphSettingFlexCol,\n    paragraphSettingSpaceLine: $bb9ae9d90429a70d$var$paragraphSettingSpaceLine\n}, $bb9ae9d90429a70d$var$AutoFocusInputNumber = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((props)=>{\n    const { value: value, onChange: onChange, className: className = \"\", min: min = 0, max: max = 100, step: step = 1 } = props, ref = $5gqvu.useRef(null);\n    return /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx((0, $1UDbf.InputNumber), {\n        step: step,\n        ref: ref,\n        min: min,\n        max: max,\n        value: value,\n        onChange: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((v)=>{\n            onChange(v != null ? v : 0).finally(()=>{\n                setTimeout(()=>{\n                    var _a28;\n                    (_a28 = ref.current) == null || _a28.focus();\n                }, 30);\n            });\n        }, \"onChange\"),\n        className: className\n    });\n}, \"AutoFocusInputNumber\");\nfunction $bb9ae9d90429a70d$var$ParagraphSetting() {\n    const localeService = (0, $7yNYd.useDependency)((0, $7yNYd.LocaleService)), alignmentOptions = (0, $5gqvu.useMemo)(()=>[\n            {\n                label: localeService.t(\"toolbar.alignLeft\"),\n                value: String((0, $7yNYd.HorizontalAlign).LEFT),\n                icon: /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx($bb9ae9d90429a70d$var$LeftJustifyingSingle, {})\n            },\n            {\n                label: localeService.t(\"toolbar.alignCenter\"),\n                value: String((0, $7yNYd.HorizontalAlign).CENTER),\n                icon: /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx($bb9ae9d90429a70d$var$HorizontallySingle, {})\n            },\n            {\n                label: localeService.t(\"toolbar.alignRight\"),\n                value: String((0, $7yNYd.HorizontalAlign).RIGHT),\n                icon: /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx($bb9ae9d90429a70d$var$RightJustifyingSingle, {})\n            },\n            {\n                label: localeService.t(\"toolbar.alignJustify\"),\n                value: String((0, $7yNYd.HorizontalAlign).JUSTIFIED),\n                icon: /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx($bb9ae9d90429a70d$var$AlignTextBothSingle, {})\n            }\n        ], []), currentParagraph = $bb9ae9d90429a70d$var$useCurrentParagraph(), [horizontalAlignValue, horizontalAlignSet] = $bb9ae9d90429a70d$var$useFirstParagraphHorizontalAlign(currentParagraph, alignmentOptions[0].value), [indentStart, indentStartSet] = $bb9ae9d90429a70d$var$useFirstParagraphIndentStart(currentParagraph), [indentEnd, indentEndSet] = $bb9ae9d90429a70d$var$useFirstParagraphIndentEnd(currentParagraph), [indentFirstLine, indentFirstLineSet] = $bb9ae9d90429a70d$var$useFirstParagraphIndentFirstLine(currentParagraph), [hanging, hangingSet] = $bb9ae9d90429a70d$var$useFirstParagraphIndentHanging(currentParagraph), [spaceAbove, spaceAboveSet] = $bb9ae9d90429a70d$var$useFirstParagraphIndentSpaceAbove(currentParagraph), [spaceBelow, spaceBelowSet] = $bb9ae9d90429a70d$var$useFirstParagraphSpaceBelow(currentParagraph), { lineSpacing: [lineSpacing, lineSpacingSet], spacingRule: [spacingRule, spacingRuleSet] } = $bb9ae9d90429a70d$var$useFirstParagraphLineSpacing(currentParagraph), lineSpaceConfig = (0, $5gqvu.useMemo)(()=>spacingRule === (0, $7yNYd.SpacingRule).AUTO ? {\n            min: 1,\n            max: 5,\n            step: lineSpacing < 2 ? 0.5 : 1\n        } : {\n            min: 1,\n            max: 100\n        }, [\n        spacingRule,\n        lineSpacing\n    ]);\n    return /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsxs(\"div\", {\n        className: $bb9ae9d90429a70d$var$styles$1.paragraphSetting,\n        children: [\n            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx(\"div\", {\n                className: $bb9ae9d90429a70d$var$styles$1.paragraphSettingTitle,\n                children: localeService.t(\"doc.paragraphSetting.alignment\")\n            }),\n            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx(\"div\", {\n                className: `${$bb9ae9d90429a70d$var$styles$1.paragraphSettingIconList} ${$bb9ae9d90429a70d$var$styles$1.paragraphSettingMtBase}`,\n                children: alignmentOptions.map((item)=>/* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx((0, $1UDbf.Tooltip), {\n                        title: item.label,\n                        placement: \"bottom\",\n                        children: /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx(\"span\", {\n                            className: (0, $aFl3s.default)($bb9ae9d90429a70d$var$styles$1.paragraphSettingIconListItem, {\n                                [$bb9ae9d90429a70d$var$styles$1.paragraphSettingIconListActive]: horizontalAlignValue === item.value\n                            }),\n                            onClick: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(()=>horizontalAlignSet(item.value), \"onClick\"),\n                            children: item.icon\n                        })\n                    }, item.value))\n            }),\n            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx(\"div\", {\n                className: $bb9ae9d90429a70d$var$styles$1.paragraphSettingTitle,\n                children: localeService.t(\"doc.paragraphSetting.indentation\")\n            }),\n            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsxs(\"div\", {\n                children: [\n                    /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsxs(\"div\", {\n                        className: $bb9ae9d90429a70d$var$styles$1.paragraphSettingFlexCol,\n                        children: [\n                            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsxs(\"div\", {\n                                className: $bb9ae9d90429a70d$var$styles$1.paragraphSettingLabel,\n                                children: [\n                                    localeService.t(\"doc.paragraphSetting.left\"),\n                                    \"(px)\"\n                                ]\n                            }),\n                            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx($bb9ae9d90429a70d$var$AutoFocusInputNumber, {\n                                className: $bb9ae9d90429a70d$var$styles$1.paragraphSettingMtBase,\n                                value: indentStart,\n                                onChange: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((v)=>indentStartSet(v != null ? v : 0), \"onChange\")\n                            })\n                        ]\n                    }),\n                    /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsxs(\"div\", {\n                        className: $bb9ae9d90429a70d$var$styles$1.paragraphSettingFlexCol,\n                        children: [\n                            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsxs(\"div\", {\n                                className: $bb9ae9d90429a70d$var$styles$1.paragraphSettingLabel,\n                                children: [\n                                    localeService.t(\"doc.paragraphSetting.right\"),\n                                    \"(px)\"\n                                ]\n                            }),\n                            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx($bb9ae9d90429a70d$var$AutoFocusInputNumber, {\n                                className: $bb9ae9d90429a70d$var$styles$1.paragraphSettingMtBase,\n                                value: indentEnd,\n                                onChange: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((v)=>indentEndSet(v != null ? v : 0), \"onChange\")\n                            })\n                        ]\n                    }),\n                    /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsxs(\"div\", {\n                        className: $bb9ae9d90429a70d$var$styles$1.paragraphSettingFlexCol,\n                        children: [\n                            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsxs(\"div\", {\n                                className: $bb9ae9d90429a70d$var$styles$1.paragraphSettingLabel,\n                                children: [\n                                    localeService.t(\"doc.paragraphSetting.firstLine\"),\n                                    \"(px)\"\n                                ]\n                            }),\n                            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx($bb9ae9d90429a70d$var$AutoFocusInputNumber, {\n                                className: $bb9ae9d90429a70d$var$styles$1.paragraphSettingMtBase,\n                                value: indentFirstLine,\n                                onChange: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((v)=>indentFirstLineSet(v != null ? v : 0), \"onChange\")\n                            })\n                        ]\n                    }),\n                    /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsxs(\"div\", {\n                        className: $bb9ae9d90429a70d$var$styles$1.paragraphSettingFlexCol,\n                        children: [\n                            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsxs(\"div\", {\n                                className: $bb9ae9d90429a70d$var$styles$1.paragraphSettingLabel,\n                                children: [\n                                    localeService.t(\"doc.paragraphSetting.hanging\"),\n                                    \"(px)\"\n                                ]\n                            }),\n                            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx($bb9ae9d90429a70d$var$AutoFocusInputNumber, {\n                                className: $bb9ae9d90429a70d$var$styles$1.paragraphSettingMtBase,\n                                value: hanging,\n                                onChange: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((v)=>hangingSet(v != null ? v : 0), \"onChange\")\n                            })\n                        ]\n                    })\n                ]\n            }),\n            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx(\"div\", {\n                className: $bb9ae9d90429a70d$var$styles$1.paragraphSettingTitle,\n                children: localeService.t(\"doc.paragraphSetting.spacing\")\n            }),\n            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsxs(\"div\", {\n                children: [\n                    /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsxs(\"div\", {\n                        className: $bb9ae9d90429a70d$var$styles$1.paragraphSettingFlexCol,\n                        children: [\n                            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsxs(\"div\", {\n                                className: $bb9ae9d90429a70d$var$styles$1.paragraphSettingLabel,\n                                children: [\n                                    localeService.t(\"doc.paragraphSetting.before\"),\n                                    \"(px)\"\n                                ]\n                            }),\n                            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx($bb9ae9d90429a70d$var$AutoFocusInputNumber, {\n                                className: $bb9ae9d90429a70d$var$styles$1.paragraphSettingMtBase,\n                                value: spaceAbove,\n                                onChange: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((v)=>spaceAboveSet(v != null ? v : 0), \"onChange\")\n                            })\n                        ]\n                    }),\n                    /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsxs(\"div\", {\n                        className: $bb9ae9d90429a70d$var$styles$1.paragraphSettingFlexCol,\n                        children: [\n                            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsxs(\"div\", {\n                                className: $bb9ae9d90429a70d$var$styles$1.paragraphSettingLabel,\n                                children: [\n                                    localeService.t(\"doc.paragraphSetting.after\"),\n                                    \"(px)\"\n                                ]\n                            }),\n                            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx($bb9ae9d90429a70d$var$AutoFocusInputNumber, {\n                                className: $bb9ae9d90429a70d$var$styles$1.paragraphSettingMtBase,\n                                value: spaceBelow,\n                                onChange: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((v)=>spaceBelowSet(v != null ? v : 0), \"onChange\")\n                            })\n                        ]\n                    }),\n                    /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsxs(\"div\", {\n                        className: $bb9ae9d90429a70d$var$styles$1.paragraphSettingFlexCol,\n                        children: [\n                            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx(\"div\", {\n                                className: $bb9ae9d90429a70d$var$styles$1.paragraphSettingLabel,\n                                children: localeService.t(\"doc.paragraphSetting.lineSpace\")\n                            }),\n                            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsxs(\"div\", {\n                                className: `${$bb9ae9d90429a70d$var$styles$1.paragraphSettingMtBase} ${$bb9ae9d90429a70d$var$styles$1.paragraphSettingSpaceLine}`,\n                                style: {\n                                    width: 162\n                                },\n                                children: [\n                                    /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx((0, $1UDbf.Select), {\n                                        value: `${spacingRule}`,\n                                        options: [\n                                            {\n                                                label: localeService.t(\"doc.paragraphSetting.multiSpace\"),\n                                                value: `${(0, $7yNYd.SpacingRule).AUTO}`\n                                            },\n                                            {\n                                                label: localeService.t(\"doc.paragraphSetting.fixedValue\"),\n                                                value: `${(0, $7yNYd.SpacingRule).AT_LEAST}`\n                                            }\n                                        ],\n                                        onChange: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((v)=>spacingRuleSet(Number(v)), \"onChange\")\n                                    }),\n                                    /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx($bb9ae9d90429a70d$var$AutoFocusInputNumber, {\n                                        ...lineSpaceConfig,\n                                        value: lineSpacing,\n                                        onChange: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((v)=>lineSpacingSet(v != null ? v : 0), \"onChange\")\n                                    })\n                                ]\n                            })\n                        ]\n                    })\n                ]\n            })\n        ]\n    });\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$ParagraphSetting, \"ParagraphSetting\");\nconst $bb9ae9d90429a70d$var$isRangesEqual = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((oldRanges, ranges)=>ranges.length === oldRanges.length && oldRanges.some((oldRange)=>ranges.some((range)=>range.startOffset === oldRange.startOffset && range.endOffset === oldRange.endOffset)), \"isRangesEqual\"), $bb9ae9d90429a70d$var$isRangesIntersection = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((oldRanges, ranges)=>oldRanges.some((oldRange)=>ranges.some((range)=>{\n            const { startOffset: activeStart, endOffset: activeEnd } = oldRange, { startOffset: compareStart, endOffset: compareEnd } = range;\n            return activeStart == null || activeEnd == null || compareStart == null || compareEnd == null ? !1 : activeStart <= compareEnd && activeEnd >= compareStart;\n        })), \"isRangesIntersection\");\nfunction $bb9ae9d90429a70d$var$ParagraphSettingIndex() {\n    const commandService = (0, $7yNYd.useDependency)((0, $7yNYd.ICommandService)), localeService = (0, $7yNYd.useDependency)((0, $7yNYd.LocaleService)), currentLocale = (0, $7yNYd.useObservable)(localeService.currentLocale$), [key, keySet] = (0, $5gqvu.useState)(\"\"), rangeRef = (0, $5gqvu.useRef)([]);\n    return (0, $5gqvu.useEffect)(()=>{\n        const dispose = commandService.onCommandExecuted((info)=>{\n            var _a28;\n            if ((0, $7AR1b.SetTextSelectionsOperation).id === info.id) {\n                const ranges = info.params.ranges;\n                $bb9ae9d90429a70d$var$isRangesEqual(ranges, rangeRef.current) || keySet((0, $7yNYd.generateRandomId)(4)), rangeRef.current = ranges;\n            }\n            if ((0, $7AR1b.RichTextEditingMutation).id === info.id) {\n                const params = info.params, ranges = (_a28 = params.textRanges) != null ? _a28 : [];\n                params.trigger !== $bb9ae9d90429a70d$var$DocParagraphSettingCommand.id && $bb9ae9d90429a70d$var$isRangesIntersection(ranges, rangeRef.current) && keySet((0, $7yNYd.generateRandomId)(4));\n            }\n        });\n        return ()=>dispose.dispose();\n    }, []), (0, $5gqvu.useEffect)(()=>{\n        keySet((0, $7yNYd.generateRandomId)(4));\n    }, [\n        currentLocale\n    ]), /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx($bb9ae9d90429a70d$var$ParagraphSetting, {}, key);\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$ParagraphSettingIndex, \"ParagraphSettingIndex\");\nvar $bb9ae9d90429a70d$var$__defProp$m = Object.defineProperty, $bb9ae9d90429a70d$var$__getOwnPropDesc$m = Object.getOwnPropertyDescriptor, $bb9ae9d90429a70d$var$__decorateClass$m = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((decorators, target, key, kind)=>{\n    for(var result = kind > 1 ? void 0 : kind ? $bb9ae9d90429a70d$var$__getOwnPropDesc$m(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)(decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n    return kind && result && $bb9ae9d90429a70d$var$__defProp$m(target, key, result), result;\n}, \"__decorateClass$m\"), $bb9ae9d90429a70d$var$__decorateParam$m = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((index, decorator)=>(target, key)=>decorator(target, key, index), \"__decorateParam$m\");\nconst $bb9ae9d90429a70d$var$paragraphSettingIndexKey = \"doc_ui_paragraph-setting-panel\";\nvar $bb9ae9d90429a70d$var$_a5;\nlet $bb9ae9d90429a70d$var$DocParagraphSettingController = ($bb9ae9d90429a70d$var$_a5 = class extends (0, $7yNYd.Disposable) {\n    constructor(_commandService, _componentManager, _sidebarService){\n        super();\n        $bb9ae9d90429a70d$var$__publicField(this, \"_id\");\n        this._commandService = _commandService, this._componentManager = _componentManager, this._sidebarService = _sidebarService, this._init();\n    }\n    _init() {\n        this.disposeWithMe(this._componentManager.register($bb9ae9d90429a70d$var$paragraphSettingIndexKey, $bb9ae9d90429a70d$var$ParagraphSettingIndex));\n    }\n    openPanel() {\n        const props = {\n            header: {\n                title: \"doc.slider.paragraphSetting\"\n            },\n            id: this._id,\n            children: {\n                label: $bb9ae9d90429a70d$var$paragraphSettingIndexKey\n            },\n            width: 300\n        };\n        this._sidebarService.open(props);\n    }\n    closePanel() {\n        this._sidebarService.close(this._id);\n    }\n}, $bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_a5, \"DocParagraphSettingController\"), $bb9ae9d90429a70d$var$_a5);\n$bb9ae9d90429a70d$var$DocParagraphSettingController = $bb9ae9d90429a70d$var$__decorateClass$m([\n    (0, $7yNYd.OnLifecycle)((0, $7yNYd.LifecycleStages).Rendered, $bb9ae9d90429a70d$var$DocParagraphSettingController),\n    $bb9ae9d90429a70d$var$__decorateParam$m(0, (0, $7yNYd.ICommandService)),\n    $bb9ae9d90429a70d$var$__decorateParam$m(1, (0, $7yNYd.Inject)((0, $fL2Ug.ComponentManager))),\n    $bb9ae9d90429a70d$var$__decorateParam$m(2, (0, $7yNYd.Inject)((0, $fL2Ug.ISidebarService)))\n], $bb9ae9d90429a70d$var$DocParagraphSettingController);\nconst $bb9ae9d90429a70d$var$DocParagraphSettingPanelOperation = {\n    id: \"sidebar.operation.doc-paragraph-setting-panel\",\n    type: (0, $7yNYd.CommandType).OPERATION,\n    handler: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((accessor)=>(accessor.get($bb9ae9d90429a70d$var$DocParagraphSettingController).openPanel(), !0), \"handler\")\n}, $bb9ae9d90429a70d$var$getDisableOnCollapsedObservable = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((accessor)=>{\n    const docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService));\n    return new (0, $1O3Nt.Observable)((subscriber)=>{\n        const observable = docSelectionManagerService.textSelection$.subscribe(()=>{\n            const range = docSelectionManagerService.getActiveTextRange();\n            range && !range.collapsed ? subscriber.next(!1) : subscriber.next(!0);\n        });\n        return ()=>observable.unsubscribe();\n    });\n}, \"getDisableOnCollapsedObservable\");\nfunction $bb9ae9d90429a70d$var$inSameTable(rectRanges) {\n    if (rectRanges.length < 2) return !0;\n    const tableIds = rectRanges.map((rectRange)=>rectRange.tableId);\n    return tableIds.every((tableId)=>tableId === tableIds[0]);\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$inSameTable, \"inSameTable\");\nconst $bb9ae9d90429a70d$var$getDisableWhenSelectionNotInTableObservable = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((accessor)=>{\n    const docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService));\n    return new (0, $1O3Nt.Observable)((subscriber)=>{\n        const observable = docSelectionManagerService.textSelection$.subscribe(()=>{\n            var _a28;\n            const rectRanges = docSelectionManagerService.getCurrentRectRanges(), activeRange = docSelectionManagerService.getActiveTextRange();\n            if (rectRanges && rectRanges.length && $bb9ae9d90429a70d$var$inSameTable(rectRanges)) {\n                subscriber.next(!1);\n                return;\n            }\n            if (activeRange && (rectRanges == null || rectRanges.length === 0)) {\n                const { segmentId: segmentId, startOffset: startOffset, endOffset: endOffset } = activeRange, docDataModel = univerInstanceService.getCurrentUniverDocInstance(), tables = (_a28 = docDataModel == null ? void 0 : docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()) == null ? void 0 : _a28.tables;\n                if (tables && tables.length && tables.some((table)=>{\n                    const { startIndex: startIndex, endIndex: endIndex } = table;\n                    return startOffset > startIndex && startOffset < endIndex || endOffset > startIndex && endOffset < endIndex;\n                })) {\n                    subscriber.next(!1);\n                    return;\n                }\n            }\n            subscriber.next(!0);\n        });\n        return ()=>observable.unsubscribe();\n    });\n}, \"getDisableWhenSelectionNotInTableObservable\"), $bb9ae9d90429a70d$var$CopyMenuFactory = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((accessor)=>({\n        id: $bb9ae9d90429a70d$export$9f1a20871184dbfd.name,\n        commandId: $bb9ae9d90429a70d$export$9f1a20871184dbfd.id,\n        type: (0, $fL2Ug.MenuItemType).BUTTON,\n        icon: \"Copy\",\n        title: \"rightClick.copy\",\n        disabled$: $bb9ae9d90429a70d$var$getDisableOnCollapsedObservable(accessor),\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC)\n    }), \"CopyMenuFactory\"), $bb9ae9d90429a70d$var$ParagraphSettingMenuFactory = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((accessor)=>({\n        id: $bb9ae9d90429a70d$var$DocParagraphSettingPanelOperation.id,\n        type: (0, $fL2Ug.MenuItemType).BUTTON,\n        icon: \"MenuSingle24\",\n        title: \"doc.menu.paragraphSetting\",\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC)\n    }), \"ParagraphSettingMenuFactory\"), $bb9ae9d90429a70d$var$CutMenuFactory = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((accessor)=>({\n        id: $bb9ae9d90429a70d$export$f23b9559f1e5cf86.id,\n        type: (0, $fL2Ug.MenuItemType).BUTTON,\n        icon: \"Copy\",\n        title: \"rightClick.cut\",\n        disabled$: $bb9ae9d90429a70d$var$getDisableOnCollapsedObservable(accessor),\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC)\n    }), \"CutMenuFactory\"), $bb9ae9d90429a70d$var$PasteMenuFactory = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((accessor)=>({\n        id: $bb9ae9d90429a70d$export$c2cb6d04fe50d389.id,\n        type: (0, $fL2Ug.MenuItemType).BUTTON,\n        icon: \"PasteSpecial\",\n        title: \"rightClick.paste\",\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC)\n    }), \"PasteMenuFactory\"), $bb9ae9d90429a70d$var$DeleteMenuFactory = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((accessor)=>({\n        id: $bb9ae9d90429a70d$export$b83c33c82ff96791.id,\n        type: (0, $fL2Ug.MenuItemType).BUTTON,\n        icon: \"PasteSpecial\",\n        title: \"rightClick.delete\",\n        disabled$: $bb9ae9d90429a70d$var$getDisableOnCollapsedObservable(accessor),\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC)\n    }), \"DeleteMenuFactory\"), $bb9ae9d90429a70d$var$TABLE_INSERT_MENU_ID = \"doc.menu.table-insert\";\nfunction $bb9ae9d90429a70d$var$TableInsertMenuItemFactory(accessor) {\n    return {\n        id: $bb9ae9d90429a70d$var$TABLE_INSERT_MENU_ID,\n        type: (0, $fL2Ug.MenuItemType).SUBITEMS,\n        title: \"table.insert\",\n        icon: \"Insert\",\n        hidden$: (0, $5K4WI.combineLatest)((0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC), $bb9ae9d90429a70d$var$getDisableWhenSelectionNotInTableObservable(accessor), (one, two)=>one || two)\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$TableInsertMenuItemFactory, \"TableInsertMenuItemFactory\");\nfunction $bb9ae9d90429a70d$var$InsertRowBeforeMenuItemFactory(accessor) {\n    return {\n        id: $bb9ae9d90429a70d$export$d24aed1c729ddbeb.id,\n        type: (0, $fL2Ug.MenuItemType).BUTTON,\n        title: \"table.insertRowAbove\",\n        icon: \"InsertRowAbove\",\n        disabled$: $bb9ae9d90429a70d$var$getDisableWhenSelectionNotInTableObservable(accessor),\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC)\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$InsertRowBeforeMenuItemFactory, \"InsertRowBeforeMenuItemFactory\");\nfunction $bb9ae9d90429a70d$var$InsertRowAfterMenuItemFactory(accessor) {\n    return {\n        id: $bb9ae9d90429a70d$export$5c48014be93c9100.id,\n        type: (0, $fL2Ug.MenuItemType).BUTTON,\n        title: \"table.insertRowBelow\",\n        icon: \"InsertRowBelow\",\n        disabled$: $bb9ae9d90429a70d$var$getDisableWhenSelectionNotInTableObservable(accessor),\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC)\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$InsertRowAfterMenuItemFactory, \"InsertRowAfterMenuItemFactory\");\nfunction $bb9ae9d90429a70d$var$InsertColumnLeftMenuItemFactory(accessor) {\n    return {\n        id: $bb9ae9d90429a70d$export$e0b51bcab3a3cf9c.id,\n        type: (0, $fL2Ug.MenuItemType).BUTTON,\n        title: \"table.insertColumnLeft\",\n        icon: \"LeftInsertColumn\",\n        disabled$: $bb9ae9d90429a70d$var$getDisableWhenSelectionNotInTableObservable(accessor),\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC)\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$InsertColumnLeftMenuItemFactory, \"InsertColumnLeftMenuItemFactory\");\nfunction $bb9ae9d90429a70d$var$InsertColumnRightMenuItemFactory(accessor) {\n    return {\n        id: $bb9ae9d90429a70d$export$f1900f4bfa5f38e0.id,\n        type: (0, $fL2Ug.MenuItemType).BUTTON,\n        title: \"table.insertColumnRight\",\n        icon: \"RightInsertColumn\",\n        disabled$: $bb9ae9d90429a70d$var$getDisableWhenSelectionNotInTableObservable(accessor),\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC)\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$InsertColumnRightMenuItemFactory, \"InsertColumnRightMenuItemFactory\");\nconst $bb9ae9d90429a70d$var$TABLE_DELETE_MENU_ID = \"doc.menu.table-delete\";\nfunction $bb9ae9d90429a70d$var$TableDeleteMenuItemFactory(accessor) {\n    return {\n        id: $bb9ae9d90429a70d$var$TABLE_DELETE_MENU_ID,\n        type: (0, $fL2Ug.MenuItemType).SUBITEMS,\n        title: \"table.delete\",\n        icon: \"Reduce\",\n        hidden$: (0, $5K4WI.combineLatest)((0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC), $bb9ae9d90429a70d$var$getDisableWhenSelectionNotInTableObservable(accessor), (one, two)=>one || two)\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$TableDeleteMenuItemFactory, \"TableDeleteMenuItemFactory\");\nfunction $bb9ae9d90429a70d$var$DeleteRowsMenuItemFactory(accessor) {\n    return {\n        id: $bb9ae9d90429a70d$export$a24cf2b8bfb8aa0d.id,\n        type: (0, $fL2Ug.MenuItemType).BUTTON,\n        title: \"table.deleteRows\",\n        icon: \"DeleteRow\",\n        disabled$: $bb9ae9d90429a70d$var$getDisableWhenSelectionNotInTableObservable(accessor),\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC)\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$DeleteRowsMenuItemFactory, \"DeleteRowsMenuItemFactory\");\nfunction $bb9ae9d90429a70d$var$DeleteColumnsMenuItemFactory(accessor) {\n    return {\n        id: $bb9ae9d90429a70d$export$9460cec99108a171.id,\n        type: (0, $fL2Ug.MenuItemType).BUTTON,\n        title: \"table.deleteColumns\",\n        icon: \"DeleteColumn\",\n        disabled$: $bb9ae9d90429a70d$var$getDisableWhenSelectionNotInTableObservable(accessor),\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC)\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$DeleteColumnsMenuItemFactory, \"DeleteColumnsMenuItemFactory\");\nfunction $bb9ae9d90429a70d$var$DeleteTableMenuItemFactory(accessor) {\n    return {\n        id: $bb9ae9d90429a70d$export$ec800041f6d17822.id,\n        type: (0, $fL2Ug.MenuItemType).BUTTON,\n        title: \"table.deleteTable\",\n        icon: \"GridSingle\",\n        disabled$: $bb9ae9d90429a70d$var$getDisableWhenSelectionNotInTableObservable(accessor),\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC)\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$DeleteTableMenuItemFactory, \"DeleteTableMenuItemFactory\");\nfunction $bb9ae9d90429a70d$var$getInsertTableHiddenObservable(accessor) {\n    const univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), renderManagerService = accessor.get((0, $3e0Iz.IRenderManagerService));\n    return new (0, $1O3Nt.Observable)((subscriber)=>{\n        const subscription = univerInstanceService.focused$.subscribe((unitId)=>{\n            if (unitId == null || univerInstanceService.getUnitType(unitId) !== (0, $7yNYd.UniverInstanceType).UNIVER_DOC) return subscriber.next(!0);\n            const currentRender2 = renderManagerService.getRenderById(unitId);\n            if (currentRender2 == null) return subscriber.next(!0);\n            currentRender2.with((0, $7AR1b.DocSkeletonManagerService)).getViewModel().editAreaChange$.subscribe((editArea)=>{\n                subscriber.next(editArea === (0, $3e0Iz.DocumentEditArea).HEADER || editArea === (0, $3e0Iz.DocumentEditArea).FOOTER);\n            });\n        }), currentRender = renderManagerService.getCurrentTypeOfRenderer((0, $7yNYd.UniverInstanceType).UNIVER_DOC);\n        if (currentRender == null) return subscriber.next(!0);\n        const viewModel = currentRender.with((0, $7AR1b.DocSkeletonManagerService)).getViewModel();\n        return subscriber.next(viewModel.getEditArea() !== (0, $3e0Iz.DocumentEditArea).BODY), ()=>subscription.unsubscribe();\n    });\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getInsertTableHiddenObservable, \"getInsertTableHiddenObservable\");\nfunction $bb9ae9d90429a70d$var$getTableDisabledObservable(accessor) {\n    const docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService)), univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService));\n    return new (0, $1O3Nt.Observable)((subscriber)=>{\n        const subscription = docSelectionManagerService.textSelection$.subscribe((selection)=>{\n            if (selection == null) {\n                subscriber.next(!0);\n                return;\n            }\n            const { textRanges: textRanges } = selection;\n            if (textRanges.length !== 1) {\n                subscriber.next(!0);\n                return;\n            }\n            const textRange = textRanges[0], { collapsed: collapsed, startNodePosition: startNodePosition, startOffset: startOffset } = textRange;\n            if (!collapsed || startOffset == null) {\n                subscriber.next(!0);\n                return;\n            }\n            const docDataModel = univerInstanceService.getCurrentUniverDocInstance();\n            if (docDataModel == null) {\n                subscriber.next(!0);\n                return;\n            }\n            const docSkeletonManagerService = $bb9ae9d90429a70d$export$aca1be174465426e(accessor, docDataModel.getUnitId());\n            if (docSkeletonManagerService == null) {\n                subscriber.next(!0);\n                return;\n            }\n            if (docSkeletonManagerService.getViewModel().getCustomRangeRaw(startOffset)) {\n                subscriber.next(!0);\n                return;\n            }\n            if (startNodePosition != null) {\n                const { path: path } = startNodePosition;\n                if (path.indexOf(\"cells\") !== -1) {\n                    subscriber.next(!0);\n                    return;\n                }\n            }\n            subscriber.next(!1);\n        });\n        return ()=>subscription.unsubscribe();\n    });\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getTableDisabledObservable, \"getTableDisabledObservable\");\nfunction $bb9ae9d90429a70d$var$disableMenuWhenNoDocRange(accessor) {\n    const docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService));\n    return new (0, $1O3Nt.Observable)((subscriber)=>{\n        const subscription = docSelectionManagerService.textSelection$.subscribe((selection)=>{\n            if (selection == null) {\n                subscriber.next(!0);\n                return;\n            }\n            const { textRanges: textRanges, rectRanges: rectRanges } = selection;\n            if (textRanges.length === 0 && rectRanges.length === 0) {\n                subscriber.next(!0);\n                return;\n            }\n            subscriber.next(!1);\n        });\n        return ()=>subscription.unsubscribe();\n    });\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$disableMenuWhenNoDocRange, \"disableMenuWhenNoDocRange\");\nfunction $bb9ae9d90429a70d$var$BoldMenuItemFactory(accessor) {\n    const commandService = accessor.get((0, $7yNYd.ICommandService));\n    return {\n        id: $bb9ae9d90429a70d$export$2ac5c6b1b1b0feee.id,\n        type: (0, $fL2Ug.MenuItemType).BUTTON,\n        icon: \"BoldSingle\",\n        title: \"Set bold\",\n        tooltip: \"toolbar.bold\",\n        activated$: new (0, $1O3Nt.Observable)((subscriber)=>{\n            const disposable = commandService.onCommandExecuted((c)=>{\n                var _a28;\n                const id = c.id;\n                if (id === (0, $7AR1b.SetTextSelectionsOperation).id || id === $bb9ae9d90429a70d$export$d752bba5c1df9b30.id) {\n                    const textRun = $bb9ae9d90429a70d$var$getFontStyleAtCursor(accessor);\n                    if (textRun == null) {\n                        subscriber.next(!1);\n                        return;\n                    }\n                    const bl = (_a28 = textRun.ts) == null ? void 0 : _a28.bl;\n                    subscriber.next(bl === (0, $7yNYd.BooleanNumber).TRUE);\n                }\n            });\n            return subscriber.next(!1), disposable.dispose;\n        }),\n        disabled$: $bb9ae9d90429a70d$var$disableMenuWhenNoDocRange(accessor),\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC)\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$BoldMenuItemFactory, \"BoldMenuItemFactory\");\nfunction $bb9ae9d90429a70d$var$ItalicMenuItemFactory(accessor) {\n    const commandService = accessor.get((0, $7yNYd.ICommandService));\n    return {\n        id: $bb9ae9d90429a70d$export$6f96a39ba8cb4fb2.id,\n        type: (0, $fL2Ug.MenuItemType).BUTTON,\n        icon: \"ItalicSingle\",\n        title: \"Set italic\",\n        tooltip: \"toolbar.italic\",\n        activated$: new (0, $1O3Nt.Observable)((subscriber)=>{\n            const disposable = commandService.onCommandExecuted((c)=>{\n                var _a28;\n                const id = c.id;\n                if (id === (0, $7AR1b.SetTextSelectionsOperation).id || id === $bb9ae9d90429a70d$export$d752bba5c1df9b30.id) {\n                    const textRun = $bb9ae9d90429a70d$var$getFontStyleAtCursor(accessor);\n                    if (textRun == null) {\n                        subscriber.next(!1);\n                        return;\n                    }\n                    const it = (_a28 = textRun.ts) == null ? void 0 : _a28.it;\n                    subscriber.next(it === (0, $7yNYd.BooleanNumber).TRUE);\n                }\n            });\n            return subscriber.next(!1), disposable.dispose;\n        }),\n        disabled$: $bb9ae9d90429a70d$var$disableMenuWhenNoDocRange(accessor),\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC)\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$ItalicMenuItemFactory, \"ItalicMenuItemFactory\");\nfunction $bb9ae9d90429a70d$var$UnderlineMenuItemFactory(accessor) {\n    const commandService = accessor.get((0, $7yNYd.ICommandService));\n    return {\n        id: $bb9ae9d90429a70d$export$64d38e2980266dfc.id,\n        type: (0, $fL2Ug.MenuItemType).BUTTON,\n        icon: \"UnderlineSingle\",\n        title: \"Set underline\",\n        tooltip: \"toolbar.underline\",\n        activated$: new (0, $1O3Nt.Observable)((subscriber)=>{\n            const disposable = commandService.onCommandExecuted((c)=>{\n                var _a28;\n                const id = c.id;\n                if (id === (0, $7AR1b.SetTextSelectionsOperation).id || id === $bb9ae9d90429a70d$export$d752bba5c1df9b30.id) {\n                    const textRun = $bb9ae9d90429a70d$var$getFontStyleAtCursor(accessor);\n                    if (textRun == null) {\n                        subscriber.next(!1);\n                        return;\n                    }\n                    const ul = (_a28 = textRun.ts) == null ? void 0 : _a28.ul;\n                    subscriber.next((ul == null ? void 0 : ul.s) === (0, $7yNYd.BooleanNumber).TRUE);\n                }\n            });\n            return subscriber.next(!1), disposable.dispose;\n        }),\n        disabled$: $bb9ae9d90429a70d$var$disableMenuWhenNoDocRange(accessor),\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC)\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$UnderlineMenuItemFactory, \"UnderlineMenuItemFactory\");\nfunction $bb9ae9d90429a70d$var$StrikeThroughMenuItemFactory(accessor) {\n    const commandService = accessor.get((0, $7yNYd.ICommandService));\n    return {\n        id: $bb9ae9d90429a70d$export$e70c98b3ed3cca1c.id,\n        type: (0, $fL2Ug.MenuItemType).BUTTON,\n        icon: \"StrikethroughSingle\",\n        title: \"Set strike through\",\n        tooltip: \"toolbar.strikethrough\",\n        activated$: new (0, $1O3Nt.Observable)((subscriber)=>{\n            const disposable = commandService.onCommandExecuted((c)=>{\n                var _a28;\n                const id = c.id;\n                if (id === (0, $7AR1b.SetTextSelectionsOperation).id || id === $bb9ae9d90429a70d$export$d752bba5c1df9b30.id) {\n                    const textRun = $bb9ae9d90429a70d$var$getFontStyleAtCursor(accessor);\n                    if (textRun == null) {\n                        subscriber.next(!1);\n                        return;\n                    }\n                    const st = (_a28 = textRun.ts) == null ? void 0 : _a28.st;\n                    subscriber.next((st == null ? void 0 : st.s) === (0, $7yNYd.BooleanNumber).TRUE);\n                }\n            });\n            return subscriber.next(!1), disposable.dispose;\n        }),\n        disabled$: $bb9ae9d90429a70d$var$disableMenuWhenNoDocRange(accessor),\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC)\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$StrikeThroughMenuItemFactory, \"StrikeThroughMenuItemFactory\");\nfunction $bb9ae9d90429a70d$var$SubscriptMenuItemFactory(accessor) {\n    const commandService = accessor.get((0, $7yNYd.ICommandService));\n    return {\n        id: $bb9ae9d90429a70d$export$73eebc63961c6386.id,\n        type: (0, $fL2Ug.MenuItemType).BUTTON,\n        icon: \"SubscriptSingle\",\n        tooltip: \"toolbar.subscript\",\n        activated$: new (0, $1O3Nt.Observable)((subscriber)=>{\n            const disposable = commandService.onCommandExecuted((c)=>{\n                var _a28;\n                const id = c.id;\n                if (id === (0, $7AR1b.SetTextSelectionsOperation).id || id === $bb9ae9d90429a70d$export$d752bba5c1df9b30.id) {\n                    const textRun = $bb9ae9d90429a70d$var$getFontStyleAtCursor(accessor);\n                    if (textRun == null) {\n                        subscriber.next(!1);\n                        return;\n                    }\n                    const va = (_a28 = textRun.ts) == null ? void 0 : _a28.va;\n                    subscriber.next(va === (0, $7yNYd.BaselineOffset).SUBSCRIPT);\n                }\n            });\n            return subscriber.next(!1), disposable.dispose;\n        }),\n        disabled$: $bb9ae9d90429a70d$var$disableMenuWhenNoDocRange(accessor),\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC)\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$SubscriptMenuItemFactory, \"SubscriptMenuItemFactory\");\nfunction $bb9ae9d90429a70d$var$SuperscriptMenuItemFactory(accessor) {\n    const commandService = accessor.get((0, $7yNYd.ICommandService));\n    return {\n        id: $bb9ae9d90429a70d$export$eced467326987bcd.id,\n        type: (0, $fL2Ug.MenuItemType).BUTTON,\n        icon: \"SuperscriptSingle\",\n        tooltip: \"toolbar.superscript\",\n        activated$: new (0, $1O3Nt.Observable)((subscriber)=>{\n            const disposable = commandService.onCommandExecuted((c)=>{\n                var _a28;\n                const id = c.id;\n                if (id === (0, $7AR1b.SetTextSelectionsOperation).id || id === $bb9ae9d90429a70d$export$d752bba5c1df9b30.id) {\n                    const textRun = $bb9ae9d90429a70d$var$getFontStyleAtCursor(accessor);\n                    if (textRun == null) {\n                        subscriber.next(!1);\n                        return;\n                    }\n                    const va = (_a28 = textRun.ts) == null ? void 0 : _a28.va;\n                    subscriber.next(va === (0, $7yNYd.BaselineOffset).SUPERSCRIPT);\n                }\n            });\n            return subscriber.next(!1), disposable.dispose;\n        }),\n        disabled$: $bb9ae9d90429a70d$var$disableMenuWhenNoDocRange(accessor),\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC)\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$SuperscriptMenuItemFactory, \"SuperscriptMenuItemFactory\");\nfunction $bb9ae9d90429a70d$var$FontFamilySelectorMenuItemFactory(accessor) {\n    const commandService = accessor.get((0, $7yNYd.ICommandService));\n    return {\n        id: $bb9ae9d90429a70d$export$b6aad3c88c8d5d81.id,\n        tooltip: \"toolbar.font\",\n        type: (0, $fL2Ug.MenuItemType).SELECTOR,\n        label: $bb9ae9d90429a70d$var$FONT_FAMILY_COMPONENT,\n        selections: (0, $fL2Ug.FONT_FAMILY_LIST).map((item)=>({\n                label: {\n                    name: $bb9ae9d90429a70d$var$FONT_FAMILY_ITEM_COMPONENT,\n                    hoverable: !0\n                },\n                value: item.value\n            })),\n        // disabled$: getCurrentSheetDisabled$(accessor),\n        value$: new (0, $1O3Nt.Observable)((subscriber)=>{\n            const defaultValue = (0, $fL2Ug.FONT_FAMILY_LIST)[0].value, disposable = commandService.onCommandExecuted((c)=>{\n                var _a28;\n                const id = c.id;\n                if (id === (0, $7AR1b.SetTextSelectionsOperation).id || id === $bb9ae9d90429a70d$export$b6aad3c88c8d5d81.id) {\n                    const textRun = $bb9ae9d90429a70d$var$getFontStyleAtCursor(accessor);\n                    if (textRun == null) {\n                        subscriber.next(defaultValue);\n                        return;\n                    }\n                    const ff = (_a28 = textRun.ts) == null ? void 0 : _a28.ff;\n                    subscriber.next(ff != null ? ff : defaultValue);\n                }\n            });\n            return subscriber.next(defaultValue), disposable.dispose;\n        }),\n        disabled$: $bb9ae9d90429a70d$var$disableMenuWhenNoDocRange(accessor),\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC)\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$FontFamilySelectorMenuItemFactory, \"FontFamilySelectorMenuItemFactory\");\nfunction $bb9ae9d90429a70d$var$FontSizeSelectorMenuItemFactory(accessor) {\n    const commandService = accessor.get((0, $7yNYd.ICommandService));\n    return {\n        id: $bb9ae9d90429a70d$export$6723c87fd3465f36.id,\n        type: (0, $fL2Ug.MenuItemType).SELECTOR,\n        tooltip: \"toolbar.fontSize\",\n        label: {\n            name: $bb9ae9d90429a70d$var$FONT_SIZE_COMPONENT,\n            props: {\n                min: 1,\n                max: 400\n            }\n        },\n        selections: (0, $fL2Ug.FONT_SIZE_LIST),\n        // disabled$,\n        value$: new (0, $1O3Nt.Observable)((subscriber)=>{\n            const disposable = commandService.onCommandExecuted((c)=>{\n                var _a28;\n                const id = c.id;\n                if (id === (0, $7AR1b.SetTextSelectionsOperation).id || id === $bb9ae9d90429a70d$export$6723c87fd3465f36.id) {\n                    const textRun = $bb9ae9d90429a70d$var$getFontStyleAtCursor(accessor);\n                    if (textRun == null) {\n                        subscriber.next(14);\n                        return;\n                    }\n                    const fs = (_a28 = textRun.ts) == null ? void 0 : _a28.fs;\n                    subscriber.next(fs != null ? fs : 14);\n                }\n            });\n            return subscriber.next(14), disposable.dispose;\n        }),\n        disabled$: $bb9ae9d90429a70d$var$disableMenuWhenNoDocRange(accessor),\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC)\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$FontSizeSelectorMenuItemFactory, \"FontSizeSelectorMenuItemFactory\");\nfunction $bb9ae9d90429a70d$var$TextColorSelectorMenuItemFactory(accessor) {\n    const commandService = accessor.get((0, $7yNYd.ICommandService)), themeService = accessor.get((0, $7yNYd.ThemeService));\n    return {\n        id: $bb9ae9d90429a70d$export$61b23f520937a12f.id,\n        icon: \"FontColor\",\n        tooltip: \"toolbar.textColor.main\",\n        type: (0, $fL2Ug.MenuItemType).BUTTON_SELECTOR,\n        selections: [\n            {\n                label: {\n                    name: $bb9ae9d90429a70d$var$COLOR_PICKER_COMPONENT,\n                    hoverable: !1\n                }\n            }\n        ],\n        value$: new (0, $1O3Nt.Observable)((subscriber)=>{\n            const defaultColor = themeService.getCurrentTheme().textColor, disposable = commandService.onCommandExecuted((c)=>{\n                if (c.id === $bb9ae9d90429a70d$export$61b23f520937a12f.id) {\n                    const color = c.params.value;\n                    subscriber.next(color != null ? color : defaultColor);\n                }\n            });\n            return subscriber.next(defaultColor), disposable.dispose;\n        }),\n        disabled$: $bb9ae9d90429a70d$var$disableMenuWhenNoDocRange(accessor),\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC)\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$TextColorSelectorMenuItemFactory, \"TextColorSelectorMenuItemFactory\");\nfunction $bb9ae9d90429a70d$var$HeaderFooterMenuItemFactory(accessor) {\n    return {\n        id: $bb9ae9d90429a70d$var$OpenHeaderFooterPanelCommand.id,\n        type: (0, $fL2Ug.MenuItemType).BUTTON,\n        icon: \"FreezeRowSingle\",\n        tooltip: \"toolbar.headerFooter\",\n        hidden$: (0, $5K4WI.combineLatest)((0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC), (0, $fL2Ug.getHeaderFooterMenuHiddenObservable)(accessor), (one, two)=>one || two)\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$HeaderFooterMenuItemFactory, \"HeaderFooterMenuItemFactory\");\nconst $bb9ae9d90429a70d$var$TableIcon = \"GridSingle\", $bb9ae9d90429a70d$var$TABLE_MENU_ID = \"doc.menu.table\";\nfunction $bb9ae9d90429a70d$var$TableMenuFactory(accessor) {\n    return {\n        id: $bb9ae9d90429a70d$var$TABLE_MENU_ID,\n        type: (0, $fL2Ug.MenuItemType).SUBITEMS,\n        icon: $bb9ae9d90429a70d$var$TableIcon,\n        tooltip: \"toolbar.table.main\",\n        disabled$: $bb9ae9d90429a70d$var$getTableDisabledObservable(accessor),\n        // Do not show header footer menu and insert table at zen mode.\n        hidden$: (0, $5K4WI.combineLatest)((0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC), $bb9ae9d90429a70d$var$getInsertTableHiddenObservable(accessor), (0, $fL2Ug.getHeaderFooterMenuHiddenObservable)(accessor), (one, two, three)=>one || two || three)\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$TableMenuFactory, \"TableMenuFactory\");\nfunction $bb9ae9d90429a70d$var$InsertTableMenuFactory(_accessor) {\n    return {\n        id: $bb9ae9d90429a70d$export$1e0acf08c78e9a29.id,\n        title: \"toolbar.table.insert\",\n        type: (0, $fL2Ug.MenuItemType).BUTTON,\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(_accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC)\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$InsertTableMenuFactory, \"InsertTableMenuFactory\");\nfunction $bb9ae9d90429a70d$var$AlignLeftMenuItemFactory(accessor) {\n    const commandService = accessor.get((0, $7yNYd.ICommandService));\n    return {\n        id: $bb9ae9d90429a70d$export$7a3dedab32c2d5a9.id,\n        type: (0, $fL2Ug.MenuItemType).BUTTON,\n        icon: \"LeftJustifyingSingle\",\n        tooltip: \"toolbar.alignLeft\",\n        disabled$: $bb9ae9d90429a70d$var$disableMenuWhenNoDocRange(accessor),\n        activated$: new (0, $1O3Nt.Observable)((subscriber)=>{\n            const disposable = commandService.onCommandExecuted((c)=>{\n                var _a28;\n                const id = c.id;\n                if (id === (0, $7AR1b.SetTextSelectionsOperation).id || id === $bb9ae9d90429a70d$export$662c5ab3bad17c14.id) {\n                    const paragraph = $bb9ae9d90429a70d$var$getParagraphStyleAtCursor(accessor);\n                    if (paragraph == null) return;\n                    const alignType = (_a28 = paragraph.paragraphStyle) == null ? void 0 : _a28.horizontalAlign;\n                    subscriber.next(alignType === (0, $7yNYd.HorizontalAlign).LEFT);\n                }\n            });\n            return subscriber.next(!1), disposable.dispose;\n        }),\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC)\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$AlignLeftMenuItemFactory, \"AlignLeftMenuItemFactory\");\nfunction $bb9ae9d90429a70d$var$AlignCenterMenuItemFactory(accessor) {\n    const commandService = accessor.get((0, $7yNYd.ICommandService));\n    return {\n        id: $bb9ae9d90429a70d$export$d6d3a31584e4793b.id,\n        type: (0, $fL2Ug.MenuItemType).BUTTON,\n        icon: \"HorizontallySingle\",\n        tooltip: \"toolbar.alignCenter\",\n        activated$: new (0, $1O3Nt.Observable)((subscriber)=>{\n            const disposable = commandService.onCommandExecuted((c)=>{\n                var _a28;\n                const id = c.id;\n                if (id === (0, $7AR1b.SetTextSelectionsOperation).id || id === $bb9ae9d90429a70d$export$662c5ab3bad17c14.id) {\n                    const paragraph = $bb9ae9d90429a70d$var$getParagraphStyleAtCursor(accessor);\n                    if (paragraph == null) return;\n                    const alignType = (_a28 = paragraph.paragraphStyle) == null ? void 0 : _a28.horizontalAlign;\n                    subscriber.next(alignType === (0, $7yNYd.HorizontalAlign).CENTER);\n                }\n            });\n            return subscriber.next(!1), disposable.dispose;\n        }),\n        disabled$: $bb9ae9d90429a70d$var$disableMenuWhenNoDocRange(accessor),\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC)\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$AlignCenterMenuItemFactory, \"AlignCenterMenuItemFactory\");\nfunction $bb9ae9d90429a70d$var$AlignRightMenuItemFactory(accessor) {\n    const commandService = accessor.get((0, $7yNYd.ICommandService));\n    return {\n        id: $bb9ae9d90429a70d$export$6e9dd45d49710046.id,\n        type: (0, $fL2Ug.MenuItemType).BUTTON,\n        icon: \"RightJustifyingSingle\",\n        tooltip: \"toolbar.alignRight\",\n        activated$: new (0, $1O3Nt.Observable)((subscriber)=>{\n            const disposable = commandService.onCommandExecuted((c)=>{\n                var _a28;\n                const id = c.id;\n                if (id === (0, $7AR1b.SetTextSelectionsOperation).id || id === $bb9ae9d90429a70d$export$662c5ab3bad17c14.id) {\n                    const paragraph = $bb9ae9d90429a70d$var$getParagraphStyleAtCursor(accessor);\n                    if (paragraph == null) return;\n                    const alignType = (_a28 = paragraph.paragraphStyle) == null ? void 0 : _a28.horizontalAlign;\n                    subscriber.next(alignType === (0, $7yNYd.HorizontalAlign).RIGHT);\n                }\n            });\n            return subscriber.next(!1), disposable.dispose;\n        }),\n        disabled$: $bb9ae9d90429a70d$var$disableMenuWhenNoDocRange(accessor),\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC)\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$AlignRightMenuItemFactory, \"AlignRightMenuItemFactory\");\nfunction $bb9ae9d90429a70d$var$AlignJustifyMenuItemFactory(accessor) {\n    const commandService = accessor.get((0, $7yNYd.ICommandService));\n    return {\n        id: $bb9ae9d90429a70d$export$8812c7b8ff337c70.id,\n        type: (0, $fL2Ug.MenuItemType).BUTTON,\n        icon: \"AlignTextBothSingle\",\n        tooltip: \"toolbar.alignJustify\",\n        activated$: new (0, $1O3Nt.Observable)((subscriber)=>{\n            const disposable = commandService.onCommandExecuted((c)=>{\n                var _a28;\n                const id = c.id;\n                if (id === (0, $7AR1b.SetTextSelectionsOperation).id || id === $bb9ae9d90429a70d$export$662c5ab3bad17c14.id) {\n                    const paragraph = $bb9ae9d90429a70d$var$getParagraphStyleAtCursor(accessor);\n                    if (paragraph == null) return;\n                    const alignType = (_a28 = paragraph.paragraphStyle) == null ? void 0 : _a28.horizontalAlign;\n                    subscriber.next(alignType === (0, $7yNYd.HorizontalAlign).JUSTIFIED);\n                }\n            });\n            return subscriber.next(!1), disposable.dispose;\n        }),\n        disabled$: $bb9ae9d90429a70d$var$disableMenuWhenNoDocRange(accessor),\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC)\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$AlignJustifyMenuItemFactory, \"AlignJustifyMenuItemFactory\");\nconst $bb9ae9d90429a70d$var$listValueFactory$ = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((accessor)=>new (0, $1O3Nt.Observable)((subscriber)=>{\n        const univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), docSelectionManagerService = accessor.get((0, $7AR1b.DocSelectionManagerService));\n        let textSubscription;\n        const subscription = univerInstanceService.focused$.subscribe((unitId)=>{\n            if (textSubscription == null || textSubscription.unsubscribe(), unitId == null) return;\n            const docDataModel = univerInstanceService.getUniverDocInstance(unitId);\n            docDataModel != null && (textSubscription = docSelectionManagerService.textSelection$.subscribe(()=>{\n                var _a28, _b;\n                const range = docSelectionManagerService.getActiveTextRange();\n                if (range) {\n                    const doc = docDataModel.getSelfOrHeaderFooterModel(range == null ? void 0 : range.segmentId), paragraphs = $bb9ae9d90429a70d$export$36fe13a9a4b57a90(range, (_b = (_a28 = doc.getBody()) == null ? void 0 : _a28.paragraphs) != null ? _b : []);\n                    let listType;\n                    if (paragraphs.every((p2)=>{\n                        var _a29;\n                        return listType || (listType = (_a29 = p2.bullet) == null ? void 0 : _a29.listType), p2.bullet && p2.bullet.listType === listType;\n                    })) {\n                        subscriber.next(listType);\n                        return;\n                    }\n                }\n                subscriber.next(void 0);\n            }));\n        });\n        return ()=>{\n            subscription.unsubscribe(), textSubscription == null || textSubscription.unsubscribe();\n        };\n    }), \"listValueFactory$\");\nfunction $bb9ae9d90429a70d$var$OrderListMenuItemFactory(accessor) {\n    return {\n        id: $bb9ae9d90429a70d$export$e87051556a6af02d.id,\n        type: (0, $fL2Ug.MenuItemType).BUTTON_SELECTOR,\n        selections: [\n            {\n                label: {\n                    name: $bb9ae9d90429a70d$var$ORDER_LIST_TYPE_COMPONENT,\n                    hoverable: !1\n                },\n                value$: $bb9ae9d90429a70d$var$listValueFactory$(accessor)\n            }\n        ],\n        icon: \"OrderSingle\",\n        tooltip: \"toolbar.order\",\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC),\n        disabled$: $bb9ae9d90429a70d$var$disableMenuWhenNoDocRange(accessor),\n        activated$: $bb9ae9d90429a70d$var$listValueFactory$(accessor).pipe((0, $hciHF.map)((v)=>v && v.indexOf(\"ORDER_LIST\") === 0))\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$OrderListMenuItemFactory, \"OrderListMenuItemFactory\");\nfunction $bb9ae9d90429a70d$var$BulletListMenuItemFactory(accessor) {\n    return {\n        id: $bb9ae9d90429a70d$export$baa537c1cdd3ac5a.id,\n        type: (0, $fL2Ug.MenuItemType).BUTTON_SELECTOR,\n        selections: [\n            {\n                label: {\n                    name: $bb9ae9d90429a70d$var$BULLET_LIST_TYPE_COMPONENT,\n                    hoverable: !1\n                },\n                value$: $bb9ae9d90429a70d$var$listValueFactory$(accessor)\n            }\n        ],\n        icon: \"UnorderSingle\",\n        tooltip: \"toolbar.unorder\",\n        disabled$: $bb9ae9d90429a70d$var$disableMenuWhenNoDocRange(accessor),\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC),\n        activated$: $bb9ae9d90429a70d$var$listValueFactory$(accessor).pipe((0, $hciHF.map)((v)=>v && v.indexOf(\"BULLET_LIST\") === 0))\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$BulletListMenuItemFactory, \"BulletListMenuItemFactory\");\nfunction $bb9ae9d90429a70d$var$CheckListMenuItemFactory(accessor) {\n    return {\n        id: $bb9ae9d90429a70d$export$dfb9f80f41464abe.id,\n        type: (0, $fL2Ug.MenuItemType).BUTTON,\n        icon: \"TodoList\",\n        tooltip: \"toolbar.checklist\",\n        disabled$: $bb9ae9d90429a70d$var$disableMenuWhenNoDocRange(accessor),\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC),\n        activated$: $bb9ae9d90429a70d$var$listValueFactory$(accessor).pipe((0, $hciHF.map)((v)=>v && v.indexOf(\"CHECK_LIST\") === 0))\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$CheckListMenuItemFactory, \"CheckListMenuItemFactory\");\nfunction $bb9ae9d90429a70d$var$ResetBackgroundColorMenuItemFactory(accessor) {\n    return {\n        id: $bb9ae9d90429a70d$export$78c2c1a989d143a9.id,\n        type: (0, $fL2Ug.MenuItemType).BUTTON,\n        title: \"toolbar.resetColor\",\n        icon: \"NoColor\"\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$ResetBackgroundColorMenuItemFactory, \"ResetBackgroundColorMenuItemFactory\");\nfunction $bb9ae9d90429a70d$var$BackgroundColorSelectorMenuItemFactory(accessor) {\n    const commandService = accessor.get((0, $7yNYd.ICommandService)), themeService = accessor.get((0, $7yNYd.ThemeService));\n    return {\n        id: $bb9ae9d90429a70d$export$7787f0bdf26d2ee3.id,\n        tooltip: \"toolbar.fillColor.main\",\n        type: (0, $fL2Ug.MenuItemType).BUTTON_SELECTOR,\n        icon: \"PaintBucket\",\n        selections: [\n            {\n                label: {\n                    name: $bb9ae9d90429a70d$var$COLOR_PICKER_COMPONENT,\n                    hoverable: !1\n                }\n            }\n        ],\n        value$: new (0, $1O3Nt.Observable)((subscriber)=>{\n            const defaultColor = themeService.getCurrentTheme().primaryColor, disposable = commandService.onCommandExecuted((c)=>{\n                if (c.id === $bb9ae9d90429a70d$export$7787f0bdf26d2ee3.id) {\n                    const color = c.params.value;\n                    subscriber.next(color != null ? color : defaultColor);\n                }\n            });\n            return subscriber.next(defaultColor), disposable.dispose;\n        }),\n        disabled$: $bb9ae9d90429a70d$var$disableMenuWhenNoDocRange(accessor),\n        hidden$: (0, $fL2Ug.getMenuHiddenObservable)(accessor, (0, $7yNYd.UniverInstanceType).UNIVER_DOC)\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$BackgroundColorSelectorMenuItemFactory, \"BackgroundColorSelectorMenuItemFactory\");\nfunction $bb9ae9d90429a70d$var$getFontStyleAtCursor(accessor) {\n    var _a28;\n    const univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), textSelectionService = accessor.get((0, $7AR1b.DocSelectionManagerService)), docDataModel = univerInstanceService.getCurrentUniverDocInstance(), activeTextRange = textSelectionService.getActiveTextRange();\n    if (docDataModel == null || activeTextRange == null) return;\n    const { startOffset: startOffset, segmentId: segmentId } = activeTextRange, textRuns = (_a28 = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()) == null ? void 0 : _a28.textRuns;\n    if (textRuns == null) return;\n    let textRun;\n    for(let i = textRuns.length - 1; i >= 0; i--){\n        const curTextRun = textRuns[i];\n        if (curTextRun.st <= startOffset && startOffset <= curTextRun.ed) {\n            textRun = curTextRun;\n            break;\n        }\n    }\n    return textRun;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getFontStyleAtCursor, \"getFontStyleAtCursor\");\nfunction $bb9ae9d90429a70d$var$getParagraphStyleAtCursor(accessor) {\n    var _a28;\n    const univerInstanceService = accessor.get((0, $7yNYd.IUniverInstanceService)), textSelectionService = accessor.get((0, $7AR1b.DocSelectionManagerService)), docDataModel = univerInstanceService.getCurrentUniverDocInstance(), activeTextRange = textSelectionService.getActiveTextRange();\n    if (docDataModel == null || activeTextRange == null) return;\n    const { startOffset: startOffset, segmentId: segmentId } = activeTextRange, paragraphs = (_a28 = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()) == null ? void 0 : _a28.paragraphs;\n    if (paragraphs == null) return;\n    let prevIndex = -1;\n    for (const paragraph of paragraphs){\n        const { startIndex: startIndex } = paragraph;\n        if (startOffset > prevIndex && startOffset <= startIndex) return paragraph;\n        prevIndex = startIndex;\n    }\n    return null;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$getParagraphStyleAtCursor, \"getParagraphStyleAtCursor\");\nconst $bb9ae9d90429a70d$export$f379d63d17da932e = {\n    [(0, $fL2Ug.RibbonStartGroup).FORMAT]: {\n        [$bb9ae9d90429a70d$export$2ac5c6b1b1b0feee.id]: {\n            order: 0,\n            menuItemFactory: $bb9ae9d90429a70d$var$BoldMenuItemFactory\n        },\n        [$bb9ae9d90429a70d$export$6f96a39ba8cb4fb2.id]: {\n            order: 1,\n            menuItemFactory: $bb9ae9d90429a70d$var$ItalicMenuItemFactory\n        },\n        [$bb9ae9d90429a70d$export$64d38e2980266dfc.id]: {\n            order: 2,\n            menuItemFactory: $bb9ae9d90429a70d$var$UnderlineMenuItemFactory\n        },\n        [$bb9ae9d90429a70d$export$e70c98b3ed3cca1c.id]: {\n            order: 3,\n            menuItemFactory: $bb9ae9d90429a70d$var$StrikeThroughMenuItemFactory\n        },\n        [$bb9ae9d90429a70d$export$73eebc63961c6386.id]: {\n            order: 4,\n            menuItemFactory: $bb9ae9d90429a70d$var$SubscriptMenuItemFactory\n        },\n        [$bb9ae9d90429a70d$export$eced467326987bcd.id]: {\n            order: 5,\n            menuItemFactory: $bb9ae9d90429a70d$var$SuperscriptMenuItemFactory\n        },\n        [$bb9ae9d90429a70d$export$6723c87fd3465f36.id]: {\n            order: 6,\n            menuItemFactory: $bb9ae9d90429a70d$var$FontSizeSelectorMenuItemFactory\n        },\n        [$bb9ae9d90429a70d$export$b6aad3c88c8d5d81.id]: {\n            order: 7,\n            menuItemFactory: $bb9ae9d90429a70d$var$FontFamilySelectorMenuItemFactory\n        },\n        [$bb9ae9d90429a70d$export$61b23f520937a12f.id]: {\n            order: 8,\n            menuItemFactory: $bb9ae9d90429a70d$var$TextColorSelectorMenuItemFactory\n        },\n        [$bb9ae9d90429a70d$export$7787f0bdf26d2ee3.id]: {\n            order: 9,\n            menuItemFactory: $bb9ae9d90429a70d$var$BackgroundColorSelectorMenuItemFactory,\n            [$bb9ae9d90429a70d$export$78c2c1a989d143a9.id]: {\n                order: 0,\n                menuItemFactory: $bb9ae9d90429a70d$var$ResetBackgroundColorMenuItemFactory\n            }\n        }\n    },\n    [(0, $fL2Ug.RibbonStartGroup).LAYOUT]: {\n        [$bb9ae9d90429a70d$var$TABLE_MENU_ID]: {\n            order: 1,\n            menuItemFactory: $bb9ae9d90429a70d$var$TableMenuFactory,\n            [$bb9ae9d90429a70d$export$1e0acf08c78e9a29.id]: {\n                order: 0,\n                menuItemFactory: $bb9ae9d90429a70d$var$InsertTableMenuFactory\n            }\n        },\n        [$bb9ae9d90429a70d$export$7a3dedab32c2d5a9.id]: {\n            order: 2,\n            menuItemFactory: $bb9ae9d90429a70d$var$AlignLeftMenuItemFactory\n        },\n        [$bb9ae9d90429a70d$export$d6d3a31584e4793b.id]: {\n            order: 3,\n            menuItemFactory: $bb9ae9d90429a70d$var$AlignCenterMenuItemFactory\n        },\n        [$bb9ae9d90429a70d$export$6e9dd45d49710046.id]: {\n            order: 4,\n            menuItemFactory: $bb9ae9d90429a70d$var$AlignRightMenuItemFactory\n        },\n        [$bb9ae9d90429a70d$export$8812c7b8ff337c70.id]: {\n            order: 5,\n            menuItemFactory: $bb9ae9d90429a70d$var$AlignJustifyMenuItemFactory\n        },\n        [$bb9ae9d90429a70d$export$e87051556a6af02d.id]: {\n            order: 6,\n            menuItemFactory: $bb9ae9d90429a70d$var$OrderListMenuItemFactory\n        },\n        [$bb9ae9d90429a70d$export$baa537c1cdd3ac5a.id]: {\n            order: 7,\n            menuItemFactory: $bb9ae9d90429a70d$var$BulletListMenuItemFactory\n        },\n        [$bb9ae9d90429a70d$export$dfb9f80f41464abe.id]: {\n            order: 8,\n            menuItemFactory: $bb9ae9d90429a70d$var$CheckListMenuItemFactory\n        },\n        [$bb9ae9d90429a70d$var$OpenHeaderFooterPanelCommand.id]: {\n            order: 9,\n            menuItemFactory: $bb9ae9d90429a70d$var$HeaderFooterMenuItemFactory\n        }\n    },\n    [(0, $fL2Ug.ContextMenuPosition).MAIN_AREA]: {\n        [(0, $fL2Ug.ContextMenuGroup).FORMAT]: {\n            [$bb9ae9d90429a70d$export$9f1a20871184dbfd.name]: {\n                order: 0,\n                menuItemFactory: $bb9ae9d90429a70d$var$CopyMenuFactory\n            },\n            [$bb9ae9d90429a70d$export$f23b9559f1e5cf86.id]: {\n                order: 1,\n                menuItemFactory: $bb9ae9d90429a70d$var$CutMenuFactory\n            },\n            [$bb9ae9d90429a70d$export$c2cb6d04fe50d389.id]: {\n                order: 2,\n                menuItemFactory: $bb9ae9d90429a70d$var$PasteMenuFactory\n            },\n            [$bb9ae9d90429a70d$export$b83c33c82ff96791.id]: {\n                order: 3,\n                menuItemFactory: $bb9ae9d90429a70d$var$DeleteMenuFactory\n            }\n        },\n        [(0, $fL2Ug.ContextMenuGroup).LAYOUT]: {\n            [$bb9ae9d90429a70d$var$DocParagraphSettingPanelOperation.id]: {\n                order: 0,\n                menuItemFactory: $bb9ae9d90429a70d$var$ParagraphSettingMenuFactory\n            },\n            [$bb9ae9d90429a70d$var$TABLE_INSERT_MENU_ID]: {\n                order: 1,\n                menuItemFactory: $bb9ae9d90429a70d$var$TableInsertMenuItemFactory,\n                [$bb9ae9d90429a70d$export$d24aed1c729ddbeb.id]: {\n                    order: 1,\n                    menuItemFactory: $bb9ae9d90429a70d$var$InsertRowBeforeMenuItemFactory\n                },\n                [$bb9ae9d90429a70d$export$5c48014be93c9100.id]: {\n                    order: 2,\n                    menuItemFactory: $bb9ae9d90429a70d$var$InsertRowAfterMenuItemFactory\n                },\n                [$bb9ae9d90429a70d$export$e0b51bcab3a3cf9c.id]: {\n                    order: 3,\n                    menuItemFactory: $bb9ae9d90429a70d$var$InsertColumnLeftMenuItemFactory\n                },\n                [$bb9ae9d90429a70d$export$f1900f4bfa5f38e0.id]: {\n                    order: 4,\n                    menuItemFactory: $bb9ae9d90429a70d$var$InsertColumnRightMenuItemFactory\n                }\n            },\n            [$bb9ae9d90429a70d$var$TABLE_DELETE_MENU_ID]: {\n                order: 2,\n                menuItemFactory: $bb9ae9d90429a70d$var$TableDeleteMenuItemFactory,\n                [$bb9ae9d90429a70d$export$a24cf2b8bfb8aa0d.id]: {\n                    order: 1,\n                    menuItemFactory: $bb9ae9d90429a70d$var$DeleteRowsMenuItemFactory\n                },\n                [$bb9ae9d90429a70d$export$9460cec99108a171.id]: {\n                    order: 2,\n                    menuItemFactory: $bb9ae9d90429a70d$var$DeleteColumnsMenuItemFactory\n                },\n                [$bb9ae9d90429a70d$export$ec800041f6d17822.id]: {\n                    order: 3,\n                    menuItemFactory: $bb9ae9d90429a70d$var$DeleteTableMenuItemFactory\n                }\n            }\n        }\n    }\n};\nvar $bb9ae9d90429a70d$var$__defProp$l = Object.defineProperty, $bb9ae9d90429a70d$var$__getOwnPropDesc$l = Object.getOwnPropertyDescriptor, $bb9ae9d90429a70d$var$__decorateClass$l = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((decorators, target, key, kind)=>{\n    for(var result = kind > 1 ? void 0 : kind ? $bb9ae9d90429a70d$var$__getOwnPropDesc$l(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)(decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n    return kind && result && $bb9ae9d90429a70d$var$__defProp$l(target, key, result), result;\n}, \"__decorateClass$l\"), $bb9ae9d90429a70d$var$__decorateParam$l = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((index, decorator)=>(target, key)=>decorator(target, key, index), \"__decorateParam$l\"), $bb9ae9d90429a70d$var$_a6;\nlet $bb9ae9d90429a70d$export$ef4d9179ef3ec705 = ($bb9ae9d90429a70d$var$_a6 = class extends (0, $7yNYd.Disposable) {\n    constructor(_injector, _componentManager, _commandService, _layoutService, _menuManagerService, _uiPartsService, _univerInstanceService, _shortcutService, _configService){\n        super(), this._injector = _injector, this._componentManager = _componentManager, this._commandService = _commandService, this._layoutService = _layoutService, this._menuManagerService = _menuManagerService, this._uiPartsService = _uiPartsService, this._univerInstanceService = _univerInstanceService, this._shortcutService = _shortcutService, this._configService = _configService, this._init();\n    }\n    _initCustomComponents() {\n        const componentManager = this._componentManager;\n        this.disposeWithMe(componentManager.register($bb9ae9d90429a70d$var$COLOR_PICKER_COMPONENT, (0, $1UDbf.ColorPicker))), this.disposeWithMe(componentManager.register($bb9ae9d90429a70d$var$FONT_FAMILY_COMPONENT, (0, $fL2Ug.FontFamily))), this.disposeWithMe(componentManager.register($bb9ae9d90429a70d$var$FONT_FAMILY_ITEM_COMPONENT, (0, $fL2Ug.FontFamilyItem))), this.disposeWithMe(componentManager.register($bb9ae9d90429a70d$var$FONT_SIZE_COMPONENT, (0, $fL2Ug.FontSize))), this.disposeWithMe(componentManager.register($bb9ae9d90429a70d$var$BULLET_LIST_TYPE_COMPONENT, $bb9ae9d90429a70d$var$BulletListTypePicker)), this.disposeWithMe(componentManager.register($bb9ae9d90429a70d$var$ORDER_LIST_TYPE_COMPONENT, $bb9ae9d90429a70d$var$OrderListTypePicker)), this.disposeWithMe(componentManager.register(\"TodoList\", $bb9ae9d90429a70d$var$TodoList));\n    }\n    // TODO: @zhangwei, why add workbook to docs-ui?\n    _initUiParts() {\n        var _a28, _b;\n        const workbook = this._univerInstanceService.getCurrentUnitForType((0, $7yNYd.UniverInstanceType).UNIVER_SHEET), config = this._configService.getConfig($bb9ae9d90429a70d$var$PLUGIN_CONFIG_KEY);\n        (_b = (_a28 = config == null ? void 0 : config.layout) == null ? void 0 : _a28.docContainerConfig) != null && _b.footer && !workbook && this.disposeWithMe(this._uiPartsService.registerComponent((0, $fL2Ug.BuiltInUIPart).FOOTER, ()=>(0, $7yNYd.connectInjector)($bb9ae9d90429a70d$var$DocFooter, this._injector)));\n    }\n    _initMenus() {\n        this._menuManagerService.mergeMenu($bb9ae9d90429a70d$export$f379d63d17da932e);\n    }\n    _initShortCut() {\n        [\n            $bb9ae9d90429a70d$var$BoldShortCut,\n            $bb9ae9d90429a70d$var$ItalicShortCut,\n            $bb9ae9d90429a70d$var$UnderlineShortCut,\n            $bb9ae9d90429a70d$var$StrikeThroughShortCut,\n            $bb9ae9d90429a70d$var$SubscriptShortCut,\n            $bb9ae9d90429a70d$var$SuperscriptShortCut,\n            $bb9ae9d90429a70d$var$AlignCenterShortCut,\n            $bb9ae9d90429a70d$var$AlignJustifyShortCut,\n            $bb9ae9d90429a70d$var$AlignRightShortCut,\n            $bb9ae9d90429a70d$var$AlignLeftShortCut,\n            $bb9ae9d90429a70d$var$OrderListShortCut,\n            $bb9ae9d90429a70d$var$BulletListShortCut,\n            $bb9ae9d90429a70d$var$TabShortCut\n        ].forEach((shortcut)=>{\n            this.disposeWithMe(this._shortcutService.registerShortcut(shortcut));\n        });\n    }\n    _init() {\n        this._initCustomComponents(), this._initMenus(), this._initFocusHandler(), this._initCommands(), this._initUiParts(), this._initShortCut();\n    }\n    _initCommands() {\n        [\n            $bb9ae9d90429a70d$var$CoreHeaderFooterCommand,\n            $bb9ae9d90429a70d$var$OpenHeaderFooterPanelCommand,\n            $bb9ae9d90429a70d$var$SidebarDocHeaderFooterPanelOperation\n        ].forEach((command)=>this.disposeWithMe(this._commandService.registerCommand(command)));\n    }\n    _initFocusHandler() {\n        this.disposeWithMe(this._layoutService.registerFocusHandler((0, $7yNYd.UniverInstanceType).UNIVER_DOC, (unitId)=>{\n            this._injector.get((0, $3e0Iz.IRenderManagerService)).getRenderById(unitId).with($bb9ae9d90429a70d$export$6dc2db33d8a277cd).focus();\n        }));\n    }\n}, $bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_a6, \"DocUIController\"), $bb9ae9d90429a70d$var$_a6);\n$bb9ae9d90429a70d$export$ef4d9179ef3ec705 = $bb9ae9d90429a70d$var$__decorateClass$l([\n    (0, $7yNYd.OnLifecycle)((0, $7yNYd.LifecycleStages).Rendered, $bb9ae9d90429a70d$export$ef4d9179ef3ec705),\n    $bb9ae9d90429a70d$var$__decorateParam$l(0, (0, $7yNYd.Inject)((0, $7yNYd.Injector))),\n    $bb9ae9d90429a70d$var$__decorateParam$l(1, (0, $7yNYd.Inject)((0, $fL2Ug.ComponentManager))),\n    $bb9ae9d90429a70d$var$__decorateParam$l(2, (0, $7yNYd.ICommandService)),\n    $bb9ae9d90429a70d$var$__decorateParam$l(3, (0, $fL2Ug.ILayoutService)),\n    $bb9ae9d90429a70d$var$__decorateParam$l(4, (0, $fL2Ug.IMenuManagerService)),\n    $bb9ae9d90429a70d$var$__decorateParam$l(5, (0, $fL2Ug.IUIPartsService)),\n    $bb9ae9d90429a70d$var$__decorateParam$l(6, (0, $7yNYd.IUniverInstanceService)),\n    $bb9ae9d90429a70d$var$__decorateParam$l(7, (0, $fL2Ug.IShortcutService)),\n    $bb9ae9d90429a70d$var$__decorateParam$l(8, (0, $7yNYd.IConfigService))\n], $bb9ae9d90429a70d$export$ef4d9179ef3ec705);\nvar $bb9ae9d90429a70d$var$__defProp$k = Object.defineProperty, $bb9ae9d90429a70d$var$__getOwnPropDesc$k = Object.getOwnPropertyDescriptor, $bb9ae9d90429a70d$var$__decorateClass$k = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((decorators, target, key, kind)=>{\n    for(var result = kind > 1 ? void 0 : kind ? $bb9ae9d90429a70d$var$__getOwnPropDesc$k(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)(decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n    return kind && result && $bb9ae9d90429a70d$var$__defProp$k(target, key, result), result;\n}, \"__decorateClass$k\"), $bb9ae9d90429a70d$var$__decorateParam$k = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((index, decorator)=>(target, key)=>decorator(target, key, index), \"__decorateParam$k\");\nconst $bb9ae9d90429a70d$var$ANCHOR_WIDTH = 1.5;\nvar $bb9ae9d90429a70d$var$_a7;\nlet $bb9ae9d90429a70d$export$8eff10ad7001c373 = ($bb9ae9d90429a70d$var$_a7 = class extends (0, $7yNYd.RxDisposable) {\n    constructor(_context, _textSelectionManagerService, _editorService, _docSkeletonManagerService){\n        super(), this._context = _context, this._textSelectionManagerService = _textSelectionManagerService, this._editorService = _editorService, this._docSkeletonManagerService = _docSkeletonManagerService, this._init();\n    }\n    _init() {\n        this._textSelectionManagerService.textSelection$.pipe((0, $2jrJe.takeUntil)(this.dispose$)).subscribe((params)=>{\n            if (params == null) return;\n            const { isEditing: isEditing, unitId: unitId } = params;\n            unitId !== this._context.unitId || !isEditing || this._scrollToSelection();\n        });\n    }\n    scrollToRange(range) {\n        const skeleton = this._docSkeletonManagerService.getSkeleton();\n        if (!skeleton) return;\n        const { startOffset: startOffset } = range, anchorNodePosition = skeleton.findNodePositionByCharIndex(startOffset);\n        this.scrollToNode(anchorNodePosition);\n    }\n    scrollToNode(startNodePosition) {\n        const { unitId: unitId, scene: scene, mainComponent: mainComponent } = this._context, skeleton = this._docSkeletonManagerService.getSkeleton();\n        if (mainComponent == null || skeleton == null) return;\n        const documentOffsetConfig = mainComponent.getOffsetConfig(), { docsLeft: docsLeft, docsTop: docsTop } = documentOffsetConfig, convertor = new $bb9ae9d90429a70d$export$37b489d6b2152f0f(documentOffsetConfig, skeleton), { contentBoxPointGroup: contentBoxPointGroup } = convertor.getRangePointData(startNodePosition, startNodePosition), { left: aLeft, top: aTop, height: height } = $bb9ae9d90429a70d$export$ea37786f3b0c02f2(contentBoxPointGroup), left = aLeft + docsLeft, top = aTop + docsTop, viewportMain = scene.getViewport($bb9ae9d90429a70d$export$691aac3130b48bd9.VIEW_MAIN), isEditor = !!this._editorService.getEditor(unitId);\n        if (viewportMain == null) return;\n        const { left: boundLeft, top: boundTop, right: boundRight, bottom: boundBottom } = viewportMain.getBounding().viewBound;\n        let offsetY = 0, offsetX = 0;\n        const delta = isEditor ? 0 : 100;\n        top < boundTop ? offsetY = top - boundTop - delta : top > boundBottom - height && (offsetY = top - boundBottom + height + delta), left < boundLeft ? offsetX = left - boundLeft : left > boundRight - $bb9ae9d90429a70d$var$ANCHOR_WIDTH && (offsetX = left - boundRight + $bb9ae9d90429a70d$var$ANCHOR_WIDTH);\n        const config = viewportMain.transViewportScroll2ScrollValue(offsetX, offsetY);\n        viewportMain.scrollByBarDeltaValue(config);\n    }\n    // Let the selection show on the current screen.\n    _scrollToSelection() {\n        const activeTextRange = this._textSelectionManagerService.getActiveTextRange();\n        if (activeTextRange == null) return;\n        const { collapsed: collapsed, startNodePosition: startNodePosition } = activeTextRange;\n        collapsed && this.scrollToNode(startNodePosition);\n    }\n}, $bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_a7, \"DocBackScrollRenderController\"), $bb9ae9d90429a70d$var$_a7);\n$bb9ae9d90429a70d$export$8eff10ad7001c373 = $bb9ae9d90429a70d$var$__decorateClass$k([\n    $bb9ae9d90429a70d$var$__decorateParam$k(1, (0, $7yNYd.Inject)((0, $7AR1b.DocSelectionManagerService))),\n    $bb9ae9d90429a70d$var$__decorateParam$k(2, (0, $fL2Ug.IEditorService)),\n    $bb9ae9d90429a70d$var$__decorateParam$k(3, (0, $7yNYd.Inject)((0, $7AR1b.DocSkeletonManagerService)))\n], $bb9ae9d90429a70d$export$8eff10ad7001c373);\nvar $bb9ae9d90429a70d$var$__defProp$j = Object.defineProperty, $bb9ae9d90429a70d$var$__getOwnPropDesc$j = Object.getOwnPropertyDescriptor, $bb9ae9d90429a70d$var$__decorateClass$j = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((decorators, target, key, kind)=>{\n    for(var result = kind > 1 ? void 0 : kind ? $bb9ae9d90429a70d$var$__getOwnPropDesc$j(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)(decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n    return kind && result && $bb9ae9d90429a70d$var$__defProp$j(target, key, result), result;\n}, \"__decorateClass$j\"), $bb9ae9d90429a70d$var$__decorateParam$j = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((index, decorator)=>(target, key)=>decorator(target, key, index), \"__decorateParam$j\"), $bb9ae9d90429a70d$var$_a8;\nlet $bb9ae9d90429a70d$export$321e75563c26d788 = ($bb9ae9d90429a70d$var$_a8 = class extends (0, $7yNYd.RxDisposable) {\n    constructor(_context, _contextService, _commandService, _docSelectionRenderService, _docSkeletonManagerService, _editorService, _renderManagerService){\n        super(), this._context = _context, this._contextService = _contextService, this._commandService = _commandService, this._docSelectionRenderService = _docSelectionRenderService, this._docSkeletonManagerService = _docSkeletonManagerService, this._editorService = _editorService, this._renderManagerService = _renderManagerService, this._addNewRender(), this._initRenderRefresh(), this._initCommandListener();\n    }\n    reRender(unitId) {\n        var _a28, _b;\n        const docSkeletonManagerService = (_a28 = this._renderManagerService.getRenderById(unitId)) == null ? void 0 : _a28.with((0, $7AR1b.DocSkeletonManagerService)), skeleton = docSkeletonManagerService == null ? void 0 : docSkeletonManagerService.getSkeleton();\n        if (!(!skeleton || skeleton.getViewModel().getDataModel().getSnapshot().disabled)) {\n            if (skeleton.calculate(), this._editorService.isEditor(unitId)) {\n                (_b = this._context.mainComponent) == null || _b.makeDirty();\n                return;\n            }\n            this._recalculateSizeBySkeleton(skeleton);\n        }\n    }\n    _addNewRender() {\n        const { scene: scene, engine: engine } = this._context, viewMain = new (0, $3e0Iz.Viewport)($bb9ae9d90429a70d$export$691aac3130b48bd9.VIEW_MAIN, scene, {\n            left: 0,\n            top: 0,\n            bottom: 0,\n            right: 0,\n            explicitViewportWidthSet: !1,\n            explicitViewportHeightSet: !1,\n            isWheelPreventDefaultX: !0\n        });\n        scene.attachControl(), scene.onMouseWheel$.subscribeEvent((evt, state)=>{\n            if (!this._contextService.getContextValue((0, $7yNYd.FOCUSING_DOC))) return;\n            const e = evt;\n            if (e.ctrlKey) {\n                const deltaFactor = Math.abs(e.deltaX);\n                let scrollNum = deltaFactor < 40 ? 0.2 : deltaFactor < 80 ? 0.4 : 0.2;\n                scrollNum *= e.deltaY > 0 ? -1 : 1, scene.scaleX < 1 && (scrollNum /= 2), scene.scaleX + scrollNum > 4 ? scene.scale(4, 4) : scene.scaleX + scrollNum < 0.1 ? scene.scale(0.1, 0.1) : e.preventDefault();\n            } else viewMain.onMouseWheel(e, state);\n        }), new (0, $3e0Iz.ScrollBar)(viewMain), scene.addLayer(new (0, $3e0Iz.Layer)(scene, [], $bb9ae9d90429a70d$export$71efbe292af93edf), new (0, $3e0Iz.Layer)(scene, [], $bb9ae9d90429a70d$export$4eda460c535b75e3)), this._addComponent(), engine.runRenderLoop(()=>{\n            scene.render();\n        }), this._docSelectionRenderService.__attachScrollEvent();\n    }\n    _addComponent() {\n        const { scene: scene, unit: documentModel, components: components } = this._context, config = {\n            pageMarginLeft: documentModel.documentStyle.marginLeft || 0,\n            pageMarginTop: documentModel.documentStyle.marginTop || 0\n        }, documents = new (0, $3e0Iz.Documents)($bb9ae9d90429a70d$export$9e0654286d987857.MAIN, void 0, config);\n        documents.zIndex = $bb9ae9d90429a70d$export$87e8cb3bbd02cbdb;\n        const docBackground = new (0, $3e0Iz.DocBackground)($bb9ae9d90429a70d$export$9e0654286d987857.BACKGROUND, void 0, config);\n        docBackground.zIndex = $bb9ae9d90429a70d$export$87e8cb3bbd02cbdb, this._context.mainComponent = documents, components.set($bb9ae9d90429a70d$export$9e0654286d987857.MAIN, documents), components.set($bb9ae9d90429a70d$export$9e0654286d987857.BACKGROUND, docBackground), scene.addObjects([\n            documents\n        ], $bb9ae9d90429a70d$export$71efbe292af93edf), scene.addObjects([\n            docBackground\n        ], $bb9ae9d90429a70d$export$f22f28902a63806f), this._editorService.getEditor(documentModel.getUnitId()) == null && scene.enableLayerCache($bb9ae9d90429a70d$export$71efbe292af93edf);\n    }\n    _initRenderRefresh() {\n        this._docSkeletonManagerService.currentSkeletonBefore$.pipe((0, $2jrJe.takeUntil)(this.dispose$)).subscribe((param)=>{\n            this._create(param);\n        });\n    }\n    _create(skeleton) {\n        if (!skeleton) return;\n        const { mainComponent: mainComponent, components: components } = this._context, docsComponent = mainComponent, docBackground = components.get($bb9ae9d90429a70d$export$9e0654286d987857.BACKGROUND);\n        docsComponent.changeSkeleton(skeleton), docBackground.changeSkeleton(skeleton), this._recalculateSizeBySkeleton(skeleton);\n    }\n    _initCommandListener() {\n        const updateCommandList = [\n            (0, $7AR1b.RichTextEditingMutation).id\n        ];\n        this.disposeWithMe(this._commandService.onCommandExecuted((command)=>{\n            if (updateCommandList.includes(command.id)) {\n                const params = command.params, { unitId: unitId } = params;\n                this.reRender(unitId);\n            }\n        }));\n    }\n    _recalculateSizeBySkeleton(skeleton) {\n        var _a28;\n        const { mainComponent: mainComponent, scene: scene, unitId: unitId, components: components } = this._context, docsComponent = mainComponent, docBackground = components.get($bb9ae9d90429a70d$export$9e0654286d987857.BACKGROUND), pages = (_a28 = skeleton.getSkeletonData()) == null ? void 0 : _a28.pages;\n        if (pages == null) return;\n        let width = 0, height = 0;\n        for(let i = 0, len = pages.length; i < len; i++){\n            const page = pages[i], { pageWidth: pageWidth, pageHeight: pageHeight } = page;\n            docsComponent.pageLayoutType === (0, $3e0Iz.PageLayoutType).VERTICAL ? (height += pageHeight, height += docsComponent.pageMarginTop, i === len - 1 && (height += docsComponent.pageMarginTop), width = Math.max(width, pageWidth)) : docsComponent.pageLayoutType === (0, $3e0Iz.PageLayoutType).HORIZONTAL && (width += pageWidth, i !== len - 1 && (width += docsComponent.pageMarginLeft), height = Math.max(height, pageHeight));\n        }\n        docsComponent.resize(width, height), docBackground.resize(width, height), this._editorService.isEditor(unitId) || scene.resize(width, height);\n    }\n}, $bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_a8, \"DocRenderController\"), $bb9ae9d90429a70d$var$_a8);\n$bb9ae9d90429a70d$export$321e75563c26d788 = $bb9ae9d90429a70d$var$__decorateClass$j([\n    $bb9ae9d90429a70d$var$__decorateParam$j(1, (0, $7yNYd.IContextService)),\n    $bb9ae9d90429a70d$var$__decorateParam$j(2, (0, $7yNYd.ICommandService)),\n    $bb9ae9d90429a70d$var$__decorateParam$j(3, (0, $7yNYd.Inject)($bb9ae9d90429a70d$export$6dc2db33d8a277cd)),\n    $bb9ae9d90429a70d$var$__decorateParam$j(4, (0, $7yNYd.Inject)((0, $7AR1b.DocSkeletonManagerService))),\n    $bb9ae9d90429a70d$var$__decorateParam$j(5, (0, $fL2Ug.IEditorService)),\n    $bb9ae9d90429a70d$var$__decorateParam$j(6, (0, $3e0Iz.IRenderManagerService))\n], $bb9ae9d90429a70d$export$321e75563c26d788);\nvar $bb9ae9d90429a70d$var$__defProp$i = Object.defineProperty, $bb9ae9d90429a70d$var$__getOwnPropDesc$i = Object.getOwnPropertyDescriptor, $bb9ae9d90429a70d$var$__decorateClass$i = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((decorators, target, key, kind)=>{\n    for(var result = kind > 1 ? void 0 : kind ? $bb9ae9d90429a70d$var$__getOwnPropDesc$i(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)(decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n    return kind && result && $bb9ae9d90429a70d$var$__defProp$i(target, key, result), result;\n}, \"__decorateClass$i\"), $bb9ae9d90429a70d$var$__decorateParam$i = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((index, decorator)=>(target, key)=>decorator(target, key, index), \"__decorateParam$i\"), $bb9ae9d90429a70d$var$_a9;\nlet $bb9ae9d90429a70d$var$DocContainerUIController = ($bb9ae9d90429a70d$var$_a9 = class {\n    constructor(_localeService, _injector, _configService){\n        $bb9ae9d90429a70d$var$__publicField(this, \"_docContainer\");\n        // 获取SheetContainer组件\n        $bb9ae9d90429a70d$var$__publicField(this, \"getComponent\", /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((ref)=>{\n            if (this._docContainer = ref, !ref.getContentRef().current) throw new Error(\"container is not ready\");\n        }, \"getComponent\"));\n        /**\n     * Change language\n     * @param {string} lang new language\n     *\n     * e: {target: HTMLSelectElement } reference from  https://stackoverflow.com/a/48443771\n     *\n     */ $bb9ae9d90429a70d$var$__publicField(this, \"changeLocale\", /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((locale)=>{\n            this._localeService.setLocale(locale);\n        }, \"changeLocale\"));\n        this._localeService = _localeService, this._injector = _injector, this._configService = _configService;\n    }\n    getUIConfig() {\n        return {\n            injector: this._injector,\n            config: this._configService.getConfig($bb9ae9d90429a70d$var$PLUGIN_CONFIG_KEY),\n            changeLocale: this.changeLocale,\n            getComponent: this.getComponent\n        };\n    }\n    getContentRef() {\n        return this._docContainer.getContentRef();\n    }\n    UIDidMount(cb) {\n        if (this._docContainer) return cb(this._docContainer);\n    }\n    getDocContainer() {\n        return this._docContainer;\n    }\n}, $bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_a9, \"DocContainerUIController\"), $bb9ae9d90429a70d$var$_a9);\n$bb9ae9d90429a70d$var$DocContainerUIController = $bb9ae9d90429a70d$var$__decorateClass$i([\n    $bb9ae9d90429a70d$var$__decorateParam$i(0, (0, $7yNYd.Inject)((0, $7yNYd.LocaleService))),\n    $bb9ae9d90429a70d$var$__decorateParam$i(1, (0, $7yNYd.Inject)((0, $7yNYd.Injector))),\n    $bb9ae9d90429a70d$var$__decorateParam$i(2, (0, $7yNYd.IConfigService))\n], $bb9ae9d90429a70d$var$DocContainerUIController);\nvar $bb9ae9d90429a70d$var$__defProp$h = Object.defineProperty, $bb9ae9d90429a70d$var$__getOwnPropDesc$h = Object.getOwnPropertyDescriptor, $bb9ae9d90429a70d$var$__decorateClass$h = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((decorators, target, key, kind)=>{\n    for(var result = kind > 1 ? void 0 : kind ? $bb9ae9d90429a70d$var$__getOwnPropDesc$h(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)(decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n    return kind && result && $bb9ae9d90429a70d$var$__defProp$h(target, key, result), result;\n}, \"__decorateClass$h\"), $bb9ae9d90429a70d$var$__decorateParam$h = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((index, decorator)=>(target, key)=>decorator(target, key, index), \"__decorateParam$h\"), $bb9ae9d90429a70d$var$_a10;\nlet $bb9ae9d90429a70d$var$AppUIController = ($bb9ae9d90429a70d$var$_a10 = class extends (0, $7yNYd.RxDisposable) {\n    constructor(_injector){\n        super();\n        $bb9ae9d90429a70d$var$__publicField(this, \"_docContainerController\");\n        this._injector = _injector, this._docContainerController = this._injector.createInstance($bb9ae9d90429a70d$var$DocContainerUIController);\n    }\n}, $bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_a10, \"AppUIController\"), $bb9ae9d90429a70d$var$_a10);\n$bb9ae9d90429a70d$var$AppUIController = $bb9ae9d90429a70d$var$__decorateClass$h([\n    $bb9ae9d90429a70d$var$__decorateParam$h(0, (0, $7yNYd.Inject)((0, $7yNYd.Injector)))\n], $bb9ae9d90429a70d$var$AppUIController);\nvar $bb9ae9d90429a70d$var$__defProp$g = Object.defineProperty, $bb9ae9d90429a70d$var$__getOwnPropDesc$g = Object.getOwnPropertyDescriptor, $bb9ae9d90429a70d$var$__decorateClass$g = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((decorators, target, key, kind)=>{\n    for(var result = kind > 1 ? void 0 : kind ? $bb9ae9d90429a70d$var$__getOwnPropDesc$g(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)(decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n    return kind && result && $bb9ae9d90429a70d$var$__defProp$g(target, key, result), result;\n}, \"__decorateClass$g\"), $bb9ae9d90429a70d$var$__decorateParam$g = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((index, decorator)=>(target, key)=>decorator(target, key, index), \"__decorateParam$g\"), $bb9ae9d90429a70d$var$_a11;\nlet $bb9ae9d90429a70d$var$DocAutoFormatController = ($bb9ae9d90429a70d$var$_a11 = class extends (0, $7yNYd.Disposable) {\n    constructor(_docAutoFormatService){\n        super(), this._docAutoFormatService = _docAutoFormatService, this._initListTabAutoFormat(), this._initListSpaceAutoFormat(), this._initDefaultEnterFormat(), this._initExitListAutoFormat();\n    }\n    _initListTabAutoFormat() {\n        this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({\n            id: $bb9ae9d90429a70d$export$e2fd85e54fa7b941.id,\n            match: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((context)=>{\n                var _a28;\n                const { selection: selection, paragraphs: paragraphs, unit: unit } = context;\n                if (paragraphs.length === 1 && selection.startOffset === paragraphs[0].paragraphStart && paragraphs[0].bullet) {\n                    const allParagraphs = (_a28 = unit.getBody()) == null ? void 0 : _a28.paragraphs, bulletParagraphs = allParagraphs == null ? void 0 : allParagraphs.filter((p2)=>{\n                        var _a29;\n                        return ((_a29 = p2.bullet) == null ? void 0 : _a29.listId) === paragraphs[0].bullet.listId;\n                    });\n                    return (bulletParagraphs == null ? void 0 : bulletParagraphs.findIndex((p2)=>p2.startIndex === paragraphs[0].startIndex)) !== 0;\n                } else if (paragraphs.length > 1 && paragraphs.some((p2)=>p2.bullet)) return !0;\n                return !1;\n            }, \"match\"),\n            // traverse all paragraphs, set paragraph\n            getMutations (context) {\n                const params = context.commandParams;\n                return [\n                    {\n                        id: $bb9ae9d90429a70d$export$1f6473f08b3bd4f.id,\n                        params: {\n                            type: params != null && params.shift ? $bb9ae9d90429a70d$export$dc1a06c250f0dd7.decrease : $bb9ae9d90429a70d$export$dc1a06c250f0dd7.increase\n                        }\n                    }\n                ];\n            },\n            priority: 100\n        })), this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({\n            id: $bb9ae9d90429a70d$export$e2fd85e54fa7b941.id,\n            match: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((context)=>{\n                const { selection: selection } = context, { startNodePosition: startNodePosition, endNodePosition: endNodePosition } = selection;\n                return !!(startNodePosition && endNodePosition && $bb9ae9d90429a70d$export$57d2e8d2118a89(startNodePosition, endNodePosition) || startNodePosition && !endNodePosition && startNodePosition.path.indexOf(\"cells\") > -1);\n            }, \"match\"),\n            getMutations (context) {\n                const params = context.commandParams;\n                return [\n                    {\n                        id: $bb9ae9d90429a70d$export$d60059992825479d.id,\n                        params: {\n                            shift: !!(params != null && params.shift)\n                        }\n                    }\n                ];\n            },\n            priority: 99\n        }));\n    }\n    _initListSpaceAutoFormat() {\n        this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({\n            id: $bb9ae9d90429a70d$export$57d0a1299f7f4db8.id,\n            match: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((context)=>{\n                var _a28;\n                const { selection: selection, paragraphs: paragraphs, unit: unit } = context;\n                if (!selection.collapsed || paragraphs.length !== 1) return !1;\n                const text = (_a28 = unit.getBody()) == null ? void 0 : _a28.dataStream.slice(paragraphs[0].paragraphStart, paragraphs[0].paragraphEnd - 1);\n                return !!(text && Object.keys((0, $7yNYd.QuickListTypeMap)).includes(text));\n            }, \"match\"),\n            getMutations (context) {\n                var _a28;\n                const { paragraphs: paragraphs, unit: unit } = context, text = (_a28 = unit.getBody()) == null ? void 0 : _a28.dataStream.slice(paragraphs[0].paragraphStart, paragraphs[0].paragraphEnd - 1);\n                if (text && Object.keys((0, $7yNYd.QuickListTypeMap)).includes(text)) {\n                    const type = (0, $7yNYd.QuickListTypeMap)[text];\n                    return [\n                        {\n                            id: $bb9ae9d90429a70d$export$234148d9524301cf.id,\n                            params: {\n                                listType: type,\n                                paragraph: paragraphs[0]\n                            }\n                        }\n                    ];\n                }\n                return [];\n            }\n        }));\n    }\n    _initExitListAutoFormat() {\n        this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({\n            id: $bb9ae9d90429a70d$export$94e417ac7df3c302.id,\n            match: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((context)=>{\n                const { paragraphs: paragraphs } = context;\n                return !!(paragraphs.length === 1 && paragraphs[0].bullet && paragraphs[0].paragraphStart === paragraphs[0].paragraphEnd);\n            }, \"match\"),\n            getMutations: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((context)=>{\n                const bullet = context.paragraphs[0].bullet;\n                return bullet ? bullet.nestingLevel > 0 ? [\n                    {\n                        id: $bb9ae9d90429a70d$export$1f6473f08b3bd4f.id,\n                        params: {\n                            type: $bb9ae9d90429a70d$export$dc1a06c250f0dd7.decrease\n                        }\n                    }\n                ] : [\n                    {\n                        id: $bb9ae9d90429a70d$export$7ae277bfd4e4bfd6.id,\n                        params: {\n                            listType: context.paragraphs[0].bullet.listType\n                        }\n                    }\n                ] : [];\n            }, \"getMutations\")\n        }));\n    }\n    _initDefaultEnterFormat() {\n        this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({\n            id: $bb9ae9d90429a70d$export$94e417ac7df3c302.id,\n            match: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(()=>!0, \"match\"),\n            getMutations () {\n                return [\n                    {\n                        id: $bb9ae9d90429a70d$export$d58fc04233d01bfb.id\n                    }\n                ];\n            },\n            priority: -9999\n        }));\n    }\n}, $bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_a11, \"DocAutoFormatController\"), $bb9ae9d90429a70d$var$_a11);\n$bb9ae9d90429a70d$var$DocAutoFormatController = $bb9ae9d90429a70d$var$__decorateClass$g([\n    (0, $7yNYd.OnLifecycle)((0, $7yNYd.LifecycleStages).Rendered, $bb9ae9d90429a70d$var$DocAutoFormatController),\n    $bb9ae9d90429a70d$var$__decorateParam$g(0, (0, $7yNYd.Inject)($bb9ae9d90429a70d$export$a1c6e22fe3cdf060))\n], $bb9ae9d90429a70d$var$DocAutoFormatController);\nfunction $bb9ae9d90429a70d$var$firstLineInTable(table) {\n    return table.rows[0].cells[0].sections[0].columns[0].lines[0];\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$firstLineInTable, \"firstLineInTable\");\nfunction $bb9ae9d90429a70d$var$lastLineInTable(table) {\n    const lastRow = table.rows[table.rows.length - 1], lastCell = lastRow.cells[lastRow.cells.length - 1];\n    return (0, $3e0Iz.getLastLine)(lastCell);\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$lastLineInTable, \"lastLineInTable\");\nfunction $bb9ae9d90429a70d$var$findTableAfterLine(line, page) {\n    const { ed: ed } = line, { skeTables: skeTables } = page;\n    let table = null;\n    for (const t of skeTables.values())if (t.st === ed + 1) {\n        table = t;\n        break;\n    }\n    return table;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$findTableAfterLine, \"findTableAfterLine\");\nfunction $bb9ae9d90429a70d$var$findLineBeforeAndAfterTable(table) {\n    const tablePage = table == null ? void 0 : table.parent;\n    let lineBeforeTable = null, lineAfterTable = null;\n    if (table == null || tablePage == null) return {\n        lineBeforeTable: lineBeforeTable,\n        lineAfterTable: lineAfterTable\n    };\n    const { st: st, ed: ed } = table, pages = tablePage.type === (0, $3e0Iz.DocumentSkeletonPageType).CELL ? [\n        tablePage\n    ] : tablePage.parent.pages;\n    return (0, $3e0Iz.lineIterator)(pages, (l2)=>{\n        l2.st === ed + 1 ? lineAfterTable = l2 : l2.ed === st - 1 && (lineBeforeTable = l2);\n    }), {\n        lineBeforeTable: lineBeforeTable,\n        lineAfterTable: lineAfterTable\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$findLineBeforeAndAfterTable, \"findLineBeforeAndAfterTable\");\nfunction $bb9ae9d90429a70d$var$findBellowCell(cell) {\n    const row = cell.parent, table = row == null ? void 0 : row.parent;\n    if (row == null || table == null) return;\n    const bellowRow = table.rows[table.rows.indexOf(row) + 1];\n    if (bellowRow == null) return;\n    const col = row.cells.indexOf(cell);\n    return bellowRow.cells[col];\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$findBellowCell, \"findBellowCell\");\nfunction $bb9ae9d90429a70d$var$findAboveCell(cell) {\n    const row = cell.parent, table = row == null ? void 0 : row.parent;\n    if (row == null || table == null) return;\n    const aboveRow = table.rows[table.rows.indexOf(row) - 1];\n    if (aboveRow == null) return;\n    const col = row.cells.indexOf(cell);\n    return aboveRow.cells[col];\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$findAboveCell, \"findAboveCell\");\nfunction $bb9ae9d90429a70d$var$findTableBeforeLine(line, page) {\n    const { st: st } = line, { skeTables: skeTables } = page;\n    let table = null;\n    for (const t of skeTables.values())if (t.ed === st - 1) {\n        table = t;\n        break;\n    }\n    return table;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$findTableBeforeLine, \"findTableBeforeLine\");\nfunction $bb9ae9d90429a70d$var$firstLineInCell(cell) {\n    return cell.sections[0].columns[0].lines[0];\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$firstLineInCell, \"firstLineInCell\");\nfunction $bb9ae9d90429a70d$var$lastLineInCell(cell) {\n    return (0, $3e0Iz.getLastLine)(cell);\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$lastLineInCell, \"lastLineInCell\");\nvar $bb9ae9d90429a70d$var$__defProp$f = Object.defineProperty, $bb9ae9d90429a70d$var$__getOwnPropDesc$f = Object.getOwnPropertyDescriptor, $bb9ae9d90429a70d$var$__decorateClass$f = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((decorators, target, key, kind)=>{\n    for(var result = kind > 1 ? void 0 : kind ? $bb9ae9d90429a70d$var$__getOwnPropDesc$f(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)(decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n    return kind && result && $bb9ae9d90429a70d$var$__defProp$f(target, key, result), result;\n}, \"__decorateClass$f\"), $bb9ae9d90429a70d$var$__decorateParam$f = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((index, decorator)=>(target, key)=>decorator(target, key, index), \"__decorateParam$f\"), $bb9ae9d90429a70d$var$_a12;\nlet $bb9ae9d90429a70d$var$DocMoveCursorController = ($bb9ae9d90429a70d$var$_a12 = class extends (0, $7yNYd.Disposable) {\n    constructor(_univerInstanceService, _renderManagerService, _textSelectionManagerService, _commandService){\n        super();\n        $bb9ae9d90429a70d$var$__publicField(this, \"_onInputSubscription\");\n        this._univerInstanceService = _univerInstanceService, this._renderManagerService = _renderManagerService, this._textSelectionManagerService = _textSelectionManagerService, this._commandService = _commandService, this._commandExecutedListener();\n    }\n    dispose() {\n        var _a28;\n        super.dispose(), (_a28 = this._onInputSubscription) == null || _a28.unsubscribe();\n    }\n    _commandExecutedListener() {\n        const updateCommandList = [\n            $bb9ae9d90429a70d$export$12633081beeab12c.id,\n            $bb9ae9d90429a70d$export$bb98a1a9da56437b.id\n        ];\n        this.disposeWithMe(this._commandService.onCommandExecuted((command)=>{\n            if (!updateCommandList.includes(command.id)) return;\n            const param = command.params;\n            switch(command.id){\n                case $bb9ae9d90429a70d$export$12633081beeab12c.id:\n                    return this._handleMoveCursor(param.direction);\n                case $bb9ae9d90429a70d$export$bb98a1a9da56437b.id:\n                    return this._handleShiftMoveSelection(param.direction);\n                default:\n                    throw new Error(\"Unknown command\");\n            }\n        }));\n    }\n    // eslint-disable-next-line max-lines-per-function, complexity\n    _handleShiftMoveSelection(direction) {\n        var _a28, _b, _c;\n        const activeRange = this._textSelectionManagerService.getActiveTextRange(), allRanges = this._textSelectionManagerService.getCurrentTextRanges(), docDataModel = this._univerInstanceService.getCurrentUniverDocInstance();\n        if (docDataModel == null) return;\n        const skeleton = (_a28 = this._renderManagerService.getRenderById(docDataModel.getUnitId())) == null ? void 0 : _a28.with((0, $7AR1b.DocSkeletonManagerService)).getSkeleton(), docObject = this._getDocObject();\n        if (activeRange == null || skeleton == null || docObject == null) return;\n        const { startOffset: startOffset, endOffset: endOffset, style: style, collapsed: collapsed, direction: rangeDirection, segmentId: segmentId, startNodePosition: startNodePosition, endNodePosition: endNodePosition, segmentPage: segmentPage } = activeRange;\n        if (allRanges.length > 1) {\n            let min = Number.POSITIVE_INFINITY, max = Number.NEGATIVE_INFINITY;\n            for (const range of allRanges)min = Math.min(min, range.startOffset), max = Math.max(max, range.endOffset);\n            this._textSelectionManagerService.replaceTextRanges([\n                {\n                    startOffset: direction === (0, $7yNYd.Direction).LEFT || direction === (0, $7yNYd.Direction).UP ? max : min,\n                    endOffset: direction === (0, $7yNYd.Direction).LEFT || direction === (0, $7yNYd.Direction).UP ? min : max,\n                    style: style\n                }\n            ], !1);\n            return;\n        }\n        const anchorOffset = collapsed || rangeDirection === (0, $7yNYd.RANGE_DIRECTION).FORWARD ? startOffset : endOffset;\n        let focusOffset = collapsed || rangeDirection === (0, $7yNYd.RANGE_DIRECTION).FORWARD ? endOffset : startOffset;\n        const dataStreamLength = (_b = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody().dataStream.length) != null ? _b : Number.POSITIVE_INFINITY;\n        if (direction === (0, $7yNYd.Direction).LEFT || direction === (0, $7yNYd.Direction).RIGHT) {\n            const preGlyph = skeleton.findNodeByCharIndex(focusOffset - 1, segmentId, segmentPage), curGlyph = skeleton.findNodeByCharIndex(focusOffset, segmentId, segmentPage);\n            focusOffset = direction === (0, $7yNYd.Direction).RIGHT ? focusOffset + curGlyph.count : focusOffset - ((_c = preGlyph == null ? void 0 : preGlyph.count) != null ? _c : 0), focusOffset = Math.min(dataStreamLength - 2, Math.max(0, focusOffset)), this._textSelectionManagerService.replaceTextRanges([\n                {\n                    startOffset: anchorOffset,\n                    endOffset: focusOffset,\n                    style: style\n                }\n            ], !1), this._scrollToFocusNodePosition(docDataModel.getUnitId(), focusOffset);\n        } else {\n            const focusGlyph = skeleton.findNodeByCharIndex(focusOffset, segmentId, segmentPage), documentOffsetConfig = docObject.document.getOffsetConfig(), focusNodePosition = collapsed ? startNodePosition : rangeDirection === (0, $7yNYd.RANGE_DIRECTION).FORWARD ? endNodePosition : startNodePosition, newPos = this._getTopOrBottomPosition(skeleton, focusGlyph, focusNodePosition, direction === (0, $7yNYd.Direction).DOWN, !0);\n            if (newPos == null) {\n                const newFocusOffset = direction === (0, $7yNYd.Direction).UP ? 0 : dataStreamLength - 2;\n                if (newFocusOffset === focusOffset) return;\n                this._textSelectionManagerService.replaceTextRanges([\n                    {\n                        startOffset: anchorOffset,\n                        endOffset: newFocusOffset,\n                        style: style\n                    }\n                ], !1);\n                return;\n            }\n            const newActiveRange = new $bb9ae9d90429a70d$export$37b489d6b2152f0f(documentOffsetConfig, skeleton).getRangePointData(newPos, newPos).cursorList[0];\n            this._textSelectionManagerService.replaceTextRanges([\n                {\n                    startOffset: anchorOffset,\n                    endOffset: newActiveRange.endOffset,\n                    style: style\n                }\n            ], !1), this._scrollToFocusNodePosition(docDataModel.getUnitId(), newActiveRange.endOffset);\n        }\n    }\n    // eslint-disable-next-line max-lines-per-function, complexity\n    _handleMoveCursor(direction) {\n        var _a28, _b, _c, _d;\n        const activeRange = this._textSelectionManagerService.getActiveTextRange(), allRanges = this._textSelectionManagerService.getCurrentTextRanges(), docDataModel = this._univerInstanceService.getCurrentUniverDocInstance();\n        if (docDataModel == null) return !1;\n        const skeleton = (_a28 = this._renderManagerService.getRenderById(docDataModel.getUnitId())) == null ? void 0 : _a28.with((0, $7AR1b.DocSkeletonManagerService)).getSkeleton(), docObject = this._getDocObject();\n        if (activeRange == null || skeleton == null || docObject == null || allRanges == null) return;\n        const { startOffset: startOffset, endOffset: endOffset, style: style, collapsed: collapsed, segmentId: segmentId, startNodePosition: startNodePosition, endNodePosition: endNodePosition, segmentPage: segmentPage } = activeRange, body = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n        if (body == null) return;\n        const dataStreamLength = (_b = body.dataStream.length) != null ? _b : Number.POSITIVE_INFINITY, customRanges = (_c = docDataModel.getCustomRanges()) != null ? _c : [];\n        if (direction === (0, $7yNYd.Direction).LEFT || direction === (0, $7yNYd.Direction).RIGHT) {\n            let cursor;\n            if (!activeRange.collapsed || allRanges.length > 1) {\n                let min = Number.POSITIVE_INFINITY, max = Number.NEGATIVE_INFINITY;\n                for (const range of allRanges)min = Math.min(min, range.startOffset), max = Math.max(max, range.endOffset);\n                cursor = direction === (0, $7yNYd.Direction).LEFT ? min : max;\n            } else {\n                const preSpan = skeleton.findNodeByCharIndex(startOffset - 1, segmentId, segmentPage), curSpan = skeleton.findNodeByCharIndex(startOffset, segmentId, segmentPage), nextGlyph = skeleton.findNodeByCharIndex(startOffset + 1, segmentId, segmentPage);\n                direction === (0, $7yNYd.Direction).LEFT ? cursor = Math.max(0, startOffset - ((_d = preSpan == null ? void 0 : preSpan.count) != null ? _d : 1)) : cursor = Math.min(dataStreamLength - 2, endOffset + curSpan.count + ((nextGlyph == null ? void 0 : nextGlyph.streamType) === (0, $7yNYd.DataStreamTreeTokenType).SECTION_BREAK ? 1 : 0));\n            }\n            const skipTokens = [\n                (0, $7yNYd.DataStreamTreeTokenType).CUSTOM_RANGE_START,\n                (0, $7yNYd.DataStreamTreeTokenType).CUSTOM_RANGE_END,\n                (0, $7yNYd.DataStreamTreeTokenType).TABLE_START,\n                (0, $7yNYd.DataStreamTreeTokenType).TABLE_END,\n                (0, $7yNYd.DataStreamTreeTokenType).TABLE_ROW_START,\n                (0, $7yNYd.DataStreamTreeTokenType).TABLE_ROW_END,\n                (0, $7yNYd.DataStreamTreeTokenType).TABLE_CELL_START,\n                (0, $7yNYd.DataStreamTreeTokenType).TABLE_CELL_END,\n                (0, $7yNYd.DataStreamTreeTokenType).SECTION_BREAK\n            ];\n            if (direction === (0, $7yNYd.Direction).LEFT) for(; skipTokens.includes(body.dataStream[cursor]);)cursor--;\n            else for(; skipTokens.includes(body.dataStream[cursor]);)cursor++;\n            customRanges.filter((range)=>range.wholeEntity && range.startIndex < cursor && range.endIndex >= cursor).forEach((range)=>{\n                direction === (0, $7yNYd.Direction).LEFT ? cursor = Math.min(range.startIndex, cursor) : cursor = Math.max(range.endIndex + 1, cursor);\n            }), this._textSelectionManagerService.replaceTextRanges([\n                {\n                    startOffset: cursor,\n                    endOffset: cursor,\n                    style: style\n                }\n            ], !1), this._scrollToFocusNodePosition(docDataModel.getUnitId(), cursor);\n        } else {\n            const startNode = skeleton.findNodeByCharIndex(startOffset, segmentId, segmentPage), endNode = skeleton.findNodeByCharIndex(endOffset, segmentId, segmentPage), documentOffsetConfig = docObject.document.getOffsetConfig(), newPos = this._getTopOrBottomPosition(skeleton, direction === (0, $7yNYd.Direction).UP || collapsed ? startNode : endNode, direction === (0, $7yNYd.Direction).UP || collapsed ? startNodePosition : endNodePosition, direction === (0, $7yNYd.Direction).DOWN);\n            if (newPos == null) {\n                let cursor;\n                collapsed ? cursor = direction === (0, $7yNYd.Direction).UP ? 0 : dataStreamLength - 2 : cursor = direction === (0, $7yNYd.Direction).UP ? startOffset : endOffset, this._textSelectionManagerService.replaceTextRanges([\n                    {\n                        startOffset: cursor,\n                        endOffset: cursor,\n                        style: style\n                    }\n                ], !1);\n                return;\n            }\n            const newActiveRange = new $bb9ae9d90429a70d$export$37b489d6b2152f0f(documentOffsetConfig, skeleton).getRangePointData(newPos, newPos).cursorList[0];\n            this._textSelectionManagerService.replaceTextRanges([\n                {\n                    ...newActiveRange,\n                    style: style\n                }\n            ], !1), this._scrollToFocusNodePosition(docDataModel.getUnitId(), newActiveRange.endOffset);\n        }\n    }\n    _getTopOrBottomPosition(docSkeleton, glyph, nodePosition, direction, skipCellContent = !1) {\n        if (glyph == null || nodePosition == null) return;\n        const offsetLeft = this._getGlyphLeftOffsetInLine(glyph), line = this._getNextOrPrevLine(glyph, direction, skipCellContent);\n        if (line == null) return;\n        const position = this._matchPositionByLeftOffset(docSkeleton, line, offsetLeft, nodePosition);\n        if (position != null) return {\n            ...position,\n            isBack: !0\n        };\n    }\n    _getGlyphLeftOffsetInLine(glyph) {\n        const divide = glyph.parent;\n        if (divide == null) return Number.NEGATIVE_INFINITY;\n        const divideLeft = divide.left, { left: left } = glyph;\n        return divideLeft + left;\n    }\n    _matchPositionByLeftOffset(docSkeleton, line, offsetLeft, nodePosition) {\n        const nearestNode = {\n            distance: Number.POSITIVE_INFINITY\n        };\n        for (const divide of line.divides){\n            const divideLeft = divide.left;\n            for (const glyph of divide.glyphGroup){\n                if (glyph.streamType === (0, $7yNYd.DataStreamTreeTokenType).SECTION_BREAK) continue;\n                const { left: left } = glyph, leftSide = divideLeft + left, distance = Math.abs(offsetLeft - leftSide);\n                distance < nearestNode.distance && (nearestNode.glyph = glyph, nearestNode.distance = distance);\n            }\n        }\n        if (nearestNode.glyph == null) return;\n        const { segmentPage: segmentPage } = nodePosition;\n        return docSkeleton.findPositionByGlyph(nearestNode.glyph, segmentPage);\n    }\n    // eslint-disable-next-line max-lines-per-function, complexity\n    _getNextOrPrevLine(glyph, direction, skipCellContent = !1) {\n        var _a28, _b, _c, _d, _e, _f, _g, _h, _i, _j, _k, _l;\n        const divide = glyph.parent, line = divide == null ? void 0 : divide.parent, column = line == null ? void 0 : line.parent, section = column == null ? void 0 : column.parent, page = section == null ? void 0 : section.parent;\n        if (divide == null || line == null || column == null || section == null || page == null) return;\n        const currentLineIndex = column.lines.indexOf(line);\n        if (currentLineIndex === -1) return;\n        let newLine;\n        if (page.type === (0, $3e0Iz.DocumentSkeletonPageType).CELL && skipCellContent) {\n            const nLine = $bb9ae9d90429a70d$var$findAboveOrBellowCellLine(page, direction);\n            if (nLine) return nLine;\n        }\n        if (direction === !0) {\n            newLine = column.lines[currentLineIndex + 1];\n            const tableAfterLine = $bb9ae9d90429a70d$var$findTableAfterLine(line, page);\n            if (tableAfterLine) {\n                const firstLine = $bb9ae9d90429a70d$var$firstLineInTable(tableAfterLine);\n                firstLine && (newLine = firstLine);\n            }\n        } else {\n            newLine = column.lines[currentLineIndex - 1];\n            const tableBeforeLine = $bb9ae9d90429a70d$var$findTableBeforeLine(line, page);\n            if (tableBeforeLine) {\n                const lastLine = $bb9ae9d90429a70d$var$lastLineInTable(tableBeforeLine);\n                lastLine && (newLine = lastLine);\n            }\n        }\n        if (newLine != null) return newLine;\n        const currentColumnIndex = section.columns.indexOf(column);\n        if (currentColumnIndex === -1) return;\n        if (direction === !0) newLine = (_a28 = section.columns[currentColumnIndex + 1]) == null ? void 0 : _a28.lines[0];\n        else {\n            const prevColumnLines = (_c = (_b = section.columns) == null ? void 0 : _b[currentColumnIndex - 1]) == null ? void 0 : _c.lines;\n            newLine = prevColumnLines == null ? void 0 : prevColumnLines[prevColumnLines.length - 1];\n        }\n        if (newLine != null) return newLine;\n        const currentSectionIndex = page.sections.indexOf(section);\n        if (currentSectionIndex === -1) return;\n        if (direction === !0) newLine = (_e = (_d = page.sections[currentSectionIndex - 1]) == null ? void 0 : _d.columns[0]) == null ? void 0 : _e.lines[0];\n        else {\n            const prevColumns = (_g = (_f = page.sections) == null ? void 0 : _f[currentSectionIndex - 1]) == null ? void 0 : _g.columns, column2 = prevColumns == null ? void 0 : prevColumns[prevColumns.length - 1], prevColumnLines = column2 == null ? void 0 : column2.lines;\n            newLine = prevColumnLines == null ? void 0 : prevColumnLines[prevColumnLines.length - 1];\n        }\n        if (newLine != null) return newLine;\n        if (page.type === (0, $3e0Iz.DocumentSkeletonPageType).CELL) return $bb9ae9d90429a70d$var$findAboveOrBellowCellLine(page, direction);\n        const skeleton = page.parent;\n        if (skeleton == null) return;\n        const currentPageIndex = skeleton.pages.indexOf(page);\n        if (currentPageIndex !== -1) {\n            if (direction === !0) newLine = (_j = (_i = (_h = skeleton.pages[currentPageIndex + 1]) == null ? void 0 : _h.sections[0]) == null ? void 0 : _i.columns[0]) == null ? void 0 : _j.lines[0];\n            else {\n                const prevSections = (_k = skeleton.pages[currentPageIndex - 1]) == null ? void 0 : _k.sections;\n                if (prevSections == null) return;\n                const prevColumns = (_l = prevSections[prevSections.length - 1]) == null ? void 0 : _l.columns, column2 = prevColumns[prevColumns.length - 1], prevColumnLines = column2 == null ? void 0 : column2.lines;\n                newLine = prevColumnLines[prevColumnLines.length - 1];\n            }\n            if (newLine != null) return newLine;\n        }\n    }\n    _scrollToFocusNodePosition(unitId, offset) {\n        var _a28;\n        const backScrollController = (_a28 = this._renderManagerService.getRenderById(unitId)) == null ? void 0 : _a28.with($bb9ae9d90429a70d$export$8eff10ad7001c373);\n        backScrollController != null && backScrollController.scrollToRange({\n            startOffset: offset,\n            endOffset: offset,\n            collapsed: !0\n        });\n    }\n    _getDocObject() {\n        return $bb9ae9d90429a70d$export$33c9206ff2745b13(this._univerInstanceService, this._renderManagerService);\n    }\n}, $bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_a12, \"DocMoveCursorController\"), $bb9ae9d90429a70d$var$_a12);\n$bb9ae9d90429a70d$var$DocMoveCursorController = $bb9ae9d90429a70d$var$__decorateClass$f([\n    (0, $7yNYd.OnLifecycle)((0, $7yNYd.LifecycleStages).Rendered, $bb9ae9d90429a70d$var$DocMoveCursorController),\n    $bb9ae9d90429a70d$var$__decorateParam$f(0, (0, $7yNYd.IUniverInstanceService)),\n    $bb9ae9d90429a70d$var$__decorateParam$f(1, (0, $3e0Iz.IRenderManagerService)),\n    $bb9ae9d90429a70d$var$__decorateParam$f(2, (0, $7yNYd.Inject)((0, $7AR1b.DocSelectionManagerService))),\n    $bb9ae9d90429a70d$var$__decorateParam$f(3, (0, $7yNYd.ICommandService))\n], $bb9ae9d90429a70d$var$DocMoveCursorController);\nfunction $bb9ae9d90429a70d$var$findAboveOrBellowCellLine(page, direction) {\n    var _a28, _b;\n    let newLine = null;\n    if (direction === !0) {\n        const bellowCell = $bb9ae9d90429a70d$var$findBellowCell(page);\n        if (bellowCell) newLine = $bb9ae9d90429a70d$var$firstLineInCell(bellowCell);\n        else {\n            const table = (_a28 = page.parent) == null ? void 0 : _a28.parent, { lineAfterTable: lineAfterTable } = $bb9ae9d90429a70d$var$findLineBeforeAndAfterTable(table);\n            lineAfterTable && (newLine = lineAfterTable);\n        }\n    } else {\n        const aboveCell = $bb9ae9d90429a70d$var$findAboveCell(page);\n        if (aboveCell) newLine = $bb9ae9d90429a70d$var$lastLineInCell(aboveCell);\n        else {\n            const table = (_b = page.parent) == null ? void 0 : _b.parent, { lineBeforeTable: lineBeforeTable } = $bb9ae9d90429a70d$var$findLineBeforeAndAfterTable(table);\n            lineBeforeTable && (newLine = lineBeforeTable);\n        }\n    }\n    return newLine, newLine;\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$findAboveOrBellowCellLine, \"findAboveOrBellowCellLine\");\nconst $bb9ae9d90429a70d$var$create = \"univer-create\", $bb9ae9d90429a70d$var$createItem = \"univer-create-item\", $bb9ae9d90429a70d$var$createLabel = \"univer-create-label\", $bb9ae9d90429a70d$var$createInput = \"univer-create-input\", $bb9ae9d90429a70d$var$styles = {\n    create: $bb9ae9d90429a70d$var$create,\n    createItem: $bb9ae9d90429a70d$var$createItem,\n    createLabel: $bb9ae9d90429a70d$var$createLabel,\n    createInput: $bb9ae9d90429a70d$var$createInput\n}, $bb9ae9d90429a70d$var$DocCreateTableConfirm = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(({ handleRowColChange: handleRowColChange, tableCreateParams: tableCreateParams })=>{\n    const localeService = (0, $7yNYd.useDependency)((0, $7yNYd.LocaleService)), [rowCount, setRowCount] = (0, $5gqvu.useState)(3), [colCount, setColCount] = (0, $5gqvu.useState)(5);\n    function handleInputChange(rowCount2, colCount2) {\n        setRowCount(rowCount2), setColCount(colCount2), handleRowColChange(rowCount2, colCount2);\n    }\n    return $bb9ae9d90429a70d$var$__name(handleInputChange, \"handleInputChange\"), (0, $5gqvu.useEffect)(()=>{\n        setRowCount(tableCreateParams.rowCount), setColCount(tableCreateParams.colCount);\n    }, [\n        tableCreateParams\n    ]), /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsxs(\"div\", {\n        className: $bb9ae9d90429a70d$var$styles.create,\n        children: [\n            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsxs(\"div\", {\n                className: $bb9ae9d90429a70d$var$styles.createItem,\n                children: [\n                    /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx(\"span\", {\n                        className: $bb9ae9d90429a70d$var$styles.createLabel,\n                        children: localeService.t(\"toolbar.table.rowCount\")\n                    }),\n                    /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx((0, $1UDbf.InputNumber), {\n                        min: 1,\n                        max: 20,\n                        precision: 0,\n                        value: rowCount,\n                        onChange: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((val)=>{\n                            handleInputChange(val, colCount);\n                        }, \"onChange\"),\n                        className: $bb9ae9d90429a70d$var$styles.createInput\n                    })\n                ]\n            }),\n            /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsxs(\"div\", {\n                className: $bb9ae9d90429a70d$var$styles.createItem,\n                children: [\n                    /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx(\"span\", {\n                        className: $bb9ae9d90429a70d$var$styles.createLabel,\n                        children: localeService.t(\"toolbar.table.colCount\")\n                    }),\n                    /* @__PURE__ */ $bb9ae9d90429a70d$var$jsxRuntimeExports.jsx((0, $1UDbf.InputNumber), {\n                        min: 1,\n                        max: 20,\n                        precision: 0,\n                        value: colCount,\n                        onChange: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((val)=>{\n                            handleInputChange(rowCount, val);\n                        }, \"onChange\"),\n                        className: $bb9ae9d90429a70d$var$styles.createInput\n                    })\n                ]\n            })\n        ]\n    });\n}, \"DocCreateTableConfirm\");\nvar $bb9ae9d90429a70d$var$__defProp$e = Object.defineProperty, $bb9ae9d90429a70d$var$__getOwnPropDesc$e = Object.getOwnPropertyDescriptor, $bb9ae9d90429a70d$var$__decorateClass$e = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((decorators, target, key, kind)=>{\n    for(var result = kind > 1 ? void 0 : kind ? $bb9ae9d90429a70d$var$__getOwnPropDesc$e(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)(decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n    return kind && result && $bb9ae9d90429a70d$var$__defProp$e(target, key, result), result;\n}, \"__decorateClass$e\"), $bb9ae9d90429a70d$var$__decorateParam$e = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((index, decorator)=>(target, key)=>decorator(target, key, index), \"__decorateParam$e\"), $bb9ae9d90429a70d$var$_a13;\nlet $bb9ae9d90429a70d$var$DocTableController = ($bb9ae9d90429a70d$var$_a13 = class extends (0, $7yNYd.Disposable) {\n    constructor(_commandService, _componentManager){\n        super(), this._commandService = _commandService, this._componentManager = _componentManager, this._initialize();\n    }\n    _initialize() {\n        this._init(), this._registerCommands(), this._initCustomComponents();\n    }\n    _registerCommands() {\n        [\n            $bb9ae9d90429a70d$export$1e0acf08c78e9a29\n        ].forEach((command)=>this.disposeWithMe(this._commandService.registerCommand(command)));\n    }\n    _initCustomComponents() {\n        const componentManager = this._componentManager;\n        this.disposeWithMe(componentManager.register($bb9ae9d90429a70d$var$COMPONENT_DOC_CREATE_TABLE_CONFIRM, $bb9ae9d90429a70d$var$DocCreateTableConfirm));\n    }\n    _init() {}\n}, $bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_a13, \"DocTableController\"), $bb9ae9d90429a70d$var$_a13);\n$bb9ae9d90429a70d$var$DocTableController = $bb9ae9d90429a70d$var$__decorateClass$e([\n    (0, $7yNYd.OnLifecycle)((0, $7yNYd.LifecycleStages).Rendered, $bb9ae9d90429a70d$var$DocTableController),\n    $bb9ae9d90429a70d$var$__decorateParam$e(0, (0, $7yNYd.ICommandService)),\n    $bb9ae9d90429a70d$var$__decorateParam$e(1, (0, $7yNYd.Inject)((0, $fL2Ug.ComponentManager)))\n], $bb9ae9d90429a70d$var$DocTableController);\nconst $bb9ae9d90429a70d$export$923355e3fc8db131 = 4;\nvar $bb9ae9d90429a70d$var$__defProp$d = Object.defineProperty, $bb9ae9d90429a70d$var$__getOwnPropDesc$d = Object.getOwnPropertyDescriptor, $bb9ae9d90429a70d$var$__decorateClass$d = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((decorators, target, key, kind)=>{\n    for(var result = kind > 1 ? void 0 : kind ? $bb9ae9d90429a70d$var$__getOwnPropDesc$d(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)(decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n    return kind && result && $bb9ae9d90429a70d$var$__defProp$d(target, key, result), result;\n}, \"__decorateClass$d\"), $bb9ae9d90429a70d$var$__decorateParam$d = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((index, decorator)=>(target, key)=>decorator(target, key, index), \"__decorateParam$d\");\nfunction $bb9ae9d90429a70d$var$transformBound2OffsetBound(originBound, scene) {\n    const topLeft = $bb9ae9d90429a70d$var$transformPosition2Offset(originBound.left, originBound.top, scene), bottomRight = $bb9ae9d90429a70d$var$transformPosition2Offset(originBound.right, originBound.bottom, scene);\n    return {\n        left: topLeft.x,\n        top: topLeft.y,\n        right: bottomRight.x,\n        bottom: bottomRight.y\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$transformBound2OffsetBound, \"transformBound2OffsetBound\");\nfunction $bb9ae9d90429a70d$var$transformPosition2Offset(x, y, scene) {\n    const { scaleX: scaleX, scaleY: scaleY } = scene.getAncestorScale(), viewMain = scene.getViewport($bb9ae9d90429a70d$export$691aac3130b48bd9.VIEW_MAIN);\n    if (!viewMain) return {\n        x: x,\n        y: y\n    };\n    const { viewportScrollX: actualScrollX, viewportScrollY: actualScrollY } = viewMain, offsetX = (x - actualScrollX) * scaleX, offsetY = (y - actualScrollY) * scaleY;\n    return {\n        x: offsetX,\n        y: offsetY\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$transformPosition2Offset, \"transformPosition2Offset\");\nfunction $bb9ae9d90429a70d$var$transformOffset2Bound(offsetX, offsetY, scene) {\n    const { scaleX: scaleX, scaleY: scaleY } = scene.getAncestorScale(), viewMain = scene.getViewport($bb9ae9d90429a70d$export$691aac3130b48bd9.VIEW_MAIN);\n    if (!viewMain) return {\n        x: offsetX,\n        y: offsetY\n    };\n    const { viewportScrollX: actualScrollX, viewportScrollY: actualScrollY } = viewMain, x = offsetX / scaleX + actualScrollX, y = offsetY / scaleY + actualScrollY;\n    return {\n        x: x,\n        y: y\n    };\n}\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$transformOffset2Bound, \"transformOffset2Bound\");\nconst $bb9ae9d90429a70d$var$calcDocRangePositions$1 = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((range, currentRender)=>{\n    const { scene: scene, mainComponent: mainComponent, engine: engine } = currentRender, skeleton = currentRender.with((0, $7AR1b.DocSkeletonManagerService)).getSkeleton(), startPosition = skeleton.findNodePositionByCharIndex(range.startOffset, !1, range.segmentId, range.segmentPage), endPosition = skeleton.findNodePositionByCharIndex(range.endOffset, !1, range.segmentId, range.segmentPage), document2 = mainComponent;\n    if (!endPosition || !startPosition) return;\n    const documentOffsetConfig = document2.getOffsetConfig(), { docsLeft: docsLeft, docsTop: docsTop } = documentOffsetConfig, canvasElement = engine.getCanvasElement(), canvasClientRect = canvasElement.getBoundingClientRect(), widthOfCanvas = (0, $3e0Iz.pxToNum)(canvasElement.style.width), { top: top, left: left, width: width } = canvasClientRect, scaleAdjust = width / widthOfCanvas, { scaleX: scaleX, scaleY: scaleY } = scene.getAncestorScale(), convertor = new $bb9ae9d90429a70d$export$37b489d6b2152f0f(documentOffsetConfig, skeleton), { borderBoxPointGroup: borderBoxPointGroup } = convertor.getRangePointData(startPosition, endPosition);\n    return $bb9ae9d90429a70d$export$18c799e465d2606c(borderBoxPointGroup).map((bound)=>$bb9ae9d90429a70d$var$transformBound2OffsetBound(bound, scene)).map((i)=>({\n            left: (i.left + docsLeft * scaleX) * scaleAdjust + left,\n            right: (i.right + docsLeft * scaleX) * scaleAdjust + left,\n            top: (i.top + docsTop * scaleY) * scaleAdjust + top,\n            bottom: (i.bottom + docsTop * scaleY) * scaleAdjust + top\n        }));\n}, \"calcDocRangePositions$1\");\nvar $bb9ae9d90429a70d$var$_a14;\nlet $bb9ae9d90429a70d$export$928598871e94e5df = ($bb9ae9d90429a70d$var$_a14 = class extends (0, $7yNYd.Disposable) {\n    constructor(_globalPopupManagerService, _renderManagerService, _univerInstanceService, _commandService){\n        super(), this._globalPopupManagerService = _globalPopupManagerService, this._renderManagerService = _renderManagerService, this._univerInstanceService = _univerInstanceService, this._commandService = _commandService;\n    }\n    _createObjectPositionObserver(targetObject, currentRender) {\n        const calc = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(()=>{\n            const { scene: scene, engine: engine } = currentRender, { left: left, top: top, width: width, height: height } = targetObject, bound = {\n                left: left,\n                right: left + width,\n                top: top,\n                bottom: top + height\n            }, canvasElement = engine.getCanvasElement(), canvasClientRect = canvasElement.getBoundingClientRect(), widthOfCanvas = (0, $3e0Iz.pxToNum)(canvasElement.style.width), offsetBound = $bb9ae9d90429a70d$var$transformBound2OffsetBound(bound, scene), { top: topOffset, left: leftOffset, width: domWidth } = canvasClientRect, scaleAdjust = domWidth / widthOfCanvas;\n            return {\n                left: offsetBound.left * scaleAdjust + leftOffset,\n                right: offsetBound.right * scaleAdjust + leftOffset,\n                top: offsetBound.top * scaleAdjust + topOffset,\n                bottom: offsetBound.bottom * scaleAdjust + topOffset\n            };\n        }, \"calc\"), position = calc(), position$ = new (0, $5LPkb.BehaviorSubject)(position), disposable = new (0, $7yNYd.DisposableCollection)();\n        disposable.add(this._commandService.onCommandExecuted((commandInfo)=>{\n            commandInfo.id === $bb9ae9d90429a70d$export$324478118aea2b96.id && position$.next(calc());\n        }));\n        const viewMain = currentRender.scene.getViewport($bb9ae9d90429a70d$export$691aac3130b48bd9.VIEW_MAIN);\n        return viewMain && disposable.add(viewMain.onScrollAfter$.subscribeEvent(()=>{\n            position$.next(calc());\n        })), {\n            position: position,\n            position$: position$,\n            disposable: disposable\n        };\n    }\n    _createRangePositionObserver(range, currentRender) {\n        var _a28;\n        const positions = (_a28 = $bb9ae9d90429a70d$var$calcDocRangePositions$1(range, currentRender)) != null ? _a28 : [], positions$ = new (0, $5LPkb.BehaviorSubject)(positions), disposable = new (0, $7yNYd.DisposableCollection)();\n        disposable.add(this._commandService.onCommandExecuted((commandInfo)=>{\n            if (commandInfo.id === $bb9ae9d90429a70d$export$324478118aea2b96.id) {\n                const position = $bb9ae9d90429a70d$var$calcDocRangePositions$1(range, currentRender);\n                position && positions$.next(position);\n            }\n        }));\n        const viewMain = currentRender.scene.getViewport($bb9ae9d90429a70d$export$691aac3130b48bd9.VIEW_MAIN);\n        return viewMain && disposable.add(viewMain.onScrollAfter$.subscribeEvent(()=>{\n            const position = $bb9ae9d90429a70d$var$calcDocRangePositions$1(range, currentRender);\n            position && positions$.next(position);\n        })), {\n            positions: positions,\n            positions$: positions$,\n            disposable: disposable\n        };\n    }\n    // #region attach to object\n    /**\n   * attach a popup to canvas object\n   * @param targetObject target canvas object\n   * @param popup popup item\n   * @returns disposable\n   */ attachPopupToObject(targetObject, popup, unitId) {\n        const currentRender = this._renderManagerService.getRenderById(unitId);\n        if (!currentRender) throw new Error(`Current render not found, unitId: ${unitId}`);\n        const { position: position, position$: position$, disposable: disposable } = this._createObjectPositionObserver(targetObject, currentRender), id = this._globalPopupManagerService.addPopup({\n            ...popup,\n            unitId: unitId,\n            subUnitId: \"default\",\n            anchorRect: position,\n            anchorRect$: position$,\n            canvasElement: currentRender.engine.getCanvasElement()\n        });\n        return {\n            dispose: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(()=>{\n                this._globalPopupManagerService.removePopup(id), position$.complete(), disposable.dispose();\n            }, \"dispose\")\n        };\n    }\n    // #endregion\n    // #region attach to range\n    /**\n   * attach a popup to doc range\n   * @param range doc range\n   * @param popup popup item\n   * @param unitId unit id\n   * @returns disposable\n   */ attachPopupToRange(range, popup, unitId) {\n        if (!this._univerInstanceService.getUnit(unitId)) throw new Error(`Document not found, unitId: ${unitId}`);\n        const { direction: direction = \"top\", multipleDirection: multipleDirection } = popup, currentRender = this._renderManagerService.getRenderById(unitId);\n        if (!currentRender) throw new Error(`Current render not found, unitId: ${unitId}`);\n        const { positions: bounds, positions$: bounds$, disposable: disposable } = this._createRangePositionObserver(range, currentRender), position$ = bounds$.pipe((0, $hciHF.map)((bounds2)=>direction.includes(\"top\") ? bounds2[0] : bounds2[bounds2.length - 1])), id = this._globalPopupManagerService.addPopup({\n            ...popup,\n            unitId: unitId,\n            subUnitId: \"default\",\n            anchorRect: direction.includes(\"top\") ? bounds[0] : bounds[bounds.length - 1],\n            anchorRect$: position$,\n            excludeRects: bounds,\n            excludeRects$: bounds$,\n            direction: direction.includes(\"top\") || direction.includes(\"bottom\") ? bounds.length > 1 ? multipleDirection : direction : \"bottom\",\n            canvasElement: currentRender.engine.getCanvasElement()\n        });\n        return {\n            dispose: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(()=>{\n                this._globalPopupManagerService.removePopup(id), bounds$.complete(), disposable.dispose();\n            }, \"dispose\"),\n            canDispose: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name(()=>this._globalPopupManagerService.activePopupId !== id, \"canDispose\")\n        };\n    }\n}, $bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_a14, \"DocCanvasPopManagerService\"), $bb9ae9d90429a70d$var$_a14);\n$bb9ae9d90429a70d$export$928598871e94e5df = $bb9ae9d90429a70d$var$__decorateClass$d([\n    $bb9ae9d90429a70d$var$__decorateParam$d(0, (0, $7yNYd.Inject)((0, $fL2Ug.ICanvasPopupService))),\n    $bb9ae9d90429a70d$var$__decorateParam$d(1, (0, $3e0Iz.IRenderManagerService)),\n    $bb9ae9d90429a70d$var$__decorateParam$d(2, (0, $7yNYd.IUniverInstanceService)),\n    $bb9ae9d90429a70d$var$__decorateParam$d(3, (0, $7yNYd.ICommandService))\n], $bb9ae9d90429a70d$export$928598871e94e5df);\nvar $bb9ae9d90429a70d$var$__defProp$c = Object.defineProperty, $bb9ae9d90429a70d$var$__getOwnPropDesc$c = Object.getOwnPropertyDescriptor, $bb9ae9d90429a70d$var$__decorateClass$c = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((decorators, target, key, kind)=>{\n    for(var result = kind > 1 ? void 0 : kind ? $bb9ae9d90429a70d$var$__getOwnPropDesc$c(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)(decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n    return kind && result && $bb9ae9d90429a70d$var$__defProp$c(target, key, result), result;\n}, \"__decorateClass$c\"), $bb9ae9d90429a70d$var$__decorateParam$c = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((index, decorator)=>(target, key)=>decorator(target, key, index), \"__decorateParam$c\");\nconst $bb9ae9d90429a70d$var$calcDocRangePositions = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((range, documents, skeleton, pageIndex)=>{\n    var _a28, _b, _c, _d, _e;\n    const startPosition = skeleton.findNodePositionByCharIndex(range.startOffset, !1, range.segmentId, pageIndex), skeletonData = skeleton.getSkeletonData();\n    let end = range.endOffset;\n    if (range.segmentId) {\n        const root = (_e = Array.from((_b = (_a28 = skeletonData == null ? void 0 : skeletonData.skeFooters.get(range.segmentId)) == null ? void 0 : _a28.values()) != null ? _b : [])[0]) != null ? _e : Array.from((_d = (_c = skeletonData == null ? void 0 : skeletonData.skeHeaders.get(range.segmentId)) == null ? void 0 : _c.values()) != null ? _d : [])[0];\n        root && (end = Math.min(root.ed, end));\n    }\n    const endPosition = skeleton.findNodePositionByCharIndex(end, !1, range.segmentId, pageIndex);\n    if (!endPosition || !startPosition) return;\n    const documentOffsetConfig = documents.getOffsetConfig(), convertor = new $bb9ae9d90429a70d$export$37b489d6b2152f0f(documentOffsetConfig, skeleton), { borderBoxPointGroup: borderBoxPointGroup } = convertor.getRangePointData(startPosition, endPosition);\n    return $bb9ae9d90429a70d$export$18c799e465d2606c(borderBoxPointGroup).map((rect)=>({\n            top: rect.top + documentOffsetConfig.docsTop - $bb9ae9d90429a70d$export$923355e3fc8db131,\n            bottom: rect.bottom + documentOffsetConfig.docsTop + $bb9ae9d90429a70d$export$923355e3fc8db131,\n            left: rect.left + documentOffsetConfig.docsLeft,\n            right: rect.right + documentOffsetConfig.docsLeft\n        }));\n}, \"calcDocRangePositions\"), $bb9ae9d90429a70d$var$calcDocGlyphPosition = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((glyph, documents, skeleton, pageIndex = -1)=>{\n    const start = skeleton.findPositionByGlyph(glyph, pageIndex);\n    if (!start) return;\n    const documentOffsetConfig = documents.getOffsetConfig(), startPosition = {\n        ...start,\n        isBack: !0\n    }, convertor = new $bb9ae9d90429a70d$export$37b489d6b2152f0f(documentOffsetConfig, skeleton), { borderBoxPointGroup: borderBoxPointGroup } = convertor.getRangePointData(startPosition, startPosition), rect = $bb9ae9d90429a70d$export$18c799e465d2606c(borderBoxPointGroup)[0];\n    return {\n        top: rect.top + documentOffsetConfig.docsTop,\n        bottom: rect.bottom + documentOffsetConfig.docsTop,\n        left: rect.left + documentOffsetConfig.docsLeft,\n        right: rect.left + documentOffsetConfig.docsLeft + glyph.width\n    };\n}, \"calcDocGlyphPosition\");\nvar $bb9ae9d90429a70d$var$_a15;\nlet $bb9ae9d90429a70d$export$1e5a6f8f312f65d4 = ($bb9ae9d90429a70d$var$_a15 = class extends (0, $7yNYd.Disposable) {\n    constructor(_context, _docSkeletonManagerService){\n        super();\n        $bb9ae9d90429a70d$var$__publicField(this, \"_hoverCustomRanges$\", new (0, $5LPkb.BehaviorSubject)([]));\n        $bb9ae9d90429a70d$var$__publicField(this, \"hoverCustomRanges$\", this._hoverCustomRanges$.pipe((0, $arCqp.distinctUntilChanged)((pre, aft)=>pre.length === aft.length && pre.every((item, i)=>aft[i].range.rangeId === item.range.rangeId && aft[i].segmentId === item.segmentId && aft[i].segmentPageIndex === item.segmentPageIndex))));\n        $bb9ae9d90429a70d$var$__publicField(this, \"_clickCustomRanges$\", new (0, $1mjSk.Subject)());\n        $bb9ae9d90429a70d$var$__publicField(this, \"clickCustomRanges$\", this._clickCustomRanges$.asObservable());\n        $bb9ae9d90429a70d$var$__publicField(this, \"_hoverBullet$\", new (0, $1mjSk.Subject)());\n        $bb9ae9d90429a70d$var$__publicField(this, \"hoverBullet$\", this._hoverBullet$.pipe((0, $arCqp.distinctUntilChanged)((pre, aft)=>(pre == null ? void 0 : pre.paragraph.startIndex) === (aft == null ? void 0 : aft.paragraph.startIndex) && (pre == null ? void 0 : pre.segmentId) === (aft == null ? void 0 : aft.segmentId) && (pre == null ? void 0 : pre.segmentPageIndex) === (aft == null ? void 0 : aft.segmentPageIndex))));\n        $bb9ae9d90429a70d$var$__publicField(this, \"_clickBullet$\", new (0, $1mjSk.Subject)());\n        $bb9ae9d90429a70d$var$__publicField(this, \"clickBullets$\", this._clickBullet$.asObservable());\n        $bb9ae9d90429a70d$var$__publicField(this, \"_customRangeDirty\", !0);\n        $bb9ae9d90429a70d$var$__publicField(this, \"_bulletDirty\", !0);\n        /**\n     * cache the bounding of custom ranges,\n     * it will be updated when the doc-skeleton is recalculated\n     */ $bb9ae9d90429a70d$var$__publicField(this, \"_customRangeBounds\", []);\n        /**\n     * cache the bounding of bullets,\n     * it will be updated when the doc-skeleton is recalculated\n     */ $bb9ae9d90429a70d$var$__publicField(this, \"_bulletBounds\", []);\n        this._context = _context, this._docSkeletonManagerService = _docSkeletonManagerService, this._initResetDirty(), this._initEvents(), this._initPointer();\n    }\n    get _skeleton() {\n        return this._docSkeletonManagerService.getSkeleton();\n    }\n    get _documents() {\n        return this._context.mainComponent;\n    }\n    dispose() {\n        this._hoverCustomRanges$.complete(), this._clickCustomRanges$.complete(), super.dispose();\n    }\n    _initPointer() {\n        let preCursor = (0, $3e0Iz.CURSOR_TYPE).TEXT;\n        this.disposeWithMe(this.hoverCustomRanges$.subscribe((ranges)=>{\n            ranges.length ? (preCursor = this._context.scene.getCursor(), this._context.scene.setCursor((0, $3e0Iz.CURSOR_TYPE).POINTER)) : this._context.scene.setCursor(preCursor);\n        }));\n    }\n    _initResetDirty() {\n        this.disposeWithMe(this._skeleton.dirty$.subscribe(()=>{\n            this._customRangeDirty = !0, this._bulletDirty = !0;\n        })), this.disposeWithMe((0, $7yNYd.fromEventSubject)(this._context.engine.onTransformChange$).pipe((0, $lMvMU.filter)((evt)=>evt.type === (0, $3e0Iz.TRANSFORM_CHANGE_OBSERVABLE_TYPE).resize)).subscribe(()=>{\n            this._customRangeDirty = !0, this._bulletDirty = !0;\n        }));\n    }\n    _initEvents() {\n        this.disposeWithMe((0, $7yNYd.fromEventSubject)(this._context.scene.onPointerMove$).pipe((0, $gv2K9.throttleTime)(30)).subscribe((evt)=>{\n            this._hoverCustomRanges$.next(this._calcActiveRanges(evt)), this._hoverBullet$.next(this._calcActiveBullet(evt));\n        })), this.disposeWithMe(this._context.scene.onPointerEnter$.subscribeEvent(()=>{\n            this._hoverBullet$.next(null), this._hoverCustomRanges$.next([]);\n        }));\n        const onPointerDown$ = (0, $7yNYd.fromEventSubject)(this._context.mainComponent.onPointerDown$), onPointerUp$ = (0, $7yNYd.fromEventSubject)(this._context.scene.onPointerUp$);\n        this.disposeWithMe(onPointerDown$.pipe((0, $97m73.mergeMap)((down)=>onPointerUp$.pipe((0, $9z4na.take)(1), (0, $hciHF.map)((up)=>({\n                    down: down,\n                    up: up\n                })))), (0, $lMvMU.filter)(({ down: down, up: up })=>down.target === up.target && up.timeStamp - down.timeStamp < 300)).subscribe(({ down: down })=>{\n            if (down.button === 2) return;\n            const ranges = this._calcActiveRanges(down);\n            ranges.length && this._clickCustomRanges$.next(ranges.pop());\n            const bullet = this._calcActiveBullet(down);\n            bullet && this._clickBullet$.next(bullet);\n        }));\n    }\n    _buildCustomRangeBoundsBySegment(segmentId, segmentPage = -1) {\n        var _a28, _b, _c;\n        const customRanges = (_c = (_b = (_a28 = this._context.unit.getSelfOrHeaderFooterModel(segmentId)) == null ? void 0 : _a28.getBody()) == null ? void 0 : _b.customRanges) != null ? _c : [], layouts = [];\n        return customRanges.forEach((range)=>{\n            const textRange = {\n                startOffset: range.startIndex,\n                endOffset: range.endIndex,\n                collapsed: !1,\n                segmentId: segmentId\n            }, rects = $bb9ae9d90429a70d$var$calcDocRangePositions(textRange, this._documents, this._skeleton, segmentPage);\n            if (!rects) return null;\n            layouts.push({\n                customRange: range,\n                rects: rects,\n                segmentId: segmentId,\n                segmentPageIndex: segmentPage\n            });\n        }), layouts;\n    }\n    _buildCustomRangeBounds() {\n        var _a28;\n        if (!this._customRangeDirty) return;\n        this._customRangeDirty = !1;\n        const customRangeBounds = [];\n        customRangeBounds.push(...this._buildCustomRangeBoundsBySegment()), (_a28 = this._skeleton.getSkeletonData()) == null || _a28.pages.forEach((page, pageIndex)=>{\n            page.headerId && customRangeBounds.push(...this._buildCustomRangeBoundsBySegment(page.headerId, pageIndex)), page.footerId && customRangeBounds.push(...this._buildCustomRangeBoundsBySegment(page.footerId, pageIndex));\n        }), this._customRangeBounds = customRangeBounds;\n    }\n    _calcActiveRanges(evt) {\n        this._buildCustomRangeBounds();\n        const { offsetX: offsetX, offsetY: offsetY } = evt, { x: x, y: y } = $bb9ae9d90429a70d$var$transformOffset2Bound(offsetX, offsetY, this._context.scene);\n        return this._customRangeBounds.filter((layout)=>layout.rects.some((rect)=>{\n                const { left: left, right: right, top: top, bottom: bottom } = rect;\n                return x >= left && x <= right && y >= top && y <= bottom;\n            })).map((range)=>({\n                segmentId: range.segmentId,\n                range: range.customRange,\n                segmentPageIndex: range.segmentPageIndex,\n                rects: range.rects\n            }));\n    }\n    _buildBulletBoundsBySegment(segmentId, segmentPage = -1) {\n        var _a28, _b, _c, _d, _e;\n        const body = (_a28 = this._context.unit.getSelfOrHeaderFooterModel(segmentId)) == null ? void 0 : _a28.getBody(), paragraphs = ((_b = body == null ? void 0 : body.paragraphs) != null ? _b : []).filter((p2)=>p2.bullet && p2.bullet.listType.indexOf(\"CHECK_LIST\") === 0), bounds = [], skeletonData = this._skeleton.getSkeletonData();\n        if (!skeletonData) return bounds;\n        const calc = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((pages)=>{\n            var _a29, _b2, _c2;\n            for (const page of pages){\n                const sections = [\n                    ...page.sections\n                ];\n                if (page.skeTables) {\n                    const tables = Array.from(page.skeTables.values());\n                    sections.push(...tables.map((i)=>i.rows.map((i2)=>i2.cells.map((i3)=>i3.sections))).flat(4));\n                }\n                for (const selection of sections)for (const column of selection.columns)for (const line of column.lines)if (line.paragraphStart) {\n                    const paragraph = paragraphs.find((p2)=>p2.startIndex === line.paragraphIndex);\n                    if (paragraph) {\n                        const targetLine = line, bulletNode = (_c2 = (_b2 = (_a29 = targetLine == null ? void 0 : targetLine.divides) == null ? void 0 : _a29[0]) == null ? void 0 : _b2.glyphGroup) == null ? void 0 : _c2[0];\n                        if (!bulletNode) continue;\n                        const rect = $bb9ae9d90429a70d$var$calcDocGlyphPosition(bulletNode, this._documents, this._skeleton, segmentPage);\n                        if (!rect) continue;\n                        bounds.push({\n                            rect: rect,\n                            segmentId: segmentId,\n                            segmentPageIndex: segmentPage,\n                            paragraph: paragraph\n                        });\n                    }\n                }\n            }\n            return bounds;\n        }, \"calc\");\n        if (segmentId) {\n            const page = (_e = (_c = skeletonData.skeFooters.get(segmentId)) == null ? void 0 : _c.values()) != null ? _e : (_d = skeletonData.skeHeaders.get(segmentId)) == null ? void 0 : _d.values();\n            return page ? calc(Array.from(page)) : bounds;\n        }\n        return calc(skeletonData.pages);\n    }\n    _buildBulletBounds() {\n        var _a28;\n        this._bulletDirty && (this._bulletDirty = !1, this._bulletBounds = [], this._bulletBounds.push(...this._buildBulletBoundsBySegment()), (_a28 = this._skeleton.getSkeletonData()) == null || _a28.pages.forEach((page, pageIndex)=>{\n            page.headerId && this._bulletBounds.push(...this._buildBulletBoundsBySegment(page.headerId, pageIndex)), page.footerId && this._bulletBounds.push(...this._buildBulletBoundsBySegment(page.footerId, pageIndex));\n        }));\n    }\n    _calcActiveBullet(evt) {\n        this._buildBulletBounds();\n        const { offsetX: offsetX, offsetY: offsetY } = evt, { x: x, y: y } = $bb9ae9d90429a70d$var$transformOffset2Bound(offsetX, offsetY, this._context.scene);\n        return this._bulletBounds.find((layout)=>{\n            const { left: left, right: right, top: top, bottom: bottom } = layout.rect;\n            return x >= left && x <= right && y >= top && y <= bottom;\n        });\n    }\n}, $bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_a15, \"DocEventManagerService\"), $bb9ae9d90429a70d$var$_a15);\n$bb9ae9d90429a70d$export$1e5a6f8f312f65d4 = $bb9ae9d90429a70d$var$__decorateClass$c([\n    $bb9ae9d90429a70d$var$__decorateParam$c(1, (0, $7yNYd.Inject)((0, $7AR1b.DocSkeletonManagerService)))\n], $bb9ae9d90429a70d$export$1e5a6f8f312f65d4);\nvar $bb9ae9d90429a70d$var$__defProp$b = Object.defineProperty, $bb9ae9d90429a70d$var$__getOwnPropDesc$b = Object.getOwnPropertyDescriptor, $bb9ae9d90429a70d$var$__decorateClass$b = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((decorators, target, key, kind)=>{\n    for(var result = kind > 1 ? void 0 : kind ? $bb9ae9d90429a70d$var$__getOwnPropDesc$b(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)(decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n    return kind && result && $bb9ae9d90429a70d$var$__defProp$b(target, key, result), result;\n}, \"__decorateClass$b\"), $bb9ae9d90429a70d$var$__decorateParam$b = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((index, decorator)=>(target, key)=>decorator(target, key, index), \"__decorateParam$b\"), $bb9ae9d90429a70d$var$_a16;\nlet $bb9ae9d90429a70d$var$DocChecklistRenderController = ($bb9ae9d90429a70d$var$_a16 = class extends (0, $7yNYd.Disposable) {\n    constructor(_context, _docSkeletonManagerService, _commandService, _docEventManagerService, _textSelectionManagerService){\n        super(), this._context = _context, this._docSkeletonManagerService = _docSkeletonManagerService, this._commandService = _commandService, this._docEventManagerService = _docEventManagerService, this._textSelectionManagerService = _textSelectionManagerService, this._initPointerDownObserver(), this._initHoverCursor();\n    }\n    _initPointerDownObserver() {\n        this._docEventManagerService.clickBullets$.subscribe((paragraph)=>{\n            this._commandService.executeCommand($bb9ae9d90429a70d$export$29ccf42ee2e09c85.id, {\n                index: paragraph.paragraph.startIndex,\n                segmentId: paragraph.segmentId\n            });\n        });\n    }\n    _initHoverCursor() {\n        this.disposeWithMe(this._docEventManagerService.hoverBullet$.subscribe((paragraph)=>{\n            paragraph ? this._context.mainComponent.setCursor((0, $3e0Iz.CURSOR_TYPE).POINTER) : this._context.mainComponent.setCursor((0, $3e0Iz.CURSOR_TYPE).TEXT);\n        }));\n    }\n    _getTransformCoordForDocumentOffset(document2, viewport, evtOffsetX, evtOffsetY) {\n        const { documentTransform: documentTransform } = document2.getOffsetConfig(), originCoord = viewport.transformVector2SceneCoord((0, $3e0Iz.Vector2).FromArray([\n            evtOffsetX,\n            evtOffsetY\n        ]));\n        if (originCoord) return documentTransform.clone().invert().applyPoint(originCoord);\n    }\n}, $bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_a16, \"DocChecklistRenderController\"), $bb9ae9d90429a70d$var$_a16);\n$bb9ae9d90429a70d$var$DocChecklistRenderController = $bb9ae9d90429a70d$var$__decorateClass$b([\n    $bb9ae9d90429a70d$var$__decorateParam$b(1, (0, $7yNYd.Inject)((0, $7AR1b.DocSkeletonManagerService))),\n    $bb9ae9d90429a70d$var$__decorateParam$b(2, (0, $7yNYd.ICommandService)),\n    $bb9ae9d90429a70d$var$__decorateParam$b(3, (0, $7yNYd.Inject)($bb9ae9d90429a70d$export$1e5a6f8f312f65d4)),\n    $bb9ae9d90429a70d$var$__decorateParam$b(4, (0, $7yNYd.Inject)((0, $7AR1b.DocSelectionManagerService)))\n], $bb9ae9d90429a70d$var$DocChecklistRenderController);\nvar $bb9ae9d90429a70d$var$__defProp$a = Object.defineProperty, $bb9ae9d90429a70d$var$__getOwnPropDesc$a = Object.getOwnPropertyDescriptor, $bb9ae9d90429a70d$var$__decorateClass$a = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((decorators, target, key, kind)=>{\n    for(var result = kind > 1 ? void 0 : kind ? $bb9ae9d90429a70d$var$__getOwnPropDesc$a(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)(decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n    return kind && result && $bb9ae9d90429a70d$var$__defProp$a(target, key, result), result;\n}, \"__decorateClass$a\"), $bb9ae9d90429a70d$var$__decorateParam$a = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((index, decorator)=>(target, key)=>decorator(target, key, index), \"__decorateParam$a\"), $bb9ae9d90429a70d$var$_a17;\nlet $bb9ae9d90429a70d$var$DocClipboardController = ($bb9ae9d90429a70d$var$_a17 = class extends (0, $7yNYd.RxDisposable) {\n    constructor(_context, _commandService, _docClipboardService, _docSelectionRenderService, _contextService){\n        super(), this._context = _context, this._commandService = _commandService, this._docClipboardService = _docClipboardService, this._docSelectionRenderService = _docSelectionRenderService, this._contextService = _contextService, this._init();\n    }\n    _init() {\n        this._initLegacyPasteCommand();\n    }\n    _initLegacyPasteCommand() {\n        var _a28;\n        (_a28 = this._docSelectionRenderService) == null || _a28.onPaste$.pipe((0, $2jrJe.takeUntil)(this.dispose$)).subscribe((config)=>{\n            var _a29, _b;\n            if (!$bb9ae9d90429a70d$var$whenDocOrEditor(this._contextService)) return;\n            config.event.preventDefault();\n            const clipboardEvent = config.event;\n            let htmlContent = (_a29 = clipboardEvent.clipboardData) == null ? void 0 : _a29.getData(\"text/html\");\n            const textContent = (_b = clipboardEvent.clipboardData) == null ? void 0 : _b.getData(\"text/plain\");\n            $bb9ae9d90429a70d$var$whenFocusEditor(this._contextService) && (htmlContent != null ? htmlContent : \"\").indexOf(\"</table>\") > -1 && (htmlContent = \"\"), this._docClipboardService.legacyPaste(htmlContent, textContent);\n        });\n    }\n}, $bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_a17, \"DocClipboardController\"), $bb9ae9d90429a70d$var$_a17);\n$bb9ae9d90429a70d$var$DocClipboardController = $bb9ae9d90429a70d$var$__decorateClass$a([\n    $bb9ae9d90429a70d$var$__decorateParam$a(1, (0, $7yNYd.ICommandService)),\n    $bb9ae9d90429a70d$var$__decorateParam$a(2, $bb9ae9d90429a70d$export$6b47ccaaccf9c11f),\n    $bb9ae9d90429a70d$var$__decorateParam$a(3, (0, $7yNYd.Inject)($bb9ae9d90429a70d$export$6dc2db33d8a277cd)),\n    $bb9ae9d90429a70d$var$__decorateParam$a(4, (0, $7yNYd.IContextService))\n], $bb9ae9d90429a70d$var$DocClipboardController);\nvar $bb9ae9d90429a70d$var$__defProp$9 = Object.defineProperty, $bb9ae9d90429a70d$var$__getOwnPropDesc$9 = Object.getOwnPropertyDescriptor, $bb9ae9d90429a70d$var$__decorateClass$9 = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((decorators, target, key, kind)=>{\n    for(var result = kind > 1 ? void 0 : kind ? $bb9ae9d90429a70d$var$__getOwnPropDesc$9(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)(decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n    return kind && result && $bb9ae9d90429a70d$var$__defProp$9(target, key, result), result;\n}, \"__decorateClass$9\"), $bb9ae9d90429a70d$var$__decorateParam$9 = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((index, decorator)=>(target, key)=>decorator(target, key, index), \"__decorateParam$9\");\nconst $bb9ae9d90429a70d$var$SKIP_UNIT_IDS = [\n    (0, $7yNYd.DEFAULT_EMPTY_DOCUMENT_VALUE),\n    (0, $7yNYd.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY),\n    (0, $7yNYd.DOCS_NORMAL_EDITOR_UNIT_ID_KEY),\n    (0, $7yNYd.DOCS_ZEN_EDITOR_UNIT_ID_KEY)\n];\nvar $bb9ae9d90429a70d$var$_a18;\nlet $bb9ae9d90429a70d$var$DocContextMenuRenderController = ($bb9ae9d90429a70d$var$_a18 = class extends (0, $7yNYd.Disposable) {\n    constructor(_context, _contextMenuService, _commandService){\n        super(), this._context = _context, this._contextMenuService = _contextMenuService, this._commandService = _commandService, $bb9ae9d90429a70d$var$SKIP_UNIT_IDS.includes(this._context.unitId) || (this._initPointerDown(), this._initEditChange());\n    }\n    _initPointerDown() {\n        var _a28, _b;\n        const documentsSubscription = ((_b = (_a28 = this._context) == null ? void 0 : _a28.mainComponent) == null ? void 0 : _b.onPointerDown$).subscribeEvent((event)=>{\n            event.button === 2 && this._contextMenuService.triggerContextMenu(event, (0, $fL2Ug.ContextMenuPosition).MAIN_AREA);\n        });\n        this.disposeWithMe(documentsSubscription);\n    }\n    _initEditChange() {\n        this.disposeWithMe(this._commandService.onCommandExecuted((command)=>{\n            command.id === (0, $7AR1b.RichTextEditingMutation).id && this._contextMenuService.visible && this._contextMenuService.hideContextMenu();\n        }));\n    }\n}, $bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_a18, \"DocContextMenuRenderController\"), $bb9ae9d90429a70d$var$_a18);\n$bb9ae9d90429a70d$var$DocContextMenuRenderController = $bb9ae9d90429a70d$var$__decorateClass$9([\n    $bb9ae9d90429a70d$var$__decorateParam$9(1, (0, $fL2Ug.IContextMenuService)),\n    $bb9ae9d90429a70d$var$__decorateParam$9(2, (0, $7yNYd.ICommandService))\n], $bb9ae9d90429a70d$var$DocContextMenuRenderController);\nvar $bb9ae9d90429a70d$var$__defProp$8 = Object.defineProperty, $bb9ae9d90429a70d$var$__getOwnPropDesc$8 = Object.getOwnPropertyDescriptor, $bb9ae9d90429a70d$var$__decorateClass$8 = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((decorators, target, key, kind)=>{\n    for(var result = kind > 1 ? void 0 : kind ? $bb9ae9d90429a70d$var$__getOwnPropDesc$8(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)(decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n    return kind && result && $bb9ae9d90429a70d$var$__defProp$8(target, key, result), result;\n}, \"__decorateClass$8\"), $bb9ae9d90429a70d$var$__decorateParam$8 = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((index, decorator)=>(target, key)=>decorator(target, key, index), \"__decorateParam$8\"), $bb9ae9d90429a70d$var$_a19;\nlet $bb9ae9d90429a70d$var$DocEditorBridgeController = ($bb9ae9d90429a70d$var$_a19 = class extends (0, $7yNYd.Disposable) {\n    constructor(_context, _univerInstanceService, _editorService, _commandService, _docSelectionRenderService, _docSkeletonManagerService, _renderManagerService){\n        super();\n        $bb9ae9d90429a70d$var$__publicField(this, \"_initialEditors\", /* @__PURE__ */ new Set());\n        this._context = _context, this._univerInstanceService = _univerInstanceService, this._editorService = _editorService, this._commandService = _commandService, this._docSelectionRenderService = _docSelectionRenderService, this._docSkeletonManagerService = _docSkeletonManagerService, this._renderManagerService = _renderManagerService, this._initialize();\n    }\n    _initialize() {\n        this.disposeWithMe(this._editorService.resize$.subscribe((unitId)=>{\n            unitId === this._context.unitId && this._resize(unitId);\n        })), this._editorService.getAllEditor().forEach((editor)=>{\n            const unitId = editor.editorUnitId;\n            unitId === this._context.unitId && (this._initialEditors.has(unitId) || (this._initialEditors.add(unitId), this._resize(unitId)));\n        }), this._commandExecutedListener(), this._initialSetValue(), this._initialBlur(), this._initialFocus(), this._initialValueChange();\n    }\n    // eslint-disable-next-line complexity\n    _resize(unitId) {\n        var _a28, _b;\n        if (unitId == null) return;\n        const editor = this._editorService.getEditor(unitId);\n        if ((editor == null ? void 0 : editor.cancelDefaultResizeListener) === !0) return;\n        const editorDataModel = this._univerInstanceService.getUniverDocInstance(unitId);\n        if (!editorDataModel) return;\n        const skeleton = this._docSkeletonManagerService.getSkeleton();\n        if (editor == null || editor.render == null || skeleton == null || editorDataModel == null) return;\n        skeleton.calculate();\n        const { marginTop: marginTop = 0, marginBottom: marginBottom = 0, marginLeft: marginLeft = 0, marginRight: marginRight = 0 } = editorDataModel.getSnapshot().documentStyle, { scene: scene, mainComponent: mainComponent } = editor.render;\n        let { actualHeight: actualHeight, actualWidth: actualWidth } = skeleton.getActualSize();\n        actualHeight += marginTop + marginBottom, actualWidth += marginLeft + marginRight;\n        const { width: width, height: height } = editor.getBoundingClientRect(), viewportMain = scene.getViewport($bb9ae9d90429a70d$export$691aac3130b48bd9.VIEW_MAIN);\n        let scrollBar = viewportMain == null ? void 0 : viewportMain.getScrollBar();\n        const contentWidth = Math.max(actualWidth, width), contentHeight = Math.max(actualHeight, height);\n        scene.transformByState({\n            width: contentWidth,\n            height: contentHeight\n        }), mainComponent == null || mainComponent.resize(contentWidth, contentHeight), editor.isSingle() ? actualWidth > width ? scrollBar == null ? viewportMain && new (0, $3e0Iz.ScrollBar)(viewportMain, {\n            barSize: 8,\n            enableVertical: !1\n        }) : viewportMain == null || viewportMain.resetCanvasSizeAndUpdateScroll() : (scrollBar = null, viewportMain == null || viewportMain.scrollToBarPos({\n            x: 0,\n            y: 0\n        }), (_b = viewportMain == null ? void 0 : viewportMain.getScrollBar()) == null || _b.dispose()) : actualHeight > height ? scrollBar == null ? viewportMain && new (0, $3e0Iz.ScrollBar)(viewportMain, {\n            enableHorizontal: !1,\n            barSize: 8\n        }) : viewportMain == null || viewportMain.resetCanvasSizeAndUpdateScroll() : (scrollBar = null, viewportMain == null || viewportMain.scrollToBarPos({\n            x: 0,\n            y: 0\n        }), (_a28 = viewportMain == null ? void 0 : viewportMain.getScrollBar()) == null || _a28.dispose());\n    }\n    _initialSetValue() {\n        this.disposeWithMe(this._editorService.setValue$.subscribe((param)=>{\n            param.editorUnitId === this._context.unitId && this._commandService.executeCommand($bb9ae9d90429a70d$export$ba4bc2e8402f82b3.id, {\n                unitId: param.editorUnitId,\n                body: param.body,\n                segmentId: null\n            });\n        }));\n    }\n    _initialBlur() {\n        this.disposeWithMe(this._editorService.blur$.subscribe(()=>{\n            this._docSelectionRenderService.removeAllRanges(), this._docSelectionRenderService.blur();\n        })), this.disposeWithMe(this._docSelectionRenderService.onBlur$.subscribe(()=>{\n            const { unitId: unitId } = this._context, editor = this._editorService.getEditor(unitId), focusEditor = this._editorService.getFocusEditor();\n            editor == null || editor.isSheetEditor() || focusEditor && focusEditor.editorUnitId === unitId || this._editorService.blur();\n        }));\n    }\n    _initialFocus() {\n        this.disposeWithMe(this._editorService.focus$.subscribe((textRange)=>{\n            var _a28;\n            ((_a28 = this._editorService.getFocusEditor()) == null ? void 0 : _a28.editorUnitId) === this._context.unitId && (this._docSelectionRenderService.removeAllRanges(), this._docSelectionRenderService.addDocRanges([\n                textRange\n            ]));\n        }));\n        const focusExcepts = [\n            \"univer-formula-search\",\n            \"univer-formula-help\",\n            \"formula-help-decorator\",\n            \"univer-formula-help-param\"\n        ];\n        this.disposeWithMe((0, $5HvWP.fromEvent)(window, \"mousedown\").subscribe((event)=>{\n            const hasSearch = event.target.classList[0] || \"\";\n            if ((0, $7yNYd.checkForSubstrings)(hasSearch, focusExcepts)) {\n                this._editorService.changeSpreadsheetFocusState(!0), event.stopPropagation();\n                return;\n            }\n            this._editorService.changeSpreadsheetFocusState(!1);\n        })), this._univerInstanceService.getAllUnitsForType((0, $7yNYd.UniverInstanceType).UNIVER_SHEET).forEach((unit)=>{\n            const unitId = unit.getUnitId(), render2 = this._renderManagerService.getRenderById(unitId), canvasEle = render2 == null ? void 0 : render2.engine.getCanvas().getCanvasEle();\n            canvasEle != null && (0, $5HvWP.fromEvent)(canvasEle, \"mousedown\").subscribe((evt)=>{\n                this._editorService.changeSpreadsheetFocusState(!0), evt.stopPropagation();\n            });\n        });\n    }\n    _initialValueChange() {\n        this.disposeWithMe(this._docSelectionRenderService.onCompositionupdate$.subscribe(this._valueChange.bind(this))), this.disposeWithMe(this._docSelectionRenderService.onInput$.subscribe(this._valueChange.bind(this))), this.disposeWithMe(this._docSelectionRenderService.onKeydown$.subscribe(this._valueChange.bind(this))), this.disposeWithMe(this._docSelectionRenderService.onPaste$.subscribe(this._valueChange.bind(this)));\n    }\n    _valueChange() {\n        const { unitId: unitId } = this._context, editor = this._editorService.getEditor(unitId);\n        editor == null || editor.isSheetEditor() || this._editorService.refreshValueChange(unitId);\n    }\n    /**\n   * Listen to document edits to refresh the size of the formula editor.\n   */ _commandExecutedListener() {\n        const updateCommandList = [\n            (0, $7AR1b.RichTextEditingMutation).id,\n            (0, $fL2Ug.SetEditorResizeOperation).id\n        ];\n        this.disposeWithMe(this._commandService.onCommandExecuted((command)=>{\n            if (updateCommandList.includes(command.id)) {\n                const params = command.params, { unitId: unitId } = params;\n                if (this._editorService.isSheetEditor(unitId) || unitId !== this._context.unitId) return;\n                this._resize(unitId), this._valueChange();\n            }\n        }));\n    }\n}, $bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_a19, \"DocEditorBridgeController\"), $bb9ae9d90429a70d$var$_a19);\n$bb9ae9d90429a70d$var$DocEditorBridgeController = $bb9ae9d90429a70d$var$__decorateClass$8([\n    $bb9ae9d90429a70d$var$__decorateParam$8(1, (0, $7yNYd.IUniverInstanceService)),\n    $bb9ae9d90429a70d$var$__decorateParam$8(2, (0, $fL2Ug.IEditorService)),\n    $bb9ae9d90429a70d$var$__decorateParam$8(3, (0, $7yNYd.ICommandService)),\n    $bb9ae9d90429a70d$var$__decorateParam$8(4, (0, $7yNYd.Inject)($bb9ae9d90429a70d$export$6dc2db33d8a277cd)),\n    $bb9ae9d90429a70d$var$__decorateParam$8(5, (0, $7yNYd.Inject)((0, $7AR1b.DocSkeletonManagerService))),\n    $bb9ae9d90429a70d$var$__decorateParam$8(6, (0, $3e0Iz.IRenderManagerService))\n], $bb9ae9d90429a70d$var$DocEditorBridgeController);\nvar $bb9ae9d90429a70d$var$__defProp$7 = Object.defineProperty, $bb9ae9d90429a70d$var$__getOwnPropDesc$7 = Object.getOwnPropertyDescriptor, $bb9ae9d90429a70d$var$__decorateClass$7 = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((decorators, target, key, kind)=>{\n    for(var result = kind > 1 ? void 0 : kind ? $bb9ae9d90429a70d$var$__getOwnPropDesc$7(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)(decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n    return kind && result && $bb9ae9d90429a70d$var$__defProp$7(target, key, result), result;\n}, \"__decorateClass$7\"), $bb9ae9d90429a70d$var$__decorateParam$7 = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((index, decorator)=>(target, key)=>decorator(target, key, index), \"__decorateParam$7\"), $bb9ae9d90429a70d$var$_a20;\nlet $bb9ae9d90429a70d$var$DocIMEInputController = ($bb9ae9d90429a70d$var$_a20 = class extends (0, $7yNYd.Disposable) {\n    constructor(_context, _univerInstanceService, _renderManagerSrv, _docSelectionRenderService, _docImeInputManagerService, _commandService){\n        super();\n        $bb9ae9d90429a70d$var$__publicField(this, \"_previousIMEContent\", \"\");\n        $bb9ae9d90429a70d$var$__publicField(this, \"_isCompositionStart\", !0);\n        $bb9ae9d90429a70d$var$__publicField(this, \"_onStartSubscription\");\n        $bb9ae9d90429a70d$var$__publicField(this, \"_onUpdateSubscription\");\n        $bb9ae9d90429a70d$var$__publicField(this, \"_onEndSubscription\");\n        this._context = _context, this._univerInstanceService = _univerInstanceService, this._renderManagerSrv = _renderManagerSrv, this._docSelectionRenderService = _docSelectionRenderService, this._docImeInputManagerService = _docImeInputManagerService, this._commandService = _commandService, this._initialize();\n    }\n    dispose() {\n        var _a28, _b, _c;\n        (_a28 = this._onStartSubscription) == null || _a28.unsubscribe(), (_b = this._onUpdateSubscription) == null || _b.unsubscribe(), (_c = this._onEndSubscription) == null || _c.unsubscribe();\n    }\n    _initialize() {\n        this._initialOnCompositionstart(), this._initialOnCompositionUpdate(), this._initialOnCompositionend();\n    }\n    _initialOnCompositionstart() {\n        this._onStartSubscription = this._docSelectionRenderService.onCompositionstart$.subscribe((config)=>{\n            if (config == null) return;\n            this._resetIME();\n            const { activeRange: activeRange } = config;\n            activeRange != null && this._docImeInputManagerService.setActiveRange((0, $7yNYd.Tools).deepClone(activeRange));\n        });\n    }\n    _initialOnCompositionUpdate() {\n        this._onUpdateSubscription = this._docSelectionRenderService.onCompositionupdate$.subscribe((config)=>{\n            this._updateContent(config, !0);\n        });\n    }\n    _initialOnCompositionend() {\n        this._onEndSubscription = this._docSelectionRenderService.onCompositionend$.subscribe((config)=>{\n            this._updateContent(config, !1);\n        });\n    }\n    async _updateContent(config, isUpdate) {\n        var _a28;\n        if (config == null) return;\n        const documentModel = this._univerInstanceService.getCurrentUniverDocInstance();\n        if (!documentModel) return;\n        const skeleton = (_a28 = this._renderManagerSrv.getRenderById(documentModel.getUnitId())) == null ? void 0 : _a28.with((0, $7AR1b.DocSkeletonManagerService)).getSkeleton(), { event: event, activeRange: activeRange } = config;\n        if (skeleton == null || activeRange == null) return;\n        const content = event.data;\n        content === this._previousIMEContent && isUpdate || (await this._commandService.executeCommand($bb9ae9d90429a70d$export$e6da9cc4b65a2183.id, {\n            unitId: documentModel.getUnitId(),\n            newText: content,\n            oldTextLen: this._previousIMEContent.length,\n            isCompositionStart: this._isCompositionStart,\n            isCompositionEnd: !isUpdate\n        }), isUpdate ? (this._isCompositionStart && (this._isCompositionStart = !1), this._previousIMEContent = content) : this._resetIME());\n    }\n    _resetIME() {\n        this._previousIMEContent = \"\", this._isCompositionStart = !0, this._docImeInputManagerService.clearUndoRedoMutationParamsCache(), this._docImeInputManagerService.setActiveRange(null);\n    }\n}, $bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_a20, \"DocIMEInputController\"), $bb9ae9d90429a70d$var$_a20);\n$bb9ae9d90429a70d$var$DocIMEInputController = $bb9ae9d90429a70d$var$__decorateClass$7([\n    $bb9ae9d90429a70d$var$__decorateParam$7(1, (0, $7yNYd.IUniverInstanceService)),\n    $bb9ae9d90429a70d$var$__decorateParam$7(2, (0, $3e0Iz.IRenderManagerService)),\n    $bb9ae9d90429a70d$var$__decorateParam$7(3, (0, $7yNYd.Inject)($bb9ae9d90429a70d$export$6dc2db33d8a277cd)),\n    $bb9ae9d90429a70d$var$__decorateParam$7(4, (0, $7yNYd.Inject)($bb9ae9d90429a70d$export$72a0cb80dc10dcf)),\n    $bb9ae9d90429a70d$var$__decorateParam$7(5, (0, $7yNYd.ICommandService))\n], $bb9ae9d90429a70d$var$DocIMEInputController);\nvar $bb9ae9d90429a70d$var$__defProp$6 = Object.defineProperty, $bb9ae9d90429a70d$var$__getOwnPropDesc$6 = Object.getOwnPropertyDescriptor, $bb9ae9d90429a70d$var$__decorateClass$6 = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((decorators, target, key, kind)=>{\n    for(var result = kind > 1 ? void 0 : kind ? $bb9ae9d90429a70d$var$__getOwnPropDesc$6(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)(decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n    return kind && result && $bb9ae9d90429a70d$var$__defProp$6(target, key, result), result;\n}, \"__decorateClass$6\"), $bb9ae9d90429a70d$var$__decorateParam$6 = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((index, decorator)=>(target, key)=>decorator(target, key, index), \"__decorateParam$6\"), $bb9ae9d90429a70d$var$_a21;\nlet $bb9ae9d90429a70d$var$DocInputController = ($bb9ae9d90429a70d$var$_a21 = class extends (0, $7yNYd.Disposable) {\n    constructor(_context, _docSelectionRenderService, _docSkeletonManagerService, _commandService){\n        super();\n        $bb9ae9d90429a70d$var$__publicField(this, \"_onInputSubscription\");\n        this._context = _context, this._docSelectionRenderService = _docSelectionRenderService, this._docSkeletonManagerService = _docSkeletonManagerService, this._commandService = _commandService, this._init();\n    }\n    dispose() {\n        var _a28;\n        super.dispose(), (_a28 = this._onInputSubscription) == null || _a28.unsubscribe();\n    }\n    _init() {\n        this._initialNormalInput();\n    }\n    _initialNormalInput() {\n        this._onInputSubscription = this._docSelectionRenderService.onInput$.subscribe(async (config)=>{\n            if (config == null) return;\n            const unitId = this._context.unitId, { event: event, content: content = \"\", activeRange: activeRange } = config, e = event, skeleton = this._docSkeletonManagerService.getSkeleton();\n            if (e.data == null || skeleton == null || !skeleton || !activeRange) return;\n            const { segmentId: segmentId } = activeRange, UNITS = [\n                (0, $7yNYd.DOCS_NORMAL_EDITOR_UNIT_ID_KEY),\n                (0, $7yNYd.DOCS_ZEN_EDITOR_UNIT_ID_KEY),\n                (0, $7yNYd.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY)\n            ];\n            await this._commandService.executeCommand($bb9ae9d90429a70d$export$f0cad0406ddcd4fa.id, {\n                unitId: unitId,\n                body: {\n                    dataStream: content\n                },\n                range: activeRange,\n                segmentId: segmentId,\n                extendLastRange: UNITS.includes(unitId)\n            }), content === \" \" && await this._commandService.executeCommand($bb9ae9d90429a70d$export$57d0a1299f7f4db8.id);\n        });\n    }\n}, $bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_a21, \"DocInputController\"), $bb9ae9d90429a70d$var$_a21);\n$bb9ae9d90429a70d$var$DocInputController = $bb9ae9d90429a70d$var$__decorateClass$6([\n    $bb9ae9d90429a70d$var$__decorateParam$6(1, (0, $7yNYd.Inject)($bb9ae9d90429a70d$export$6dc2db33d8a277cd)),\n    $bb9ae9d90429a70d$var$__decorateParam$6(2, (0, $7yNYd.Inject)((0, $7AR1b.DocSkeletonManagerService))),\n    $bb9ae9d90429a70d$var$__decorateParam$6(3, (0, $7yNYd.ICommandService))\n], $bb9ae9d90429a70d$var$DocInputController);\nconst $bb9ae9d90429a70d$var$_DocPageLayoutService = class _DocPageLayoutService extends (0, $7yNYd.Disposable) {\n    constructor(_context){\n        super(), this._context = _context;\n    }\n    calculatePagePosition() {\n        var _a28, _b;\n        const docObject = $bb9ae9d90429a70d$export$ea0dbb208e4826e2(this._context), zoomRatio = (_b = (_a28 = this._context.unit.getSettings()) == null ? void 0 : _a28.zoomRatio) != null ? _b : 1, { document: docsComponent, scene: scene, docBackground: docBackground } = docObject, parent = scene == null ? void 0 : scene.getParent(), { width: docsWidth, height: docsHeight, pageMarginLeft: pageMarginLeft, pageMarginTop: pageMarginTop } = docsComponent;\n        if (parent == null || docsWidth === Number.POSITIVE_INFINITY || docsHeight === Number.POSITIVE_INFINITY) return;\n        const { width: engineWidth, height: engineHeight } = parent;\n        let docsLeft = 0, docsTop = 0, sceneWidth = 0, sceneHeight = 0, scrollToX = Number.POSITIVE_INFINITY;\n        engineWidth > (docsWidth + pageMarginLeft * 2) * zoomRatio ? (docsLeft = engineWidth / 2 - docsWidth * zoomRatio / 2, docsLeft /= zoomRatio, sceneWidth = (engineWidth - pageMarginLeft * 2) / zoomRatio, scrollToX = 0) : (docsLeft = pageMarginLeft, sceneWidth = docsWidth + pageMarginLeft * 2, scrollToX = (sceneWidth - engineWidth / zoomRatio) / 2), engineHeight > docsHeight ? (docsTop = engineHeight / 2 - docsHeight / 2, sceneHeight = (engineHeight - pageMarginTop * 2) / zoomRatio) : (docsTop = pageMarginTop, sceneHeight = docsHeight + pageMarginTop * 2), scene.resize(sceneWidth, sceneHeight + 200), docsComponent.translate(docsLeft, docsTop), docBackground.translate(docsLeft, docsTop);\n        const viewport = scene.getViewport($bb9ae9d90429a70d$export$691aac3130b48bd9.VIEW_MAIN);\n        return scrollToX !== Number.POSITIVE_INFINITY && viewport != null && viewport.scrollToViewportPos({\n            viewportScrollX: scrollToX\n        }), this;\n    }\n};\n$bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_DocPageLayoutService, \"DocPageLayoutService\");\nlet $bb9ae9d90429a70d$var$DocPageLayoutService = $bb9ae9d90429a70d$var$_DocPageLayoutService;\nvar $bb9ae9d90429a70d$var$__defProp$5 = Object.defineProperty, $bb9ae9d90429a70d$var$__getOwnPropDesc$5 = Object.getOwnPropertyDescriptor, $bb9ae9d90429a70d$var$__decorateClass$5 = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((decorators, target, key, kind)=>{\n    for(var result = kind > 1 ? void 0 : kind ? $bb9ae9d90429a70d$var$__getOwnPropDesc$5(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)(decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n    return kind && result && $bb9ae9d90429a70d$var$__defProp$5(target, key, result), result;\n}, \"__decorateClass$5\"), $bb9ae9d90429a70d$var$__decorateParam$5 = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((index, decorator)=>(target, key)=>decorator(target, key, index), \"__decorateParam$5\"), $bb9ae9d90429a70d$var$_a22;\nlet $bb9ae9d90429a70d$var$DocResizeRenderController = ($bb9ae9d90429a70d$var$_a22 = class extends (0, $7yNYd.Disposable) {\n    constructor(_context, _docPageLayoutService, _textSelectionManagerService){\n        super(), this._context = _context, this._docPageLayoutService = _docPageLayoutService, this._textSelectionManagerService = _textSelectionManagerService;\n        const unitId = this._context.unitId;\n        if ((0, $7yNYd.isInternalEditorID)(unitId) && unitId !== (0, $7yNYd.DOCS_ZEN_EDITOR_UNIT_ID_KEY)) return this;\n        this._initResize();\n    }\n    _initResize() {\n        this.disposeWithMe((0, $7yNYd.fromEventSubject)(this._context.engine.onTransformChange$).pipe((0, $lMvMU.filter)((evt)=>evt.type === (0, $3e0Iz.TRANSFORM_CHANGE_OBSERVABLE_TYPE).resize), (0, $gv2K9.throttleTime)(0, (0, $6nOkr.animationFrameScheduler))).subscribe(()=>{\n            this._docPageLayoutService.calculatePagePosition(), this._textSelectionManagerService.refreshSelection();\n        }));\n    }\n}, $bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_a22, \"DocResizeRenderController\"), $bb9ae9d90429a70d$var$_a22);\n$bb9ae9d90429a70d$var$DocResizeRenderController = $bb9ae9d90429a70d$var$__decorateClass$5([\n    $bb9ae9d90429a70d$var$__decorateParam$5(1, (0, $7yNYd.Inject)($bb9ae9d90429a70d$var$DocPageLayoutService)),\n    $bb9ae9d90429a70d$var$__decorateParam$5(2, (0, $7yNYd.Inject)((0, $7AR1b.DocSelectionManagerService)))\n], $bb9ae9d90429a70d$var$DocResizeRenderController);\nvar $bb9ae9d90429a70d$var$__defProp$4 = Object.defineProperty, $bb9ae9d90429a70d$var$__getOwnPropDesc$4 = Object.getOwnPropertyDescriptor, $bb9ae9d90429a70d$var$__decorateClass$4 = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((decorators, target, key, kind)=>{\n    for(var result = kind > 1 ? void 0 : kind ? $bb9ae9d90429a70d$var$__getOwnPropDesc$4(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)(decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n    return kind && result && $bb9ae9d90429a70d$var$__defProp$4(target, key, result), result;\n}, \"__decorateClass$4\"), $bb9ae9d90429a70d$var$__decorateParam$4 = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((index, decorator)=>(target, key)=>decorator(target, key, index), \"__decorateParam$4\"), $bb9ae9d90429a70d$var$_a23;\nlet $bb9ae9d90429a70d$var$DocSelectionRenderController = ($bb9ae9d90429a70d$var$_a23 = class extends (0, $7yNYd.Disposable) {\n    constructor(_context, _commandService, _editorService, _instanceSrv, _docSelectionRenderService, _docSkeletonManagerService, _docSelectionManagerService){\n        super();\n        $bb9ae9d90429a70d$var$__publicField(this, \"_loadedMap\", /* @__PURE__ */ new WeakSet());\n        this._context = _context, this._commandService = _commandService, this._editorService = _editorService, this._instanceSrv = _instanceSrv, this._docSelectionRenderService = _docSelectionRenderService, this._docSkeletonManagerService = _docSkeletonManagerService, this._docSelectionManagerService = _docSelectionManagerService, this._initialize();\n    }\n    _initialize() {\n        this._init(), this._skeletonListener(), this._commandExecutedListener(), this._refreshListener(), this._syncSelection();\n    }\n    _init() {\n        const { unitId: unitId } = this._context, docObject = $bb9ae9d90429a70d$export$ea0dbb208e4826e2(this._context);\n        docObject == null || docObject.document == null || this._loadedMap.has(docObject.document) || (this._initialMain(unitId), this._loadedMap.add(docObject.document));\n    }\n    _refreshListener() {\n        this.disposeWithMe(this._docSelectionManagerService.refreshSelection$.subscribe((params)=>{\n            if (params == null) return;\n            const { unitId: unitId, docRanges: docRanges, isEditing: isEditing, options: options } = params;\n            unitId === this._context.unitId && (this._docSelectionRenderService.removeAllRanges(), docRanges.length && this._docSelectionRenderService.addDocRanges(docRanges, isEditing, options));\n        }));\n    }\n    _syncSelection() {\n        this.disposeWithMe(this._docSelectionRenderService.textSelectionInner$.subscribe((params)=>{\n            params != null && this._docSelectionManagerService.__replaceTextRangesWithNoRefresh(params);\n        }));\n    }\n    // eslint-disable-next-line max-lines-per-function\n    _initialMain(unitId) {\n        const docObject = $bb9ae9d90429a70d$export$ea0dbb208e4826e2(this._context), { document: document2, scene: scene } = docObject;\n        this.disposeWithMe(document2.onPointerEnter$.subscribeEvent(()=>{\n            this._isEditorReadOnly(unitId) || (document2.cursor = (0, $3e0Iz.CURSOR_TYPE).TEXT);\n        })), this.disposeWithMe(document2.onPointerLeave$.subscribeEvent(()=>{\n            document2.cursor = (0, $3e0Iz.CURSOR_TYPE).DEFAULT, scene.resetCursor();\n        })), this.disposeWithMe(document2.onPointerDown$.subscribeEvent((evt, state)=>{\n            if (this._isEditorReadOnly(unitId)) return;\n            const docDataModel = this._instanceSrv.getCurrentUnitForType((0, $7yNYd.UniverInstanceType).UNIVER_DOC);\n            (docDataModel == null ? void 0 : docDataModel.getUnitId()) !== unitId && this._instanceSrv.setCurrentUnitForType(unitId);\n            const skeleton = this._docSkeletonManagerService.getSkeleton(), { offsetX: offsetX, offsetY: offsetY } = evt, coord = this._getTransformCoordForDocumentOffset(offsetX, offsetY);\n            if (coord != null) {\n                const { pageLayoutType: pageLayoutType = (0, $3e0Iz.PageLayoutType).VERTICAL, pageMarginLeft: pageMarginLeft, pageMarginTop: pageMarginTop } = document2.getOffsetConfig(), { editArea: editArea } = skeleton.findEditAreaByCoord(coord, pageLayoutType, pageMarginLeft, pageMarginTop), viewModel = this._docSkeletonManagerService.getViewModel(), preEditArea = viewModel.getEditArea();\n                preEditArea !== (0, $3e0Iz.DocumentEditArea).BODY && editArea !== (0, $3e0Iz.DocumentEditArea).BODY && editArea !== preEditArea && viewModel.setEditArea(editArea);\n            }\n            if (this._docSelectionRenderService.__onPointDown(evt), this._editorService.getEditor(unitId)) {\n                this._setEditorFocus(unitId);\n                const { offsetX: offsetX2, offsetY: offsetY2 } = evt;\n                setTimeout(()=>{\n                    unitId !== this._editorService.getFocusId() && (this._setEditorFocus(unitId), this._docSelectionRenderService.setCursorManually(offsetX2, offsetY2));\n                }, 0);\n            }\n            evt.button !== 2 && state.stopPropagation();\n        })), this.disposeWithMe(document2.onDblclick$.subscribeEvent((evt)=>{\n            this._isEditorReadOnly(unitId) || this._docSelectionRenderService.__handleDblClick(evt);\n        })), this.disposeWithMe(document2.onTripleClick$.subscribeEvent((evt)=>{\n            this._isEditorReadOnly(unitId) || this._docSelectionRenderService.__handleTripleClick(evt);\n        }));\n    }\n    _getTransformCoordForDocumentOffset(evtOffsetX, evtOffsetY) {\n        const docObject = $bb9ae9d90429a70d$export$ea0dbb208e4826e2(this._context), { document: document2, scene: scene } = docObject, { documentTransform: documentTransform } = document2.getOffsetConfig(), activeViewport = scene.getViewports()[0];\n        if (activeViewport == null) return;\n        const originCoord = activeViewport.transformVector2SceneCoord((0, $3e0Iz.Vector2).FromArray([\n            evtOffsetX,\n            evtOffsetY\n        ]));\n        return documentTransform.clone().invert().applyPoint(originCoord);\n    }\n    _isEditorReadOnly(unitId) {\n        const editor = this._editorService.getEditor(unitId);\n        return editor ? editor.isReadOnly() : !1;\n    }\n    _setEditorFocus(unitId) {\n        this._editorService.focusStyle(unitId);\n    }\n    _commandExecutedListener() {\n        const updateCommandList = [\n            $bb9ae9d90429a70d$export$324478118aea2b96.id\n        ];\n        this.disposeWithMe(this._commandService.onCommandExecuted((command)=>{\n            var _a28;\n            if (updateCommandList.includes(command.id)) {\n                const params = command.params, { unitId: documentId } = params, unitId = (_a28 = this._docSelectionManagerService.getCurrentSelection()) == null ? void 0 : _a28.unitId;\n                if (documentId !== unitId) return;\n                this._docSelectionManagerService.refreshSelection();\n            }\n        }));\n    }\n    _skeletonListener() {\n        let init = !1;\n        this.disposeWithMe(this._docSkeletonManagerService.currentSkeleton$.subscribe((skeleton)=>{\n            if (!skeleton) return;\n            const { unitId: unitId } = this._context, isInternalEditor = (0, $7yNYd.isInternalEditorID)(unitId);\n            (init || !(0, $7yNYd.isInternalEditorID)(this._context.unitId)) && (isInternalEditor || this._docSelectionManagerService.replaceTextRanges([\n                {\n                    startOffset: 0,\n                    endOffset: 0\n                }\n            ], !1)), init = !0;\n        }));\n    }\n}, $bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_a23, \"DocSelectionRenderController\"), $bb9ae9d90429a70d$var$_a23);\n$bb9ae9d90429a70d$var$DocSelectionRenderController = $bb9ae9d90429a70d$var$__decorateClass$4([\n    $bb9ae9d90429a70d$var$__decorateParam$4(1, (0, $7yNYd.ICommandService)),\n    $bb9ae9d90429a70d$var$__decorateParam$4(2, (0, $fL2Ug.IEditorService)),\n    $bb9ae9d90429a70d$var$__decorateParam$4(3, (0, $7yNYd.IUniverInstanceService)),\n    $bb9ae9d90429a70d$var$__decorateParam$4(4, (0, $7yNYd.Inject)($bb9ae9d90429a70d$export$6dc2db33d8a277cd)),\n    $bb9ae9d90429a70d$var$__decorateParam$4(5, (0, $7yNYd.Inject)((0, $7AR1b.DocSkeletonManagerService))),\n    $bb9ae9d90429a70d$var$__decorateParam$4(6, (0, $7yNYd.Inject)((0, $7AR1b.DocSelectionManagerService)))\n], $bb9ae9d90429a70d$var$DocSelectionRenderController);\nvar $bb9ae9d90429a70d$var$__defProp$3 = Object.defineProperty, $bb9ae9d90429a70d$var$__getOwnPropDesc$3 = Object.getOwnPropertyDescriptor, $bb9ae9d90429a70d$var$__decorateClass$3 = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((decorators, target, key, kind)=>{\n    for(var result = kind > 1 ? void 0 : kind ? $bb9ae9d90429a70d$var$__getOwnPropDesc$3(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)(decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n    return kind && result && $bb9ae9d90429a70d$var$__defProp$3(target, key, result), result;\n}, \"__decorateClass$3\"), $bb9ae9d90429a70d$var$__decorateParam$3 = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((index, decorator)=>(target, key)=>decorator(target, key, index), \"__decorateParam$3\"), $bb9ae9d90429a70d$var$_a24;\nlet $bb9ae9d90429a70d$var$DocZoomRenderController = ($bb9ae9d90429a70d$var$_a24 = class extends (0, $7yNYd.Disposable) {\n    constructor(_context, _contextService, _docSkeletonManagerService, _univerInstanceService, _commandService, _textSelectionManagerService, _editorService, _docPageLayoutService){\n        super(), this._context = _context, this._contextService = _contextService, this._docSkeletonManagerService = _docSkeletonManagerService, this._univerInstanceService = _univerInstanceService, this._commandService = _commandService, this._textSelectionManagerService = _textSelectionManagerService, this._editorService = _editorService, this._docPageLayoutService = _docPageLayoutService, this._initSkeletonListener(), this._initCommandExecutedListener(), this._initRenderRefresher(), setTimeout(()=>this.updateViewZoom(1, !0), 20);\n    }\n    _initRenderRefresher() {\n        this._docSkeletonManagerService.currentSkeleton$.subscribe((param)=>{\n            if (param == null) return;\n            const { unitId: unitId, scene: scene } = this._context;\n            this._editorService.isEditor(unitId) || this.disposeWithMe(scene.onMouseWheel$.subscribeEvent((e)=>{\n                if (!e.ctrlKey || !this._contextService.getContextValue((0, $7yNYd.FOCUSING_DOC))) return;\n                const documentModel = this._univerInstanceService.getCurrentUniverDocInstance();\n                if (!documentModel) return;\n                const deltaFactor = Math.abs(e.deltaX);\n                let ratioDelta = deltaFactor < 40 ? 0.2 : deltaFactor < 80 ? 0.4 : 0.2;\n                ratioDelta *= e.deltaY > 0 ? -1 : 1, scene.scaleX < 1 && (ratioDelta /= 2);\n                const currentRatio = documentModel.zoomRatio;\n                let nextRatio = +Number.parseFloat(`${currentRatio + ratioDelta}`).toFixed(1);\n                nextRatio = nextRatio >= 4 ? 4 : nextRatio <= 0.1 ? 0.1 : nextRatio, this._commandService.executeCommand($bb9ae9d90429a70d$export$fdc76f9b34e96863.id, {\n                    zoomRatio: nextRatio,\n                    unitId: documentModel.getUnitId()\n                }), e.preventDefault();\n            }));\n        });\n    }\n    _initSkeletonListener() {\n        this.disposeWithMe(this._docSkeletonManagerService.currentSkeleton$.subscribe((param)=>{\n            if (param == null) return;\n            const documentModel = this._univerInstanceService.getCurrentUniverDocInstance();\n            if (!documentModel) return;\n            const zoomRatio = documentModel.zoomRatio || 1;\n            this.updateViewZoom(zoomRatio, !1);\n        }));\n    }\n    _initCommandExecutedListener() {\n        const updateCommandList = [\n            $bb9ae9d90429a70d$export$324478118aea2b96.id\n        ];\n        this.disposeWithMe(this._commandService.onCommandExecuted((command)=>{\n            if (updateCommandList.includes(command.id) && command.params.unitId === this._context.unitId) {\n                const zoomRatio = this._context.unit.zoomRatio || 1;\n                this.updateViewZoom(zoomRatio);\n            }\n        }));\n    }\n    updateViewZoom(zoomRatio, needRefreshSelection = !0) {\n        var _a28;\n        const docObject = $bb9ae9d90429a70d$export$ea0dbb208e4826e2(this._context);\n        docObject.scene.scale(zoomRatio, zoomRatio), this._docPageLayoutService.calculatePagePosition(), needRefreshSelection && !this._editorService.isEditor(this._context.unitId) && this._textSelectionManagerService.refreshSelection(), (_a28 = docObject.scene.getTransformer()) == null || _a28.clearSelectedObjects();\n    }\n}, $bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_a24, \"DocZoomRenderController\"), $bb9ae9d90429a70d$var$_a24);\n$bb9ae9d90429a70d$var$DocZoomRenderController = $bb9ae9d90429a70d$var$__decorateClass$3([\n    $bb9ae9d90429a70d$var$__decorateParam$3(1, (0, $7yNYd.IContextService)),\n    $bb9ae9d90429a70d$var$__decorateParam$3(2, (0, $7yNYd.Inject)((0, $7AR1b.DocSkeletonManagerService))),\n    $bb9ae9d90429a70d$var$__decorateParam$3(3, (0, $7yNYd.IUniverInstanceService)),\n    $bb9ae9d90429a70d$var$__decorateParam$3(4, (0, $7yNYd.ICommandService)),\n    $bb9ae9d90429a70d$var$__decorateParam$3(5, (0, $7yNYd.Inject)((0, $7AR1b.DocSelectionManagerService))),\n    $bb9ae9d90429a70d$var$__decorateParam$3(6, (0, $fL2Ug.IEditorService)),\n    $bb9ae9d90429a70d$var$__decorateParam$3(7, (0, $7yNYd.Inject)($bb9ae9d90429a70d$var$DocPageLayoutService))\n], $bb9ae9d90429a70d$var$DocZoomRenderController);\nvar $bb9ae9d90429a70d$var$__defProp$2 = Object.defineProperty, $bb9ae9d90429a70d$var$__getOwnPropDesc$2 = Object.getOwnPropertyDescriptor, $bb9ae9d90429a70d$var$__decorateClass$2 = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((decorators, target, key, kind)=>{\n    for(var result = kind > 1 ? void 0 : kind ? $bb9ae9d90429a70d$var$__getOwnPropDesc$2(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)(decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n    return kind && result && $bb9ae9d90429a70d$var$__defProp$2(target, key, result), result;\n}, \"__decorateClass$2\"), $bb9ae9d90429a70d$var$__decorateParam$2 = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((index, decorator)=>(target, key)=>decorator(target, key, index), \"__decorateParam$2\");\nconst $bb9ae9d90429a70d$var$DEBOUNCE_DELAY = 300;\nvar $bb9ae9d90429a70d$var$_a25;\nlet $bb9ae9d90429a70d$export$cc3d72a47d4cd6e3 = ($bb9ae9d90429a70d$var$_a25 = class extends (0, $7yNYd.RxDisposable) {\n    constructor(_undoRedoService, _commandService, _univerInstanceService, _docStateEmitService, _renderManagerService){\n        super();\n        $bb9ae9d90429a70d$var$__publicField(this, \"_docStateChange$\", new (0, $5LPkb.BehaviorSubject)(null));\n        $bb9ae9d90429a70d$var$__publicField(this, \"docStateChange$\", this._docStateChange$.asObservable());\n        // This cache used for history compose.\n        $bb9ae9d90429a70d$var$__publicField(this, \"_historyStateCache\", /* @__PURE__ */ new Map());\n        // This cache used for collaboration state compose.\n        $bb9ae9d90429a70d$var$__publicField(this, \"_changeStateCache\", /* @__PURE__ */ new Map());\n        $bb9ae9d90429a70d$var$__publicField(this, \"_historyTimer\", null);\n        $bb9ae9d90429a70d$var$__publicField(this, \"_changeStateCacheTimer\", null);\n        this._undoRedoService = _undoRedoService, this._commandService = _commandService, this._univerInstanceService = _univerInstanceService, this._docStateEmitService = _docStateEmitService, this._renderManagerService = _renderManagerService, this._initialize(), this._listenDocStateChange();\n    }\n    _setChangeState(changeState) {\n        this._cacheChangeState(changeState, \"history\"), this._cacheChangeState(changeState, \"collaboration\");\n    }\n    _initialize() {\n        this.disposeWithMe(this._commandService.beforeCommandExecuted((command)=>{\n            if (command.id === (0, $7yNYd.UndoCommandId) || command.id === (0, $7yNYd.RedoCommandId)) {\n                const univerDoc = this._univerInstanceService.getCurrentUniverDocInstance();\n                if (univerDoc == null) return;\n                const unitId = univerDoc.getUnitId();\n                this._pushHistory(unitId), this._emitChangeState(unitId);\n            }\n        }));\n    }\n    _listenDocStateChange() {\n        this._docStateEmitService.docStateChangeParams$.pipe((0, $2jrJe.takeUntil)(this.dispose$)).subscribe((changeStateInfo)=>{\n            var _a28;\n            if (changeStateInfo == null) return;\n            const { isCompositionEnd: isCompositionEnd, ...changeState } = changeStateInfo, imeInputManagerService = (_a28 = this._renderManagerService.getRenderById(changeStateInfo.unitId)) == null ? void 0 : _a28.with($bb9ae9d90429a70d$export$72a0cb80dc10dcf);\n            if (imeInputManagerService != null) {\n                if (isCompositionEnd) {\n                    const historyParams = imeInputManagerService.fetchComposedUndoRedoMutationParams();\n                    if (historyParams == null) throw new Error(\"historyParams is null in RichTextEditingMutation\");\n                    const { undoMutationParams: undoMutationParams, redoMutationParams: redoMutationParams, previousActiveRange: previousActiveRange } = historyParams;\n                    changeState.redoState.actions = redoMutationParams.actions, changeState.undoState.actions = undoMutationParams.actions, changeState.undoState.textRanges = [\n                        previousActiveRange\n                    ];\n                }\n                this._setChangeState(changeState);\n            }\n        });\n    }\n    _cacheChangeState(changeState, type = \"history\") {\n        const { trigger: trigger, unitId: unitId, noHistory: noHistory, debounce: debounce = !1 } = changeState;\n        if (noHistory || trigger == null || type === \"history\" && (trigger === (0, $7yNYd.RedoCommandId) || trigger === (0, $7yNYd.UndoCommandId))) return;\n        const stateCache = type === \"history\" ? this._historyStateCache : this._changeStateCache, cb = type === \"history\" ? this._pushHistory.bind(this) : this._emitChangeState.bind(this);\n        if (stateCache.has(unitId)) {\n            const cacheStates = stateCache.get(unitId);\n            cacheStates == null || cacheStates.push(changeState);\n        } else stateCache.set(unitId, [\n            changeState\n        ]);\n        debounce ? type === \"history\" ? (this._historyTimer && clearTimeout(this._historyTimer), this._historyTimer = setTimeout(()=>{\n            cb(unitId);\n        }, $bb9ae9d90429a70d$var$DEBOUNCE_DELAY)) : (this._changeStateCacheTimer && clearTimeout(this._changeStateCacheTimer), this._changeStateCacheTimer = setTimeout(()=>{\n            cb(unitId);\n        }, $bb9ae9d90429a70d$var$DEBOUNCE_DELAY)) : cb(unitId);\n    }\n    _pushHistory(unitId) {\n        const undoRedoService = this._undoRedoService, cacheStates = this._historyStateCache.get(unitId);\n        if (!Array.isArray(cacheStates) || cacheStates.length === 0) return;\n        const len = cacheStates.length, commandId = cacheStates[0].commandId, firstState = cacheStates[0], lastState = cacheStates[len - 1], redoParams = {\n            unitId: unitId,\n            actions: cacheStates.reduce((acc, cur)=>(0, $7yNYd.JSONX).compose(acc, cur.redoState.actions), null),\n            textRanges: lastState.redoState.textRanges\n        }, undoParams = {\n            unitId: unitId,\n            // Always need to put undoParams after redoParams, because `reverse` will change the `cacheStates` order.\n            actions: cacheStates.reverse().reduce((acc, cur)=>(0, $7yNYd.JSONX).compose(acc, cur.undoState.actions), null),\n            textRanges: firstState.undoState.textRanges\n        };\n        undoRedoService.pushUndoRedo({\n            unitID: unitId,\n            undoMutations: [\n                {\n                    id: commandId,\n                    params: undoParams\n                }\n            ],\n            redoMutations: [\n                {\n                    id: commandId,\n                    params: redoParams\n                }\n            ]\n        }), cacheStates.length = 0;\n    }\n    _emitChangeState(unitId) {\n        const cacheStates = this._changeStateCache.get(unitId);\n        if (!Array.isArray(cacheStates) || cacheStates.length === 0) return;\n        const len = cacheStates.length, { commandId: commandId, trigger: trigger, segmentId: segmentId, noHistory: noHistory, debounce: debounce } = cacheStates[0], firstState = cacheStates[0], lastState = cacheStates[len - 1], redoState = {\n            unitId: unitId,\n            actions: cacheStates.reduce((acc, cur)=>(0, $7yNYd.JSONX).compose(acc, cur.redoState.actions), null),\n            textRanges: lastState.redoState.textRanges\n        }, undoState = {\n            unitId: unitId,\n            // Always need to put undoParams after redoParams, because `reverse` will change the `cacheStates` order.\n            actions: cacheStates.reverse().reduce((acc, cur)=>(0, $7yNYd.JSONX).compose(acc, cur.undoState.actions), null),\n            textRanges: firstState.undoState.textRanges\n        }, changeState = {\n            commandId: commandId,\n            unitId: unitId,\n            trigger: trigger,\n            redoState: redoState,\n            undoState: undoState,\n            segmentId: segmentId,\n            noHistory: noHistory,\n            debounce: debounce\n        };\n        cacheStates.length = 0, this._docStateChange$.next(changeState);\n    }\n}, $bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_a25, \"DocStateChangeManagerService\"), $bb9ae9d90429a70d$var$_a25);\n$bb9ae9d90429a70d$export$cc3d72a47d4cd6e3 = $bb9ae9d90429a70d$var$__decorateClass$2([\n    (0, $7yNYd.OnLifecycle)((0, $7yNYd.LifecycleStages).Ready, $bb9ae9d90429a70d$export$cc3d72a47d4cd6e3),\n    $bb9ae9d90429a70d$var$__decorateParam$2(0, (0, $7yNYd.Inject)((0, $7yNYd.IUndoRedoService))),\n    $bb9ae9d90429a70d$var$__decorateParam$2(1, (0, $7yNYd.ICommandService)),\n    $bb9ae9d90429a70d$var$__decorateParam$2(2, (0, $7yNYd.IUniverInstanceService)),\n    $bb9ae9d90429a70d$var$__decorateParam$2(3, (0, $7yNYd.Inject)((0, $7AR1b.DocStateEmitService))),\n    $bb9ae9d90429a70d$var$__decorateParam$2(4, (0, $3e0Iz.IRenderManagerService))\n], $bb9ae9d90429a70d$export$cc3d72a47d4cd6e3);\nvar $bb9ae9d90429a70d$var$__defProp$1 = Object.defineProperty, $bb9ae9d90429a70d$var$__getOwnPropDesc$1 = Object.getOwnPropertyDescriptor, $bb9ae9d90429a70d$var$__decorateClass$1 = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((decorators, target, key, kind)=>{\n    for(var result = kind > 1 ? void 0 : kind ? $bb9ae9d90429a70d$var$__getOwnPropDesc$1(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)(decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n    return kind && result && $bb9ae9d90429a70d$var$__defProp$1(target, key, result), result;\n}, \"__decorateClass$1\"), $bb9ae9d90429a70d$var$__decorateParam$1 = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((index, decorator)=>(target, key)=>decorator(target, key, index), \"__decorateParam$1\"), $bb9ae9d90429a70d$var$_a26;\nlet $bb9ae9d90429a70d$export$c7516c8e4c4bc9a0 = ($bb9ae9d90429a70d$var$_a26 = class extends (0, $7yNYd.RxDisposable) {\n    constructor(_instanceSrv, _renderManagerService){\n        super(), this._instanceSrv = _instanceSrv, this._renderManagerService = _renderManagerService, this._init();\n    }\n    _init() {\n        this._renderManagerService.createRender$.pipe((0, $2jrJe.takeUntil)(this.dispose$)).subscribe((unitId)=>this._createRenderWithId(unitId)), this._instanceSrv.getAllUnitsForType((0, $7yNYd.UniverInstanceType).UNIVER_DOC).forEach((documentModel)=>this._createRenderer(documentModel)), this._instanceSrv.getTypeOfUnitAdded$((0, $7yNYd.UniverInstanceType).UNIVER_DOC).pipe((0, $2jrJe.takeUntil)(this.dispose$)).subscribe((doc)=>this._createRenderer(doc)), this._instanceSrv.getTypeOfUnitDisposed$((0, $7yNYd.UniverInstanceType).UNIVER_DOC).pipe((0, $2jrJe.takeUntil)(this.dispose$)).subscribe((doc)=>this._disposeRenderer(doc));\n    }\n    _createRenderer(doc) {\n        const unitId = doc.getUnitId();\n        this._renderManagerService.has(unitId) || (this._createRenderWithId(unitId), this._renderManagerService.setCurrent(unitId));\n    }\n    _createRenderWithId(unitId) {\n        this._renderManagerService.createRender(unitId);\n    }\n    _disposeRenderer(doc) {\n        const unitId = doc.getUnitId();\n        this._renderManagerService.removeRender(unitId);\n    }\n}, $bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_a26, \"DocsRenderService\"), $bb9ae9d90429a70d$var$_a26);\n$bb9ae9d90429a70d$export$c7516c8e4c4bc9a0 = $bb9ae9d90429a70d$var$__decorateClass$1([\n    (0, $7yNYd.OnLifecycle)((0, $7yNYd.LifecycleStages).Ready, $bb9ae9d90429a70d$export$c7516c8e4c4bc9a0),\n    $bb9ae9d90429a70d$var$__decorateParam$1(0, (0, $7yNYd.IUniverInstanceService)),\n    $bb9ae9d90429a70d$var$__decorateParam$1(1, (0, $3e0Iz.IRenderManagerService))\n], $bb9ae9d90429a70d$export$c7516c8e4c4bc9a0);\nconst $bb9ae9d90429a70d$var$BreakLineShortcut = {\n    id: $bb9ae9d90429a70d$export$94e417ac7df3c302.id,\n    preconditions: $bb9ae9d90429a70d$var$whenDocAndEditorFocusedWithBreakLine,\n    binding: (0, $fL2Ug.KeyCode).ENTER\n}, $bb9ae9d90429a70d$var$DeleteLeftShortcut = {\n    id: $bb9ae9d90429a70d$export$b83c33c82ff96791.id,\n    preconditions: $bb9ae9d90429a70d$export$9cb76b3207b29c5d,\n    binding: (0, $fL2Ug.KeyCode).BACKSPACE\n}, $bb9ae9d90429a70d$var$DeleteRightShortcut = {\n    id: $bb9ae9d90429a70d$export$887646cf81f0174e.id,\n    preconditions: $bb9ae9d90429a70d$export$9cb76b3207b29c5d,\n    binding: (0, $fL2Ug.KeyCode).DELETE\n}, $bb9ae9d90429a70d$var$MoveCursorUpShortcut = {\n    id: $bb9ae9d90429a70d$export$12633081beeab12c.id,\n    binding: (0, $fL2Ug.KeyCode).ARROW_UP,\n    preconditions: $bb9ae9d90429a70d$export$9cb76b3207b29c5d,\n    staticParameters: {\n        direction: (0, $7yNYd.Direction).UP\n    }\n}, $bb9ae9d90429a70d$var$MoveCursorDownShortcut = {\n    id: $bb9ae9d90429a70d$export$12633081beeab12c.id,\n    binding: (0, $fL2Ug.KeyCode).ARROW_DOWN,\n    preconditions: $bb9ae9d90429a70d$export$9cb76b3207b29c5d,\n    staticParameters: {\n        direction: (0, $7yNYd.Direction).DOWN\n    }\n}, $bb9ae9d90429a70d$var$MoveCursorLeftShortcut = {\n    id: $bb9ae9d90429a70d$export$12633081beeab12c.id,\n    binding: (0, $fL2Ug.KeyCode).ARROW_LEFT,\n    preconditions: $bb9ae9d90429a70d$export$9cb76b3207b29c5d,\n    staticParameters: {\n        direction: (0, $7yNYd.Direction).LEFT\n    }\n}, $bb9ae9d90429a70d$var$MoveCursorRightShortcut = {\n    id: $bb9ae9d90429a70d$export$12633081beeab12c.id,\n    binding: (0, $fL2Ug.KeyCode).ARROW_RIGHT,\n    preconditions: $bb9ae9d90429a70d$export$9cb76b3207b29c5d,\n    staticParameters: {\n        direction: (0, $7yNYd.Direction).RIGHT\n    }\n}, $bb9ae9d90429a70d$var$MoveSelectionUpShortcut = {\n    id: $bb9ae9d90429a70d$export$bb98a1a9da56437b.id,\n    binding: (0, $fL2Ug.KeyCode).ARROW_UP | (0, $fL2Ug.MetaKeys).SHIFT,\n    preconditions: $bb9ae9d90429a70d$export$9cb76b3207b29c5d,\n    staticParameters: {\n        direction: (0, $7yNYd.Direction).UP\n    }\n}, $bb9ae9d90429a70d$var$MoveSelectionDownShortcut = {\n    id: $bb9ae9d90429a70d$export$bb98a1a9da56437b.id,\n    binding: (0, $fL2Ug.KeyCode).ARROW_DOWN | (0, $fL2Ug.MetaKeys).SHIFT,\n    preconditions: $bb9ae9d90429a70d$export$9cb76b3207b29c5d,\n    staticParameters: {\n        direction: (0, $7yNYd.Direction).DOWN\n    }\n}, $bb9ae9d90429a70d$var$MoveSelectionLeftShortcut = {\n    id: $bb9ae9d90429a70d$export$bb98a1a9da56437b.id,\n    binding: (0, $fL2Ug.KeyCode).ARROW_LEFT | (0, $fL2Ug.MetaKeys).SHIFT,\n    preconditions: $bb9ae9d90429a70d$export$9cb76b3207b29c5d,\n    staticParameters: {\n        direction: (0, $7yNYd.Direction).LEFT\n    }\n}, $bb9ae9d90429a70d$var$MoveSelectionRightShortcut = {\n    id: $bb9ae9d90429a70d$export$bb98a1a9da56437b.id,\n    binding: (0, $fL2Ug.KeyCode).ARROW_RIGHT | (0, $fL2Ug.MetaKeys).SHIFT,\n    preconditions: $bb9ae9d90429a70d$export$9cb76b3207b29c5d,\n    staticParameters: {\n        direction: (0, $7yNYd.Direction).RIGHT\n    }\n}, $bb9ae9d90429a70d$var$SelectAllShortcut = {\n    id: $bb9ae9d90429a70d$export$b1260f52284457c5.id,\n    binding: (0, $fL2Ug.KeyCode).A | (0, $fL2Ug.MetaKeys).CTRL_COMMAND,\n    preconditions: /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((contextService)=>contextService.getContextValue((0, $7yNYd.FOCUSING_UNIVER_EDITOR)) && (contextService.getContextValue((0, $7yNYd.FOCUSING_DOC)) || contextService.getContextValue((0, $7yNYd.EDITOR_ACTIVATED))), \"preconditions\")\n};\nvar $bb9ae9d90429a70d$var$__defProp2 = Object.defineProperty, $bb9ae9d90429a70d$var$__getOwnPropDesc = Object.getOwnPropertyDescriptor, $bb9ae9d90429a70d$var$__decorateClass = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((decorators, target, key, kind)=>{\n    for(var result = kind > 1 ? void 0 : kind ? $bb9ae9d90429a70d$var$__getOwnPropDesc(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)(decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n    return kind && result && $bb9ae9d90429a70d$var$__defProp2(target, key, result), result;\n}, \"__decorateClass\"), $bb9ae9d90429a70d$var$__decorateParam = /* @__PURE__ */ $bb9ae9d90429a70d$var$__name((index, decorator)=>(target, key)=>decorator(target, key, index), \"__decorateParam\"), $bb9ae9d90429a70d$var$_a27;\nlet $bb9ae9d90429a70d$export$d5808d819c51512a = ($bb9ae9d90429a70d$var$_a27 = class extends (0, $7yNYd.Plugin) {\n    constructor(_config = $bb9ae9d90429a70d$var$defaultPluginConfig, _injector, _renderManagerSrv, _commandService, _logService, _configService){\n        super(), this._config = _config, this._injector = _injector, this._renderManagerSrv = _renderManagerSrv, this._commandService = _commandService, this._logService = _logService, this._configService = _configService;\n        const { menu: menu, ...rest } = this._config;\n        menu && this._configService.setConfig(\"menu\", menu, {\n            merge: !0\n        }), this._configService.setConfig($bb9ae9d90429a70d$var$PLUGIN_CONFIG_KEY, rest), this._initDependencies(_injector), this._initializeShortcut(), this._initCommand();\n    }\n    onReady() {\n        this._initRenderBasics(), this._markDocAsFocused();\n    }\n    onRendered() {\n        this._initUI(), this._initRenderModules();\n    }\n    _initCommand() {\n        [\n            $bb9ae9d90429a70d$export$b83c33c82ff96791,\n            $bb9ae9d90429a70d$export$887646cf81f0174e,\n            $bb9ae9d90429a70d$export$2ac5c6b1b1b0feee,\n            $bb9ae9d90429a70d$export$6f96a39ba8cb4fb2,\n            $bb9ae9d90429a70d$export$64d38e2980266dfc,\n            $bb9ae9d90429a70d$export$e70c98b3ed3cca1c,\n            $bb9ae9d90429a70d$export$73eebc63961c6386,\n            $bb9ae9d90429a70d$export$eced467326987bcd,\n            $bb9ae9d90429a70d$export$6723c87fd3465f36,\n            $bb9ae9d90429a70d$export$b6aad3c88c8d5d81,\n            $bb9ae9d90429a70d$export$61b23f520937a12f,\n            $bb9ae9d90429a70d$export$78c2c1a989d143a9,\n            $bb9ae9d90429a70d$export$7787f0bdf26d2ee3,\n            $bb9ae9d90429a70d$export$d752bba5c1df9b30,\n            $bb9ae9d90429a70d$export$d58fc04233d01bfb,\n            $bb9ae9d90429a70d$export$f0cad0406ddcd4fa,\n            $bb9ae9d90429a70d$export$bcbb37853c82bc7a,\n            $bb9ae9d90429a70d$export$6d896186514a9d62,\n            $bb9ae9d90429a70d$export$19ae6d3f93acfd2e,\n            $bb9ae9d90429a70d$export$d11f1a7d3b7026a9,\n            $bb9ae9d90429a70d$export$324478118aea2b96,\n            $bb9ae9d90429a70d$export$e87051556a6af02d,\n            $bb9ae9d90429a70d$export$baa537c1cdd3ac5a,\n            $bb9ae9d90429a70d$export$7ae277bfd4e4bfd6,\n            $bb9ae9d90429a70d$export$7a3dedab32c2d5a9,\n            $bb9ae9d90429a70d$export$d6d3a31584e4793b,\n            $bb9ae9d90429a70d$export$6e9dd45d49710046,\n            $bb9ae9d90429a70d$export$662c5ab3bad17c14,\n            $bb9ae9d90429a70d$export$8812c7b8ff337c70,\n            $bb9ae9d90429a70d$export$4e832bb83534614c,\n            $bb9ae9d90429a70d$export$c84c1b77b54bc20c,\n            $bb9ae9d90429a70d$export$d24aed1c729ddbeb,\n            $bb9ae9d90429a70d$export$5c48014be93c9100,\n            $bb9ae9d90429a70d$export$59ad16502cefbbfe,\n            $bb9ae9d90429a70d$export$e0b51bcab3a3cf9c,\n            $bb9ae9d90429a70d$export$f1900f4bfa5f38e0,\n            $bb9ae9d90429a70d$export$a24cf2b8bfb8aa0d,\n            $bb9ae9d90429a70d$export$9460cec99108a171,\n            $bb9ae9d90429a70d$export$ec800041f6d17822,\n            $bb9ae9d90429a70d$export$d60059992825479d,\n            $bb9ae9d90429a70d$export$e2fd85e54fa7b941,\n            $bb9ae9d90429a70d$export$57d0a1299f7f4db8,\n            $bb9ae9d90429a70d$export$94e417ac7df3c302,\n            $bb9ae9d90429a70d$export$1f6473f08b3bd4f,\n            $bb9ae9d90429a70d$export$a2a53bf26cf288dd,\n            $bb9ae9d90429a70d$export$dfb9f80f41464abe,\n            $bb9ae9d90429a70d$export$29ccf42ee2e09c85,\n            $bb9ae9d90429a70d$export$234148d9524301cf,\n            $bb9ae9d90429a70d$export$e6da9cc4b65a2183,\n            $bb9ae9d90429a70d$var$DocParagraphSettingCommand,\n            $bb9ae9d90429a70d$export$b23e7be54cecd122,\n            $bb9ae9d90429a70d$export$c235cac640c1f2b3,\n            $bb9ae9d90429a70d$export$6a8c10d8a8594492,\n            $bb9ae9d90429a70d$export$ba4bc2e8402f82b3,\n            $bb9ae9d90429a70d$export$fdc76f9b34e96863,\n            $bb9ae9d90429a70d$export$b1260f52284457c5,\n            $bb9ae9d90429a70d$var$DocParagraphSettingPanelOperation,\n            $bb9ae9d90429a70d$export$12633081beeab12c,\n            $bb9ae9d90429a70d$export$bb98a1a9da56437b\n        ].forEach((e)=>{\n            this._commandService.registerCommand(e);\n        }), [\n            $bb9ae9d90429a70d$export$9f1a20871184dbfd,\n            $bb9ae9d90429a70d$export$f23b9559f1e5cf86,\n            $bb9ae9d90429a70d$export$c2cb6d04fe50d389\n        ].forEach((command)=>this.disposeWithMe(this._commandService.registerMultipleCommand(command)));\n    }\n    _initializeShortcut() {\n        [\n            $bb9ae9d90429a70d$var$MoveCursorUpShortcut,\n            $bb9ae9d90429a70d$var$MoveCursorDownShortcut,\n            $bb9ae9d90429a70d$var$MoveCursorRightShortcut,\n            $bb9ae9d90429a70d$var$MoveCursorLeftShortcut,\n            $bb9ae9d90429a70d$var$MoveSelectionUpShortcut,\n            $bb9ae9d90429a70d$var$MoveSelectionDownShortcut,\n            $bb9ae9d90429a70d$var$MoveSelectionLeftShortcut,\n            $bb9ae9d90429a70d$var$MoveSelectionRightShortcut,\n            $bb9ae9d90429a70d$var$SelectAllShortcut,\n            $bb9ae9d90429a70d$var$DeleteLeftShortcut,\n            $bb9ae9d90429a70d$var$DeleteRightShortcut,\n            $bb9ae9d90429a70d$var$BreakLineShortcut,\n            $bb9ae9d90429a70d$var$ShiftTabShortCut\n        ].forEach((shortcut)=>{\n            this._injector.get((0, $fL2Ug.IShortcutService)).registerShortcut(shortcut);\n        });\n    }\n    _initDependencies(injector) {\n        (0, $7yNYd.mergeOverrideWithDependencies)([\n            [\n                $bb9ae9d90429a70d$var$DocClipboardController\n            ],\n            [\n                $bb9ae9d90429a70d$var$DocEditorBridgeController\n            ],\n            // Controller\n            [\n                $bb9ae9d90429a70d$export$ef4d9179ef3ec705\n            ],\n            [\n                $bb9ae9d90429a70d$var$DocAutoFormatController\n            ],\n            [\n                $bb9ae9d90429a70d$var$DocTableController\n            ],\n            [\n                $bb9ae9d90429a70d$var$DocMoveCursorController\n            ],\n            [\n                $bb9ae9d90429a70d$var$AppUIController\n            ],\n            [\n                $bb9ae9d90429a70d$var$DocParagraphSettingController\n            ],\n            // Services\n            [\n                $bb9ae9d90429a70d$export$6b47ccaaccf9c11f,\n                {\n                    useClass: $bb9ae9d90429a70d$var$DocClipboardService\n                }\n            ],\n            [\n                $bb9ae9d90429a70d$export$928598871e94e5df\n            ],\n            [\n                $bb9ae9d90429a70d$export$c7516c8e4c4bc9a0\n            ],\n            [\n                $bb9ae9d90429a70d$export$cc3d72a47d4cd6e3\n            ],\n            [\n                $bb9ae9d90429a70d$export$a1c6e22fe3cdf060\n            ]\n        ], this._config.override).forEach((d)=>injector.add(d));\n    }\n    _markDocAsFocused() {\n        const currentService = this._injector.get((0, $7yNYd.IUniverInstanceService)), editorService = this._injector.get((0, $fL2Ug.IEditorService));\n        try {\n            const doc = currentService.getCurrentUnitForType((0, $7yNYd.UniverInstanceType).UNIVER_DOC);\n            if (!doc) return;\n            const id = doc.getUnitId();\n            editorService.isEditor(id) || currentService.focusUnit(doc.getUnitId());\n        } catch (err) {\n            this._logService.warn(err);\n        }\n    }\n    _initUI() {\n        this._injector.get($bb9ae9d90429a70d$var$AppUIController);\n    }\n    _initRenderBasics() {\n        [\n            // Services.\n            [\n                (0, $7AR1b.DocSkeletonManagerService)\n            ],\n            [\n                $bb9ae9d90429a70d$export$6dc2db33d8a277cd\n            ],\n            [\n                (0, $7AR1b.DocInterceptorService)\n            ],\n            [\n                $bb9ae9d90429a70d$var$DocPageLayoutService\n            ],\n            [\n                $bb9ae9d90429a70d$export$72a0cb80dc10dcf\n            ],\n            // Controllers.\n            [\n                $bb9ae9d90429a70d$export$321e75563c26d788\n            ],\n            [\n                $bb9ae9d90429a70d$var$DocZoomRenderController\n            ]\n        ].forEach((m2)=>{\n            this._renderManagerSrv.registerRenderModule((0, $7yNYd.UniverInstanceType).UNIVER_DOC, m2);\n        });\n    }\n    _initRenderModules() {\n        [\n            // Services\n            [\n                $bb9ae9d90429a70d$export$1e5a6f8f312f65d4\n            ],\n            // Controllers.\n            [\n                $bb9ae9d90429a70d$export$8eff10ad7001c373\n            ],\n            [\n                $bb9ae9d90429a70d$var$DocSelectionRenderController\n            ],\n            [\n                $bb9ae9d90429a70d$var$DocHeaderFooterController\n            ],\n            [\n                $bb9ae9d90429a70d$var$DocResizeRenderController\n            ],\n            [\n                $bb9ae9d90429a70d$var$DocContextMenuRenderController\n            ],\n            [\n                $bb9ae9d90429a70d$var$DocChecklistRenderController\n            ],\n            [\n                $bb9ae9d90429a70d$var$DocClipboardController\n            ],\n            [\n                $bb9ae9d90429a70d$var$DocInputController\n            ],\n            [\n                $bb9ae9d90429a70d$var$DocIMEInputController\n            ],\n            [\n                $bb9ae9d90429a70d$var$DocEditorBridgeController\n            ]\n        ].forEach((m2)=>{\n            this._renderManagerSrv.registerRenderModule((0, $7yNYd.UniverInstanceType).UNIVER_DOC, m2);\n        });\n    }\n}, $bb9ae9d90429a70d$var$__name($bb9ae9d90429a70d$var$_a27, \"UniverDocsUIPlugin\"), $bb9ae9d90429a70d$var$__publicField($bb9ae9d90429a70d$var$_a27, \"pluginName\", $bb9ae9d90429a70d$export$aacb7588171917ce), $bb9ae9d90429a70d$var$__publicField($bb9ae9d90429a70d$var$_a27, \"type\", (0, $7yNYd.UniverInstanceType).UNIVER_DOC), $bb9ae9d90429a70d$var$_a27);\n$bb9ae9d90429a70d$export$d5808d819c51512a = $bb9ae9d90429a70d$var$__decorateClass([\n    $bb9ae9d90429a70d$var$__decorateParam(1, (0, $7yNYd.Inject)((0, $7yNYd.Injector))),\n    $bb9ae9d90429a70d$var$__decorateParam(2, (0, $3e0Iz.IRenderManagerService)),\n    $bb9ae9d90429a70d$var$__decorateParam(3, (0, $7yNYd.ICommandService)),\n    $bb9ae9d90429a70d$var$__decorateParam(4, (0, $7yNYd.ILogService)),\n    $bb9ae9d90429a70d$var$__decorateParam(5, (0, $7yNYd.IConfigService))\n], $bb9ae9d90429a70d$export$d5808d819c51512a);\n\n});\nparcelRegister(\"binOv\", function(module, exports) {\n\n$parcel$export(module.exports, \"bufferTime\", function () { return $8393d90e725f1304$export$d6b40c95035461c7; });\n\nvar $1a7ft = parcelRequire(\"1a7ft\");\n\nvar $e1VZ5 = parcelRequire(\"e1VZ5\");\n\nvar $jSzwf = parcelRequire(\"jSzwf\");\n\nvar $iNetn = parcelRequire(\"iNetn\");\n\nvar $hFN8R = parcelRequire(\"hFN8R\");\n\nvar $jaZjQ = parcelRequire(\"jaZjQ\");\n\nvar $4xvfD = parcelRequire(\"4xvfD\");\n\nvar $99A8K = parcelRequire(\"99A8K\");\nfunction $8393d90e725f1304$export$d6b40c95035461c7(bufferTimeSpan) {\n    var _a, _b;\n    var otherArgs = [];\n    for(var _i = 1; _i < arguments.length; _i++)otherArgs[_i - 1] = arguments[_i];\n    var scheduler = (_a = (0, $4xvfD.popScheduler)(otherArgs)) !== null && _a !== void 0 ? _a : (0, $jaZjQ.asyncScheduler);\n    var bufferCreationInterval = (_b = otherArgs[0]) !== null && _b !== void 0 ? _b : null;\n    var maxBufferSize = otherArgs[1] || Infinity;\n    return (0, $jSzwf.operate)(function(source, subscriber) {\n        var bufferRecords = [];\n        var restartOnEmit = false;\n        var emit = function(record) {\n            var buffer = record.buffer, subs = record.subs;\n            subs.unsubscribe();\n            (0, $hFN8R.arrRemove)(bufferRecords, record);\n            subscriber.next(buffer);\n            restartOnEmit && startBuffer();\n        };\n        var startBuffer = function() {\n            if (bufferRecords) {\n                var subs = new (0, $e1VZ5.Subscription)();\n                subscriber.add(subs);\n                var buffer = [];\n                var record_1 = {\n                    buffer: buffer,\n                    subs: subs\n                };\n                bufferRecords.push(record_1);\n                (0, $99A8K.executeSchedule)(subs, scheduler, function() {\n                    return emit(record_1);\n                }, bufferTimeSpan);\n            }\n        };\n        if (bufferCreationInterval !== null && bufferCreationInterval >= 0) (0, $99A8K.executeSchedule)(subscriber, scheduler, startBuffer, bufferCreationInterval, true);\n        else restartOnEmit = true;\n        startBuffer();\n        var bufferTimeSubscriber = (0, $iNetn.createOperatorSubscriber)(subscriber, function(value) {\n            var e_1, _a;\n            var recordsCopy = bufferRecords.slice();\n            try {\n                for(var recordsCopy_1 = (0, $1a7ft.__values)(recordsCopy), recordsCopy_1_1 = recordsCopy_1.next(); !recordsCopy_1_1.done; recordsCopy_1_1 = recordsCopy_1.next()){\n                    var record = recordsCopy_1_1.value;\n                    var buffer = record.buffer;\n                    buffer.push(value);\n                    maxBufferSize <= buffer.length && emit(record);\n                }\n            } catch (e_1_1) {\n                e_1 = {\n                    error: e_1_1\n                };\n            } finally{\n                try {\n                    if (recordsCopy_1_1 && !recordsCopy_1_1.done && (_a = recordsCopy_1.return)) _a.call(recordsCopy_1);\n                } finally{\n                    if (e_1) throw e_1.error;\n                }\n            }\n        }, function() {\n            while(bufferRecords === null || bufferRecords === void 0 ? void 0 : bufferRecords.length)subscriber.next(bufferRecords.shift().buffer);\n            bufferTimeSubscriber === null || bufferTimeSubscriber === void 0 || bufferTimeSubscriber.unsubscribe();\n            subscriber.complete();\n            subscriber.unsubscribe();\n        }, undefined, function() {\n            return bufferRecords = null;\n        });\n        source.subscribe(bufferTimeSubscriber);\n    });\n}\n\n});\n\n\n\n//# sourceMappingURL=es.917821ab.js.map\n","var __defProp = Object.defineProperty;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: !0, configurable: !0, writable: !0, value }) : obj[key] = value;\nvar __name = (target, value) => __defProp(target, \"name\", { value, configurable: !0 });\nvar __publicField = (obj, key, value) => __defNormalProp(obj, typeof key != \"symbol\" ? key + \"\" : key, value);\nimport { Disposable, toDisposable, UniverInstanceType, BuildTextUtils, Inject, IUniverInstanceService, TextX, JSONX, TextXActionType, getBodySlice, Tools, UpdateDocsAttributeType, ObjectRelativeFromH, ObjectRelativeFromV, CommandType, sequenceExecuteAsync, ICommandService, DataStreamTreeTokenType, PresetListType, BooleanNumber, normalizeBody, updateAttributeByInsert, TableCellHeightRule, TableSizeType, generateRandomId, TableAlignmentType, TableTextWrapType, MemoryCursor, PositionedObjectLayoutType, getCustomRangeSlice, getCustomDecorationSlice, LRUMap, BaselineOffset, ColorKit, skipParseTagNames, CustomRangeType, DataStreamTreeNodeType, createIdentifier, ILogService, SliceBodyType, DOCS_NORMAL_EDITOR_UNIT_ID_KEY, DOC_RANGE_TYPE, FOCUSING_DOC, EDITOR_ACTIVATED, RxDisposable, PRESET_LIST_TYPE, GridType, sortRulesFactory, HorizontalAlign, IUndoRedoService, LocaleService, RANGE_DIRECTION, COLORS, Rectangle, useDependency, DocumentFlavor, FOCUSING_UNIVER_EDITOR, FOCUSING_COMMON_DRAWINGS, FOCUSING_UNIVER_EDITOR_STANDALONE_SINGLE_MODE, useObservable, SpacingRule, OnLifecycle, LifecycleStages, ThemeService, connectInjector, Injector, IConfigService, IContextService, QuickListTypeMap, Direction, DisposableCollection, fromEventSubject, DEFAULT_EMPTY_DOCUMENT_VALUE, DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY, DOCS_ZEN_EDITOR_UNIT_ID_KEY, checkForSubstrings, isInternalEditorID, UndoCommandId, RedoCommandId, Plugin, mergeOverrideWithDependencies } from \"@univerjs/core\";\nimport { DocSelectionManagerService, RichTextEditingMutation, DocSkeletonManagerService, SetTextSelectionsOperation, DocStateEmitService, DocInterceptorService } from \"@univerjs/docs\";\nimport { IRenderManagerService, hasListGlyph, isIndentByGlyph, isFirstGlyph, getParagraphByGlyph, pixelToPt, ptToPixel, parseDataStreamToTree, getCharSpaceApply, getNumberUnitValue, Liquid, GlyphType, DocumentSkeletonPageType, getPageFromPath, getTableIdAndSliceIndex, NORMAL_TEXT_SELECTION_PLUGIN_STYLE, getColor, RegularPolygon, Rect, getOffsetRectForDom, ScrollTimer, CURSOR_TYPE, getSystemHighlightColor, Vector2, PageLayoutType, DocumentEditArea, Shape, Path, Viewport, ScrollBar, Layer, Documents, DocBackground, lineIterator, getLastLine, pxToNum, TRANSFORM_CHANGE_OBSERVABLE_TYPE } from \"@univerjs/engine-render\";\nimport { IClipboardInterfaceService, PLAIN_TEXT_CLIPBOARD_MIME_TYPE, HTML_CLIPBOARD_MIME_TYPE, CopyCommand, CutCommand, PasteCommand, IConfirmService, ILayoutService, ComponentManager, IEditorService, ISidebarService, KeyCode, MetaKeys, MenuItemType, getMenuHiddenObservable, FONT_FAMILY_LIST, FONT_SIZE_LIST, getHeaderFooterMenuHiddenObservable, RibbonStartGroup, ContextMenuPosition, ContextMenuGroup, FontFamily, FontFamilyItem, FontSize, BuiltInUIPart, IMenuManagerService, IUIPartsService, IShortcutService, ICanvasPopupService, IContextMenuService, SetEditorResizeOperation } from \"@univerjs/ui\";\nimport { Subject, BehaviorSubject, fromEvent, combineLatest, Observable, map as map$1, takeUntil, distinctUntilChanged, filter as filter$1, throttleTime, mergeMap, take, animationFrameScheduler } from \"rxjs\";\nimport * as require$$0 from \"react\";\nimport require$$0__default, { forwardRef, useRef, createElement, useState, useEffect, useMemo, useCallback } from \"react\";\nimport { Checkbox, InputNumber, Button, Slider, Tooltip, Select, ColorPicker } from \"@univerjs/design\";\nimport clsx from \"clsx\";\nimport { filter, bufferTime, map } from \"rxjs/operators\";\nvar __defProp$q = Object.defineProperty, __getOwnPropDesc$q = Object.getOwnPropertyDescriptor, __decorateClass$q = /* @__PURE__ */ __name((decorators, target, key, kind) => {\n  for (var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$q(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)\n    (decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n  return kind && result && __defProp$q(target, key, result), result;\n}, \"__decorateClass$q\"), __decorateParam$q = /* @__PURE__ */ __name((index, decorator) => (target, key) => decorator(target, key, index), \"__decorateParam$q\");\nfunction getParagraphsInRange$1(activeRange, paragraphs) {\n  var _a28, _b;\n  const { startOffset, endOffset } = activeRange, results = [];\n  let start = -1;\n  for (let i = 0; i < paragraphs.length; i++) {\n    const paragraph = paragraphs[i], prevParagraph = paragraphs[i - 1], { startIndex } = paragraph;\n    startOffset > start && startOffset <= startIndex || endOffset > start && endOffset <= startIndex ? results.push({\n      ...paragraph,\n      paragraphStart: ((_a28 = prevParagraph == null ? void 0 : prevParagraph.startIndex) != null ? _a28 : -1) + 1,\n      paragraphEnd: paragraph.startIndex\n    }) : startIndex >= startOffset && startIndex <= endOffset && results.push({\n      ...paragraph,\n      paragraphStart: ((_b = prevParagraph == null ? void 0 : prevParagraph.startIndex) != null ? _b : -1) + 1,\n      paragraphEnd: paragraph.startIndex\n    }), start = startIndex;\n  }\n  return results;\n}\n__name(getParagraphsInRange$1, \"getParagraphsInRange$1\");\nvar _a;\nlet DocAutoFormatService = (_a = class extends Disposable {\n  constructor(_univerInstanceService, _textSelectionManagerService) {\n    super();\n    __publicField(this, \"_matches\", /* @__PURE__ */ new Map());\n    this._univerInstanceService = _univerInstanceService, this._textSelectionManagerService = _textSelectionManagerService;\n  }\n  registerAutoFormat(match) {\n    const matchList = this._matches.get(match.id);\n    return matchList ? (matchList.push(match), matchList.sort((a, b) => {\n      var _a28, _b;\n      return ((_a28 = b.priority) != null ? _a28 : 0) - ((_b = a.priority) != null ? _b : 0);\n    })) : this._matches.set(match.id, [match]), toDisposable(() => {\n      const matchList2 = this._matches.get(match.id);\n      if (matchList2) {\n        const index = matchList2.findIndex((i) => i === match);\n        index >= 0 && matchList2.splice(index, 1);\n      }\n    });\n  }\n  onAutoFormat(id, params) {\n    var _a28, _b, _c, _d, _e, _f;\n    const autoFormats = (_a28 = this._matches.get(id)) != null ? _a28 : [], unit = this._univerInstanceService.getCurrentUnitForType(UniverInstanceType.UNIVER_DOC), selection = this._textSelectionManagerService.getActiveTextRange();\n    if (unit && selection) {\n      const doc = unit.getSelfOrHeaderFooterModel(selection.segmentId), context = {\n        unit: doc,\n        selection,\n        isBody: !selection.segmentId,\n        paragraphs: getParagraphsInRange$1(selection, (_c = (_b = doc.getBody()) == null ? void 0 : _b.paragraphs) != null ? _c : []),\n        customRanges: BuildTextUtils.customRange.getCustomRangesInterestsWithRange(selection, (_e = (_d = doc.getBody()) == null ? void 0 : _d.customRanges) != null ? _e : []),\n        commandId: id,\n        commandParams: params\n      }, matched = autoFormats.find((i) => i.match(context));\n      return (_f = matched == null ? void 0 : matched.getMutations(context)) != null ? _f : [];\n    }\n    return [];\n  }\n}, __name(_a, \"DocAutoFormatService\"), _a);\nDocAutoFormatService = __decorateClass$q([\n  __decorateParam$q(0, IUniverInstanceService),\n  __decorateParam$q(1, Inject(DocSelectionManagerService))\n], DocAutoFormatService);\nconst DefaultToolbarConfig = {\n  undo: !0,\n  redo: !0,\n  // Undo redo\n  font: !0,\n  // 'font'\n  fontSize: !0,\n  // 'Font size'\n  bold: !0,\n  // 'Bold (Ctrl+B)'\n  italic: !0,\n  // 'Italic (Ctrl+I)'\n  strikethrough: !0,\n  // 'Strikethrough (Alt+Shift+5)'\n  underline: !0,\n  // 'Underline (Alt+Shift+6)'\n  textColor: !0,\n  // 'Text color'\n  fillColor: !0,\n  // 'Cell color'\n  horizontalAlignMode: !0,\n  // 'Horizontal alignment'\n  verticalAlignMode: !0,\n  // 'Vertical alignment'\n  textWrapMode: !0,\n  // 'Wrap mode'\n  textRotateMode: !0\n  // 'Text Rotation Mode'\n}, DefaultDocContainerConfig = {\n  outerLeft: !1,\n  outerRight: !1,\n  header: !0,\n  footer: !0,\n  innerLeft: !1,\n  innerRight: !1,\n  frozenHeaderLT: !1,\n  frozenHeaderRT: !1,\n  frozenHeaderLM: !1,\n  frozenContent: !1,\n  infoBar: !0,\n  toolbar: !0\n}, DOC_UI_PLUGIN_NAME = \"DOC_UI_PLUGIN\";\nvar DOCS_VIEW_KEY = /* @__PURE__ */ ((DOCS_VIEW_KEY2) => (DOCS_VIEW_KEY2.MAIN = \"__Document_Render_Main__\", DOCS_VIEW_KEY2.BACKGROUND = \"__Document_Render_Background__\", DOCS_VIEW_KEY2))(DOCS_VIEW_KEY || {}), VIEWPORT_KEY = /* @__PURE__ */ ((VIEWPORT_KEY2) => (VIEWPORT_KEY2.VIEW_MAIN = \"viewMain\", VIEWPORT_KEY2.VIEW_TOP = \"viewTop\", VIEWPORT_KEY2.VIEW_LEFT = \"viewLeft\", VIEWPORT_KEY2.VIEW_LEFT_TOP = \"viewLeftTop\", VIEWPORT_KEY2))(VIEWPORT_KEY || {});\nconst DOCS_COMPONENT_BACKGROUND_LAYER_INDEX = 0, DOCS_COMPONENT_MAIN_LAYER_INDEX = 2, DOCS_COMPONENT_HEADER_LAYER_INDEX = 4, DOCS_COMPONENT_DEFAULT_Z_INDEX = 10, NORMAL_TEXT_SELECTION_PLUGIN_NAME = \"normalTextSelectionPluginName\";\nfunction neoGetDocObject(renderContext) {\n  const { mainComponent, scene, engine, components } = renderContext, document2 = mainComponent, docBackground = components.get(DOCS_VIEW_KEY.BACKGROUND);\n  return {\n    document: document2,\n    docBackground,\n    scene,\n    engine\n  };\n}\n__name(neoGetDocObject, \"neoGetDocObject\");\nfunction getDocObject(univerInstanceService, renderManagerService) {\n  const documentModel = univerInstanceService.getCurrentUnitForType(UniverInstanceType.UNIVER_DOC);\n  if (!documentModel)\n    return null;\n  const unitId = documentModel.getUnitId(), currentRender = renderManagerService.getRenderById(unitId);\n  if (currentRender == null)\n    return;\n  const { mainComponent, scene, engine, components } = currentRender, document2 = mainComponent, docBackground = components.get(DOCS_VIEW_KEY.BACKGROUND);\n  return {\n    document: document2,\n    docBackground,\n    scene,\n    engine\n  };\n}\n__name(getDocObject, \"getDocObject\");\nfunction getDocObjectById(unitId, renderManagerService) {\n  const currentRender = renderManagerService.getRenderById(unitId);\n  if (currentRender == null)\n    return;\n  const { mainComponent, scene, engine, components } = currentRender, document2 = mainComponent, docBackground = components.get(DOCS_VIEW_KEY.BACKGROUND);\n  return {\n    document: document2,\n    docBackground,\n    scene,\n    engine\n  };\n}\n__name(getDocObjectById, \"getDocObjectById\");\nfunction addCustomDecorationFactory(param) {\n  const { unitId, ranges, id, type, segmentId } = param, doMutation = {\n    id: RichTextEditingMutation.id,\n    params: {\n      unitId,\n      actions: [],\n      textRanges: void 0\n    }\n  }, textX = new TextX(), jsonX = JSONX.getInstance();\n  let cursor = 0;\n  for (let i = 0; i < ranges.length; i++) {\n    const range = ranges[i], { startOffset: start, endOffset: end } = range;\n    start > 0 && textX.push({\n      t: TextXActionType.RETAIN,\n      len: start - cursor,\n      segmentId\n    }), textX.push({\n      t: TextXActionType.RETAIN,\n      body: {\n        dataStream: \"\",\n        customDecorations: [{\n          id,\n          type,\n          startIndex: 0,\n          endIndex: end - start - 1\n        }]\n      },\n      len: end - start,\n      segmentId\n    }), cursor = end;\n  }\n  return doMutation.params.actions = jsonX.editOp(textX.serialize()), doMutation;\n}\n__name(addCustomDecorationFactory, \"addCustomDecorationFactory\");\nfunction addCustomDecorationBySelectionFactory(accessor, param) {\n  const { segmentId, id, type } = param, docSelectionManagerService = accessor.get(DocSelectionManagerService), univerInstanceService = accessor.get(IUniverInstanceService), selections = docSelectionManagerService.getCurrentTextRanges();\n  if (!selections)\n    return !1;\n  const documentDataModel = univerInstanceService.getCurrentUnitForType(UniverInstanceType.UNIVER_DOC);\n  if (!documentDataModel)\n    return !1;\n  const body = documentDataModel.getBody(), unitId = documentDataModel.getUnitId();\n  return body ? addCustomDecorationFactory(\n    {\n      unitId,\n      ranges: selections,\n      id,\n      type,\n      segmentId\n    }\n  ) : !1;\n}\n__name(addCustomDecorationBySelectionFactory, \"addCustomDecorationBySelectionFactory\");\nfunction deleteCustomDecorationFactory(accessor, params) {\n  var _a28, _b;\n  const { unitId, id, segmentId } = params, documentDataModel = accessor.get(IUniverInstanceService).getUnit(unitId), body = documentDataModel == null ? void 0 : documentDataModel.getBody();\n  if (!documentDataModel || !body)\n    return !1;\n  const decorations = (_b = (_a28 = documentDataModel.getBody()) == null ? void 0 : _a28.customDecorations) == null ? void 0 : _b.filter((d) => d.id === id);\n  if (!(decorations != null && decorations.length))\n    return !1;\n  const oldBodySlices = decorations.map((i) => getBodySlice(body, i.startIndex, i.endIndex + 1)), bodySlices = oldBodySlices.map((bodySlice) => {\n    var _a29;\n    const copy = Tools.deepClone(bodySlice);\n    return copy.customDecorations = (_a29 = copy.customDecorations) == null ? void 0 : _a29.filter((decoration) => decoration.id !== id), copy;\n  }), doMutation = {\n    id: RichTextEditingMutation.id,\n    params: {\n      unitId,\n      actions: [],\n      textRanges: void 0\n    }\n  }, textX = new TextX(), jsonX = JSONX.getInstance();\n  let cursor = 0;\n  return decorations.forEach((decoration, i) => {\n    const bodySlice = bodySlices[i], oldBody = oldBodySlices[i];\n    decoration.startIndex !== cursor && textX.push({\n      t: TextXActionType.RETAIN,\n      len: decoration.startIndex - cursor,\n      segmentId\n    }), cursor = decoration.startIndex, textX.push({\n      t: TextXActionType.RETAIN,\n      len: decoration.endIndex - decoration.startIndex + 1,\n      segmentId,\n      body: bodySlice,\n      oldBody,\n      coverType: UpdateDocsAttributeType.REPLACE\n    }), cursor = cursor + (decoration.endIndex - decoration.startIndex + 1);\n  }), doMutation.params.actions = jsonX.editOp(textX.serialize()), doMutation;\n}\n__name(deleteCustomDecorationFactory, \"deleteCustomDecorationFactory\");\nfunction getCommandSkeleton(accessor, unitId) {\n  var _a28;\n  return (_a28 = accessor.get(IRenderManagerService).getRenderById(unitId)) == null ? void 0 : _a28.with(DocSkeletonManagerService);\n}\n__name(getCommandSkeleton, \"getCommandSkeleton\");\nfunction getRichTextEditPath(docDataModel, segmentId = \"\") {\n  if (!segmentId)\n    return [\"body\"];\n  const { headers, footers } = docDataModel.getSnapshot();\n  if (headers == null && footers == null)\n    throw new Error(\"Document data model must have headers or footers when update by segment id\");\n  if ((headers == null ? void 0 : headers[segmentId]) != null)\n    return [\"headers\", segmentId, \"body\"];\n  if ((footers == null ? void 0 : footers[segmentId]) != null)\n    return [\"footers\", segmentId, \"body\"];\n  throw new Error(\"Segment id not found in headers or footers\");\n}\n__name(getRichTextEditPath, \"getRichTextEditPath\");\nfunction addCustomRangeFactory(accessor, param, body) {\n  const { unitId, segmentId } = param, documentDataModel = accessor.get(IUniverInstanceService).getUnit(unitId);\n  if (!documentDataModel)\n    return !1;\n  const doMutation = {\n    id: RichTextEditingMutation.id,\n    params: {\n      unitId: param.unitId,\n      actions: [],\n      textRanges: void 0\n    }\n  }, jsonX = JSONX.getInstance(), textX = BuildTextUtils.customRange.add({ ...param, body });\n  if (!textX)\n    return !1;\n  const path = getRichTextEditPath(documentDataModel, segmentId);\n  return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), doMutation;\n}\n__name(addCustomRangeFactory, \"addCustomRangeFactory\");\nfunction addCustomRangeBySelectionFactory(accessor, param) {\n  const { rangeId, rangeType, wholeEntity, properties, unitId, selection: propSelection } = param, docSelectionManagerService = accessor.get(DocSelectionManagerService), univerInstanceService = accessor.get(IUniverInstanceService), selection = propSelection != null ? propSelection : docSelectionManagerService.getActiveTextRange(), segmentId = selection == null ? void 0 : selection.segmentId;\n  if (!selection)\n    return !1;\n  const documentDataModel = univerInstanceService.getUnit(unitId, UniverInstanceType.UNIVER_DOC);\n  if (!documentDataModel)\n    return !1;\n  const body = documentDataModel.getSelfOrHeaderFooterModel(selection.segmentId).getBody();\n  if (!body)\n    return !1;\n  const { startOffset, endOffset } = BuildTextUtils.selection.normalizeSelection(selection), textX = BuildTextUtils.customRange.add({\n    range: { startOffset, endOffset, collapsed: startOffset === endOffset },\n    rangeId,\n    rangeType,\n    segmentId,\n    wholeEntity,\n    properties,\n    body\n  });\n  if (!textX)\n    return !1;\n  const jsonX = JSONX.getInstance(), doMutation = {\n    id: RichTextEditingMutation.id,\n    params: {\n      unitId,\n      actions: [],\n      textRanges: void 0\n    },\n    textX\n  }, path = getRichTextEditPath(documentDataModel, segmentId);\n  return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), doMutation;\n}\n__name(addCustomRangeBySelectionFactory, \"addCustomRangeBySelectionFactory\");\nfunction deleteCustomRangeFactory(accessor, params) {\n  const { unitId, segmentId, insert } = params, documentDataModel = accessor.get(IUniverInstanceService).getUnit(unitId);\n  if (!documentDataModel)\n    return !1;\n  const doMutation = {\n    id: RichTextEditingMutation.id,\n    params: {\n      unitId: params.unitId,\n      actions: [],\n      textRanges: void 0,\n      segmentId\n    }\n  }, jsonX = JSONX.getInstance(), textX = BuildTextUtils.customRange.delete(accessor, {\n    documentDataModel,\n    rangeId: params.rangeId,\n    insert,\n    segmentId\n  });\n  if (!textX)\n    return !1;\n  const path = getRichTextEditPath(documentDataModel, segmentId);\n  return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), doMutation;\n}\n__name(deleteCustomRangeFactory, \"deleteCustomRangeFactory\");\nfunction hasParagraphInTable(paragraph, tables) {\n  return tables.some((table) => paragraph.startIndex > table.startIndex && paragraph.startIndex < table.endIndex);\n}\n__name(hasParagraphInTable, \"hasParagraphInTable\");\nfunction replaceSelectionFactory(accessor, params) {\n  var _a28, _b, _c, _d;\n  const { unitId, body: insertBody, doc } = params;\n  let docDataModel = doc;\n  if (docDataModel || (docDataModel = accessor.get(IUniverInstanceService).getUnit(unitId)), !docDataModel)\n    return !1;\n  const segmentId = (_a28 = params.selection) == null ? void 0 : _a28.segmentId, body = (_b = docDataModel.getSelfOrHeaderFooterModel(segmentId)) == null ? void 0 : _b.getBody();\n  if (!body) return !1;\n  const docSelectionManagerService = accessor.get(DocSelectionManagerService), selection = (_c = params.selection) != null ? _c : docSelectionManagerService.getActiveTextRange();\n  if (!selection || !body)\n    return !1;\n  const textRanges = (_d = params.textRanges) != null ? _d : [{\n    startOffset: selection.startOffset + insertBody.dataStream.length,\n    endOffset: selection.startOffset + insertBody.dataStream.length,\n    collapsed: !0,\n    segmentId\n  }], textX = BuildTextUtils.selection.replace({\n    selection,\n    body: insertBody,\n    doc: docDataModel\n  });\n  if (!textX)\n    return !1;\n  const doMutation = {\n    id: RichTextEditingMutation.id,\n    params: {\n      unitId,\n      actions: [],\n      textRanges,\n      debounce: !0,\n      segmentId\n    },\n    textX\n  }, jsonX = JSONX.getInstance(), path = getRichTextEditPath(docDataModel, segmentId);\n  return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), doMutation;\n}\n__name(replaceSelectionFactory, \"replaceSelectionFactory\");\nfunction docDrawingPositionToTransform(position) {\n  return {\n    left: position.positionH.posOffset,\n    top: position.positionV.posOffset,\n    width: position.size.width,\n    height: position.size.height\n  };\n}\n__name(docDrawingPositionToTransform, \"docDrawingPositionToTransform\");\nfunction transformToDocDrawingPosition(transform, marginLeft = 0, marginTop = 0) {\n  return {\n    size: {\n      width: transform.width,\n      height: transform.height\n    },\n    positionH: {\n      relativeFrom: ObjectRelativeFromH.MARGIN,\n      posOffset: (transform.left || 0) - marginLeft\n    },\n    positionV: {\n      relativeFrom: ObjectRelativeFromV.PAGE,\n      posOffset: (transform.top || 0) - marginTop\n    },\n    angle: transform.angle || 0\n  };\n}\n__name(transformToDocDrawingPosition, \"transformToDocDrawingPosition\");\nconst TabCommandId = \"doc.command.tab\", TabCommand = {\n  id: TabCommandId,\n  type: CommandType.COMMAND,\n  async handler(accessor, params) {\n    const mutations = accessor.get(DocAutoFormatService).onAutoFormat(TabCommand.id, params);\n    return (await sequenceExecuteAsync(mutations, accessor.get(ICommandService))).result;\n  }\n}, AfterSpaceCommandId = \"doc.command.after-space\", AfterSpaceCommand = {\n  id: AfterSpaceCommandId,\n  type: CommandType.COMMAND,\n  async handler(accessor) {\n    const mutations = accessor.get(DocAutoFormatService).onAutoFormat(AfterSpaceCommand.id);\n    return (await sequenceExecuteAsync(mutations, accessor.get(ICommandService))).result;\n  }\n}, EnterCommand = {\n  id: \"doc.command.enter\",\n  type: CommandType.COMMAND,\n  async handler(accessor) {\n    const mutations = accessor.get(DocAutoFormatService).onAutoFormat(EnterCommand.id);\n    return (await sequenceExecuteAsync(mutations, accessor.get(ICommandService))).result;\n  }\n};\nvar DeleteDirection = /* @__PURE__ */ ((DeleteDirection2) => (DeleteDirection2[DeleteDirection2.LEFT = 0] = \"LEFT\", DeleteDirection2[DeleteDirection2.RIGHT = 1] = \"RIGHT\", DeleteDirection2))(DeleteDirection || {});\nconst EditorInsertTextCommandId = \"doc.command.insert-text\", InsertCommand = {\n  id: EditorInsertTextCommandId,\n  type: CommandType.COMMAND,\n  // eslint-disable-next-line max-lines-per-function\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    var _a28;\n    const commandService = accessor.get(ICommandService), { range, segmentId, body, unitId, cursorOffset, extendLastRange } = params, docSelectionManagerService = accessor.get(DocSelectionManagerService), docDataModel = accessor.get(IUniverInstanceService).getUnit(unitId, UniverInstanceType.UNIVER_DOC);\n    if (docDataModel == null)\n      return !1;\n    const activeRange = docSelectionManagerService.getActiveTextRange(), originBody = docDataModel.getSelfOrHeaderFooterModel((_a28 = activeRange == null ? void 0 : activeRange.segmentId) != null ? _a28 : \"\").getBody();\n    if (!originBody)\n      return !1;\n    const actualRange = extendLastRange ? BuildTextUtils.selection.getDeleteSelection(range, originBody) : BuildTextUtils.selection.getInsertSelection(range, originBody), { startOffset, collapsed } = actualRange, cursorMove = cursorOffset != null ? cursorOffset : body.dataStream.length, textRanges = [\n      {\n        startOffset: startOffset + cursorMove,\n        endOffset: startOffset + cursorMove,\n        style: activeRange == null ? void 0 : activeRange.style,\n        collapsed\n      }\n    ], doMutation = {\n      id: RichTextEditingMutation.id,\n      params: {\n        unitId,\n        actions: [],\n        textRanges,\n        debounce: !0\n      }\n    }, textX = new TextX(), jsonX = JSONX.getInstance();\n    if (collapsed)\n      startOffset > 0 && textX.push({\n        t: TextXActionType.RETAIN,\n        len: startOffset,\n        segmentId\n      });\n    else {\n      const { dos, retain } = BuildTextUtils.selection.getDeleteActions(actualRange, segmentId, 0, originBody);\n      textX.push(...dos), doMutation.params.textRanges = [{\n        startOffset: startOffset + cursorMove + retain,\n        endOffset: startOffset + cursorMove + retain,\n        collapsed\n      }];\n    }\n    textX.push({\n      t: TextXActionType.INSERT,\n      body,\n      len: body.dataStream.length,\n      line: 0,\n      segmentId\n    });\n    const path = getRichTextEditPath(docDataModel, segmentId);\n    return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n  }, \"handler\")\n}, DeleteCommand = {\n  id: \"doc.command.delete-text\",\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    var _a28;\n    const commandService = accessor.get(ICommandService), univerInstanceService = accessor.get(IUniverInstanceService), { range, segmentId, unitId, direction, len = 1 } = params, docDataModel = univerInstanceService.getUnit(unitId, UniverInstanceType.UNIVER_DOC), body = docDataModel == null ? void 0 : docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n    if (docDataModel == null || body == null)\n      return !1;\n    const { startOffset } = range, dataStream = body.dataStream, start = direction === DeleteDirection.LEFT ? startOffset - len : startOffset, end = start + len - 1, relativeCustomRanges = (_a28 = body.customRanges) == null ? void 0 : _a28.filter((customRange) => BuildTextUtils.customRange.isIntersecting(customRange.startIndex, customRange.endIndex, start, end)), toDeleteRanges = relativeCustomRanges == null ? void 0 : relativeCustomRanges.filter((customRange) => BuildTextUtils.customRange.shouldDeleteCustomRange(start, len, customRange, dataStream)), deleteIndexes = [];\n    for (let i = 0; i < len; i++)\n      deleteIndexes.push(start + i);\n    toDeleteRanges == null || toDeleteRanges.forEach((range2) => {\n      deleteIndexes.push(range2.startIndex, range2.endIndex);\n    }), deleteIndexes.sort((pre, aft) => pre - aft);\n    const deleteStart = deleteIndexes[0], doMutation = {\n      id: RichTextEditingMutation.id,\n      params: {\n        unitId,\n        actions: [],\n        textRanges: [{\n          startOffset: deleteStart,\n          endOffset: deleteStart,\n          collapsed: !0\n        }],\n        debounce: !0\n      }\n    }, textX = new TextX(), jsonX = JSONX.getInstance();\n    let cursor = 0;\n    for (let i = 0; i < deleteIndexes.length; i++) {\n      const deleteIndex = deleteIndexes[i];\n      deleteIndex - cursor > 0 && textX.push({\n        t: TextXActionType.RETAIN,\n        len: deleteIndex - cursor,\n        segmentId\n      }), textX.push({\n        t: TextXActionType.DELETE,\n        len: 1,\n        segmentId,\n        line: 0\n      }), cursor = deleteIndex + 1;\n    }\n    const path = getRichTextEditPath(docDataModel, segmentId);\n    return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n  }, \"handler\")\n}, UpdateCommand = {\n  id: \"doc.command.update-text\",\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    const { range, segmentId, updateBody, coverType, unitId, textRanges } = params, commandService = accessor.get(ICommandService), docDataModel = accessor.get(IUniverInstanceService).getCurrentUniverDocInstance();\n    if (docDataModel == null)\n      return !1;\n    const doMutation = {\n      id: RichTextEditingMutation.id,\n      params: {\n        unitId,\n        actions: [],\n        textRanges\n      }\n    }, textX = new TextX(), jsonX = JSONX.getInstance(), { startOffset, endOffset } = range;\n    textX.push({\n      t: TextXActionType.RETAIN,\n      len: startOffset,\n      segmentId\n    }), textX.push({\n      t: TextXActionType.RETAIN,\n      body: updateBody,\n      len: endOffset - startOffset,\n      segmentId,\n      coverType\n    });\n    const path = getRichTextEditPath(docDataModel, segmentId);\n    return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n  }, \"handler\")\n};\nfunction generateParagraphs(dataStream, prevParagraph) {\n  var _a28, _b;\n  const paragraphs = [];\n  for (let i = 0, len = dataStream.length; i < len; i++)\n    dataStream[i] === DataStreamTreeTokenType.PARAGRAPH && paragraphs.push({\n      startIndex: i\n    });\n  if (prevParagraph)\n    for (const paragraph of paragraphs)\n      prevParagraph.bullet && (paragraph.bullet = Tools.deepClone(prevParagraph.bullet), paragraph.bullet.listType === PresetListType.CHECK_LIST_CHECKED && (paragraph.bullet.listType = PresetListType.CHECK_LIST)), prevParagraph.paragraphStyle && (paragraph.paragraphStyle = Tools.deepClone(prevParagraph.paragraphStyle), ((_a28 = prevParagraph.bullet) == null ? void 0 : _a28.listType) === PresetListType.CHECK_LIST_CHECKED && (_b = paragraph.paragraphStyle) != null && _b.textStyle && (paragraph.paragraphStyle.textStyle.st = {\n        s: BooleanNumber.FALSE\n      }));\n  return paragraphs;\n}\n__name(generateParagraphs, \"generateParagraphs\");\nconst BreakLineCommand = {\n  id: \"doc.command.break-line\",\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name(async (accessor) => {\n    var _a28, _b;\n    const docSelectionManagerService = accessor.get(DocSelectionManagerService), univerInstanceService = accessor.get(IUniverInstanceService), commandService = accessor.get(ICommandService), activeTextRange = docSelectionManagerService.getActiveTextRange(), rectRanges = docSelectionManagerService.getCurrentRectRanges();\n    if (activeTextRange == null)\n      return !1;\n    if (rectRanges && rectRanges.length) {\n      const { startOffset: startOffset2 } = activeTextRange;\n      return docSelectionManagerService.replaceTextRanges([{\n        startOffset: startOffset2,\n        endOffset: startOffset2\n      }]), !0;\n    }\n    const { segmentId } = activeTextRange, docDataModel = univerInstanceService.getCurrentUniverDocInstance(), body = docDataModel == null ? void 0 : docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n    if (!docDataModel || !body)\n      return !1;\n    const unitId = docDataModel.getUnitId(), { startOffset, endOffset } = BuildTextUtils.selection.getInsertSelection(activeTextRange, body), prevParagraph = ((_a28 = body.paragraphs) != null ? _a28 : []).find((p2) => p2.startIndex >= startOffset);\n    if (prevParagraph && prevParagraph.startIndex > endOffset) {\n      const bodyAfter = normalizeBody(getBodySlice(body, endOffset, prevParagraph.startIndex + 1));\n      bodyAfter.customRanges = (_b = bodyAfter.customRanges) == null ? void 0 : _b.map(BuildTextUtils.customRange.copyCustomRange);\n      const deleteRange = {\n        startOffset,\n        endOffset: prevParagraph.startIndex + 1,\n        collapsed: !1\n      };\n      return updateAttributeByInsert(\n        bodyAfter,\n        {\n          dataStream: DataStreamTreeTokenType.PARAGRAPH,\n          paragraphs: generateParagraphs(DataStreamTreeTokenType.PARAGRAPH, prevParagraph)\n        },\n        1,\n        0\n      ), await commandService.executeCommand(InsertCommand.id, {\n        unitId,\n        body: bodyAfter,\n        range: deleteRange,\n        segmentId,\n        cursorOffset: 1\n      });\n    } else\n      return await commandService.executeCommand(InsertCommand.id, {\n        unitId,\n        body: {\n          dataStream: DataStreamTreeTokenType.PARAGRAPH,\n          paragraphs: generateParagraphs(DataStreamTreeTokenType.PARAGRAPH, prevParagraph)\n        },\n        range: activeTextRange,\n        segmentId\n      });\n  }, \"handler\")\n};\nvar INSERT_ROW_POSITION = /* @__PURE__ */ ((INSERT_ROW_POSITION2) => (INSERT_ROW_POSITION2[INSERT_ROW_POSITION2.ABOVE = 0] = \"ABOVE\", INSERT_ROW_POSITION2[INSERT_ROW_POSITION2.BELLOW = 1] = \"BELLOW\", INSERT_ROW_POSITION2))(INSERT_ROW_POSITION || {}), INSERT_COLUMN_POSITION = /* @__PURE__ */ ((INSERT_COLUMN_POSITION2) => (INSERT_COLUMN_POSITION2[INSERT_COLUMN_POSITION2.LEFT = 0] = \"LEFT\", INSERT_COLUMN_POSITION2[INSERT_COLUMN_POSITION2.RIGHT = 1] = \"RIGHT\", INSERT_COLUMN_POSITION2))(INSERT_COLUMN_POSITION || {});\nfunction genEmptyTable(rowCount, colCount) {\n  let dataStream = DataStreamTreeTokenType.TABLE_START;\n  const paragraphs = [], sectionBreaks = [];\n  for (let i = 0; i < rowCount; i++) {\n    dataStream += DataStreamTreeTokenType.TABLE_ROW_START;\n    for (let j = 0; j < colCount; j++)\n      dataStream += `${DataStreamTreeTokenType.TABLE_CELL_START}\\r\n${DataStreamTreeTokenType.TABLE_CELL_END}`, paragraphs.push({\n        startIndex: dataStream.length - 3,\n        paragraphStyle: {\n          spaceAbove: { v: 3 },\n          lineSpacing: 2,\n          spaceBelow: { v: 0 }\n        }\n      }), sectionBreaks.push({\n        startIndex: dataStream.length - 2\n      });\n    dataStream += DataStreamTreeTokenType.TABLE_ROW_END;\n  }\n  return dataStream += DataStreamTreeTokenType.TABLE_END, {\n    dataStream,\n    paragraphs,\n    sectionBreaks\n  };\n}\n__name(genEmptyTable, \"genEmptyTable\");\nfunction getEmptyTableCell() {\n  return {\n    margin: {\n      start: {\n        v: 10\n      },\n      end: {\n        v: 10\n      },\n      top: {\n        v: 5\n      },\n      bottom: {\n        v: 5\n      }\n    }\n  };\n}\n__name(getEmptyTableCell, \"getEmptyTableCell\");\nfunction getEmptyTableRow(col) {\n  const tableCell = getEmptyTableCell();\n  return {\n    tableCells: [...new Array(col).fill(null).map(() => Tools.deepClone(tableCell))],\n    trHeight: {\n      val: { v: 30 },\n      hRule: TableCellHeightRule.AUTO\n    }\n  };\n}\n__name(getEmptyTableRow, \"getEmptyTableRow\");\nfunction getTableColumn(width) {\n  return {\n    size: {\n      type: TableSizeType.SPECIFIED,\n      width: {\n        v: width\n      }\n    }\n  };\n}\n__name(getTableColumn, \"getTableColumn\");\nfunction genTableSource(rowCount, colCount, pageContentWidth) {\n  const tableColumn = getTableColumn(pageContentWidth / colCount), tableRow = getEmptyTableRow(colCount), tableRows = [...new Array(rowCount).fill(null).map(() => Tools.deepClone(tableRow))], tableColumns = [...new Array(colCount).fill(null).map(() => Tools.deepClone(tableColumn))], tableId = generateRandomId(6);\n  return {\n    tableRows,\n    tableColumns,\n    tableId,\n    align: TableAlignmentType.START,\n    indent: {\n      v: 0\n    },\n    textWrap: TableTextWrapType.NONE,\n    position: {\n      positionH: {\n        relativeFrom: ObjectRelativeFromH.PAGE,\n        posOffset: 0\n      },\n      positionV: {\n        relativeFrom: ObjectRelativeFromV.PAGE,\n        posOffset: 0\n      }\n    },\n    dist: {\n      distB: 0,\n      distL: 0,\n      distR: 0,\n      distT: 0\n    },\n    cellMargin: {\n      start: {\n        v: 10\n      },\n      end: {\n        v: 10\n      },\n      top: {\n        v: 5\n      },\n      bottom: {\n        v: 5\n      }\n    },\n    size: {\n      type: TableSizeType.UNSPECIFIED,\n      width: {\n        v: pageContentWidth\n      }\n    }\n  };\n}\n__name(genTableSource, \"genTableSource\");\nfunction getRangeInfoFromRanges(textRange, rectRanges) {\n  if (!textRange && !rectRanges)\n    return null;\n  if (rectRanges && rectRanges.length > 0) {\n    let startOffset = Number.POSITIVE_INFINITY, endOffset = Number.NEGATIVE_INFINITY;\n    const segmentId = \"\";\n    for (const rectRange of rectRanges) {\n      const { startOffset: st, endOffset: ed, segmentId: sid } = rectRange;\n      st == null || ed == null || sid == null || (startOffset = Math.min(startOffset, st), endOffset = Math.max(endOffset, ed));\n    }\n    if (Number.isFinite(startOffset) && Number.isFinite(endOffset))\n      return {\n        startOffset,\n        endOffset,\n        segmentId\n      };\n  } else if (textRange) {\n    const { startOffset, endOffset, segmentId } = textRange;\n    return startOffset == null || endOffset == null || segmentId == null ? null : {\n      startOffset,\n      endOffset,\n      segmentId\n    };\n  }\n}\n__name(getRangeInfoFromRanges, \"getRangeInfoFromRanges\");\nfunction getInsertRowBody(col) {\n  let dataStream = DataStreamTreeTokenType.TABLE_ROW_START;\n  const paragraphs = [], sectionBreaks = [];\n  for (let i = 0; i < col; i++)\n    dataStream += `${DataStreamTreeTokenType.TABLE_CELL_START}\\r\n${DataStreamTreeTokenType.TABLE_CELL_END}`, paragraphs.push({\n      startIndex: dataStream.length - 3,\n      paragraphStyle: {\n        spaceAbove: { v: 3 },\n        lineSpacing: 2,\n        spaceBelow: { v: 0 }\n      }\n    }), sectionBreaks.push({\n      startIndex: dataStream.length - 2\n    });\n  return dataStream += DataStreamTreeTokenType.TABLE_ROW_END, {\n    dataStream,\n    paragraphs,\n    sectionBreaks\n  };\n}\n__name(getInsertRowBody, \"getInsertRowBody\");\nfunction getInsertColumnBody() {\n  const dataStream = `${DataStreamTreeTokenType.TABLE_CELL_START}\\r\n${DataStreamTreeTokenType.TABLE_CELL_END}`, paragraphs = [], sectionBreaks = [];\n  return paragraphs.push({\n    startIndex: 1,\n    paragraphStyle: {\n      spaceAbove: { v: 3 },\n      lineSpacing: 2,\n      spaceBelow: { v: 0 }\n    }\n  }), sectionBreaks.push({\n    startIndex: 2\n  }), {\n    dataStream,\n    paragraphs,\n    sectionBreaks\n  };\n}\n__name(getInsertColumnBody, \"getInsertColumnBody\");\nfunction getInsertRowActionsParams(rangeInfo, position, viewModel) {\n  var _a28, _b, _c;\n  const { startOffset, endOffset, segmentId } = rangeInfo, vm = viewModel.getSelfOrHeaderFooterViewModel(segmentId), index = position === 0 ? startOffset : endOffset;\n  let tableRow = null;\n  const tableId = (_c = (_b = (_a28 = viewModel.getBody()) == null ? void 0 : _a28.tables) == null ? void 0 : _b.find((t) => index >= t.startIndex && index <= t.endIndex)) == null ? void 0 : _c.tableId;\n  let rowIndex = 0;\n  for (const section of vm.children) {\n    for (const paragraph of section.children) {\n      const { children } = paragraph, table = children[0];\n      if (table) {\n        for (const row of table.children)\n          if (row.startIndex <= index && index <= row.endIndex) {\n            rowIndex = table.children.indexOf(row), tableRow = row;\n            break;\n          }\n      }\n      if (tableRow)\n        break;\n    }\n    if (tableRow)\n      break;\n  }\n  return tableRow == null || tableId == null ? null : {\n    offset: position === 0 ? tableRow.startIndex : tableRow.endIndex + 1,\n    colCount: tableRow.children.length,\n    tableId,\n    insertRowIndex: position === 0 ? rowIndex : rowIndex + 1\n  };\n}\n__name(getInsertRowActionsParams, \"getInsertRowActionsParams\");\nfunction getInsertColumnActionsParams(rangeInfo, position, viewModel) {\n  var _a28, _b, _c;\n  const { startOffset, endOffset, segmentId } = rangeInfo, vm = viewModel.getSelfOrHeaderFooterViewModel(segmentId), index = position === 0 ? startOffset : endOffset, tableId = (_c = (_b = (_a28 = viewModel.getBody()) == null ? void 0 : _a28.tables) == null ? void 0 : _b.find((t) => index >= t.startIndex && index <= t.endIndex)) == null ? void 0 : _c.tableId, offsets = [];\n  let table = null, columnIndex = -1;\n  for (const section of vm.children) {\n    for (const paragraph of section.children) {\n      const { children } = paragraph, tableNode = children[0];\n      if (tableNode) {\n        if (index < tableNode.startIndex || index > tableNode.endIndex)\n          continue;\n        table = tableNode;\n        for (const row of tableNode.children) {\n          for (const cell of row.children) {\n            const cellIndex = row.children.indexOf(cell);\n            if (index >= cell.startIndex && index <= cell.endIndex) {\n              columnIndex = cellIndex;\n              break;\n            }\n          }\n          if (columnIndex !== -1)\n            break;\n        }\n      }\n      if (table)\n        break;\n    }\n    if (table)\n      break;\n  }\n  if (table == null || tableId == null || columnIndex === -1)\n    return null;\n  let cursor = 0;\n  for (const row of table.children) {\n    const cell = row.children[columnIndex], insertIndex = position === 0 ? cell.startIndex : cell.endIndex + 1;\n    offsets.push(insertIndex - cursor), cursor = insertIndex;\n  }\n  return {\n    offsets,\n    tableId,\n    columnIndex,\n    rowCount: table.children.length\n  };\n}\n__name(getInsertColumnActionsParams, \"getInsertColumnActionsParams\");\nfunction getColumnWidths(pageWidth, tableColumns, insertColumnIndex) {\n  const widths = [];\n  let newColWidth = tableColumns[insertColumnIndex].size.width.v, totalWidth = 0;\n  for (let i = 0; i < tableColumns.length; i++)\n    totalWidth += tableColumns[i].size.width.v;\n  totalWidth += newColWidth;\n  for (let i = 0; i < tableColumns.length; i++)\n    widths.push(tableColumns[i].size.width.v / totalWidth * pageWidth);\n  return newColWidth = newColWidth / totalWidth * pageWidth, {\n    widths,\n    newColWidth\n  };\n}\n__name(getColumnWidths, \"getColumnWidths\");\nfunction getDeleteRowsActionsParams(rangeInfo, viewModel) {\n  var _a28, _b, _c;\n  const { startOffset, endOffset, segmentId } = rangeInfo, vm = viewModel.getSelfOrHeaderFooterViewModel(segmentId), tableId = (_c = (_b = (_a28 = viewModel.getBody()) == null ? void 0 : _a28.tables) == null ? void 0 : _b.find((t) => startOffset >= t.startIndex && endOffset <= t.endIndex)) == null ? void 0 : _c.tableId, rowIndexes = [];\n  let offset = -1, len = 0, cursor = -1, selectWholeTable = !1;\n  for (const section of vm.children) {\n    for (const paragraph of section.children) {\n      const { children } = paragraph, table = children[0];\n      if (table) {\n        if (startOffset < table.startIndex || endOffset > table.endIndex)\n          continue;\n        cursor = table.startIndex + 3;\n        for (const row of table.children) {\n          const rowIndex = table.children.indexOf(row), { startIndex, endIndex } = row;\n          startOffset >= startIndex && startOffset <= endIndex ? (offset = startIndex, rowIndexes.push(rowIndex), len += endIndex - startIndex + 1) : (startIndex > startOffset && endIndex < endOffset || endOffset >= startIndex && endOffset <= endIndex) && (rowIndexes.push(rowIndex), len += endIndex - startIndex + 1), rowIndexes.length === table.children.length && (selectWholeTable = !0);\n        }\n      }\n      if (rowIndexes.length)\n        break;\n    }\n    if (rowIndexes.length)\n      break;\n  }\n  return tableId == null || rowIndexes.length === 0 ? null : {\n    tableId,\n    rowIndexes,\n    offset,\n    len,\n    cursor,\n    selectWholeTable\n  };\n}\n__name(getDeleteRowsActionsParams, \"getDeleteRowsActionsParams\");\nfunction getDeleteColumnsActionParams(rangeInfo, viewModel) {\n  var _a28, _b, _c;\n  const { startOffset, endOffset, segmentId } = rangeInfo, vm = viewModel.getSelfOrHeaderFooterViewModel(segmentId), tableId = (_c = (_b = (_a28 = viewModel.getBody()) == null ? void 0 : _a28.tables) == null ? void 0 : _b.find((t) => startOffset >= t.startIndex && endOffset <= t.endIndex)) == null ? void 0 : _c.tableId, offsets = [];\n  let table = null;\n  const columnIndexes = [];\n  let cursor = -1, startColumnIndex = -1, endColumnIndex = -1;\n  for (const section of vm.children) {\n    for (const paragraph of section.children) {\n      const { children } = paragraph, tableNode = children[0];\n      if (tableNode) {\n        if (startOffset < tableNode.startIndex || endOffset > tableNode.endIndex)\n          continue;\n        table = tableNode;\n        for (const row of tableNode.children)\n          for (const cell of row.children) {\n            const cellIndex = row.children.indexOf(cell);\n            startOffset >= cell.startIndex && startOffset <= cell.endIndex && (startColumnIndex = cellIndex), endOffset >= cell.startIndex && endOffset <= cell.endIndex && (endColumnIndex = cellIndex);\n          }\n      }\n      if (table)\n        break;\n    }\n    if (table)\n      break;\n  }\n  if (table == null || tableId == null)\n    return null;\n  for (let i = startColumnIndex; i <= endColumnIndex; i++)\n    columnIndexes.push(i);\n  let delta = 0;\n  for (const row of table.children) {\n    const startCell = row.children[startColumnIndex], endCell = row.children[endColumnIndex];\n    offsets.push({\n      retain: startCell.startIndex - delta,\n      delete: endCell.endIndex - startCell.startIndex + 1\n    }), delta = endCell.endIndex + 1;\n  }\n  return cursor = table.startIndex + 3, {\n    offsets,\n    tableId,\n    columnIndexes,\n    cursor,\n    selectWholeTable: columnIndexes.length === table.children[0].children.length,\n    rowCount: table.children.length\n  };\n}\n__name(getDeleteColumnsActionParams, \"getDeleteColumnsActionParams\");\nfunction getDeleteTableActionParams(rangeInfo, viewModel) {\n  var _a28, _b, _c;\n  const { startOffset, endOffset, segmentId } = rangeInfo, vm = viewModel.getSelfOrHeaderFooterViewModel(segmentId), tableId = (_c = (_b = (_a28 = viewModel.getBody()) == null ? void 0 : _a28.tables) == null ? void 0 : _b.find((t) => startOffset >= t.startIndex && endOffset <= t.endIndex)) == null ? void 0 : _c.tableId;\n  let offset = -1, len = 0, cursor = -1;\n  for (const section of vm.children) {\n    for (const paragraph of section.children) {\n      const { children } = paragraph, table = children[0];\n      if (table) {\n        if (startOffset < table.startIndex || endOffset > table.endIndex)\n          continue;\n        offset = table.startIndex, len = table.endIndex - table.startIndex + 1, cursor = table.startIndex;\n      }\n      if (table)\n        break;\n    }\n    if (len > 0)\n      break;\n  }\n  return tableId == null ? null : {\n    tableId,\n    offset,\n    len,\n    cursor\n  };\n}\n__name(getDeleteTableActionParams, \"getDeleteTableActionParams\");\nfunction getDeleteRowContentActionParams(rangeInfo, viewModel) {\n  var _a28, _b, _c;\n  const { startOffset, endOffset, segmentId } = rangeInfo, vm = viewModel.getSelfOrHeaderFooterViewModel(segmentId), tableId = (_c = (_b = (_a28 = viewModel.getBody()) == null ? void 0 : _a28.tables) == null ? void 0 : _b.find((t) => startOffset >= t.startIndex && endOffset <= t.endIndex)) == null ? void 0 : _c.tableId, offsets = [];\n  let table = null, cursor = -1, rowIndex = -1, startColumnIndex = -1, endColumnIndex = -1;\n  for (const section of vm.children) {\n    for (const paragraph of section.children) {\n      const { children } = paragraph, tableNode = children[0];\n      if (tableNode) {\n        if (startOffset < tableNode.startIndex || endOffset > tableNode.endIndex)\n          continue;\n        table = tableNode;\n        for (const row2 of tableNode.children) {\n          const rIndex = tableNode.children.indexOf(row2);\n          for (const cell of row2.children) {\n            const cellIndex = row2.children.indexOf(cell);\n            startOffset >= cell.startIndex && startOffset <= cell.endIndex && (rowIndex = rIndex, startColumnIndex = cellIndex), endOffset >= cell.startIndex && endOffset <= cell.endIndex && (endColumnIndex = cellIndex);\n          }\n        }\n      }\n      if (table)\n        break;\n    }\n    if (table)\n      break;\n  }\n  if (table == null || tableId == null || rowIndex === -1)\n    return null;\n  const row = table.children[rowIndex];\n  for (let i = startColumnIndex; i <= endColumnIndex; i++) {\n    const cell = row.children[i];\n    offsets.push({\n      retain: cell.startIndex + 1,\n      delete: cell.endIndex - cell.startIndex - 3\n    });\n  }\n  return cursor = table.startIndex + 3, {\n    offsets,\n    tableId,\n    cursor,\n    rowCount: table.children.length\n  };\n}\n__name(getDeleteRowContentActionParams, \"getDeleteRowContentActionParams\");\nvar CellPosition = /* @__PURE__ */ ((CellPosition2) => (CellPosition2[CellPosition2.NEXT = 0] = \"NEXT\", CellPosition2[CellPosition2.PREV = 1] = \"PREV\", CellPosition2))(CellPosition || {});\nfunction getCellOffsets(viewModel, range, position) {\n  const { startOffset } = range;\n  let targetTable = null;\n  for (const section of viewModel.children) {\n    for (const paragraph of section.children) {\n      const table = paragraph.children[0];\n      if (table && startOffset > table.startIndex && startOffset < table.endIndex) {\n        targetTable = table;\n        break;\n      }\n    }\n    if (targetTable)\n      break;\n  }\n  if (targetTable == null)\n    return null;\n  let cellIndex = -1, rowIndex = -1, targetRow = null;\n  for (const row of targetTable.children) {\n    for (const cell of row.children)\n      if (startOffset > cell.startIndex && startOffset < cell.endIndex) {\n        cellIndex = row.children.indexOf(cell), rowIndex = targetTable.children.indexOf(row), targetRow = row;\n        break;\n      }\n    if (cellIndex > -1)\n      break;\n  }\n  if (cellIndex === -1 || rowIndex === -1 || targetRow == null)\n    return null;\n  let newCell = null;\n  if (position === 0) {\n    if (newCell = targetRow.children[cellIndex + 1], !newCell) {\n      const nextRow = targetTable.children[rowIndex + 1];\n      nextRow && (newCell = nextRow.children[0]);\n    }\n  } else if (newCell = targetRow.children[cellIndex - 1], !newCell) {\n    const prevRow = targetTable.children[rowIndex - 1];\n    prevRow && (newCell = prevRow.children[prevRow.children.length - 1]);\n  }\n  if (newCell) {\n    const { startIndex, endIndex } = newCell;\n    return {\n      startOffset: startIndex + 1,\n      endOffset: endIndex - 2\n    };\n  }\n}\n__name(getCellOffsets, \"getCellOffsets\");\nfunction getCustomBlockIdsInSelections(body, selections) {\n  const customBlockIds = [], { customBlocks = [] } = body;\n  for (const selection of selections) {\n    const { startOffset, endOffset } = selection;\n    if (!(startOffset == null || endOffset == null))\n      for (const customBlock of customBlocks) {\n        const { startIndex } = customBlock;\n        startIndex >= startOffset && startIndex < endOffset && customBlockIds.push(customBlock.blockId);\n      }\n  }\n  return customBlockIds;\n}\n__name(getCustomBlockIdsInSelections, \"getCustomBlockIdsInSelections\");\nfunction hasRangeInTable(ranges) {\n  return ranges.some((range) => {\n    const { startNodePosition } = range;\n    return startNodePosition ? (startNodePosition == null ? void 0 : startNodePosition.path.indexOf(\"cells\")) > -1 : !1;\n  });\n}\n__name(hasRangeInTable, \"hasRangeInTable\");\nconst InnerPasteCommand = {\n  id: \"doc.command.inner-paste\",\n  type: CommandType.COMMAND,\n  // eslint-disable-next-line max-lines-per-function, complexity\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    var _a28, _b, _c, _d;\n    const { segmentId, textRanges, doc } = params, commandService = accessor.get(ICommandService), docSelectionManagerService = accessor.get(DocSelectionManagerService), univerInstanceService = accessor.get(IUniverInstanceService), selections = docSelectionManagerService.getCurrentTextRanges(), { body, tableSource, drawings } = doc;\n    if (!Array.isArray(selections) || selections.length === 0 || body == null)\n      return !1;\n    const docDataModel = univerInstanceService.getCurrentUniverDocInstance(), originBody = docDataModel == null ? void 0 : docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n    if (docDataModel == null || originBody == null)\n      return !1;\n    const unitId = docDataModel.getUnitId(), doMutation = {\n      id: RichTextEditingMutation.id,\n      params: {\n        unitId,\n        actions: [],\n        textRanges,\n        segmentId\n      }\n    }, memoryCursor = new MemoryCursor();\n    memoryCursor.reset();\n    const textX = new TextX(), jsonX = JSONX.getInstance(), rawActions = [], hasTable = !!((_a28 = body.tables) != null && _a28.length), hasCustomBlock = !!((_b = body.customBlocks) != null && _b.length);\n    if (hasTable && segmentId || hasTable && hasRangeInTable(selections))\n      return !1;\n    for (const selection of selections) {\n      const { startOffset, endOffset, collapsed } = selection, len = startOffset - memoryCursor.cursor, cloneBody = Tools.deepClone(body);\n      if (hasTable)\n        for (const t of cloneBody.tables) {\n          const { tableId: oldTableId } = t, tableId = Tools.generateRandomId(6);\n          t.tableId = tableId;\n          const table = Tools.deepClone(tableSource[oldTableId]);\n          table.tableId = tableId;\n          const action = jsonX.insertOp([\"tableSource\", tableId], table);\n          rawActions.push(action);\n        }\n      if (hasCustomBlock && drawings) {\n        const drawingLen = (_d = (_c = docDataModel.getSnapshot().drawingsOrder) == null ? void 0 : _c.length) != null ? _d : 0;\n        for (const block of cloneBody.customBlocks) {\n          const { blockId } = block, drawingId = Tools.generateRandomId(6);\n          block.blockId = drawingId;\n          const drawing = Tools.deepClone(drawings[blockId]);\n          drawing.drawingId = drawingId;\n          const action = jsonX.insertOp([\"drawings\", drawingId], drawing), orderAction = jsonX.insertOp([\"drawingsOrder\", drawingLen], drawingId);\n          rawActions.push(action), rawActions.push(orderAction);\n        }\n      }\n      if (collapsed)\n        textX.push({\n          t: TextXActionType.RETAIN,\n          len,\n          segmentId\n        });\n      else {\n        const { dos } = BuildTextUtils.selection.getDeleteActions(selection, segmentId, memoryCursor.cursor, originBody);\n        textX.push(...dos);\n      }\n      textX.push({\n        t: TextXActionType.INSERT,\n        body: cloneBody,\n        len: body.dataStream.length,\n        line: 0,\n        segmentId\n      }), memoryCursor.reset(), memoryCursor.moveCursor(endOffset);\n    }\n    const path = getRichTextEditPath(docDataModel, segmentId);\n    return rawActions.push(jsonX.editOp(textX.serialize(), path)), doMutation.params.actions = rawActions.reduce((acc, cur) => JSONX.compose(acc, cur), null), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n  }, \"handler\")\n};\nfunction getCutActionsFromTextRanges(selections, docDataModel, segmentId) {\n  var _a28, _b;\n  const originBody = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody(), textX = new TextX(), jsonX = JSONX.getInstance(), rawActions = [];\n  if (originBody == null)\n    return rawActions;\n  const memoryCursor = new MemoryCursor();\n  memoryCursor.reset();\n  for (const selection of selections) {\n    const { startOffset, endOffset, collapsed } = selection;\n    if (startOffset == null || endOffset == null)\n      continue;\n    const len = startOffset - memoryCursor.cursor;\n    collapsed ? textX.push({\n      t: TextXActionType.RETAIN,\n      len,\n      segmentId\n    }) : textX.push(...BuildTextUtils.selection.getDeleteExculdeLastLineBreakActions(selection, originBody, segmentId, memoryCursor.cursor, !1)), memoryCursor.reset(), memoryCursor.moveCursor(endOffset);\n  }\n  const path = getRichTextEditPath(docDataModel, segmentId);\n  rawActions.push(jsonX.editOp(textX.serialize(), path));\n  const removedCustomBlockIds = getCustomBlockIdsInSelections(originBody, selections), drawings = (_a28 = docDataModel.getDrawings()) != null ? _a28 : {}, drawingOrder = (_b = docDataModel.getDrawingsOrder()) != null ? _b : [], sortedRemovedCustomBlockIds = removedCustomBlockIds.sort((a, b) => drawingOrder.indexOf(a) > drawingOrder.indexOf(b) ? -1 : drawingOrder.indexOf(a) < drawingOrder.indexOf(b) ? 1 : 0);\n  if (sortedRemovedCustomBlockIds.length > 0)\n    for (const blockId of sortedRemovedCustomBlockIds) {\n      const drawing = drawings[blockId], drawingIndex = drawingOrder.indexOf(blockId);\n      if (drawing == null || drawingIndex < 0)\n        continue;\n      const removeDrawingAction = jsonX.removeOp([\"drawings\", blockId], drawing), removeDrawingOrderAction = jsonX.removeOp([\"drawingsOrder\", drawingIndex], blockId);\n      rawActions.push(removeDrawingAction), rawActions.push(removeDrawingOrderAction);\n    }\n  return rawActions.reduce((acc, cur) => JSONX.compose(acc, cur), null);\n}\n__name(getCutActionsFromTextRanges, \"getCutActionsFromTextRanges\");\nfunction getCutActionsFromRectRanges(ranges, docDataModel, viewModel, segmentId) {\n  const rawActions = [];\n  if (docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody() == null)\n    return rawActions;\n  const textX = new TextX(), jsonX = JSONX.getInstance(), memoryCursor = new MemoryCursor();\n  memoryCursor.reset();\n  for (const range of ranges) {\n    const { startOffset, endOffset, spanEntireRow, spanEntireTable } = range;\n    if (!(startOffset == null || endOffset == null))\n      if (spanEntireTable) {\n        const actionParams = getDeleteTableActionParams({ startOffset, endOffset, segmentId }, viewModel);\n        if (actionParams == null)\n          continue;\n        const { offset, len, tableId } = actionParams;\n        offset - memoryCursor.cursor > 0 && textX.push({\n          t: TextXActionType.RETAIN,\n          len: offset - memoryCursor.cursor,\n          segmentId\n        }), textX.push({\n          t: TextXActionType.DELETE,\n          len,\n          line: 0,\n          segmentId\n        });\n        const action = jsonX.removeOp([\"tableSource\", tableId]);\n        rawActions.push(action), memoryCursor.moveCursorTo(offset + len);\n      } else if (spanEntireRow) {\n        const actionParams = getDeleteRowsActionsParams({ startOffset, endOffset, segmentId }, viewModel);\n        if (actionParams == null)\n          continue;\n        const { offset, rowIndexes, len, tableId } = actionParams;\n        offset - memoryCursor.cursor > 0 && textX.push({\n          t: TextXActionType.RETAIN,\n          len: offset - memoryCursor.cursor,\n          segmentId\n        }), textX.push({\n          t: TextXActionType.DELETE,\n          len,\n          line: 0,\n          segmentId\n        });\n        for (const index of rowIndexes.reverse()) {\n          const action = jsonX.removeOp([\"tableSource\", tableId, \"tableRows\", index]);\n          rawActions.push(action);\n        }\n        memoryCursor.moveCursorTo(offset + len);\n      } else {\n        const actionParams = getDeleteRowContentActionParams({ startOffset, endOffset, segmentId }, viewModel);\n        if (actionParams == null)\n          continue;\n        const { offsets } = actionParams;\n        for (const offset of offsets) {\n          const { retain, delete: delLen } = offset;\n          retain - memoryCursor.cursor > 0 && textX.push({\n            t: TextXActionType.RETAIN,\n            len: retain - memoryCursor.cursor,\n            segmentId\n          }), textX.push({\n            t: TextXActionType.DELETE,\n            len: delLen,\n            line: 0,\n            segmentId\n          }), memoryCursor.moveCursorTo(retain + delLen);\n        }\n      }\n  }\n  const path = getRichTextEditPath(docDataModel, segmentId);\n  return rawActions.push(jsonX.editOp(textX.serialize(), path)), rawActions.reduce((acc, cur) => JSONX.compose(acc, cur), null);\n}\n__name(getCutActionsFromRectRanges, \"getCutActionsFromRectRanges\");\nfunction getCutActionsFromDocRanges(textRanges, rectRanges, docDataModel, viewModel, segmentId) {\n  let rawActions = [];\n  if (Array.isArray(textRanges) && (textRanges == null ? void 0 : textRanges.length) !== 0 && (rawActions = getCutActionsFromTextRanges(textRanges, docDataModel, segmentId)), Array.isArray(rectRanges) && (rectRanges == null ? void 0 : rectRanges.length) !== 0) {\n    const actions = getCutActionsFromRectRanges(rectRanges, docDataModel, viewModel, segmentId);\n    rawActions == null || rawActions.length === 0 ? rawActions = actions : rawActions = JSONX.compose(\n      rawActions,\n      JSONX.transform(actions, rawActions, \"right\")\n    );\n  }\n  return rawActions;\n}\n__name(getCutActionsFromDocRanges, \"getCutActionsFromDocRanges\");\nconst INNER_CUT_COMMAND_ID = \"doc.command.inner-cut\", CutContentCommand = {\n  id: INNER_CUT_COMMAND_ID,\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    var _a28, _b;\n    const { segmentId, textRanges } = params, commandService = accessor.get(ICommandService), docSelectionManagerService = accessor.get(DocSelectionManagerService), univerInstanceService = accessor.get(IUniverInstanceService), selections = (_a28 = params.selections) != null ? _a28 : docSelectionManagerService.getCurrentTextRanges(), rectRanges = docSelectionManagerService.getCurrentRectRanges();\n    if ((!Array.isArray(selections) || selections.length === 0) && (!Array.isArray(rectRanges) || rectRanges.length === 0))\n      return !1;\n    const unitId = (_b = univerInstanceService.getCurrentUniverDocInstance()) == null ? void 0 : _b.getUnitId();\n    if (!unitId)\n      return !1;\n    const docDataModel = univerInstanceService.getUniverDocInstance(unitId);\n    if (docDataModel == null)\n      return !1;\n    const docSkeletonManagerService = getCommandSkeleton(accessor, unitId);\n    if (docSkeletonManagerService == null)\n      return !1;\n    const viewModel = docSkeletonManagerService.getViewModel(), doMutation = {\n      id: RichTextEditingMutation.id,\n      params: {\n        unitId,\n        actions: [],\n        textRanges\n      }\n    };\n    return doMutation.params.actions = getCutActionsFromDocRanges(selections, rectRanges, docDataModel, viewModel, segmentId), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n  }, \"handler\")\n}, getDeleteSelection = BuildTextUtils.selection.getDeleteSelection, DeleteCustomBlockCommand = {\n  id: \"doc.command.delete-custom-block\",\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    var _a28;\n    const docSelectionManagerService = accessor.get(DocSelectionManagerService), univerInstanceService = accessor.get(IUniverInstanceService), commandService = accessor.get(ICommandService), activeRange = docSelectionManagerService.getActiveTextRange(), documentDataModel = univerInstanceService.getCurrentUniverDocInstance();\n    if (activeRange == null || documentDataModel == null)\n      return !1;\n    const { direction, range, unitId, drawingId } = params, { startOffset, segmentId, style } = activeRange, cursor = direction === DeleteDirection.LEFT ? startOffset - 1 : startOffset, textRanges = [\n      {\n        startOffset: cursor,\n        endOffset: cursor,\n        style\n      }\n    ], doMutation = {\n      id: RichTextEditingMutation.id,\n      params: {\n        unitId,\n        actions: [],\n        textRanges,\n        prevTextRanges: [range]\n      }\n    }, textX = new TextX(), jsonX = JSONX.getInstance(), rawActions = [];\n    startOffset > 0 && textX.push({\n      t: TextXActionType.RETAIN,\n      len: direction === DeleteDirection.LEFT ? startOffset - 1 : startOffset,\n      segmentId\n    }), textX.push({\n      t: TextXActionType.DELETE,\n      len: 1,\n      line: 0,\n      segmentId\n    });\n    const path = getRichTextEditPath(documentDataModel, segmentId);\n    rawActions.push(jsonX.editOp(textX.serialize(), path));\n    const drawing = ((_a28 = documentDataModel.getDrawings()) != null ? _a28 : {})[drawingId], drawingIndex = documentDataModel.getDrawingsOrder().indexOf(drawingId), removeDrawingAction = jsonX.removeOp([\"drawings\", drawingId], drawing), removeDrawingOrderAction = jsonX.removeOp([\"drawingsOrder\", drawingIndex], drawingId);\n    return rawActions.push(removeDrawingAction), rawActions.push(removeDrawingOrderAction), doMutation.params.actions = rawActions.reduce((acc, cur) => JSONX.compose(acc, cur), null), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n  }, \"handler\")\n}, MergeTwoParagraphCommand = {\n  id: \"doc.command.merge-two-paragraph\",\n  type: CommandType.COMMAND,\n  // eslint-disable-next-line max-lines-per-function\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    const docSelectionManagerService = accessor.get(DocSelectionManagerService), univerInstanceService = accessor.get(IUniverInstanceService), commandService = accessor.get(ICommandService), { direction, range } = params, activeRange = docSelectionManagerService.getActiveTextRange(), ranges = docSelectionManagerService.getCurrentTextRanges();\n    if (activeRange == null || ranges == null)\n      return !1;\n    const { segmentId, style } = activeRange, docDataModel = univerInstanceService.getCurrentUniverDocInstance(), originBody = docDataModel == null ? void 0 : docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n    if (!docDataModel || !originBody)\n      return !1;\n    const actualRange = getDeleteSelection(activeRange, originBody), unitId = docDataModel.getUnitId(), { startOffset, collapsed } = actualRange;\n    if (!collapsed)\n      return !1;\n    const startIndex = direction === DeleteDirection.LEFT ? startOffset : startOffset + 1, endIndex = originBody.paragraphs.find((p2) => p2.startIndex >= startIndex).startIndex, body = getParagraphBody(accessor, unitId, originBody, startIndex, endIndex), cursor = direction === DeleteDirection.LEFT ? startOffset - 1 : startOffset, textRanges = [\n      {\n        startOffset: cursor,\n        endOffset: cursor,\n        style\n      }\n    ], doMutation = {\n      id: RichTextEditingMutation.id,\n      params: {\n        unitId,\n        actions: [],\n        textRanges,\n        prevTextRanges: [range]\n      }\n    }, textX = new TextX(), jsonX = JSONX.getInstance();\n    textX.push({\n      t: TextXActionType.RETAIN,\n      len: direction === DeleteDirection.LEFT ? startOffset - 1 : startOffset,\n      segmentId\n    }), body.dataStream.length && textX.push({\n      t: TextXActionType.INSERT,\n      body,\n      len: body.dataStream.length,\n      line: 0,\n      segmentId\n    }), textX.push({\n      t: TextXActionType.RETAIN,\n      len: 1,\n      segmentId\n    }), textX.push({\n      t: TextXActionType.DELETE,\n      len: endIndex + 1 - startIndex,\n      line: 0,\n      segmentId\n    });\n    const path = getRichTextEditPath(docDataModel, segmentId);\n    return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n  }, \"handler\")\n};\nfunction getCursorWhenDelete(textRanges, rectRanges) {\n  let cursor = 0;\n  if (textRanges == null || textRanges.length === 0) {\n    if (typeof rectRanges[0].startOffset == \"number\") {\n      const rectRange = rectRanges[0], { spanEntireRow, spanEntireTable } = rectRange;\n      spanEntireTable ? cursor = rectRange.startOffset - 3 : spanEntireRow ? rectRange.startRow > 0 ? cursor = rectRange.startOffset - 6 : cursor = rectRange.startOffset : cursor = rectRanges[0].startOffset;\n    }\n  } else if (textRanges.length > 0 && rectRanges.length > 0) {\n    const textRange = textRanges[0], rectRange = rectRanges[0];\n    if (textRange.startOffset != null && rectRange.startOffset != null) {\n      if (textRange.startOffset < rectRange.startOffset)\n        cursor = textRange.startOffset;\n      else if (textRange.startOffset >= rectRange.startOffset) {\n        const { spanEntireRow, spanEntireTable } = rectRange;\n        spanEntireTable ? cursor = rectRange.startOffset - 3 : spanEntireRow && (cursor = rectRange.startOffset - 6);\n      }\n    }\n  }\n  return cursor;\n}\n__name(getCursorWhenDelete, \"getCursorWhenDelete\");\nconst DeleteLeftCommand = {\n  id: \"doc.command.delete-left\",\n  type: CommandType.COMMAND,\n  // eslint-disable-next-line max-lines-per-function, complexity\n  handler: /* @__PURE__ */ __name(async (accessor) => {\n    var _a28, _b;\n    const docSelectionManagerService = accessor.get(DocSelectionManagerService), univerInstanceService = accessor.get(IUniverInstanceService), commandService = accessor.get(ICommandService);\n    let result = !0;\n    const docDataModel = univerInstanceService.getCurrentUniverDocInstance();\n    if (!docDataModel)\n      return !1;\n    const unitId = docDataModel.getUnitId(), docSkeletonManagerService = getCommandSkeleton(accessor, unitId), activeRange = docSelectionManagerService.getActiveTextRange(), rectRanges = docSelectionManagerService.getCurrentRectRanges(), ranges = docSelectionManagerService.getCurrentTextRanges(), skeleton = docSkeletonManagerService == null ? void 0 : docSkeletonManagerService.getSkeleton();\n    if (skeleton == null)\n      return !1;\n    if (rectRanges != null && rectRanges.length) {\n      const cursor2 = getCursorWhenDelete(ranges, rectRanges), segmentId2 = rectRanges[0].segmentId, textRanges = [\n        {\n          startOffset: cursor2,\n          endOffset: cursor2\n        }\n      ];\n      return commandService.executeCommand(CutContentCommand.id, {\n        segmentId: segmentId2,\n        textRanges\n      });\n    }\n    if (activeRange == null || ranges == null)\n      return !1;\n    const { segmentId, style, segmentPage } = activeRange, body = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n    if (body == null)\n      return !1;\n    const actualRange = getDeleteSelection(activeRange, body), { startOffset, collapsed } = actualRange, curGlyph = skeleton.findNodeByCharIndex(startOffset, segmentId, segmentPage), isBullet = hasListGlyph(curGlyph), isIndent = isIndentByGlyph(curGlyph, body);\n    let cursor = startOffset;\n    const preGlyph = skeleton.findNodeByCharIndex(startOffset - 1, segmentId, segmentPage);\n    if (isFirstGlyph(curGlyph) && preGlyph !== curGlyph && (isBullet === !0 || isIndent === !0) && collapsed) {\n      const paragraph = getParagraphByGlyph(curGlyph, body);\n      if (paragraph == null)\n        return !1;\n      const paragraphIndex = paragraph == null ? void 0 : paragraph.startIndex, updateParagraph = { startIndex: 0 }, paragraphStyle = paragraph.paragraphStyle;\n      if (isBullet === !0) {\n        const paragraphStyle2 = paragraph.paragraphStyle;\n        if (paragraphStyle2) {\n          updateParagraph.paragraphStyle = paragraphStyle2;\n          const { hanging } = paragraphStyle2;\n          hanging && (updateParagraph.paragraphStyle.indentStart = hanging, updateParagraph.paragraphStyle.hanging = void 0);\n        }\n      } else if (isIndent === !0) {\n        const bullet = paragraph.bullet;\n        bullet && (updateParagraph.bullet = bullet), paragraphStyle != null && (updateParagraph.paragraphStyle = { ...paragraphStyle }, delete updateParagraph.paragraphStyle.hanging, delete updateParagraph.paragraphStyle.indentStart);\n      }\n      const textRanges = [\n        {\n          startOffset: cursor,\n          endOffset: cursor,\n          style\n        }\n      ];\n      result = await commandService.executeCommand(UpdateCommand.id, {\n        unitId: docDataModel.getUnitId(),\n        updateBody: {\n          dataStream: \"\",\n          paragraphs: [{ ...updateParagraph }]\n        },\n        range: {\n          startOffset: paragraphIndex,\n          endOffset: paragraphIndex + 1\n        },\n        textRanges,\n        coverType: UpdateDocsAttributeType.REPLACE,\n        segmentId\n      });\n    } else if (collapsed === !0) {\n      if (preGlyph == null)\n        return !0;\n      if (preGlyph.content === \"\\r\")\n        result = await commandService.executeCommand(MergeTwoParagraphCommand.id, {\n          direction: DeleteDirection.LEFT,\n          range: actualRange\n        });\n      else if (preGlyph.streamType === \"\\b\") {\n        const drawing = (_b = docDataModel.getSnapshot().drawings) == null ? void 0 : _b[(_a28 = preGlyph.drawingId) != null ? _a28 : \"\"];\n        if (drawing == null)\n          return !0;\n        if (drawing.layoutType === PositionedObjectLayoutType.INLINE) {\n          const unitId2 = docDataModel.getUnitId();\n          result = await commandService.executeCommand(DeleteCustomBlockCommand.id, {\n            direction: DeleteDirection.LEFT,\n            range: activeRange,\n            unitId: unitId2,\n            drawingId: preGlyph.drawingId\n          });\n        } else {\n          const prePreGlyph = skeleton.findNodeByCharIndex(startOffset - 2);\n          if (prePreGlyph == null)\n            return !0;\n          cursor -= preGlyph.count, cursor -= prePreGlyph.count;\n          const textRanges = [\n            {\n              startOffset: cursor,\n              endOffset: cursor,\n              style\n            }\n          ];\n          result = await commandService.executeCommand(DeleteCommand.id, {\n            unitId: docDataModel.getUnitId(),\n            range: {\n              ...activeRange,\n              startOffset: activeRange.startOffset - 1,\n              endOffset: activeRange.endOffset - 1\n            },\n            segmentId,\n            direction: DeleteDirection.LEFT,\n            len: prePreGlyph.count,\n            textRanges\n          });\n        }\n      } else\n        cursor -= preGlyph.count, result = await commandService.executeCommand(DeleteCommand.id, {\n          unitId: docDataModel.getUnitId(),\n          range: actualRange,\n          segmentId,\n          direction: DeleteDirection.LEFT,\n          len: preGlyph.count\n        });\n    } else {\n      const textRanges = getTextRangesWhenDelete(actualRange, [actualRange]);\n      result = await commandService.executeCommand(CutContentCommand.id, {\n        segmentId,\n        textRanges,\n        selections: [actualRange]\n      });\n    }\n    return result;\n  }, \"handler\")\n}, DeleteRightCommand = {\n  id: \"doc.command.delete-right\",\n  type: CommandType.COMMAND,\n  // eslint-disable-next-line max-lines-per-function, complexity\n  handler: /* @__PURE__ */ __name(async (accessor) => {\n    var _a28, _b;\n    const docSelectionManagerService = accessor.get(DocSelectionManagerService), docDataModel = accessor.get(IUniverInstanceService).getCurrentUniverDocInstance();\n    if (!docDataModel)\n      return !1;\n    const docSkeletonManagerService = getCommandSkeleton(accessor, docDataModel.getUnitId()), commandService = accessor.get(ICommandService), activeRange = docSelectionManagerService.getActiveTextRange(), rectRanges = docSelectionManagerService.getCurrentRectRanges(), ranges = docSelectionManagerService.getCurrentTextRanges(), skeleton = docSkeletonManagerService == null ? void 0 : docSkeletonManagerService.getSkeleton();\n    if (rectRanges != null && rectRanges.length) {\n      const cursor = getCursorWhenDelete(ranges, rectRanges), segmentId2 = rectRanges[0].segmentId, textRanges = [\n        {\n          startOffset: cursor,\n          endOffset: cursor\n        }\n      ];\n      return commandService.executeCommand(CutContentCommand.id, {\n        segmentId: segmentId2,\n        textRanges\n      });\n    }\n    if (activeRange == null || skeleton == null || ranges == null)\n      return !1;\n    const { segmentId, style, segmentPage } = activeRange, body = docDataModel == null ? void 0 : docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n    if (!docDataModel || !body)\n      return !1;\n    const actualRange = getDeleteSelection(activeRange, body, DeleteDirection.RIGHT), { startOffset, endOffset, collapsed } = actualRange;\n    if (startOffset === body.dataStream.length - 2 && collapsed)\n      return !0;\n    let result = !1;\n    if (collapsed === !0) {\n      const needDeleteGlyph = skeleton.findNodeByCharIndex(startOffset, segmentId, segmentPage), nextGlyph = skeleton.findNodeByCharIndex(startOffset + 1);\n      if (needDeleteGlyph.streamType === DataStreamTreeTokenType.PARAGRAPH && (nextGlyph == null ? void 0 : nextGlyph.streamType) === DataStreamTreeTokenType.SECTION_BREAK)\n        return !1;\n      if (needDeleteGlyph.content === \"\\r\")\n        result = await commandService.executeCommand(MergeTwoParagraphCommand.id, {\n          direction: DeleteDirection.RIGHT,\n          range: activeRange\n        });\n      else if (needDeleteGlyph.streamType === \"\\b\") {\n        const drawing = (_b = docDataModel.getSnapshot().drawings) == null ? void 0 : _b[(_a28 = needDeleteGlyph.drawingId) != null ? _a28 : \"\"];\n        if (drawing == null)\n          return !0;\n        if (drawing.layoutType === PositionedObjectLayoutType.INLINE) {\n          const unitId = docDataModel.getUnitId();\n          result = await commandService.executeCommand(DeleteCustomBlockCommand.id, {\n            direction: DeleteDirection.RIGHT,\n            range: activeRange,\n            unitId,\n            drawingId: needDeleteGlyph.drawingId\n          });\n        } else {\n          if (nextGlyph == null)\n            return !0;\n          const textRanges = [\n            {\n              startOffset: startOffset + 1,\n              endOffset: startOffset + 1,\n              style\n            }\n          ];\n          result = await commandService.executeCommand(DeleteCommand.id, {\n            unitId: docDataModel.getUnitId(),\n            range: {\n              ...activeRange,\n              startOffset: startOffset + 1,\n              endOffset: endOffset + 1\n            },\n            segmentId,\n            direction: DeleteDirection.RIGHT,\n            textRanges,\n            len: nextGlyph.count\n          });\n        }\n      } else {\n        const textRanges = [\n          {\n            startOffset,\n            endOffset: startOffset,\n            style\n          }\n        ];\n        result = await commandService.executeCommand(DeleteCommand.id, {\n          unitId: docDataModel.getUnitId(),\n          range: actualRange,\n          segmentId,\n          direction: DeleteDirection.RIGHT,\n          textRanges,\n          len: needDeleteGlyph.count\n        });\n      }\n    } else {\n      const textRanges = getTextRangesWhenDelete(actualRange, [actualRange]);\n      result = await commandService.executeCommand(CutContentCommand.id, {\n        segmentId,\n        textRanges,\n        selections: [actualRange]\n      });\n    }\n    return result;\n  }, \"handler\")\n};\nfunction getParagraphBody(accessor, unitId, body, start, end) {\n  const { textRuns: originTextRuns = [], customBlocks: originCustomBlocks = [] } = body, bodySlice = {\n    dataStream: body.dataStream.substring(start, end),\n    customRanges: getCustomRangeSlice(body, start, end).customRanges.map((range) => ({\n      ...Tools.deepClone(range),\n      rangeId: generateRandomId()\n    })),\n    customDecorations: getCustomDecorationSlice(body, start, end)\n  }, textRuns = [];\n  for (const textRun of originTextRuns) {\n    const { st, ed } = textRun;\n    ed <= start || st >= end || (st < start ? textRuns.push({\n      ...textRun,\n      st: 0,\n      ed: ed - start\n    }) : ed > end ? textRuns.push({\n      ...textRun,\n      st: st - start,\n      ed: end - start\n    }) : textRuns.push({\n      ...textRun,\n      st: st - start,\n      ed: ed - start\n    }));\n  }\n  textRuns.length > 0 && (bodySlice.textRuns = textRuns);\n  const customBlocks = [];\n  for (const block of originCustomBlocks) {\n    const { startIndex } = block;\n    startIndex >= start && startIndex <= end && customBlocks.push({\n      ...block,\n      startIndex: startIndex - start\n    });\n  }\n  return customBlocks.length > 0 && (bodySlice.customBlocks = customBlocks), bodySlice;\n}\n__name(getParagraphBody, \"getParagraphBody\");\nfunction getTextRangesWhenDelete(activeRange, ranges) {\n  let cursor = activeRange.endOffset;\n  for (const range of ranges) {\n    const { startOffset, endOffset } = range;\n    startOffset == null || endOffset == null || endOffset <= activeRange.endOffset && (cursor -= endOffset - startOffset);\n  }\n  return [\n    {\n      startOffset: cursor,\n      endOffset: cursor,\n      style: activeRange.style\n    }\n  ];\n}\n__name(getTextRangesWhenDelete, \"getTextRangesWhenDelete\");\nconst COPY_CONTENT_CACHE_LIMIT = 10, ID_LENGTH$2 = 6;\nfunction genId() {\n  return Tools.generateRandomId(ID_LENGTH$2);\n}\n__name(genId, \"genId\");\nfunction extractId(html) {\n  const match = html.match(/data-copy-id=\"([^\\s]+)\"/);\n  return match && match[1] ? match[1] : null;\n}\n__name(extractId, \"extractId\");\nconst _CopyContentCache = class _CopyContentCache {\n  constructor() {\n    __publicField(this, \"_cache\", new LRUMap(COPY_CONTENT_CACHE_LIMIT));\n  }\n  set(id, clipboardData) {\n    this._cache.set(id, clipboardData);\n  }\n  get(id) {\n    return this._cache.get(id);\n  }\n  clear() {\n    this._cache.clear();\n  }\n};\n__name(_CopyContentCache, \"CopyContentCache\");\nlet CopyContentCache = _CopyContentCache;\nconst copyContentCache = new CopyContentCache();\nfunction extractNodeStyle(node) {\n  const styles2 = node.style, docStyles = {}, tagName = node.tagName.toLowerCase();\n  switch (tagName) {\n    case \"b\":\n    case \"em\":\n    case \"strong\": {\n      docStyles.bl = BooleanNumber.TRUE;\n      break;\n    }\n    case \"s\": {\n      docStyles.st = {\n        s: BooleanNumber.TRUE\n      };\n      break;\n    }\n    case \"u\": {\n      docStyles.ul = {\n        s: BooleanNumber.TRUE\n      };\n      break;\n    }\n    case \"i\": {\n      docStyles.it = BooleanNumber.TRUE;\n      break;\n    }\n    case \"sub\":\n    case \"sup\": {\n      docStyles.va = tagName === \"sup\" ? BaselineOffset.SUPERSCRIPT : BaselineOffset.SUBSCRIPT;\n      break;\n    }\n  }\n  for (let i = 0; i < styles2.length; i++) {\n    const cssRule = styles2[i], cssValue = styles2.getPropertyValue(cssRule);\n    switch (cssRule) {\n      case \"font-family\": {\n        docStyles.ff = cssValue.replace(/^\"/g, \"\").replace(/\"$/g, \"\");\n        break;\n      }\n      case \"font-size\": {\n        const fontSize = Number.parseInt(cssValue);\n        Number.isNaN(fontSize) || (cssValue.endsWith(\"pt\") ? docStyles.fs = fontSize : cssValue.endsWith(\"px\") && (docStyles.fs = pixelToPt(fontSize)));\n        break;\n      }\n      case \"font-style\": {\n        cssValue === \"italic\" && (docStyles.it = BooleanNumber.TRUE);\n        break;\n      }\n      case \"font-weight\": {\n        (Number(cssValue) > 400 || String(cssValue) === \"bold\") && (docStyles.bl = BooleanNumber.TRUE);\n        break;\n      }\n      case \"text-decoration\": {\n        /underline/.test(cssValue) ? docStyles.ul = {\n          s: BooleanNumber.TRUE\n        } : /overline/.test(cssValue) ? docStyles.ol = {\n          s: BooleanNumber.TRUE\n        } : /line-through/.test(cssValue) && (docStyles.st = {\n          s: BooleanNumber.TRUE\n        });\n        break;\n      }\n      case \"color\": {\n        try {\n          const color = new ColorKit(cssValue);\n          color.isValid && (docStyles.cl = {\n            rgb: color.toRgbString()\n          });\n        } catch {\n        }\n        break;\n      }\n      case \"background-color\": {\n        const color = new ColorKit(cssValue);\n        color.isValid && (docStyles.bg = {\n          rgb: color.toRgbString()\n        });\n        break;\n      }\n    }\n  }\n  return docStyles;\n}\n__name(extractNodeStyle, \"extractNodeStyle\");\nfunction parseToDom(rawHtml) {\n  const parser = new DOMParser(), html = `<x-univer id=\"univer-root\">${rawHtml}</x-univer>`;\n  return parser.parseFromString(html, \"text/html\").querySelector(\"#univer-root\");\n}\n__name(parseToDom, \"parseToDom\");\nfunction matchFilter(node, filter2) {\n  const tagName = node.tagName.toLowerCase();\n  return typeof filter2 == \"string\" ? tagName === filter2 : Array.isArray(filter2) ? filter2.some((name) => name === tagName) : filter2(node);\n}\n__name(matchFilter, \"matchFilter\");\nconst DEFAULT_TABLE_WIDTH = 600, _HtmlToUDMService = class _HtmlToUDMService {\n  constructor() {\n    __publicField(this, \"_tableCache\", []);\n    __publicField(this, \"_styleCache\", /* @__PURE__ */ new Map());\n    __publicField(this, \"_styleRules\", []);\n    __publicField(this, \"_afterProcessRules\", []);\n  }\n  static use(plugin) {\n    if (this._pluginList.includes(plugin))\n      throw new Error(`Univer paste plugin ${plugin.name} already added`);\n    this._pluginList.push(plugin);\n  }\n  convert(html) {\n    const pastePlugin = _HtmlToUDMService._pluginList.find((plugin) => plugin.checkPasteType(html)), dom = parseToDom(html), docData = {\n      body: {\n        dataStream: \"\",\n        paragraphs: [],\n        sectionBreaks: [],\n        tables: [],\n        textRuns: []\n      },\n      tableSource: {}\n    };\n    return pastePlugin && (this._styleRules = [...pastePlugin.stylesRules], this._afterProcessRules = [...pastePlugin.afterProcessRules]), this._tableCache = [], this._styleCache.clear(), this._process(null, dom.childNodes, docData), this._styleCache.clear(), this._styleRules = [], this._afterProcessRules = [], docData;\n  }\n  _process(parent, nodes, doc) {\n    var _a28, _b;\n    const body = doc.body;\n    for (const node of nodes)\n      if (node.nodeType === Node.TEXT_NODE) {\n        if (((_a28 = node.nodeValue) == null ? void 0 : _a28.trim()) === \"\")\n          continue;\n        const text = (_b = node.nodeValue) == null ? void 0 : _b.replace(/[\\r\\n]/g, \"\");\n        let style;\n        parent && this._styleCache.has(parent) && (style = this._styleCache.get(parent)), body.dataStream += text, style && Object.getOwnPropertyNames(style).length && body.textRuns.push({\n          st: body.dataStream.length - text.length,\n          ed: body.dataStream.length,\n          ts: style\n        });\n      } else {\n        if (skipParseTagNames.includes(node.nodeName.toLowerCase()))\n          continue;\n        if (node.nodeType === Node.ELEMENT_NODE) {\n          const element2 = node, linkStart = this._processBeforeLink(element2, doc), parentStyles = parent ? this._styleCache.get(parent) : {}, styleRule = this._styleRules.find(({ filter: filter2 }) => matchFilter(node, filter2)), nodeStyles = styleRule ? styleRule.getStyle(node) : extractNodeStyle(node);\n          this._styleCache.set(node, { ...parentStyles, ...nodeStyles });\n          const { childNodes } = node;\n          this._processBeforeTable(node, doc), this._process(node, childNodes, doc), this._processAfterTable(node, doc);\n          const afterProcessRule = this._afterProcessRules.find(\n            ({ filter: filter2 }) => matchFilter(node, filter2)\n          );\n          afterProcessRule && afterProcessRule.handler(doc, node), this._processAfterLink(element2, doc, linkStart);\n        }\n      }\n  }\n  _processBeforeTable(node, doc) {\n    var _a28;\n    const tagName = node.tagName.toUpperCase(), body = doc.body;\n    switch (tagName) {\n      case \"TABLE\": {\n        body.dataStream[body.dataStream.length - 1] !== \"\\r\" && (body.dataStream += \"\\r\", body.paragraphs == null && (body.paragraphs = []), (_a28 = body.paragraphs) == null || _a28.push({\n          startIndex: body.dataStream.length - 1\n        }));\n        const table = genTableSource(0, 0, DEFAULT_TABLE_WIDTH);\n        this._tableCache.push({\n          table,\n          startIndex: body.dataStream.length\n        }), body.dataStream += DataStreamTreeTokenType.TABLE_START;\n        break;\n      }\n      case \"TR\": {\n        const row = getEmptyTableRow(0);\n        this._tableCache[this._tableCache.length - 1].table.tableRows.push(row), body.dataStream += DataStreamTreeTokenType.TABLE_ROW_START;\n        break;\n      }\n      case \"TD\": {\n        const cell = getEmptyTableCell(), lastTable = this._tableCache[this._tableCache.length - 1].table;\n        lastTable.tableRows[lastTable.tableRows.length - 1].tableCells.push(cell), body.dataStream += DataStreamTreeTokenType.TABLE_CELL_START;\n        break;\n      }\n    }\n  }\n  _processAfterTable(node, doc) {\n    var _a28, _b;\n    const tagName = node.tagName.toUpperCase(), body = doc.body;\n    doc.tableSource == null && (doc.tableSource = {}), body.tables == null && (body.tables = []), body.sectionBreaks == null && (body.sectionBreaks = []);\n    const { tableSource } = doc;\n    switch (tagName) {\n      case \"TABLE\": {\n        const tableCache = this._tableCache.pop(), { startIndex, table } = tableCache, colCount = table.tableRows[0].tableCells.length, tableColumn = getTableColumn(DEFAULT_TABLE_WIDTH / colCount), tableColumns = [...new Array(colCount).fill(null).map(() => Tools.deepClone(tableColumn))];\n        table.tableColumns = tableColumns, tableSource[table.tableId] = table, body.dataStream += DataStreamTreeTokenType.TABLE_END, body.tables.push({\n          startIndex,\n          endIndex: body.dataStream.length - 1,\n          tableId: table.tableId\n        });\n        break;\n      }\n      case \"TR\": {\n        body.dataStream += DataStreamTreeTokenType.TABLE_ROW_END;\n        break;\n      }\n      case \"TD\": {\n        body.dataStream[body.dataStream.length - 1] !== \"\\r\" && ((_a28 = body.paragraphs) == null || _a28.push({\n          startIndex: body.dataStream.length\n        }), body.dataStream += \"\\r\"), (_b = body.sectionBreaks) == null || _b.push({\n          startIndex: body.dataStream.length\n        }), body.dataStream += `\n${DataStreamTreeTokenType.TABLE_CELL_END}`;\n        break;\n      }\n    }\n  }\n  _processBeforeLink(node, doc) {\n    const body = doc.body, element2 = node, start = body.dataStream.length;\n    return element2.tagName.toUpperCase() === \"A\" && (body.dataStream += DataStreamTreeTokenType.CUSTOM_RANGE_START), start;\n  }\n  _processAfterLink(node, doc, start) {\n    var _a28, _b;\n    const body = doc.body, element2 = node;\n    element2.tagName.toUpperCase() === \"A\" && (body.dataStream += DataStreamTreeTokenType.CUSTOM_RANGE_END, body.customRanges = (_a28 = body.customRanges) != null ? _a28 : [], body.customRanges.push({\n      startIndex: start,\n      endIndex: body.dataStream.length - 1,\n      rangeId: (_b = element2.dataset.rangeid) != null ? _b : generateRandomId(),\n      rangeType: CustomRangeType.HYPERLINK,\n      properties: { url: element2.href }\n    }));\n  }\n};\n__name(_HtmlToUDMService, \"HtmlToUDMService\"), __publicField(_HtmlToUDMService, \"_pluginList\", []);\nlet HtmlToUDMService = _HtmlToUDMService;\nconst wordPastePlugin$1 = {\n  name: \"univer-doc-paste-plugin-lark\",\n  checkPasteType(html) {\n    return /lark-record-clipboard/i.test(html);\n  },\n  // TODO: @JOCS, support inline code copy from lark.\n  stylesRules: [\n    {\n      filter: [\"s\"],\n      getStyle(node) {\n        const inlineStyle = extractNodeStyle(node);\n        return {\n          st: {\n            s: BooleanNumber.TRUE\n          },\n          ...inlineStyle\n        };\n      }\n    }\n  ],\n  afterProcessRules: [\n    {\n      filter(el) {\n        return el.tagName === \"DIV\" && /ace-line/i.test(el.className);\n      },\n      handler(doc) {\n        const body = doc.body;\n        body.paragraphs == null && (body.paragraphs = []), body.paragraphs.push({\n          startIndex: body.dataStream.length\n        }), body.dataStream += \"\\r\";\n      }\n    }\n  ]\n}, PastePluginLark = wordPastePlugin$1;\nfunction getParagraphStyle(el) {\n  const styles2 = el.style, paragraphStyle = {};\n  for (let i = 0; i < styles2.length; i++) {\n    const cssRule = styles2[i], cssValue = styles2.getPropertyValue(cssRule);\n    switch (cssRule) {\n      case \"margin-top\": {\n        const marginTopValue = Number.parseInt(cssValue);\n        paragraphStyle.spaceAbove = { v: /pt/.test(cssValue) ? ptToPixel(marginTopValue) : marginTopValue };\n        break;\n      }\n      case \"margin-bottom\": {\n        const marginBottomValue = Number.parseInt(cssValue);\n        paragraphStyle.spaceBelow = { v: /pt/.test(cssValue) ? ptToPixel(marginBottomValue) : marginBottomValue };\n        break;\n      }\n      case \"line-height\": {\n        let lineHeightValue = Number.parseFloat(cssValue);\n        cssValue.endsWith(\"%\") && (lineHeightValue /= 100), paragraphStyle.lineSpacing = lineHeightValue;\n        break;\n      }\n    }\n  }\n  return Object.getOwnPropertyNames(paragraphStyle).length ? paragraphStyle : null;\n}\n__name(getParagraphStyle, \"getParagraphStyle\");\nconst univerPastePlugin = {\n  name: \"univer-doc-paste-plugin-univer\",\n  checkPasteType(html) {\n    return /UniverNormal/i.test(html);\n  },\n  stylesRules: [],\n  afterProcessRules: [\n    {\n      filter(el) {\n        return el.tagName === \"P\" && /UniverNormal/i.test(el.className);\n      },\n      handler(doc, el) {\n        const body = doc.body;\n        body.paragraphs == null && (body.paragraphs = []);\n        const paragraph = {\n          startIndex: body.dataStream.length\n        }, paragraphStyle = getParagraphStyle(el);\n        paragraphStyle && (paragraph.paragraphStyle = paragraphStyle), body.paragraphs.push(paragraph), body.dataStream += \"\\r\";\n      }\n    }\n  ]\n}, PastePluginUniver = univerPastePlugin, wordPastePlugin = {\n  name: \"univer-doc-paste-plugin-word\",\n  checkPasteType(html) {\n    return /word|mso/i.test(html);\n  },\n  stylesRules: [\n    {\n      filter: [\"b\"],\n      getStyle(node) {\n        const inlineStyle = extractNodeStyle(node);\n        return { bl: BooleanNumber.TRUE, ...inlineStyle };\n      }\n    }\n  ],\n  afterProcessRules: [\n    {\n      filter(el) {\n        return el.tagName === \"P\";\n      },\n      handler(doc, el) {\n        const body = doc.body;\n        body.paragraphs == null && (body.paragraphs = []);\n        const paragraph = {\n          startIndex: body.dataStream.length\n        }, paragraphStyle = getParagraphStyle(el);\n        paragraphStyle && (paragraph.paragraphStyle = paragraphStyle), body.paragraphs.push(paragraph), body.dataStream += \"\\r\";\n      }\n    }\n  ]\n}, PastePluginWord = wordPastePlugin;\nfunction covertTextRunToHtml(dataStream, textRun) {\n  const { st: start, ed, ts = {} } = textRun, { ff, fs, it, bl, ul, st, ol, bg, cl, va } = ts;\n  let html = dataStream.slice(start, ed);\n  const style = [];\n  return it === BooleanNumber.TRUE && (html = `<i>${html}</i>`), va === BaselineOffset.SUPERSCRIPT ? html = `<sup>${html}</sup>` : va === BaselineOffset.SUBSCRIPT && (html = `<sub>${html}</sub>`), (ul == null ? void 0 : ul.s) === BooleanNumber.TRUE && (html = `<u>${html}</u>`), (st == null ? void 0 : st.s) === BooleanNumber.TRUE && (html = `<s>${html}</s>`), bl === BooleanNumber.TRUE && (html = `<strong>${html}</strong>`), ff && style.push(`font-family: ${ff}`), cl && style.push(`color: ${cl.rgb}`), fs && style.push(`font-size: ${fs}pt`), ol && style.push(\"text-decoration: overline\"), bg && style.push(`background: ${bg.rgb}`), style.length ? `<span style=\"${style.join(\"; \")};\">${html}</span>` : html;\n}\n__name(covertTextRunToHtml, \"covertTextRunToHtml\");\nfunction getBodyInlineSlice(body, startIndex, endIndex) {\n  const { dataStream, textRuns = [] } = body;\n  let cursorIndex = startIndex;\n  const spanList = [];\n  for (const textRun of textRuns) {\n    const { st, ed } = textRun;\n    Tools.hasIntersectionBetweenTwoRanges(startIndex, endIndex, st, ed) && (st > cursorIndex ? (spanList.push(dataStream.slice(cursorIndex, st)), spanList.push(covertTextRunToHtml(dataStream, {\n      ...textRun,\n      ed: Math.min(ed, endIndex)\n    }))) : spanList.push(covertTextRunToHtml(dataStream, {\n      ...textRun,\n      st: cursorIndex,\n      ed: Math.min(ed, endIndex)\n    }))), cursorIndex = Math.max(startIndex, Math.min(ed, endIndex));\n  }\n  return cursorIndex !== endIndex && spanList.push(dataStream.slice(cursorIndex, endIndex)), spanList.join(\"\");\n}\n__name(getBodyInlineSlice, \"getBodyInlineSlice\");\nfunction getBodySliceHtml(body, startIndex, endIndex) {\n  const { customRanges = [] } = body, customRangesInRange = customRanges.filter((range) => range.startIndex >= startIndex && range.endIndex <= endIndex);\n  let cursorIndex = startIndex, html = \"\";\n  customRangesInRange.forEach((range) => {\n    var _a28, _b;\n    const { startIndex: startIndex2, endIndex: endIndex2, rangeType, rangeId } = range, preHtml = getBodyInlineSlice(body, cursorIndex, startIndex2);\n    html += preHtml;\n    const sliceHtml = getBodyInlineSlice(body, startIndex2 + 1, endIndex2);\n    switch (rangeType) {\n      case CustomRangeType.HYPERLINK: {\n        html += `<a data-rangeid=\"${rangeId}\" href=\"${(_b = (_a28 = range.properties) == null ? void 0 : _a28.url) != null ? _b : \"\"}\">${sliceHtml}</a>`;\n        break;\n      }\n      default: {\n        html += sliceHtml;\n        break;\n      }\n    }\n    cursorIndex = endIndex2 + 1;\n  });\n  const endHtml = getBodyInlineSlice(body, cursorIndex, endIndex);\n  return html += endHtml, html;\n}\n__name(getBodySliceHtml, \"getBodySliceHtml\");\nfunction convertBodyToHtml(body) {\n  const { paragraphs = [], sectionBreaks = [] } = body;\n  let { dataStream } = body;\n  dataStream.endsWith(`\\r\n`) || (dataStream += `\\r\n`, paragraphs.push({\n    startIndex: dataStream.length - 2\n  }), sectionBreaks.push({\n    startIndex: dataStream.length - 1\n  }), body.dataStream = dataStream, body.paragraphs = paragraphs, body.sectionBreaks = sectionBreaks);\n  const result = { html: \"\" }, nodeList = parseDataStreamToTree(dataStream);\n  for (const node of nodeList)\n    processNode(node, body, result);\n  return result.html;\n}\n__name(convertBodyToHtml, \"convertBodyToHtml\");\nfunction processNode(node, body, result) {\n  var _a28;\n  switch (node.nodeType) {\n    case DataStreamTreeNodeType.SECTION_BREAK: {\n      for (const n2 of node.children)\n        processNode(n2, body, result);\n      break;\n    }\n    case DataStreamTreeNodeType.PARAGRAPH: {\n      const { children, startIndex, endIndex } = node, paragraph = (_a28 = body.paragraphs.find((p2) => p2.startIndex === endIndex)) != null ? _a28 : {}, { paragraphStyle = {} } = paragraph, { spaceAbove, spaceBelow, lineSpacing } = paragraphStyle, style = [];\n      if (spaceAbove != null && (typeof spaceAbove == \"number\" ? style.push(`margin-top: ${spaceAbove}px`) : style.push(`margin-top: ${spaceAbove.v}px`)), spaceBelow != null && (typeof spaceBelow == \"number\" ? style.push(`margin-bottom: ${spaceBelow}px`) : style.push(`margin-bottom: ${spaceBelow.v}px`)), lineSpacing != null && style.push(`line-height: ${lineSpacing}`), result.html += `<p class=\"UniverNormal\" ${style.length ? `style=\"${style.join(\"; \")};\"` : \"\"}>`, children.length)\n        for (const table of children)\n          processNode(table, body, result);\n      result.html += `${getBodySliceHtml(body, startIndex, endIndex)}</p>`;\n      break;\n    }\n    case DataStreamTreeNodeType.TABLE: {\n      const { children } = node;\n      result.html += '<table class=\"UniverTable\" style=\"width: 100%; border-collapse: collapse;\"><tbody>';\n      for (const row of children)\n        processNode(row, body, result);\n      result.html += \"</tbody></table>\";\n      break;\n    }\n    case DataStreamTreeNodeType.TABLE_ROW: {\n      const { children } = node;\n      result.html += '<tr class=\"UniverTableRow\">';\n      for (const cell of children)\n        processNode(cell, body, result);\n      result.html += \"</tr>\";\n      break;\n    }\n    case DataStreamTreeNodeType.TABLE_CELL: {\n      const { children } = node;\n      result.html += '<td class=\"UniverTableCell\">';\n      for (const n2 of children)\n        processNode(n2, body, result);\n      result.html += \"</td>\";\n      break;\n    }\n    default:\n      throw new Error(`Unknown node type: ${node.nodeType}`);\n  }\n}\n__name(processNode, \"processNode\");\nconst _UDMToHtmlService = class _UDMToHtmlService {\n  convert(bodyList) {\n    if (bodyList.length === 0)\n      throw new Error(\"The bodyList length at least to be 1\");\n    let html = \"\";\n    for (const body of Tools.deepClone(bodyList))\n      html += convertBodyToHtml(body);\n    return html;\n  }\n};\n__name(_UDMToHtmlService, \"UDMToHtmlService\");\nlet UDMToHtmlService = _UDMToHtmlService;\nvar __defProp$p = Object.defineProperty, __getOwnPropDesc$p = Object.getOwnPropertyDescriptor, __decorateClass$p = /* @__PURE__ */ __name((decorators, target, key, kind) => {\n  for (var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$p(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)\n    (decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n  return kind && result && __defProp$p(target, key, result), result;\n}, \"__decorateClass$p\"), __decorateParam$p = /* @__PURE__ */ __name((index, decorator) => (target, key) => decorator(target, key, index), \"__decorateParam$p\");\nHtmlToUDMService.use(PastePluginWord);\nHtmlToUDMService.use(PastePluginLark);\nHtmlToUDMService.use(PastePluginUniver);\nfunction getTableSlice(body, start, end) {\n  var _a28, _b, _c;\n  const bodySlice = getBodySlice(body, start, end + 2), dataStream = DataStreamTreeTokenType.TABLE_START + DataStreamTreeTokenType.TABLE_ROW_START + DataStreamTreeTokenType.TABLE_CELL_START + bodySlice.dataStream + DataStreamTreeTokenType.TABLE_CELL_END + DataStreamTreeTokenType.TABLE_ROW_END + DataStreamTreeTokenType.TABLE_END;\n  return bodySlice.dataStream = dataStream, (_a28 = bodySlice.textRuns) == null || _a28.forEach((textRun) => {\n    const { st, ed } = textRun;\n    textRun.st = st + 3, textRun.ed = ed + 3;\n  }), (_b = bodySlice.tables) == null || _b.forEach((table) => {\n    const { startIndex, endIndex } = table;\n    table.startIndex = startIndex + 3, table.endIndex = endIndex + 3;\n  }), (_c = bodySlice.paragraphs) == null || _c.forEach((paragraph) => {\n    const { startIndex } = paragraph;\n    paragraph.startIndex = startIndex + 3;\n  }), bodySlice;\n}\n__name(getTableSlice, \"getTableSlice\");\nconst IDocClipboardService = createIdentifier(\"doc.clipboard-service\");\nvar _a2;\nlet DocClipboardService = (_a2 = class extends Disposable {\n  constructor(_univerInstanceService, _logService, _commandService, _clipboardInterfaceService, _docSelectionManagerService) {\n    super();\n    __publicField(this, \"_clipboardHooks\", []);\n    __publicField(this, \"_htmlToUDM\", new HtmlToUDMService());\n    __publicField(this, \"_umdToHtml\", new UDMToHtmlService());\n    this._univerInstanceService = _univerInstanceService, this._logService = _logService, this._commandService = _commandService, this._clipboardInterfaceService = _clipboardInterfaceService, this._docSelectionManagerService = _docSelectionManagerService;\n  }\n  async copy(sliceType = SliceBodyType.copy) {\n    var _a28;\n    const { bodyList = [], needCache = !1, snapshot } = (_a28 = this._getDocumentBodyInRanges(sliceType)) != null ? _a28 : {};\n    if (bodyList.length === 0 || snapshot == null)\n      return !1;\n    try {\n      const activeRange = this._docSelectionManagerService.getActiveTextRange(), isCopyInHeaderFooter = !!(activeRange != null && activeRange.segmentId);\n      this._setClipboardData(bodyList, snapshot, !isCopyInHeaderFooter && needCache);\n    } catch (e) {\n      return this._logService.error(\"[DocClipboardService] copy failed\", e), !1;\n    }\n    return !0;\n  }\n  async cut() {\n    return this._cut();\n  }\n  async paste(items) {\n    const partDocData = await this._genDocDataFromClipboardItems(items);\n    return this._paste(partDocData);\n  }\n  async legacyPaste(html, text) {\n    var _a28;\n    const partDocData = this._genDocDataFromHtmlAndText(html, text);\n    if (((_a28 = this._univerInstanceService.getCurrentUnitForType(UniverInstanceType.UNIVER_DOC)) == null ? void 0 : _a28.getUnitId()) === DOCS_NORMAL_EDITOR_UNIT_ID_KEY)\n      if (text) {\n        const textDocData = BuildTextUtils.transform.fromPlainText(text);\n        return this._paste({ body: textDocData });\n      } else\n        partDocData.body.textRuns = [];\n    return this._paste(partDocData);\n  }\n  async _cut() {\n    var _a28, _b, _c;\n    const {\n      segmentId,\n      endOffset: activeEndOffset,\n      style\n    } = (_a28 = this._docSelectionManagerService.getActiveTextRange()) != null ? _a28 : {}, textRanges = (_b = this._docSelectionManagerService.getCurrentTextRanges()) != null ? _b : [], rectRanges = (_c = this._docSelectionManagerService.getCurrentRectRanges()) != null ? _c : [];\n    if (segmentId == null && this._logService.error(\"[DocClipboardController] segmentId is not existed\"), textRanges.length === 0 && rectRanges.length === 0)\n      return !1;\n    this.copy(SliceBodyType.cut);\n    try {\n      let cursor = 0;\n      if (rectRanges.length > 0)\n        cursor = getCursorWhenDelete(textRanges, rectRanges);\n      else if (activeEndOffset != null) {\n        cursor = activeEndOffset;\n        for (const range of textRanges) {\n          const { startOffset, endOffset } = range;\n          startOffset == null || endOffset == null || endOffset <= activeEndOffset && (cursor -= endOffset - startOffset);\n        }\n      }\n      const newTextRanges = [\n        {\n          startOffset: cursor,\n          endOffset: cursor,\n          style\n        }\n      ];\n      return this._commandService.executeCommand(CutContentCommand.id, { segmentId, textRanges: newTextRanges });\n    } catch {\n      return this._logService.error(\"[DocClipboardController] cut content failed\"), !1;\n    }\n  }\n  async _paste(docData) {\n    var _a28, _b;\n    const { body: _body } = docData;\n    if (_body == null)\n      return !1;\n    let body = normalizeBody(_body);\n    if (!((_a28 = this._univerInstanceService.getCurrentUnitForType(UniverInstanceType.UNIVER_DOC)) == null ? void 0 : _a28.getUnitId()))\n      return !1;\n    this._clipboardHooks.forEach((hook) => {\n      hook.onBeforePaste && (body = hook.onBeforePaste(body));\n    }), body.customRanges = (_b = body.customRanges) == null ? void 0 : _b.map(BuildTextUtils.customRange.copyCustomRange);\n    const activeRange = this._docSelectionManagerService.getActiveTextRange(), { segmentId, endOffset: activeEndOffset, style } = activeRange || {}, ranges = this._docSelectionManagerService.getCurrentTextRanges();\n    if (segmentId == null && this._logService.error(\"[DocClipboardController] segmentId does not exist!\"), activeEndOffset == null || ranges == null)\n      return !1;\n    try {\n      let cursor = activeEndOffset;\n      for (const range of ranges) {\n        const { startOffset, endOffset } = range;\n        startOffset == null || endOffset == null || endOffset <= activeEndOffset && (cursor += body.dataStream.length - (endOffset - startOffset));\n      }\n      const textRanges = [\n        {\n          startOffset: cursor,\n          endOffset: cursor,\n          style\n        }\n      ];\n      return this._commandService.executeCommand(InnerPasteCommand.id, {\n        doc: {\n          ...docData,\n          body\n        },\n        segmentId,\n        textRanges\n      });\n    } catch {\n      return this._logService.error(\"[DocClipboardController]\", \"clipboard is empty.\"), !1;\n    }\n  }\n  async _setClipboardData(documentBodyList, snapshot, needCache = !0) {\n    var _a28, _b;\n    const copyId = genId(), text = (documentBodyList.length > 1 ? documentBodyList.map((body) => body.dataStream).join(`\n`) : documentBodyList[0].dataStream).replaceAll(DataStreamTreeTokenType.CUSTOM_RANGE_START, \"\").replaceAll(DataStreamTreeTokenType.CUSTOM_RANGE_END, \"\");\n    let html = this._umdToHtml.convert(documentBodyList);\n    if (documentBodyList.length === 1 && needCache) {\n      html = html.replace(/(<[a-z]+)/, (_p0, p1) => `${p1} data-copy-id=\"${copyId}\"`);\n      const body = documentBodyList[0], cache = { body };\n      if ((_a28 = body.customBlocks) != null && _a28.length) {\n        cache.drawings = {};\n        for (const block of body.customBlocks) {\n          const { blockId } = block, drawing = (_b = snapshot.drawings) == null ? void 0 : _b[blockId];\n          if (drawing) {\n            const id = Tools.generateRandomId(6);\n            block.blockId = id, cache.drawings[id] = {\n              ...Tools.deepClone(drawing),\n              drawingId: id\n            };\n          }\n        }\n      }\n      copyContentCache.set(copyId, cache);\n    }\n    return this._clipboardInterfaceService.write(text, html);\n  }\n  addClipboardHook(hook) {\n    return this._clipboardHooks.push(hook), toDisposable(() => {\n      const index = this._clipboardHooks.indexOf(hook);\n      index > -1 && this._clipboardHooks.splice(index, 1);\n    });\n  }\n  _getDocumentBodyInRanges(sliceType) {\n    var _a28;\n    const docDataModel = this._univerInstanceService.getCurrentUniverDocInstance(), allRanges = this._docSelectionManagerService.getDocRanges(), results = [];\n    let needCache = !0;\n    if (docDataModel == null || allRanges.length === 0)\n      return;\n    const segmentId = allRanges[0].segmentId, body = (_a28 = docDataModel == null ? void 0 : docDataModel.getSelfOrHeaderFooterModel(segmentId)) == null ? void 0 : _a28.getBody(), snapshot = docDataModel.getSnapshot();\n    if (body != null) {\n      for (const range of allRanges) {\n        const { startOffset, endOffset, collapsed, rangeType } = range;\n        if (collapsed || startOffset == null || endOffset == null)\n          continue;\n        if (rangeType === DOC_RANGE_TYPE.RECT) {\n          needCache = !1;\n          const { spanEntireRow } = range;\n          let bodySlice;\n          bodySlice = getTableSlice(body, startOffset, endOffset), results.push(bodySlice);\n          continue;\n        }\n        const deleteRange = BuildTextUtils.selection.getDeleteSelection({ startOffset, endOffset, collapsed }, body), docBody = docDataModel.getSelfOrHeaderFooterModel(segmentId).sliceBody(deleteRange.startOffset, deleteRange.endOffset, sliceType);\n        docBody != null && results.push(docBody);\n      }\n      return {\n        bodyList: results,\n        needCache,\n        snapshot\n      };\n    }\n  }\n  async _genDocDataFromClipboardItems(items) {\n    try {\n      let html = \"\", text = \"\";\n      for (const clipboardItem of items)\n        for (const type of clipboardItem.types)\n          type === PLAIN_TEXT_CLIPBOARD_MIME_TYPE ? text = await clipboardItem.getType(type).then((blob) => blob && blob.text()) : type === HTML_CLIPBOARD_MIME_TYPE && (html = await clipboardItem.getType(type).then((blob) => blob && blob.text()));\n      return this._genDocDataFromHtmlAndText(html, text);\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  }\n  _genDocDataFromHtmlAndText(html, text) {\n    if (!html) {\n      if (text)\n        return { body: BuildTextUtils.transform.fromPlainText(text) };\n      throw new Error(\"[DocClipboardService] html and text cannot be both empty!\");\n    }\n    const copyId = extractId(html);\n    if (copyId) {\n      const copyCache = copyContentCache.get(copyId);\n      if (copyCache)\n        return copyCache;\n    }\n    return this._htmlToUDM.convert(html);\n  }\n}, __name(_a2, \"DocClipboardService\"), _a2);\nDocClipboardService = __decorateClass$p([\n  __decorateParam$p(0, IUniverInstanceService),\n  __decorateParam$p(1, ILogService),\n  __decorateParam$p(2, ICommandService),\n  __decorateParam$p(3, IClipboardInterfaceService),\n  __decorateParam$p(4, Inject(DocSelectionManagerService))\n], DocClipboardService);\nfunction whenDocOrEditor(contextService) {\n  return contextService.getContextValue(FOCUSING_DOC) || contextService.getContextValue(EDITOR_ACTIVATED);\n}\n__name(whenDocOrEditor, \"whenDocOrEditor\");\nfunction whenFocusEditor(contextService) {\n  return contextService.getContextValue(EDITOR_ACTIVATED);\n}\n__name(whenFocusEditor, \"whenFocusEditor\");\nconst DOC_CLIPBOARD_PRIORITY = 999, DocCopyCommand = {\n  id: CopyCommand.id,\n  name: \"doc.command.copy\",\n  type: CommandType.COMMAND,\n  multi: !0,\n  priority: DOC_CLIPBOARD_PRIORITY,\n  preconditions: whenDocOrEditor,\n  handler: /* @__PURE__ */ __name(async (accessor) => accessor.get(IDocClipboardService).copy(), \"handler\")\n}, DocCutCommand = {\n  id: CutCommand.id,\n  name: \"doc.command.cut\",\n  type: CommandType.COMMAND,\n  multi: !0,\n  priority: DOC_CLIPBOARD_PRIORITY,\n  preconditions: whenDocOrEditor,\n  handler: /* @__PURE__ */ __name(async (accessor) => accessor.get(IDocClipboardService).cut(), \"handler\")\n}, DocPasteCommand = {\n  id: PasteCommand.id,\n  name: \"doc.command.paste\",\n  type: CommandType.COMMAND,\n  multi: !0,\n  priority: DOC_CLIPBOARD_PRIORITY,\n  preconditions: whenDocOrEditor,\n  handler: /* @__PURE__ */ __name(async (accessor) => {\n    const docClipboardService = accessor.get(IDocClipboardService), clipboardItems = await accessor.get(IClipboardInterfaceService).read();\n    return clipboardItems.length === 0 ? !1 : docClipboardService.paste(clipboardItems);\n  }, \"handler\")\n}, _DocIMEInputManagerService = class _DocIMEInputManagerService extends RxDisposable {\n  constructor(_context) {\n    super();\n    __publicField(this, \"_previousActiveRange\", null);\n    __publicField(this, \"_undoMutationParamsCache\", []);\n    __publicField(this, \"_redoMutationParamsCache\", []);\n    this._context = _context;\n  }\n  clearUndoRedoMutationParamsCache() {\n    this._undoMutationParamsCache = [], this._redoMutationParamsCache = [];\n  }\n  getUndoRedoMutationParamsCache() {\n    return {\n      undoCache: this._undoMutationParamsCache,\n      redoCache: this._redoMutationParamsCache\n    };\n  }\n  setUndoRedoMutationParamsCache({ undoCache = [], redoCache = [] }) {\n    this._undoMutationParamsCache = undoCache, this._redoMutationParamsCache = redoCache;\n  }\n  getActiveRange() {\n    return this._previousActiveRange;\n  }\n  setActiveRange(range) {\n    this._previousActiveRange = range;\n  }\n  pushUndoRedoMutationParams(undoParams, redoParams) {\n    this._undoMutationParamsCache.push(undoParams), this._redoMutationParamsCache.push(redoParams);\n  }\n  fetchComposedUndoRedoMutationParams() {\n    if (this._undoMutationParamsCache.length === 0 || this._previousActiveRange == null || this._redoMutationParamsCache.length === 0)\n      return null;\n    const { unitId } = this._undoMutationParamsCache[0], undoMutationParams = {\n      unitId,\n      actions: this._undoMutationParamsCache.reverse().reduce((acc, cur) => JSONX.compose(acc, cur.actions), null),\n      textRanges: []\n      // Add empty array, will never use, just fix type error\n    };\n    return { redoMutationParams: {\n      unitId,\n      actions: this._redoMutationParamsCache.reduce((acc, cur) => JSONX.compose(acc, cur.actions), null),\n      textRanges: []\n      // Add empty array, will never use, just fix type error\n    }, undoMutationParams, previousActiveRange: this._previousActiveRange };\n  }\n  dispose() {\n    this._undoMutationParamsCache = [], this._redoMutationParamsCache = [], this._previousActiveRange = null;\n  }\n};\n__name(_DocIMEInputManagerService, \"DocIMEInputManagerService\");\nlet DocIMEInputManagerService = _DocIMEInputManagerService;\nconst IMEInputCommand = {\n  id: \"doc.command.ime-input\",\n  type: CommandType.COMMAND,\n  // eslint-disable-next-line max-lines-per-function\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    var _a28;\n    const { unitId, newText, oldTextLen, isCompositionEnd, isCompositionStart } = params, commandService = accessor.get(ICommandService), imeInputManagerService = (_a28 = accessor.get(IRenderManagerService).getRenderById(unitId)) == null ? void 0 : _a28.with(DocIMEInputManagerService), docDataModel = accessor.get(IUniverInstanceService).getCurrentUniverDocInstance();\n    if (docDataModel == null || imeInputManagerService == null)\n      return !1;\n    const previousActiveRange = imeInputManagerService.getActiveRange();\n    if (!previousActiveRange)\n      return !1;\n    const { style, segmentId } = previousActiveRange, body = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n    if (body == null)\n      return !1;\n    const insertRange = BuildTextUtils.selection.getInsertSelection(previousActiveRange, body);\n    Object.assign(previousActiveRange, insertRange);\n    const { startOffset } = previousActiveRange, len = newText.length, textRanges = [\n      {\n        startOffset: startOffset + len,\n        endOffset: startOffset + len,\n        collapsed: !0,\n        style\n      }\n    ], doMutation = {\n      id: RichTextEditingMutation.id,\n      params: {\n        unitId,\n        actions: [],\n        textRanges\n      }\n    }, textX = new TextX(), jsonX = JSONX.getInstance();\n    if (!previousActiveRange.collapsed && isCompositionStart) {\n      const { dos, retain, cursor } = BuildTextUtils.selection.getDeleteActions(previousActiveRange, segmentId, 0, body);\n      textX.push(...dos), doMutation.params.textRanges = [{\n        startOffset: startOffset + len + retain,\n        endOffset: startOffset + len + retain,\n        collapsed: !0\n      }];\n    } else\n      textX.push({\n        t: TextXActionType.RETAIN,\n        len: startOffset,\n        segmentId\n      });\n    oldTextLen > 0 && textX.push({\n      t: TextXActionType.DELETE,\n      len: oldTextLen,\n      line: 0,\n      segmentId\n    }), textX.push({\n      t: TextXActionType.INSERT,\n      body: {\n        dataStream: newText\n      },\n      len: newText.length,\n      line: 0,\n      segmentId\n    });\n    const path = getRichTextEditPath(docDataModel, segmentId);\n    doMutation.params.actions = jsonX.editOp(textX.serialize(), path), doMutation.params.noHistory = !isCompositionEnd, doMutation.params.isCompositionEnd = isCompositionEnd;\n    const result = commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n    return imeInputManagerService.pushUndoRedoMutationParams(result, doMutation.params), !!result;\n  }, \"handler\")\n};\nfunction handleInlineFormat(preCommandId, params, commandService) {\n  return commandService.executeCommand(SetInlineFormatCommand.id, {\n    preCommandId,\n    ...params != null ? params : {}\n  });\n}\n__name(handleInlineFormat, \"handleInlineFormat\");\nconst SetInlineFormatBoldCommandId = \"doc.command.set-inline-format-bold\", SetInlineFormatBoldCommand = {\n  id: SetInlineFormatBoldCommandId,\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    const commandService = accessor.get(ICommandService);\n    return handleInlineFormat(\n      SetInlineFormatBoldCommandId,\n      params,\n      commandService\n    );\n  }, \"handler\")\n}, SetInlineFormatItalicCommandId = \"doc.command.set-inline-format-italic\", SetInlineFormatItalicCommand = {\n  id: SetInlineFormatItalicCommandId,\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    const commandService = accessor.get(ICommandService);\n    return handleInlineFormat(\n      SetInlineFormatItalicCommandId,\n      params,\n      commandService\n    );\n  }, \"handler\")\n}, SetInlineFormatUnderlineCommandId = \"doc.command.set-inline-format-underline\", SetInlineFormatUnderlineCommand = {\n  id: SetInlineFormatUnderlineCommandId,\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    const commandService = accessor.get(ICommandService);\n    return handleInlineFormat(\n      SetInlineFormatUnderlineCommandId,\n      params,\n      commandService\n    );\n  }, \"handler\")\n}, SetInlineFormatStrikethroughCommandId = \"doc.command.set-inline-format-strikethrough\", SetInlineFormatStrikethroughCommand = {\n  id: SetInlineFormatStrikethroughCommandId,\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    const commandService = accessor.get(ICommandService);\n    return handleInlineFormat(\n      SetInlineFormatStrikethroughCommandId,\n      params,\n      commandService\n    );\n  }, \"handler\")\n}, SetInlineFormatSubscriptCommandId = \"doc.command.set-inline-format-subscript\", SetInlineFormatSubscriptCommand = {\n  id: SetInlineFormatSubscriptCommandId,\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    const commandService = accessor.get(ICommandService);\n    return handleInlineFormat(\n      SetInlineFormatSubscriptCommandId,\n      params,\n      commandService\n    );\n  }, \"handler\")\n}, SetInlineFormatSuperscriptCommandId = \"doc.command.set-inline-format-superscript\", SetInlineFormatSuperscriptCommand = {\n  id: SetInlineFormatSuperscriptCommandId,\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    const commandService = accessor.get(ICommandService);\n    return handleInlineFormat(\n      SetInlineFormatSuperscriptCommandId,\n      params,\n      commandService\n    );\n  }, \"handler\")\n}, SetInlineFormatFontSizeCommandId = \"doc.command.set-inline-format-fontsize\", SetInlineFormatFontSizeCommand = {\n  id: SetInlineFormatFontSizeCommandId,\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    const commandService = accessor.get(ICommandService);\n    return handleInlineFormat(\n      SetInlineFormatFontSizeCommandId,\n      params,\n      commandService\n    );\n  }, \"handler\")\n}, SetInlineFormatFontFamilyCommandId = \"doc.command.set-inline-format-font-family\", SetInlineFormatFontFamilyCommand = {\n  id: SetInlineFormatFontFamilyCommandId,\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    const commandService = accessor.get(ICommandService);\n    return handleInlineFormat(\n      SetInlineFormatFontFamilyCommandId,\n      params,\n      commandService\n    );\n  }, \"handler\")\n}, SetInlineFormatTextColorCommandId = \"doc.command.set-inline-format-text-color\", SetInlineFormatTextColorCommand = {\n  id: SetInlineFormatTextColorCommandId,\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    const commandService = accessor.get(ICommandService);\n    return handleInlineFormat(\n      SetInlineFormatTextColorCommandId,\n      params,\n      commandService\n    );\n  }, \"handler\")\n}, SetInlineFormatTextBackgroundColorCommandId = \"doc.command.set-inline-format-text-background-color\", SetInlineFormatTextBackgroundColorCommand = {\n  id: SetInlineFormatTextBackgroundColorCommandId,\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    const commandService = accessor.get(ICommandService);\n    return handleInlineFormat(\n      SetInlineFormatTextBackgroundColorCommandId,\n      params,\n      commandService\n    );\n  }, \"handler\")\n}, ResetInlineFormatTextBackgroundColorCommandId = \"doc.command.reset-inline-format-text-background-color\", ResetInlineFormatTextBackgroundColorCommand = {\n  id: ResetInlineFormatTextBackgroundColorCommandId,\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    const commandService = accessor.get(ICommandService);\n    return handleInlineFormat(\n      ResetInlineFormatTextBackgroundColorCommandId,\n      params,\n      commandService\n    );\n  }, \"handler\")\n}, COMMAND_ID_TO_FORMAT_KEY_MAP = {\n  [SetInlineFormatBoldCommand.id]: \"bl\",\n  [SetInlineFormatItalicCommand.id]: \"it\",\n  [SetInlineFormatUnderlineCommand.id]: \"ul\",\n  [SetInlineFormatStrikethroughCommand.id]: \"st\",\n  [SetInlineFormatFontSizeCommand.id]: \"fs\",\n  [SetInlineFormatFontFamilyCommand.id]: \"ff\",\n  [SetInlineFormatTextColorCommand.id]: \"cl\",\n  [SetInlineFormatTextBackgroundColorCommand.id]: \"bg\",\n  [ResetInlineFormatTextBackgroundColorCommand.id]: \"bg\",\n  [SetInlineFormatSubscriptCommand.id]: \"va\",\n  [SetInlineFormatSuperscriptCommand.id]: \"va\"\n}, SetInlineFormatCommand = {\n  id: \"doc.command.set-inline-format\",\n  type: CommandType.COMMAND,\n  // eslint-disable-next-line max-lines-per-function\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    const { value, preCommandId } = params, commandService = accessor.get(ICommandService), docSelectionManagerService = accessor.get(DocSelectionManagerService), univerInstanceService = accessor.get(IUniverInstanceService), docRanges = docSelectionManagerService.getDocRanges();\n    if (docRanges.length === 0)\n      return !1;\n    const segmentId = docRanges[0].segmentId, docDataModel = univerInstanceService.getCurrentUniverDocInstance();\n    if (docDataModel == null)\n      return !1;\n    const unitId = docDataModel.getUnitId();\n    let formatValue;\n    switch (preCommandId) {\n      case SetInlineFormatBoldCommand.id:\n      case SetInlineFormatItalicCommand.id:\n      case SetInlineFormatUnderlineCommand.id:\n      case SetInlineFormatStrikethroughCommand.id:\n      case SetInlineFormatSubscriptCommand.id:\n      case SetInlineFormatSuperscriptCommand.id: {\n        formatValue = getReverseFormatValueInSelection(\n          docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody().textRuns,\n          preCommandId,\n          docRanges\n        );\n        break;\n      }\n      case SetInlineFormatFontSizeCommand.id:\n      case SetInlineFormatFontFamilyCommand.id: {\n        formatValue = value;\n        break;\n      }\n      case SetInlineFormatTextColorCommand.id:\n      case SetInlineFormatTextBackgroundColorCommand.id: {\n        formatValue = {\n          rgb: value\n        };\n        break;\n      }\n      case ResetInlineFormatTextBackgroundColorCommand.id: {\n        formatValue = {\n          rgb: null\n        };\n        break;\n      }\n      default:\n        throw new Error(`Unknown command: ${preCommandId} in handleInlineFormat`);\n    }\n    const doMutation = {\n      id: RichTextEditingMutation.id,\n      params: {\n        unitId,\n        actions: [],\n        textRanges: docRanges\n      }\n    }, textX = new TextX(), jsonX = JSONX.getInstance(), memoryCursor = new MemoryCursor();\n    memoryCursor.reset();\n    for (const range of docRanges) {\n      const { startOffset, endOffset } = range;\n      if (startOffset == null || endOffset == null)\n        continue;\n      const body = {\n        dataStream: \"\",\n        textRuns: [\n          {\n            st: 0,\n            ed: endOffset - startOffset,\n            ts: {\n              [COMMAND_ID_TO_FORMAT_KEY_MAP[preCommandId]]: formatValue\n            }\n          }\n        ]\n      }, len = startOffset - memoryCursor.cursor;\n      len !== 0 && textX.push({\n        t: TextXActionType.RETAIN,\n        len,\n        segmentId\n      }), textX.push({\n        t: TextXActionType.RETAIN,\n        body,\n        len: endOffset - startOffset,\n        segmentId\n      }), memoryCursor.reset(), memoryCursor.moveCursor(endOffset);\n    }\n    const path = getRichTextEditPath(docDataModel, segmentId);\n    return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n  }, \"handler\")\n};\nfunction isTextDecoration(value) {\n  return value !== null && typeof value == \"object\";\n}\n__name(isTextDecoration, \"isTextDecoration\");\nfunction getReverseFormatValueInSelection(textRuns, preCommandId, docRanges) {\n  let ti = 0, si = 0;\n  const key = COMMAND_ID_TO_FORMAT_KEY_MAP[preCommandId];\n  for (; ti !== textRuns.length && si !== docRanges.length; ) {\n    const { startOffset, endOffset } = docRanges[si], { st, ed, ts } = textRuns[ti];\n    if (endOffset <= st)\n      si++;\n    else if (ed <= startOffset)\n      ti++;\n    else {\n      if (/bl|it/.test(key))\n        return (ts == null ? void 0 : ts[key]) === BooleanNumber.TRUE ? BooleanNumber.FALSE : BooleanNumber.TRUE;\n      if (/ul|st/.test(key))\n        return isTextDecoration(ts == null ? void 0 : ts[key]) && (ts == null ? void 0 : ts[key]).s === BooleanNumber.TRUE ? {\n          s: BooleanNumber.FALSE\n        } : {\n          s: BooleanNumber.TRUE\n        };\n      if (/va/.test(key))\n        return preCommandId === SetInlineFormatSubscriptCommand.id ? (ts == null ? void 0 : ts[key]) === BaselineOffset.SUBSCRIPT ? BaselineOffset.NORMAL : BaselineOffset.SUBSCRIPT : (ts == null ? void 0 : ts[key]) === BaselineOffset.SUPERSCRIPT ? BaselineOffset.NORMAL : BaselineOffset.SUPERSCRIPT;\n      ti++;\n    }\n  }\n  return /bl|it/.test(key) ? BooleanNumber.TRUE : /ul|st/.test(key) ? {\n    s: BooleanNumber.TRUE\n  } : preCommandId === SetInlineFormatSubscriptCommand.id ? BaselineOffset.SUBSCRIPT : BaselineOffset.SUPERSCRIPT;\n}\n__name(getReverseFormatValueInSelection, \"getReverseFormatValueInSelection\");\nconst ListOperationCommand = {\n  id: \"doc.command.list-operation\",\n  type: CommandType.COMMAND,\n  // eslint-disable-next-line max-lines-per-function, complexity\n  handler: /* @__PURE__ */ __name((accessor, params) => {\n    var _a28, _b, _c, _d, _e, _f;\n    const docSelectionManagerService = accessor.get(DocSelectionManagerService), univerInstanceService = accessor.get(IUniverInstanceService), commandService = accessor.get(ICommandService);\n    let listType = params.listType;\n    const docDataModel = univerInstanceService.getCurrentUniverDocInstance(), docRanges = (_a28 = docSelectionManagerService.getDocRanges()) != null ? _a28 : [];\n    if (docDataModel == null || docRanges.length === 0)\n      return !1;\n    const segmentId = docRanges[0].segmentId, paragraphs = (_b = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()) == null ? void 0 : _b.paragraphs;\n    if (paragraphs == null)\n      return !1;\n    const sectionBreaks = (_d = (_c = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()) == null ? void 0 : _c.sectionBreaks) != null ? _d : [], currentParagraphs = getParagraphsInRanges(docRanges, paragraphs), unitId = docDataModel.getUnitId(), isAlreadyList = currentParagraphs.every((paragraph) => {\n      var _a29;\n      return ((_a29 = paragraph.bullet) == null ? void 0 : _a29.listType.indexOf(listType)) === 0;\n    });\n    let listId = Tools.generateRandomId(6);\n    if (currentParagraphs.length === 1) {\n      const curIndex = paragraphs.indexOf(currentParagraphs[0]), prevParagraph = paragraphs[curIndex - 1], nextParagraph = paragraphs[curIndex + 1];\n      prevParagraph && prevParagraph.bullet && prevParagraph.bullet.listType.indexOf(listType) === 0 ? (listId = prevParagraph.bullet.listId, listType !== PresetListType.CHECK_LIST && (listType = prevParagraph.bullet.listType)) : nextParagraph && nextParagraph.bullet && nextParagraph.bullet.listType.indexOf(listType) === 0 && (listId = nextParagraph.bullet.listId, listType !== PresetListType.CHECK_LIST && (listType = nextParagraph.bullet.listType));\n    }\n    const doMutation = {\n      id: RichTextEditingMutation.id,\n      params: {\n        unitId,\n        actions: [],\n        textRanges: docRanges\n      }\n    }, memoryCursor = new MemoryCursor();\n    memoryCursor.reset();\n    const textX = new TextX(), jsonX = JSONX.getInstance(), customLists = (_e = docDataModel.getSnapshot().lists) != null ? _e : {}, lists = {\n      ...PRESET_LIST_TYPE,\n      ...customLists\n    }, { defaultTabStop = 36 } = docDataModel.getSnapshot().documentStyle;\n    for (const paragraph of currentParagraphs) {\n      const { startIndex, paragraphStyle = {}, bullet } = paragraph, { indentFirstLine, snapToGrid, indentStart } = paragraphStyle, paragraphProperties = lists[listType].nestingLevel[0].paragraphProperties || {}, { hanging: listHanging, indentStart: listIndentStart } = paragraphProperties, { charSpace, gridType } = findNearestSectionBreak(startIndex, sectionBreaks) || { charSpace: 0, gridType: GridType.LINES }, charSpaceApply = getCharSpaceApply(charSpace, defaultTabStop, gridType, snapToGrid);\n      textX.push({\n        t: TextXActionType.RETAIN,\n        len: startIndex - memoryCursor.cursor,\n        segmentId\n      }), textX.push({\n        t: TextXActionType.RETAIN,\n        len: 1,\n        body: {\n          dataStream: \"\",\n          paragraphs: [\n            isAlreadyList ? {\n              paragraphStyle: {\n                ...paragraphStyle,\n                hanging: void 0,\n                indentStart: indentStart ? { v: Math.max(0, getNumberUnitValue(indentStart, charSpaceApply) + getNumberUnitValue(listHanging, charSpaceApply) - getNumberUnitValue(listIndentStart, charSpaceApply)) } : void 0\n              },\n              startIndex: 0\n            } : {\n              startIndex: 0,\n              paragraphStyle: {\n                ...paragraphStyle,\n                indentFirstLine: void 0,\n                hanging: listHanging,\n                indentStart: { v: getNumberUnitValue(listIndentStart, charSpaceApply) - getNumberUnitValue(listHanging, charSpaceApply) + getNumberUnitValue(indentFirstLine, charSpaceApply) + getNumberUnitValue(indentStart, charSpaceApply) }\n              },\n              bullet: {\n                nestingLevel: (_f = bullet == null ? void 0 : bullet.nestingLevel) != null ? _f : 0,\n                textStyle: {\n                  fs: 20\n                },\n                listType,\n                listId\n              }\n            }\n          ]\n        },\n        segmentId,\n        coverType: UpdateDocsAttributeType.REPLACE\n      }), memoryCursor.moveCursorTo(startIndex + 1);\n    }\n    const path = getRichTextEditPath(docDataModel, segmentId);\n    return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n  }, \"handler\")\n}, ChangeListTypeCommand = {\n  id: \"doc.command.change-list-type\",\n  type: CommandType.COMMAND,\n  // eslint-disable-next-line max-lines-per-function\n  handler: /* @__PURE__ */ __name((accessor, params) => {\n    var _a28, _b, _c, _d, _e, _f;\n    const docSelectionManagerService = accessor.get(DocSelectionManagerService), univerInstanceService = accessor.get(IUniverInstanceService), commandService = accessor.get(ICommandService), { listType } = params, docDataModel = univerInstanceService.getCurrentUniverDocInstance(), activeRanges = docSelectionManagerService.getDocRanges();\n    if (docDataModel == null || activeRanges == null || !activeRanges.length)\n      return !1;\n    const { segmentId } = activeRanges[0], selections = (_a28 = docSelectionManagerService.getDocRanges()) != null ? _a28 : [], paragraphs = (_b = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()) == null ? void 0 : _b.paragraphs;\n    if (paragraphs == null)\n      return !1;\n    const sectionBreaks = (_d = (_c = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()) == null ? void 0 : _c.sectionBreaks) != null ? _d : [], currentParagraphs = getParagraphsRelative(activeRanges, paragraphs), unitId = docDataModel.getUnitId(), listId = Tools.generateRandomId(6), doMutation = {\n      id: RichTextEditingMutation.id,\n      params: {\n        unitId,\n        actions: [],\n        textRanges: selections\n      }\n    }, memoryCursor = new MemoryCursor();\n    memoryCursor.reset();\n    const textX = new TextX(), jsonX = JSONX.getInstance(), customLists = (_e = docDataModel.getSnapshot().lists) != null ? _e : {}, lists = {\n      ...PRESET_LIST_TYPE,\n      ...customLists\n    }, { defaultTabStop = 36 } = docDataModel.getSnapshot().documentStyle;\n    for (const paragraph of currentParagraphs) {\n      const { startIndex, paragraphStyle = {}, bullet } = paragraph, { indentFirstLine, snapToGrid, indentStart } = paragraphStyle, paragraphProperties = lists[listType].nestingLevel[0].paragraphProperties || {}, { hanging: listHanging, indentStart: listIndentStart } = paragraphProperties, { charSpace, gridType } = findNearestSectionBreak(startIndex, sectionBreaks) || { charSpace: 0, gridType: GridType.LINES }, charSpaceApply = getCharSpaceApply(charSpace, defaultTabStop, gridType, snapToGrid);\n      textX.push({\n        t: TextXActionType.RETAIN,\n        len: startIndex - memoryCursor.cursor,\n        segmentId\n      }), textX.push({\n        t: TextXActionType.RETAIN,\n        len: 1,\n        body: {\n          dataStream: \"\",\n          paragraphs: [\n            {\n              startIndex: 0,\n              paragraphStyle: {\n                ...paragraphStyle,\n                indentFirstLine: void 0,\n                hanging: listHanging,\n                indentStart: { v: getNumberUnitValue(listIndentStart, charSpaceApply) - getNumberUnitValue(listHanging, charSpaceApply) + getNumberUnitValue(indentFirstLine, charSpaceApply) + getNumberUnitValue(indentStart, charSpaceApply) }\n              },\n              bullet: {\n                nestingLevel: (_f = bullet == null ? void 0 : bullet.nestingLevel) != null ? _f : 0,\n                textStyle: (bullet == null ? void 0 : bullet.listType) === listType ? bullet.textStyle : {\n                  fs: 20\n                },\n                listType,\n                listId\n              }\n            }\n          ]\n        },\n        segmentId,\n        coverType: UpdateDocsAttributeType.REPLACE\n      }), memoryCursor.moveCursorTo(startIndex + 1);\n    }\n    const path = getRichTextEditPath(docDataModel, segmentId);\n    return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n  }, \"handler\")\n};\nvar ChangeListNestingLevelType = /* @__PURE__ */ ((ChangeListNestingLevelType2) => (ChangeListNestingLevelType2[ChangeListNestingLevelType2.increase = 1] = \"increase\", ChangeListNestingLevelType2[ChangeListNestingLevelType2.decrease = -1] = \"decrease\", ChangeListNestingLevelType2))(ChangeListNestingLevelType || {});\nconst ChangeListNestingLevelCommand = {\n  id: \"doc.command.change-list-nesting-level\",\n  type: CommandType.COMMAND,\n  // eslint-disable-next-line max-lines-per-function\n  handler: /* @__PURE__ */ __name((accessor, params) => {\n    var _a28, _b, _c, _d, _e;\n    if (!params)\n      return !1;\n    const { type } = params, docSelectionManagerService = accessor.get(DocSelectionManagerService), univerInstanceService = accessor.get(IUniverInstanceService), commandService = accessor.get(ICommandService), docDataModel = univerInstanceService.getCurrentUniverDocInstance(), activeRange = docSelectionManagerService.getActiveTextRange();\n    if (docDataModel == null || activeRange == null)\n      return !1;\n    const { segmentId } = activeRange, tables = (_b = (_a28 = docDataModel.getBody()) == null ? void 0 : _a28.tables) != null ? _b : [], selections = (_c = docSelectionManagerService.getDocRanges()) != null ? _c : [], paragraphs = (_d = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()) == null ? void 0 : _d.paragraphs;\n    if (paragraphs == null)\n      return !1;\n    const currentParagraphs = getParagraphsInRange(activeRange, paragraphs), unitId = docDataModel.getUnitId(), doMutation = {\n      id: RichTextEditingMutation.id,\n      params: {\n        unitId,\n        actions: [],\n        textRanges: selections\n      }\n    }, memoryCursor = new MemoryCursor();\n    memoryCursor.reset();\n    const textX = new TextX(), jsonX = JSONX.getInstance(), customLists = (_e = docDataModel.getSnapshot().lists) != null ? _e : {}, lists = {\n      ...PRESET_LIST_TYPE,\n      ...customLists\n    };\n    for (const paragraph of currentParagraphs) {\n      const { startIndex, paragraphStyle = {}, bullet } = paragraph, isInTable = hasParagraphInTable(paragraph, tables);\n      if (textX.push({\n        t: TextXActionType.RETAIN,\n        len: startIndex - memoryCursor.cursor,\n        segmentId\n      }), bullet) {\n        const listType = bullet.listType;\n        let maxLevel = lists[listType].nestingLevel.length - 1;\n        isInTable && (maxLevel = Math.min(maxLevel, 2)), textX.push({\n          t: TextXActionType.RETAIN,\n          len: 1,\n          body: {\n            dataStream: \"\",\n            paragraphs: [\n              {\n                startIndex: 0,\n                paragraphStyle: {\n                  ...paragraphStyle\n                },\n                bullet: {\n                  ...bullet,\n                  nestingLevel: Math.max(Math.min(bullet.nestingLevel + type, maxLevel), 0)\n                }\n              }\n            ]\n          },\n          segmentId,\n          coverType: UpdateDocsAttributeType.REPLACE\n        });\n      } else\n        textX.push({\n          t: TextXActionType.RETAIN,\n          len: 1\n        });\n      memoryCursor.moveCursorTo(startIndex + 1);\n    }\n    const path = getRichTextEditPath(docDataModel, segmentId);\n    return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n  }, \"handler\")\n}, BulletListCommand = {\n  id: \"doc.command.bullet-list\",\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name((accessor, params) => {\n    const commandService = accessor.get(ICommandService);\n    return params != null && params.value ? commandService.syncExecuteCommand(ChangeListTypeCommand.id, {\n      listType: params.value\n    }) : commandService.syncExecuteCommand(ListOperationCommand.id, {\n      listType: PresetListType.BULLET_LIST\n    });\n  }, \"handler\")\n}, CheckListCommand = {\n  id: \"doc.command.check-list\",\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name((accessor, params) => {\n    const commandService = accessor.get(ICommandService);\n    return params != null && params.value ? commandService.syncExecuteCommand(ChangeListTypeCommand.id, {\n      listType: params.value\n    }) : commandService.syncExecuteCommand(ListOperationCommand.id, {\n      listType: PresetListType.CHECK_LIST\n    });\n  }, \"handler\")\n}, ToggleCheckListCommand = {\n  id: \"doc.command.toggle-check-list\",\n  type: CommandType.COMMAND,\n  // eslint-disable-next-line max-lines-per-function\n  handler: /* @__PURE__ */ __name((accessor, params) => {\n    var _a28;\n    if (!params)\n      return !1;\n    const univerInstanceService = accessor.get(IUniverInstanceService), commandService = accessor.get(ICommandService), { index, segmentId } = params, docDataModel = univerInstanceService.getCurrentUniverDocInstance();\n    if (docDataModel == null)\n      return !1;\n    const paragraphs = (_a28 = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()) == null ? void 0 : _a28.paragraphs;\n    if (paragraphs == null)\n      return !1;\n    const currentParagraph = paragraphs.find((p2) => p2.startIndex === index), unitId = docDataModel.getUnitId();\n    if (!(currentParagraph != null && currentParagraph.bullet) || currentParagraph.bullet.listType.indexOf(PresetListType.CHECK_LIST) === -1)\n      return !1;\n    const doMutation = {\n      id: RichTextEditingMutation.id,\n      params: {\n        unitId,\n        actions: [],\n        textRanges: [],\n        segmentId\n      }\n    }, memoryCursor = new MemoryCursor();\n    memoryCursor.reset();\n    const textX = new TextX(), jsonX = JSONX.getInstance(), { startIndex, paragraphStyle = {} } = currentParagraph, listType = currentParagraph.bullet.listType === PresetListType.CHECK_LIST ? PresetListType.CHECK_LIST_CHECKED : PresetListType.CHECK_LIST;\n    textX.push({\n      t: TextXActionType.RETAIN,\n      len: startIndex - memoryCursor.cursor,\n      segmentId\n    }), textX.push({\n      t: TextXActionType.RETAIN,\n      len: 1,\n      body: {\n        dataStream: \"\",\n        paragraphs: [\n          {\n            ...currentParagraph,\n            paragraphStyle,\n            startIndex: 0,\n            bullet: {\n              ...currentParagraph.bullet,\n              listType\n            }\n          }\n        ]\n      },\n      coverType: UpdateDocsAttributeType.REPLACE,\n      segmentId\n    }), memoryCursor.moveCursorTo(startIndex + 1);\n    const path = getRichTextEditPath(docDataModel, segmentId);\n    return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n  }, \"handler\")\n}, OrderListCommand = {\n  id: \"doc.command.order-list\",\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name((accessor, params) => {\n    const commandService = accessor.get(ICommandService);\n    return params != null && params.value ? commandService.syncExecuteCommand(ChangeListTypeCommand.id, {\n      listType: params.value\n    }) : commandService.syncExecuteCommand(ListOperationCommand.id, {\n      listType: PresetListType.ORDER_LIST\n    });\n  }, \"handler\")\n}, QuickListCommand = {\n  id: \"doc.command.quick-list\",\n  type: CommandType.COMMAND,\n  // eslint-disable-next-line max-lines-per-function\n  handler(accessor, params) {\n    var _a28, _b, _c, _d, _e;\n    if (!params)\n      return !1;\n    const docSelectionManagerService = accessor.get(DocSelectionManagerService), univerInstanceService = accessor.get(IUniverInstanceService), commandService = accessor.get(ICommandService), docDataModel = univerInstanceService.getCurrentUniverDocInstance(), activeRange = docSelectionManagerService.getActiveTextRange();\n    if (docDataModel == null || activeRange == null)\n      return !1;\n    const { segmentId } = activeRange, { listType, paragraph } = params, { paragraphStart, paragraphEnd } = paragraph, textX = new TextX(), jsonX = JSONX.getInstance(), { defaultTabStop = 36 } = docDataModel.getSnapshot().documentStyle, sectionBreaks = (_b = (_a28 = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()) == null ? void 0 : _a28.sectionBreaks) != null ? _b : [], { startIndex, paragraphStyle = {} } = paragraph, { indentFirstLine, snapToGrid, indentStart } = paragraphStyle, paragraphProperties = PRESET_LIST_TYPE[listType].nestingLevel[0].paragraphProperties || {}, { hanging: listHanging, indentStart: listIndentStart } = paragraphProperties, bulletParagraphTextStyle = paragraphProperties.textStyle, { charSpace, gridType } = findNearestSectionBreak(startIndex, sectionBreaks) || { charSpace: 0, gridType: GridType.LINES }, charSpaceApply = getCharSpaceApply(charSpace, defaultTabStop, gridType, snapToGrid);\n    let listId = Tools.generateRandomId(6);\n    const paragraphs = (_d = (_c = docDataModel.getBody()) == null ? void 0 : _c.paragraphs) != null ? _d : [], curIndex = paragraphs.findIndex((i) => i.startIndex === paragraph.startIndex), prevParagraph = paragraphs[curIndex - 1], nextParagraph = paragraphs[curIndex + 1];\n    prevParagraph && prevParagraph.bullet && prevParagraph.bullet.listType.indexOf(listType) === 0 ? listId = prevParagraph.bullet.listId : nextParagraph && nextParagraph.bullet && nextParagraph.bullet.listType.indexOf(listType) === 0 && (listId = nextParagraph.bullet.listId);\n    const doMutation = {\n      id: RichTextEditingMutation.id,\n      params: {\n        unitId: docDataModel.getUnitId(),\n        actions: [],\n        textRanges: [{\n          startOffset: paragraphStart,\n          endOffset: paragraphStart,\n          collapsed: !0\n        }]\n      }\n    };\n    textX.push({\n      t: TextXActionType.RETAIN,\n      len: paragraphStart\n    }), textX.push({\n      t: TextXActionType.DELETE,\n      len: paragraphEnd - paragraphStart,\n      line: 1\n    }), textX.push({\n      t: TextXActionType.RETAIN,\n      len: 1,\n      body: {\n        dataStream: \"\",\n        paragraphs: [\n          {\n            startIndex: 0,\n            paragraphStyle: {\n              ...paragraphStyle,\n              textStyle: {\n                ...paragraphStyle.textStyle,\n                ...bulletParagraphTextStyle\n              },\n              indentFirstLine: void 0,\n              hanging: listHanging,\n              indentStart: { v: getNumberUnitValue(listIndentStart, charSpaceApply) - getNumberUnitValue(listHanging, charSpaceApply) + getNumberUnitValue(indentFirstLine, charSpaceApply) + getNumberUnitValue(indentStart, charSpaceApply) }\n            },\n            bullet: {\n              ...(_e = paragraph.bullet) != null ? _e : {\n                nestingLevel: 0,\n                textStyle: {\n                  fs: 20\n                }\n              },\n              listType,\n              listId\n            }\n          }\n        ]\n      }\n    });\n    const path = getRichTextEditPath(docDataModel, segmentId);\n    return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n  }\n};\nfunction getParagraphsInRange(activeRange, paragraphs) {\n  const { startOffset, endOffset } = activeRange, results = [];\n  let start = -1;\n  for (const paragraph of paragraphs) {\n    const { startIndex } = paragraph;\n    (startOffset > start && startOffset <= startIndex || endOffset > start && endOffset <= startIndex || startIndex >= startOffset && startIndex <= endOffset) && results.push(paragraph), start = startIndex;\n  }\n  return results;\n}\n__name(getParagraphsInRange, \"getParagraphsInRange\");\nfunction getParagraphsRelative(ranges, paragraphs) {\n  const selectionParagraphs = getParagraphsInRanges(ranges, paragraphs), startIndex = paragraphs.indexOf(selectionParagraphs[0]), endIndex = paragraphs.indexOf(selectionParagraphs[selectionParagraphs.length - 1]);\n  if (selectionParagraphs[0].bullet)\n    for (let i = startIndex - 1; i >= 0; i--) {\n      const prevParagraph = paragraphs[i];\n      prevParagraph.bullet && prevParagraph.bullet.listId === selectionParagraphs[0].bullet.listId && selectionParagraphs.unshift(prevParagraph);\n    }\n  const lastParagraph = selectionParagraphs[selectionParagraphs.length - 1];\n  if (lastParagraph.bullet)\n    for (let i = endIndex + 1; i < paragraphs.length; i++) {\n      const nextParagraph = paragraphs[i];\n      nextParagraph.bullet && nextParagraph.bullet.listId === lastParagraph.bullet.listId && selectionParagraphs.push(nextParagraph);\n    }\n  return selectionParagraphs;\n}\n__name(getParagraphsRelative, \"getParagraphsRelative\");\nfunction getParagraphsInRanges(ranges, paragraphs) {\n  const results = [];\n  for (const range of ranges) {\n    const ps = getParagraphsInRange(range, paragraphs);\n    results.push(...ps);\n  }\n  return results;\n}\n__name(getParagraphsInRanges, \"getParagraphsInRanges\");\nfunction findNearestSectionBreak(currentIndex, sectionBreaks) {\n  const sortedSectionBreaks = sectionBreaks.sort(sortRulesFactory(\"startIndex\"));\n  for (let i = 0; i < sortedSectionBreaks.length; i++) {\n    const sectionBreak = sectionBreaks[i];\n    if (sectionBreak.startIndex >= currentIndex)\n      return sectionBreak;\n  }\n}\n__name(findNearestSectionBreak, \"findNearestSectionBreak\");\nconst AlignOperationCommand = {\n  id: \"doc.command.align-action\",\n  type: CommandType.COMMAND,\n  // eslint-disable-next-line max-lines-per-function\n  handler: /* @__PURE__ */ __name((accessor, params) => {\n    var _a28;\n    const docSelectionManagerService = accessor.get(DocSelectionManagerService), univerInstanceService = accessor.get(IUniverInstanceService), commandService = accessor.get(ICommandService), { alignType } = params, docDataModel = univerInstanceService.getCurrentUniverDocInstance();\n    if (docDataModel == null)\n      return !1;\n    const allRanges = docSelectionManagerService.getDocRanges();\n    if (allRanges.length === 0)\n      return !1;\n    const segmentId = allRanges[0].segmentId, paragraphs = (_a28 = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()) == null ? void 0 : _a28.paragraphs;\n    if (paragraphs == null)\n      return !1;\n    const currentParagraphs = getParagraphsInRanges(allRanges, paragraphs), unitId = docDataModel.getUnitId(), isAlreadyAligned = currentParagraphs.every((paragraph) => {\n      var _a29;\n      return ((_a29 = paragraph.paragraphStyle) == null ? void 0 : _a29.horizontalAlign) === alignType;\n    }), doMutation = {\n      id: RichTextEditingMutation.id,\n      params: {\n        unitId,\n        actions: [],\n        textRanges: allRanges\n      }\n    }, memoryCursor = new MemoryCursor();\n    memoryCursor.reset();\n    const textX = new TextX(), jsonX = JSONX.getInstance();\n    for (const paragraph of currentParagraphs) {\n      const { startIndex } = paragraph;\n      textX.push({\n        t: TextXActionType.RETAIN,\n        len: startIndex - memoryCursor.cursor,\n        segmentId\n      });\n      const paragraphStyle = {\n        ...paragraph.paragraphStyle,\n        horizontalAlign: isAlreadyAligned ? HorizontalAlign.UNSPECIFIED : alignType\n      };\n      textX.push({\n        t: TextXActionType.RETAIN,\n        len: 1,\n        body: {\n          dataStream: \"\",\n          paragraphs: [\n            {\n              ...paragraph,\n              paragraphStyle,\n              startIndex: 0\n            }\n          ]\n        },\n        segmentId,\n        coverType: UpdateDocsAttributeType.REPLACE\n      }), memoryCursor.moveCursorTo(startIndex + 1);\n    }\n    const path = getRichTextEditPath(docDataModel, segmentId);\n    return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n  }, \"handler\")\n}, AlignLeftCommand = {\n  id: \"doc.command.align-left\",\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name((accessor) => accessor.get(ICommandService).syncExecuteCommand(AlignOperationCommand.id, {\n    alignType: HorizontalAlign.LEFT\n  }), \"handler\")\n}, AlignCenterCommand = {\n  id: \"doc.command.align-center\",\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name((accessor) => accessor.get(ICommandService).syncExecuteCommand(AlignOperationCommand.id, {\n    alignType: HorizontalAlign.CENTER\n  }), \"handler\")\n}, AlignRightCommand = {\n  id: \"doc.command.align-right\",\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name((accessor) => accessor.get(ICommandService).syncExecuteCommand(AlignOperationCommand.id, {\n    alignType: HorizontalAlign.RIGHT\n  }), \"handler\")\n}, AlignJustifyCommand = {\n  id: \"doc.command.align-justify\",\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name((accessor) => accessor.get(ICommandService).syncExecuteCommand(AlignOperationCommand.id, {\n    alignType: HorizontalAlign.JUSTIFIED\n  }), \"handler\")\n}, ReplaceContentCommand = {\n  id: \"doc.command-replace-content\",\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    const { unitId, body, textRanges, segmentId = \"\", options } = params, univerInstanceService = accessor.get(IUniverInstanceService), commandService = accessor.get(ICommandService), docSelectionManagerService = accessor.get(DocSelectionManagerService), docDataModel = univerInstanceService.getUniverDocInstance(unitId), prevBody = docDataModel == null ? void 0 : docDataModel.getSnapshot().body, selections = docSelectionManagerService.getCurrentTextRanges();\n    if (docDataModel == null || prevBody == null || !Array.isArray(selections) || selections.length === 0)\n      return !1;\n    const doMutation = getMutationParams(unitId, segmentId, docDataModel, prevBody, body);\n    return doMutation.params.textRanges = textRanges, options && (doMutation.params.options = options), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n  }, \"handler\")\n}, CoverContentCommand = {\n  id: \"doc.command-cover-content\",\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    const { unitId, body, segmentId = \"\" } = params, univerInstanceService = accessor.get(IUniverInstanceService), commandService = accessor.get(ICommandService), undoRedoService = accessor.get(IUndoRedoService), docDatModel = univerInstanceService.getUniverDocInstance(unitId), prevBody = docDatModel == null ? void 0 : docDatModel.getSnapshot().body;\n    if (docDatModel == null || prevBody == null)\n      return !1;\n    const doMutation = getMutationParams(unitId, segmentId, docDatModel, prevBody, body);\n    return doMutation.params.noNeedSetTextRange = !0, doMutation.params.noHistory = !0, commandService.syncExecuteCommand(\n      doMutation.id,\n      doMutation.params\n    ), undoRedoService.clearUndoRedo(unitId), !0;\n  }, \"handler\")\n};\nfunction getMutationParams(unitId, segmentId, docDatModel, prevBody, body) {\n  const doMutation = {\n    id: RichTextEditingMutation.id,\n    params: {\n      unitId,\n      actions: [],\n      textRanges: []\n    }\n  }, textX = new TextX(), jsonX = JSONX.getInstance(), deleteLen = (prevBody == null ? void 0 : prevBody.dataStream.length) - 2;\n  deleteLen > 0 && textX.push({\n    t: TextXActionType.DELETE,\n    len: deleteLen,\n    line: 0,\n    segmentId\n  }), body.dataStream.length > 0 && textX.push({\n    t: TextXActionType.INSERT,\n    body,\n    len: body.dataStream.length,\n    line: 0,\n    segmentId\n  });\n  const path = getRichTextEditPath(docDatModel, segmentId);\n  return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), doMutation;\n}\n__name(getMutationParams, \"getMutationParams\");\nCommandType.COMMAND;\nconst SetDocZoomRatioUndoMutationFactory = /* @__PURE__ */ __name((accessor, params) => {\n  const documentModel = accessor.get(IUniverInstanceService).getUniverDocInstance(params.unitId), old = (documentModel == null ? void 0 : documentModel.zoomRatio) || 1;\n  return {\n    ...Tools.deepClone(params),\n    zoomRatio: old\n  };\n}, \"SetDocZoomRatioUndoMutationFactory\"), SetDocZoomRatioOperation = {\n  id: \"doc.operation.set-zoom-ratio\",\n  type: CommandType.OPERATION,\n  handler: /* @__PURE__ */ __name((accessor, params) => {\n    const documentModel = accessor.get(IUniverInstanceService).getUniverDocInstance(params.unitId);\n    if (!documentModel)\n      return !1;\n    const documentData = documentModel.getSnapshot();\n    return documentData.settings == null ? documentData.settings = {\n      zoomRatio: params.zoomRatio\n    } : documentData.settings.zoomRatio = params.zoomRatio, !0;\n  }, \"handler\")\n}, SetDocZoomRatioCommand = {\n  type: CommandType.COMMAND,\n  id: \"doc.command.set-zoom-ratio\",\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    var _a28, _b, _c;\n    const commandService = accessor.get(ICommandService), undoRedoService = accessor.get(IUndoRedoService), univerInstanceService = accessor.get(IUniverInstanceService);\n    let documentId = (_a28 = univerInstanceService.getCurrentUniverDocInstance()) == null ? void 0 : _a28.getUnitId();\n    if (!documentId) return !1;\n    let zoomRatio = 1;\n    if (params && (documentId = (_b = params.documentId) != null ? _b : documentId, zoomRatio = (_c = params.zoomRatio) != null ? _c : zoomRatio), !univerInstanceService.getUniverDocInstance(documentId)) return !1;\n    const setZoomRatioMutationParams = {\n      zoomRatio,\n      unitId: documentId\n    }, undoMutationParams = SetDocZoomRatioUndoMutationFactory(accessor, setZoomRatioMutationParams);\n    return commandService.syncExecuteCommand(SetDocZoomRatioOperation.id, setZoomRatioMutationParams) ? (undoRedoService.pushUndoRedo({\n      unitID: documentId,\n      undoMutations: [{ id: SetDocZoomRatioOperation.id, params: undoMutationParams }],\n      redoMutations: [{ id: SetDocZoomRatioOperation.id, params: setZoomRatioMutationParams }]\n    }), !0) : !1;\n  }, \"handler\")\n}, CreateDocTableCommandId = \"doc.command.create-table\", CreateDocTableCommand = {\n  id: CreateDocTableCommandId,\n  type: CommandType.COMMAND,\n  // eslint-disable-next-line max-lines-per-function, complexity\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    var _a28, _b, _c, _d, _e, _f;\n    const { rowCount, colCount } = params, docSelectionManagerService = accessor.get(DocSelectionManagerService), univerInstanceService = accessor.get(IUniverInstanceService), commandService = accessor.get(ICommandService), activeRange = docSelectionManagerService.getActiveTextRange();\n    if (activeRange == null)\n      return !1;\n    const { segmentId, segmentPage } = activeRange, docDataModel = univerInstanceService.getCurrentUniverDocInstance(), body = docDataModel == null ? void 0 : docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n    if (docDataModel == null || body == null)\n      return !1;\n    const unitId = docDataModel.getUnitId(), docSkeletonManagerService = getCommandSkeleton(accessor, unitId), skeleton = docSkeletonManagerService == null ? void 0 : docSkeletonManagerService.getSkeleton();\n    if (skeleton == null)\n      return !1;\n    const { startOffset } = BuildTextUtils.selection.getInsertSelection(activeRange, body), prevParagraph = ((_a28 = body.paragraphs) != null ? _a28 : []).find((p2) => p2.startIndex >= startOffset), curGlyph = skeleton.findNodeByCharIndex(startOffset, segmentId, segmentPage), line = (_b = curGlyph == null ? void 0 : curGlyph.parent) == null ? void 0 : _b.parent, preGlyph = skeleton.findNodeByCharIndex(startOffset - 1, segmentId, segmentPage), isInParagraph = preGlyph && preGlyph.content !== \"\\r\";\n    if (curGlyph == null || line == null)\n      return !1;\n    const needCreateParagraph = isInParagraph || line.isBehindTable, textX = new TextX(), jsonX = JSONX.getInstance(), rawActions = [], cursor = startOffset + (needCreateParagraph ? 4 : 3), textRanges = [{\n      startOffset: cursor,\n      endOffset: cursor,\n      collapsed: !0\n    }], doMutation = {\n      id: RichTextEditingMutation.id,\n      params: {\n        unitId,\n        actions: [],\n        textRanges\n      }\n    };\n    startOffset > 0 && textX.push({\n      t: TextXActionType.RETAIN,\n      len: startOffset,\n      segmentId\n    }), needCreateParagraph && textX.push({\n      t: TextXActionType.INSERT,\n      body: {\n        dataStream: DataStreamTreeTokenType.PARAGRAPH,\n        paragraphs: generateParagraphs(DataStreamTreeTokenType.PARAGRAPH, prevParagraph)\n      },\n      len: 1,\n      line: 0,\n      segmentId\n    });\n    const { dataStream: tableDataStream, paragraphs: tableParagraphs, sectionBreaks } = genEmptyTable(rowCount, colCount), page = (_f = (_e = (_d = (_c = curGlyph.parent) == null ? void 0 : _c.parent) == null ? void 0 : _d.parent) == null ? void 0 : _e.parent) == null ? void 0 : _f.parent;\n    if (page == null)\n      return !1;\n    const { pageWidth, marginLeft, marginRight } = page, tableSource = genTableSource(rowCount, colCount, pageWidth - marginLeft - marginRight);\n    textX.push({\n      t: TextXActionType.INSERT,\n      body: {\n        dataStream: tableDataStream,\n        paragraphs: tableParagraphs,\n        sectionBreaks,\n        tables: [\n          {\n            startIndex: 0,\n            endIndex: tableDataStream.length,\n            tableId: tableSource.tableId\n          }\n        ]\n      },\n      len: tableDataStream.length,\n      line: 0,\n      segmentId\n    });\n    const path = getRichTextEditPath(docDataModel, segmentId);\n    rawActions.push(jsonX.editOp(textX.serialize(), path));\n    const insertTableSource = jsonX.insertOp([\"tableSource\", tableSource.tableId], tableSource);\n    return rawActions.push(insertTableSource), doMutation.params.actions = rawActions.reduce((acc, cur) => JSONX.compose(acc, cur), null), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n  }, \"handler\")\n}, DocTableDeleteRowsCommand = {\n  id: \"doc.table.delete-rows\",\n  type: CommandType.COMMAND,\n  // eslint-disable-next-line max-lines-per-function\n  handler: /* @__PURE__ */ __name(async (accessor) => {\n    const docSelectionManagerService = accessor.get(DocSelectionManagerService), univerInstanceService = accessor.get(IUniverInstanceService), commandService = accessor.get(ICommandService), activeRectRanges = docSelectionManagerService.getCurrentRectRanges(), activeTextRange = docSelectionManagerService.getActiveTextRange(), rangeInfo = getRangeInfoFromRanges(activeTextRange, activeRectRanges);\n    if (rangeInfo == null)\n      return !1;\n    const { segmentId } = rangeInfo, docDataModel = univerInstanceService.getCurrentUniverDocInstance(), body = docDataModel == null ? void 0 : docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n    if (docDataModel == null || body == null)\n      return !1;\n    const docSkeletonManagerService = getCommandSkeleton(accessor, docDataModel.getUnitId());\n    if (docSkeletonManagerService == null)\n      return !1;\n    const viewModel = docSkeletonManagerService.getViewModel(), unitId = docDataModel == null ? void 0 : docDataModel.getUnitId(), textX = new TextX(), jsonX = JSONX.getInstance(), actionParams = getDeleteRowsActionsParams(rangeInfo, viewModel);\n    if (actionParams == null)\n      return !1;\n    const { offset, rowIndexes, len, tableId, cursor, selectWholeTable } = actionParams;\n    if (selectWholeTable)\n      return commandService.executeCommand(DocTableDeleteTableCommand.id);\n    const rawActions = [], textRanges = [{\n      startOffset: cursor,\n      endOffset: cursor,\n      collapsed: !0\n    }], doMutation = {\n      id: RichTextEditingMutation.id,\n      params: {\n        unitId,\n        actions: [],\n        textRanges\n      }\n    };\n    offset > 0 && textX.push({\n      t: TextXActionType.RETAIN,\n      len: offset,\n      segmentId\n    }), textX.push({\n      t: TextXActionType.DELETE,\n      len,\n      line: 0,\n      segmentId\n    });\n    const path = getRichTextEditPath(docDataModel, segmentId);\n    rawActions.push(jsonX.editOp(textX.serialize(), path));\n    for (const index of rowIndexes.reverse()) {\n      const action = jsonX.removeOp([\"tableSource\", tableId, \"tableRows\", index]);\n      rawActions.push(action);\n    }\n    return doMutation.params.actions = rawActions.reduce((acc, cur) => JSONX.compose(acc, cur), null), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n  }, \"handler\")\n}, DocTableDeleteColumnsCommand = {\n  id: \"doc.table.delete-columns\",\n  type: CommandType.COMMAND,\n  // eslint-disable-next-line max-lines-per-function\n  handler: /* @__PURE__ */ __name(async (accessor) => {\n    const docSelectionManagerService = accessor.get(DocSelectionManagerService), univerInstanceService = accessor.get(IUniverInstanceService), commandService = accessor.get(ICommandService), activeRectRanges = docSelectionManagerService.getCurrentRectRanges(), activeTextRange = docSelectionManagerService.getActiveTextRange(), rangeInfo = getRangeInfoFromRanges(activeTextRange, activeRectRanges);\n    if (rangeInfo == null)\n      return !1;\n    const { segmentId } = rangeInfo, docDataModel = univerInstanceService.getCurrentUniverDocInstance(), body = docDataModel == null ? void 0 : docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n    if (docDataModel == null || body == null)\n      return !1;\n    const docSkeletonManagerService = getCommandSkeleton(accessor, docDataModel.getUnitId());\n    if (docSkeletonManagerService == null)\n      return !1;\n    const viewModel = docSkeletonManagerService.getViewModel(), unitId = docDataModel == null ? void 0 : docDataModel.getUnitId(), textX = new TextX(), jsonX = JSONX.getInstance(), actionParams = getDeleteColumnsActionParams(rangeInfo, viewModel);\n    if (actionParams == null)\n      return !1;\n    const { offsets, columnIndexes, tableId, cursor, rowCount, selectWholeTable } = actionParams;\n    if (selectWholeTable)\n      return commandService.executeCommand(DocTableDeleteTableCommand.id);\n    const rawActions = [], textRanges = [{\n      startOffset: cursor,\n      endOffset: cursor,\n      collapsed: !0\n    }], doMutation = {\n      id: RichTextEditingMutation.id,\n      params: {\n        unitId,\n        actions: [],\n        textRanges\n      }\n    };\n    for (const offset of offsets) {\n      const { retain, delete: deleteLen } = offset;\n      retain > 0 && textX.push({\n        t: TextXActionType.RETAIN,\n        len: retain,\n        segmentId\n      }), textX.push({\n        t: TextXActionType.DELETE,\n        len: deleteLen,\n        line: 0,\n        segmentId\n      });\n    }\n    const path = getRichTextEditPath(docDataModel, segmentId);\n    rawActions.push(jsonX.editOp(textX.serialize(), path)), columnIndexes.reverse();\n    for (let i = 0; i < rowCount; i++)\n      for (const index of columnIndexes) {\n        const action = jsonX.removeOp([\"tableSource\", tableId, \"tableRows\", i, \"tableCells\", index]);\n        rawActions.push(action);\n      }\n    for (const index of columnIndexes) {\n      const action = jsonX.removeOp([\"tableSource\", tableId, \"tableColumns\", index]);\n      rawActions.push(action);\n    }\n    return doMutation.params.actions = rawActions.reduce((acc, cur) => JSONX.compose(acc, cur), null), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n  }, \"handler\")\n}, DocTableDeleteTableCommand = {\n  id: \"doc.table.delete-table\",\n  type: CommandType.COMMAND,\n  // eslint-disable-next-line max-lines-per-function\n  handler: /* @__PURE__ */ __name(async (accessor) => {\n    const docSelectionManagerService = accessor.get(DocSelectionManagerService), univerInstanceService = accessor.get(IUniverInstanceService), commandService = accessor.get(ICommandService), activeRectRanges = docSelectionManagerService.getCurrentRectRanges(), activeTextRange = docSelectionManagerService.getActiveTextRange(), rangeInfo = getRangeInfoFromRanges(activeTextRange, activeRectRanges);\n    if (rangeInfo == null)\n      return !1;\n    const { segmentId } = rangeInfo, docDataModel = univerInstanceService.getCurrentUniverDocInstance(), body = docDataModel == null ? void 0 : docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n    if (docDataModel == null || body == null)\n      return !1;\n    const docSkeletonManagerService = getCommandSkeleton(accessor, docDataModel.getUnitId());\n    if (docSkeletonManagerService == null)\n      return !1;\n    const viewModel = docSkeletonManagerService.getViewModel(), unitId = docDataModel == null ? void 0 : docDataModel.getUnitId(), textX = new TextX(), jsonX = JSONX.getInstance(), actionParams = getDeleteTableActionParams(rangeInfo, viewModel);\n    if (actionParams == null)\n      return !1;\n    const { offset, len, tableId, cursor } = actionParams, rawActions = [], textRanges = [{\n      startOffset: cursor,\n      endOffset: cursor,\n      collapsed: !0\n    }], doMutation = {\n      id: RichTextEditingMutation.id,\n      params: {\n        unitId,\n        actions: [],\n        textRanges\n      }\n    };\n    offset > 0 && textX.push({\n      t: TextXActionType.RETAIN,\n      len: offset,\n      segmentId\n    }), textX.push({\n      t: TextXActionType.DELETE,\n      len,\n      line: 0,\n      segmentId\n    });\n    const path = getRichTextEditPath(docDataModel, segmentId);\n    rawActions.push(jsonX.editOp(textX.serialize(), path));\n    const action = jsonX.removeOp([\"tableSource\", tableId]);\n    return rawActions.push(action), doMutation.params.actions = rawActions.reduce((acc, cur) => JSONX.compose(acc, cur), null), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n  }, \"handler\")\n}, DocTableInsertRowCommandId = \"doc.command.table-insert-row\", DocTableInsertColumnCommandId = \"doc.command.table-insert-column\", DocTableInsertRowAboveCommandId = \"doc.command.table-insert-row-above\", DocTableInsertRowBellowCommandId = \"doc.command.table-insert-row-bellow\", DocTableInsertColumnLeftCommandId = \"doc.command.table-insert-column-left\", DocTableInsertColumnRightCommandId = \"doc.command.table-insert-column-right\", DocTableInsertRowAboveCommand = {\n  id: DocTableInsertRowAboveCommandId,\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name(async (accessor) => accessor.get(ICommandService).executeCommand(DocTableInsertRowCommandId, { position: INSERT_ROW_POSITION.ABOVE }), \"handler\")\n}, DocTableInsertRowBellowCommand = {\n  id: DocTableInsertRowBellowCommandId,\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name(async (accessor) => accessor.get(ICommandService).executeCommand(DocTableInsertRowCommandId, { position: INSERT_ROW_POSITION.BELLOW }), \"handler\")\n}, DocTableInsertColumnLeftCommand = {\n  id: DocTableInsertColumnLeftCommandId,\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name(async (accessor) => accessor.get(ICommandService).executeCommand(DocTableInsertColumnCommandId, { position: INSERT_COLUMN_POSITION.LEFT }), \"handler\")\n}, DocTableInsertColumnRightCommand = {\n  id: DocTableInsertColumnRightCommandId,\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name(async (accessor) => accessor.get(ICommandService).executeCommand(DocTableInsertColumnCommandId, { position: INSERT_COLUMN_POSITION.RIGHT }), \"handler\")\n}, DocTableInsertRowCommand = {\n  id: DocTableInsertRowCommandId,\n  type: CommandType.COMMAND,\n  // eslint-disable-next-line max-lines-per-function\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    const { position } = params, docSelectionManagerService = accessor.get(DocSelectionManagerService), univerInstanceService = accessor.get(IUniverInstanceService), commandService = accessor.get(ICommandService), activeRectRanges = docSelectionManagerService.getCurrentRectRanges(), activeTextRange = docSelectionManagerService.getActiveTextRange(), rangeInfo = getRangeInfoFromRanges(activeTextRange, activeRectRanges);\n    if (rangeInfo == null)\n      return !1;\n    const { segmentId } = rangeInfo, docDataModel = univerInstanceService.getCurrentUniverDocInstance(), body = docDataModel == null ? void 0 : docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n    if (docDataModel == null || body == null)\n      return !1;\n    const docSkeletonManagerService = getCommandSkeleton(accessor, docDataModel.getUnitId());\n    if (docSkeletonManagerService == null)\n      return !1;\n    const viewModel = docSkeletonManagerService.getViewModel(), unitId = docDataModel == null ? void 0 : docDataModel.getUnitId(), textX = new TextX(), jsonX = JSONX.getInstance(), actionParams = getInsertRowActionsParams(rangeInfo, position, viewModel);\n    if (actionParams == null)\n      return !1;\n    const { offset, colCount, tableId, insertRowIndex } = actionParams, rawActions = [], cursor = offset + 2, textRanges = [{\n      startOffset: cursor,\n      endOffset: cursor,\n      collapsed: !0\n    }], doMutation = {\n      id: RichTextEditingMutation.id,\n      params: {\n        unitId,\n        actions: [],\n        textRanges\n      }\n    };\n    offset > 0 && textX.push({\n      t: TextXActionType.RETAIN,\n      len: offset,\n      segmentId\n    });\n    const insertBody = getInsertRowBody(colCount);\n    textX.push({\n      t: TextXActionType.INSERT,\n      body: insertBody,\n      len: insertBody.dataStream.length,\n      line: 0,\n      segmentId\n    });\n    const path = getRichTextEditPath(docDataModel, segmentId);\n    rawActions.push(jsonX.editOp(textX.serialize(), path));\n    const insertRow = getEmptyTableRow(colCount), insertTableSource = jsonX.insertOp([\"tableSource\", tableId, \"tableRows\", insertRowIndex], insertRow);\n    return rawActions.push(insertTableSource), doMutation.params.actions = rawActions.reduce((acc, cur) => JSONX.compose(acc, cur), null), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n  }, \"handler\")\n}, DocTableInsertColumnCommand = {\n  id: DocTableInsertColumnCommandId,\n  type: CommandType.COMMAND,\n  // eslint-disable-next-line max-lines-per-function\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    var _a28, _b, _c;\n    const { position } = params, docSelectionManagerService = accessor.get(DocSelectionManagerService), univerInstanceService = accessor.get(IUniverInstanceService), commandService = accessor.get(ICommandService), activeRectRanges = docSelectionManagerService.getCurrentRectRanges(), activeTextRange = docSelectionManagerService.getActiveTextRange(), rangeInfo = getRangeInfoFromRanges(activeTextRange, activeRectRanges);\n    if (rangeInfo == null)\n      return !1;\n    const { segmentId } = rangeInfo, docDataModel = univerInstanceService.getCurrentUniverDocInstance(), body = docDataModel == null ? void 0 : docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n    if (docDataModel == null || body == null)\n      return !1;\n    const docSkeletonManagerService = getCommandSkeleton(accessor, docDataModel.getUnitId());\n    if (docSkeletonManagerService == null)\n      return !1;\n    const viewModel = docSkeletonManagerService.getViewModel(), unitId = docDataModel == null ? void 0 : docDataModel.getUnitId(), textX = new TextX(), jsonX = JSONX.getInstance(), actionParams = getInsertColumnActionsParams(rangeInfo, position, viewModel);\n    if (actionParams == null)\n      return !1;\n    const { offsets, columnIndex, tableId, rowCount } = actionParams, rawActions = [], cursor = offsets[0] + 1, textRanges = [{\n      startOffset: cursor,\n      endOffset: cursor,\n      collapsed: !0\n    }], doMutation = {\n      id: RichTextEditingMutation.id,\n      params: {\n        unitId,\n        actions: [],\n        textRanges\n      }\n    };\n    for (const offset of offsets) {\n      textX.push({\n        t: TextXActionType.RETAIN,\n        len: offset,\n        segmentId\n      });\n      const insertBody = getInsertColumnBody();\n      textX.push({\n        t: TextXActionType.INSERT,\n        body: insertBody,\n        len: insertBody.dataStream.length,\n        line: 0,\n        segmentId\n      });\n    }\n    const path = getRichTextEditPath(docDataModel, segmentId);\n    rawActions.push(jsonX.editOp(textX.serialize(), path));\n    for (let i = 0; i < rowCount; i++) {\n      const insertCell = getEmptyTableCell(), insertTableSource = jsonX.insertOp([\"tableSource\", tableId, \"tableRows\", i, \"tableCells\", columnIndex], insertCell);\n      rawActions.push(insertTableSource);\n    }\n    const snapshot = docDataModel.getSnapshot(), documentStyle = snapshot.documentStyle, { marginLeft = 0, marginRight = 0 } = documentStyle, pageWidth = ((_b = (_a28 = documentStyle.pageSize) == null ? void 0 : _a28.width) != null ? _b : 800) - marginLeft - marginRight, tableColumns = (_c = snapshot == null ? void 0 : snapshot.tableSource) == null ? void 0 : _c[tableId].tableColumns, { newColWidth, widths } = getColumnWidths(pageWidth, tableColumns, columnIndex);\n    for (let i = 0; i < widths.length; i++) {\n      const action = jsonX.replaceOp([\"tableSource\", tableId, \"tableColumns\", i, \"size\", \"width\", \"v\"], tableColumns[i].size.width.v, widths[i]);\n      rawActions.push(action);\n    }\n    const insertCol = getTableColumn(newColWidth), insertTableColumn = jsonX.insertOp([\"tableSource\", tableId, \"tableColumns\", columnIndex], insertCol);\n    return rawActions.push(insertTableColumn), doMutation.params.actions = rawActions.reduce((acc, cur) => JSONX.compose(acc, cur), null), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n  }, \"handler\")\n}, DocTableTabCommand = {\n  id: \"doc.table.tab-in-table\",\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    const { shift } = params, textSelectionManager = accessor.get(DocSelectionManagerService), activeTextRange = textSelectionManager.getActiveTextRange(), commandService = accessor.get(ICommandService), docDataModel = accessor.get(IUniverInstanceService).getCurrentUniverDocInstance();\n    if (!docDataModel)\n      return !1;\n    const unitId = docDataModel.getUnitId(), docSkeletonManagerService = getCommandSkeleton(accessor, unitId), skeleton = docSkeletonManagerService == null ? void 0 : docSkeletonManagerService.getSkeleton(), viewModel = skeleton == null ? void 0 : skeleton.getViewModel().getSelfOrHeaderFooterViewModel(activeTextRange == null ? void 0 : activeTextRange.segmentId);\n    if (viewModel == null || activeTextRange == null)\n      return !1;\n    let offsets = null;\n    if (shift ? offsets = getCellOffsets(viewModel, activeTextRange, CellPosition.PREV) : offsets = getCellOffsets(viewModel, activeTextRange, CellPosition.NEXT), offsets) {\n      const { startOffset, endOffset } = offsets, textRanges = [{\n        startOffset,\n        endOffset\n      }];\n      return textSelectionManager.replaceTextRanges(textRanges), !0;\n    }\n    return shift === !1 ? await commandService.executeCommand(DocTableInsertRowCommand.id, {\n      position: INSERT_ROW_POSITION.BELLOW\n    }) : !0;\n  }, \"handler\")\n}, COMPONENT_DOC_CREATE_TABLE_CONFIRM = \"COMPONENT_DOC_CREATE_TABLE_CONFIRM\", COMPONENT_DOC_CREATE_TABLE_CONFIRM_ID = \"doc.component.create-table-confirm\", DocCreateTableOperation = {\n  id: \"doc.operation.create-table\",\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name(async (accessor) => {\n    const localeService = accessor.get(LocaleService), confirmService = accessor.get(IConfirmService), commandService = accessor.get(ICommandService), tableCreateParams = {\n      rowCount: 3,\n      colCount: 5\n    }, handleRowColChange = /* @__PURE__ */ __name((rowCount, colCount) => {\n      tableCreateParams.rowCount = rowCount, tableCreateParams.colCount = colCount;\n    }, \"handleRowColChange\");\n    return await confirmService.open({\n      id: COMPONENT_DOC_CREATE_TABLE_CONFIRM_ID,\n      children: {\n        label: {\n          name: COMPONENT_DOC_CREATE_TABLE_CONFIRM,\n          props: {\n            handleRowColChange,\n            tableCreateParams\n          }\n        }\n      },\n      width: 400,\n      title: { title: localeService.t(\"toolbar.table.insert\") },\n      onConfirm: /* @__PURE__ */ __name(() => {\n        commandService.executeCommand(CreateDocTableCommand.id, tableCreateParams), confirmService.close(COMPONENT_DOC_CREATE_TABLE_CONFIRM_ID);\n      }, \"onConfirm\"),\n      onClose: /* @__PURE__ */ __name(() => {\n        confirmService.close(COMPONENT_DOC_CREATE_TABLE_CONFIRM_ID);\n      }, \"onClose\")\n    }), !0;\n  }, \"handler\")\n}, MoveCursorOperation = {\n  id: \"doc.operation.move-cursor\",\n  type: CommandType.OPERATION,\n  handler: /* @__PURE__ */ __name((accessor, params) => !!params, \"handler\")\n}, MoveSelectionOperation = {\n  id: \"doc.operation.move-selection\",\n  type: CommandType.OPERATION,\n  handler: /* @__PURE__ */ __name((accessor, params) => !!params, \"handler\")\n}, SelectAllOperation = {\n  id: \"doc.operation.select-all\",\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name(async (accessor) => {\n    const univerInstanceService = accessor.get(IUniverInstanceService), docSelectionManagerService = accessor.get(DocSelectionManagerService), docDataModel = univerInstanceService.getCurrentUniverDocInstance(), activeTextRange = docSelectionManagerService.getActiveTextRange();\n    if (docDataModel == null || activeTextRange == null)\n      return !1;\n    const { segmentId } = activeTextRange, prevBody = docDataModel.getSelfOrHeaderFooterModel(segmentId).getSnapshot().body;\n    if (prevBody == null)\n      return !1;\n    const textRanges = [\n      {\n        startOffset: 0,\n        endOffset: prevBody.dataStream.length - 2\n      }\n    ];\n    return docSelectionManagerService.replaceTextRanges(textRanges, !1), !0;\n  }, \"handler\")\n};\nvar __assign = function() {\n  return __assign = Object.assign || function(t) {\n    for (var s, i = 1, n2 = arguments.length; i < n2; i++) {\n      s = arguments[i];\n      for (var p2 in s) Object.prototype.hasOwnProperty.call(s, p2) && (t[p2] = s[p2]);\n    }\n    return t;\n  }, __assign.apply(this, arguments);\n}, __rest = function(s, e) {\n  var t = {};\n  for (var p2 in s) Object.prototype.hasOwnProperty.call(s, p2) && e.indexOf(p2) < 0 && (t[p2] = s[p2]);\n  if (s != null && typeof Object.getOwnPropertySymbols == \"function\")\n    for (var i = 0, p2 = Object.getOwnPropertySymbols(s); i < p2.length; i++)\n      e.indexOf(p2[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p2[i]) && (t[p2[i]] = s[p2[i]]);\n  return t;\n}, IconBase = forwardRef(function(props, ref) {\n  var icon = props.icon, id = props.id, className = props.className, extend = props.extend, restProps = __rest(props, [\"icon\", \"id\", \"className\", \"extend\"]), cls = \"univerjs-icon univerjs-icon-\".concat(id, \" \").concat(className || \"\").trim(), idSuffix = useRef(\"_\".concat(generateShortUuid()));\n  return render(icon, \"\".concat(id), { defIds: icon.defIds, idSuffix: idSuffix.current }, __assign({ ref, className: cls }, restProps), extend);\n});\nfunction render(node, id, runtimeProps, rootProps, extend) {\n  return createElement(node.tag, __assign(__assign({ key: id }, replaceRuntimeIdsAndExtInAttrs(node, runtimeProps, extend)), rootProps), (replaceRuntimeIdsInDefs(node, runtimeProps).children || []).map(function(child, index) {\n    return render(child, \"\".concat(id, \"-\").concat(node.tag, \"-\").concat(index), runtimeProps, void 0, extend);\n  }));\n}\n__name(render, \"render\");\nfunction replaceRuntimeIdsAndExtInAttrs(node, runtimeProps, extend) {\n  var attrs = __assign({}, node.attrs);\n  extend != null && extend.colorChannel1 && attrs.fill === \"colorChannel1\" && (attrs.fill = extend.colorChannel1);\n  var defIds = runtimeProps.defIds;\n  return !defIds || defIds.length === 0 || (node.tag === \"use\" && attrs[\"xlink:href\"] && (attrs[\"xlink:href\"] = attrs[\"xlink:href\"] + runtimeProps.idSuffix), Object.entries(attrs).forEach(function(_a28) {\n    var key = _a28[0], value = _a28[1];\n    typeof value == \"string\" && (attrs[key] = value.replace(/url\\(#(.*)\\)/, \"url(#$1\".concat(runtimeProps.idSuffix, \")\")));\n  })), attrs;\n}\n__name(replaceRuntimeIdsAndExtInAttrs, \"replaceRuntimeIdsAndExtInAttrs\");\nfunction replaceRuntimeIdsInDefs(node, runtimeProps) {\n  var _a28, defIds = runtimeProps.defIds;\n  return !defIds || defIds.length === 0 ? node : node.tag === \"defs\" && (!((_a28 = node.children) === null || _a28 === void 0) && _a28.length) ? __assign(__assign({}, node), { children: node.children.map(function(child) {\n    return typeof child.attrs.id == \"string\" && defIds && defIds.indexOf(child.attrs.id) > -1 ? __assign(__assign({}, child), { attrs: __assign(__assign({}, child.attrs), { id: child.attrs.id + runtimeProps.idSuffix }) }) : child;\n  }) }) : node;\n}\n__name(replaceRuntimeIdsInDefs, \"replaceRuntimeIdsInDefs\");\nfunction generateShortUuid() {\n  return Math.random().toString(36).substring(2, 8);\n}\n__name(generateShortUuid, \"generateShortUuid\");\nIconBase.displayName = \"UniverIcon\";\nvar element$4 = { tag: \"svg\", attrs: { fill: \"none\", viewBox: \"0 0 16 16\", width: \"1em\", height: \"1em\" }, children: [{ tag: \"path\", attrs: { fill: \"currentColor\", d: \"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941 1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941 14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999zM1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641 1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H13.9999C14.3313 6.76641 14.5999 6.49778 14.5999 6.16641 14.5999 5.83504 14.3313 5.56641 13.9999 5.56641H1.9999zM1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334 14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334zM1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004 1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H13.9999C14.3313 14.1004 14.5999 13.8318 14.5999 13.5004 14.5999 13.169 14.3313 12.9004 13.9999 12.9004H1.9999z\" } }] }, AlignTextBothSingle = forwardRef(function(props, ref) {\n  return createElement(IconBase, Object.assign({}, props, {\n    id: \"align-text-both-single\",\n    ref,\n    icon: element$4\n  }));\n});\nAlignTextBothSingle.displayName = \"AlignTextBothSingle\";\nvar element$3 = { tag: \"svg\", attrs: { fill: \"none\", viewBox: \"0 0 16 16\", width: \"1em\", height: \"1em\" }, children: [{ tag: \"path\", attrs: { fill: \"currentColor\", d: \"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941 1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941 14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999zM3.33315 5.56641C3.00178 5.56641 2.73315 5.83504 2.73315 6.16641 2.73315 6.49778 3.00178 6.76641 3.33315 6.76641H12.6665C12.9979 6.76641 13.2665 6.49778 13.2665 6.16641 13.2665 5.83504 12.9979 5.56641 12.6665 5.56641H3.33315zM1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334 14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334zM3.33315 12.9004C3.00178 12.9004 2.73315 13.169 2.73315 13.5004 2.73315 13.8318 3.00178 14.1004 3.33315 14.1004H12.6665C12.9979 14.1004 13.2665 13.8318 13.2665 13.5004 13.2665 13.169 12.9979 12.9004 12.6665 12.9004H3.33315z\" } }] }, HorizontallySingle = forwardRef(function(props, ref) {\n  return createElement(IconBase, Object.assign({}, props, {\n    id: \"horizontally-single\",\n    ref,\n    icon: element$3\n  }));\n});\nHorizontallySingle.displayName = \"HorizontallySingle\";\nvar element$2 = { tag: \"svg\", attrs: { fill: \"none\", viewBox: \"0 0 16 16\", width: \"1em\", height: \"1em\" }, children: [{ tag: \"path\", attrs: { fill: \"currentColor\", d: \"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941 1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941 14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999zM1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641 1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H11.3332C11.6646 6.76641 11.9332 6.49778 11.9332 6.16641 11.9332 5.83504 11.6646 5.56641 11.3332 5.56641H1.9999zM1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334 14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334zM1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004 1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H11.3332C11.6646 14.1004 11.9332 13.8318 11.9332 13.5004 11.9332 13.169 11.6646 12.9004 11.3332 12.9004H1.9999z\" } }] }, LeftJustifyingSingle = forwardRef(function(props, ref) {\n  return createElement(IconBase, Object.assign({}, props, {\n    id: \"left-justifying-single\",\n    ref,\n    icon: element$2\n  }));\n});\nLeftJustifyingSingle.displayName = \"LeftJustifyingSingle\";\nvar element$1 = { tag: \"svg\", attrs: { fill: \"none\", viewBox: \"0 0 16 16\", width: \"1em\", height: \"1em\" }, children: [{ tag: \"path\", attrs: { fill: \"currentColor\", d: \"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941 1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941 14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999zM4.66665 5.56641C4.33528 5.56641 4.06665 5.83504 4.06665 6.16641 4.06665 6.49778 4.33528 6.76641 4.66665 6.76641H14C14.3314 6.76641 14.6 6.49778 14.6 6.16641 14.6 5.83504 14.3314 5.56641 14 5.56641H4.66665zM1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334 14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334zM4.66665 12.9004C4.33528 12.9004 4.06665 13.169 4.06665 13.5004 4.06665 13.8318 4.33528 14.1004 4.66665 14.1004H14C14.3314 14.1004 14.6 13.8318 14.6 13.5004 14.6 13.169 14.3314 12.9004 14 12.9004H4.66665z\" } }] }, RightJustifyingSingle = forwardRef(function(props, ref) {\n  return createElement(IconBase, Object.assign({}, props, {\n    id: \"right-justifying-single\",\n    ref,\n    icon: element$1\n  }));\n});\nRightJustifyingSingle.displayName = \"RightJustifyingSingle\";\nvar element = { tag: \"svg\", attrs: { fill: \"none\", viewBox: \"0 0 16 16\", width: \"1em\", height: \"1em\" }, children: [{ tag: \"path\", attrs: { fill: \"currentColor\", d: \"M4.96372 2.59116C5.19803 2.35684 5.19803 1.97695 4.96372 1.74263 4.7294 1.50832 4.3495 1.50832 4.11519 1.74263L2.53945 3.31837 1.96372 2.74263C1.7294 2.50832 1.3495 2.50832 1.11519 2.74263.880874 2.97695.880874 3.35684 1.11519 3.59116L2.11519 4.59116C2.3495 4.82547 2.7294 4.82547 2.96372 4.59116L4.96372 2.59116zM14.4605 2.56689H6.8981C6.56672 2.56689 6.2981 2.83552 6.2981 3.16689 6.2981 3.49827 6.56672 3.76689 6.8981 3.76689H14.4605C14.7918 3.76689 15.0605 3.49827 15.0605 3.16689 15.0605 2.83552 14.7918 2.56689 14.4605 2.56689zM6.8981 7.2334C6.56672 7.2334 6.2981 7.50203 6.2981 7.8334 6.2981 8.16477 6.56672 8.4334 6.8981 8.4334H14.4605C14.7918 8.4334 15.0605 8.16477 15.0605 7.8334 15.0605 7.50203 14.7918 7.2334 14.4605 7.2334H6.8981zM6.2981 12.4999C6.2981 12.1685 6.56672 11.8999 6.8981 11.8999H14.4605C14.7918 11.8999 15.0605 12.1685 15.0605 12.4999 15.0605 12.8313 14.7918 13.0999 14.4605 13.0999H6.8981C6.56672 13.0999 6.2981 12.8313 6.2981 12.4999z\" } }, { tag: \"path\", attrs: { fill: \"currentColor\", d: \"M2.87279 5.8999C1.80504 5.8999.939453 6.76549.939453 7.83324.939453 8.90099 1.80504 9.76657 2.87279 9.76657 3.94054 9.76657 4.80612 8.90099 4.80612 7.83324 4.80612 6.76549 3.94054 5.8999 2.87279 5.8999zM2.13945 7.83324C2.13945 7.42823 2.46778 7.0999 2.87279 7.0999 3.2778 7.0999 3.60612 7.42823 3.60612 7.83324 3.60612 8.23824 3.2778 8.56657 2.87279 8.56657 2.46778 8.56657 2.13945 8.23824 2.13945 7.83324zM.939453 12.5002C.939453 11.4325 1.80504 10.5669 2.87279 10.5669 3.94054 10.5669 4.80612 11.4325 4.80612 12.5002 4.80612 13.568 3.94054 14.4336 2.87279 14.4336 1.80504 14.4336.939453 13.568.939453 12.5002zM2.87279 11.7669C2.46778 11.7669 2.13945 12.0952 2.13945 12.5002 2.13945 12.9052 2.46778 13.2336 2.87279 13.2336 3.2778 13.2336 3.60612 12.9052 3.60612 12.5002 3.60612 12.0952 3.2778 11.7669 2.87279 11.7669z\", fillRule: \"evenodd\", clipRule: \"evenodd\" } }] }, TodoList = forwardRef(function(props, ref) {\n  return createElement(IconBase, Object.assign({}, props, {\n    id: \"todo-list\",\n    ref,\n    icon: element\n  }));\n});\nTodoList.displayName = \"TodoList\";\nvar NodePositionType = /* @__PURE__ */ ((NodePositionType2) => (NodePositionType2[NodePositionType2.page = 0] = \"page\", NodePositionType2[NodePositionType2.section = 1] = \"section\", NodePositionType2[NodePositionType2.column = 2] = \"column\", NodePositionType2[NodePositionType2.line = 3] = \"line\", NodePositionType2[NodePositionType2.divide = 4] = \"divide\", NodePositionType2[NodePositionType2.glyph = 5] = \"glyph\", NodePositionType2))(NodePositionType || {});\nconst NodePositionMap = {\n  page: 0,\n  section: 1,\n  column: 2,\n  line: 3,\n  divide: 4,\n  glyph: 5\n};\nfunction compareNodePositionLogic(pos1, pos2) {\n  return pos1.page > pos2.page ? !1 : pos1.page < pos2.page ? !0 : pos1.section > pos2.section ? !1 : pos1.section < pos2.section ? !0 : pos1.column > pos2.column ? !1 : pos1.column < pos2.column ? !0 : pos1.line > pos2.line ? !1 : pos1.line < pos2.line ? !0 : pos1.divide > pos2.divide ? !1 : pos1.divide < pos2.divide ? !0 : pos1.glyph > pos2.glyph ? !1 : (pos1.glyph < pos2.glyph, !0);\n}\n__name(compareNodePositionLogic, \"compareNodePositionLogic\");\nfunction compareNodePosition(pos1, pos2) {\n  return compareNodePositionLogic(pos1, pos2) ? {\n    start: pos1,\n    end: pos2\n  } : {\n    start: pos2,\n    end: pos1\n  };\n}\n__name(compareNodePosition, \"compareNodePosition\");\nfunction getOneTextSelectionRange(rangeList) {\n  const rangeCount = rangeList.length;\n  if (rangeCount === 0)\n    return;\n  const firstCursor = rangeList[0], lastCursor = rangeList[rangeCount - 1], collapsed = rangeList.length === 1 && firstCursor.collapsed;\n  return {\n    startOffset: firstCursor.startOffset,\n    endOffset: lastCursor.endOffset,\n    collapsed\n  };\n}\n__name(getOneTextSelectionRange, \"getOneTextSelectionRange\");\nfunction getOffsetInDivide(glyphGroup, startGlyphIndex, endGlyphIndex, st) {\n  let startOffset = st, endOffset = st;\n  for (let i = 0; i < glyphGroup.length; i++) {\n    const contentLength = glyphGroup[i].count;\n    i < startGlyphIndex && (startOffset += contentLength), i < endGlyphIndex && (endOffset += contentLength);\n  }\n  return {\n    startOffset,\n    endOffset\n  };\n}\n__name(getOffsetInDivide, \"getOffsetInDivide\");\nfunction pushToPoints(position) {\n  const { startX, startY, endX, endY } = position, points = [];\n  return points.push({\n    x: startX,\n    y: startY\n  }), points.push({\n    x: endX,\n    y: startY\n  }), points.push({\n    x: endX,\n    y: endY\n  }), points.push({\n    x: startX,\n    y: endY\n  }), points.push({\n    x: startX,\n    y: startY\n  }), points;\n}\n__name(pushToPoints, \"pushToPoints\");\nconst _NodePositionConvertToCursor = class _NodePositionConvertToCursor {\n  constructor(_documentOffsetConfig, _docSkeleton) {\n    __publicField(this, \"_liquid\", new Liquid());\n    __publicField(this, \"_currentStartState\", {\n      page: 0,\n      section: 0,\n      column: 0,\n      line: 0,\n      divide: 0,\n      glyph: 0\n      /* NORMAL */\n    });\n    __publicField(this, \"_currentEndState\", {\n      page: 0,\n      section: 0,\n      column: 0,\n      line: 0,\n      divide: 0,\n      glyph: 0\n      /* NORMAL */\n    });\n    this._documentOffsetConfig = _documentOffsetConfig, this._docSkeleton = _docSkeleton;\n  }\n  // eslint-disable-next-line max-lines-per-function\n  getRangePointData(startOrigin, endOrigin) {\n    const borderBoxPointGroup = [], contentBoxPointGroup = [], cursorList = [];\n    if (startOrigin == null || endOrigin == null)\n      return {\n        borderBoxPointGroup,\n        contentBoxPointGroup,\n        cursorList\n      };\n    if (!this._isValidPosition(startOrigin, endOrigin))\n      throw new Error(\n        `\n                Invalid positions in NodePositionConvertToCursor,\n                they are not in the same segment page when in header or footer.`\n      );\n    const { start, end } = compareNodePosition(startOrigin, endOrigin);\n    return this._selectionIterator(start, end, (start_sp, end_sp, isFirst, isLast, divide, line) => {\n      const { lineHeight, asc, paddingTop, marginTop, marginBottom } = line, { glyphGroup, st } = divide;\n      if (glyphGroup.length === 0)\n        return;\n      const { x: startX, y: startY } = this._liquid;\n      let borderBoxPosition, contentBoxPosition;\n      const firstGlyph = glyphGroup[start_sp], lastGlyph = glyphGroup[end_sp], preGlyph = glyphGroup[start_sp - 1], firstGlyphLeft = (firstGlyph == null ? void 0 : firstGlyph.left) || 0, firstGlyphWidth = (firstGlyph == null ? void 0 : firstGlyph.width) || 0, lastGlyphLeft = (lastGlyph == null ? void 0 : lastGlyph.left) || 0, lastGlyphWidth = (lastGlyph == null ? void 0 : lastGlyph.width) || 0, isCurrentList = (firstGlyph == null ? void 0 : firstGlyph.glyphType) === GlyphType.LIST, { startOffset, endOffset } = getOffsetInDivide(glyphGroup, start_sp, end_sp, st), isStartBack = start.glyph === start_sp && isFirst ? start.isBack : !0, isEndBack = end.glyph === end_sp && isLast ? end.isBack : !1, collapsed = start === end, anchorGlyph = isStartBack && preGlyph != null ? preGlyph : firstGlyph;\n      if (start_sp === 0 && end_sp === glyphGroup.length - 1)\n        borderBoxPosition = {\n          startX: startX + firstGlyphLeft + (isCurrentList ? firstGlyphWidth : 0),\n          startY,\n          endX: startX + lastGlyphLeft + (isEndBack ? 0 : lastGlyphWidth),\n          endY: startY + lineHeight - marginTop - marginBottom\n        }, contentBoxPosition = {\n          startX: startX + firstGlyphLeft + (isCurrentList ? firstGlyphWidth : 0),\n          startY: startY + paddingTop + asc - anchorGlyph.bBox.ba,\n          endX: startX + lastGlyphLeft + (isEndBack ? 0 : lastGlyphWidth),\n          endY: startY + paddingTop + asc + anchorGlyph.bBox.bd\n        };\n      else {\n        const isStartBackFin = isStartBack && !isCurrentList;\n        borderBoxPosition = {\n          startX: startX + firstGlyphLeft + (isStartBackFin ? 0 : firstGlyphWidth),\n          startY,\n          endX: startX + lastGlyphLeft + (isEndBack ? 0 : lastGlyphWidth),\n          endY: startY + lineHeight - marginTop - marginBottom\n        }, contentBoxPosition = {\n          startX: startX + firstGlyphLeft + (isStartBackFin ? 0 : firstGlyphWidth),\n          startY: startY + paddingTop + asc - anchorGlyph.bBox.ba,\n          endX: startX + lastGlyphLeft + (isEndBack ? 0 : lastGlyphWidth),\n          endY: startY + paddingTop + asc + anchorGlyph.bBox.bd\n        };\n      }\n      borderBoxPointGroup.push(pushToPoints(borderBoxPosition)), contentBoxPointGroup.push(pushToPoints(contentBoxPosition)), cursorList.push({\n        startOffset: isStartBack ? startOffset : startOffset + firstGlyph.count,\n        endOffset: isEndBack ? endOffset : endOffset + lastGlyph.count,\n        collapsed\n      });\n    }), {\n      borderBoxPointGroup,\n      contentBoxPointGroup,\n      cursorList\n    };\n  }\n  _isValidPosition(startOrigin, endOrigin) {\n    const { segmentPage: startPage, pageType: startPageType } = startOrigin, { segmentPage: endPage, pageType: endPageType } = endOrigin;\n    return startPageType !== endPageType ? !1 : startPageType === DocumentSkeletonPageType.HEADER || startPageType === DocumentSkeletonPageType.FOOTER ? startPage === endPage : !0;\n  }\n  _resetCurrentNodePositionState() {\n    this._currentStartState = {\n      page: 0,\n      section: 0,\n      column: 0,\n      line: 0,\n      divide: 0,\n      glyph: 0\n      /* NORMAL */\n    }, this._currentEndState = {\n      page: 0,\n      section: 0,\n      column: 0,\n      line: 0,\n      divide: 0,\n      glyph: 0\n      /* NORMAL */\n    };\n  }\n  _setNodePositionState(type = 0, start, end, current) {\n    current === start ? this._currentStartState[type] = 1 : this._currentStartState[type] = 0, current === end ? this._currentEndState[type] = 2 : this._currentEndState[type] = 0;\n  }\n  _checkPreviousNodePositionState(typeIndex, isStart = !0) {\n    let index = typeIndex, resultState;\n    for (; index >= 0; ) {\n      const type = NodePositionType[index];\n      let state;\n      if (isStart ? state = this._currentStartState[type] : state = this._currentEndState[type], state === void 0)\n        return;\n      if (resultState === void 0 && (resultState = state), state !== resultState)\n        return 0;\n      index--;\n    }\n    return resultState;\n  }\n  _getSelectionRuler(typeIndex, startPosition, endPosition, nextLength, current) {\n    let start_next = 0, end_next = nextLength;\n    const type = NodePositionType[typeIndex], nextType = NodePositionType[typeIndex + 1];\n    if (nextType === null || type === null)\n      return {\n        start_next,\n        end_next\n      };\n    const start = startPosition[type], end = endPosition[type];\n    this._setNodePositionState(type, start, end, current);\n    const preStartNestType = this._checkPreviousNodePositionState(typeIndex), preEndNestType = this._checkPreviousNodePositionState(typeIndex, !1);\n    return preStartNestType === 1 && (start_next = startPosition[nextType]), preEndNestType === 2 && (end_next = endPosition[nextType]), {\n      start_next,\n      end_next\n    };\n  }\n  // eslint-disable-next-line max-lines-per-function, complexity\n  _selectionIterator(startPosition, endPosition, func) {\n    var _a28, _b;\n    const skeleton = this._docSkeleton;\n    if (!skeleton)\n      return [];\n    const { pageType, path } = startPosition;\n    this._liquid.reset();\n    const skeletonData = skeleton.getSkeletonData();\n    if (skeletonData == null)\n      return [];\n    const { pages, skeHeaders, skeFooters } = skeletonData, { page: pageIndex, segmentPage } = startPosition, { page: endPageIndex, segmentPage: endSegmentPage } = endPosition;\n    if (this._resetCurrentNodePositionState(), this._documentOffsetConfig == null)\n      return [];\n    const { pageLayoutType, pageMarginLeft, pageMarginTop } = this._documentOffsetConfig, skipPageIndex = pageType === DocumentSkeletonPageType.BODY || pageType === DocumentSkeletonPageType.CELL ? pageIndex : segmentPage;\n    for (let p2 = 0; p2 < skipPageIndex; p2++) {\n      const page = pages[p2];\n      this._liquid.translatePage(page, pageLayoutType, pageMarginLeft, pageMarginTop);\n    }\n    const endIndex = pageType === DocumentSkeletonPageType.BODY || pageType === DocumentSkeletonPageType.CELL ? endPageIndex : endSegmentPage;\n    for (let p2 = skipPageIndex; p2 <= endIndex; p2++) {\n      const page = pages[p2], { headerId, footerId, pageWidth } = page;\n      let segmentPage2 = page;\n      if (pageType === DocumentSkeletonPageType.HEADER ? segmentPage2 = (_a28 = skeHeaders.get(headerId)) == null ? void 0 : _a28.get(pageWidth) : pageType === DocumentSkeletonPageType.FOOTER ? segmentPage2 = (_b = skeFooters.get(footerId)) == null ? void 0 : _b.get(pageWidth) : pageType === DocumentSkeletonPageType.CELL && (segmentPage2 = getPageFromPath(skeletonData, path)), segmentPage2 == null) {\n        this._liquid.translatePage(page, pageLayoutType, pageMarginLeft, pageMarginTop);\n        continue;\n      }\n      const sections = segmentPage2.sections, { start_next: start_s, end_next: end_s } = this._getSelectionRuler(\n        NodePositionMap.page,\n        startPosition,\n        endPosition,\n        sections.length - 1,\n        pageType === DocumentSkeletonPageType.BODY || pageType === DocumentSkeletonPageType.CELL ? p2 : 0\n      );\n      switch (this._liquid.translateSave(), pageType) {\n        case DocumentSkeletonPageType.HEADER:\n          this._liquid.translatePagePadding({\n            ...segmentPage2,\n            marginLeft: page.marginLeft\n            // Because header or footer margin Left is 0.\n          });\n          break;\n        case DocumentSkeletonPageType.FOOTER: {\n          const footerTop = page.pageHeight - segmentPage2.height - segmentPage2.marginBottom;\n          this._liquid.translate(page.marginLeft, footerTop);\n          break;\n        }\n        case DocumentSkeletonPageType.CELL: {\n          this._liquid.translatePagePadding(page);\n          const rowSke = segmentPage2.parent, tableSke = rowSke.parent, { left: cellLeft } = segmentPage2, { top: tableTop, left: tableLeft } = tableSke, { top: rowTop } = rowSke;\n          this._liquid.translate(tableLeft + cellLeft, tableTop + rowTop), this._liquid.translatePagePadding(segmentPage2);\n          break;\n        }\n        default:\n          this._liquid.translatePagePadding(page);\n          break;\n      }\n      for (let s = start_s; s <= end_s; s++) {\n        const section = sections[s], columns = section.columns, { start_next: start_c, end_next: end_c } = this._getSelectionRuler(\n          NodePositionMap.section,\n          startPosition,\n          endPosition,\n          columns.length - 1,\n          s\n        );\n        this._liquid.translateSection(section);\n        for (let c = start_c; c <= end_c; c++) {\n          const column = columns[c], lines = column.lines, { start_next: start_l, end_next: end_l } = this._getSelectionRuler(\n            NodePositionMap.column,\n            startPosition,\n            endPosition,\n            lines.length - 1,\n            c\n          );\n          this._liquid.translateColumn(column);\n          for (let l2 = start_l; l2 <= end_l; l2++) {\n            const line = lines[l2], { divides } = line, { start_next: start_d, end_next: end_d } = this._getSelectionRuler(\n              NodePositionMap.line,\n              startPosition,\n              endPosition,\n              divides.length - 1,\n              l2\n            );\n            this._liquid.translateSave(), this._liquid.translateLine(line, !0, !1);\n            for (let d = start_d; d <= end_d; d++) {\n              const divide = divides[d];\n              this._liquid.translateSave(), this._liquid.translateDivide(divide);\n              const { glyphGroup } = divide, { start_next: start_sp, end_next: end_sp } = this._getSelectionRuler(\n                NodePositionMap.divide,\n                startPosition,\n                endPosition,\n                glyphGroup.length - 1,\n                d\n              );\n              let isFirst = !1, isLast = !1;\n              p2 === skipPageIndex && s === start_s && c === start_c && l2 === start_l && d === start_d && (isFirst = !0), p2 === endIndex && s === end_s && c === end_c && l2 === end_l && d === end_d && (isLast = !0), func && func(start_sp, end_sp, isFirst, isLast, divide, line, column, section, segmentPage2), this._liquid.translateRestore();\n            }\n            this._liquid.translateRestore();\n          }\n        }\n      }\n      this._liquid.translateRestore(), this._liquid.translatePage(page, pageLayoutType, pageMarginLeft, pageMarginTop);\n    }\n  }\n};\n__name(_NodePositionConvertToCursor, \"NodePositionConvertToCursor\");\nlet NodePositionConvertToCursor = _NodePositionConvertToCursor;\nfunction isValidRectRange(anchorNodePosition, focusNodePosition) {\n  const { path: anchorPath } = anchorNodePosition, { path: focusPath } = focusNodePosition;\n  if (anchorPath.length !== focusPath.length || anchorPath.indexOf(\"cells\") === -1)\n    return !1;\n  const tableIdIndex = anchorPath.indexOf(\"skeTables\") + 1, rowIndex = anchorPath.indexOf(\"rows\") + 1, cellIndex = anchorPath.indexOf(\"cells\") + 1, anchorTableId = getTableIdAndSliceIndex(anchorPath[tableIdIndex]).tableId, focusTableId = getTableIdAndSliceIndex(focusPath[tableIdIndex]).tableId;\n  if (anchorTableId !== focusTableId)\n    return !1;\n  const anchorRowIndex = anchorPath[rowIndex], focusRowIndex = focusPath[rowIndex], anchorCellIndex = anchorPath[cellIndex], focusCellIndex = focusPath[cellIndex];\n  return !(anchorRowIndex === focusRowIndex && anchorCellIndex === focusCellIndex);\n}\n__name(isValidRectRange, \"isValidRectRange\");\nfunction isInSameTableCell(anchorNodePosition, focusNodePosition) {\n  const { path: anchorPath } = anchorNodePosition, { path: focusPath } = focusNodePosition;\n  return anchorPath.indexOf(\"cells\") === -1 || focusPath.indexOf(\"cells\") === -1 ? !1 : Tools.diffValue(anchorPath, focusPath);\n}\n__name(isInSameTableCell, \"isInSameTableCell\");\nfunction compareNodePositionInTable(a, b) {\n  if (isInSameTableCell(a, b))\n    return compareNodePositionLogic(a, b);\n  const { path: aPath } = a, { path: bPath } = b, aTableId = aPath[aPath.length - 5], bTableId = bPath[bPath.length - 5];\n  if (aTableId !== bTableId && typeof aTableId == \"string\" && typeof bTableId == \"string\") {\n    const aSlideId = aTableId.split(\"#-#\")[1], bSlideId = bTableId.split(\"#-#\")[1];\n    return +aSlideId < +bSlideId;\n  }\n  const aRowCount = aPath[aPath.length - 3], bRowCount = bPath[bPath.length - 3], aCellCount = aPath[aPath.length - 1], bCellCount = bPath[bPath.length - 1];\n  return aRowCount < bRowCount ? !0 : aRowCount > bRowCount ? !1 : aCellCount <= bCellCount;\n}\n__name(compareNodePositionInTable, \"compareNodePositionInTable\");\nfunction firstGlyphInCellPage(cellPage) {\n  return cellPage.sections[0].columns[0].lines[0].divides[0].glyphGroup[0];\n}\n__name(firstGlyphInCellPage, \"firstGlyphInCellPage\");\nfunction lastGlyphInCellPage(cellPage) {\n  const { sections } = cellPage, lastSection = sections[sections.length - 1], lastColumn = lastSection.columns[lastSection.columns.length - 1], lastLine = lastColumn.lines[lastColumn.lines.length - 1], lastGlyphGroup = lastLine.divides[lastLine.divides.length - 1].glyphGroup;\n  return lastGlyphGroup[lastGlyphGroup.length - 2];\n}\n__name(lastGlyphInCellPage, \"lastGlyphInCellPage\");\nconst _NodePositionConvertToRectRange = class _NodePositionConvertToRectRange {\n  constructor(_documentOffsetConfig, _docSkeleton) {\n    __publicField(this, \"_liquid\", new Liquid());\n    this._documentOffsetConfig = _documentOffsetConfig, this._docSkeleton = _docSkeleton;\n  }\n  // eslint-disable-next-line max-lines-per-function\n  getRangePointData(startNodePosition, endNodePosition) {\n    const pointGroup = [], skeletonData = this._docSkeleton.getSkeletonData();\n    if (skeletonData == null)\n      return;\n    const { pages } = skeletonData, { segmentPage: startSegmentPage, page: startPage, pageType } = startNodePosition, { segmentPage: endSegmentPage, page: endPage } = endNodePosition, rectInfo = this._getTableRectRangeInfo(startNodePosition, endNodePosition);\n    if (rectInfo == null)\n      return;\n    const {\n      tableId,\n      startRowIndex: startRow,\n      startColumnIndex: startColumn,\n      endRowIndex: endRow,\n      endColumnIndex: endColumn\n    } = rectInfo;\n    this._liquid.reset();\n    const { pageLayoutType, pageMarginLeft, pageMarginTop } = this._documentOffsetConfig, skipPageIndex = pageType === DocumentSkeletonPageType.BODY || pageType === DocumentSkeletonPageType.CELL ? startPage : startSegmentPage;\n    for (let p2 = 0; p2 < skipPageIndex; p2++) {\n      const page = pages[p2];\n      this._liquid.translatePage(page, pageLayoutType, pageMarginLeft, pageMarginTop);\n    }\n    const endIndex = pageType === DocumentSkeletonPageType.BODY || pageType === DocumentSkeletonPageType.CELL ? endPage : endSegmentPage;\n    for (let p2 = skipPageIndex; p2 <= endIndex; p2++) {\n      const page = pages[p2];\n      this._liquid.translatePagePadding(page);\n      const { skeTables } = page;\n      let table = null;\n      for (const [id, tableSke] of skeTables.entries())\n        id.startsWith(tableId) && (table = tableSke);\n      if (table == null) {\n        this._liquid.restorePagePadding(page), this._liquid.translatePage(page, pageLayoutType, pageMarginLeft, pageMarginTop);\n        continue;\n      }\n      this._liquid.translateSave(), this._liquid.translate(0, table.top);\n      const { x, y } = this._liquid;\n      for (const row of table.rows)\n        if (row.index >= startRow && row.index <= endRow) {\n          const rowStartCell = row.cells[startColumn], rowEndCell = row.cells[endColumn], position = {\n            startX: x + rowStartCell.left,\n            startY: y + row.top,\n            endX: x + rowEndCell.left + rowEndCell.pageWidth,\n            endY: y + row.top + row.height\n          };\n          pointGroup.push(pushToPoints(position));\n        }\n      this._liquid.translateRestore(), this._liquid.restorePagePadding(page), this._liquid.translatePage(page, pageLayoutType, pageMarginLeft, pageMarginTop);\n    }\n    return {\n      pointGroup,\n      startRow,\n      startColumn,\n      endRow,\n      endColumn,\n      tableId\n    };\n  }\n  getNodePositionGroup(anchorNodePosition, focusNodePosition) {\n    const nodePositionGroup = [], compare = compareNodePositionInTable(anchorNodePosition, focusNodePosition), startNodePosition = compare ? anchorNodePosition : focusNodePosition, endNodePosition = compare ? focusNodePosition : anchorNodePosition, { segmentPage } = startNodePosition, rectInfo = this._getTableRectRangeInfo(startNodePosition, endNodePosition);\n    if (rectInfo == null)\n      return;\n    const { tableId, pages, startRowIndex, startColumnIndex, endRowIndex, endColumnIndex } = rectInfo, tables = [];\n    for (const page of pages) {\n      const { skeTables } = page;\n      for (const [id, table] of skeTables.entries())\n        id.startsWith(tableId) && tables.push(table);\n    }\n    if (tables.length === 0)\n      return;\n    const totalColumns = tables[0].rows[0].cells.length;\n    if (startColumnIndex === 0 && endColumnIndex === totalColumns - 1)\n      return nodePositionGroup.push({\n        anchor: anchorNodePosition,\n        focus: focusNodePosition\n      }), nodePositionGroup;\n    for (const table of tables)\n      this._collectPositionGroup(table, nodePositionGroup, startRowIndex, endRowIndex, startColumnIndex, endColumnIndex, segmentPage, compare);\n    return nodePositionGroup;\n  }\n  _collectPositionGroup(table, nodePositionGroup, startRowIndex, endRowIndex, startColumnIndex, endColumnIndex, segmentPage, compare) {\n    for (let i = 0; i < table.rows.length; i++) {\n      const row = table.rows[i];\n      if (row.index < startRowIndex)\n        continue;\n      if (row.index > endRowIndex)\n        break;\n      const startCellInRow = row.cells[startColumnIndex], endCellInRow = row.cells[endColumnIndex], startCellGlyph = firstGlyphInCellPage(startCellInRow), endCellGlyph = lastGlyphInCellPage(endCellInRow);\n      if (startCellGlyph == null || endCellGlyph == null)\n        continue;\n      const startPosition = this._docSkeleton.findPositionByGlyph(startCellGlyph, segmentPage), endPosition = this._docSkeleton.findPositionByGlyph(endCellGlyph, segmentPage);\n      if (startPosition == null || endPosition == null)\n        continue;\n      const anchor = compare ? startPosition : endPosition, focus = compare ? endPosition : startPosition;\n      nodePositionGroup.push({\n        anchor: {\n          ...anchor,\n          isBack: !0\n          // true or false is the same.\n        },\n        focus: {\n          ...focus,\n          isBack: !0\n        }\n      });\n    }\n  }\n  _getTableRectRangeInfo(startNodePosition, endNodePosition) {\n    const skeletonData = this._docSkeleton.getSkeletonData();\n    if (skeletonData == null)\n      return;\n    const { pages } = skeletonData, { path: startPath } = startNodePosition, { path: endPath } = endNodePosition, startCell = getPageFromPath(skeletonData, startPath), endCell = getPageFromPath(skeletonData, endPath);\n    if (startCell == null || endCell == null)\n      return;\n    const tableId = startCell.segmentId, startRow = startCell.parent.index, startColumn = startCell.parent.cells.indexOf(startCell), endRow = (endCell == null ? void 0 : endCell.parent).index, endColumn = (endCell == null ? void 0 : endCell.parent).cells.indexOf(endCell);\n    return {\n      pages,\n      tableId,\n      startCell,\n      endCell,\n      startRowIndex: startRow,\n      startColumnIndex: startColumn,\n      endRowIndex: endRow,\n      endColumnIndex: endColumn\n    };\n  }\n};\n__name(_NodePositionConvertToRectRange, \"NodePositionConvertToRectRange\");\nlet NodePositionConvertToRectRange = _NodePositionConvertToRectRange;\nconst TEXT_RANGE_KEY_PREFIX = \"__TestSelectionRange__\", TEXT_ANCHOR_KEY_PREFIX = \"__TestSelectionAnchor__\", ID_LENGTH$1 = 6, BLINK_ON = 500, BLINK_OFF = 500, TEXT_RANGE_LAYER_INDEX = 3;\nfunction getAnchorBounding(pointsGroup) {\n  const points = pointsGroup[0], startPoint = points[0], endPoint = points[2], { x: startX, y: startY } = startPoint, { x: endX, y: endY } = endPoint;\n  return {\n    left: startX,\n    top: startY,\n    width: endX - startX,\n    height: endY - startY\n  };\n}\n__name(getAnchorBounding, \"getAnchorBounding\");\nfunction getLineBounding(pointsGroup) {\n  return pointsGroup.map((line) => {\n    let xMin = 1 / 0, xMax = -1 / 0, yMin = 1 / 0, yMax = -1 / 0;\n    return line.forEach((point) => {\n      xMin = Math.min(point.x, xMin), xMax = Math.max(point.x, xMax), yMax = Math.max(point.y, yMax), yMin = Math.min(point.y, yMin);\n    }), {\n      left: xMin,\n      right: xMax,\n      top: yMin,\n      bottom: yMax\n    };\n  });\n}\n__name(getLineBounding, \"getLineBounding\");\nconst _TextRange = class _TextRange {\n  constructor(_scene, _document, _docSkeleton, anchorNodePosition, focusNodePosition, style = NORMAL_TEXT_SELECTION_PLUGIN_STYLE, _segmentId = \"\", _segmentPage = -1) {\n    __publicField(this, \"rangeType\", DOC_RANGE_TYPE.TEXT);\n    // Identifies whether the range is the current one, most of which is the last range.\n    __publicField(this, \"_current\", !1);\n    // The rendered range graphic when collapsed is false\n    __publicField(this, \"_rangeShape\");\n    // The rendered range graphic when collapsed is true\n    __publicField(this, \"_anchorShape\");\n    __publicField(this, \"_cursorList\", []);\n    __publicField(this, \"_anchorBlinkTimer\", null);\n    this._scene = _scene, this._document = _document, this._docSkeleton = _docSkeleton, this.anchorNodePosition = anchorNodePosition, this.focusNodePosition = focusNodePosition, this.style = style, this._segmentId = _segmentId, this._segmentPage = _segmentPage, this._anchorBlink(), this.refresh();\n  }\n  _anchorBlink() {\n    setTimeout(() => {\n      this._anchorShape && this._anchorShape.visible && this.deactivateStatic();\n    }, BLINK_ON), this._anchorBlinkTimer = setInterval(() => {\n      this._anchorShape && this._anchorShape.visible && (this.activeStatic(), setTimeout(() => {\n        this.deactivateStatic();\n      }, BLINK_ON));\n    }, BLINK_OFF + BLINK_ON);\n  }\n  // The start position of the range\n  get startOffset() {\n    var _a28;\n    const { startOffset } = (_a28 = getOneTextSelectionRange(this._cursorList)) != null ? _a28 : {}, body = this._docSkeleton.getViewModel().getDataModel().getSelfOrHeaderFooterModel(this._segmentId).getBody();\n    if (startOffset == null || body == null)\n      return startOffset;\n    const maxLength = body.dataStream.length - 2;\n    return Math.min(maxLength, startOffset);\n  }\n  // The end position of the range\n  get endOffset() {\n    var _a28;\n    const { endOffset } = (_a28 = getOneTextSelectionRange(this._cursorList)) != null ? _a28 : {}, body = this._docSkeleton.getViewModel().getDataModel().getSelfOrHeaderFooterModel(this._segmentId).getBody();\n    if (endOffset == null || body == null)\n      return endOffset;\n    const maxLength = body.dataStream.length - 2;\n    return Math.min(endOffset, maxLength);\n  }\n  get collapsed() {\n    const { startOffset, endOffset } = this;\n    return startOffset != null && startOffset === endOffset;\n  }\n  get startNodePosition() {\n    if (this.anchorNodePosition == null)\n      return null;\n    if (this.focusNodePosition == null)\n      return this.anchorNodePosition;\n    const { start } = compareNodePosition(this.anchorNodePosition, this.focusNodePosition);\n    return start;\n  }\n  get endNodePosition() {\n    if (this.anchorNodePosition == null)\n      return this.focusNodePosition;\n    if (this.focusNodePosition == null)\n      return null;\n    const { end } = compareNodePosition(this.anchorNodePosition, this.focusNodePosition);\n    return end;\n  }\n  get direction() {\n    const { collapsed, anchorNodePosition, focusNodePosition } = this;\n    return collapsed || anchorNodePosition == null || focusNodePosition == null ? RANGE_DIRECTION.NONE : compareNodePositionLogic(anchorNodePosition, focusNodePosition) ? RANGE_DIRECTION.FORWARD : RANGE_DIRECTION.BACKWARD;\n  }\n  get segmentId() {\n    return this._segmentId;\n  }\n  get segmentPage() {\n    return this._segmentPage;\n  }\n  getAbsolutePosition() {\n    const anchor = this.anchorNodePosition, focus = this.focusNodePosition;\n    if (this._isEmpty())\n      return;\n    const documentOffsetConfig = this._document.getOffsetConfig(), { docsLeft, docsTop } = documentOffsetConfig, convertor = new NodePositionConvertToCursor(documentOffsetConfig, this._docSkeleton);\n    if (this._isCollapsed()) {\n      const { contentBoxPointGroup, cursorList: cursorList2 } = convertor.getRangePointData(anchor, anchor);\n      if (this._setCursorList(cursorList2), contentBoxPointGroup.length === 0)\n        return;\n      const pos2 = getAnchorBounding(contentBoxPointGroup);\n      return {\n        ...pos2,\n        left: pos2.left + docsLeft,\n        top: pos2.top + docsTop\n      };\n    }\n    const { borderBoxPointGroup, cursorList } = convertor.getRangePointData(anchor, focus);\n    if (this._setCursorList(cursorList), borderBoxPointGroup.length === 0)\n      return;\n    const pos = getAnchorBounding(borderBoxPointGroup);\n    return {\n      ...pos,\n      left: pos.left + docsLeft,\n      top: pos.top + docsTop\n    };\n  }\n  getAnchor() {\n    return this._anchorShape;\n  }\n  activeStatic() {\n    var _a28, _b;\n    (_b = this._anchorShape) == null || _b.setProps({\n      stroke: ((_a28 = this.style) == null ? void 0 : _a28.strokeActive) || getColor(COLORS.black, 1)\n    });\n  }\n  deactivateStatic() {\n    var _a28, _b;\n    (_b = this._anchorShape) == null || _b.setProps({\n      stroke: ((_a28 = this.style) == null ? void 0 : _a28.stroke) || getColor(COLORS.black, 0)\n    });\n  }\n  isActive() {\n    return this._current === !0;\n  }\n  activate() {\n    this._current = !0;\n  }\n  deactivate() {\n    this._current = !1;\n  }\n  dispose() {\n    var _a28, _b;\n    (_a28 = this._rangeShape) == null || _a28.dispose(), this._rangeShape = null, (_b = this._anchorShape) == null || _b.dispose(), this._anchorShape = null, this._anchorBlinkTimer && (clearInterval(this._anchorBlinkTimer), this._anchorBlinkTimer = null);\n  }\n  isIntersection(compareRange) {\n    const { startOffset: activeStart, endOffset: activeEnd } = this, { startOffset: compareStart, endOffset: compareEnd } = compareRange;\n    return activeStart == null || activeEnd == null || compareStart == null || compareEnd == null ? !1 : activeStart <= compareEnd && activeEnd >= compareStart;\n  }\n  // render cursor and selection.\n  refresh() {\n    var _a28, _b;\n    const { _document, _docSkeleton } = this, anchor = this.anchorNodePosition, focus = this.focusNodePosition;\n    if ((_a28 = this._anchorShape) == null || _a28.hide(), (_b = this._rangeShape) == null || _b.hide(), this._isEmpty())\n      return;\n    const documentOffsetConfig = _document.getOffsetConfig(), { docsLeft, docsTop } = documentOffsetConfig, convertor = new NodePositionConvertToCursor(documentOffsetConfig, _docSkeleton);\n    if (this._isCollapsed()) {\n      const { contentBoxPointGroup, cursorList: cursorList2 } = convertor.getRangePointData(anchor, anchor);\n      if (this._setCursorList(cursorList2), contentBoxPointGroup.length > 0) {\n        const glyphAtCursor = _docSkeleton.findGlyphByPosition(anchor);\n        this._createOrUpdateAnchor(contentBoxPointGroup, docsLeft, docsTop, glyphAtCursor);\n      }\n      return;\n    }\n    const { borderBoxPointGroup, cursorList } = convertor.getRangePointData(anchor, focus);\n    this._setCursorList(cursorList), borderBoxPointGroup.length > 0 && this._createOrUpdateRange(borderBoxPointGroup, docsLeft, docsTop);\n  }\n  _isEmpty() {\n    return this.anchorNodePosition == null && this.focusNodePosition == null;\n  }\n  _isCollapsed() {\n    const anchor = this.anchorNodePosition, focus = this.focusNodePosition;\n    if (anchor != null && focus == null)\n      return !0;\n    if (anchor == null || focus == null)\n      return !1;\n    const keys = Object.keys(NodePositionMap);\n    for (const key of keys) {\n      const startNodeValue = anchor[key], endNodeValue = focus[key];\n      if (startNodeValue !== endNodeValue)\n        return !1;\n    }\n    return anchor.isBack === focus.isBack;\n  }\n  _createOrUpdateRange(pointsGroup, left, top) {\n    var _a28;\n    if (this._rangeShape) {\n      this._rangeShape.translate(left, top), this._rangeShape.updatePointGroup(pointsGroup), this._rangeShape.show();\n      return;\n    }\n    const OPACITY = 0.3, polygon = new RegularPolygon(TEXT_RANGE_KEY_PREFIX + Tools.generateRandomId(ID_LENGTH$1), {\n      pointsGroup,\n      fill: ((_a28 = this.style) == null ? void 0 : _a28.fill) || getColor(COLORS.black, OPACITY),\n      left,\n      top,\n      evented: !1,\n      debounceParentDirty: !1\n    });\n    this._rangeShape = polygon, this._scene.addObject(polygon, TEXT_RANGE_LAYER_INDEX);\n  }\n  _createOrUpdateAnchor(pointsGroup, docsLeft, docsTop, glyph) {\n    var _a28, _b, _c;\n    const bounding = getAnchorBounding(pointsGroup), { left: boundingLeft } = bounding;\n    let { top: boundingTop, height } = bounding;\n    const MIN_CURSOR_HEIGHT = 14;\n    height < MIN_CURSOR_HEIGHT && (boundingTop -= MIN_CURSOR_HEIGHT - height, height = MIN_CURSOR_HEIGHT);\n    const ITALIC_DEGREE = 12;\n    let left = boundingLeft + docsLeft;\n    const top = boundingTop + docsTop, isItalic = ((_a28 = glyph == null ? void 0 : glyph.ts) == null ? void 0 : _a28.it) === BooleanNumber.TRUE;\n    if (isItalic && (left += height * Math.tan(ITALIC_DEGREE * Math.PI / 180) / 2), this._anchorShape) {\n      this._anchorShape.transformByState({ left, top, height }), this._anchorShape.show(), isItalic ? this._anchorShape.skew(-ITALIC_DEGREE, 0) : this._anchorShape.skew(0, 0);\n      return;\n    }\n    const anchor = new Rect(TEXT_ANCHOR_KEY_PREFIX + Tools.generateRandomId(ID_LENGTH$1), {\n      left,\n      top,\n      height,\n      strokeWidth: ((_b = this.style) == null ? void 0 : _b.strokeWidth) || 1.5,\n      stroke: ((_c = this.style) == null ? void 0 : _c.strokeActive) || getColor(COLORS.black, 1),\n      evented: !1\n    });\n    isItalic && anchor.skew(-ITALIC_DEGREE, 0), this._anchorShape = anchor, this._scene.addObject(anchor, TEXT_RANGE_LAYER_INDEX);\n  }\n  _setCursorList(cursorList) {\n    cursorList.length !== 0 && (this._cursorList = cursorList);\n  }\n};\n__name(_TextRange, \"TextRange\");\nlet TextRange = _TextRange;\nconst RECT_RANGE_KEY_PREFIX = \"__DocTableRectRange__\", ID_LENGTH = 6;\nfunction convertPositionsToRectRanges(scene, document2, docSkeleton, anchorNodePosition, focusNodePosition, style = NORMAL_TEXT_SELECTION_PLUGIN_STYLE, segmentId = \"\", segmentPage = -1) {\n  const documentOffsetConfig = document2.getOffsetConfig(), nodePositionGroup = new NodePositionConvertToRectRange(documentOffsetConfig, docSkeleton).getNodePositionGroup(anchorNodePosition, focusNodePosition);\n  return (nodePositionGroup != null ? nodePositionGroup : []).map((position) => new RectRange(\n    scene,\n    document2,\n    docSkeleton,\n    position.anchor,\n    position.focus,\n    style,\n    segmentId,\n    segmentPage\n  ));\n}\n__name(convertPositionsToRectRanges, \"convertPositionsToRectRanges\");\nconst _RectRange = class _RectRange {\n  constructor(_scene, _document, _docSkeleton, anchorNodePosition, focusNodePosition, style = NORMAL_TEXT_SELECTION_PLUGIN_STYLE, _segmentId = \"\", _segmentPage = -1) {\n    __publicField(this, \"rangeType\", DOC_RANGE_TYPE.RECT);\n    // The rendered rect range\n    __publicField(this, \"_rangeShape\");\n    // Identifies whether the range is the current one, most of which is the last range.\n    __publicField(this, \"_current\", !1);\n    // Rect Range start row.\n    __publicField(this, \"_startRow\");\n    // Rect Range start column.\n    __publicField(this, \"_startCol\");\n    // Rect Range end row.\n    __publicField(this, \"_endRow\");\n    // Rect Range end column.\n    __publicField(this, \"_endCol\");\n    // table id in view model.\n    __publicField(this, \"_tableId\");\n    this._scene = _scene, this._document = _document, this._docSkeleton = _docSkeleton, this.anchorNodePosition = anchorNodePosition, this.focusNodePosition = focusNodePosition, this.style = style, this._segmentId = _segmentId, this._segmentPage = _segmentPage, this.refresh();\n  }\n  get startOffset() {\n    const { startNodePosition } = this;\n    return this._docSkeleton.findCharIndexByPosition(startNodePosition);\n  }\n  get endOffset() {\n    const { endNodePosition } = this;\n    return this._docSkeleton.findCharIndexByPosition(endNodePosition);\n  }\n  get collapsed() {\n    return !1;\n  }\n  get startRow() {\n    return this._startRow;\n  }\n  get startColumn() {\n    return this._startCol;\n  }\n  get endRow() {\n    return this._endRow;\n  }\n  get endColumn() {\n    return this._endCol;\n  }\n  get tableId() {\n    return this._tableId;\n  }\n  get segmentId() {\n    return this._segmentId;\n  }\n  get segmentPage() {\n    return this._segmentPage;\n  }\n  get spanEntireRow() {\n    var _a28;\n    const table = (_a28 = this._docSkeleton.getViewModel().getSnapshot().tableSource) == null ? void 0 : _a28[this._tableId], { _startCol, _endCol } = this;\n    if (table == null)\n      throw new Error(\"Table is not found.\");\n    const { tableColumns } = table;\n    return _startCol === 0 && _endCol === tableColumns.length - 1;\n  }\n  get spanEntireColumn() {\n    var _a28;\n    const table = (_a28 = this._docSkeleton.getViewModel().getSnapshot().tableSource) == null ? void 0 : _a28[this._tableId], { _startRow, _endRow } = this;\n    if (table == null)\n      throw new Error(\"Table is not found.\");\n    const { tableRows } = table;\n    return _startRow === 0 && _endRow === tableRows.length - 1;\n  }\n  get spanEntireTable() {\n    return this.spanEntireRow && this.spanEntireColumn;\n  }\n  get startNodePosition() {\n    const { anchorNodePosition, focusNodePosition } = this;\n    return compareNodePositionInTable(anchorNodePosition, focusNodePosition) ? anchorNodePosition : focusNodePosition;\n  }\n  get endNodePosition() {\n    const { anchorNodePosition, focusNodePosition } = this;\n    return compareNodePositionInTable(anchorNodePosition, focusNodePosition) ? focusNodePosition : anchorNodePosition;\n  }\n  get direction() {\n    const { anchorNodePosition, focusNodePosition } = this;\n    return compareNodePositionInTable(anchorNodePosition, focusNodePosition) ? RANGE_DIRECTION.FORWARD : RANGE_DIRECTION.BACKWARD;\n  }\n  isActive() {\n    return this._current === !0;\n  }\n  activate() {\n    this._current = !0;\n  }\n  deactivate() {\n    this._current = !1;\n  }\n  dispose() {\n    var _a28;\n    (_a28 = this._rangeShape) == null || _a28.dispose(), this._rangeShape = null;\n  }\n  isIntersection(compareRange) {\n    const { startRow, startColumn, endRow, endColumn } = this, { startRow: cStartRow, startColumn: cStartColumn, endRow: cEndRow, endColumn: cEndColumn } = compareRange, rect1 = {\n      left: startColumn,\n      top: startRow,\n      right: endColumn,\n      bottom: endRow\n    }, rect2 = {\n      left: cStartColumn,\n      top: cStartRow,\n      right: cEndColumn,\n      bottom: cEndRow\n    };\n    return Rectangle.hasIntersectionBetweenTwoRect(rect1, rect2);\n  }\n  refresh() {\n    var _a28;\n    (_a28 = this._rangeShape) == null || _a28.hide();\n    const { startNodePosition, endNodePosition, _document, _docSkeleton } = this, documentOffsetConfig = _document.getOffsetConfig(), { docsLeft, docsTop } = documentOffsetConfig, rectInfo = new NodePositionConvertToRectRange(documentOffsetConfig, _docSkeleton).getRangePointData(startNodePosition, endNodePosition);\n    if (rectInfo == null)\n      return;\n    const { pointGroup = [], startRow, endRow, startColumn, endColumn, tableId } = rectInfo;\n    (pointGroup == null ? void 0 : pointGroup.length) > 0 && this._createOrUpdateRange(pointGroup, docsLeft, docsTop), this._updateTableInfo(startRow, endRow, startColumn, endColumn, tableId);\n  }\n  _updateTableInfo(startRow, endRow, startCol, endCol, tableId) {\n    this._startRow = startRow, this._endRow = endRow, this._startCol = startCol, this._endCol = endCol, this._tableId = tableId;\n  }\n  _createOrUpdateRange(pointsGroup, left, top) {\n    var _a28;\n    if (this._rangeShape) {\n      this._rangeShape.translate(left, top), this._rangeShape.updatePointGroup(pointsGroup), this._rangeShape.show();\n      return;\n    }\n    const OPACITY = 0.3, polygon = new RegularPolygon(RECT_RANGE_KEY_PREFIX + Tools.generateRandomId(ID_LENGTH), {\n      pointsGroup,\n      fill: ((_a28 = this.style) == null ? void 0 : _a28.fill) || getColor(COLORS.black, OPACITY),\n      left,\n      top,\n      evented: !1,\n      debounceParentDirty: !1\n    });\n    this._rangeShape = polygon, this._scene.addObject(polygon, TEXT_RANGE_LAYER_INDEX);\n  }\n};\n__name(_RectRange, \"RectRange\");\nlet RectRange = _RectRange;\nfunction getTextRangeFromCharIndex(startOffset, endOffset, scene, document2, skeleton, style, segmentId, segmentPage) {\n  const startNodePosition = skeleton.findNodePositionByCharIndex(startOffset, !0, segmentId, segmentPage), endNodePosition = skeleton.findNodePositionByCharIndex(endOffset, !0, segmentId, segmentPage);\n  if (!(startNodePosition == null || endNodePosition == null))\n    return new TextRange(scene, document2, skeleton, startNodePosition, endNodePosition, style, segmentId, segmentPage);\n}\n__name(getTextRangeFromCharIndex, \"getTextRangeFromCharIndex\");\nfunction getRectRangeFromCharIndex(startOffset, endOffset, scene, document2, skeleton, style, segmentId, segmentPage) {\n  const startNodePosition = skeleton.findNodePositionByCharIndex(startOffset, !0, segmentId, segmentPage), endNodePosition = skeleton.findNodePositionByCharIndex(endOffset, !0, segmentId, segmentPage);\n  if (!(startNodePosition == null || endNodePosition == null))\n    return new RectRange(scene, document2, skeleton, startNodePosition, endNodePosition, style, segmentId, segmentPage);\n}\n__name(getRectRangeFromCharIndex, \"getRectRangeFromCharIndex\");\nfunction getRangeListFromCharIndex(startOffset, endOffset, scene, document2, skeleton, style, segmentId, segmentPage) {\n  const startNodePosition = skeleton.findNodePositionByCharIndex(startOffset, !0, segmentId, segmentPage), endNodePosition = skeleton.findNodePositionByCharIndex(endOffset, !0, segmentId, segmentPage);\n  if (!(startNodePosition == null || endNodePosition == null))\n    return getRangeListFromSelection(\n      startNodePosition,\n      endNodePosition,\n      scene,\n      document2,\n      skeleton,\n      style,\n      segmentId,\n      segmentPage\n    );\n}\n__name(getRangeListFromCharIndex, \"getRangeListFromCharIndex\");\nfunction getRangeListFromSelection(anchorPosition, focusPosition, scene, document2, skeleton, style, segmentId, segmentPage) {\n  const textRanges = [], rectRanges = [], rangeParams = [scene, document2, skeleton, anchorPosition, focusPosition, style, segmentId, segmentPage];\n  if (isInSameTableCell(anchorPosition, focusPosition))\n    return textRanges.push(new TextRange(...rangeParams)), {\n      textRanges,\n      rectRanges\n    };\n  if (isValidRectRange(anchorPosition, focusPosition)) {\n    const ranges = convertPositionsToRectRanges(\n      ...rangeParams\n    );\n    return rectRanges.push(...ranges), {\n      textRanges,\n      rectRanges\n    };\n  }\n  const viewModel = skeleton.getViewModel().getSelfOrHeaderFooterViewModel(segmentId), anchorOffset = skeleton.findCharIndexByPosition(anchorPosition), focusOffset = skeleton.findCharIndexByPosition(focusPosition);\n  if (anchorOffset == null || focusOffset == null)\n    return;\n  const direction = anchorOffset <= focusOffset ? RANGE_DIRECTION.FORWARD : RANGE_DIRECTION.BACKWARD, startOffset = Math.min(anchorOffset, focusOffset), endOffset = Math.max(anchorOffset, focusOffset);\n  let start = startOffset, end = endOffset;\n  for (const section of viewModel.children)\n    for (const paragraph of section.children) {\n      const { startIndex, endIndex, children } = paragraph, table = children[0];\n      let endInTable = !1;\n      if (table) {\n        const { startIndex: tableStart, endIndex: tableEnd, children: children2 } = table;\n        let tableStartPosition = null, tableEndPosition = null;\n        const startRow = children2.find((row) => row.startIndex <= startOffset && row.endIndex >= startOffset), endRow = children2.find((row) => row.startIndex <= endOffset && row.endIndex >= endOffset);\n        if (startOffset > tableStart && startOffset < tableEnd)\n          tableStartPosition = skeleton.findNodePositionByCharIndex(startRow.startIndex + 2, !0, segmentId, segmentPage), tableEndPosition = skeleton.findNodePositionByCharIndex(tableEnd - 4, !0, segmentId, segmentPage), start = tableEnd + 1;\n        else if (endOffset > tableStart && endOffset < tableEnd)\n          tableStartPosition = skeleton.findNodePositionByCharIndex(tableStart + 3, !0, segmentId, segmentPage), tableEndPosition = skeleton.findNodePositionByCharIndex(endRow.endIndex - 3, !0, segmentId, segmentPage), end = tableStart - 1, endInTable = !0;\n        else if (tableStart > startOffset && tableEnd < endOffset) {\n          if (tableStartPosition = skeleton.findNodePositionByCharIndex(tableStart + 3, !0, segmentId, segmentPage), tableEndPosition = skeleton.findNodePositionByCharIndex(tableEnd - 4, !0, segmentId, segmentPage), start <= tableStart - 1) {\n            const sp = skeleton.findNodePositionByCharIndex(start, !0, segmentId, segmentPage), ep = skeleton.findNodePositionByCharIndex(tableStart - 1, !1, segmentId, segmentPage), ap = direction === RANGE_DIRECTION.FORWARD ? sp : ep, fp = direction === RANGE_DIRECTION.FORWARD ? ep : sp;\n            textRanges.push(new TextRange(scene, document2, skeleton, ap, fp, style, segmentId, segmentPage));\n          }\n          start = tableEnd + 1;\n        }\n        if (tableStartPosition && tableEndPosition) {\n          const ap = direction === RANGE_DIRECTION.FORWARD ? tableStartPosition : tableEndPosition, fp = direction === RANGE_DIRECTION.FORWARD ? tableEndPosition : tableStartPosition;\n          rectRanges.push(...convertPositionsToRectRanges(\n            scene,\n            document2,\n            skeleton,\n            ap,\n            fp,\n            style,\n            segmentId,\n            segmentPage\n          ));\n        }\n      }\n      if (end >= startIndex && end <= endIndex || endInTable) {\n        const sp = skeleton.findNodePositionByCharIndex(start, !0, segmentId, segmentPage), ep = skeleton.findNodePositionByCharIndex(end, !endInTable, segmentId, segmentPage), ap = direction === RANGE_DIRECTION.FORWARD ? sp : ep, fp = direction === RANGE_DIRECTION.FORWARD ? ep : sp;\n        if (rectRanges.length && Tools.diffValue(ap, fp))\n          continue;\n        textRanges.push(new TextRange(scene, document2, skeleton, ap, fp, style, segmentId, segmentPage));\n      }\n    }\n  return {\n    textRanges,\n    rectRanges\n  };\n}\n__name(getRangeListFromSelection, \"getRangeListFromSelection\");\nfunction getCanvasOffsetByEngine(engine) {\n  const canvas = engine == null ? void 0 : engine.getCanvasElement();\n  if (!canvas)\n    return {\n      left: 0,\n      top: 0\n    };\n  const { top, left } = getOffsetRectForDom(canvas);\n  return {\n    left,\n    top\n  };\n}\n__name(getCanvasOffsetByEngine, \"getCanvasOffsetByEngine\");\nfunction getParagraphInfoByGlyph(node) {\n  var _a28;\n  const line = (_a28 = node.parent) == null ? void 0 : _a28.parent, column = line == null ? void 0 : line.parent;\n  if (line == null || column == null)\n    return;\n  const { paragraphIndex } = line, lines = column.lines.filter((line2) => line2.paragraphIndex === paragraphIndex);\n  let nodeIndex = -1, content = \"\", hasFound = !1;\n  for (const line2 of lines)\n    for (const divide of line2.divides)\n      for (const glyph of divide.glyphGroup)\n        hasFound || (nodeIndex += glyph.count), glyph === node && (hasFound = !0), content += glyph.count > 0 ? glyph.content : \"\";\n  return {\n    st: lines[0].st,\n    ed: paragraphIndex,\n    content,\n    nodeIndex\n  };\n}\n__name(getParagraphInfoByGlyph, \"getParagraphInfoByGlyph\");\nfunction serializeTextRange(textRange) {\n  const { startOffset, endOffset, collapsed, rangeType, startNodePosition, endNodePosition, direction, segmentId, segmentPage } = textRange;\n  return {\n    startOffset,\n    endOffset,\n    collapsed,\n    rangeType,\n    startNodePosition,\n    endNodePosition,\n    direction,\n    segmentId,\n    segmentPage,\n    isActive: textRange.isActive()\n  };\n}\n__name(serializeTextRange, \"serializeTextRange\");\nfunction serializeRectRange(rectRange) {\n  const serializedTextRange = serializeTextRange(rectRange), {\n    startRow,\n    startColumn,\n    endRow,\n    endColumn,\n    tableId,\n    spanEntireRow,\n    spanEntireColumn,\n    spanEntireTable\n  } = rectRange;\n  return {\n    ...serializedTextRange,\n    startRow,\n    startColumn,\n    endRow,\n    endColumn,\n    tableId,\n    spanEntireRow,\n    spanEntireColumn,\n    spanEntireTable\n  };\n}\n__name(serializeRectRange, \"serializeRectRange\");\nvar __defProp$o = Object.defineProperty, __getOwnPropDesc$o = Object.getOwnPropertyDescriptor, __decorateClass$o = /* @__PURE__ */ __name((decorators, target, key, kind) => {\n  for (var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$o(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)\n    (decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n  return kind && result && __defProp$o(target, key, result), result;\n}, \"__decorateClass$o\"), __decorateParam$o = /* @__PURE__ */ __name((index, decorator) => (target, key) => decorator(target, key, index), \"__decorateParam$o\"), _a3;\nlet DocSelectionRenderService = (_a3 = class extends RxDisposable {\n  constructor(_context, _layoutService, _logService, _docSkeletonManagerService) {\n    super();\n    __publicField(this, \"_onInputBefore$\", new Subject());\n    __publicField(this, \"onInputBefore$\", this._onInputBefore$.asObservable());\n    __publicField(this, \"_onKeydown$\", new BehaviorSubject(null));\n    __publicField(this, \"onKeydown$\", this._onKeydown$.asObservable());\n    __publicField(this, \"_onInput$\", new BehaviorSubject(null));\n    __publicField(this, \"onInput$\", this._onInput$.asObservable());\n    __publicField(this, \"_onCompositionstart$\", new BehaviorSubject(null));\n    __publicField(this, \"onCompositionstart$\", this._onCompositionstart$.asObservable());\n    __publicField(this, \"_onCompositionupdate$\", new BehaviorSubject(null));\n    __publicField(this, \"onCompositionupdate$\", this._onCompositionupdate$.asObservable());\n    __publicField(this, \"_onCompositionend$\", new BehaviorSubject(null));\n    __publicField(this, \"onCompositionend$\", this._onCompositionend$.asObservable());\n    __publicField(this, \"_onSelectionStart$\", new BehaviorSubject(null));\n    __publicField(this, \"onSelectionStart$\", this._onSelectionStart$.asObservable());\n    __publicField(this, \"_onPaste$\", new Subject());\n    __publicField(this, \"onPaste$\", this._onPaste$.asObservable());\n    __publicField(this, \"_textSelectionInner$\", new BehaviorSubject(null));\n    __publicField(this, \"textSelectionInner$\", this._textSelectionInner$.asObservable());\n    __publicField(this, \"_onFocus$\", new Subject());\n    __publicField(this, \"onFocus$\", this._onFocus$.asObservable());\n    __publicField(this, \"_onBlur$\", new Subject());\n    __publicField(this, \"onBlur$\", this._onBlur$.asObservable());\n    __publicField(this, \"_onPointerDown$\", new Subject());\n    __publicField(this, \"onPointerDown$\", this._onPointerDown$.asObservable());\n    __publicField(this, \"_container\");\n    __publicField(this, \"_inputParent\");\n    __publicField(this, \"_input\");\n    __publicField(this, \"_scrollTimers\", []);\n    __publicField(this, \"_rangeList\", []);\n    // Use to cache range list in moving.\n    __publicField(this, \"_rangeListCache\", []);\n    // Rect range list.\n    __publicField(this, \"_rectRangeList\", []);\n    // Use to cache rect range list in moving.\n    __publicField(this, \"_rectRangeListCache\", []);\n    __publicField(this, \"_anchorNodePosition\", null);\n    __publicField(this, \"_focusNodePosition\", null);\n    __publicField(this, \"_currentSegmentId\", \"\");\n    __publicField(this, \"_currentSegmentPage\", -1);\n    __publicField(this, \"_selectionStyle\", NORMAL_TEXT_SELECTION_PLUGIN_STYLE);\n    __publicField(this, \"_viewPortObserverMap\", /* @__PURE__ */ new Map());\n    __publicField(this, \"_isIMEInputApply\", !1);\n    __publicField(this, \"_scenePointerMoveSubs\", []);\n    __publicField(this, \"_scenePointerUpSubs\", []);\n    __publicField(this, \"_editorFocusing\", !0);\n    this._context = _context, this._layoutService = _layoutService, this._logService = _logService, this._docSkeletonManagerService = _docSkeletonManagerService, this._initDOM(), this._registerContainer(), this._setSystemHighlightColorToStyle();\n  }\n  get activeViewPort() {\n    return this._context.scene.getViewports()[0];\n  }\n  setSegment(id) {\n    this._currentSegmentId = id;\n  }\n  getSegment() {\n    return this._currentSegmentId;\n  }\n  setSegmentPage(pageIndex) {\n    this._currentSegmentPage = pageIndex;\n  }\n  getSegmentPage() {\n    return this._currentSegmentPage;\n  }\n  _setRangeStyle(style = NORMAL_TEXT_SELECTION_PLUGIN_STYLE) {\n    this._selectionStyle = style;\n  }\n  addDocRanges(ranges, isEditing = !0, options) {\n    const {\n      _currentSegmentId: segmentId,\n      _currentSegmentPage: segmentPage,\n      _selectionStyle: style\n    } = this, { scene, mainComponent } = this._context, document2 = mainComponent, docSkeleton = this._docSkeletonManagerService.getSkeleton();\n    for (const range of ranges) {\n      const { startOffset, endOffset, rangeType } = range;\n      if (rangeType === DOC_RANGE_TYPE.RECT) {\n        const rectRange = getRectRangeFromCharIndex(\n          startOffset,\n          endOffset,\n          scene,\n          document2,\n          docSkeleton,\n          style,\n          segmentId,\n          segmentPage\n        );\n        rectRange && this._addRectRanges([rectRange]);\n      } else if (rangeType === DOC_RANGE_TYPE.TEXT) {\n        const textRange = getTextRangeFromCharIndex(\n          startOffset,\n          endOffset,\n          scene,\n          document2,\n          docSkeleton,\n          style,\n          segmentId,\n          segmentPage\n        );\n        textRange && this._addTextRange(textRange);\n      } else {\n        const rangeList = getRangeListFromCharIndex(\n          startOffset,\n          endOffset,\n          scene,\n          document2,\n          docSkeleton,\n          style,\n          segmentId,\n          segmentPage\n        );\n        if (rangeList == null)\n          continue;\n        const { textRanges, rectRanges } = rangeList;\n        for (const textRange of textRanges)\n          this._addTextRange(textRange);\n        this._addRectRanges(rectRanges);\n      }\n    }\n    this._textSelectionInner$.next({\n      textRanges: this._getAllTextRanges(),\n      rectRanges: this._getAllRectRanges(),\n      segmentId,\n      segmentPage,\n      style,\n      isEditing,\n      options\n    }), this._updateInputPosition(options == null ? void 0 : options.forceFocus);\n  }\n  setCursorManually(evtOffsetX, evtOffsetY) {\n    const startNode = this._findNodeByCoord(evtOffsetX, evtOffsetY, {\n      strict: !0,\n      segmentId: this._currentSegmentId,\n      segmentPage: this._currentSegmentPage\n    }), position = this._getNodePosition(startNode);\n    if (position == null) {\n      this._removeAllRanges();\n      return;\n    }\n    (startNode == null ? void 0 : startNode.node.streamType) === DataStreamTreeTokenType.PARAGRAPH && (position.isBack = !0), this._createTextRangeByAnchorPosition(position), this._textSelectionInner$.next({\n      textRanges: this._getAllTextRanges(),\n      rectRanges: this._getAllRectRanges(),\n      segmentId: this._currentSegmentId,\n      segmentPage: this._currentSegmentPage,\n      style: this._selectionStyle,\n      isEditing: !1\n    });\n  }\n  // Sync canvas selection to dom selection.\n  sync() {\n    this._updateInputPosition();\n  }\n  activate(x, y, force = !1) {\n    const isFocusing = this._input === document.activeElement;\n    this._container.style.left = `${x}px`, this._container.style.top = `${y}px`, this._container.style.zIndex = \"1000\", (isFocusing || force) && this.focus();\n  }\n  hasFocus() {\n    return document.activeElement === this._input;\n  }\n  focus() {\n    this._editorFocusing && this._input.focus();\n  }\n  blur() {\n    this._input.blur();\n  }\n  focusEditor() {\n    this._editorFocusing = !0, this.focus();\n  }\n  blurEditor() {\n    this._editorFocusing = !1, this.blur();\n  }\n  // FIXME: for editor cell editor we don't need to blur the input element\n  deactivate() {\n    this._container.style.left = \"0px\", this._container.style.top = \"0px\";\n  }\n  // Handler double click.\n  __handleDblClick(evt) {\n    const { offsetX: evtOffsetX, offsetY: evtOffsetY } = evt, startNode = this._findNodeByCoord(evtOffsetX, evtOffsetY, {\n      strict: !1,\n      segmentId: this._currentSegmentId,\n      segmentPage: this._currentSegmentPage\n    });\n    if (startNode == null || startNode.node == null)\n      return;\n    const paragraphInfo = getParagraphInfoByGlyph(startNode.node);\n    if (paragraphInfo == null)\n      return;\n    const { content, st, nodeIndex } = paragraphInfo;\n    if (nodeIndex === -1 || Intl.Segmenter == null)\n      return;\n    const segments = new Intl.Segmenter(void 0, { granularity: \"word\" }).segment(content);\n    let startOffset = Number.NEGATIVE_INFINITY, endOffset = Number.NEGATIVE_INFINITY;\n    for (const { segment, index, isWordLike } of segments)\n      if (index <= nodeIndex && nodeIndex < index + segment.length && isWordLike) {\n        startOffset = index + st, endOffset = index + st + segment.length;\n        break;\n      }\n    if (Number.isFinite(startOffset) && Number.isFinite(endOffset)) {\n      this.removeAllRanges();\n      const textRanges = [\n        {\n          startOffset,\n          endOffset\n        }\n      ];\n      this.addDocRanges(textRanges, !1, { forceFocus: !0 });\n    }\n  }\n  __handleTripleClick(evt) {\n    const { offsetX: evtOffsetX, offsetY: evtOffsetY } = evt, startNode = this._findNodeByCoord(evtOffsetX, evtOffsetY, {\n      strict: !1,\n      segmentId: this._currentSegmentId,\n      segmentPage: this._currentSegmentPage\n    });\n    if (startNode == null || startNode.node == null)\n      return;\n    const paragraphInfo = getParagraphInfoByGlyph(startNode.node);\n    if (paragraphInfo == null)\n      return;\n    this.removeAllRanges();\n    const { st, ed } = paragraphInfo, textRanges = [\n      {\n        startOffset: st,\n        endOffset: ed\n      }\n    ];\n    this.addDocRanges(textRanges, !1, { forceFocus: !0 });\n  }\n  // Handle pointer down.\n  // eslint-disable-next-line max-lines-per-function, complexity\n  __onPointDown(evt) {\n    var _a28, _b;\n    this._editorFocusing = !0;\n    const { scene, mainComponent } = this._context, skeleton = this._docSkeletonManagerService.getSkeleton(), { offsetX: evtOffsetX, offsetY: evtOffsetY } = evt, startNode = this._findNodeByCoord(evtOffsetX, evtOffsetY, {\n      strict: !1,\n      segmentId: this._currentSegmentId,\n      segmentPage: this._currentSegmentPage\n    }), position = this._getNodePosition(startNode);\n    if (position == null || startNode == null) {\n      this._removeAllRanges();\n      return;\n    }\n    (startNode == null ? void 0 : startNode.node.streamType) === DataStreamTreeTokenType.PARAGRAPH && (position.isBack = !0);\n    const docSelection = this._textSelectionInner$.value;\n    if (startNode && evt.button === 2 && docSelection) {\n      const nodeCharIndex = skeleton.findCharIndexByPosition(position);\n      if (typeof nodeCharIndex == \"number\" && docSelection.textRanges.some((textRange) => textRange.startOffset <= nodeCharIndex && textRange.endOffset > nodeCharIndex) || typeof nodeCharIndex == \"number\" && docSelection.rectRanges.some((rectRange) => rectRange.startOffset <= nodeCharIndex && rectRange.endOffset >= nodeCharIndex))\n        return;\n    }\n    const { segmentId, segmentPage } = startNode;\n    segmentId && this._currentSegmentId && segmentId !== this._currentSegmentId && this.setSegment(segmentId), segmentId && segmentPage !== this._currentSegmentPage && this.setSegmentPage(segmentPage), this._anchorNodePosition = position, evt.shiftKey && this._getActiveRangeInstance() ? this._updateActiveRangePosition(position) : !evt.ctrlKey && !this._isEmpty() && this._removeAllRanges(), scene.disableObjectsEvent();\n    const scrollTimer = ScrollTimer.create(scene);\n    this._scrollTimers.push(scrollTimer), scrollTimer.startScroll(evtOffsetX, evtOffsetY), this._onSelectionStart$.next((_a28 = this._getActiveRangeInstance()) == null ? void 0 : _a28.startNodePosition), (_b = scene.getTransformer()) == null || _b.clearSelectedObjects();\n    let preMoveOffsetX = evtOffsetX, preMoveOffsetY = evtOffsetY;\n    this._scenePointerMoveSubs.push(scene.onPointerMove$.subscribeEvent((moveEvt) => {\n      const { offsetX: moveOffsetX, offsetY: moveOffsetY } = moveEvt;\n      scene.setCursor(CURSOR_TYPE.TEXT), !(Math.sqrt((moveOffsetX - preMoveOffsetX) ** 2 + (moveOffsetY - preMoveOffsetY) ** 2) < 3) && (this._moving(moveOffsetX, moveOffsetY), scrollTimer.scrolling(moveOffsetX, moveOffsetY, () => {\n        this._moving(moveOffsetX, moveOffsetY);\n      }), preMoveOffsetX = moveOffsetX, preMoveOffsetY = moveOffsetY);\n    })), this._scenePointerUpSubs.push(scene.onPointerUp$.subscribeEvent(() => {\n      if ([...this._scenePointerMoveSubs, ...this._scenePointerUpSubs].forEach((e) => {\n        e.unsubscribe();\n      }), scene.enableObjectsEvent(), this._anchorNodePosition && !this._focusNodePosition) {\n        const textRange = new TextRange(scene, mainComponent, skeleton, this._anchorNodePosition, void 0, this._selectionStyle, this._currentSegmentId, this._currentSegmentPage);\n        this._addTextRange(textRange);\n      } else if (this._anchorNodePosition && this._focusNodePosition) {\n        for (const textRange of this._rangeListCache)\n          this._addTextRange(textRange);\n        this._addRectRanges(this._rectRangeListCache), this._rangeListCache = [], this._rectRangeListCache = [];\n      }\n      this._anchorNodePosition = null, this._focusNodePosition = null;\n      const selectionInfo = {\n        textRanges: this._getAllTextRanges(),\n        rectRanges: this._getAllRectRanges(),\n        segmentId: this._currentSegmentId,\n        segmentPage: this._currentSegmentPage,\n        style: this._selectionStyle,\n        isEditing: !1\n      };\n      this._textSelectionInner$.next(selectionInfo), this._scrollTimers.forEach((timer) => {\n        timer == null || timer.dispose();\n      }), this._scrollTimers = [], this._updateInputPosition(!0);\n    }));\n  }\n  removeAllRanges() {\n    this._removeAllRanges(), this.deactivate();\n  }\n  getActiveTextRange() {\n    return this._getActiveRangeInstance();\n  }\n  _setSystemHighlightColorToStyle() {\n    const { r, g, b, a } = getSystemHighlightColor(), style = {\n      strokeWidth: 1.5,\n      stroke: \"rgba(0, 0, 0, 0)\",\n      strokeActive: \"rgba(0, 0, 0, 1)\",\n      fill: `rgba(${r}, ${g}, ${b}, ${a != null ? a : 0.3})`\n    };\n    this._setRangeStyle(style);\n  }\n  _getAllTextRanges() {\n    return this._rangeList.map(serializeTextRange);\n  }\n  _getAllRectRanges() {\n    return this._rectRangeList.map(serializeRectRange);\n  }\n  _getActiveRange() {\n    const activeRange = this._rangeList.find((range) => range.isActive());\n    if (activeRange == null)\n      return null;\n    const { startOffset, endOffset } = activeRange;\n    return startOffset == null || endOffset == null ? null : serializeTextRange(activeRange);\n  }\n  _getActiveRangeInstance() {\n    return this._rangeList.find((range) => range.isActive());\n  }\n  dispose() {\n    super.dispose(), this._detachEvent(), this._removeAllRanges(), this._container.remove();\n  }\n  _initDOM() {\n    const { unitId } = this._context, container = document.createElement(\"div\");\n    container.style.position = \"fixed\", container.style.left = \"0px\", container.style.top = \"0px\", container.id = `univer-doc-selection-container-${unitId}`;\n    const inputParent = document.createElement(\"div\"), inputDom = document.createElement(\"div\");\n    inputParent.appendChild(inputDom), container.appendChild(inputParent), this._container = container, this._inputParent = inputParent, this._input = inputDom, this._initInput(), this._initInputEvents(), document.body.appendChild(container);\n  }\n  _registerContainer() {\n    this.disposeWithMe(\n      // the content editable div should be regarded as part of the applications container\n      this._layoutService.registerContainerElement(this._container)\n    );\n  }\n  _initInput() {\n    this._inputParent.style.cssText = `\n            position:absolute;\n            height:1px;\n            width:1px;\n            overflow: hidden;\n        `, this._input.contentEditable = \"true\", this._input.classList.add(\"univer-editor\"), this._input.style.cssText = `\n            position: absolute;\n            overflow: hidden;\n            opacity: 1;\n            background: #000;\n            color: transparent;\n            outline: none;\n            z-index: -2;\n            caret-color: transparent;\n            white-space: pre-wrap;\n            user-select: text;\n        `;\n  }\n  _getNodePosition(node) {\n    if (node == null)\n      return;\n    const { node: glyph, ratioX, segmentPage } = node, position = this._docSkeletonManagerService.getSkeleton().findPositionByGlyph(glyph, segmentPage);\n    if (position == null)\n      return;\n    const isBack = ratioX < 0.5;\n    return {\n      ...position,\n      isBack\n    };\n  }\n  _interactTextRanges(textRanges) {\n    const newTextRanges = [];\n    for (const range of this._rangeList) {\n      if (textRanges.some((textRange) => textRange.isIntersection(range))) {\n        range.dispose();\n        continue;\n      }\n      newTextRanges.push(range);\n    }\n    this._rangeList = newTextRanges;\n  }\n  _interactRectRanges(rectRanges) {\n    const newRanges = [];\n    for (const range of this._rectRangeList) {\n      if (rectRanges.some((rectRange) => rectRange.isIntersection(range))) {\n        range.dispose();\n        continue;\n      }\n      newRanges.push(range);\n    }\n    this._rectRangeList = newRanges;\n  }\n  _removeAllRanges() {\n    this._removeAllTextRanges(), this._removeAllRectRanges();\n  }\n  _removeAllCacheRanges() {\n    this._rangeListCache.forEach((range) => {\n      range.dispose();\n    }), this._rectRangeListCache.forEach((range) => {\n      range.dispose();\n    }), this._rangeListCache = [], this._rectRangeListCache = [];\n  }\n  _removeAllTextRanges() {\n    this._rangeList.forEach((range) => {\n      range.dispose();\n    }), this._rangeList = [];\n  }\n  _removeAllRectRanges() {\n    this._rectRangeList.forEach((range) => {\n      range.dispose();\n    }), this._rectRangeList = [];\n  }\n  _deactivateAllTextRanges() {\n    this._rangeList.forEach((range) => {\n      range.deactivate();\n    });\n  }\n  _deactivateAllRectRanges() {\n    this._rectRangeList.forEach((range) => {\n      range.deactivate();\n    });\n  }\n  _addTextRangesToCache(textRanges) {\n    this._rangeListCache.push(...textRanges);\n  }\n  _addTextRange(textRange) {\n    this._deactivateAllTextRanges(), textRange.activate(), this._rangeList.push(textRange);\n  }\n  _addRectRangesToCache(rectRanges) {\n    this._rectRangeListCache.push(...rectRanges);\n  }\n  _addRectRanges(rectRanges) {\n    rectRanges.length !== 0 && (this._deactivateAllRectRanges(), rectRanges[rectRanges.length - 1].activate(), this._rectRangeList.push(...rectRanges));\n  }\n  _createTextRangeByAnchorPosition(position) {\n    this._removeAllRanges();\n    const { scene, mainComponent } = this._context, skeleton = this._docSkeletonManagerService.getSkeleton(), lastRange = new TextRange(scene, mainComponent, skeleton, position, void 0, this._selectionStyle, this._currentSegmentId, this._currentSegmentPage);\n    this._addTextRange(lastRange);\n  }\n  _updateActiveRangePosition(position) {\n    const activeTextRange = this._getActiveRangeInstance();\n    if (activeTextRange == null || activeTextRange.anchorNodePosition == null) {\n      this._logService.error(\n        \"[DocSelectionRenderService] _updateActiveRangeFocusPosition: active range has no anchor\"\n      );\n      return;\n    }\n    this._removeAllRanges(), this._anchorNodePosition = activeTextRange.anchorNodePosition, this._focusNodePosition = position;\n    const { scene, mainComponent } = this._context, skeleton = this._docSkeletonManagerService.getSkeleton(), { _anchorNodePosition, _focusNodePosition, _selectionStyle, _currentSegmentId, _currentSegmentPage } = this;\n    if (_anchorNodePosition == null || _focusNodePosition == null || mainComponent == null)\n      return;\n    const ranges = getRangeListFromSelection(\n      _anchorNodePosition,\n      _focusNodePosition,\n      scene,\n      mainComponent,\n      skeleton,\n      _selectionStyle,\n      _currentSegmentId,\n      _currentSegmentPage\n    );\n    if (ranges == null)\n      return;\n    const { textRanges, rectRanges } = ranges;\n    this._addTextRangesToCache(textRanges), this._addRectRangesToCache(rectRanges), this.deactivate();\n  }\n  _isEmpty() {\n    return this._rangeList.length === 0 && this._rectRangeList.length === 0;\n  }\n  _getCanvasOffset() {\n    var _a28;\n    const engine = (_a28 = this._context.scene) == null ? void 0 : _a28.getEngine();\n    return getCanvasOffsetByEngine(engine);\n  }\n  _updateInputPosition(forceFocus = !1) {\n    const activeRangeInstance = this._getActiveRangeInstance(), anchor = activeRangeInstance == null ? void 0 : activeRangeInstance.getAnchor();\n    if (!anchor || anchor && !anchor.visible || this.activeViewPort == null) {\n      this.focus();\n      return;\n    }\n    const { left, top } = anchor, absoluteCoord = this.activeViewPort.getAbsoluteVector(Vector2.FromArray([left, top])), { x, y } = absoluteCoord;\n    let { left: canvasLeft, top: canvasTop } = this._getCanvasOffset();\n    canvasLeft += x, canvasTop += y, this.activate(canvasLeft, canvasTop, forceFocus);\n  }\n  _moving(moveOffsetX, moveOffsetY) {\n    var _a28, _b;\n    const focusNode = this._findNodeByCoord(moveOffsetX, moveOffsetY, {\n      strict: !0,\n      segmentId: this._currentSegmentId,\n      segmentPage: this._currentSegmentPage\n    }), focusNodePosition = this._getNodePosition(focusNode);\n    if (!focusNodePosition || focusNode == null)\n      return;\n    const divide = focusNode == null ? void 0 : focusNode.node.parent, nextGlyph = divide == null ? void 0 : divide.glyphGroup[divide.glyphGroup.indexOf(focusNode.node) + 1];\n    (focusNode == null ? void 0 : focusNode.node.streamType) === DataStreamTreeTokenType.PARAGRAPH && (nextGlyph == null ? void 0 : nextGlyph.streamType) === DataStreamTreeTokenType.SECTION_BREAK && (focusNodePosition.isBack = !0), this._focusNodePosition = focusNodePosition, this._removeAllCacheRanges();\n    const { _anchorNodePosition, _focusNodePosition, _selectionStyle, _currentSegmentId, _currentSegmentPage } = this, { scene, mainComponent } = this._context, skeleton = this._docSkeletonManagerService.getSkeleton();\n    if (_anchorNodePosition == null || _focusNodePosition == null || mainComponent == null)\n      return;\n    const ranges = getRangeListFromSelection(\n      _anchorNodePosition,\n      _focusNodePosition,\n      scene,\n      mainComponent,\n      skeleton,\n      _selectionStyle,\n      _currentSegmentId,\n      _currentSegmentPage\n    );\n    if (ranges == null)\n      return;\n    const { textRanges, rectRanges } = ranges;\n    this._rangeList.length > 0 && textRanges.length > 0 && this._interactTextRanges(textRanges), this._rectRangeList.length > 0 && rectRanges.length > 0 && this._interactRectRanges(rectRanges), this._addTextRangesToCache(textRanges), this._addRectRangesToCache(rectRanges), this.deactivate(), (_b = (_a28 = this._context.scene) == null ? void 0 : _a28.getEngine()) == null || _b.setRemainCapture();\n  }\n  __attachScrollEvent() {\n    const viewport = this.activeViewPort;\n    if (!viewport)\n      return;\n    const { unitId } = this._context;\n    if (this._viewPortObserverMap.has(unitId))\n      return;\n    const scrollBefore = viewport.onScrollAfter$.subscribeEvent((param) => {\n      if (!param.viewport)\n        return;\n      const activeRangeInstance = this._getActiveRangeInstance();\n      activeRangeInstance == null || activeRangeInstance.activeStatic();\n    }), scrollStop = viewport.onScrollEnd$.subscribeEvent((param) => {\n      const viewport2 = param.viewport;\n      if (!viewport2)\n        return;\n      const bounds = viewport2.getBounding(), activeRangeInstance = this._getActiveRangeInstance(), anchor = activeRangeInstance == null ? void 0 : activeRangeInstance.getAnchor();\n      if (!(!anchor || anchor && !anchor.visible)) {\n        if (bounds) {\n          const { left, top, right, bottom } = bounds.viewBound;\n          if (anchor.left < left || anchor.left > right || anchor.top < top || anchor.top > bottom) {\n            activeRangeInstance == null || activeRangeInstance.deactivateStatic();\n            return;\n          }\n        }\n        this._updateInputPosition();\n      }\n    });\n    this._viewPortObserverMap.set(unitId, {\n      scrollBefore,\n      scrollStop\n    });\n  }\n  // FIXME: listeners here are not correctly disposed\n  // eslint-disable-next-line max-lines-per-function\n  _initInputEvents() {\n    this.disposeWithMe(\n      fromEvent(this._input, \"keydown\").subscribe((e) => {\n        this._isIMEInputApply || this._eventHandle(e, (config) => {\n          this._onKeydown$.next(config);\n        });\n      })\n    ), this.disposeWithMe(\n      fromEvent(this._input, \"input\").subscribe((e) => {\n        if (!(e.inputType === \"historyUndo\" || e.inputType === \"historyRedo\")) {\n          if (this._rectRangeList.length > 0)\n            return e.stopPropagation(), e.preventDefault();\n          this._isIMEInputApply || this._eventHandle(e, (config) => {\n            this._onInputBefore$.next(config), this._onInput$.next(config);\n          });\n        }\n      })\n    ), this.disposeWithMe(\n      fromEvent(this._input, \"compositionstart\").subscribe((e) => {\n        if (this._rectRangeList.length > 0)\n          return e.stopPropagation(), e.preventDefault();\n        this._isIMEInputApply = !0, this._eventHandle(e, (config) => {\n          this._onCompositionstart$.next(config);\n        });\n      })\n    ), this.disposeWithMe(\n      fromEvent(this._input, \"compositionend\").subscribe((e) => {\n        this._isIMEInputApply = !1, this._eventHandle(e, (config) => {\n          this._onCompositionend$.next(config);\n        });\n      })\n    ), this.disposeWithMe(\n      fromEvent(this._input, \"compositionupdate\").subscribe((e) => {\n        this._eventHandle(e, (config) => {\n          this._onInputBefore$.next(config), this._onCompositionupdate$.next(config);\n        });\n      })\n    ), this.disposeWithMe(\n      fromEvent(this._input, \"paste\").subscribe((e) => {\n        this._eventHandle(e, (config) => {\n          this._onPaste$.next(config);\n        });\n      })\n    ), this.disposeWithMe(\n      fromEvent(this._input, \"focus\").subscribe((e) => {\n        this._eventHandle(e, (config) => {\n          this._onFocus$.next(config);\n        });\n      })\n    ), this.disposeWithMe(\n      fromEvent(this._input, \"pointerdown\").subscribe((e) => {\n        this._eventHandle(e, () => {\n          this._onBlur$.next();\n        });\n      })\n    ), this.disposeWithMe(\n      fromEvent(this._input, \"blur\").subscribe((e) => {\n        this._eventHandle(e, (config) => {\n          this._onBlur$.next(config);\n        });\n      })\n    );\n  }\n  _eventHandle(e, func) {\n    const content = this._input.textContent || \"\";\n    this._input.innerHTML = \"\";\n    const activeRange = this._getActiveRange(), rangeList = this._getAllTextRanges();\n    func({\n      event: e,\n      content,\n      activeRange,\n      rangeList\n    });\n  }\n  _getTransformCoordForDocumentOffset(evtOffsetX, evtOffsetY) {\n    const document2 = this._context.mainComponent, { documentTransform } = document2.getOffsetConfig();\n    if (this.activeViewPort == null || documentTransform == null)\n      return;\n    const originCoord = this.activeViewPort.transformVector2SceneCoord(Vector2.FromArray([evtOffsetX, evtOffsetY]));\n    if (originCoord)\n      return documentTransform.clone().invert().applyPoint(originCoord);\n  }\n  _findNodeByCoord(evtOffsetX, evtOffsetY, restrictions) {\n    const coord = this._getTransformCoordForDocumentOffset(evtOffsetX, evtOffsetY);\n    if (coord == null)\n      return;\n    const document2 = this._context.mainComponent, skeleton = this._docSkeletonManagerService.getSkeleton(), {\n      pageLayoutType = PageLayoutType.VERTICAL,\n      pageMarginLeft,\n      pageMarginTop\n    } = document2.getOffsetConfig();\n    return skeleton.findNodeByCoord(\n      coord,\n      pageLayoutType,\n      pageMarginLeft,\n      pageMarginTop,\n      restrictions\n    );\n  }\n  _detachEvent() {\n    this._onInputBefore$.complete(), this._onKeydown$.complete(), this._onInput$.complete(), this._onCompositionstart$.complete(), this._onCompositionupdate$.complete(), this._onCompositionend$.complete(), this._onSelectionStart$.complete(), this._textSelectionInner$.complete(), this._onPaste$.complete(), this._onFocus$.complete(), this._onBlur$.complete(), this._onPointerDown$.complete();\n  }\n}, __name(_a3, \"DocSelectionRenderService\"), _a3);\nDocSelectionRenderService = __decorateClass$o([\n  __decorateParam$o(1, ILayoutService),\n  __decorateParam$o(2, ILogService),\n  __decorateParam$o(3, Inject(DocSkeletonManagerService))\n], DocSelectionRenderService);\nconst COMPONENT_DOC_HEADER_FOOTER_PANEL = \"COMPONENT_DOC_HEADER_FOOTER_PANEL\";\nvar jsxRuntime = { exports: {} }, reactJsxRuntime_production_min = {};\n/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\nvar f = require$$0__default, k = Symbol.for(\"react.element\"), l = Symbol.for(\"react.fragment\"), m = Object.prototype.hasOwnProperty, n = f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner, p = { key: !0, ref: !0, __self: !0, __source: !0 };\nfunction q(c, a, g) {\n  var b, d = {}, e = null, h = null;\n  g !== void 0 && (e = \"\" + g), a.key !== void 0 && (e = \"\" + a.key), a.ref !== void 0 && (h = a.ref);\n  for (b in a) m.call(a, b) && !p.hasOwnProperty(b) && (d[b] = a[b]);\n  if (c && c.defaultProps) for (b in a = c.defaultProps, a) d[b] === void 0 && (d[b] = a[b]);\n  return { $$typeof: k, type: c, key: e, ref: h, props: d, _owner: n.current };\n}\n__name(q, \"q\");\nreactJsxRuntime_production_min.Fragment = l;\nreactJsxRuntime_production_min.jsx = q;\nreactJsxRuntime_production_min.jsxs = q;\njsxRuntime.exports = reactJsxRuntime_production_min;\nvar jsxRuntimeExports = jsxRuntime.exports;\nconst panel = \"univer-panel\", optionsSection = \"univer-options-section\", optionsFormItem = \"univer-options-form-item\", optionsInput = \"univer-options-input\", optionsMarginSetting = \"univer-options-margin-setting\", styles$5 = {\n  panel,\n  optionsSection,\n  optionsFormItem,\n  optionsInput,\n  optionsMarginSetting\n}, DocHeaderFooterOptions = /* @__PURE__ */ __name((props) => {\n  const localeService = useDependency(LocaleService), univerInstanceService = useDependency(IUniverInstanceService), renderManagerService = useDependency(IRenderManagerService), commandService = useDependency(ICommandService), docSelectionManagerService = useDependency(DocSelectionManagerService), { unitId } = props, docSelectionRenderService = renderManagerService.getRenderById(unitId).with(DocSelectionRenderService), [options, setOptions] = useState({}), handleCheckboxChange = /* @__PURE__ */ __name((val, type) => {\n    var _a28;\n    setOptions((prev) => ({\n      ...prev,\n      [type]: val ? BooleanNumber.TRUE : BooleanNumber.FALSE\n    }));\n    const docDataModel = univerInstanceService.getUniverDocInstance(unitId), documentStyle = docDataModel == null ? void 0 : docDataModel.getSnapshot().documentStyle, docSkeletonManagerService = (_a28 = renderManagerService.getRenderById(unitId)) == null ? void 0 : _a28.with(DocSkeletonManagerService), viewModel = docSkeletonManagerService == null ? void 0 : docSkeletonManagerService.getViewModel();\n    if (documentStyle == null || viewModel == null)\n      return;\n    const editArea = viewModel.getEditArea();\n    let needCreateHeaderFooter = !1;\n    const segmentPage = docSelectionRenderService.getSegmentPage();\n    let needChangeSegmentId = !1;\n    if (type === \"useFirstPageHeaderFooter\" && val === !0 && ((editArea === DocumentEditArea.HEADER && !documentStyle.firstPageHeaderId || editArea === DocumentEditArea.FOOTER && !documentStyle.firstPageFooterId) && (needCreateHeaderFooter = !0), needCreateHeaderFooter && segmentPage === 0 && (needChangeSegmentId = !0)), type === \"evenAndOddHeaders\" && val === !0 && ((editArea === DocumentEditArea.HEADER && !documentStyle.evenPageHeaderId || editArea === DocumentEditArea.FOOTER && !documentStyle.evenPageFooterId) && (needCreateHeaderFooter = !0), needCreateHeaderFooter && segmentPage % 2 === 1 && (needChangeSegmentId = !0)), needCreateHeaderFooter) {\n      const segmentId = Tools.generateRandomId(6);\n      needChangeSegmentId && docSelectionRenderService.setSegment(segmentId), commandService.executeCommand(CoreHeaderFooterCommandId, {\n        unitId,\n        segmentId,\n        headerFooterProps: {\n          [type]: val ? BooleanNumber.TRUE : BooleanNumber.FALSE\n        }\n      });\n    } else\n      commandService.executeCommand(CoreHeaderFooterCommandId, {\n        unitId,\n        headerFooterProps: {\n          [type]: val ? BooleanNumber.TRUE : BooleanNumber.FALSE\n        }\n      });\n  }, \"handleCheckboxChange\"), handleMarginChange = /* @__PURE__ */ __name(async (val, type) => {\n    setOptions((prev) => ({\n      ...prev,\n      [type]: val\n    })), await commandService.executeCommand(CoreHeaderFooterCommandId, {\n      unitId,\n      headerFooterProps: {\n        [type]: val\n      }\n    }), docSelectionRenderService.removeAllRanges(), docSelectionRenderService.blur();\n  }, \"handleMarginChange\"), closeHeaderFooter = /* @__PURE__ */ __name(() => {\n    var _a28;\n    const renderObject = renderManagerService.getRenderById(unitId);\n    if (renderObject == null)\n      return;\n    const { scene } = renderObject, transformer = scene.getTransformerByCreate(), docSkeletonManagerService = renderObject.with(DocSkeletonManagerService), skeleton = docSkeletonManagerService == null ? void 0 : docSkeletonManagerService.getSkeleton(), viewModel = docSkeletonManagerService == null ? void 0 : docSkeletonManagerService.getViewModel(), render2 = renderManagerService.getRenderById(unitId);\n    render2 == null || viewModel == null || skeleton == null || (docSelectionManagerService.replaceTextRanges([]), transformer.clearSelectedObjects(), docSelectionRenderService.setSegment(\"\"), docSelectionRenderService.setSegmentPage(-1), viewModel.setEditArea(DocumentEditArea.BODY), skeleton.calculate(), (_a28 = render2.mainComponent) == null || _a28.makeDirty(!0));\n  }, \"closeHeaderFooter\");\n  return useEffect(() => {\n    const docDataModel = univerInstanceService.getUniverDocInstance(unitId), documentStyle = docDataModel == null ? void 0 : docDataModel.getSnapshot().documentStyle;\n    if (documentStyle) {\n      const {\n        marginHeader = 0,\n        marginFooter = 0,\n        useFirstPageHeaderFooter = BooleanNumber.FALSE,\n        evenAndOddHeaders = BooleanNumber.FALSE\n      } = documentStyle;\n      setOptions({\n        marginHeader,\n        marginFooter,\n        useFirstPageHeaderFooter,\n        evenAndOddHeaders\n      });\n    }\n  }, [unitId]), /* @__PURE__ */ jsxRuntimeExports.jsxs(\"div\", { className: styles$5.options, children: [\n    /* @__PURE__ */ jsxRuntimeExports.jsxs(\"div\", { className: styles$5.optionsSection, children: [\n      /* @__PURE__ */ jsxRuntimeExports.jsx(\"div\", { className: styles$5.optionsFormItem, children: /* @__PURE__ */ jsxRuntimeExports.jsx(\n        Checkbox,\n        {\n          checked: options.useFirstPageHeaderFooter === BooleanNumber.TRUE,\n          onChange: /* @__PURE__ */ __name((val) => {\n            handleCheckboxChange(val, \"useFirstPageHeaderFooter\");\n          }, \"onChange\"),\n          children: localeService.t(\"headerFooter.firstPageCheckBox\")\n        }\n      ) }),\n      /* @__PURE__ */ jsxRuntimeExports.jsx(\"div\", { className: styles$5.optionsFormItem, children: /* @__PURE__ */ jsxRuntimeExports.jsx(\n        Checkbox,\n        {\n          checked: options.evenAndOddHeaders === BooleanNumber.TRUE,\n          onChange: /* @__PURE__ */ __name((val) => {\n            handleCheckboxChange(val, \"evenAndOddHeaders\");\n          }, \"onChange\"),\n          children: localeService.t(\"headerFooter.oddEvenCheckBox\")\n        }\n      ) })\n    ] }),\n    /* @__PURE__ */ jsxRuntimeExports.jsxs(\"div\", { className: clsx(styles$5.optionsSection, styles$5.optionsMarginSetting), children: [\n      /* @__PURE__ */ jsxRuntimeExports.jsxs(\"div\", { className: styles$5.optionsMarginItem, children: [\n        /* @__PURE__ */ jsxRuntimeExports.jsx(\"span\", { children: localeService.t(\"headerFooter.headerTopMargin\") }),\n        /* @__PURE__ */ jsxRuntimeExports.jsx(\n          InputNumber,\n          {\n            min: 0,\n            max: 200,\n            precision: 1,\n            value: options.marginHeader,\n            onChange: /* @__PURE__ */ __name((val) => {\n              handleMarginChange(val, \"marginHeader\");\n            }, \"onChange\"),\n            className: styles$5.optionsInput\n          }\n        )\n      ] }),\n      /* @__PURE__ */ jsxRuntimeExports.jsxs(\"div\", { className: styles$5.optionsMarginItem, children: [\n        /* @__PURE__ */ jsxRuntimeExports.jsx(\"span\", { children: localeService.t(\"headerFooter.footerBottomMargin\") }),\n        /* @__PURE__ */ jsxRuntimeExports.jsx(\n          InputNumber,\n          {\n            min: 0,\n            max: 200,\n            precision: 1,\n            value: options.marginFooter,\n            onChange: /* @__PURE__ */ __name((val) => {\n              handleMarginChange(val, \"marginFooter\");\n            }, \"onChange\"),\n            className: styles$5.optionsInput\n          }\n        )\n      ] })\n    ] }),\n    /* @__PURE__ */ jsxRuntimeExports.jsx(\"div\", { className: styles$5.optionsSection, children: /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { onClick: closeHeaderFooter, children: localeService.t(\"headerFooter.closeHeaderFooter\") }) })\n  ] });\n}, \"DocHeaderFooterOptions\"), DocHeaderFooterPanel = /* @__PURE__ */ __name(() => {\n  var _a28;\n  const localeService = useDependency(LocaleService), renderManagerService = useDependency(IRenderManagerService), unitId = useDependency(IUniverInstanceService).getCurrentUniverDocInstance().getUnitId(), viewModel = ((_a28 = renderManagerService.getRenderById(unitId)) == null ? void 0 : _a28.with(DocSkeletonManagerService)).getViewModel(), [isEditHeaderFooter, setIsEditHeaderFooter] = useState(!0);\n  return useEffect(() => {\n    const editArea = viewModel.getEditArea();\n    setIsEditHeaderFooter(editArea !== DocumentEditArea.BODY);\n    const subscription = viewModel.editAreaChange$.subscribe((editArea2) => {\n      editArea2 != null && setIsEditHeaderFooter(editArea2 !== DocumentEditArea.BODY);\n    });\n    return () => {\n      subscription.unsubscribe();\n    };\n  }, []), /* @__PURE__ */ jsxRuntimeExports.jsx(\"div\", { className: styles$5.panel, children: isEditHeaderFooter ? /* @__PURE__ */ jsxRuntimeExports.jsx(DocHeaderFooterOptions, { unitId }) : /* @__PURE__ */ jsxRuntimeExports.jsx(\"div\", { className: styles$5.panelDisableText, children: localeService.t(\"headerFooter.disableText\") }) });\n}, \"DocHeaderFooterPanel\"), COLLAB_CURSOR_LABEL_HEIGHT = 18, COLLAB_CURSOR_LABEL_MAX_WIDTH = 200, COLLAB_CURSOR_LABEL_TEXT_PADDING_LR = 6, COLLAB_CURSOR_LABEL_TEXT_PADDING_TB = 4;\nfunction drawBubble(ctx, props) {\n  let { radius, width, height } = props;\n  radius = radius != null ? radius : 0, width = width != null ? width : 30, height = height != null ? height : 30;\n  let bottomRight = 0;\n  bottomRight = Math.min(radius, width / 2, height / 2), ctx.beginPath(), ctx.moveTo(0, 0), ctx.lineTo(width, 0), ctx.lineTo(width, height - bottomRight), ctx.arc(width - bottomRight, height - bottomRight, bottomRight, 0, Math.PI / 2, !1), ctx.lineTo(0, height), ctx.lineTo(0, 0), ctx.closePath(), props.fill && (ctx.save(), ctx.fillStyle = props.fill, props.fillRule === \"evenodd\" ? ctx.fill(\"evenodd\") : ctx.fill(), ctx.restore());\n}\n__name(drawBubble, \"drawBubble\");\nconst _TextBubbleShape = class _TextBubbleShape extends Shape {\n  constructor(key, props) {\n    super(key, props);\n    __publicField(this, \"color\");\n    __publicField(this, \"text\");\n    this.color = props == null ? void 0 : props.color, this.text = props == null ? void 0 : props.text;\n  }\n  static drawWith(ctx, props) {\n    const { text, color } = props;\n    ctx.save(), ctx.font = \"13px Source Han Sans CN\";\n    const textWidth = ctx.measureText(text).width, realInfoWidth = Math.min(\n      textWidth + 2 * COLLAB_CURSOR_LABEL_TEXT_PADDING_LR,\n      COLLAB_CURSOR_LABEL_MAX_WIDTH\n    );\n    drawBubble(ctx, {\n      height: COLLAB_CURSOR_LABEL_HEIGHT,\n      width: realInfoWidth,\n      radius: 4,\n      fill: color,\n      evented: !1\n    }), ctx.fillStyle = \"rgba(58, 96, 247, 1)\";\n    const offsetX = COLLAB_CURSOR_LABEL_TEXT_PADDING_LR, offsetY = COLLAB_CURSOR_LABEL_HEIGHT - COLLAB_CURSOR_LABEL_TEXT_PADDING_TB, maxTextWidth = COLLAB_CURSOR_LABEL_MAX_WIDTH - 2 * COLLAB_CURSOR_LABEL_TEXT_PADDING_LR;\n    if (textWidth > maxTextWidth) {\n      let truncatedText = \"\", currentWidth = 0;\n      for (const element2 of text) {\n        const charWidth = ctx.measureText(element2).width;\n        if (currentWidth + charWidth <= maxTextWidth - ctx.measureText(\"...\").width)\n          truncatedText += element2, currentWidth += charWidth;\n        else {\n          truncatedText += \"...\";\n          break;\n        }\n      }\n      ctx.fillText(truncatedText, offsetX, offsetY);\n    } else\n      ctx.fillText(text, offsetX, offsetY);\n    ctx.restore();\n  }\n  _draw(ctx) {\n    _TextBubbleShape.drawWith(ctx, this);\n  }\n};\n__name(_TextBubbleShape, \"TextBubbleShape\");\nlet TextBubbleShape = _TextBubbleShape;\nvar __defProp$n = Object.defineProperty, __getOwnPropDesc$n = Object.getOwnPropertyDescriptor, __decorateClass$n = /* @__PURE__ */ __name((decorators, target, key, kind) => {\n  for (var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$n(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)\n    (decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n  return kind && result && __defProp$n(target, key, result), result;\n}, \"__decorateClass$n\"), __decorateParam$n = /* @__PURE__ */ __name((index, decorator) => (target, key) => decorator(target, key, index), \"__decorateParam$n\");\nconst HEADER_FOOTER_STROKE_COLOR = \"rgba(58, 96, 247, 1)\", HEADER_FOOTER_FILL_COLOR = \"rgba(58, 96, 247, 0.08)\";\nvar HeaderFooterType = /* @__PURE__ */ ((HeaderFooterType2) => (HeaderFooterType2[HeaderFooterType2.FIRST_PAGE_HEADER = 0] = \"FIRST_PAGE_HEADER\", HeaderFooterType2[HeaderFooterType2.FIRST_PAGE_FOOTER = 1] = \"FIRST_PAGE_FOOTER\", HeaderFooterType2[HeaderFooterType2.DEFAULT_HEADER = 2] = \"DEFAULT_HEADER\", HeaderFooterType2[HeaderFooterType2.DEFAULT_FOOTER = 3] = \"DEFAULT_FOOTER\", HeaderFooterType2[HeaderFooterType2.EVEN_PAGE_HEADER = 4] = \"EVEN_PAGE_HEADER\", HeaderFooterType2[HeaderFooterType2.EVEN_PAGE_FOOTER = 5] = \"EVEN_PAGE_FOOTER\", HeaderFooterType2))(HeaderFooterType || {});\nfunction checkCreateHeaderFooterType(viewModel, editArea, segmentPage) {\n  const { documentStyle } = viewModel.getDataModel().getSnapshot(), {\n    defaultHeaderId,\n    defaultFooterId,\n    evenPageHeaderId,\n    evenPageFooterId,\n    firstPageHeaderId,\n    firstPageFooterId,\n    evenAndOddHeaders,\n    useFirstPageHeaderFooter\n  } = documentStyle;\n  switch (editArea) {\n    case DocumentEditArea.BODY:\n      return {\n        createType: null,\n        headerFooterId: null\n      };\n    case DocumentEditArea.HEADER:\n      return useFirstPageHeaderFooter === BooleanNumber.TRUE && !firstPageHeaderId ? {\n        createType: 0,\n        headerFooterId: null\n      } : evenAndOddHeaders === BooleanNumber.TRUE && segmentPage % 2 === 0 && !evenPageHeaderId ? {\n        createType: 4,\n        headerFooterId: null\n      } : defaultHeaderId ? {\n        createType: null,\n        headerFooterId: defaultHeaderId\n      } : {\n        createType: 2,\n        headerFooterId: null\n      };\n    case DocumentEditArea.FOOTER:\n      return useFirstPageHeaderFooter === BooleanNumber.TRUE && !firstPageFooterId ? {\n        createType: 1,\n        headerFooterId: null\n      } : evenAndOddHeaders === BooleanNumber.TRUE && segmentPage % 2 === 0 && !evenPageFooterId ? {\n        createType: 5,\n        headerFooterId: null\n      } : defaultFooterId ? {\n        createType: null,\n        headerFooterId: defaultFooterId\n      } : {\n        createType: 3,\n        headerFooterId: null\n      };\n    default:\n      throw new Error(`Invalid editArea: ${editArea}`);\n  }\n}\n__name(checkCreateHeaderFooterType, \"checkCreateHeaderFooterType\");\nvar _a4;\nlet DocHeaderFooterController = (_a4 = class extends Disposable {\n  constructor(_context, _commandService, _editorService, _instanceSrv, _renderManagerService, _docSkeletonManagerService, _docSelectionRenderService, _localeService, _componentManager) {\n    super();\n    __publicField(this, \"_loadedMap\", /* @__PURE__ */ new WeakSet());\n    this._context = _context, this._commandService = _commandService, this._editorService = _editorService, this._instanceSrv = _instanceSrv, this._renderManagerService = _renderManagerService, this._docSkeletonManagerService = _docSkeletonManagerService, this._docSelectionRenderService = _docSelectionRenderService, this._localeService = _localeService, this._componentManager = _componentManager, this._initialize();\n  }\n  _initialize() {\n    this._context.unit.getSnapshot().documentStyle.documentFlavor === DocumentFlavor.TRADITIONAL && (this._init(), this._drawHeaderFooterLabel(), this._initCustomComponents());\n  }\n  _initCustomComponents() {\n    const componentManager = this._componentManager;\n    this.disposeWithMe(componentManager.register(COMPONENT_DOC_HEADER_FOOTER_PANEL, DocHeaderFooterPanel));\n  }\n  _init() {\n    const { unitId } = this._context, docObject = neoGetDocObject(this._context);\n    docObject == null || docObject.document == null || this._loadedMap.has(docObject.document) || (this._initialMain(unitId), this._loadedMap.add(docObject.document));\n  }\n  _initialMain(unitId) {\n    const docObject = neoGetDocObject(this._context), { document: document2 } = docObject;\n    this.disposeWithMe(document2.onDblclick$.subscribeEvent(async (evt) => {\n      if (this._isEditorReadOnly(unitId))\n        return;\n      const { offsetX, offsetY } = evt, {\n        pageLayoutType = PageLayoutType.VERTICAL,\n        pageMarginLeft,\n        pageMarginTop\n      } = document2.getOffsetConfig(), coord = this._getTransformCoordForDocumentOffset(offsetX, offsetY);\n      if (coord == null)\n        return;\n      const viewModel = this._docSkeletonManagerService.getViewModel(), skeleton = this._docSkeletonManagerService.getSkeleton(), preEditArea = viewModel.getEditArea(), { editArea, pageNumber } = skeleton.findEditAreaByCoord(\n        coord,\n        pageLayoutType,\n        pageMarginLeft,\n        pageMarginTop\n      );\n      if (preEditArea === editArea)\n        return;\n      viewModel.setEditArea(editArea);\n      const { createType, headerFooterId } = checkCreateHeaderFooterType(viewModel, editArea, pageNumber);\n      if (editArea === DocumentEditArea.BODY)\n        this._docSelectionRenderService.setSegment(\"\"), this._docSelectionRenderService.setSegmentPage(-1), this._docSelectionRenderService.setCursorManually(offsetX, offsetY);\n      else if (createType != null) {\n        const segmentId = Tools.generateRandomId(6);\n        this._docSelectionRenderService.setSegment(segmentId), this._docSelectionRenderService.setSegmentPage(pageNumber), await this._commandService.executeCommand(CoreHeaderFooterCommand.id, {\n          unitId,\n          createType,\n          segmentId\n        });\n      } else headerFooterId != null && (this._docSelectionRenderService.setSegment(headerFooterId), this._docSelectionRenderService.setSegmentPage(pageNumber), this._docSelectionRenderService.setCursorManually(offsetX, offsetY));\n    }));\n  }\n  _getTransformCoordForDocumentOffset(evtOffsetX, evtOffsetY) {\n    const docObject = neoGetDocObject(this._context), { document: document2, scene } = docObject, { documentTransform } = document2.getOffsetConfig(), activeViewport = scene.getViewports()[0];\n    if (activeViewport == null)\n      return;\n    const originCoord = activeViewport.transformVector2SceneCoord(Vector2.FromArray([evtOffsetX, evtOffsetY]));\n    return documentTransform.clone().invert().applyPoint(originCoord);\n  }\n  // eslint-disable-next-line max-lines-per-function\n  _drawHeaderFooterLabel() {\n    const localeService = this._localeService;\n    this._renderManagerService.currentRender$.subscribe((unitId) => {\n      if (unitId == null)\n        return;\n      const currentRender = this._renderManagerService.getRenderById(unitId);\n      if (this._editorService.isEditor(unitId) || this._instanceSrv.getUniverDocInstance(unitId) == null || currentRender == null)\n        return;\n      const { mainComponent } = currentRender, docsComponent = mainComponent;\n      this.disposeWithMe(\n        toDisposable(\n          // eslint-disable-next-line max-lines-per-function\n          docsComponent.pageRender$.subscribe((config) => {\n            if (this._editorService.isEditor(unitId))\n              return;\n            const isEditBody = this._docSkeletonManagerService.getViewModel().getEditArea() === DocumentEditArea.BODY, { page, pageLeft, pageTop, ctx } = config, { pageWidth, pageHeight, marginTop, marginBottom } = page;\n            if (ctx.save(), ctx.translate(pageLeft - 0.5, pageTop - 0.5), isEditBody ? (Rect.drawWith(ctx, {\n              left: 0,\n              top: 0,\n              width: pageWidth,\n              height: marginTop,\n              fill: \"rgba(255, 255, 255, 0.5)\"\n            }), ctx.save(), ctx.translate(0, pageHeight - marginBottom), Rect.drawWith(ctx, {\n              left: 0,\n              top: 0,\n              width: pageWidth,\n              height: marginBottom,\n              fill: \"rgba(255, 255, 255, 0.5)\"\n            }), ctx.restore()) : (ctx.save(), ctx.translate(0, marginTop), Rect.drawWith(ctx, {\n              left: 0,\n              top: marginTop,\n              width: pageWidth,\n              height: pageHeight - marginTop - marginBottom,\n              fill: \"rgba(255, 255, 255, 0.5)\"\n            }), ctx.restore()), !isEditBody) {\n              const headerPathConfigIPathProps = {\n                dataArray: [{\n                  command: \"M\",\n                  points: [0, marginTop]\n                }, {\n                  command: \"L\",\n                  points: [pageWidth, marginTop]\n                }],\n                strokeWidth: 1,\n                stroke: HEADER_FOOTER_STROKE_COLOR\n              }, footerPathConfigIPathProps = {\n                dataArray: [{\n                  command: \"M\",\n                  points: [0, pageHeight - marginBottom]\n                }, {\n                  command: \"L\",\n                  points: [pageWidth, pageHeight - marginBottom]\n                }],\n                strokeWidth: 1,\n                stroke: HEADER_FOOTER_STROKE_COLOR\n              };\n              Path.drawWith(ctx, headerPathConfigIPathProps), Path.drawWith(ctx, footerPathConfigIPathProps), ctx.translate(0, marginTop + 1), TextBubbleShape.drawWith(ctx, {\n                text: localeService.t(\"headerFooter.header\"),\n                color: HEADER_FOOTER_FILL_COLOR\n              }), ctx.translate(0, pageHeight - marginTop - marginBottom), TextBubbleShape.drawWith(ctx, {\n                text: localeService.t(\"headerFooter.footer\"),\n                color: HEADER_FOOTER_FILL_COLOR\n              });\n            }\n            ctx.restore();\n          })\n        )\n      );\n    });\n  }\n  _isEditorReadOnly(unitId) {\n    const editor = this._editorService.getEditor(unitId);\n    return editor ? editor.isReadOnly() : !1;\n  }\n  _getDocDataModel() {\n    return this._context.unit;\n  }\n}, __name(_a4, \"DocHeaderFooterController\"), _a4);\nDocHeaderFooterController = __decorateClass$n([\n  __decorateParam$n(1, ICommandService),\n  __decorateParam$n(2, IEditorService),\n  __decorateParam$n(3, IUniverInstanceService),\n  __decorateParam$n(4, IRenderManagerService),\n  __decorateParam$n(5, Inject(DocSkeletonManagerService)),\n  __decorateParam$n(6, Inject(DocSelectionRenderService)),\n  __decorateParam$n(7, Inject(LocaleService)),\n  __decorateParam$n(8, Inject(ComponentManager))\n], DocHeaderFooterController);\nconst SidebarDocHeaderFooterPanelOperation = {\n  id: \"sidebar.operation.doc-header-footer-panel\",\n  type: CommandType.OPERATION,\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    const sidebarService = accessor.get(ISidebarService), localeService = accessor.get(LocaleService);\n    switch (params.value) {\n      case \"open\":\n        sidebarService.open({\n          header: { title: localeService.t(\"headerFooter.panel\") },\n          children: { label: COMPONENT_DOC_HEADER_FOOTER_PANEL },\n          onClose: /* @__PURE__ */ __name(() => {\n          }, \"onClose\"),\n          width: 400\n        });\n        break;\n      case \"close\":\n      default:\n        sidebarService.close();\n        break;\n    }\n    return !0;\n  }, \"handler\")\n};\nfunction getEmptyHeaderFooterBody() {\n  return {\n    dataStream: `\\r\n`,\n    textRuns: [{\n      st: 0,\n      ed: 0,\n      ts: {\n        fs: 9\n        // The default header footer text size.\n      }\n    }],\n    customBlocks: [],\n    paragraphs: [\n      {\n        startIndex: 0,\n        paragraphStyle: {\n          spaceAbove: { v: 0 },\n          lineSpacing: 1.5,\n          spaceBelow: { v: 0 }\n        }\n      }\n    ],\n    sectionBreaks: [\n      {\n        startIndex: 1\n      }\n    ]\n  };\n}\n__name(getEmptyHeaderFooterBody, \"getEmptyHeaderFooterBody\");\nfunction createHeaderFooterAction(segmentId, createType, documentStyle, actions) {\n  const jsonX = JSONX.getInstance(), ID_LEN = 6, firstSegmentId = segmentId != null ? segmentId : Tools.generateRandomId(ID_LEN), isHeader = createType === HeaderFooterType.DEFAULT_HEADER || createType === HeaderFooterType.FIRST_PAGE_HEADER || createType === HeaderFooterType.EVEN_PAGE_HEADER, insertAction = jsonX.insertOp([isHeader ? \"headers\" : \"footers\", firstSegmentId], {\n    [isHeader ? \"headerId\" : \"footerId\"]: firstSegmentId,\n    body: getEmptyHeaderFooterBody()\n  });\n  actions.push(insertAction);\n  const secondSegmentId = Tools.generateRandomId(ID_LEN), insertPairAction = jsonX.insertOp([isHeader ? \"footers\" : \"headers\", secondSegmentId], {\n    [isHeader ? \"footerId\" : \"headerId\"]: secondSegmentId,\n    body: getEmptyHeaderFooterBody()\n  });\n  actions.push(insertPairAction);\n  let key = \"defaultHeaderId\", pairKey = \"defaultFooterId\";\n  switch (createType) {\n    case HeaderFooterType.DEFAULT_HEADER:\n      key = \"defaultHeaderId\", pairKey = \"defaultFooterId\";\n      break;\n    case HeaderFooterType.DEFAULT_FOOTER:\n      key = \"defaultFooterId\", pairKey = \"defaultHeaderId\";\n      break;\n    case HeaderFooterType.FIRST_PAGE_HEADER:\n      key = \"firstPageHeaderId\", pairKey = \"firstPageFooterId\";\n      break;\n    case HeaderFooterType.FIRST_PAGE_FOOTER:\n      key = \"firstPageFooterId\", pairKey = \"firstPageHeaderId\";\n      break;\n    case HeaderFooterType.EVEN_PAGE_HEADER:\n      key = \"evenPageHeaderId\", pairKey = \"evenPageFooterId\";\n      break;\n    case HeaderFooterType.EVEN_PAGE_FOOTER:\n      key = \"evenPageFooterId\", pairKey = \"evenPageHeaderId\";\n      break;\n    default:\n      throw new Error(`Unknown header footer type: ${createType}`);\n  }\n  for (const [k2, id] of [[key, firstSegmentId], [pairKey, secondSegmentId]])\n    if (documentStyle[k2] != null) {\n      const replaceAction = jsonX.replaceOp([\"documentStyle\", k2], documentStyle[k2], id);\n      actions.push(replaceAction);\n    } else {\n      const insertAction2 = jsonX.insertOp([\"documentStyle\", k2], id);\n      actions.push(insertAction2);\n    }\n  return actions;\n}\n__name(createHeaderFooterAction, \"createHeaderFooterAction\");\nconst CoreHeaderFooterCommandId = \"doc.command.core-header-footer\", CoreHeaderFooterCommand = {\n  id: CoreHeaderFooterCommandId,\n  type: CommandType.COMMAND,\n  // eslint-disable-next-line max-lines-per-function\n  handler: /* @__PURE__ */ __name(async (accessor, params) => {\n    var _a28;\n    const commandService = accessor.get(ICommandService), univerInstanceService = accessor.get(IUniverInstanceService), renderManagerService = accessor.get(IRenderManagerService), { unitId, segmentId, createType, headerFooterProps } = params, docSkeletonManagerService = (_a28 = renderManagerService.getRenderById(unitId)) == null ? void 0 : _a28.with(DocSkeletonManagerService), docDataModel = univerInstanceService.getUniverDocInstance(unitId), docViewModel = docSkeletonManagerService == null ? void 0 : docSkeletonManagerService.getViewModel();\n    if (docDataModel == null || docViewModel == null)\n      return !1;\n    const editArea = docViewModel.getEditArea(), { documentStyle } = docDataModel.getSnapshot(), isUpdateMargin = (headerFooterProps == null ? void 0 : headerFooterProps.marginFooter) != null || (headerFooterProps == null ? void 0 : headerFooterProps.marginHeader) != null, textRanges = [{\n      startOffset: 0,\n      endOffset: 0,\n      collapsed: !0\n    }], doMutation = {\n      id: RichTextEditingMutation.id,\n      params: {\n        unitId,\n        actions: [],\n        textRanges,\n        debounce: !0\n      }\n    };\n    isUpdateMargin && (doMutation.params.noNeedSetTextRange = !0);\n    const jsonX = JSONX.getInstance(), rawActions = [];\n    return createType != null && createHeaderFooterAction(segmentId, createType, documentStyle, rawActions), headerFooterProps != null && Object.keys(headerFooterProps).forEach((key) => {\n      const value = headerFooterProps[key], oldValue = documentStyle[key];\n      if (value === oldValue)\n        return;\n      let action;\n      if (oldValue === void 0 ? action = jsonX.insertOp([\"documentStyle\", key], value) : action = jsonX.replaceOp([\"documentStyle\", key], oldValue, value), rawActions.push(action), key === \"useFirstPageHeaderFooter\" && value === BooleanNumber.TRUE && !documentStyle.firstPageHeaderId) {\n        const headerFooterType = editArea === DocumentEditArea.HEADER ? HeaderFooterType.FIRST_PAGE_HEADER : HeaderFooterType.FIRST_PAGE_FOOTER;\n        createHeaderFooterAction(segmentId, headerFooterType, documentStyle, rawActions);\n      } else if (key === \"evenAndOddHeaders\" && value === BooleanNumber.TRUE && !documentStyle.evenPageHeaderId) {\n        const headerFooterType = editArea === DocumentEditArea.HEADER ? HeaderFooterType.EVEN_PAGE_HEADER : HeaderFooterType.EVEN_PAGE_FOOTER;\n        createHeaderFooterAction(segmentId, headerFooterType, documentStyle, rawActions);\n      }\n    }), rawActions.length === 0 ? !1 : (doMutation.params.actions = rawActions.reduce((acc, cur) => JSONX.compose(acc, cur), null), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params));\n  }, \"handler\")\n}, OpenHeaderFooterPanelCommand = {\n  id: \"doc.command.open-header-footer-panel\",\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name(async (accessor, _params) => accessor.get(ICommandService).executeCommand(SidebarDocHeaderFooterPanelOperation.id, { value: \"open\" }), \"handler\")\n}, COMPONENT_PREFIX = \"UI_PLUGIN_DOCS\", COLOR_PICKER_COMPONENT = `${COMPONENT_PREFIX}_COLOR_PICKER_COMPONENT`, FONT_FAMILY_COMPONENT = `${COMPONENT_PREFIX}_FONT_FAMILY_COMPONENT`, FONT_FAMILY_ITEM_COMPONENT = `${COMPONENT_PREFIX}_FONT_FAMILY_ITEM_COMPONENT`, FONT_SIZE_COMPONENT = `${COMPONENT_PREFIX}_FONT_SIZE_COMPONENT`, docListTypePicker = \"univer-doc-list-type-picker\", docListTypePickerItem = \"univer-doc-list-type-picker-item\", docListTypePickerItemActive = \"univer-doc-list-type-picker-item-active\", styles$4 = {\n  docListTypePicker,\n  docListTypePickerItem,\n  docListTypePickerItemActive\n}, ListTypePicker = /* @__PURE__ */ __name((props) => {\n  const { value, onChange, options } = props;\n  return /* @__PURE__ */ jsxRuntimeExports.jsx(\"div\", { className: styles$4.docListTypePicker, children: options.map((item) => /* @__PURE__ */ jsxRuntimeExports.jsx(\n    \"img\",\n    {\n      className: styles$4.docListTypePickerItem + (value === item.value ? ` ${styles$4.docListTypePickerItemActive}` : \"\"),\n      onClick: /* @__PURE__ */ __name(() => {\n        onChange(item.value);\n      }, \"onClick\"),\n      src: item.img\n    },\n    item.value\n  )) });\n}, \"ListTypePicker\"), orderListOptions = [\n  {\n    value: PresetListType.ORDER_LIST,\n    img: \"data:image/jpeg;base64,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\"\n  },\n  {\n    value: PresetListType.ORDER_LIST_1,\n    img: \"data:image/jpeg;base64,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\"\n  },\n  {\n    value: PresetListType.ORDER_LIST_2,\n    img: \"data:image/jpeg;base64,/9j/4AAQSkZJRgABAgEA2ADYAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/CABEIAPQA2AMBEQACEQEDEQH/xAAzAAEAAgMBAQEAAAAAAAAAAAAABwoGCAkFBAMBAQADAQEAAAAAAAAAAAAAAAACAwQBBf/aAAwDAQACEAMQAAAAv8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHLPRXpvZCwpjvAAAAAAAAAAAA/ArTbs9mDDoGJGuwAAAAAAABlxsQAAVn92fsLmt3bqn8RjAAAAAAAAB9pk4ABBs4+QbEwkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMB7ytZuotI4NGoNkeXmiqwDjvAAAAAAAAAAGH95Wz3UWfMGiMZc4EbKbIuG8YwQUAAAAAZOTqAAACs/uz9+sd8vx7XB3Ud2Md02x75hggAAAAB6hnQAAANQbYeEbf1z1mnGO5c35pmAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOWd9ewsZbhVS4B7KLAOO/D+84q6qu7WS4AAAAAAAAAcZtNXrHVrPZVP9DPbZ87TrhOPATZTaKwaBj5DoABkJMIAAAABpFbDVmyPXLNbXL3UWN8N/wBZWi3Z7JuHR6Z4pGIAB7RJwAAAABD0uRFLmv8AZGQI9ybiXI91xnyOJc6o57AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIjlzhzrp7P5bdg4SAAAAAAAAAAAHH7TV1Zz21wNuezPh0DCzCwAAAAAAAe0ScACCJxrxbKbJuK+R49EfEfAAAAAAAAyEmEAHFTVTDUudG6bIQlHrJntAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH//xAAqEAABAwQCAAQHAQEAAAAAAAAGAAcIBAUJFwMWChAVYAEgMDg5OkACFP/aAAgBAQABCAD2nkJyfD8IyRvGTCcGMyZrSncnJMHTX/p+FLTfCp/3W/DA/wDezny8zqpqKMVulRSdkIl2QiXZCJdkIl2QiXZCJdkIl2QiXZCJdkIl2QiXZCJdkIl2QiXZCJdkIl2QiQLe7zWFVrp6v5cD/wB7OfJCeROIxtMc3gUOq426jutHzUFfrwPWvA9a8D1rwPWvA9a8D1rwPWvA9a8D1rwPWvA9a8D1rwPWvA9a8D1rwPWvA9W4NG7VWcNfQfK0saWHYkpd02aCwxJjQLyCK5WD3ux0nSb5k28LXYdYj8QeRO3OCEzNxBUyZ3xcgM3dI5coMZOWeQM753SkYdxf5j9vQV1g6+t65mYkZGwzJB4doUD0dsq0DokAEVOVDr9k3Lp5mVxrLUN3KvoNhmC2GYLYZgthmC2GYLYZgthmC2GYLYZgthmC2GYINMiS6kltoK/6Ga78n/h8U+EimHjQLW43kHS1VNW01PWUcOv2TcuiIJJx+E3nEI6E6vNpp75bam11eqB1aoHVqgdWqB1aoHVqgdWqB1aoHVqgdWqB1aoHVZm+s1juVNdKT6EhoPMPJ95Itvs6s58fEaMijdiTYyZGRuxho2PCAwBQpYxtpcPpNoYcLGlE1z5rNpP4t91ZDcucT8ewUSfErx+yu55xQ8ZCVVTz8/BS8HNU1M6vEHxei44gGzjEo9cMBasVupy5sec67Ky0yMD0JI7/AMk6IGxLaSMGVKVgXgJ/EJClHIbY3FCTFvifOdD2NEK4DQxauMClFEpg5mt5a2mkgQAwY2nib4jgTd+RVdqix2GvulJtciW1yJbXIltciW1yJCrg3m+X6gtdX9PJn+N7IIsBP4hIUq13i0Xun5Kuy+Jy+0qGSuVzttmoKu63ji5eLn4uPm4XX/acjMq69Wa2VdsoLkiGz+vWestK1CtQrUK1CtQoebj0G8Ud2+pIZn7bIZgXyYG8xAiAMxDh83UPR/F1i8bjFu2bntu3eRKAQfkRbBpWwM8hUJhXITFg7i4YxZj8PRTjozUcBMmx7BpNkkbzJHzz0xUtrPd+oiv0ae3X2fZpozNMbPk+XB4gqiuo3uYai7KVj5ksuKv7Hr+jLVAx7cgn+IbNgH3W6hzaBlwvV48NzR8F6t2TF3W38i8v6p6ctvLby28tvLby28tvLby28tvLby28tvLby28tvIecf168Udp+WS8lGdiIyZ1IJ+bU1E4s9vPZjqQrRNE2jCNoGM4znkdidxJ/Sv8Ag1QRLVBEtUES1QRLVBEtUES1QRLVBEtUES1QRLVBEtUES1QRLVBEtUES1QRIVb682O/UF0q/kzQY0X3yagrBty1PFETxCvBxcfDwwWaqfjXWlxqed+MeCUo4ZEEqb1JH3N//xAA9EAABBAECAwYDBAoCAQUAAAAEAgMFBgEABwgSExEUlKXU1ZXT5RUhIrcJECAjMDNAWFlgJFZCRGJktbb/2gAIAQEACT8A/wBT2G3h4nuKnfCDlJPZTZba2CU6HN5jz0xLklcbZymLrFcCkXG/tM8CDsBYYvMYSELHIIkRrZByl24dOIeG20jaPVYSqR1R2tkxJbdWDutOqsvX41mUssBHzFSFAjJezzlnkiRI1kz7WfdNLIJ/qR2MGOMNiuF4abwSsZlx11odb+E9VTDTr7zjbWV5bQ486tKcKcXnP+RS5fm1xIfrIfFIb7j03x3XGHkc8iGhfI60pK08yFKQrlVjmSpSc9uM5xqfmvih3z9T818UO+fqfmvih3z9T818UO+fqfmvih3z9T818UO+fqfmvih3z9T818UO+fqfmvih3z9T818UO+fqfmvih3z9T818UO+fqfmvih3z9T818UO+fqfmvih3z9T818UO+fqfmvih3z9S8oUO537qMEHlvsr5I4xaOdp11SFcq0pWnmTnlUlKsdmcYz+1/kUuX5tcSGt0UmcTm38EqfsFIXXLKNHZaHio2dlIyLtpEU3V5adhYWZjJSViApV0tgV8rpIfehp5mK0z1xH+n1Wuo61z9J1Dzf7xlbbqeV1tCvwrx29nZntTnOMxHmEp63UR5hKet1EeYSnrdRHmEp63UR5hKet1EeYSnrdRHmEp63UR5hKet1EeYSnrdRHmEp63UR5hKet1EeYSnrdRHmEp63UR5hKet1EeYSnrdRHmEp63UR5hKet1G9AtjqdJ3vh7vJ1Wlsufu3inGlczTi0/iRns7e3HYrGM4/Z2wrNBte/d0J3E3inIFghk7cG7GSM3LFWSfU+S+h6RfkrJOGLWwhhvL0mTnDeMKThOye38RxF3iCZrVr3eCg2GrhNQ7LAAmWCDe3LTZJIcVFgnyQzDEnJAxwIMgYUIIwy3/tlriqNt1Q4cift9tm3HWoqChxlIS8aYphp9/LaVuNtpQyy68664hpptbi0pztF9o8JHEHxAY2UmuJLeClW2HTu3IRc3SALyPsLF5m60VEiUMC8QCpGfucVIGGS9gDDeqUSxFOOTWtzBaDCzL8gBU4tmLlrBaLtMxozRREJVK9CBmmyJyGyBeu+9gSKjkkskS0lHh5USjYIbh62r2t2gou5+2dJucLNg78sxl4zTZKtSu5hb887X2FW6nW2Ot4dfiq0GuDEmI2PXNTWRHpGQ/pqhXb9Q7SKgCzU23RAU/WbFHoJYL+zpyEkmSI6WjnXxmVER5474ZSEdElh1lS21V+DqlXgOJjdSMgq3WokCCgIWNGt3CagaPiYeLHFjo0EdH4GBAx2WGk/hbbTj7v1bYUPcGxbWSxdg21l7pVYWzmUKwm9xw/YqiuaDNxAWHsjQksTsYkaWFQzlApjKHXkuf268MH5Q8N363ugWx3PpO9Np3k6p4rLn7t5DjSuZpxafxIz2dvbjsVjGcS/l8X6LUv5fF+i1L+XxfotS/l8X6LUv5fF+i1L+XxfotS/l8X6LUv5fF+i1L+XxfotS/l8X6LUv5fF+i1JdcR/vnVa7mA1z9IAp5v8AeMitup5XW0K/CvHb2dme1Oc4z/A/um3b/wD2HCdrd/bzZioS9hj6pF2Tci1xFShz7HKNkvhQ4p0wUKw8YsUM091CFZwLGgnyRamAAiiGSGCwy2GihCxXWyBihiG0usEDvtKW08w80tLjTralNuNqStCspzjOf7deGD8oeG7W8+2sBvvf4UixUnaOXuEIBf7RCjd/6h8JWSTG5M9paYmYcFSwwp01mFmng232oeSWLpb7Y5XR6ix1Noex0H2iEcinW3kY7VspwrmbV2pyrGOzOcKwbNeIB9u0bNeIB9u0bNeIB9u0bNeIB9u0bNeIB9u0bNeIB9u0bNeIB9u0bNeIB9u0bNeIB9u0bNeIB9u0bNeIB9u0TKOEC9bpoIeEWznrsOjr50tBMrz2IeVlPK4nsVhOc9uMZTn+BH2Yu/8AB7dJy+7LkQljJhosGw2E+kSUk5YY1llxqeFUTt9XMsivraS0hotGFZwUrKa5YZ2u0e7CX2tvVa0ydSlwZpgAyJLYUfGqzgiMl4qQLj5ER9lxfTW2UA+DIjCmsxzEPWqpBxNbr0QLlzI0VBwYA8XExw+XluvZYBAFHGay6445ltpPOtau1WQLI1vpxE1Sm0zck8yxEF1oqEokDUq5ANxFdWykeJJbjKVBJKIaecUS82S6rCckKximzhXEVtVBhQtblQ7VKgVclyIZmBoCbnayM4gWUnIAWdOGjSlvNDLZSEmRDkMxoGR/9qt0Vufv0LDypdQ4bdv5kaX3Hmjo+MLlFE20eKZmHNs6WACEXKz9ztgQ4oULHyT8QBPyY7MOTRmttX94IKcmHaOxY121mAVC3Gx1PoN2JyDra5JJOIDB/UVCg5Z733Xke6HeHnmhhhmnHyCH3EMsMMMoy468865lLbTTTaVLccWpKEITlSs4TjOdR8Zxc7kz249RpN/IoN1ZB2u2qGtJ5kewzPboRMDcIOVvrzwBywKFDNEEoFiZx6elIF+PHDkNXapbd0qCYUTNW68WKIqtaiR0pUrL0jOThYMaGjsSrsUQS3hXZnCe3P3a28mLrtjMUS9WdriZlJU6swtklqKJNPyLe3dIkKuo+1UvJ8MVAIup05X0lzQUymNhjYyPEkpb+k2YrY/EZu9wccYExdt3ph6UsluceltgLyGcHWyJ8+RDo8YWAywAdH0oOAHlRWUYmEyDuXHV/wDSLz+cO4umXyK1eqtYabYRxSHAyX4OzxJcJLMjls5w8K+6AcQhohrOHGHFJdRnCk41tBVtpKa5+k74dZCTHg0HHzdkk8bZb/tolrfbp4yWttwlWWV90FkbNNypYQCGY4N0ePHYGa1R07jbcRd2r9/zUn5ufgo+SsNXbkEwuZZ+tycRJHRg7kk8+TEqOQBJZQ2NJsGAKIDfqddotIqv6NmYiKzUalDR9ercBFjy3EH0QIiGihxY+PFbypS8MjDtoy4tbisZWtas/qQy4QL3XpoIS4tnPXMHHXzpacZXnsQ8rKeVxPYrCc57cYynIUL4c73HQUL4c73HQUL4c73HQUL4c73HQUL4c73HQ0Y2OV3rqLHZLQ9joBkEI5FOmvIx2rZThXM2rtTlWMdmc4Vj+H/ZFxXfkPfdf9IvP5w7i6lI6XEaKLBdKizhjx2zQH1inBuPCOutoKDJbcHLHUrDw77a2XkIcSpOP8mHDt+Wm/mpAGJiwGFknyUkWwCAEM1jtcILMKcaHGYbx963XnENox96lYxpxDzLyEOtOtLS40604nC23G3EZylaFpzhSFpzlKk5xnGc4zjOv8dc9/8AbcQWpaMjzpslwOGDOPFELly2WVEOixg77rbx5LQ6FvuMCoddQylTqk4QnKsaI7p3vu//ACOj1+n0CmCf5XVZ5ubo8n8xPLzc339nLmw+U/U9WHyn6nqw+U/U9WHyn6nqw+U/U9TPe+6d4/4/2d0Op1xXxv5vfnuXl63P/LVzcvL93bzY/hzB1dh98dntzNn5WwRjDBUlBRu5lLm6WdMR4xWcCknRgs26aIwTnDDz7Dbb2cNqVq52a2VjbypWmoi3QxAkDajhLVP2SeKOR9lc40bIhOWR9kEgXmyzkUcjsy7zY1uluLumPuhuKq/SUlfMxgjcXkaKHhIsCMhoZpqObOxHDN4n57CUF2EloRTg4IUdHgC7gWTboDabiFofELHSlYjIuULl5mh167V4SvGsyqkssRh7N2KIJKY7SmnQR0tYyhxzV8t+20PdJCqy2LXTcsPHhn1KxR9iAZkYcxxqPsMKSQAls2HOcabUvu54z4siAEUzYLHaq5sxQYGhQ9ithAxFglw4MXDCDJBQbAwbHOrmSKCIw2LGhJGjx8ZZGQrO4dmGu+3mwxuw4W2zUXFLqsjEmlXkpc8VLLV9rtSKFXktCRmk92zgEfOc9rjmt290dvZjhMt7lmh4KklhpjbUwuy1W2d1w+bhT9SllylRjmCrLBoXIFxWUhvNZfj4c2O/127RO3u1+3sSuZtFomVu5YFYy60KGEEGK0RIS81LyBAsVBQUUKZLzkuYFFRQRZ5bDDn6Mf8ASP2LhTSxmVVxEAbMguQjlTHbddkLsJFMTJUQ9UhGR3yvtx25jR6REJWcRHkryIi6i3nbe2ofbFkGxyY+TiJcBSWpitWSGObZkIOxwhKsDyUaY0lWOZkwR0uNMBNJ/qJ3b8Xh6oXFDTd2OK2p3KesEPJ3vbisnxQuYGsBxFYsEdYjM12UvmcQtjMhIp6Yerz6zMKYySCbXqNQKHWyJCSkDHQK/VqjUq1GqfJJIdXkWMhYKDiQ1LWrPdwo8EbP8plrsxELguFzdrjy3EmuG6NbiioWKzVBDpwlwqvgPDhjIh2KvNUCvt9xEaaFMrxsQ9yERTgov6o7v/f+9/8Aq+69Luvdv/jEdTqd4/8AZy8n/lzfhr3m30zVe82+mar3m30zVe82+mar3m30zVe82+mar3m30zVe82+mar3m30zVe82+mar3m30zVe82+mar3m30zVe82+mar3m30zVe82+mahu6d77x/wAj7R6/T6Ar5P8AK7izzc3R5P5ieXm5vv7OXP7FtGpu2u38Zg+YknEKJPPLIeQJEV6vxjecETNksMm8NFQcSN+9MOJawtbA6XyGX7TwTfopZAsKwUfh9r57YXEBxUwQhGDa7Z9yprAxDVep8w62PMBsZT9jfZ+I1dWr9lLzF7ttUyF2+2y2+hWK/T6fX2FsRkNGMLceUhCnnHyzDDC3yZGVlZEkuVmZUs2WljTZI0op79TwTPce/dXvjj7fN3nufT6fRGI7ezu6+fm5OztT2c3bnlNhfEHe3aNhfEHe3aNhfEHe3aNhfEHe3aNhfEHe3aNhfEHe3aNhfEHe3aNhfEHe3aNhfEHe3aNhfEHe3aNhfEHe3aNhfEHe3aNhfEHe3aNhfEHe3aNhfEHe3aNhfEHe3aJjHBxe9dRA7xa3s9cMgdHIl0JlGexbycq5nE9icKzjtzjCc/sb4UbaepbXbgT25V1gr9WpS1Ql3srEZFxO37z8ME08AcNWwy70yYFMtPgmM2TDKhX0Zewn9K/w4sssoQ0001wi7aNtNNNpwhttttG2mEoQhOMJQhOMJSnGMYxjGMY1xS7e8T0tMSNbe23kKDtTXtrW6hHBjS6LKHJj1+u15uZXLkkQz4jxLZKw0gEIbW2khSVcZlt4rWd8NyI+00CNn37S8DRI2PNuBclLoHtM3NphZ+6JskUxN1+sKYrsY1VIxDJszhY2Yv8A2b//xAA6EQEAAQIEAwMICQMFAAAAAAABAgMRABIhMQRBUUBhcRATMjM0YHOyIiOBkaGxwdHwFELxNUNUk8P/2gAIAQIBAT8A906NBqkps406cH6cpO2l9Dm91z9McXSpU40GkNpwZKreXoooth15B+Ha+L9VwfwT5afa+L9VwfwT5aeGjUKRWY/VrYlc6pte4XLXt+Z2qVScyJKSkC0R/tNCx9xhqVGBTZuQbkb6D/OW3vbGMpyIxLyWwHNwcGRpVZVJfWQhn83FHLcUztnezoO3PUtilRqVpZacbpa7sA81f89MV+HhSo05xnnlKbGSJk0uOXS+iWvfXXTbs4sUYqJsjZPB5Y4ZWhxqqrTjddV0qc/ISlESMpBItIFMx0bbnc4q+w8P8SfzVO0cL6jjPhx/KpiMJzbQjKTa9oituunkq+w8P8SfzVMEJsWZGTAbMgco97tzPvOzwqzpxqQja1UIyuX0LmnT0nFGtOhJlBLplbly2/5mFVV1VVeq6uGrOVOFJtkgrHTW6q3ftcRr1I0pURMkm7prra4PRt+3vXR4epWSxlhcvOWkS7bS9szyA522xWp+aqzp3zZU1ta9wdrvXr5KPB1Kgyn9XHKpmPpSt0io5dS691t/IDJtEZLsAr9xifCTp0WrOQSGJ5s1S9vSR0dRtZ08dOyUqtSVTh6bJyRq07R0D0ze27437scZ7TV8T5Y4FikjcRPEbmOEqTq1qsqkmT5ie+x9KGgFgO4DyU6k6Us1OWWVkvYdHfcfvwLLgKqqrXFVuvq93stD19H4tP5zHGe01fE+WPk4D1tT4E/mh5Y/6fU+Mf8An2WEsk4TC7CUZB1yo2/DFWo1akqiAyRtuaAfpjiOIeIlGTGMcsbac+e7y6HLFGs0JSkBLNBhrfQUb6eGKNVo1CoBK19HvLb8nvxUm1JymgMlbGxfBWShKhlLSnnza3vpp0/txR4howqwIxkVCyvLRPtNdn9/d6EJTkQgMpSbAfzbq7Bj+jb5GvQKm2TNrfptv3WxUpzpSYTLSPxOSPMevaeGrQo+dkjnabGmgISeupbW2pyvjVbaqviq/mrjjv8AYjJvUjRCpzb6b998z9t+faacJVJkIF5O36r0Dm4ZUuEuQtV4jZm+hTeZE5p/lPRxKUpyZSWUpN1ef8/DY7TwteFBnKUGTIIiIIc9e/TbpjznB/8AHqf9j++KsqMsvmqcqdr5s0mV9rbra2uK9WnVKeSkU8sbKW1200tcLaLrry95/wD/xAA5EQACAQEFBQQIBAcBAAAAAAABAhEDABIhMUFAUXGRsRBhcoETIjIzNGCh8ARCwdFDUlOSwtLh8f/aAAgBAwEBPwD5TeoEIUAsxyUfqdPrai7sagc4q0QIgZyBy79ro+3W8Z6ttdH263jPVrX1LFJ9Yaf9y++O1BVUkgQWMnvNrq3r0C8cJ1+bSQASTAGZsa0ugUeqzReIOOU3eE68t9mdUEsY3bzwFqdVndlK3QACAc9M+IM5bOQCIIBG44i1UAPQAwF44DivYQDBIBjKRMcN1l+IqeFei7RV95Q8R6rYsFEsQBliY7F+IqeFei2vKCFkScQJxPls7IGKsZlDI+mfKzorgBtDOGFgIEDIYWCAOXxlgAd2EftY01LhyPWHLunh81vVVBiZbRRn57h3n62Rr6hoidM9Y7HrqpAHrGRMHAeeOPd2EgCSQBvOAstYNUCKJEH1uG4ajDP7OyOihajAesVaTnod+Xlaj7pOB6mxEgg5ERztWVURQoAHpB0bM5nz7GVXEMJEzH/liAPxCACB6PIZfm2Wp7t/A3Q2o+6Tgep7PxHsL4x0btPxCeA/5bKwvKV3gjmIsi3VCzMAics7U6YpggEmTOP3zOtqiekAExDBuU/vZ0DqVJInUd3WyrdULnAjGxSagqTkt2Of72emHKkki6dNdfI4Zj5eJCgkmAMzb0+op1Cv80fXdHnZWDgMpkH7g7TUQvdAi6GBYGcQN2HH6WwA3AcgBah/EI9kubvDH9I+xtLMFBY5C0PWxaUp6L+Zt092vSfasAFAAEAZDaatNqgUAgAEkzqdOWPO12v/AFF/tH+tkDib7BsogRG/QWpoyXrzlpMjPDPHE5nXh8z/AP/Z\"\n  },\n  {\n    value: PresetListType.ORDER_LIST_3,\n    img: \"data:image/jpeg;base64,/9j/4AAQSkZJRgABAgEA2ADYAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/CABEIAPQA2AMBEQACEQEDEQH/xAAzAAEAAgMBAQEAAAAAAAAAAAAABwkGCAoFBAMBAQADAQEAAAAAAAAAAAAAAAACAwQBBf/aAAwDAQACEAMQAAAA7+AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcdPpZewDzdXrAAAAAAAAAAAA1LsjURpqk6Pb3clw8g1gAAAAAAABlxsQADmI355/r7oddHoOx3bt1T/ExEAAAAAAAH2mTgAgicZ3hKBpx842KhIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAa6zjSzqqkyPb5MlwxggoAAAAAycnUAAAAqZ0V6sWQ0Nuh1H+fpnCPfMMEAAAAAPUM6AAAAIllyoHTVYTTPHOt8qZgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACqfRXaxnsAAAAAAAAAAAAFOGmq4/NaMfIdAAMhJhAAAAAAAAObrbR0YYr/VPFIxAAPaJOAAAAAAAANAboRZLlqOewAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACte+vR26G9tM7HaLAAAAAAAAAAABzG7895GS6h7XT1F4NA+IiQAAAAAAAHtEnAA5evQz2c551N6K+rDz9I88g0AAAAAAAGQkwgApz01QxOORc7NsJWyZ7AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB//8QAKRAAAAYCAQMEAwADAAAAAAAAAAUGBwgXBAkDAgoWEBUgQAEwYBk6cP/aAAgBAQABCAD+Unrt9m238+XqcOOpAfE6pIiVTp77E7JREEL4hP8AyZP9X+t/GVOmFbtQ+nb3yGVbkwkzo2O16KDl5OEhO+bh8kUQ8kUQ8kUQ8kUQ8kUQ8kUQ8kUQ8kUQ8kUQ8kUQ8kUQ8kUQ8kUQ8kUQ8kUQ8kUQQp2c5iqK8fL+G8fPM5tSwgRp0ReL288e8LGx8LCYllCnSbuva5pSjk2JxG4ps8GvTqGTj8OZj5GJkV4jxXiPFeI8V4jxXiPFeI8V4jxXiPFeI8V4jxXiPFeI8V4jxXiPFeI8V4jwXI1NlWZw5+B8C2MTBFEgD+VBeHtjAwMj8lu857+uI8aOSRvFLrk/4RLZdvi2kb3cWsaWz1Rz8fVtyN3Zc6f5TycNnrnFrwmD6LIxzCpNmWfgWGsBYawFhrAWGsBYawFhrAWGsBYawFhrAWGsBYawCNWSkNVIW4Gf+ndlNdzoEa/HOfJl210lsYu2qTjszH7fvoYPh2dbW8OLreSXj47TjOe0TYg5Kcc8Lckry6oToqhOiqE6KoToqhOiqE6KoToqhOiqE6KoToqhOgmb4mIzLGNMT9L6sW1El2lXDGPgi+3yh6lsAuRR8wkBI0RlfN45AsrG/WxEuKEhpBSfZX+wU+zrJTu09D6z+j7Stmu+RPvBbCB2F6Ko2yCMhzzTEtdRC11ELXUQtdRC11EEq4JyeH2AV5f0XB/2jWMGSekmEaFhHmBQk/vxPmFIqEVCKhFQioQnm49hOMM2+keQCSB5seRuxzlkPqma+RGwiNOww7/ndjGzto9a5Wy2e6HF3AqX/PLx/jmgttSiRsGz1kkmY+x3CxwUJ5+tLB+f8s64RcHHyc3Mh1CiZvdw21knYZehlme3l2fni3hbwt4W8LeFvC3hbwt4W8LeFvC3hbwt4W8E84/vxxhlPx7jFHplwnh03IFa/wCErVEH7agg027ItauLB30N8TkzyozweGqFEKoUQqhRCqFEKoUQqhRCqFEKoUQqhRCqFEKoUQqhRCqFEKoUQqhRCqFEEq3xyRn2AaZfw2065XqntlxEVLD9UXe4M6unq6fxGLT24BTKhLzh2Cv9BCTzqbKoyTDQ/wDTf//EADkQAAAGAAMGBAMHBAIDAAAAAAECAwQFBgAHEggRE5Sl1RSV1OUJFdMQICEiM0BgFhcjJDAxWXC2/9oACAEBAAk/AP4pPKrfDz+Hdmjs5ZObXtfaVOtv0LvYMwbbMRmYR/nstWZO2xknGzISmWyKtfmIiMj5es198q3eHsLYszINpeAscTGz0HKszio0k4eXZoyEZINTiBRO2esnCDlA4gAmSVKO4N+79yqxD+1WXU3MVtjIKlSbT1+fplhMuqwYTHIYf6lvMnX4Q3DEyhE3x1SkPwxKJSyGaXxGahmJnrm9Zp5kZeXZ27PCKLIZYWJ4DxmRynO0yJbUe7+HWZ6Ym+DMLtkFBEVXBjs8+NgrMmzbK+ZEI9VVNKs4imPHKVAcOEXCp3SbFlDIPaExVWRaFXWy/kOE2IVId/2KHSWSiJJVJVI5k1E1E2axiKJnKIGIchgAxDlEDFMACAgIYn5rzR99fE/NeaPvr4n5rzR99fE/NeaPvr4n5rzR99fE/NeaPvr4n5rzR99fE/NeaPvr4n5rzR99fE/NeaPvr4n5rzR99fE/NeaPvr4n5rzR99fE/NeaPvr4n5rzR99fE/NeaPvr4l5R03U8dxEHD92uifRHPDk1pKqmIbScpTl1FHSYpTBuEAH7s7Lx0VnPeU9oTahkawuqnLVzJaipzhItFZb5bIxKKsgwh8xpuKQnCLMULjA5dun0csm+jTqbcHxRWjNogk1aNGu1uzbtmrZumVJBu3QSyxIkigikQiaSSZCppplKQhSlKABmDmjdNmL4m+VTqoEu+ddqaWe0qbStXsLt7Cf1BZo+s19OyTrifkIurwoqNvGCpnwJ5JdczNNwOaJR2q3FbGyJ5fp1uyrMygWmLZkDBL2lKKPXGtk/tyge9BFOZJExq6ZFYqovHDdkrgnEbukVW66eoxNaK6ZklSayGKcuohjF1EMUxd+8pgEAHER1CU9biI6hKetxEdQlPW4iOoSnrcRHUJT1uIjqEp63ER1CU9biI6hKetxEdQlPW4iOoSnrcRHUJT1uIjqEp63ER1CU9biI6hKetxEdQlPW4iOoSnrcRvAdocThK+Mfq6OKkdFT/Gs6USNqSUOX8xB3b94bjAAh9zK2robQ9oqCNCnM2RQcr2t5Tm5IUiNfK4cOVWrOPKSuw5dDFq2OYGptahvFPPEYytrOYr/KS2oXvLORnEnZZKj3Bqo0Wb2GuyMe7ZPY6RSWYMVyqorgHHZM1xKKrVA6eSlBPtLIV0aojnKeFSNdEYQYpSAFFJ8JhRTfDXlla2MyRuE0NbVUrwyHyU5mI/8AojKv+9efcPVjkypy0O/jo5pYLjKv2UNGOJRzKy0CzNCV00ie0TzMZqLdSUNCv45g+bP3TZUvxbtu/K/aTvMAwtUrlzs55gsMqsmMop+WaN36FHe0KomRr90/pM5koueWiXFbj5Z62fItXTxsp85kcxCZ3Zs7D90qTen58mhmcHM5nZUXdpIKV1a3x8cUWxLHGx7GClVH7p1JTL8lrWYTEtMv6+vOy32LcB2h4PhK8NJXRxX7VFT/ABrEUSNqSUOX8xB3b94bjAAhL9Pi/RYl+nxfosS/T4v0WJfp8X6LEv0+L9FiX6fF+ixL9Pi/RYl+nxfosS/T4v0WJfp8X6LEv0+L9FiS47RfxnFS8GwS18Jg6WT/AMiLVNUulVMhvynDfu3DvKIgP/C0Zjmm9naflxS7BJxyUxGUiSu8oZm5ujuJcpLMJFzCxLWR+QtpUikOa0OYM8uzlo4jmGkdsLa72nMx7LTo2/3nNKY2pbhUss2KkpDJT0q7y9iapJRkVW8umbdZReK8ZMSzZGKJ4tF40jzIsmlkn7hkHFwmUkNlta7LZZm5SdkiISTl4l5Np2qwLOJewQ8lNMpN3W5V0sqV5XVYpVscWhkMZzZcX3M/JaQJFZrUSq2uImbNQpIzpzHqMrJFsnKrlg5ZybN3EySRyiaKmGy8TJA1kkjtQwddNu64PEO3MmRYOAuk4JoMqmsQN50SgbUmbeUTAG4RAwPZrmGPbsPZrmGPbsPZrmGPbsPZrmGPbsPZrmGPbsPZrmGPbsPZrmGPbsPZrmGPbsPZrmGPbsPZrmGPbsPZrmGPbsOZRRw143DI4WaHRHjoKtz6ypMkTjuIsYS6VC7jAUR3gAlH/hpcVmBlbmLDmhLXVpcFit3rYHCD1m7au2ird/FTEPJtWUxAzkW6Zy0HNMGEvFPGkgzbOE889u3M/IeLVRM12X8wtqaxK7PIN2yoLNY5WjU+Cpz5aMbqAIlYqWAyKxTHTdAukochqavSbjnfVstaVa4KJeJs6BE1fKWtRtSpENTKWyaNYqqsYuDiWLUW8eUEVOEJgTJq3BRpWvZr7Sj58+zDfvLTNS8M1NNWJW4WZrVIR84UaQLGzW06dglGhfEpN3bVoygwh4ZAsZ/Mdl/NWSQt+XC18W2iEXgJVCN01OYtia7et/IFiSNGRGHVqMreFbfGKx9+ONYRrD/QR+t+6f1suz9ati6Qzwl45Sut1LSe+N7RmHEpuELMKwOUIwGdbjCjGlRFMVCrH171hAPsIio4a+F4ZHBVDojx3jdufWVJRE47iLGEulQu4wFEd4AJRZQvLvu44ZQvLvu44ZQvLvu44ZQvLvu44ZQvLvu44bRibd14riHbouyLBwGbhwTQZV6sQN50SgbUmbeUTAG4RAwfsf8Axny//wB3nDiYimk3NEeKw8O5kGiEpLJRyRVpBSMj1ViO35GCJyqvDtUVStUjFUXEhBAfsceE8X4f/Y4PH4fAdIOf0uKjq1cHR+oXTq1fju0jYek+54sPSfc8WHpPueLD0n3PFh6T7niZ8X4TxH+v8u4HE47Vdt+r45bTp42v9M2rTp/DfqD9jmBZELrTdnp1s9tst04yLNVnsM6mrVNGsK8qY3zZOTIranCINUy+FFNoiYR1HPjNnNWs3zZwiYSIj6BBPY49OsyFVm7PYoAp13jdSUrzZzI26Xb3BhGqrMbVEcFlwIlyrJyEl/HcsM6c1X+fFylaJRa5klX6zZLE4sUY3iVk2KkXYbbVlnbmWWmWTCHZw/zN89fHFuVsQ5keL8L34taaIqEBVRLZRjllSJCYAUOmkfMNAqqhS7xImZZEpzABRVTAROE7cqnm7lykd1fsiM5Kktl9m9VI9N8SLVk3lfO9lomUj2cmojGy69bn5sa8/dRzSxEiV5eII+/cSkdBwMH8QOnzE3NzD5tGREPERlyyieyUpKST1VBnHx0ezQWdvnztZFs0bIqrrqppJnOG2PsqoookOqqqrtC5RpppJplE6iiih7eBSEIUBMc5hApSgIiIAAjhUt1yM2YdmW5UTah2iaSzcq5SZl3eegMxK/T8uoq+MShWL9NQx7zRpls8j3skZ9HU96DM7mLprZ4h9ifG8CydPOFr4fF8Mgotw+JpPo16NOvQfTv36Tbtw17q3tmK91b2zFe6t7ZivdW9sxXure2Yr3VvbMV7q3tmK91b2zFe6t7ZivdW9sxXure2Yr3VvbMV7q3tmK91b2zFe6t7ZivdW9sxDeE8X4j/AGPmPH4fAaruf0vAo6tXB0fqF06tX47tI/chmdjpt428K9T7bXpEpzx89WbNaMp4WehnxEzpqHZykU9dsXJSKEOZBc4FOURAwbDOSHlUz3rEncKHkDt5Z0SeQueuyateLXasqV3D6w5YVlpmxT61aZSedwE/XlMxgnpaVYPEflxYBlFtFGleslijHf2GIVZ7HvWiRlRMCZVHLZREhlBKU5gIBjgJxKQ5gLvECmH8BewvMPu3YewvMPu3YewvMPu3YewvMPu3YewvMPu3YewvMPu3YewvMPu3YewvMPu3YewvMPu3YewvMPu3YewvMPu3YewvMPu3YewvMPu3YewvMPu3YewvMPu3YewvMPu3Ycxijdr4riEbrOzrDx2bhuTQVVkiQdx1iibUoXcUDCG8QAo/czko2TF+2Us5nGdEBOXqsSVrj3NiZK1eRq50otkB2zgsXNVlu8dtZJJZm9QMDdRI6ZlCj8UDZbIJiiAHLsn1cTEEQ3AYoHqZyCYv/YayGLvD8xTBvAdsO37ce0Tly3cp5PRrqmRWXGT2UTx6m5RcStaokW9fRSkm2BfxcMaIi6hEx0uJp51CytgbxMvF7ZV0y72fMnqynF3/AGb2UjZyRFukWi9nXfFZQ7CRbU2Rjr+2l4SJtrizRziXjG1fReRTl8sSHbwf8m//xAA9EQACAQIEAwQFBw0BAAAAAAABAhEDIQAEEjETQVEyQGFxFGCRodEiI1OBk8HhEDRCQ1RkcHJzgpKxsvD/2gAIAQIBAT8A9VKOWpNRVXHz1dXamZNgoBGxiCIN5ME9DBEEg7ix7zSpmrUSmP0mAPgN2P1CTjMV4zQZOzRKooG0IflDyJkeIjGcQLV1r2Kyiop5Se177/3d5ynzVOtmSBKjRTnYsY+Ki3InHpjn9Vl/svxw7elZVmhQ9BphBA0EXgSYEXP8mOBU4XG0/NzEyOumYmY1W8+8cRygp6joBkLym9/efyLUdNQRioYQ0cx0PtxxH0cPUdEzpm07/wC7xtN9/wCBNMIzqHbQhPymiYG/tOw6TOGzFFGK08tSZAYDONTMBz1G4nlvHuGZpoFpVqa6FqgykyFYbx4bjoI2Ex3nK0lrVlRuzBYgWJjlPjzi8THXDZpwxWlTp0wCQFFMFt4hiQZPWwvjOa+Bl+IAHltQAAgwLQLAxv44KOqqzKwVuySCAfI8+8I7U2DodLLcEf8AvaMHOVTcLSV/pFpjX5ySb/Vh6zuioxkIWI6ksZJJ3Mk4evUqIlNzKp2bAcoE9YFh8fXEUJy5r8RbNGjmbgbzY3mI7N572KSHKtWvrFXQL2iFO3W/e1/MH/rj/lcfd3oViKBoQIL69XOYAjpywmYZKL0QqkPNzuJAB89hHQ9fV6hQavrhlUIJYsSBF+gO0GZx6H+8Zf7T8MVcvUowWgq2zqdSnwm1/MX5bHvOSEpmgLk0iABzs2ODV+iqf4N8MEGlkmp1bPUcNTQ9pQCpJK7rsd+vU95yRIXMkGCKUg9CAxBx6VmPpX9v4YRjmaFfiwXorrSpADbMdJIAkHTAH3gd5y1daPEDqWFRdJAMWvPuOOJk/wBnqfaH44fMg0zSo0hSRu1cszebWMdZm1pi2Eq01oVKZpBnY2qWkC3M3Ecote/j6zf/xAA5EQACAQEEBAwCCwEAAAAAAAABAhEDABIhMUBBYYETIlFSYHGRkqGx0fAjMhA0QlNjcHJzwdLh8f/aAAgBAwEBPwDoo9Vw5K/IhUNtnPVOzcOW2eOku1xWbkHjq8bU6fwiDm4JO/LswPXagxKXTmhKndl6btJrcdkpA5mWjkHsnrjZbgF59Tvf5ZRwNUCSVqCJPOnxP9rX1v3J40TG6e2MdIurevRxoidn0MqtEiYMjYbXVvXoF7ljH3GHVh+RLEhSVEtGA2+8bCm5EtVcMcYUwBsgZ7otSZrz02MlDgeUbfDbjpNVyiEjPADZOv3rsKKkS7MxIkm9hu2WoxwtS6ZWMDvFgykkAgkZgHLSCAwIIkHMWFBMpcjmluL2CPOwRVYsBBIA2ACAIG6y01VmYCC2fnhv6Y8J8QU7pxE3tWU9mqZzwjSy7CsqfZKTvx17tLP1hf2/7aWUmoKk5Ldjtx8bNTDOryZXVqw8s8eXo9UqCnEgm8YEW4b8Op3bJUV5AkEZgiD78tek1vmo/r/lbX05694ethD1wy4hVIZhkTBETkcx2bNJrgFqQOReD1ErbgaXMHj62YcFUp3JAc3WWSRmBOOvHw5J0mrTZ7pUgFTOO70tdr/eL3f8stI3r7tfYZYQBu8sosyMaisHIUDFfeGOuf8AnSb/2Q==\"\n  },\n  {\n    value: PresetListType.ORDER_LIST_4,\n    img: \"data:image/jpeg;base64,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\"\n  },\n  {\n    value: PresetListType.ORDER_LIST_5,\n    img: \"data:image/jpeg;base64,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\"\n  }\n], OrderListTypePicker = /* @__PURE__ */ __name((props) => /* @__PURE__ */ jsxRuntimeExports.jsx(\n  ListTypePicker,\n  {\n    ...props,\n    options: orderListOptions\n  }\n), \"OrderListTypePicker\"), bulletOptions = [\n  {\n    value: PresetListType.BULLET_LIST,\n    img: \"data:image/jpeg;base64,/9j/4AAQSkZJRgABAgEA2ADYAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/CABEIAPQA2AMBEQACEQEDEQH/xAA1AAEAAQUBAQEAAAAAAAAAAAAACAYHCQoLBQEEAQEAAwEBAQAAAAAAAAAAAAAAAgMEBQEG/9oADAMBAAIQAxAAAADf4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABqsdDPqc9DNtjc/TtT8/QAAAAAAAAAAAOK79Ryrce+XH897UXy/VAiSAAAAAAAVcSIAAOYl3efgD2U5/cd3Ts4XQAosAAAAAAA/aVOAAeUY+bq8gtVnreAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDeun4ZAaZzkqmAAAAAAAAAABi10VyprlKGuWA/XTnwyXCmCxQAAAABU5fUAAAEVrIwCthloz2YMNdOwbjvHmFCAAAAAHqFdAAAAEMLYQithmby3eiAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAClvfNZDfQMkdE8uua0AAAAAAAAAACyM48YT6bljcG5unfj5G0U+WdAAKhLwgAAAAAAsjOPGE+m5Y3Bubp34+RtHilsQAD2i5wAAAAAAPD9YYdNQmDXKfNMwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIY2w199lOwVjumZVMAAAAAAAAAAAchX6PmQAuhP6mfXr+c6YFlwAAAAAAD2i5wABxwfpeXFSyMra5djz5rqAR9AAAAAAAKhLwgAGKnRXrRbs+y3h0ZWM9gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//xAAnEAABBAIBAwMFAQAAAAAAAAAGAAUIFwcJBAEQFgMKYBogMDhAFf/aAAgBAQABCAD4pu19wryoQHzpFCI3TfZtz6FfpGPTSb7hn15vHrPFGXf9GYsiFmXstZOyqeLDuQyzEeW8XZVAu/khEvJCJeSES8kIl5IRLyQiXkhEvJCJeSES8kIl5IRLyQiXkhEvJCJeSESBXt55hU18fl/bvp1TZQhBKPJObQ9aFNU2TJvyixzms1714HqvA9V4HqvA9V4HqvA9V4HqvA9V4HqvA9V4HqvA9V4HqvA9V4HpuDRtq5no8/gfa+MTITs7mOkvXUJq/wCpX6pp1YWBiFmdvHhj5aX7LZby9yqe4W1Eunre4XwP6XJyDzIHz3xLPbGxEVg38+67OJfHTVnMjKYFCuO4TFCKWBY/ACyyy8CN2/8AiEZgHYyceY1Dblz+BYZgrDMFYZgrDMFYZgrDMFYZgrDMFYZgrDMFYZgg0yJHUkbeBz/wThjGzzLiPIGMLzqr2ENGRAplhNKjJ2VcZ4VCnnI+XoWvjtsz2Ov+zBv7PLTx3xt5LXy6oHVVA6qoHVVA6qoHVVA6qoHVVA6qoHVVA6qoHUzY+ZmNy4zpxPwy515w2nS0t7dKAH9vvrKFSRnJilnZ2geam1iYPlxyXNuPwkxPHn6uXW8vq5dby1vboYubQzbJIHgH+eTP63yC7+z8/ZCYfcqduQxsPPdOJa5ErXIla5ErXIla5EhXILy+P3Aa+X+aTP63yC7+z8/ZCYfchZ/95n5jSqhVQqoVUKqFD2OP8F44bt+cmHGUxGyARI/pyNMy+nI0zKH2sCDMCCQxLom/H5qbAIp6/cf8PIUnunu9IZeV+lwesLZ/xS2A4+5GQ4w/0bPJqGM9ppZoz2RLWLNI0gZNLCmeRrvbyt5W8reVvK3lbyt5W8reVvK3lbyt5W8h7I/+88cNp+6cEYS+GssM7RuM1B6LphM6WGDI2BneqCJVQRKqCJVQRKqCJVQRKqCJVQRKqCJVQRKqCJVQRKqCJVQRKqCJCuPnljfuA6cv7dlun6KOztga+Rlrr7PDKPlfq8bprR0/RT1iMDvyMT/Jv//EADsQAAEEAQIDBgMDCwUBAAAAAAQCAwUGAQAHEhOlCBEUlNTVldPlEBUjFyAhIiQwM0BXYLYJFpeo19j/2gAIAQEACT8A/tSEq9w7QsKGA/uduPbGlTVL2jIlBg5OPqsXXhnx0Wy+Pw5TR8qqRNYgKiguOELCsUuRKRlf7al++8misFpjs1bbDNUyrDqneQ7S80bNTeF/WyjIz0M43lrhRnGcJT3QlUpXaEmAH/yZbk1RtcJS94DYoMgyQrUvXjCiW6luG5GiOSkdiKNcrVvdakwYuLq0ixDQs7/MEkmXbcncC4Xu2klvqJJdsdrsEhOTOXX14wpxSTzn0YzwpxhKcYShCcYTjT5I14203Dpd+p5AbSnymrPULHG2CBWOwj9Yh3EpHi8A+O/n57mu7PH3fmT818UO+fqfmvih3z9T818UO+fqfmvih3z9T818UO+fqfmvih3z9T818UO+fqfmvih3z9T818UO+fqfmvih3z9T818UO+fqfmvih3z9T818UO+fqfmvih3z9T818UO+fqXlCh3PHcxgg8t9lfBHGLRxtOuqQrhWlK08Sc8KkpVjuzjGfzqdKy/ZM30u85fqXdYSKcdr221hucs7MTW01qWC24PV1w03JEi0FySUwLZqr93NxxZs1FWMON1S5aL7JOx1yib1dbpMx5AkDuRY6jIplIHaqpvkoabszspPx4jV8ci1ujVurIkWZE0Calq6JI/bEdQlPW6iOoSnrdRHUJT1uojqEp63UR1CU9bqI6hKet1EdQlPW6iOoSnrdRHUJT1uojqEp63UR1CU9bqI6hKet1EdQlPW6iOoSnrdRHUJT1uo3kFsczlO+MPd4Oa0tlz8N4pxpXE04tP6yM93f347lYxnH5sPFWGvzYJMZMwU5HiS0PLxpjSmC4+TjD2SAjwSmVrZJEKYdYfaUpt1tSFZxnsI9mf77dKyaprG19fxXcEZdS9xNU3A2KeyjmJxnDDME2xjHEnDeEqUnMLE1yAiBkBxUHAxocRDxgjec5QLHxkeyOEEMjKs5QwMw00nOc9ycd+f7u2M223Iqm1tiNo26Hbf7Rs3MwnZngbuCkZyQrm3ETU1/wC8N1ioptx1g2XrzZoYxbkfIJhZCqSMTYJd7sCdtetRrTkhYNlqiBuJsnudIhDcRZEdtjapMVup4lnWGlCCP3FcrxLdaQzCyBK8ZTEWnbzcbbOzEUDfbYjccD7m3P2V3DBcKYKrVtis8OViluAHOQM4whsaVYENGIHjJ6JnoKI/lzDI22C7cRNGiJWOVluRhlbwX2o7PmTccQlaHAz4WPvZcoEewtJMeUI0aNnBA7eowOMgdt9tazEkrDaU199WYmPak7lajON15a5O22w2ZskmvLq0eNk3ks4bHS00jWGoxv8A1FuzZ2g9qt8IEdxxsGasPZmqQW6NN3GLBbThh20fc8XE0keTeypbUDHnjMYZcPPUd9j3ILY8HyneW07wc08Vlz8N5DjSuJpxaf1kZ7u/vx3KxjOJfp8X6LUv0+L9FqX6fF+i1L9Pi/Ral+nxfotS/T4v0Wpfp8X6LUv0+L9FqX6fF+i1L9Pi/Ral+nxfotSXPEf8ZzWvBgNcfKAKeb/EZFbdTwutoV+qvHf3d2e9Oc4z+4KFjk7w7bTlahZg5t54Gv3NlLUzQbMYOP8AtBItYvEXXrAQKz3OlMxqx21JU5hWJFjZ/wD1COzRFR2026+0t8IGgpnclNPDDiK/uvtoQW60JfYO9V9MPPlvV7LjqJA8mRDj81SRrkzK3+n7Y0GvMeIm7je7FFVeuRrecZ5aSZaYKEDS+QrHKEFw6okx/KRxWnn1obVX5+D7HvZk2vtHZv7FMtY4uRgTd6rjbJQlnebfeKipPOSGKq2EmRokS+oYFUsE9DILZCsdatMOF9i32xyuTzFjqbQ9jkPtEI4FOtvIx3rZThXE2rvTlWMd2c4Vg2a8wD7do2a8wD7do2a8wD7do2a8wD7do2a8wD7do2a8wD7do2a8wD7do2a8wD7do2a8wD7do2a8wD7do2a8wD7domUcIF53LQQ8ItnPPYdHXxpaCZXnuQ8rKeFxPcrCc578YynP7nYmpbkSEIwseuXLCpSrbi1planHcDwW4VQPgrgDHJKXg5cH98OQBhrbL8hFGZbTjW1l+3uIri3F12G343j3E3LqUPh1ttrLLVQkptiuSIuG20J8HORsqIrhQpxla2WFNRcdBwcMCLGRENDgjRkVFRoLKBwo+NjgmmBAQRB222BRBWWmB2UIaabQhKU4/u5g4mHpNWsNulRoxth6SIja3ElzJzEeyUSEK6c6KE62I2SYIw4+ptLxLDeVOo2T7bv/ABvsP/8ASetk+27/AMb7D/8A0nqhb+VCY2tq0TbrATvBV9vICNMjZiWVDCsQ71L3T3AKIObKRlx9s0OPYSx3KbJdc/Cx/L/0R3X/AMDnvt/ojRf88e+1DLhAvheWghLi2c88wcdfGlpxlee5Dysp4XE9ysJznvxjKchQvlzvcdBQvlzvcdBQvlzvcdBQvlzvcdBQvlzvcdDRjY5XiuYsdktD2OQGQQjgU6a8jHetlOFcTau9OVYx3ZzhWP339Ed1/wDA577f6I0X/PHvtI8J4vw/7Ryefy+QUwT/AAuazxcXJ4P4ieHi4v093Dmw9J+p6sPSfqerD0n6nqw9J+p6sPSfqepnxfhPEfs/3dyOZzxXxv4vjnuHh53H/DVxcPD+jv4sfvg/vGvWqDlq5PR/iCw/Hws4ARGSgfiwHxThfFAlPseIDJHLY4+YO+y8lDiexx/2F7VP/uOuxx/2F7VP/uOtj/yUWG/QYFctsh+Uvd+9fe0LGHqkwg/CblX+4ggcg5WX/ERgwZbnfy3n3Ge5v+4Nz4+mDTTpAtQqYA70/uBejBFCoNHp9OjuZKyrUdk0PMvLLQLBQiSxFTMqBgsbL3Zl7TGKVkrDT1lw5tfmxNic1SclNVHN0wA6vDXC7gZVwZznOVN83GU4UrdGOuw0P4Fq4VI0ciA3BoJ8gh9QoFzp0mlmVivEuCHMx0uwg2tzqwDnK9Ny4wrr6f5iYKOqxVqlartBCrKU/HVLZ+syRkfRYaMZSrIzCy4tCbBPviIaalbTNTcxlCVnqTjU3IR1WGt8JV94YUVS3Bbfs3ZJcAG/wJoHGlg0lqGy5N1xZCXExdriYKYaQp4BCVfbXurfTNV7q30zVe6t9M1XurfTNV7q30zVe6t9M1XurfTNV7q30zVe6t9M1XurfTNV7q30zVe6t9M1XurfTNV7q30zVe6t9M1DeE8X4j9o+8efy+QK+T/C8CzxcXJ4P4ieHi4v093Dn82NkAS9stw7DEQBh4mQ/wDc1FfPeOoNyAR3cCoy3U8mGsAOW8/htH+GeS0Sw+w1qNKPM3Nv0JFz5Izb6mq9RRCkSV+tkg4P+IPHVenhzM0U4hSXVpDSMLxmPjtOfabC+YO9u0bC+YO9u0bC+YO9u0bC+YO9u0bC+YO9u0bC+YO9u0bC+YO9u0bC+YO9u0bC+YO9u0bC+YO9u0bC+YO9u0bC+YO9u0bC+YO9u0bC+YO9u0bC+YO9u0TGODi+K5iB3i1vZ54ZA6OBLoTKM9y3k5VxOJ7k4VnHfnGE5/NAmKLvFU4oiJo2+dA8CNcYiOceWY1XrICeO/FXintyC1lpgplts6NUVKKq09WSpmULK7cdBzR8FZwzN52UsWLW4FzU9y3avjcDMQ0VlnizltNveZw7hOOblKs5SDL3veG2x6Yu675X1IT9ylYhBfjUVqvBAstRNLqmCUsPkREK14uafCjiLNLTr8VFOA/3N//EADoRAAEDAAYFCQYGAwAAAAAAAAECAxEABCExQVESQGFxkRATFBUiMmBysQVCUoGh0jNTgpKiwSMkQ//aAAgBAgEBPwDwpVanzo5xyQg91IsKts4J+p2C/odWiOaHFU8Zn60rVS5oFxskoHeSbSnaDinDMYk2kawlISlKU3JAA3AQORQCkqSblJIM5EQdZqlYS62lBMOIABBNqgBGkM5xyOyOSt1hLSFIBlxQgAXpB945WXZnZOsgkGQYIuIsIp0l+I55yPMZ43/WhJJkkknE2nxcGG20hVZWpJUJS0gAuEZqJsTOR4zYP9JfZ/zNHBZ0VJ/UBbG6N4o6yppQBhSVCULTalacwfUYboJ1eqoC6w0k3aRO/RBVHzijqy44tZvUoncMB8hA5EnTqbgP/FaFJOQcOiRum2M41hpzmnEOfCoEjMXEfMSKVhkgl1vtMrOklQtCZvSrIg2W+s0SlSyEpBUTcAJPAUdhhgMSC4tQW6BB0AB2UTnicrcCJ1ht51r8NZTN4vSd6TI+cTQ1x8ggKCZv0EpSeMTwNL7T4vAkgC8kDiYp1c/8bX7l/ZTq5/42v3L+yj9Vcq4SVlBCiQNEqNwm2Up1hHfR50+o5faXca859NYR30edPqOX2l3GvOfTWASCCLwZG8U6bWvzf4N/ZTpta/N/g39lHX3XgA4vSAMjspEH9IHiBplx5Wi2mYvNwG8+gvOAp1a7HfbnLtRxj+qOsuMq0XExkb0q3H+rxiBrLDQZaSgC2JUc1G8n0GQAHI+0HmloIEwSk5KAsPGw5iRrLTgdbQse8kE7DiN4MjkdcDTa1n3QY2nADaTGssVlxgnRgpN6DcdoyO3iDFOskx+EZy0xHHRn6UfrLj57ViRcgXDacSdpuwjxP//EADYRAAECAQYLBgcBAAAAAAAAAAECEQMAITFBUZEQEhMyQGFxgaGx8BQiYHLB0QQjQ1Ki0uGC/9oACAEDAQE/APCkaPiHFTOqsmgatZ5cstEd8c8GuZpQo+OcVTBVRFB9jwOqvSCXJJpJJO/ACQQRSCCNo0mNDKFEgd1RcGx6jZq1b8EGGVqBI7oLk2tULddg3aVkobviJumuo4eLzEUokQgCBMVqzQdVvVVPz0z9xYsnB3FmveSFhYcTETKSaQbD1xcaRFJTDURSzXkD1khISlKRUONZ3mfARixkkfUSoH/Id+Q0hacdKk2jjUdxlDW4xFTLTMQa2oItcWcmkSAHJAFpkj5kTKN3EgpQaHNZ2Uj+g6SpCF5yQddd4nkIEMTsT5iSLvfxgSwJsBN0u0w7F3D9pdph2LuH7ShxUxCQkKDB5wPQnSF5qvKeRw/DZyvL6jSF5qvKeRw/DZyvL6jSCHBBoM0shC+38le8shC+38le8kw0IJKQxM1JPMnxAtaUB1FrBWdgl2lL5qmtme7+yQtKw6S9orG0dCzSYiytZUdg1Crq3BDWULCr9YrHVekrSUKKTUeFR3ifAhJUoJFZ4VncJ9JiQkxKZiKCKdmsdBnl2UvnhrWnuf1lDhJh0Tk0k07NQ6Pif//Z\"\n  },\n  {\n    value: PresetListType.BULLET_LIST_1,\n    img: \"data:image/jpeg;base64,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\"\n  },\n  {\n    value: PresetListType.BULLET_LIST_2,\n    img: \"data:image/jpeg;base64,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\"\n  },\n  {\n    value: PresetListType.BULLET_LIST_3,\n    img: \"data:image/jpeg;base64,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\"\n  },\n  {\n    value: PresetListType.BULLET_LIST_4,\n    img: \"data:image/jpeg;base64,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\"\n  },\n  {\n    value: PresetListType.BULLET_LIST_5,\n    img: \"data:image/jpeg;base64,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\"\n  }\n], BulletListTypePicker = /* @__PURE__ */ __name((props) => /* @__PURE__ */ jsxRuntimeExports.jsx(\n  ListTypePicker,\n  {\n    ...props,\n    options: bulletOptions\n  }\n), \"BulletListTypePicker\"), ORDER_LIST_TYPE_COMPONENT = `${COMPONENT_PREFIX}_ORDER_LIST_TYPE_COMPONENT`, BULLET_LIST_TYPE_COMPONENT = `${COMPONENT_PREFIX}_BULLET_LIST_TYPE_COMPONENT`;\nfunction whenDocAndEditorFocused(contextService) {\n  return contextService.getContextValue(FOCUSING_DOC) && contextService.getContextValue(FOCUSING_UNIVER_EDITOR) && !contextService.getContextValue(FOCUSING_COMMON_DRAWINGS);\n}\n__name(whenDocAndEditorFocused, \"whenDocAndEditorFocused\");\nfunction whenDocAndEditorFocusedWithBreakLine(contextService) {\n  return contextService.getContextValue(FOCUSING_DOC) && contextService.getContextValue(FOCUSING_UNIVER_EDITOR) && !contextService.getContextValue(FOCUSING_UNIVER_EDITOR_STANDALONE_SINGLE_MODE) && !contextService.getContextValue(FOCUSING_COMMON_DRAWINGS);\n}\n__name(whenDocAndEditorFocusedWithBreakLine, \"whenDocAndEditorFocusedWithBreakLine\");\nconst TabShortCut = {\n  id: TabCommand.id,\n  binding: KeyCode.TAB,\n  preconditions: whenDocAndEditorFocused\n}, ShiftTabShortCut = {\n  id: TabCommand.id,\n  binding: KeyCode.TAB | MetaKeys.SHIFT,\n  preconditions: whenDocAndEditorFocused,\n  staticParameters: {\n    shift: !0\n  }\n}, BoldShortCut = {\n  id: SetInlineFormatBoldCommand.id,\n  binding: KeyCode.B | MetaKeys.CTRL_COMMAND,\n  preconditions: whenDocAndEditorFocused\n}, ItalicShortCut = {\n  id: SetInlineFormatItalicCommand.id,\n  binding: KeyCode.I | MetaKeys.CTRL_COMMAND,\n  preconditions: whenDocAndEditorFocused\n}, UnderlineShortCut = {\n  id: SetInlineFormatUnderlineCommand.id,\n  binding: KeyCode.U | MetaKeys.CTRL_COMMAND,\n  preconditions: whenDocAndEditorFocused\n}, StrikeThroughShortCut = {\n  id: SetInlineFormatStrikethroughCommand.id,\n  binding: KeyCode.X | MetaKeys.SHIFT | MetaKeys.CTRL_COMMAND,\n  preconditions: whenDocAndEditorFocused\n}, SubscriptShortCut = {\n  id: SetInlineFormatSubscriptCommand.id,\n  binding: KeyCode.COMMA | MetaKeys.CTRL_COMMAND,\n  preconditions: whenDocAndEditorFocused\n}, SuperscriptShortCut = {\n  id: SetInlineFormatSuperscriptCommand.id,\n  binding: KeyCode.PERIOD | MetaKeys.CTRL_COMMAND,\n  preconditions: whenDocAndEditorFocused\n}, AlignLeftShortCut = {\n  id: AlignLeftCommand.id,\n  binding: KeyCode.L | MetaKeys.CTRL_COMMAND | MetaKeys.SHIFT,\n  preconditions: whenDocAndEditorFocused\n}, AlignRightShortCut = {\n  id: AlignRightCommand.id,\n  binding: KeyCode.R | MetaKeys.CTRL_COMMAND | MetaKeys.SHIFT,\n  preconditions: whenDocAndEditorFocused\n}, AlignCenterShortCut = {\n  id: AlignCenterCommand.id,\n  binding: KeyCode.E | MetaKeys.CTRL_COMMAND | MetaKeys.SHIFT,\n  preconditions: whenDocAndEditorFocused\n}, AlignJustifyShortCut = {\n  id: AlignJustifyCommand.id,\n  binding: KeyCode.J | MetaKeys.CTRL_COMMAND | MetaKeys.SHIFT,\n  preconditions: whenDocAndEditorFocused\n}, OrderListShortCut = {\n  id: OrderListCommand.id,\n  binding: KeyCode.Digit7 | MetaKeys.CTRL_COMMAND | MetaKeys.SHIFT,\n  preconditions: whenDocAndEditorFocused\n}, BulletListShortCut = {\n  id: BulletListCommand.id,\n  binding: KeyCode.Digit8 | MetaKeys.CTRL_COMMAND | MetaKeys.SHIFT,\n  preconditions: whenDocAndEditorFocused\n}, docCountBar = \"univer-doc-count-bar\", styles$3 = {\n  docCountBar\n}, ZOOM_MAP = [50, 80, 100, 130, 150, 170, 200, 400], DOC_ZOOM_RANGE = [10, 400];\nfunction ZoomSlider() {\n  const commandService = useDependency(ICommandService), univerInstanceService = useDependency(IUniverInstanceService), currentDoc$ = useMemo(() => univerInstanceService.getCurrentTypeOfUnit$(UniverInstanceType.UNIVER_DOC), []), documentDataModel = useObservable(currentDoc$), getCurrentZoom = useCallback(() => {\n    var _a28, _b;\n    if (!documentDataModel) return 100;\n    const currentZoom = ((_b = (_a28 = documentDataModel.getSettings()) == null ? void 0 : _a28.zoomRatio) != null ? _b : 1) * 100;\n    return Math.round(currentZoom);\n  }, [documentDataModel]), [zoom, setZoom] = useState(() => getCurrentZoom());\n  useEffect(() => (setZoom(getCurrentZoom()), commandService.onCommandExecuted((commandInfo) => {\n    if (commandInfo.id === SetDocZoomRatioOperation.id) {\n      const currentZoom = getCurrentZoom();\n      setZoom(currentZoom);\n    }\n  }).dispose), [commandService, getCurrentZoom]);\n  function handleChange(value) {\n    if (setZoom(value), documentDataModel == null)\n      return;\n    const zoomRatio = value / 100;\n    commandService.executeCommand(SetDocZoomRatioOperation.id, {\n      unitId: documentDataModel.getUnitId(),\n      zoomRatio\n    });\n  }\n  return __name(handleChange, \"handleChange\"), /* @__PURE__ */ jsxRuntimeExports.jsx(\n    Slider,\n    {\n      min: DOC_ZOOM_RANGE[0],\n      value: zoom,\n      shortcuts: ZOOM_MAP,\n      onChange: handleChange\n    }\n  );\n}\n__name(ZoomSlider, \"ZoomSlider\");\nfunction CountBar(props) {\n  return /* @__PURE__ */ jsxRuntimeExports.jsx(\"section\", { className: styles$3.docCountBar, children: /* @__PURE__ */ jsxRuntimeExports.jsx(ZoomSlider, {}) });\n}\n__name(CountBar, \"CountBar\");\nconst docFooterContainer = \"univer-doc-footer-container\", styles$2 = {\n  docFooterContainer\n}, DocFooter = /* @__PURE__ */ __name(() => /* @__PURE__ */ jsxRuntimeExports.jsxs(\"div\", { className: styles$2.docFooterContainer, children: [\n  /* @__PURE__ */ jsxRuntimeExports.jsx(\"div\", {}),\n  /* @__PURE__ */ jsxRuntimeExports.jsx(CountBar, {})\n] }), \"DocFooter\"), PLUGIN_CONFIG_KEY = \"docs-ui.config\", defaultPluginConfig = {\n  layout: {\n    docContainerConfig: DefaultDocContainerConfig,\n    toolbarConfig: DefaultToolbarConfig\n  }\n}, DocParagraphSettingCommand = {\n  id: \"doc-paragraph-setting.command\",\n  type: CommandType.COMMAND,\n  handler: /* @__PURE__ */ __name(async (accessor, config) => {\n    var _a28, _b, _c;\n    const docSelectionManagerService = accessor.get(DocSelectionManagerService), univerInstanceService = accessor.get(IUniverInstanceService), commandService = accessor.get(ICommandService), docDataModel = univerInstanceService.getCurrentUnitForType(UniverInstanceType.UNIVER_DOC), docRanges = docSelectionManagerService.getDocRanges();\n    if (!docDataModel || docRanges.length === 0 || !config)\n      return !1;\n    const segmentId = docRanges[0].segmentId, unitId = docDataModel.getUnitId(), allParagraphs = (_b = (_a28 = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()) == null ? void 0 : _a28.paragraphs) != null ? _b : [], paragraphs = (_c = getParagraphsInRanges(docRanges, allParagraphs)) != null ? _c : [], doMutation = {\n      id: RichTextEditingMutation.id,\n      params: {\n        unitId,\n        actions: [],\n        textRanges: docRanges\n      }\n    }, memoryCursor = new MemoryCursor();\n    memoryCursor.reset();\n    const textX = new TextX(), jsonX = JSONX.getInstance();\n    for (const paragraph of paragraphs) {\n      const { startIndex } = paragraph;\n      textX.push({\n        t: TextXActionType.RETAIN,\n        len: startIndex - memoryCursor.cursor,\n        segmentId\n      });\n      const paragraphStyle = {\n        ...paragraph.paragraphStyle,\n        ...config.paragraph\n      };\n      textX.push({\n        t: TextXActionType.RETAIN,\n        len: 1,\n        body: {\n          dataStream: \"\",\n          paragraphs: [\n            {\n              ...paragraph,\n              paragraphStyle,\n              startIndex: 0\n            }\n          ]\n        },\n        segmentId,\n        coverType: UpdateDocsAttributeType.REPLACE\n      }), memoryCursor.moveCursorTo(startIndex + 1);\n    }\n    const path = getRichTextEditPath(docDataModel, segmentId);\n    return doMutation.params.actions = jsonX.editOp(textX.serialize(), path), !!commandService.syncExecuteCommand(doMutation.id, doMutation.params);\n  }, \"handler\")\n}, useDocRanges = /* @__PURE__ */ __name(() => {\n  const docSelectionManagerService = useDependency(DocSelectionManagerService), docParagraphSettingController = useDependency(DocParagraphSettingController), docRanges = useMemo(() => docSelectionManagerService.getDocRanges(), []);\n  return useEffect(() => {\n    docRanges.length || docParagraphSettingController.closePanel();\n  }, [docRanges]), docRanges;\n}, \"useDocRanges\"), useCurrentParagraph = /* @__PURE__ */ __name(() => {\n  var _a28, _b, _c;\n  const docDataModel = useDependency(IUniverInstanceService).getCurrentUnitForType(UniverInstanceType.UNIVER_DOC), docRanges = useDocRanges();\n  if (!docDataModel || docRanges.length === 0)\n    return [];\n  const segmentId = docRanges[0].segmentId, paragraphs = (_b = (_a28 = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()) == null ? void 0 : _a28.paragraphs) != null ? _b : [];\n  return (_c = getParagraphsInRanges(docRanges, paragraphs)) != null ? _c : [];\n}, \"useCurrentParagraph\"), useFirstParagraphHorizontalAlign = /* @__PURE__ */ __name((paragraph, defaultValue) => {\n  const commandService = useDependency(ICommandService), [horizontalAlign, _horizontalAlignSet] = useState(() => {\n    var _a28, _b;\n    const firstParagraph = paragraph[0];\n    return firstParagraph ? String((_b = (_a28 = firstParagraph.paragraphStyle) == null ? void 0 : _a28.horizontalAlign) != null ? _b : defaultValue) : defaultValue;\n  });\n  return [horizontalAlign, /* @__PURE__ */ __name((v) => (_horizontalAlignSet(v), commandService.executeCommand(DocParagraphSettingCommand.id, {\n    paragraph: { horizontalAlign: Number(v) }\n  })), \"horizontalAlignSet\")];\n}, \"useFirstParagraphHorizontalAlign\"), useFirstParagraphIndentStart = /* @__PURE__ */ __name((paragraph) => {\n  const commandService = useDependency(ICommandService), [indentStart, _indentStartSet] = useState(() => {\n    var _a28;\n    const firstParagraph = paragraph[0];\n    return firstParagraph ? getNumberUnitValue((_a28 = firstParagraph.paragraphStyle) == null ? void 0 : _a28.indentStart, 0) : 0;\n  });\n  return [indentStart, /* @__PURE__ */ __name((v) => (_indentStartSet(v), commandService.executeCommand(DocParagraphSettingCommand.id, {\n    paragraph: { indentStart: { v } }\n  })), \"indentStartSet\")];\n}, \"useFirstParagraphIndentStart\"), useFirstParagraphIndentEnd = /* @__PURE__ */ __name((paragraph) => {\n  const commandService = useDependency(ICommandService), [indentEnd, _indentEndSet] = useState(() => {\n    var _a28;\n    const firstParagraph = paragraph[0];\n    return firstParagraph ? getNumberUnitValue((_a28 = firstParagraph.paragraphStyle) == null ? void 0 : _a28.indentEnd, 0) : 0;\n  });\n  return [indentEnd, /* @__PURE__ */ __name((v) => (_indentEndSet(v), commandService.executeCommand(DocParagraphSettingCommand.id, {\n    paragraph: { indentEnd: { v } }\n  })), \"indentEndSet\")];\n}, \"useFirstParagraphIndentEnd\"), useFirstParagraphIndentFirstLine = /* @__PURE__ */ __name((paragraph) => {\n  const commandService = useDependency(ICommandService), [indentFirstLine, _indentFirstLineSet] = useState(() => {\n    var _a28;\n    const firstParagraph = paragraph[0];\n    return firstParagraph ? getNumberUnitValue((_a28 = firstParagraph.paragraphStyle) == null ? void 0 : _a28.indentFirstLine, 0) : 0;\n  });\n  return [indentFirstLine, /* @__PURE__ */ __name((v) => (_indentFirstLineSet(v), commandService.executeCommand(DocParagraphSettingCommand.id, {\n    paragraph: { indentFirstLine: { v } }\n  })), \"indentFirstLineSet\")];\n}, \"useFirstParagraphIndentFirstLine\"), useFirstParagraphIndentHanging = /* @__PURE__ */ __name((paragraph) => {\n  const commandService = useDependency(ICommandService), [hanging, _hangingSet] = useState(() => {\n    var _a28;\n    const firstParagraph = paragraph[0];\n    return firstParagraph ? getNumberUnitValue((_a28 = firstParagraph.paragraphStyle) == null ? void 0 : _a28.hanging, 0) : 0;\n  });\n  return [hanging, /* @__PURE__ */ __name((v) => (_hangingSet(v), commandService.executeCommand(DocParagraphSettingCommand.id, {\n    paragraph: { hanging: { v } }\n  })), \"hangingSet\")];\n}, \"useFirstParagraphIndentHanging\"), useFirstParagraphIndentSpaceAbove = /* @__PURE__ */ __name((paragraph) => {\n  const commandService = useDependency(ICommandService), [spaceAbove, _spaceAboveSet] = useState(() => {\n    var _a28;\n    const firstParagraph = paragraph[0];\n    return firstParagraph ? getNumberUnitValue((_a28 = firstParagraph.paragraphStyle) == null ? void 0 : _a28.spaceAbove, 0) : 0;\n  });\n  return [spaceAbove, /* @__PURE__ */ __name((v) => (_spaceAboveSet(v), commandService.executeCommand(DocParagraphSettingCommand.id, {\n    paragraph: { spaceAbove: { v } }\n  })), \"spaceAboveSet\")];\n}, \"useFirstParagraphIndentSpaceAbove\"), useFirstParagraphSpaceBelow = /* @__PURE__ */ __name((paragraph) => {\n  const commandService = useDependency(ICommandService), [spaceBelow, _spaceBelowSet] = useState(() => {\n    var _a28;\n    const firstParagraph = paragraph[0];\n    return firstParagraph ? getNumberUnitValue((_a28 = firstParagraph.paragraphStyle) == null ? void 0 : _a28.spaceBelow, 0) : 0;\n  });\n  return [spaceBelow, /* @__PURE__ */ __name((v) => (_spaceBelowSet(v), commandService.executeCommand(DocParagraphSettingCommand.id, {\n    paragraph: { spaceBelow: { v } }\n  })), \"spaceBelowSet\")];\n}, \"useFirstParagraphSpaceBelow\"), useFirstParagraphLineSpacing = /* @__PURE__ */ __name((paragraph) => {\n  const commandService = useDependency(ICommandService), renderManagerService = useDependency(IRenderManagerService), univerInstanceService = useDependency(IUniverInstanceService), skeleton = useMemo(() => {\n    var _a28;\n    const docDataModel = univerInstanceService.getCurrentUnitForType(UniverInstanceType.UNIVER_DOC);\n    if (docDataModel)\n      return (_a28 = renderManagerService.getRenderById(docDataModel == null ? void 0 : docDataModel.getUnitId())) == null ? void 0 : _a28.with(DocSkeletonManagerService).getSkeleton();\n  }, []), stateChange$ = useMemo(() => new BehaviorSubject({}), []), [lineSpacing, _lineSpacingSet] = useState(() => {\n    var _a28, _b;\n    const firstParagraph = paragraph[0];\n    return firstParagraph && (_b = (_a28 = firstParagraph.paragraphStyle) == null ? void 0 : _a28.lineSpacing) != null ? _b : 1;\n  }), lineSpacingCache = useRef(lineSpacing), [spacingRule, _spacingRuleSet] = useState(() => {\n    var _a28, _b;\n    const firstParagraph = paragraph[0];\n    return firstParagraph ? (_b = (_a28 = firstParagraph.paragraphStyle) == null ? void 0 : _a28.spacingRule) != null ? _b : SpacingRule.AUTO : SpacingRule.AUTO;\n  }), lineSpacingSet = /* @__PURE__ */ __name(async (v) => {\n    _lineSpacingSet(v), stateChange$.next({ lineSpacing: v, spacingRule });\n  }, \"lineSpacingSet\"), spacingRuleSet = /* @__PURE__ */ __name(async (v) => {\n    if (v !== spacingRule) {\n      let cache = lineSpacingCache.current;\n      if (v === SpacingRule.AT_LEAST) {\n        const glyphNode = skeleton == null ? void 0 : skeleton.findNodeByCharIndex(paragraph[0].startIndex), divideNode = glyphNode == null ? void 0 : glyphNode.parent, lineNode = divideNode == null ? void 0 : divideNode.parent;\n        (lineNode == null ? void 0 : lineNode.contentHeight) !== void 0 && (cache = Math.max(lineNode.contentHeight, cache));\n      } else\n        cache > 5 && (cache = 2);\n      lineSpacingCache.current = lineSpacing, lineSpacingSet(cache), _spacingRuleSet(v), stateChange$.next({ spacingRule: v });\n    }\n  }, \"spacingRuleSet\");\n  return useEffect(() => {\n    const dispose = stateChange$.pipe(\n      filter((obj) => !!Object.keys(obj).length),\n      bufferTime(16),\n      filter((list) => !!list.length),\n      map((list) => list.reduce((a, b) => (Object.keys(b).forEach((key) => {\n        a[key] = b[key];\n      }), a), {}))\n    ).subscribe((v) => commandService.executeCommand(DocParagraphSettingCommand.id, {\n      paragraph: { ...v }\n    }));\n    return () => dispose.unsubscribe();\n  }, []), {\n    lineSpacing: [lineSpacing, lineSpacingSet],\n    spacingRule: [spacingRule, spacingRuleSet]\n  };\n}, \"useFirstParagraphLineSpacing\"), paragraphSettingIconList = \"univer-paragraph-setting-icon-list\", paragraphSettingIconListItem = \"univer-paragraph-setting-icon-list-item\", paragraphSettingIconListActive = \"univer-paragraph-setting-icon-list-active\", paragraphSettingTitle = \"univer-paragraph-setting-title\", paragraphSettingLabel = \"univer-paragraph-setting-label\", paragraphSettingMtBase = \"univer-paragraph-setting-mt-base\", paragraphSettingFlexCol = \"univer-paragraph-setting-flex-col\", paragraphSettingSpaceLine = \"univer-paragraph-setting-space-line\", styles$1 = {\n  paragraphSettingIconList,\n  paragraphSettingIconListItem,\n  paragraphSettingIconListActive,\n  paragraphSettingTitle,\n  paragraphSettingLabel,\n  paragraphSettingMtBase,\n  paragraphSettingFlexCol,\n  paragraphSettingSpaceLine\n}, AutoFocusInputNumber = /* @__PURE__ */ __name((props) => {\n  const { value, onChange, className = \"\", min = 0, max = 100, step = 1 } = props, ref = require$$0.useRef(null);\n  return /* @__PURE__ */ jsxRuntimeExports.jsx(\n    InputNumber,\n    {\n      step,\n      ref,\n      min,\n      max,\n      value,\n      onChange: /* @__PURE__ */ __name((v) => {\n        onChange(v != null ? v : 0).finally(() => {\n          setTimeout(() => {\n            var _a28;\n            (_a28 = ref.current) == null || _a28.focus();\n          }, 30);\n        });\n      }, \"onChange\"),\n      className\n    }\n  );\n}, \"AutoFocusInputNumber\");\nfunction ParagraphSetting() {\n  const localeService = useDependency(LocaleService), alignmentOptions = useMemo(\n    () => [\n      { label: localeService.t(\"toolbar.alignLeft\"), value: String(HorizontalAlign.LEFT), icon: /* @__PURE__ */ jsxRuntimeExports.jsx(LeftJustifyingSingle, {}) },\n      { label: localeService.t(\"toolbar.alignCenter\"), value: String(HorizontalAlign.CENTER), icon: /* @__PURE__ */ jsxRuntimeExports.jsx(HorizontallySingle, {}) },\n      { label: localeService.t(\"toolbar.alignRight\"), value: String(HorizontalAlign.RIGHT), icon: /* @__PURE__ */ jsxRuntimeExports.jsx(RightJustifyingSingle, {}) },\n      { label: localeService.t(\"toolbar.alignJustify\"), value: String(HorizontalAlign.JUSTIFIED), icon: /* @__PURE__ */ jsxRuntimeExports.jsx(AlignTextBothSingle, {}) }\n    ],\n    []\n  ), currentParagraph = useCurrentParagraph(), [horizontalAlignValue, horizontalAlignSet] = useFirstParagraphHorizontalAlign(currentParagraph, alignmentOptions[0].value), [indentStart, indentStartSet] = useFirstParagraphIndentStart(currentParagraph), [indentEnd, indentEndSet] = useFirstParagraphIndentEnd(currentParagraph), [indentFirstLine, indentFirstLineSet] = useFirstParagraphIndentFirstLine(currentParagraph), [hanging, hangingSet] = useFirstParagraphIndentHanging(currentParagraph), [spaceAbove, spaceAboveSet] = useFirstParagraphIndentSpaceAbove(currentParagraph), [spaceBelow, spaceBelowSet] = useFirstParagraphSpaceBelow(currentParagraph), { lineSpacing: [lineSpacing, lineSpacingSet], spacingRule: [spacingRule, spacingRuleSet] } = useFirstParagraphLineSpacing(currentParagraph), lineSpaceConfig = useMemo(() => spacingRule === SpacingRule.AUTO ? { min: 1, max: 5, step: lineSpacing < 2 ? 0.5 : 1 } : { min: 1, max: 100 }, [spacingRule, lineSpacing]);\n  return /* @__PURE__ */ jsxRuntimeExports.jsxs(\"div\", { className: styles$1.paragraphSetting, children: [\n    /* @__PURE__ */ jsxRuntimeExports.jsx(\"div\", { className: styles$1.paragraphSettingTitle, children: localeService.t(\"doc.paragraphSetting.alignment\") }),\n    /* @__PURE__ */ jsxRuntimeExports.jsx(\"div\", { className: `${styles$1.paragraphSettingIconList} ${styles$1.paragraphSettingMtBase}`, children: alignmentOptions.map((item) => /* @__PURE__ */ jsxRuntimeExports.jsx(Tooltip, { title: item.label, placement: \"bottom\", children: /* @__PURE__ */ jsxRuntimeExports.jsx(\n      \"span\",\n      {\n        className: clsx(\n          styles$1.paragraphSettingIconListItem,\n          { [styles$1.paragraphSettingIconListActive]: horizontalAlignValue === item.value }\n        ),\n        onClick: /* @__PURE__ */ __name(() => horizontalAlignSet(item.value), \"onClick\"),\n        children: item.icon\n      }\n    ) }, item.value)) }),\n    /* @__PURE__ */ jsxRuntimeExports.jsx(\"div\", { className: styles$1.paragraphSettingTitle, children: localeService.t(\"doc.paragraphSetting.indentation\") }),\n    /* @__PURE__ */ jsxRuntimeExports.jsxs(\"div\", { children: [\n      /* @__PURE__ */ jsxRuntimeExports.jsxs(\"div\", { className: styles$1.paragraphSettingFlexCol, children: [\n        /* @__PURE__ */ jsxRuntimeExports.jsxs(\"div\", { className: styles$1.paragraphSettingLabel, children: [\n          localeService.t(\"doc.paragraphSetting.left\"),\n          \"(px)\"\n        ] }),\n        /* @__PURE__ */ jsxRuntimeExports.jsx(AutoFocusInputNumber, { className: styles$1.paragraphSettingMtBase, value: indentStart, onChange: /* @__PURE__ */ __name((v) => indentStartSet(v != null ? v : 0), \"onChange\") })\n      ] }),\n      /* @__PURE__ */ jsxRuntimeExports.jsxs(\"div\", { className: styles$1.paragraphSettingFlexCol, children: [\n        /* @__PURE__ */ jsxRuntimeExports.jsxs(\"div\", { className: styles$1.paragraphSettingLabel, children: [\n          localeService.t(\"doc.paragraphSetting.right\"),\n          \"(px)\"\n        ] }),\n        /* @__PURE__ */ jsxRuntimeExports.jsx(AutoFocusInputNumber, { className: styles$1.paragraphSettingMtBase, value: indentEnd, onChange: /* @__PURE__ */ __name((v) => indentEndSet(v != null ? v : 0), \"onChange\") })\n      ] }),\n      /* @__PURE__ */ jsxRuntimeExports.jsxs(\"div\", { className: styles$1.paragraphSettingFlexCol, children: [\n        /* @__PURE__ */ jsxRuntimeExports.jsxs(\"div\", { className: styles$1.paragraphSettingLabel, children: [\n          localeService.t(\"doc.paragraphSetting.firstLine\"),\n          \"(px)\"\n        ] }),\n        /* @__PURE__ */ jsxRuntimeExports.jsx(AutoFocusInputNumber, { className: styles$1.paragraphSettingMtBase, value: indentFirstLine, onChange: /* @__PURE__ */ __name((v) => indentFirstLineSet(v != null ? v : 0), \"onChange\") })\n      ] }),\n      /* @__PURE__ */ jsxRuntimeExports.jsxs(\"div\", { className: styles$1.paragraphSettingFlexCol, children: [\n        /* @__PURE__ */ jsxRuntimeExports.jsxs(\"div\", { className: styles$1.paragraphSettingLabel, children: [\n          localeService.t(\"doc.paragraphSetting.hanging\"),\n          \"(px)\"\n        ] }),\n        /* @__PURE__ */ jsxRuntimeExports.jsx(AutoFocusInputNumber, { className: styles$1.paragraphSettingMtBase, value: hanging, onChange: /* @__PURE__ */ __name((v) => hangingSet(v != null ? v : 0), \"onChange\") })\n      ] })\n    ] }),\n    /* @__PURE__ */ jsxRuntimeExports.jsx(\"div\", { className: styles$1.paragraphSettingTitle, children: localeService.t(\"doc.paragraphSetting.spacing\") }),\n    /* @__PURE__ */ jsxRuntimeExports.jsxs(\"div\", { children: [\n      /* @__PURE__ */ jsxRuntimeExports.jsxs(\"div\", { className: styles$1.paragraphSettingFlexCol, children: [\n        /* @__PURE__ */ jsxRuntimeExports.jsxs(\"div\", { className: styles$1.paragraphSettingLabel, children: [\n          localeService.t(\"doc.paragraphSetting.before\"),\n          \"(px)\"\n        ] }),\n        /* @__PURE__ */ jsxRuntimeExports.jsx(AutoFocusInputNumber, { className: styles$1.paragraphSettingMtBase, value: spaceAbove, onChange: /* @__PURE__ */ __name((v) => spaceAboveSet(v != null ? v : 0), \"onChange\") })\n      ] }),\n      /* @__PURE__ */ jsxRuntimeExports.jsxs(\"div\", { className: styles$1.paragraphSettingFlexCol, children: [\n        /* @__PURE__ */ jsxRuntimeExports.jsxs(\"div\", { className: styles$1.paragraphSettingLabel, children: [\n          localeService.t(\"doc.paragraphSetting.after\"),\n          \"(px)\"\n        ] }),\n        /* @__PURE__ */ jsxRuntimeExports.jsx(AutoFocusInputNumber, { className: styles$1.paragraphSettingMtBase, value: spaceBelow, onChange: /* @__PURE__ */ __name((v) => spaceBelowSet(v != null ? v : 0), \"onChange\") })\n      ] }),\n      /* @__PURE__ */ jsxRuntimeExports.jsxs(\"div\", { className: styles$1.paragraphSettingFlexCol, children: [\n        /* @__PURE__ */ jsxRuntimeExports.jsx(\"div\", { className: styles$1.paragraphSettingLabel, children: localeService.t(\"doc.paragraphSetting.lineSpace\") }),\n        /* @__PURE__ */ jsxRuntimeExports.jsxs(\"div\", { className: `${styles$1.paragraphSettingMtBase} ${styles$1.paragraphSettingSpaceLine}`, style: { width: 162 }, children: [\n          /* @__PURE__ */ jsxRuntimeExports.jsx(\n            Select,\n            {\n              value: `${spacingRule}`,\n              options: [\n                { label: localeService.t(\"doc.paragraphSetting.multiSpace\"), value: `${SpacingRule.AUTO}` },\n                { label: localeService.t(\"doc.paragraphSetting.fixedValue\"), value: `${SpacingRule.AT_LEAST}` }\n              ],\n              onChange: /* @__PURE__ */ __name((v) => spacingRuleSet(Number(v)), \"onChange\")\n            }\n          ),\n          /* @__PURE__ */ jsxRuntimeExports.jsx(\n            AutoFocusInputNumber,\n            {\n              ...lineSpaceConfig,\n              value: lineSpacing,\n              onChange: /* @__PURE__ */ __name((v) => lineSpacingSet(v != null ? v : 0), \"onChange\")\n            }\n          )\n        ] })\n      ] })\n    ] })\n  ] });\n}\n__name(ParagraphSetting, \"ParagraphSetting\");\nconst isRangesEqual = /* @__PURE__ */ __name((oldRanges, ranges) => ranges.length === oldRanges.length && oldRanges.some((oldRange) => ranges.some((range) => range.startOffset === oldRange.startOffset && range.endOffset === oldRange.endOffset)), \"isRangesEqual\"), isRangesIntersection = /* @__PURE__ */ __name((oldRanges, ranges) => oldRanges.some((oldRange) => ranges.some((range) => {\n  const { startOffset: activeStart, endOffset: activeEnd } = oldRange, { startOffset: compareStart, endOffset: compareEnd } = range;\n  return activeStart == null || activeEnd == null || compareStart == null || compareEnd == null ? !1 : activeStart <= compareEnd && activeEnd >= compareStart;\n})), \"isRangesIntersection\");\nfunction ParagraphSettingIndex() {\n  const commandService = useDependency(ICommandService), localeService = useDependency(LocaleService), currentLocale = useObservable(localeService.currentLocale$), [key, keySet] = useState(\"\"), rangeRef = useRef([]);\n  return useEffect(() => {\n    const dispose = commandService.onCommandExecuted((info) => {\n      var _a28;\n      if (SetTextSelectionsOperation.id === info.id) {\n        const ranges = info.params.ranges;\n        isRangesEqual(ranges, rangeRef.current) || keySet(generateRandomId(4)), rangeRef.current = ranges;\n      }\n      if (RichTextEditingMutation.id === info.id) {\n        const params = info.params, ranges = (_a28 = params.textRanges) != null ? _a28 : [];\n        params.trigger !== DocParagraphSettingCommand.id && isRangesIntersection(ranges, rangeRef.current) && keySet(generateRandomId(4));\n      }\n    });\n    return () => dispose.dispose();\n  }, []), useEffect(() => {\n    keySet(generateRandomId(4));\n  }, [currentLocale]), /* @__PURE__ */ jsxRuntimeExports.jsx(ParagraphSetting, {}, key);\n}\n__name(ParagraphSettingIndex, \"ParagraphSettingIndex\");\nvar __defProp$m = Object.defineProperty, __getOwnPropDesc$m = Object.getOwnPropertyDescriptor, __decorateClass$m = /* @__PURE__ */ __name((decorators, target, key, kind) => {\n  for (var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$m(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)\n    (decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n  return kind && result && __defProp$m(target, key, result), result;\n}, \"__decorateClass$m\"), __decorateParam$m = /* @__PURE__ */ __name((index, decorator) => (target, key) => decorator(target, key, index), \"__decorateParam$m\");\nconst paragraphSettingIndexKey = \"doc_ui_paragraph-setting-panel\";\nvar _a5;\nlet DocParagraphSettingController = (_a5 = class extends Disposable {\n  constructor(_commandService, _componentManager, _sidebarService) {\n    super();\n    __publicField(this, \"_id\");\n    this._commandService = _commandService, this._componentManager = _componentManager, this._sidebarService = _sidebarService, this._init();\n  }\n  _init() {\n    this.disposeWithMe(this._componentManager.register(paragraphSettingIndexKey, ParagraphSettingIndex));\n  }\n  openPanel() {\n    const props = {\n      header: { title: \"doc.slider.paragraphSetting\" },\n      id: this._id,\n      children: {\n        label: paragraphSettingIndexKey\n      },\n      width: 300\n    };\n    this._sidebarService.open(props);\n  }\n  closePanel() {\n    this._sidebarService.close(this._id);\n  }\n}, __name(_a5, \"DocParagraphSettingController\"), _a5);\nDocParagraphSettingController = __decorateClass$m([\n  OnLifecycle(LifecycleStages.Rendered, DocParagraphSettingController),\n  __decorateParam$m(0, ICommandService),\n  __decorateParam$m(1, Inject(ComponentManager)),\n  __decorateParam$m(2, Inject(ISidebarService))\n], DocParagraphSettingController);\nconst DocParagraphSettingPanelOperation = {\n  id: \"sidebar.operation.doc-paragraph-setting-panel\",\n  type: CommandType.OPERATION,\n  handler: /* @__PURE__ */ __name((accessor) => (accessor.get(DocParagraphSettingController).openPanel(), !0), \"handler\")\n}, getDisableOnCollapsedObservable = /* @__PURE__ */ __name((accessor) => {\n  const docSelectionManagerService = accessor.get(DocSelectionManagerService);\n  return new Observable((subscriber) => {\n    const observable = docSelectionManagerService.textSelection$.subscribe(() => {\n      const range = docSelectionManagerService.getActiveTextRange();\n      range && !range.collapsed ? subscriber.next(!1) : subscriber.next(!0);\n    });\n    return () => observable.unsubscribe();\n  });\n}, \"getDisableOnCollapsedObservable\");\nfunction inSameTable(rectRanges) {\n  if (rectRanges.length < 2)\n    return !0;\n  const tableIds = rectRanges.map((rectRange) => rectRange.tableId);\n  return tableIds.every((tableId) => tableId === tableIds[0]);\n}\n__name(inSameTable, \"inSameTable\");\nconst getDisableWhenSelectionNotInTableObservable = /* @__PURE__ */ __name((accessor) => {\n  const docSelectionManagerService = accessor.get(DocSelectionManagerService), univerInstanceService = accessor.get(IUniverInstanceService);\n  return new Observable((subscriber) => {\n    const observable = docSelectionManagerService.textSelection$.subscribe(() => {\n      var _a28;\n      const rectRanges = docSelectionManagerService.getCurrentRectRanges(), activeRange = docSelectionManagerService.getActiveTextRange();\n      if (rectRanges && rectRanges.length && inSameTable(rectRanges)) {\n        subscriber.next(!1);\n        return;\n      }\n      if (activeRange && (rectRanges == null || rectRanges.length === 0)) {\n        const { segmentId, startOffset, endOffset } = activeRange, docDataModel = univerInstanceService.getCurrentUniverDocInstance(), tables = (_a28 = docDataModel == null ? void 0 : docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()) == null ? void 0 : _a28.tables;\n        if (tables && tables.length && tables.some((table) => {\n          const { startIndex, endIndex } = table;\n          return startOffset > startIndex && startOffset < endIndex || endOffset > startIndex && endOffset < endIndex;\n        })) {\n          subscriber.next(!1);\n          return;\n        }\n      }\n      subscriber.next(!0);\n    });\n    return () => observable.unsubscribe();\n  });\n}, \"getDisableWhenSelectionNotInTableObservable\"), CopyMenuFactory = /* @__PURE__ */ __name((accessor) => ({\n  id: DocCopyCommand.name,\n  commandId: DocCopyCommand.id,\n  type: MenuItemType.BUTTON,\n  icon: \"Copy\",\n  title: \"rightClick.copy\",\n  disabled$: getDisableOnCollapsedObservable(accessor),\n  hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC)\n}), \"CopyMenuFactory\"), ParagraphSettingMenuFactory = /* @__PURE__ */ __name((accessor) => ({\n  id: DocParagraphSettingPanelOperation.id,\n  type: MenuItemType.BUTTON,\n  icon: \"MenuSingle24\",\n  title: \"doc.menu.paragraphSetting\",\n  hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC)\n}), \"ParagraphSettingMenuFactory\"), CutMenuFactory = /* @__PURE__ */ __name((accessor) => ({\n  id: DocCutCommand.id,\n  type: MenuItemType.BUTTON,\n  icon: \"Copy\",\n  title: \"rightClick.cut\",\n  disabled$: getDisableOnCollapsedObservable(accessor),\n  hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC)\n}), \"CutMenuFactory\"), PasteMenuFactory = /* @__PURE__ */ __name((accessor) => ({\n  id: DocPasteCommand.id,\n  type: MenuItemType.BUTTON,\n  icon: \"PasteSpecial\",\n  title: \"rightClick.paste\",\n  hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC)\n}), \"PasteMenuFactory\"), DeleteMenuFactory = /* @__PURE__ */ __name((accessor) => ({\n  id: DeleteLeftCommand.id,\n  type: MenuItemType.BUTTON,\n  icon: \"PasteSpecial\",\n  title: \"rightClick.delete\",\n  disabled$: getDisableOnCollapsedObservable(accessor),\n  hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC)\n}), \"DeleteMenuFactory\"), TABLE_INSERT_MENU_ID = \"doc.menu.table-insert\";\nfunction TableInsertMenuItemFactory(accessor) {\n  return {\n    id: TABLE_INSERT_MENU_ID,\n    type: MenuItemType.SUBITEMS,\n    title: \"table.insert\",\n    icon: \"Insert\",\n    hidden$: combineLatest(getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC), getDisableWhenSelectionNotInTableObservable(accessor), (one, two) => one || two)\n  };\n}\n__name(TableInsertMenuItemFactory, \"TableInsertMenuItemFactory\");\nfunction InsertRowBeforeMenuItemFactory(accessor) {\n  return {\n    id: DocTableInsertRowAboveCommand.id,\n    type: MenuItemType.BUTTON,\n    title: \"table.insertRowAbove\",\n    icon: \"InsertRowAbove\",\n    disabled$: getDisableWhenSelectionNotInTableObservable(accessor),\n    hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC)\n  };\n}\n__name(InsertRowBeforeMenuItemFactory, \"InsertRowBeforeMenuItemFactory\");\nfunction InsertRowAfterMenuItemFactory(accessor) {\n  return {\n    id: DocTableInsertRowBellowCommand.id,\n    type: MenuItemType.BUTTON,\n    title: \"table.insertRowBelow\",\n    icon: \"InsertRowBelow\",\n    disabled$: getDisableWhenSelectionNotInTableObservable(accessor),\n    hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC)\n  };\n}\n__name(InsertRowAfterMenuItemFactory, \"InsertRowAfterMenuItemFactory\");\nfunction InsertColumnLeftMenuItemFactory(accessor) {\n  return {\n    id: DocTableInsertColumnLeftCommand.id,\n    type: MenuItemType.BUTTON,\n    title: \"table.insertColumnLeft\",\n    icon: \"LeftInsertColumn\",\n    disabled$: getDisableWhenSelectionNotInTableObservable(accessor),\n    hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC)\n  };\n}\n__name(InsertColumnLeftMenuItemFactory, \"InsertColumnLeftMenuItemFactory\");\nfunction InsertColumnRightMenuItemFactory(accessor) {\n  return {\n    id: DocTableInsertColumnRightCommand.id,\n    type: MenuItemType.BUTTON,\n    title: \"table.insertColumnRight\",\n    icon: \"RightInsertColumn\",\n    disabled$: getDisableWhenSelectionNotInTableObservable(accessor),\n    hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC)\n  };\n}\n__name(InsertColumnRightMenuItemFactory, \"InsertColumnRightMenuItemFactory\");\nconst TABLE_DELETE_MENU_ID = \"doc.menu.table-delete\";\nfunction TableDeleteMenuItemFactory(accessor) {\n  return {\n    id: TABLE_DELETE_MENU_ID,\n    type: MenuItemType.SUBITEMS,\n    title: \"table.delete\",\n    icon: \"Reduce\",\n    hidden$: combineLatest(getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC), getDisableWhenSelectionNotInTableObservable(accessor), (one, two) => one || two)\n  };\n}\n__name(TableDeleteMenuItemFactory, \"TableDeleteMenuItemFactory\");\nfunction DeleteRowsMenuItemFactory(accessor) {\n  return {\n    id: DocTableDeleteRowsCommand.id,\n    type: MenuItemType.BUTTON,\n    title: \"table.deleteRows\",\n    icon: \"DeleteRow\",\n    disabled$: getDisableWhenSelectionNotInTableObservable(accessor),\n    hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC)\n  };\n}\n__name(DeleteRowsMenuItemFactory, \"DeleteRowsMenuItemFactory\");\nfunction DeleteColumnsMenuItemFactory(accessor) {\n  return {\n    id: DocTableDeleteColumnsCommand.id,\n    type: MenuItemType.BUTTON,\n    title: \"table.deleteColumns\",\n    icon: \"DeleteColumn\",\n    disabled$: getDisableWhenSelectionNotInTableObservable(accessor),\n    hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC)\n  };\n}\n__name(DeleteColumnsMenuItemFactory, \"DeleteColumnsMenuItemFactory\");\nfunction DeleteTableMenuItemFactory(accessor) {\n  return {\n    id: DocTableDeleteTableCommand.id,\n    type: MenuItemType.BUTTON,\n    title: \"table.deleteTable\",\n    icon: \"GridSingle\",\n    disabled$: getDisableWhenSelectionNotInTableObservable(accessor),\n    hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC)\n  };\n}\n__name(DeleteTableMenuItemFactory, \"DeleteTableMenuItemFactory\");\nfunction getInsertTableHiddenObservable(accessor) {\n  const univerInstanceService = accessor.get(IUniverInstanceService), renderManagerService = accessor.get(IRenderManagerService);\n  return new Observable((subscriber) => {\n    const subscription = univerInstanceService.focused$.subscribe((unitId) => {\n      if (unitId == null || univerInstanceService.getUnitType(unitId) !== UniverInstanceType.UNIVER_DOC)\n        return subscriber.next(!0);\n      const currentRender2 = renderManagerService.getRenderById(unitId);\n      if (currentRender2 == null)\n        return subscriber.next(!0);\n      currentRender2.with(DocSkeletonManagerService).getViewModel().editAreaChange$.subscribe((editArea) => {\n        subscriber.next(editArea === DocumentEditArea.HEADER || editArea === DocumentEditArea.FOOTER);\n      });\n    }), currentRender = renderManagerService.getCurrentTypeOfRenderer(UniverInstanceType.UNIVER_DOC);\n    if (currentRender == null)\n      return subscriber.next(!0);\n    const viewModel = currentRender.with(DocSkeletonManagerService).getViewModel();\n    return subscriber.next(viewModel.getEditArea() !== DocumentEditArea.BODY), () => subscription.unsubscribe();\n  });\n}\n__name(getInsertTableHiddenObservable, \"getInsertTableHiddenObservable\");\nfunction getTableDisabledObservable(accessor) {\n  const docSelectionManagerService = accessor.get(DocSelectionManagerService), univerInstanceService = accessor.get(IUniverInstanceService);\n  return new Observable((subscriber) => {\n    const subscription = docSelectionManagerService.textSelection$.subscribe((selection) => {\n      if (selection == null) {\n        subscriber.next(!0);\n        return;\n      }\n      const { textRanges } = selection;\n      if (textRanges.length !== 1) {\n        subscriber.next(!0);\n        return;\n      }\n      const textRange = textRanges[0], { collapsed, startNodePosition, startOffset } = textRange;\n      if (!collapsed || startOffset == null) {\n        subscriber.next(!0);\n        return;\n      }\n      const docDataModel = univerInstanceService.getCurrentUniverDocInstance();\n      if (docDataModel == null) {\n        subscriber.next(!0);\n        return;\n      }\n      const docSkeletonManagerService = getCommandSkeleton(accessor, docDataModel.getUnitId());\n      if (docSkeletonManagerService == null) {\n        subscriber.next(!0);\n        return;\n      }\n      if (docSkeletonManagerService.getViewModel().getCustomRangeRaw(startOffset)) {\n        subscriber.next(!0);\n        return;\n      }\n      if (startNodePosition != null) {\n        const { path } = startNodePosition;\n        if (path.indexOf(\"cells\") !== -1) {\n          subscriber.next(!0);\n          return;\n        }\n      }\n      subscriber.next(!1);\n    });\n    return () => subscription.unsubscribe();\n  });\n}\n__name(getTableDisabledObservable, \"getTableDisabledObservable\");\nfunction disableMenuWhenNoDocRange(accessor) {\n  const docSelectionManagerService = accessor.get(DocSelectionManagerService);\n  return new Observable((subscriber) => {\n    const subscription = docSelectionManagerService.textSelection$.subscribe((selection) => {\n      if (selection == null) {\n        subscriber.next(!0);\n        return;\n      }\n      const { textRanges, rectRanges } = selection;\n      if (textRanges.length === 0 && rectRanges.length === 0) {\n        subscriber.next(!0);\n        return;\n      }\n      subscriber.next(!1);\n    });\n    return () => subscription.unsubscribe();\n  });\n}\n__name(disableMenuWhenNoDocRange, \"disableMenuWhenNoDocRange\");\nfunction BoldMenuItemFactory(accessor) {\n  const commandService = accessor.get(ICommandService);\n  return {\n    id: SetInlineFormatBoldCommand.id,\n    type: MenuItemType.BUTTON,\n    icon: \"BoldSingle\",\n    title: \"Set bold\",\n    tooltip: \"toolbar.bold\",\n    activated$: new Observable((subscriber) => {\n      const disposable = commandService.onCommandExecuted((c) => {\n        var _a28;\n        const id = c.id;\n        if (id === SetTextSelectionsOperation.id || id === SetInlineFormatCommand.id) {\n          const textRun = getFontStyleAtCursor(accessor);\n          if (textRun == null) {\n            subscriber.next(!1);\n            return;\n          }\n          const bl = (_a28 = textRun.ts) == null ? void 0 : _a28.bl;\n          subscriber.next(bl === BooleanNumber.TRUE);\n        }\n      });\n      return subscriber.next(!1), disposable.dispose;\n    }),\n    disabled$: disableMenuWhenNoDocRange(accessor),\n    hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC)\n  };\n}\n__name(BoldMenuItemFactory, \"BoldMenuItemFactory\");\nfunction ItalicMenuItemFactory(accessor) {\n  const commandService = accessor.get(ICommandService);\n  return {\n    id: SetInlineFormatItalicCommand.id,\n    type: MenuItemType.BUTTON,\n    icon: \"ItalicSingle\",\n    title: \"Set italic\",\n    tooltip: \"toolbar.italic\",\n    activated$: new Observable((subscriber) => {\n      const disposable = commandService.onCommandExecuted((c) => {\n        var _a28;\n        const id = c.id;\n        if (id === SetTextSelectionsOperation.id || id === SetInlineFormatCommand.id) {\n          const textRun = getFontStyleAtCursor(accessor);\n          if (textRun == null) {\n            subscriber.next(!1);\n            return;\n          }\n          const it = (_a28 = textRun.ts) == null ? void 0 : _a28.it;\n          subscriber.next(it === BooleanNumber.TRUE);\n        }\n      });\n      return subscriber.next(!1), disposable.dispose;\n    }),\n    disabled$: disableMenuWhenNoDocRange(accessor),\n    hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC)\n  };\n}\n__name(ItalicMenuItemFactory, \"ItalicMenuItemFactory\");\nfunction UnderlineMenuItemFactory(accessor) {\n  const commandService = accessor.get(ICommandService);\n  return {\n    id: SetInlineFormatUnderlineCommand.id,\n    type: MenuItemType.BUTTON,\n    icon: \"UnderlineSingle\",\n    title: \"Set underline\",\n    tooltip: \"toolbar.underline\",\n    activated$: new Observable((subscriber) => {\n      const disposable = commandService.onCommandExecuted((c) => {\n        var _a28;\n        const id = c.id;\n        if (id === SetTextSelectionsOperation.id || id === SetInlineFormatCommand.id) {\n          const textRun = getFontStyleAtCursor(accessor);\n          if (textRun == null) {\n            subscriber.next(!1);\n            return;\n          }\n          const ul = (_a28 = textRun.ts) == null ? void 0 : _a28.ul;\n          subscriber.next((ul == null ? void 0 : ul.s) === BooleanNumber.TRUE);\n        }\n      });\n      return subscriber.next(!1), disposable.dispose;\n    }),\n    disabled$: disableMenuWhenNoDocRange(accessor),\n    hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC)\n  };\n}\n__name(UnderlineMenuItemFactory, \"UnderlineMenuItemFactory\");\nfunction StrikeThroughMenuItemFactory(accessor) {\n  const commandService = accessor.get(ICommandService);\n  return {\n    id: SetInlineFormatStrikethroughCommand.id,\n    type: MenuItemType.BUTTON,\n    icon: \"StrikethroughSingle\",\n    title: \"Set strike through\",\n    tooltip: \"toolbar.strikethrough\",\n    activated$: new Observable((subscriber) => {\n      const disposable = commandService.onCommandExecuted((c) => {\n        var _a28;\n        const id = c.id;\n        if (id === SetTextSelectionsOperation.id || id === SetInlineFormatCommand.id) {\n          const textRun = getFontStyleAtCursor(accessor);\n          if (textRun == null) {\n            subscriber.next(!1);\n            return;\n          }\n          const st = (_a28 = textRun.ts) == null ? void 0 : _a28.st;\n          subscriber.next((st == null ? void 0 : st.s) === BooleanNumber.TRUE);\n        }\n      });\n      return subscriber.next(!1), disposable.dispose;\n    }),\n    disabled$: disableMenuWhenNoDocRange(accessor),\n    hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC)\n  };\n}\n__name(StrikeThroughMenuItemFactory, \"StrikeThroughMenuItemFactory\");\nfunction SubscriptMenuItemFactory(accessor) {\n  const commandService = accessor.get(ICommandService);\n  return {\n    id: SetInlineFormatSubscriptCommand.id,\n    type: MenuItemType.BUTTON,\n    icon: \"SubscriptSingle\",\n    tooltip: \"toolbar.subscript\",\n    activated$: new Observable((subscriber) => {\n      const disposable = commandService.onCommandExecuted((c) => {\n        var _a28;\n        const id = c.id;\n        if (id === SetTextSelectionsOperation.id || id === SetInlineFormatCommand.id) {\n          const textRun = getFontStyleAtCursor(accessor);\n          if (textRun == null) {\n            subscriber.next(!1);\n            return;\n          }\n          const va = (_a28 = textRun.ts) == null ? void 0 : _a28.va;\n          subscriber.next(va === BaselineOffset.SUBSCRIPT);\n        }\n      });\n      return subscriber.next(!1), disposable.dispose;\n    }),\n    disabled$: disableMenuWhenNoDocRange(accessor),\n    hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC)\n  };\n}\n__name(SubscriptMenuItemFactory, \"SubscriptMenuItemFactory\");\nfunction SuperscriptMenuItemFactory(accessor) {\n  const commandService = accessor.get(ICommandService);\n  return {\n    id: SetInlineFormatSuperscriptCommand.id,\n    type: MenuItemType.BUTTON,\n    icon: \"SuperscriptSingle\",\n    tooltip: \"toolbar.superscript\",\n    activated$: new Observable((subscriber) => {\n      const disposable = commandService.onCommandExecuted((c) => {\n        var _a28;\n        const id = c.id;\n        if (id === SetTextSelectionsOperation.id || id === SetInlineFormatCommand.id) {\n          const textRun = getFontStyleAtCursor(accessor);\n          if (textRun == null) {\n            subscriber.next(!1);\n            return;\n          }\n          const va = (_a28 = textRun.ts) == null ? void 0 : _a28.va;\n          subscriber.next(va === BaselineOffset.SUPERSCRIPT);\n        }\n      });\n      return subscriber.next(!1), disposable.dispose;\n    }),\n    disabled$: disableMenuWhenNoDocRange(accessor),\n    hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC)\n  };\n}\n__name(SuperscriptMenuItemFactory, \"SuperscriptMenuItemFactory\");\nfunction FontFamilySelectorMenuItemFactory(accessor) {\n  const commandService = accessor.get(ICommandService);\n  return {\n    id: SetInlineFormatFontFamilyCommand.id,\n    tooltip: \"toolbar.font\",\n    type: MenuItemType.SELECTOR,\n    label: FONT_FAMILY_COMPONENT,\n    selections: FONT_FAMILY_LIST.map((item) => ({\n      label: {\n        name: FONT_FAMILY_ITEM_COMPONENT,\n        hoverable: !0\n      },\n      value: item.value\n    })),\n    // disabled$: getCurrentSheetDisabled$(accessor),\n    value$: new Observable((subscriber) => {\n      const defaultValue = FONT_FAMILY_LIST[0].value, disposable = commandService.onCommandExecuted((c) => {\n        var _a28;\n        const id = c.id;\n        if (id === SetTextSelectionsOperation.id || id === SetInlineFormatFontFamilyCommand.id) {\n          const textRun = getFontStyleAtCursor(accessor);\n          if (textRun == null) {\n            subscriber.next(defaultValue);\n            return;\n          }\n          const ff = (_a28 = textRun.ts) == null ? void 0 : _a28.ff;\n          subscriber.next(ff != null ? ff : defaultValue);\n        }\n      });\n      return subscriber.next(defaultValue), disposable.dispose;\n    }),\n    disabled$: disableMenuWhenNoDocRange(accessor),\n    hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC)\n  };\n}\n__name(FontFamilySelectorMenuItemFactory, \"FontFamilySelectorMenuItemFactory\");\nfunction FontSizeSelectorMenuItemFactory(accessor) {\n  const commandService = accessor.get(ICommandService);\n  return {\n    id: SetInlineFormatFontSizeCommand.id,\n    type: MenuItemType.SELECTOR,\n    tooltip: \"toolbar.fontSize\",\n    label: {\n      name: FONT_SIZE_COMPONENT,\n      props: {\n        min: 1,\n        max: 400\n        // disabled$,\n      }\n    },\n    selections: FONT_SIZE_LIST,\n    // disabled$,\n    value$: new Observable((subscriber) => {\n      const disposable = commandService.onCommandExecuted((c) => {\n        var _a28;\n        const id = c.id;\n        if (id === SetTextSelectionsOperation.id || id === SetInlineFormatFontSizeCommand.id) {\n          const textRun = getFontStyleAtCursor(accessor);\n          if (textRun == null) {\n            subscriber.next(14);\n            return;\n          }\n          const fs = (_a28 = textRun.ts) == null ? void 0 : _a28.fs;\n          subscriber.next(fs != null ? fs : 14);\n        }\n      });\n      return subscriber.next(14), disposable.dispose;\n    }),\n    disabled$: disableMenuWhenNoDocRange(accessor),\n    hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC)\n  };\n}\n__name(FontSizeSelectorMenuItemFactory, \"FontSizeSelectorMenuItemFactory\");\nfunction TextColorSelectorMenuItemFactory(accessor) {\n  const commandService = accessor.get(ICommandService), themeService = accessor.get(ThemeService);\n  return {\n    id: SetInlineFormatTextColorCommand.id,\n    icon: \"FontColor\",\n    tooltip: \"toolbar.textColor.main\",\n    type: MenuItemType.BUTTON_SELECTOR,\n    selections: [\n      {\n        label: {\n          name: COLOR_PICKER_COMPONENT,\n          hoverable: !1\n        }\n      }\n    ],\n    value$: new Observable((subscriber) => {\n      const defaultColor = themeService.getCurrentTheme().textColor, disposable = commandService.onCommandExecuted((c) => {\n        if (c.id === SetInlineFormatTextColorCommand.id) {\n          const color = c.params.value;\n          subscriber.next(color != null ? color : defaultColor);\n        }\n      });\n      return subscriber.next(defaultColor), disposable.dispose;\n    }),\n    disabled$: disableMenuWhenNoDocRange(accessor),\n    hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC)\n    // disabled$: getCurrentSheetDisabled$(accessor),\n  };\n}\n__name(TextColorSelectorMenuItemFactory, \"TextColorSelectorMenuItemFactory\");\nfunction HeaderFooterMenuItemFactory(accessor) {\n  return {\n    id: OpenHeaderFooterPanelCommand.id,\n    type: MenuItemType.BUTTON,\n    icon: \"FreezeRowSingle\",\n    tooltip: \"toolbar.headerFooter\",\n    hidden$: combineLatest(getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC), getHeaderFooterMenuHiddenObservable(accessor), (one, two) => one || two)\n  };\n}\n__name(HeaderFooterMenuItemFactory, \"HeaderFooterMenuItemFactory\");\nconst TableIcon = \"GridSingle\", TABLE_MENU_ID = \"doc.menu.table\";\nfunction TableMenuFactory(accessor) {\n  return {\n    id: TABLE_MENU_ID,\n    type: MenuItemType.SUBITEMS,\n    icon: TableIcon,\n    tooltip: \"toolbar.table.main\",\n    disabled$: getTableDisabledObservable(accessor),\n    // Do not show header footer menu and insert table at zen mode.\n    hidden$: combineLatest(getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC), getInsertTableHiddenObservable(accessor), getHeaderFooterMenuHiddenObservable(accessor), (one, two, three) => one || two || three)\n  };\n}\n__name(TableMenuFactory, \"TableMenuFactory\");\nfunction InsertTableMenuFactory(_accessor) {\n  return {\n    id: DocCreateTableOperation.id,\n    title: \"toolbar.table.insert\",\n    type: MenuItemType.BUTTON,\n    hidden$: getMenuHiddenObservable(_accessor, UniverInstanceType.UNIVER_DOC)\n  };\n}\n__name(InsertTableMenuFactory, \"InsertTableMenuFactory\");\nfunction AlignLeftMenuItemFactory(accessor) {\n  const commandService = accessor.get(ICommandService);\n  return {\n    id: AlignLeftCommand.id,\n    type: MenuItemType.BUTTON,\n    icon: \"LeftJustifyingSingle\",\n    tooltip: \"toolbar.alignLeft\",\n    disabled$: disableMenuWhenNoDocRange(accessor),\n    activated$: new Observable((subscriber) => {\n      const disposable = commandService.onCommandExecuted((c) => {\n        var _a28;\n        const id = c.id;\n        if (id === SetTextSelectionsOperation.id || id === AlignOperationCommand.id) {\n          const paragraph = getParagraphStyleAtCursor(accessor);\n          if (paragraph == null)\n            return;\n          const alignType = (_a28 = paragraph.paragraphStyle) == null ? void 0 : _a28.horizontalAlign;\n          subscriber.next(alignType === HorizontalAlign.LEFT);\n        }\n      });\n      return subscriber.next(!1), disposable.dispose;\n    }),\n    hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC)\n  };\n}\n__name(AlignLeftMenuItemFactory, \"AlignLeftMenuItemFactory\");\nfunction AlignCenterMenuItemFactory(accessor) {\n  const commandService = accessor.get(ICommandService);\n  return {\n    id: AlignCenterCommand.id,\n    type: MenuItemType.BUTTON,\n    icon: \"HorizontallySingle\",\n    tooltip: \"toolbar.alignCenter\",\n    activated$: new Observable((subscriber) => {\n      const disposable = commandService.onCommandExecuted((c) => {\n        var _a28;\n        const id = c.id;\n        if (id === SetTextSelectionsOperation.id || id === AlignOperationCommand.id) {\n          const paragraph = getParagraphStyleAtCursor(accessor);\n          if (paragraph == null)\n            return;\n          const alignType = (_a28 = paragraph.paragraphStyle) == null ? void 0 : _a28.horizontalAlign;\n          subscriber.next(alignType === HorizontalAlign.CENTER);\n        }\n      });\n      return subscriber.next(!1), disposable.dispose;\n    }),\n    disabled$: disableMenuWhenNoDocRange(accessor),\n    hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC)\n  };\n}\n__name(AlignCenterMenuItemFactory, \"AlignCenterMenuItemFactory\");\nfunction AlignRightMenuItemFactory(accessor) {\n  const commandService = accessor.get(ICommandService);\n  return {\n    id: AlignRightCommand.id,\n    type: MenuItemType.BUTTON,\n    icon: \"RightJustifyingSingle\",\n    tooltip: \"toolbar.alignRight\",\n    activated$: new Observable((subscriber) => {\n      const disposable = commandService.onCommandExecuted((c) => {\n        var _a28;\n        const id = c.id;\n        if (id === SetTextSelectionsOperation.id || id === AlignOperationCommand.id) {\n          const paragraph = getParagraphStyleAtCursor(accessor);\n          if (paragraph == null)\n            return;\n          const alignType = (_a28 = paragraph.paragraphStyle) == null ? void 0 : _a28.horizontalAlign;\n          subscriber.next(alignType === HorizontalAlign.RIGHT);\n        }\n      });\n      return subscriber.next(!1), disposable.dispose;\n    }),\n    disabled$: disableMenuWhenNoDocRange(accessor),\n    hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC)\n  };\n}\n__name(AlignRightMenuItemFactory, \"AlignRightMenuItemFactory\");\nfunction AlignJustifyMenuItemFactory(accessor) {\n  const commandService = accessor.get(ICommandService);\n  return {\n    id: AlignJustifyCommand.id,\n    type: MenuItemType.BUTTON,\n    icon: \"AlignTextBothSingle\",\n    tooltip: \"toolbar.alignJustify\",\n    activated$: new Observable((subscriber) => {\n      const disposable = commandService.onCommandExecuted((c) => {\n        var _a28;\n        const id = c.id;\n        if (id === SetTextSelectionsOperation.id || id === AlignOperationCommand.id) {\n          const paragraph = getParagraphStyleAtCursor(accessor);\n          if (paragraph == null)\n            return;\n          const alignType = (_a28 = paragraph.paragraphStyle) == null ? void 0 : _a28.horizontalAlign;\n          subscriber.next(alignType === HorizontalAlign.JUSTIFIED);\n        }\n      });\n      return subscriber.next(!1), disposable.dispose;\n    }),\n    disabled$: disableMenuWhenNoDocRange(accessor),\n    hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC)\n  };\n}\n__name(AlignJustifyMenuItemFactory, \"AlignJustifyMenuItemFactory\");\nconst listValueFactory$ = /* @__PURE__ */ __name((accessor) => new Observable((subscriber) => {\n  const univerInstanceService = accessor.get(IUniverInstanceService), docSelectionManagerService = accessor.get(DocSelectionManagerService);\n  let textSubscription;\n  const subscription = univerInstanceService.focused$.subscribe((unitId) => {\n    if (textSubscription == null || textSubscription.unsubscribe(), unitId == null)\n      return;\n    const docDataModel = univerInstanceService.getUniverDocInstance(unitId);\n    docDataModel != null && (textSubscription = docSelectionManagerService.textSelection$.subscribe(() => {\n      var _a28, _b;\n      const range = docSelectionManagerService.getActiveTextRange();\n      if (range) {\n        const doc = docDataModel.getSelfOrHeaderFooterModel(range == null ? void 0 : range.segmentId), paragraphs = getParagraphsInRange(range, (_b = (_a28 = doc.getBody()) == null ? void 0 : _a28.paragraphs) != null ? _b : []);\n        let listType;\n        if (paragraphs.every((p2) => {\n          var _a29;\n          return listType || (listType = (_a29 = p2.bullet) == null ? void 0 : _a29.listType), p2.bullet && p2.bullet.listType === listType;\n        })) {\n          subscriber.next(listType);\n          return;\n        }\n      }\n      subscriber.next(void 0);\n    }));\n  });\n  return () => {\n    subscription.unsubscribe(), textSubscription == null || textSubscription.unsubscribe();\n  };\n}), \"listValueFactory$\");\nfunction OrderListMenuItemFactory(accessor) {\n  return {\n    id: OrderListCommand.id,\n    type: MenuItemType.BUTTON_SELECTOR,\n    selections: [\n      {\n        label: {\n          name: ORDER_LIST_TYPE_COMPONENT,\n          hoverable: !1\n        },\n        value$: listValueFactory$(accessor)\n      }\n    ],\n    icon: \"OrderSingle\",\n    tooltip: \"toolbar.order\",\n    hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC),\n    disabled$: disableMenuWhenNoDocRange(accessor),\n    activated$: listValueFactory$(accessor).pipe(map$1((v) => v && v.indexOf(\"ORDER_LIST\") === 0))\n  };\n}\n__name(OrderListMenuItemFactory, \"OrderListMenuItemFactory\");\nfunction BulletListMenuItemFactory(accessor) {\n  return {\n    id: BulletListCommand.id,\n    type: MenuItemType.BUTTON_SELECTOR,\n    selections: [\n      {\n        label: {\n          name: BULLET_LIST_TYPE_COMPONENT,\n          hoverable: !1\n        },\n        value$: listValueFactory$(accessor)\n      }\n    ],\n    icon: \"UnorderSingle\",\n    tooltip: \"toolbar.unorder\",\n    disabled$: disableMenuWhenNoDocRange(accessor),\n    hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC),\n    activated$: listValueFactory$(accessor).pipe(map$1((v) => v && v.indexOf(\"BULLET_LIST\") === 0))\n  };\n}\n__name(BulletListMenuItemFactory, \"BulletListMenuItemFactory\");\nfunction CheckListMenuItemFactory(accessor) {\n  return {\n    id: CheckListCommand.id,\n    type: MenuItemType.BUTTON,\n    icon: \"TodoList\",\n    tooltip: \"toolbar.checklist\",\n    disabled$: disableMenuWhenNoDocRange(accessor),\n    hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC),\n    activated$: listValueFactory$(accessor).pipe(map$1((v) => v && v.indexOf(\"CHECK_LIST\") === 0))\n  };\n}\n__name(CheckListMenuItemFactory, \"CheckListMenuItemFactory\");\nfunction ResetBackgroundColorMenuItemFactory(accessor) {\n  return {\n    id: ResetInlineFormatTextBackgroundColorCommand.id,\n    type: MenuItemType.BUTTON,\n    title: \"toolbar.resetColor\",\n    icon: \"NoColor\"\n  };\n}\n__name(ResetBackgroundColorMenuItemFactory, \"ResetBackgroundColorMenuItemFactory\");\nfunction BackgroundColorSelectorMenuItemFactory(accessor) {\n  const commandService = accessor.get(ICommandService), themeService = accessor.get(ThemeService);\n  return {\n    id: SetInlineFormatTextBackgroundColorCommand.id,\n    tooltip: \"toolbar.fillColor.main\",\n    type: MenuItemType.BUTTON_SELECTOR,\n    icon: \"PaintBucket\",\n    selections: [\n      {\n        label: {\n          name: COLOR_PICKER_COMPONENT,\n          hoverable: !1\n        }\n      }\n    ],\n    value$: new Observable((subscriber) => {\n      const defaultColor = themeService.getCurrentTheme().primaryColor, disposable = commandService.onCommandExecuted((c) => {\n        if (c.id === SetInlineFormatTextBackgroundColorCommand.id) {\n          const color = c.params.value;\n          subscriber.next(color != null ? color : defaultColor);\n        }\n      });\n      return subscriber.next(defaultColor), disposable.dispose;\n    }),\n    disabled$: disableMenuWhenNoDocRange(accessor),\n    hidden$: getMenuHiddenObservable(accessor, UniverInstanceType.UNIVER_DOC)\n  };\n}\n__name(BackgroundColorSelectorMenuItemFactory, \"BackgroundColorSelectorMenuItemFactory\");\nfunction getFontStyleAtCursor(accessor) {\n  var _a28;\n  const univerInstanceService = accessor.get(IUniverInstanceService), textSelectionService = accessor.get(DocSelectionManagerService), docDataModel = univerInstanceService.getCurrentUniverDocInstance(), activeTextRange = textSelectionService.getActiveTextRange();\n  if (docDataModel == null || activeTextRange == null)\n    return;\n  const { startOffset, segmentId } = activeTextRange, textRuns = (_a28 = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()) == null ? void 0 : _a28.textRuns;\n  if (textRuns == null)\n    return;\n  let textRun;\n  for (let i = textRuns.length - 1; i >= 0; i--) {\n    const curTextRun = textRuns[i];\n    if (curTextRun.st <= startOffset && startOffset <= curTextRun.ed) {\n      textRun = curTextRun;\n      break;\n    }\n  }\n  return textRun;\n}\n__name(getFontStyleAtCursor, \"getFontStyleAtCursor\");\nfunction getParagraphStyleAtCursor(accessor) {\n  var _a28;\n  const univerInstanceService = accessor.get(IUniverInstanceService), textSelectionService = accessor.get(DocSelectionManagerService), docDataModel = univerInstanceService.getCurrentUniverDocInstance(), activeTextRange = textSelectionService.getActiveTextRange();\n  if (docDataModel == null || activeTextRange == null)\n    return;\n  const { startOffset, segmentId } = activeTextRange, paragraphs = (_a28 = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody()) == null ? void 0 : _a28.paragraphs;\n  if (paragraphs == null)\n    return;\n  let prevIndex = -1;\n  for (const paragraph of paragraphs) {\n    const { startIndex } = paragraph;\n    if (startOffset > prevIndex && startOffset <= startIndex)\n      return paragraph;\n    prevIndex = startIndex;\n  }\n  return null;\n}\n__name(getParagraphStyleAtCursor, \"getParagraphStyleAtCursor\");\nconst menuSchema = {\n  [RibbonStartGroup.FORMAT]: {\n    [SetInlineFormatBoldCommand.id]: {\n      order: 0,\n      menuItemFactory: BoldMenuItemFactory\n    },\n    [SetInlineFormatItalicCommand.id]: {\n      order: 1,\n      menuItemFactory: ItalicMenuItemFactory\n    },\n    [SetInlineFormatUnderlineCommand.id]: {\n      order: 2,\n      menuItemFactory: UnderlineMenuItemFactory\n    },\n    [SetInlineFormatStrikethroughCommand.id]: {\n      order: 3,\n      menuItemFactory: StrikeThroughMenuItemFactory\n    },\n    [SetInlineFormatSubscriptCommand.id]: {\n      order: 4,\n      menuItemFactory: SubscriptMenuItemFactory\n    },\n    [SetInlineFormatSuperscriptCommand.id]: {\n      order: 5,\n      menuItemFactory: SuperscriptMenuItemFactory\n    },\n    [SetInlineFormatFontSizeCommand.id]: {\n      order: 6,\n      menuItemFactory: FontSizeSelectorMenuItemFactory\n    },\n    [SetInlineFormatFontFamilyCommand.id]: {\n      order: 7,\n      menuItemFactory: FontFamilySelectorMenuItemFactory\n    },\n    [SetInlineFormatTextColorCommand.id]: {\n      order: 8,\n      menuItemFactory: TextColorSelectorMenuItemFactory\n    },\n    [SetInlineFormatTextBackgroundColorCommand.id]: {\n      order: 9,\n      menuItemFactory: BackgroundColorSelectorMenuItemFactory,\n      [ResetInlineFormatTextBackgroundColorCommand.id]: {\n        order: 0,\n        menuItemFactory: ResetBackgroundColorMenuItemFactory\n      }\n    }\n  },\n  [RibbonStartGroup.LAYOUT]: {\n    [TABLE_MENU_ID]: {\n      order: 1,\n      menuItemFactory: TableMenuFactory,\n      [DocCreateTableOperation.id]: {\n        order: 0,\n        menuItemFactory: InsertTableMenuFactory\n      }\n    },\n    [AlignLeftCommand.id]: {\n      order: 2,\n      menuItemFactory: AlignLeftMenuItemFactory\n    },\n    [AlignCenterCommand.id]: {\n      order: 3,\n      menuItemFactory: AlignCenterMenuItemFactory\n    },\n    [AlignRightCommand.id]: {\n      order: 4,\n      menuItemFactory: AlignRightMenuItemFactory\n    },\n    [AlignJustifyCommand.id]: {\n      order: 5,\n      menuItemFactory: AlignJustifyMenuItemFactory\n    },\n    [OrderListCommand.id]: {\n      order: 6,\n      menuItemFactory: OrderListMenuItemFactory\n    },\n    [BulletListCommand.id]: {\n      order: 7,\n      menuItemFactory: BulletListMenuItemFactory\n    },\n    [CheckListCommand.id]: {\n      order: 8,\n      menuItemFactory: CheckListMenuItemFactory\n    },\n    [OpenHeaderFooterPanelCommand.id]: {\n      order: 9,\n      menuItemFactory: HeaderFooterMenuItemFactory\n    }\n  },\n  [ContextMenuPosition.MAIN_AREA]: {\n    [ContextMenuGroup.FORMAT]: {\n      [DocCopyCommand.name]: {\n        order: 0,\n        menuItemFactory: CopyMenuFactory\n      },\n      [DocCutCommand.id]: {\n        order: 1,\n        menuItemFactory: CutMenuFactory\n      },\n      [DocPasteCommand.id]: {\n        order: 2,\n        menuItemFactory: PasteMenuFactory\n      },\n      [DeleteLeftCommand.id]: {\n        order: 3,\n        menuItemFactory: DeleteMenuFactory\n      }\n    },\n    [ContextMenuGroup.LAYOUT]: {\n      [DocParagraphSettingPanelOperation.id]: {\n        order: 0,\n        menuItemFactory: ParagraphSettingMenuFactory\n      },\n      [TABLE_INSERT_MENU_ID]: {\n        order: 1,\n        menuItemFactory: TableInsertMenuItemFactory,\n        [DocTableInsertRowAboveCommand.id]: {\n          order: 1,\n          menuItemFactory: InsertRowBeforeMenuItemFactory\n        },\n        [DocTableInsertRowBellowCommand.id]: {\n          order: 2,\n          menuItemFactory: InsertRowAfterMenuItemFactory\n        },\n        [DocTableInsertColumnLeftCommand.id]: {\n          order: 3,\n          menuItemFactory: InsertColumnLeftMenuItemFactory\n        },\n        [DocTableInsertColumnRightCommand.id]: {\n          order: 4,\n          menuItemFactory: InsertColumnRightMenuItemFactory\n        }\n      },\n      [TABLE_DELETE_MENU_ID]: {\n        order: 2,\n        menuItemFactory: TableDeleteMenuItemFactory,\n        [DocTableDeleteRowsCommand.id]: {\n          order: 1,\n          menuItemFactory: DeleteRowsMenuItemFactory\n        },\n        [DocTableDeleteColumnsCommand.id]: {\n          order: 2,\n          menuItemFactory: DeleteColumnsMenuItemFactory\n        },\n        [DocTableDeleteTableCommand.id]: {\n          order: 3,\n          menuItemFactory: DeleteTableMenuItemFactory\n        }\n      }\n    }\n  }\n};\nvar __defProp$l = Object.defineProperty, __getOwnPropDesc$l = Object.getOwnPropertyDescriptor, __decorateClass$l = /* @__PURE__ */ __name((decorators, target, key, kind) => {\n  for (var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$l(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)\n    (decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n  return kind && result && __defProp$l(target, key, result), result;\n}, \"__decorateClass$l\"), __decorateParam$l = /* @__PURE__ */ __name((index, decorator) => (target, key) => decorator(target, key, index), \"__decorateParam$l\"), _a6;\nlet DocUIController = (_a6 = class extends Disposable {\n  constructor(_injector, _componentManager, _commandService, _layoutService, _menuManagerService, _uiPartsService, _univerInstanceService, _shortcutService, _configService) {\n    super(), this._injector = _injector, this._componentManager = _componentManager, this._commandService = _commandService, this._layoutService = _layoutService, this._menuManagerService = _menuManagerService, this._uiPartsService = _uiPartsService, this._univerInstanceService = _univerInstanceService, this._shortcutService = _shortcutService, this._configService = _configService, this._init();\n  }\n  _initCustomComponents() {\n    const componentManager = this._componentManager;\n    this.disposeWithMe(componentManager.register(COLOR_PICKER_COMPONENT, ColorPicker)), this.disposeWithMe(componentManager.register(FONT_FAMILY_COMPONENT, FontFamily)), this.disposeWithMe(componentManager.register(FONT_FAMILY_ITEM_COMPONENT, FontFamilyItem)), this.disposeWithMe(componentManager.register(FONT_SIZE_COMPONENT, FontSize)), this.disposeWithMe(componentManager.register(BULLET_LIST_TYPE_COMPONENT, BulletListTypePicker)), this.disposeWithMe(componentManager.register(ORDER_LIST_TYPE_COMPONENT, OrderListTypePicker)), this.disposeWithMe(componentManager.register(\"TodoList\", TodoList));\n  }\n  // TODO: @zhangwei, why add workbook to docs-ui?\n  _initUiParts() {\n    var _a28, _b;\n    const workbook = this._univerInstanceService.getCurrentUnitForType(UniverInstanceType.UNIVER_SHEET), config = this._configService.getConfig(PLUGIN_CONFIG_KEY);\n    (_b = (_a28 = config == null ? void 0 : config.layout) == null ? void 0 : _a28.docContainerConfig) != null && _b.footer && !workbook && this.disposeWithMe(this._uiPartsService.registerComponent(BuiltInUIPart.FOOTER, () => connectInjector(DocFooter, this._injector)));\n  }\n  _initMenus() {\n    this._menuManagerService.mergeMenu(menuSchema);\n  }\n  _initShortCut() {\n    [\n      BoldShortCut,\n      ItalicShortCut,\n      UnderlineShortCut,\n      StrikeThroughShortCut,\n      SubscriptShortCut,\n      SuperscriptShortCut,\n      AlignCenterShortCut,\n      AlignJustifyShortCut,\n      AlignRightShortCut,\n      AlignLeftShortCut,\n      OrderListShortCut,\n      BulletListShortCut,\n      TabShortCut\n    ].forEach((shortcut) => {\n      this.disposeWithMe(this._shortcutService.registerShortcut(shortcut));\n    });\n  }\n  _init() {\n    this._initCustomComponents(), this._initMenus(), this._initFocusHandler(), this._initCommands(), this._initUiParts(), this._initShortCut();\n  }\n  _initCommands() {\n    [\n      CoreHeaderFooterCommand,\n      OpenHeaderFooterPanelCommand,\n      SidebarDocHeaderFooterPanelOperation\n    ].forEach((command) => this.disposeWithMe(this._commandService.registerCommand(command)));\n  }\n  _initFocusHandler() {\n    this.disposeWithMe(\n      this._layoutService.registerFocusHandler(UniverInstanceType.UNIVER_DOC, (unitId) => {\n        this._injector.get(IRenderManagerService).getRenderById(unitId).with(DocSelectionRenderService).focus();\n      })\n    );\n  }\n}, __name(_a6, \"DocUIController\"), _a6);\nDocUIController = __decorateClass$l([\n  OnLifecycle(LifecycleStages.Rendered, DocUIController),\n  __decorateParam$l(0, Inject(Injector)),\n  __decorateParam$l(1, Inject(ComponentManager)),\n  __decorateParam$l(2, ICommandService),\n  __decorateParam$l(3, ILayoutService),\n  __decorateParam$l(4, IMenuManagerService),\n  __decorateParam$l(5, IUIPartsService),\n  __decorateParam$l(6, IUniverInstanceService),\n  __decorateParam$l(7, IShortcutService),\n  __decorateParam$l(8, IConfigService)\n], DocUIController);\nvar __defProp$k = Object.defineProperty, __getOwnPropDesc$k = Object.getOwnPropertyDescriptor, __decorateClass$k = /* @__PURE__ */ __name((decorators, target, key, kind) => {\n  for (var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$k(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)\n    (decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n  return kind && result && __defProp$k(target, key, result), result;\n}, \"__decorateClass$k\"), __decorateParam$k = /* @__PURE__ */ __name((index, decorator) => (target, key) => decorator(target, key, index), \"__decorateParam$k\");\nconst ANCHOR_WIDTH = 1.5;\nvar _a7;\nlet DocBackScrollRenderController = (_a7 = class extends RxDisposable {\n  constructor(_context, _textSelectionManagerService, _editorService, _docSkeletonManagerService) {\n    super(), this._context = _context, this._textSelectionManagerService = _textSelectionManagerService, this._editorService = _editorService, this._docSkeletonManagerService = _docSkeletonManagerService, this._init();\n  }\n  _init() {\n    this._textSelectionManagerService.textSelection$.pipe(takeUntil(this.dispose$)).subscribe((params) => {\n      if (params == null)\n        return;\n      const { isEditing, unitId } = params;\n      unitId !== this._context.unitId || !isEditing || this._scrollToSelection();\n    });\n  }\n  scrollToRange(range) {\n    const skeleton = this._docSkeletonManagerService.getSkeleton();\n    if (!skeleton)\n      return;\n    const { startOffset } = range, anchorNodePosition = skeleton.findNodePositionByCharIndex(startOffset);\n    this.scrollToNode(anchorNodePosition);\n  }\n  scrollToNode(startNodePosition) {\n    const { unitId, scene, mainComponent } = this._context, skeleton = this._docSkeletonManagerService.getSkeleton();\n    if (mainComponent == null || skeleton == null)\n      return;\n    const documentOffsetConfig = mainComponent.getOffsetConfig(), { docsLeft, docsTop } = documentOffsetConfig, convertor = new NodePositionConvertToCursor(documentOffsetConfig, skeleton), { contentBoxPointGroup } = convertor.getRangePointData(startNodePosition, startNodePosition), { left: aLeft, top: aTop, height } = getAnchorBounding(contentBoxPointGroup), left = aLeft + docsLeft, top = aTop + docsTop, viewportMain = scene.getViewport(VIEWPORT_KEY.VIEW_MAIN), isEditor = !!this._editorService.getEditor(unitId);\n    if (viewportMain == null)\n      return;\n    const {\n      left: boundLeft,\n      top: boundTop,\n      right: boundRight,\n      bottom: boundBottom\n    } = viewportMain.getBounding().viewBound;\n    let offsetY = 0, offsetX = 0;\n    const delta = isEditor ? 0 : 100;\n    top < boundTop ? offsetY = top - boundTop - delta : top > boundBottom - height && (offsetY = top - boundBottom + height + delta), left < boundLeft ? offsetX = left - boundLeft : left > boundRight - ANCHOR_WIDTH && (offsetX = left - boundRight + ANCHOR_WIDTH);\n    const config = viewportMain.transViewportScroll2ScrollValue(offsetX, offsetY);\n    viewportMain.scrollByBarDeltaValue(config);\n  }\n  // Let the selection show on the current screen.\n  _scrollToSelection() {\n    const activeTextRange = this._textSelectionManagerService.getActiveTextRange();\n    if (activeTextRange == null)\n      return;\n    const { collapsed, startNodePosition } = activeTextRange;\n    collapsed && this.scrollToNode(startNodePosition);\n  }\n}, __name(_a7, \"DocBackScrollRenderController\"), _a7);\nDocBackScrollRenderController = __decorateClass$k([\n  __decorateParam$k(1, Inject(DocSelectionManagerService)),\n  __decorateParam$k(2, IEditorService),\n  __decorateParam$k(3, Inject(DocSkeletonManagerService))\n], DocBackScrollRenderController);\nvar __defProp$j = Object.defineProperty, __getOwnPropDesc$j = Object.getOwnPropertyDescriptor, __decorateClass$j = /* @__PURE__ */ __name((decorators, target, key, kind) => {\n  for (var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$j(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)\n    (decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n  return kind && result && __defProp$j(target, key, result), result;\n}, \"__decorateClass$j\"), __decorateParam$j = /* @__PURE__ */ __name((index, decorator) => (target, key) => decorator(target, key, index), \"__decorateParam$j\"), _a8;\nlet DocRenderController = (_a8 = class extends RxDisposable {\n  constructor(_context, _contextService, _commandService, _docSelectionRenderService, _docSkeletonManagerService, _editorService, _renderManagerService) {\n    super(), this._context = _context, this._contextService = _contextService, this._commandService = _commandService, this._docSelectionRenderService = _docSelectionRenderService, this._docSkeletonManagerService = _docSkeletonManagerService, this._editorService = _editorService, this._renderManagerService = _renderManagerService, this._addNewRender(), this._initRenderRefresh(), this._initCommandListener();\n  }\n  reRender(unitId) {\n    var _a28, _b;\n    const docSkeletonManagerService = (_a28 = this._renderManagerService.getRenderById(unitId)) == null ? void 0 : _a28.with(DocSkeletonManagerService), skeleton = docSkeletonManagerService == null ? void 0 : docSkeletonManagerService.getSkeleton();\n    if (!(!skeleton || skeleton.getViewModel().getDataModel().getSnapshot().disabled)) {\n      if (skeleton.calculate(), this._editorService.isEditor(unitId)) {\n        (_b = this._context.mainComponent) == null || _b.makeDirty();\n        return;\n      }\n      this._recalculateSizeBySkeleton(skeleton);\n    }\n  }\n  _addNewRender() {\n    const { scene, engine } = this._context, viewMain = new Viewport(VIEWPORT_KEY.VIEW_MAIN, scene, {\n      left: 0,\n      top: 0,\n      bottom: 0,\n      right: 0,\n      explicitViewportWidthSet: !1,\n      explicitViewportHeightSet: !1,\n      isWheelPreventDefaultX: !0\n    });\n    scene.attachControl(), scene.onMouseWheel$.subscribeEvent((evt, state) => {\n      if (!this._contextService.getContextValue(FOCUSING_DOC))\n        return;\n      const e = evt;\n      if (e.ctrlKey) {\n        const deltaFactor = Math.abs(e.deltaX);\n        let scrollNum = deltaFactor < 40 ? 0.2 : deltaFactor < 80 ? 0.4 : 0.2;\n        scrollNum *= e.deltaY > 0 ? -1 : 1, scene.scaleX < 1 && (scrollNum /= 2), scene.scaleX + scrollNum > 4 ? scene.scale(4, 4) : scene.scaleX + scrollNum < 0.1 ? scene.scale(0.1, 0.1) : e.preventDefault();\n      } else\n        viewMain.onMouseWheel(e, state);\n    }), new ScrollBar(viewMain), scene.addLayer(\n      new Layer(scene, [], DOCS_COMPONENT_MAIN_LAYER_INDEX),\n      new Layer(scene, [], DOCS_COMPONENT_HEADER_LAYER_INDEX)\n    ), this._addComponent(), engine.runRenderLoop(() => {\n      scene.render();\n    }), this._docSelectionRenderService.__attachScrollEvent();\n  }\n  _addComponent() {\n    const { scene, unit: documentModel, components } = this._context, config = {\n      pageMarginLeft: documentModel.documentStyle.marginLeft || 0,\n      pageMarginTop: documentModel.documentStyle.marginTop || 0\n    }, documents = new Documents(DOCS_VIEW_KEY.MAIN, void 0, config);\n    documents.zIndex = DOCS_COMPONENT_DEFAULT_Z_INDEX;\n    const docBackground = new DocBackground(DOCS_VIEW_KEY.BACKGROUND, void 0, config);\n    docBackground.zIndex = DOCS_COMPONENT_DEFAULT_Z_INDEX, this._context.mainComponent = documents, components.set(DOCS_VIEW_KEY.MAIN, documents), components.set(DOCS_VIEW_KEY.BACKGROUND, docBackground), scene.addObjects([documents], DOCS_COMPONENT_MAIN_LAYER_INDEX), scene.addObjects([docBackground], DOCS_COMPONENT_BACKGROUND_LAYER_INDEX), this._editorService.getEditor(documentModel.getUnitId()) == null && scene.enableLayerCache(DOCS_COMPONENT_MAIN_LAYER_INDEX);\n  }\n  _initRenderRefresh() {\n    this._docSkeletonManagerService.currentSkeletonBefore$.pipe(takeUntil(this.dispose$)).subscribe((param) => {\n      this._create(param);\n    });\n  }\n  _create(skeleton) {\n    if (!skeleton)\n      return;\n    const { mainComponent, components } = this._context, docsComponent = mainComponent, docBackground = components.get(DOCS_VIEW_KEY.BACKGROUND);\n    docsComponent.changeSkeleton(skeleton), docBackground.changeSkeleton(skeleton), this._recalculateSizeBySkeleton(skeleton);\n  }\n  _initCommandListener() {\n    const updateCommandList = [RichTextEditingMutation.id];\n    this.disposeWithMe(this._commandService.onCommandExecuted((command) => {\n      if (updateCommandList.includes(command.id)) {\n        const params = command.params, { unitId } = params;\n        this.reRender(unitId);\n      }\n    }));\n  }\n  _recalculateSizeBySkeleton(skeleton) {\n    var _a28;\n    const { mainComponent, scene, unitId, components } = this._context, docsComponent = mainComponent, docBackground = components.get(DOCS_VIEW_KEY.BACKGROUND), pages = (_a28 = skeleton.getSkeletonData()) == null ? void 0 : _a28.pages;\n    if (pages == null)\n      return;\n    let width = 0, height = 0;\n    for (let i = 0, len = pages.length; i < len; i++) {\n      const page = pages[i], { pageWidth, pageHeight } = page;\n      docsComponent.pageLayoutType === PageLayoutType.VERTICAL ? (height += pageHeight, height += docsComponent.pageMarginTop, i === len - 1 && (height += docsComponent.pageMarginTop), width = Math.max(width, pageWidth)) : docsComponent.pageLayoutType === PageLayoutType.HORIZONTAL && (width += pageWidth, i !== len - 1 && (width += docsComponent.pageMarginLeft), height = Math.max(height, pageHeight));\n    }\n    docsComponent.resize(width, height), docBackground.resize(width, height), this._editorService.isEditor(unitId) || scene.resize(width, height);\n  }\n}, __name(_a8, \"DocRenderController\"), _a8);\nDocRenderController = __decorateClass$j([\n  __decorateParam$j(1, IContextService),\n  __decorateParam$j(2, ICommandService),\n  __decorateParam$j(3, Inject(DocSelectionRenderService)),\n  __decorateParam$j(4, Inject(DocSkeletonManagerService)),\n  __decorateParam$j(5, IEditorService),\n  __decorateParam$j(6, IRenderManagerService)\n], DocRenderController);\nvar __defProp$i = Object.defineProperty, __getOwnPropDesc$i = Object.getOwnPropertyDescriptor, __decorateClass$i = /* @__PURE__ */ __name((decorators, target, key, kind) => {\n  for (var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$i(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)\n    (decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n  return kind && result && __defProp$i(target, key, result), result;\n}, \"__decorateClass$i\"), __decorateParam$i = /* @__PURE__ */ __name((index, decorator) => (target, key) => decorator(target, key, index), \"__decorateParam$i\"), _a9;\nlet DocContainerUIController = (_a9 = class {\n  constructor(_localeService, _injector, _configService) {\n    __publicField(this, \"_docContainer\");\n    // 获取SheetContainer组件\n    __publicField(this, \"getComponent\", /* @__PURE__ */ __name((ref) => {\n      if (this._docContainer = ref, !ref.getContentRef().current)\n        throw new Error(\"container is not ready\");\n    }, \"getComponent\"));\n    /**\n     * Change language\n     * @param {string} lang new language\n     *\n     * e: {target: HTMLSelectElement } reference from  https://stackoverflow.com/a/48443771\n     *\n     */\n    __publicField(this, \"changeLocale\", /* @__PURE__ */ __name((locale) => {\n      this._localeService.setLocale(locale);\n    }, \"changeLocale\"));\n    this._localeService = _localeService, this._injector = _injector, this._configService = _configService;\n  }\n  getUIConfig() {\n    return {\n      injector: this._injector,\n      config: this._configService.getConfig(PLUGIN_CONFIG_KEY),\n      changeLocale: this.changeLocale,\n      getComponent: this.getComponent\n    };\n  }\n  getContentRef() {\n    return this._docContainer.getContentRef();\n  }\n  UIDidMount(cb) {\n    if (this._docContainer)\n      return cb(this._docContainer);\n  }\n  getDocContainer() {\n    return this._docContainer;\n  }\n}, __name(_a9, \"DocContainerUIController\"), _a9);\nDocContainerUIController = __decorateClass$i([\n  __decorateParam$i(0, Inject(LocaleService)),\n  __decorateParam$i(1, Inject(Injector)),\n  __decorateParam$i(2, IConfigService)\n], DocContainerUIController);\nvar __defProp$h = Object.defineProperty, __getOwnPropDesc$h = Object.getOwnPropertyDescriptor, __decorateClass$h = /* @__PURE__ */ __name((decorators, target, key, kind) => {\n  for (var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$h(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)\n    (decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n  return kind && result && __defProp$h(target, key, result), result;\n}, \"__decorateClass$h\"), __decorateParam$h = /* @__PURE__ */ __name((index, decorator) => (target, key) => decorator(target, key, index), \"__decorateParam$h\"), _a10;\nlet AppUIController = (_a10 = class extends RxDisposable {\n  constructor(_injector) {\n    super();\n    __publicField(this, \"_docContainerController\");\n    this._injector = _injector, this._docContainerController = this._injector.createInstance(DocContainerUIController);\n  }\n}, __name(_a10, \"AppUIController\"), _a10);\nAppUIController = __decorateClass$h([\n  __decorateParam$h(0, Inject(Injector))\n], AppUIController);\nvar __defProp$g = Object.defineProperty, __getOwnPropDesc$g = Object.getOwnPropertyDescriptor, __decorateClass$g = /* @__PURE__ */ __name((decorators, target, key, kind) => {\n  for (var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$g(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)\n    (decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n  return kind && result && __defProp$g(target, key, result), result;\n}, \"__decorateClass$g\"), __decorateParam$g = /* @__PURE__ */ __name((index, decorator) => (target, key) => decorator(target, key, index), \"__decorateParam$g\"), _a11;\nlet DocAutoFormatController = (_a11 = class extends Disposable {\n  constructor(_docAutoFormatService) {\n    super(), this._docAutoFormatService = _docAutoFormatService, this._initListTabAutoFormat(), this._initListSpaceAutoFormat(), this._initDefaultEnterFormat(), this._initExitListAutoFormat();\n  }\n  _initListTabAutoFormat() {\n    this.disposeWithMe(\n      this._docAutoFormatService.registerAutoFormat({\n        id: TabCommand.id,\n        match: /* @__PURE__ */ __name((context) => {\n          var _a28;\n          const { selection, paragraphs, unit } = context;\n          if (paragraphs.length === 1 && selection.startOffset === paragraphs[0].paragraphStart && paragraphs[0].bullet) {\n            const allParagraphs = (_a28 = unit.getBody()) == null ? void 0 : _a28.paragraphs, bulletParagraphs = allParagraphs == null ? void 0 : allParagraphs.filter((p2) => {\n              var _a29;\n              return ((_a29 = p2.bullet) == null ? void 0 : _a29.listId) === paragraphs[0].bullet.listId;\n            });\n            return (bulletParagraphs == null ? void 0 : bulletParagraphs.findIndex((p2) => p2.startIndex === paragraphs[0].startIndex)) !== 0;\n          } else if (paragraphs.length > 1 && paragraphs.some((p2) => p2.bullet))\n            return !0;\n          return !1;\n        }, \"match\"),\n        // traverse all paragraphs, set paragraph\n        getMutations(context) {\n          const params = context.commandParams;\n          return [{\n            id: ChangeListNestingLevelCommand.id,\n            params: {\n              type: params != null && params.shift ? ChangeListNestingLevelType.decrease : ChangeListNestingLevelType.increase\n            }\n          }];\n        },\n        priority: 100\n      })\n    ), this.disposeWithMe(\n      this._docAutoFormatService.registerAutoFormat({\n        id: TabCommand.id,\n        match: /* @__PURE__ */ __name((context) => {\n          const { selection } = context, { startNodePosition, endNodePosition } = selection;\n          return !!(startNodePosition && endNodePosition && isInSameTableCell(startNodePosition, endNodePosition) || startNodePosition && !endNodePosition && startNodePosition.path.indexOf(\"cells\") > -1);\n        }, \"match\"),\n        getMutations(context) {\n          const params = context.commandParams;\n          return [{\n            id: DocTableTabCommand.id,\n            params: {\n              shift: !!(params != null && params.shift)\n            }\n          }];\n        },\n        priority: 99\n      })\n    );\n  }\n  _initListSpaceAutoFormat() {\n    this.disposeWithMe(\n      this._docAutoFormatService.registerAutoFormat({\n        id: AfterSpaceCommand.id,\n        match: /* @__PURE__ */ __name((context) => {\n          var _a28;\n          const { selection, paragraphs, unit } = context;\n          if (!selection.collapsed || paragraphs.length !== 1)\n            return !1;\n          const text = (_a28 = unit.getBody()) == null ? void 0 : _a28.dataStream.slice(paragraphs[0].paragraphStart, paragraphs[0].paragraphEnd - 1);\n          return !!(text && Object.keys(QuickListTypeMap).includes(text));\n        }, \"match\"),\n        getMutations(context) {\n          var _a28;\n          const { paragraphs, unit } = context, text = (_a28 = unit.getBody()) == null ? void 0 : _a28.dataStream.slice(paragraphs[0].paragraphStart, paragraphs[0].paragraphEnd - 1);\n          if (text && Object.keys(QuickListTypeMap).includes(text)) {\n            const type = QuickListTypeMap[text];\n            return [{\n              id: QuickListCommand.id,\n              params: {\n                listType: type,\n                paragraph: paragraphs[0]\n              }\n            }];\n          }\n          return [];\n        }\n      })\n    );\n  }\n  _initExitListAutoFormat() {\n    this.disposeWithMe(\n      this._docAutoFormatService.registerAutoFormat({\n        id: EnterCommand.id,\n        match: /* @__PURE__ */ __name((context) => {\n          const { paragraphs } = context;\n          return !!(paragraphs.length === 1 && paragraphs[0].bullet && paragraphs[0].paragraphStart === paragraphs[0].paragraphEnd);\n        }, \"match\"),\n        getMutations: /* @__PURE__ */ __name((context) => {\n          const bullet = context.paragraphs[0].bullet;\n          return bullet ? bullet.nestingLevel > 0 ? [{\n            id: ChangeListNestingLevelCommand.id,\n            params: {\n              type: ChangeListNestingLevelType.decrease\n            }\n          }] : [{\n            id: ListOperationCommand.id,\n            params: {\n              listType: context.paragraphs[0].bullet.listType\n            }\n          }] : [];\n        }, \"getMutations\")\n      })\n    );\n  }\n  _initDefaultEnterFormat() {\n    this.disposeWithMe(\n      this._docAutoFormatService.registerAutoFormat({\n        id: EnterCommand.id,\n        match: /* @__PURE__ */ __name(() => !0, \"match\"),\n        getMutations() {\n          return [{\n            id: BreakLineCommand.id\n          }];\n        },\n        priority: -9999\n      })\n    );\n  }\n}, __name(_a11, \"DocAutoFormatController\"), _a11);\nDocAutoFormatController = __decorateClass$g([\n  OnLifecycle(LifecycleStages.Rendered, DocAutoFormatController),\n  __decorateParam$g(0, Inject(DocAutoFormatService))\n], DocAutoFormatController);\nfunction firstLineInTable(table) {\n  return table.rows[0].cells[0].sections[0].columns[0].lines[0];\n}\n__name(firstLineInTable, \"firstLineInTable\");\nfunction lastLineInTable(table) {\n  const lastRow = table.rows[table.rows.length - 1], lastCell = lastRow.cells[lastRow.cells.length - 1];\n  return getLastLine(lastCell);\n}\n__name(lastLineInTable, \"lastLineInTable\");\nfunction findTableAfterLine(line, page) {\n  const { ed } = line, { skeTables } = page;\n  let table = null;\n  for (const t of skeTables.values())\n    if (t.st === ed + 1) {\n      table = t;\n      break;\n    }\n  return table;\n}\n__name(findTableAfterLine, \"findTableAfterLine\");\nfunction findLineBeforeAndAfterTable(table) {\n  const tablePage = table == null ? void 0 : table.parent;\n  let lineBeforeTable = null, lineAfterTable = null;\n  if (table == null || tablePage == null)\n    return {\n      lineBeforeTable,\n      lineAfterTable\n    };\n  const { st, ed } = table, pages = tablePage.type === DocumentSkeletonPageType.CELL ? [tablePage] : tablePage.parent.pages;\n  return lineIterator(pages, (l2) => {\n    l2.st === ed + 1 ? lineAfterTable = l2 : l2.ed === st - 1 && (lineBeforeTable = l2);\n  }), {\n    lineBeforeTable,\n    lineAfterTable\n  };\n}\n__name(findLineBeforeAndAfterTable, \"findLineBeforeAndAfterTable\");\nfunction findBellowCell(cell) {\n  const row = cell.parent, table = row == null ? void 0 : row.parent;\n  if (row == null || table == null)\n    return;\n  const bellowRow = table.rows[table.rows.indexOf(row) + 1];\n  if (bellowRow == null)\n    return;\n  const col = row.cells.indexOf(cell);\n  return bellowRow.cells[col];\n}\n__name(findBellowCell, \"findBellowCell\");\nfunction findAboveCell(cell) {\n  const row = cell.parent, table = row == null ? void 0 : row.parent;\n  if (row == null || table == null)\n    return;\n  const aboveRow = table.rows[table.rows.indexOf(row) - 1];\n  if (aboveRow == null)\n    return;\n  const col = row.cells.indexOf(cell);\n  return aboveRow.cells[col];\n}\n__name(findAboveCell, \"findAboveCell\");\nfunction findTableBeforeLine(line, page) {\n  const { st } = line, { skeTables } = page;\n  let table = null;\n  for (const t of skeTables.values())\n    if (t.ed === st - 1) {\n      table = t;\n      break;\n    }\n  return table;\n}\n__name(findTableBeforeLine, \"findTableBeforeLine\");\nfunction firstLineInCell(cell) {\n  return cell.sections[0].columns[0].lines[0];\n}\n__name(firstLineInCell, \"firstLineInCell\");\nfunction lastLineInCell(cell) {\n  return getLastLine(cell);\n}\n__name(lastLineInCell, \"lastLineInCell\");\nvar __defProp$f = Object.defineProperty, __getOwnPropDesc$f = Object.getOwnPropertyDescriptor, __decorateClass$f = /* @__PURE__ */ __name((decorators, target, key, kind) => {\n  for (var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$f(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)\n    (decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n  return kind && result && __defProp$f(target, key, result), result;\n}, \"__decorateClass$f\"), __decorateParam$f = /* @__PURE__ */ __name((index, decorator) => (target, key) => decorator(target, key, index), \"__decorateParam$f\"), _a12;\nlet DocMoveCursorController = (_a12 = class extends Disposable {\n  constructor(_univerInstanceService, _renderManagerService, _textSelectionManagerService, _commandService) {\n    super();\n    __publicField(this, \"_onInputSubscription\");\n    this._univerInstanceService = _univerInstanceService, this._renderManagerService = _renderManagerService, this._textSelectionManagerService = _textSelectionManagerService, this._commandService = _commandService, this._commandExecutedListener();\n  }\n  dispose() {\n    var _a28;\n    super.dispose(), (_a28 = this._onInputSubscription) == null || _a28.unsubscribe();\n  }\n  _commandExecutedListener() {\n    const updateCommandList = [MoveCursorOperation.id, MoveSelectionOperation.id];\n    this.disposeWithMe(\n      this._commandService.onCommandExecuted((command) => {\n        if (!updateCommandList.includes(command.id))\n          return;\n        const param = command.params;\n        switch (command.id) {\n          case MoveCursorOperation.id:\n            return this._handleMoveCursor(param.direction);\n          case MoveSelectionOperation.id:\n            return this._handleShiftMoveSelection(param.direction);\n          default:\n            throw new Error(\"Unknown command\");\n        }\n      })\n    );\n  }\n  // eslint-disable-next-line max-lines-per-function, complexity\n  _handleShiftMoveSelection(direction) {\n    var _a28, _b, _c;\n    const activeRange = this._textSelectionManagerService.getActiveTextRange(), allRanges = this._textSelectionManagerService.getCurrentTextRanges(), docDataModel = this._univerInstanceService.getCurrentUniverDocInstance();\n    if (docDataModel == null)\n      return;\n    const skeleton = (_a28 = this._renderManagerService.getRenderById(docDataModel.getUnitId())) == null ? void 0 : _a28.with(DocSkeletonManagerService).getSkeleton(), docObject = this._getDocObject();\n    if (activeRange == null || skeleton == null || docObject == null)\n      return;\n    const {\n      startOffset,\n      endOffset,\n      style,\n      collapsed,\n      direction: rangeDirection,\n      segmentId,\n      startNodePosition,\n      endNodePosition,\n      segmentPage\n    } = activeRange;\n    if (allRanges.length > 1) {\n      let min = Number.POSITIVE_INFINITY, max = Number.NEGATIVE_INFINITY;\n      for (const range of allRanges)\n        min = Math.min(min, range.startOffset), max = Math.max(max, range.endOffset);\n      this._textSelectionManagerService.replaceTextRanges([\n        {\n          startOffset: direction === Direction.LEFT || direction === Direction.UP ? max : min,\n          endOffset: direction === Direction.LEFT || direction === Direction.UP ? min : max,\n          style\n        }\n      ], !1);\n      return;\n    }\n    const anchorOffset = collapsed || rangeDirection === RANGE_DIRECTION.FORWARD ? startOffset : endOffset;\n    let focusOffset = collapsed || rangeDirection === RANGE_DIRECTION.FORWARD ? endOffset : startOffset;\n    const dataStreamLength = (_b = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody().dataStream.length) != null ? _b : Number.POSITIVE_INFINITY;\n    if (direction === Direction.LEFT || direction === Direction.RIGHT) {\n      const preGlyph = skeleton.findNodeByCharIndex(focusOffset - 1, segmentId, segmentPage), curGlyph = skeleton.findNodeByCharIndex(focusOffset, segmentId, segmentPage);\n      focusOffset = direction === Direction.RIGHT ? focusOffset + curGlyph.count : focusOffset - ((_c = preGlyph == null ? void 0 : preGlyph.count) != null ? _c : 0), focusOffset = Math.min(dataStreamLength - 2, Math.max(0, focusOffset)), this._textSelectionManagerService.replaceTextRanges([\n        {\n          startOffset: anchorOffset,\n          endOffset: focusOffset,\n          style\n        }\n      ], !1), this._scrollToFocusNodePosition(docDataModel.getUnitId(), focusOffset);\n    } else {\n      const focusGlyph = skeleton.findNodeByCharIndex(focusOffset, segmentId, segmentPage), documentOffsetConfig = docObject.document.getOffsetConfig(), focusNodePosition = collapsed ? startNodePosition : rangeDirection === RANGE_DIRECTION.FORWARD ? endNodePosition : startNodePosition, newPos = this._getTopOrBottomPosition(skeleton, focusGlyph, focusNodePosition, direction === Direction.DOWN, !0);\n      if (newPos == null) {\n        const newFocusOffset = direction === Direction.UP ? 0 : dataStreamLength - 2;\n        if (newFocusOffset === focusOffset)\n          return;\n        this._textSelectionManagerService.replaceTextRanges([\n          {\n            startOffset: anchorOffset,\n            endOffset: newFocusOffset,\n            style\n          }\n        ], !1);\n        return;\n      }\n      const newActiveRange = new NodePositionConvertToCursor(documentOffsetConfig, skeleton).getRangePointData(\n        newPos,\n        newPos\n      ).cursorList[0];\n      this._textSelectionManagerService.replaceTextRanges([\n        {\n          startOffset: anchorOffset,\n          endOffset: newActiveRange.endOffset,\n          style\n        }\n      ], !1), this._scrollToFocusNodePosition(docDataModel.getUnitId(), newActiveRange.endOffset);\n    }\n  }\n  // eslint-disable-next-line max-lines-per-function, complexity\n  _handleMoveCursor(direction) {\n    var _a28, _b, _c, _d;\n    const activeRange = this._textSelectionManagerService.getActiveTextRange(), allRanges = this._textSelectionManagerService.getCurrentTextRanges(), docDataModel = this._univerInstanceService.getCurrentUniverDocInstance();\n    if (docDataModel == null)\n      return !1;\n    const skeleton = (_a28 = this._renderManagerService.getRenderById(docDataModel.getUnitId())) == null ? void 0 : _a28.with(DocSkeletonManagerService).getSkeleton(), docObject = this._getDocObject();\n    if (activeRange == null || skeleton == null || docObject == null || allRanges == null)\n      return;\n    const { startOffset, endOffset, style, collapsed, segmentId, startNodePosition, endNodePosition, segmentPage } = activeRange, body = docDataModel.getSelfOrHeaderFooterModel(segmentId).getBody();\n    if (body == null)\n      return;\n    const dataStreamLength = (_b = body.dataStream.length) != null ? _b : Number.POSITIVE_INFINITY, customRanges = (_c = docDataModel.getCustomRanges()) != null ? _c : [];\n    if (direction === Direction.LEFT || direction === Direction.RIGHT) {\n      let cursor;\n      if (!activeRange.collapsed || allRanges.length > 1) {\n        let min = Number.POSITIVE_INFINITY, max = Number.NEGATIVE_INFINITY;\n        for (const range of allRanges)\n          min = Math.min(min, range.startOffset), max = Math.max(max, range.endOffset);\n        cursor = direction === Direction.LEFT ? min : max;\n      } else {\n        const preSpan = skeleton.findNodeByCharIndex(startOffset - 1, segmentId, segmentPage), curSpan = skeleton.findNodeByCharIndex(startOffset, segmentId, segmentPage), nextGlyph = skeleton.findNodeByCharIndex(startOffset + 1, segmentId, segmentPage);\n        direction === Direction.LEFT ? cursor = Math.max(0, startOffset - ((_d = preSpan == null ? void 0 : preSpan.count) != null ? _d : 1)) : cursor = Math.min(dataStreamLength - 2, endOffset + curSpan.count + ((nextGlyph == null ? void 0 : nextGlyph.streamType) === DataStreamTreeTokenType.SECTION_BREAK ? 1 : 0));\n      }\n      const skipTokens = [\n        DataStreamTreeTokenType.CUSTOM_RANGE_START,\n        DataStreamTreeTokenType.CUSTOM_RANGE_END,\n        DataStreamTreeTokenType.TABLE_START,\n        DataStreamTreeTokenType.TABLE_END,\n        DataStreamTreeTokenType.TABLE_ROW_START,\n        DataStreamTreeTokenType.TABLE_ROW_END,\n        DataStreamTreeTokenType.TABLE_CELL_START,\n        DataStreamTreeTokenType.TABLE_CELL_END,\n        DataStreamTreeTokenType.SECTION_BREAK\n      ];\n      if (direction === Direction.LEFT)\n        for (; skipTokens.includes(body.dataStream[cursor]); )\n          cursor--;\n      else\n        for (; skipTokens.includes(body.dataStream[cursor]); )\n          cursor++;\n      customRanges.filter((range) => range.wholeEntity && range.startIndex < cursor && range.endIndex >= cursor).forEach((range) => {\n        direction === Direction.LEFT ? cursor = Math.min(range.startIndex, cursor) : cursor = Math.max(range.endIndex + 1, cursor);\n      }), this._textSelectionManagerService.replaceTextRanges([\n        {\n          startOffset: cursor,\n          endOffset: cursor,\n          style\n        }\n      ], !1), this._scrollToFocusNodePosition(docDataModel.getUnitId(), cursor);\n    } else {\n      const startNode = skeleton.findNodeByCharIndex(startOffset, segmentId, segmentPage), endNode = skeleton.findNodeByCharIndex(endOffset, segmentId, segmentPage), documentOffsetConfig = docObject.document.getOffsetConfig(), newPos = this._getTopOrBottomPosition(\n        skeleton,\n        direction === Direction.UP || collapsed ? startNode : endNode,\n        direction === Direction.UP || collapsed ? startNodePosition : endNodePosition,\n        direction === Direction.DOWN\n      );\n      if (newPos == null) {\n        let cursor;\n        collapsed ? cursor = direction === Direction.UP ? 0 : dataStreamLength - 2 : cursor = direction === Direction.UP ? startOffset : endOffset, this._textSelectionManagerService.replaceTextRanges([\n          {\n            startOffset: cursor,\n            endOffset: cursor,\n            style\n          }\n        ], !1);\n        return;\n      }\n      const newActiveRange = new NodePositionConvertToCursor(documentOffsetConfig, skeleton).getRangePointData(\n        newPos,\n        newPos\n      ).cursorList[0];\n      this._textSelectionManagerService.replaceTextRanges([\n        {\n          ...newActiveRange,\n          style\n        }\n      ], !1), this._scrollToFocusNodePosition(docDataModel.getUnitId(), newActiveRange.endOffset);\n    }\n  }\n  _getTopOrBottomPosition(docSkeleton, glyph, nodePosition, direction, skipCellContent = !1) {\n    if (glyph == null || nodePosition == null)\n      return;\n    const offsetLeft = this._getGlyphLeftOffsetInLine(glyph), line = this._getNextOrPrevLine(glyph, direction, skipCellContent);\n    if (line == null)\n      return;\n    const position = this._matchPositionByLeftOffset(docSkeleton, line, offsetLeft, nodePosition);\n    if (position != null)\n      return { ...position, isBack: !0 };\n  }\n  _getGlyphLeftOffsetInLine(glyph) {\n    const divide = glyph.parent;\n    if (divide == null)\n      return Number.NEGATIVE_INFINITY;\n    const divideLeft = divide.left, { left } = glyph;\n    return divideLeft + left;\n  }\n  _matchPositionByLeftOffset(docSkeleton, line, offsetLeft, nodePosition) {\n    const nearestNode = {\n      distance: Number.POSITIVE_INFINITY\n    };\n    for (const divide of line.divides) {\n      const divideLeft = divide.left;\n      for (const glyph of divide.glyphGroup) {\n        if (glyph.streamType === DataStreamTreeTokenType.SECTION_BREAK)\n          continue;\n        const { left } = glyph, leftSide = divideLeft + left, distance = Math.abs(offsetLeft - leftSide);\n        distance < nearestNode.distance && (nearestNode.glyph = glyph, nearestNode.distance = distance);\n      }\n    }\n    if (nearestNode.glyph == null)\n      return;\n    const { segmentPage } = nodePosition;\n    return docSkeleton.findPositionByGlyph(nearestNode.glyph, segmentPage);\n  }\n  // eslint-disable-next-line max-lines-per-function, complexity\n  _getNextOrPrevLine(glyph, direction, skipCellContent = !1) {\n    var _a28, _b, _c, _d, _e, _f, _g, _h, _i, _j, _k, _l;\n    const divide = glyph.parent, line = divide == null ? void 0 : divide.parent, column = line == null ? void 0 : line.parent, section = column == null ? void 0 : column.parent, page = section == null ? void 0 : section.parent;\n    if (divide == null || line == null || column == null || section == null || page == null)\n      return;\n    const currentLineIndex = column.lines.indexOf(line);\n    if (currentLineIndex === -1)\n      return;\n    let newLine;\n    if (page.type === DocumentSkeletonPageType.CELL && skipCellContent) {\n      const nLine = findAboveOrBellowCellLine(page, direction);\n      if (nLine)\n        return nLine;\n    }\n    if (direction === !0) {\n      newLine = column.lines[currentLineIndex + 1];\n      const tableAfterLine = findTableAfterLine(line, page);\n      if (tableAfterLine) {\n        const firstLine = firstLineInTable(tableAfterLine);\n        firstLine && (newLine = firstLine);\n      }\n    } else {\n      newLine = column.lines[currentLineIndex - 1];\n      const tableBeforeLine = findTableBeforeLine(line, page);\n      if (tableBeforeLine) {\n        const lastLine = lastLineInTable(tableBeforeLine);\n        lastLine && (newLine = lastLine);\n      }\n    }\n    if (newLine != null)\n      return newLine;\n    const currentColumnIndex = section.columns.indexOf(column);\n    if (currentColumnIndex === -1)\n      return;\n    if (direction === !0)\n      newLine = (_a28 = section.columns[currentColumnIndex + 1]) == null ? void 0 : _a28.lines[0];\n    else {\n      const prevColumnLines = (_c = (_b = section.columns) == null ? void 0 : _b[currentColumnIndex - 1]) == null ? void 0 : _c.lines;\n      newLine = prevColumnLines == null ? void 0 : prevColumnLines[prevColumnLines.length - 1];\n    }\n    if (newLine != null)\n      return newLine;\n    const currentSectionIndex = page.sections.indexOf(section);\n    if (currentSectionIndex === -1)\n      return;\n    if (direction === !0)\n      newLine = (_e = (_d = page.sections[currentSectionIndex - 1]) == null ? void 0 : _d.columns[0]) == null ? void 0 : _e.lines[0];\n    else {\n      const prevColumns = (_g = (_f = page.sections) == null ? void 0 : _f[currentSectionIndex - 1]) == null ? void 0 : _g.columns, column2 = prevColumns == null ? void 0 : prevColumns[prevColumns.length - 1], prevColumnLines = column2 == null ? void 0 : column2.lines;\n      newLine = prevColumnLines == null ? void 0 : prevColumnLines[prevColumnLines.length - 1];\n    }\n    if (newLine != null)\n      return newLine;\n    if (page.type === DocumentSkeletonPageType.CELL)\n      return findAboveOrBellowCellLine(page, direction);\n    const skeleton = page.parent;\n    if (skeleton == null)\n      return;\n    const currentPageIndex = skeleton.pages.indexOf(page);\n    if (currentPageIndex !== -1) {\n      if (direction === !0)\n        newLine = (_j = (_i = (_h = skeleton.pages[currentPageIndex + 1]) == null ? void 0 : _h.sections[0]) == null ? void 0 : _i.columns[0]) == null ? void 0 : _j.lines[0];\n      else {\n        const prevSections = (_k = skeleton.pages[currentPageIndex - 1]) == null ? void 0 : _k.sections;\n        if (prevSections == null)\n          return;\n        const prevColumns = (_l = prevSections[prevSections.length - 1]) == null ? void 0 : _l.columns, column2 = prevColumns[prevColumns.length - 1], prevColumnLines = column2 == null ? void 0 : column2.lines;\n        newLine = prevColumnLines[prevColumnLines.length - 1];\n      }\n      if (newLine != null)\n        return newLine;\n    }\n  }\n  _scrollToFocusNodePosition(unitId, offset) {\n    var _a28;\n    const backScrollController = (_a28 = this._renderManagerService.getRenderById(unitId)) == null ? void 0 : _a28.with(DocBackScrollRenderController);\n    backScrollController != null && backScrollController.scrollToRange({\n      startOffset: offset,\n      endOffset: offset,\n      collapsed: !0\n    });\n  }\n  _getDocObject() {\n    return getDocObject(this._univerInstanceService, this._renderManagerService);\n  }\n}, __name(_a12, \"DocMoveCursorController\"), _a12);\nDocMoveCursorController = __decorateClass$f([\n  OnLifecycle(LifecycleStages.Rendered, DocMoveCursorController),\n  __decorateParam$f(0, IUniverInstanceService),\n  __decorateParam$f(1, IRenderManagerService),\n  __decorateParam$f(2, Inject(DocSelectionManagerService)),\n  __decorateParam$f(3, ICommandService)\n], DocMoveCursorController);\nfunction findAboveOrBellowCellLine(page, direction) {\n  var _a28, _b;\n  let newLine = null;\n  if (direction === !0) {\n    const bellowCell = findBellowCell(page);\n    if (bellowCell)\n      newLine = firstLineInCell(bellowCell);\n    else {\n      const table = (_a28 = page.parent) == null ? void 0 : _a28.parent, { lineAfterTable } = findLineBeforeAndAfterTable(table);\n      lineAfterTable && (newLine = lineAfterTable);\n    }\n  } else {\n    const aboveCell = findAboveCell(page);\n    if (aboveCell)\n      newLine = lastLineInCell(aboveCell);\n    else {\n      const table = (_b = page.parent) == null ? void 0 : _b.parent, { lineBeforeTable } = findLineBeforeAndAfterTable(table);\n      lineBeforeTable && (newLine = lineBeforeTable);\n    }\n  }\n  return newLine != null, newLine;\n}\n__name(findAboveOrBellowCellLine, \"findAboveOrBellowCellLine\");\nconst create = \"univer-create\", createItem = \"univer-create-item\", createLabel = \"univer-create-label\", createInput = \"univer-create-input\", styles = {\n  create,\n  createItem,\n  createLabel,\n  createInput\n}, DocCreateTableConfirm = /* @__PURE__ */ __name(({\n  handleRowColChange,\n  tableCreateParams\n}) => {\n  const localeService = useDependency(LocaleService), [rowCount, setRowCount] = useState(3), [colCount, setColCount] = useState(5);\n  function handleInputChange(rowCount2, colCount2) {\n    setRowCount(rowCount2), setColCount(colCount2), handleRowColChange(rowCount2, colCount2);\n  }\n  return __name(handleInputChange, \"handleInputChange\"), useEffect(() => {\n    setRowCount(tableCreateParams.rowCount), setColCount(tableCreateParams.colCount);\n  }, [tableCreateParams]), /* @__PURE__ */ jsxRuntimeExports.jsxs(\"div\", { className: styles.create, children: [\n    /* @__PURE__ */ jsxRuntimeExports.jsxs(\"div\", { className: styles.createItem, children: [\n      /* @__PURE__ */ jsxRuntimeExports.jsx(\"span\", { className: styles.createLabel, children: localeService.t(\"toolbar.table.rowCount\") }),\n      /* @__PURE__ */ jsxRuntimeExports.jsx(\n        InputNumber,\n        {\n          min: 1,\n          max: 20,\n          precision: 0,\n          value: rowCount,\n          onChange: /* @__PURE__ */ __name((val) => {\n            handleInputChange(val, colCount);\n          }, \"onChange\"),\n          className: styles.createInput\n        }\n      )\n    ] }),\n    /* @__PURE__ */ jsxRuntimeExports.jsxs(\"div\", { className: styles.createItem, children: [\n      /* @__PURE__ */ jsxRuntimeExports.jsx(\"span\", { className: styles.createLabel, children: localeService.t(\"toolbar.table.colCount\") }),\n      /* @__PURE__ */ jsxRuntimeExports.jsx(\n        InputNumber,\n        {\n          min: 1,\n          max: 20,\n          precision: 0,\n          value: colCount,\n          onChange: /* @__PURE__ */ __name((val) => {\n            handleInputChange(rowCount, val);\n          }, \"onChange\"),\n          className: styles.createInput\n        }\n      )\n    ] })\n  ] });\n}, \"DocCreateTableConfirm\");\nvar __defProp$e = Object.defineProperty, __getOwnPropDesc$e = Object.getOwnPropertyDescriptor, __decorateClass$e = /* @__PURE__ */ __name((decorators, target, key, kind) => {\n  for (var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$e(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)\n    (decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n  return kind && result && __defProp$e(target, key, result), result;\n}, \"__decorateClass$e\"), __decorateParam$e = /* @__PURE__ */ __name((index, decorator) => (target, key) => decorator(target, key, index), \"__decorateParam$e\"), _a13;\nlet DocTableController = (_a13 = class extends Disposable {\n  constructor(_commandService, _componentManager) {\n    super(), this._commandService = _commandService, this._componentManager = _componentManager, this._initialize();\n  }\n  _initialize() {\n    this._init(), this._registerCommands(), this._initCustomComponents();\n  }\n  _registerCommands() {\n    [\n      DocCreateTableOperation\n    ].forEach((command) => this.disposeWithMe(this._commandService.registerCommand(command)));\n  }\n  _initCustomComponents() {\n    const componentManager = this._componentManager;\n    this.disposeWithMe(componentManager.register(COMPONENT_DOC_CREATE_TABLE_CONFIRM, DocCreateTableConfirm));\n  }\n  _init() {\n  }\n}, __name(_a13, \"DocTableController\"), _a13);\nDocTableController = __decorateClass$e([\n  OnLifecycle(LifecycleStages.Rendered, DocTableController),\n  __decorateParam$e(0, ICommandService),\n  __decorateParam$e(1, Inject(ComponentManager))\n], DocTableController);\nconst DOC_VERTICAL_PADDING = 4;\nvar __defProp$d = Object.defineProperty, __getOwnPropDesc$d = Object.getOwnPropertyDescriptor, __decorateClass$d = /* @__PURE__ */ __name((decorators, target, key, kind) => {\n  for (var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$d(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)\n    (decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n  return kind && result && __defProp$d(target, key, result), result;\n}, \"__decorateClass$d\"), __decorateParam$d = /* @__PURE__ */ __name((index, decorator) => (target, key) => decorator(target, key, index), \"__decorateParam$d\");\nfunction transformBound2OffsetBound(originBound, scene) {\n  const topLeft = transformPosition2Offset(originBound.left, originBound.top, scene), bottomRight = transformPosition2Offset(originBound.right, originBound.bottom, scene);\n  return {\n    left: topLeft.x,\n    top: topLeft.y,\n    right: bottomRight.x,\n    bottom: bottomRight.y\n  };\n}\n__name(transformBound2OffsetBound, \"transformBound2OffsetBound\");\nfunction transformPosition2Offset(x, y, scene) {\n  const { scaleX, scaleY } = scene.getAncestorScale(), viewMain = scene.getViewport(VIEWPORT_KEY.VIEW_MAIN);\n  if (!viewMain)\n    return {\n      x,\n      y\n    };\n  const { viewportScrollX: actualScrollX, viewportScrollY: actualScrollY } = viewMain, offsetX = (x - actualScrollX) * scaleX, offsetY = (y - actualScrollY) * scaleY;\n  return {\n    x: offsetX,\n    y: offsetY\n  };\n}\n__name(transformPosition2Offset, \"transformPosition2Offset\");\nfunction transformOffset2Bound(offsetX, offsetY, scene) {\n  const { scaleX, scaleY } = scene.getAncestorScale(), viewMain = scene.getViewport(VIEWPORT_KEY.VIEW_MAIN);\n  if (!viewMain)\n    return {\n      x: offsetX,\n      y: offsetY\n    };\n  const { viewportScrollX: actualScrollX, viewportScrollY: actualScrollY } = viewMain, x = offsetX / scaleX + actualScrollX, y = offsetY / scaleY + actualScrollY;\n  return {\n    x,\n    y\n  };\n}\n__name(transformOffset2Bound, \"transformOffset2Bound\");\nconst calcDocRangePositions$1 = /* @__PURE__ */ __name((range, currentRender) => {\n  const { scene, mainComponent, engine } = currentRender, skeleton = currentRender.with(DocSkeletonManagerService).getSkeleton(), startPosition = skeleton.findNodePositionByCharIndex(range.startOffset, !1, range.segmentId, range.segmentPage), endPosition = skeleton.findNodePositionByCharIndex(range.endOffset, !1, range.segmentId, range.segmentPage), document2 = mainComponent;\n  if (!endPosition || !startPosition)\n    return;\n  const documentOffsetConfig = document2.getOffsetConfig(), { docsLeft, docsTop } = documentOffsetConfig, canvasElement = engine.getCanvasElement(), canvasClientRect = canvasElement.getBoundingClientRect(), widthOfCanvas = pxToNum(canvasElement.style.width), { top, left, width } = canvasClientRect, scaleAdjust = width / widthOfCanvas, { scaleX, scaleY } = scene.getAncestorScale(), convertor = new NodePositionConvertToCursor(documentOffsetConfig, skeleton), { borderBoxPointGroup } = convertor.getRangePointData(startPosition, endPosition);\n  return getLineBounding(borderBoxPointGroup).map((bound) => transformBound2OffsetBound(bound, scene)).map((i) => ({\n    left: (i.left + docsLeft * scaleX) * scaleAdjust + left,\n    right: (i.right + docsLeft * scaleX) * scaleAdjust + left,\n    top: (i.top + docsTop * scaleY) * scaleAdjust + top,\n    bottom: (i.bottom + docsTop * scaleY) * scaleAdjust + top\n  }));\n}, \"calcDocRangePositions$1\");\nvar _a14;\nlet DocCanvasPopManagerService = (_a14 = class extends Disposable {\n  constructor(_globalPopupManagerService, _renderManagerService, _univerInstanceService, _commandService) {\n    super(), this._globalPopupManagerService = _globalPopupManagerService, this._renderManagerService = _renderManagerService, this._univerInstanceService = _univerInstanceService, this._commandService = _commandService;\n  }\n  _createObjectPositionObserver(targetObject, currentRender) {\n    const calc = /* @__PURE__ */ __name(() => {\n      const { scene, engine } = currentRender, { left, top, width, height } = targetObject, bound = {\n        left,\n        right: left + width,\n        top,\n        bottom: top + height\n      }, canvasElement = engine.getCanvasElement(), canvasClientRect = canvasElement.getBoundingClientRect(), widthOfCanvas = pxToNum(canvasElement.style.width), offsetBound = transformBound2OffsetBound(bound, scene), { top: topOffset, left: leftOffset, width: domWidth } = canvasClientRect, scaleAdjust = domWidth / widthOfCanvas;\n      return {\n        left: offsetBound.left * scaleAdjust + leftOffset,\n        right: offsetBound.right * scaleAdjust + leftOffset,\n        top: offsetBound.top * scaleAdjust + topOffset,\n        bottom: offsetBound.bottom * scaleAdjust + topOffset\n      };\n    }, \"calc\"), position = calc(), position$ = new BehaviorSubject(position), disposable = new DisposableCollection();\n    disposable.add(this._commandService.onCommandExecuted((commandInfo) => {\n      commandInfo.id === SetDocZoomRatioOperation.id && position$.next(calc());\n    }));\n    const viewMain = currentRender.scene.getViewport(VIEWPORT_KEY.VIEW_MAIN);\n    return viewMain && disposable.add(viewMain.onScrollAfter$.subscribeEvent(() => {\n      position$.next(calc());\n    })), {\n      position,\n      position$,\n      disposable\n    };\n  }\n  _createRangePositionObserver(range, currentRender) {\n    var _a28;\n    const positions = (_a28 = calcDocRangePositions$1(range, currentRender)) != null ? _a28 : [], positions$ = new BehaviorSubject(positions), disposable = new DisposableCollection();\n    disposable.add(this._commandService.onCommandExecuted((commandInfo) => {\n      if (commandInfo.id === SetDocZoomRatioOperation.id) {\n        const position = calcDocRangePositions$1(range, currentRender);\n        position && positions$.next(position);\n      }\n    }));\n    const viewMain = currentRender.scene.getViewport(VIEWPORT_KEY.VIEW_MAIN);\n    return viewMain && disposable.add(viewMain.onScrollAfter$.subscribeEvent(() => {\n      const position = calcDocRangePositions$1(range, currentRender);\n      position && positions$.next(position);\n    })), {\n      positions,\n      positions$,\n      disposable\n    };\n  }\n  // #region attach to object\n  /**\n   * attach a popup to canvas object\n   * @param targetObject target canvas object\n   * @param popup popup item\n   * @returns disposable\n   */\n  attachPopupToObject(targetObject, popup, unitId) {\n    const currentRender = this._renderManagerService.getRenderById(unitId);\n    if (!currentRender)\n      throw new Error(`Current render not found, unitId: ${unitId}`);\n    const { position, position$, disposable } = this._createObjectPositionObserver(targetObject, currentRender), id = this._globalPopupManagerService.addPopup({\n      ...popup,\n      unitId,\n      subUnitId: \"default\",\n      anchorRect: position,\n      anchorRect$: position$,\n      canvasElement: currentRender.engine.getCanvasElement()\n    });\n    return {\n      dispose: /* @__PURE__ */ __name(() => {\n        this._globalPopupManagerService.removePopup(id), position$.complete(), disposable.dispose();\n      }, \"dispose\")\n    };\n  }\n  // #endregion\n  // #region attach to range\n  /**\n   * attach a popup to doc range\n   * @param range doc range\n   * @param popup popup item\n   * @param unitId unit id\n   * @returns disposable\n   */\n  attachPopupToRange(range, popup, unitId) {\n    if (!this._univerInstanceService.getUnit(unitId))\n      throw new Error(`Document not found, unitId: ${unitId}`);\n    const { direction = \"top\", multipleDirection } = popup, currentRender = this._renderManagerService.getRenderById(unitId);\n    if (!currentRender)\n      throw new Error(`Current render not found, unitId: ${unitId}`);\n    const { positions: bounds, positions$: bounds$, disposable } = this._createRangePositionObserver(range, currentRender), position$ = bounds$.pipe(map$1((bounds2) => direction.includes(\"top\") ? bounds2[0] : bounds2[bounds2.length - 1])), id = this._globalPopupManagerService.addPopup({\n      ...popup,\n      unitId,\n      subUnitId: \"default\",\n      anchorRect: direction.includes(\"top\") ? bounds[0] : bounds[bounds.length - 1],\n      anchorRect$: position$,\n      excludeRects: bounds,\n      excludeRects$: bounds$,\n      direction: direction.includes(\"top\") || direction.includes(\"bottom\") ? bounds.length > 1 ? multipleDirection : direction : \"bottom\",\n      canvasElement: currentRender.engine.getCanvasElement()\n    });\n    return {\n      dispose: /* @__PURE__ */ __name(() => {\n        this._globalPopupManagerService.removePopup(id), bounds$.complete(), disposable.dispose();\n      }, \"dispose\"),\n      canDispose: /* @__PURE__ */ __name(() => this._globalPopupManagerService.activePopupId !== id, \"canDispose\")\n    };\n  }\n  // #endregion\n}, __name(_a14, \"DocCanvasPopManagerService\"), _a14);\nDocCanvasPopManagerService = __decorateClass$d([\n  __decorateParam$d(0, Inject(ICanvasPopupService)),\n  __decorateParam$d(1, IRenderManagerService),\n  __decorateParam$d(2, IUniverInstanceService),\n  __decorateParam$d(3, ICommandService)\n], DocCanvasPopManagerService);\nvar __defProp$c = Object.defineProperty, __getOwnPropDesc$c = Object.getOwnPropertyDescriptor, __decorateClass$c = /* @__PURE__ */ __name((decorators, target, key, kind) => {\n  for (var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$c(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)\n    (decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n  return kind && result && __defProp$c(target, key, result), result;\n}, \"__decorateClass$c\"), __decorateParam$c = /* @__PURE__ */ __name((index, decorator) => (target, key) => decorator(target, key, index), \"__decorateParam$c\");\nconst calcDocRangePositions = /* @__PURE__ */ __name((range, documents, skeleton, pageIndex) => {\n  var _a28, _b, _c, _d, _e;\n  const startPosition = skeleton.findNodePositionByCharIndex(range.startOffset, !1, range.segmentId, pageIndex), skeletonData = skeleton.getSkeletonData();\n  let end = range.endOffset;\n  if (range.segmentId) {\n    const root = (_e = Array.from((_b = (_a28 = skeletonData == null ? void 0 : skeletonData.skeFooters.get(range.segmentId)) == null ? void 0 : _a28.values()) != null ? _b : [])[0]) != null ? _e : Array.from((_d = (_c = skeletonData == null ? void 0 : skeletonData.skeHeaders.get(range.segmentId)) == null ? void 0 : _c.values()) != null ? _d : [])[0];\n    root && (end = Math.min(root.ed, end));\n  }\n  const endPosition = skeleton.findNodePositionByCharIndex(end, !1, range.segmentId, pageIndex);\n  if (!endPosition || !startPosition)\n    return;\n  const documentOffsetConfig = documents.getOffsetConfig(), convertor = new NodePositionConvertToCursor(documentOffsetConfig, skeleton), { borderBoxPointGroup } = convertor.getRangePointData(startPosition, endPosition);\n  return getLineBounding(borderBoxPointGroup).map((rect) => ({\n    top: rect.top + documentOffsetConfig.docsTop - DOC_VERTICAL_PADDING,\n    bottom: rect.bottom + documentOffsetConfig.docsTop + DOC_VERTICAL_PADDING,\n    left: rect.left + documentOffsetConfig.docsLeft,\n    right: rect.right + documentOffsetConfig.docsLeft\n  }));\n}, \"calcDocRangePositions\"), calcDocGlyphPosition = /* @__PURE__ */ __name((glyph, documents, skeleton, pageIndex = -1) => {\n  const start = skeleton.findPositionByGlyph(glyph, pageIndex);\n  if (!start)\n    return;\n  const documentOffsetConfig = documents.getOffsetConfig(), startPosition = { ...start, isBack: !0 }, convertor = new NodePositionConvertToCursor(documentOffsetConfig, skeleton), { borderBoxPointGroup } = convertor.getRangePointData(startPosition, startPosition), rect = getLineBounding(borderBoxPointGroup)[0];\n  return {\n    top: rect.top + documentOffsetConfig.docsTop,\n    bottom: rect.bottom + documentOffsetConfig.docsTop,\n    left: rect.left + documentOffsetConfig.docsLeft,\n    right: rect.left + documentOffsetConfig.docsLeft + glyph.width\n  };\n}, \"calcDocGlyphPosition\");\nvar _a15;\nlet DocEventManagerService = (_a15 = class extends Disposable {\n  constructor(_context, _docSkeletonManagerService) {\n    super();\n    __publicField(this, \"_hoverCustomRanges$\", new BehaviorSubject([]));\n    __publicField(this, \"hoverCustomRanges$\", this._hoverCustomRanges$.pipe(distinctUntilChanged((pre, aft) => pre.length === aft.length && pre.every((item, i) => aft[i].range.rangeId === item.range.rangeId && aft[i].segmentId === item.segmentId && aft[i].segmentPageIndex === item.segmentPageIndex))));\n    __publicField(this, \"_clickCustomRanges$\", new Subject());\n    __publicField(this, \"clickCustomRanges$\", this._clickCustomRanges$.asObservable());\n    __publicField(this, \"_hoverBullet$\", new Subject());\n    __publicField(this, \"hoverBullet$\", this._hoverBullet$.pipe(distinctUntilChanged((pre, aft) => (pre == null ? void 0 : pre.paragraph.startIndex) === (aft == null ? void 0 : aft.paragraph.startIndex) && (pre == null ? void 0 : pre.segmentId) === (aft == null ? void 0 : aft.segmentId) && (pre == null ? void 0 : pre.segmentPageIndex) === (aft == null ? void 0 : aft.segmentPageIndex))));\n    __publicField(this, \"_clickBullet$\", new Subject());\n    __publicField(this, \"clickBullets$\", this._clickBullet$.asObservable());\n    __publicField(this, \"_customRangeDirty\", !0);\n    __publicField(this, \"_bulletDirty\", !0);\n    /**\n     * cache the bounding of custom ranges,\n     * it will be updated when the doc-skeleton is recalculated\n     */\n    __publicField(this, \"_customRangeBounds\", []);\n    /**\n     * cache the bounding of bullets,\n     * it will be updated when the doc-skeleton is recalculated\n     */\n    __publicField(this, \"_bulletBounds\", []);\n    this._context = _context, this._docSkeletonManagerService = _docSkeletonManagerService, this._initResetDirty(), this._initEvents(), this._initPointer();\n  }\n  get _skeleton() {\n    return this._docSkeletonManagerService.getSkeleton();\n  }\n  get _documents() {\n    return this._context.mainComponent;\n  }\n  dispose() {\n    this._hoverCustomRanges$.complete(), this._clickCustomRanges$.complete(), super.dispose();\n  }\n  _initPointer() {\n    let preCursor = CURSOR_TYPE.TEXT;\n    this.disposeWithMe(this.hoverCustomRanges$.subscribe((ranges) => {\n      ranges.length ? (preCursor = this._context.scene.getCursor(), this._context.scene.setCursor(CURSOR_TYPE.POINTER)) : this._context.scene.setCursor(preCursor);\n    }));\n  }\n  _initResetDirty() {\n    this.disposeWithMe(this._skeleton.dirty$.subscribe(() => {\n      this._customRangeDirty = !0, this._bulletDirty = !0;\n    })), this.disposeWithMe(\n      fromEventSubject(this._context.engine.onTransformChange$).pipe(\n        filter$1((evt) => evt.type === TRANSFORM_CHANGE_OBSERVABLE_TYPE.resize)\n      ).subscribe(() => {\n        this._customRangeDirty = !0, this._bulletDirty = !0;\n      })\n    );\n  }\n  _initEvents() {\n    this.disposeWithMe(fromEventSubject(this._context.scene.onPointerMove$).pipe(throttleTime(30)).subscribe((evt) => {\n      this._hoverCustomRanges$.next(\n        this._calcActiveRanges(evt)\n      ), this._hoverBullet$.next(\n        this._calcActiveBullet(evt)\n      );\n    })), this.disposeWithMe(this._context.scene.onPointerEnter$.subscribeEvent(() => {\n      this._hoverBullet$.next(null), this._hoverCustomRanges$.next([]);\n    }));\n    const onPointerDown$ = fromEventSubject(this._context.mainComponent.onPointerDown$), onPointerUp$ = fromEventSubject(this._context.scene.onPointerUp$);\n    this.disposeWithMe(onPointerDown$.pipe(\n      mergeMap((down) => onPointerUp$.pipe(take(1), map$1((up) => ({ down, up })))),\n      filter$1(({ down, up }) => down.target === up.target && up.timeStamp - down.timeStamp < 300)\n      // filter(({ down, up }) => down.offsetX === up.offsetX && down.offsetY === up.offsetY)\n    ).subscribe(({ down }) => {\n      if (down.button === 2)\n        return;\n      const ranges = this._calcActiveRanges(down);\n      ranges.length && this._clickCustomRanges$.next(ranges.pop());\n      const bullet = this._calcActiveBullet(down);\n      bullet && this._clickBullet$.next(bullet);\n    }));\n  }\n  _buildCustomRangeBoundsBySegment(segmentId, segmentPage = -1) {\n    var _a28, _b, _c;\n    const customRanges = (_c = (_b = (_a28 = this._context.unit.getSelfOrHeaderFooterModel(segmentId)) == null ? void 0 : _a28.getBody()) == null ? void 0 : _b.customRanges) != null ? _c : [], layouts = [];\n    return customRanges.forEach((range) => {\n      const textRange = {\n        startOffset: range.startIndex,\n        endOffset: range.endIndex,\n        collapsed: !1,\n        segmentId\n      }, rects = calcDocRangePositions(textRange, this._documents, this._skeleton, segmentPage);\n      if (!rects)\n        return null;\n      layouts.push({\n        customRange: range,\n        rects,\n        segmentId,\n        segmentPageIndex: segmentPage\n      });\n    }), layouts;\n  }\n  _buildCustomRangeBounds() {\n    var _a28;\n    if (!this._customRangeDirty)\n      return;\n    this._customRangeDirty = !1;\n    const customRangeBounds = [];\n    customRangeBounds.push(...this._buildCustomRangeBoundsBySegment()), (_a28 = this._skeleton.getSkeletonData()) == null || _a28.pages.forEach((page, pageIndex) => {\n      page.headerId && customRangeBounds.push(...this._buildCustomRangeBoundsBySegment(page.headerId, pageIndex)), page.footerId && customRangeBounds.push(...this._buildCustomRangeBoundsBySegment(page.footerId, pageIndex));\n    }), this._customRangeBounds = customRangeBounds;\n  }\n  _calcActiveRanges(evt) {\n    this._buildCustomRangeBounds();\n    const { offsetX, offsetY } = evt, { x, y } = transformOffset2Bound(offsetX, offsetY, this._context.scene);\n    return this._customRangeBounds.filter((layout) => layout.rects.some((rect) => {\n      const { left, right, top, bottom } = rect;\n      return x >= left && x <= right && y >= top && y <= bottom;\n    })).map(\n      (range) => ({\n        segmentId: range.segmentId,\n        range: range.customRange,\n        segmentPageIndex: range.segmentPageIndex,\n        rects: range.rects\n      })\n    );\n  }\n  _buildBulletBoundsBySegment(segmentId, segmentPage = -1) {\n    var _a28, _b, _c, _d, _e;\n    const body = (_a28 = this._context.unit.getSelfOrHeaderFooterModel(segmentId)) == null ? void 0 : _a28.getBody(), paragraphs = ((_b = body == null ? void 0 : body.paragraphs) != null ? _b : []).filter((p2) => p2.bullet && p2.bullet.listType.indexOf(\"CHECK_LIST\") === 0), bounds = [], skeletonData = this._skeleton.getSkeletonData();\n    if (!skeletonData)\n      return bounds;\n    const calc = /* @__PURE__ */ __name((pages) => {\n      var _a29, _b2, _c2;\n      for (const page of pages) {\n        const sections = [...page.sections];\n        if (page.skeTables) {\n          const tables = Array.from(page.skeTables.values());\n          sections.push(...tables.map((i) => i.rows.map((i2) => i2.cells.map((i3) => i3.sections))).flat(4));\n        }\n        for (const selection of sections)\n          for (const column of selection.columns)\n            for (const line of column.lines)\n              if (line.paragraphStart) {\n                const paragraph = paragraphs.find((p2) => p2.startIndex === line.paragraphIndex);\n                if (paragraph) {\n                  const targetLine = line, bulletNode = (_c2 = (_b2 = (_a29 = targetLine == null ? void 0 : targetLine.divides) == null ? void 0 : _a29[0]) == null ? void 0 : _b2.glyphGroup) == null ? void 0 : _c2[0];\n                  if (!bulletNode)\n                    continue;\n                  const rect = calcDocGlyphPosition(bulletNode, this._documents, this._skeleton, segmentPage);\n                  if (!rect)\n                    continue;\n                  bounds.push({\n                    rect,\n                    segmentId,\n                    segmentPageIndex: segmentPage,\n                    paragraph\n                  });\n                }\n              }\n      }\n      return bounds;\n    }, \"calc\");\n    if (segmentId) {\n      const page = (_e = (_c = skeletonData.skeFooters.get(segmentId)) == null ? void 0 : _c.values()) != null ? _e : (_d = skeletonData.skeHeaders.get(segmentId)) == null ? void 0 : _d.values();\n      return page ? calc(Array.from(page)) : bounds;\n    }\n    return calc(skeletonData.pages);\n  }\n  _buildBulletBounds() {\n    var _a28;\n    this._bulletDirty && (this._bulletDirty = !1, this._bulletBounds = [], this._bulletBounds.push(...this._buildBulletBoundsBySegment()), (_a28 = this._skeleton.getSkeletonData()) == null || _a28.pages.forEach((page, pageIndex) => {\n      page.headerId && this._bulletBounds.push(...this._buildBulletBoundsBySegment(page.headerId, pageIndex)), page.footerId && this._bulletBounds.push(...this._buildBulletBoundsBySegment(page.footerId, pageIndex));\n    }));\n  }\n  _calcActiveBullet(evt) {\n    this._buildBulletBounds();\n    const { offsetX, offsetY } = evt, { x, y } = transformOffset2Bound(offsetX, offsetY, this._context.scene);\n    return this._bulletBounds.find((layout) => {\n      const { left, right, top, bottom } = layout.rect;\n      return x >= left && x <= right && y >= top && y <= bottom;\n    });\n  }\n}, __name(_a15, \"DocEventManagerService\"), _a15);\nDocEventManagerService = __decorateClass$c([\n  __decorateParam$c(1, Inject(DocSkeletonManagerService))\n], DocEventManagerService);\nvar __defProp$b = Object.defineProperty, __getOwnPropDesc$b = Object.getOwnPropertyDescriptor, __decorateClass$b = /* @__PURE__ */ __name((decorators, target, key, kind) => {\n  for (var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$b(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)\n    (decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n  return kind && result && __defProp$b(target, key, result), result;\n}, \"__decorateClass$b\"), __decorateParam$b = /* @__PURE__ */ __name((index, decorator) => (target, key) => decorator(target, key, index), \"__decorateParam$b\"), _a16;\nlet DocChecklistRenderController = (_a16 = class extends Disposable {\n  constructor(_context, _docSkeletonManagerService, _commandService, _docEventManagerService, _textSelectionManagerService) {\n    super(), this._context = _context, this._docSkeletonManagerService = _docSkeletonManagerService, this._commandService = _commandService, this._docEventManagerService = _docEventManagerService, this._textSelectionManagerService = _textSelectionManagerService, this._initPointerDownObserver(), this._initHoverCursor();\n  }\n  _initPointerDownObserver() {\n    this._docEventManagerService.clickBullets$.subscribe((paragraph) => {\n      this._commandService.executeCommand(ToggleCheckListCommand.id, {\n        index: paragraph.paragraph.startIndex,\n        segmentId: paragraph.segmentId\n      });\n    });\n  }\n  _initHoverCursor() {\n    this.disposeWithMe(\n      this._docEventManagerService.hoverBullet$.subscribe((paragraph) => {\n        paragraph ? this._context.mainComponent.setCursor(CURSOR_TYPE.POINTER) : this._context.mainComponent.setCursor(CURSOR_TYPE.TEXT);\n      })\n    );\n  }\n  _getTransformCoordForDocumentOffset(document2, viewport, evtOffsetX, evtOffsetY) {\n    const { documentTransform } = document2.getOffsetConfig(), originCoord = viewport.transformVector2SceneCoord(Vector2.FromArray([evtOffsetX, evtOffsetY]));\n    if (originCoord)\n      return documentTransform.clone().invert().applyPoint(originCoord);\n  }\n}, __name(_a16, \"DocChecklistRenderController\"), _a16);\nDocChecklistRenderController = __decorateClass$b([\n  __decorateParam$b(1, Inject(DocSkeletonManagerService)),\n  __decorateParam$b(2, ICommandService),\n  __decorateParam$b(3, Inject(DocEventManagerService)),\n  __decorateParam$b(4, Inject(DocSelectionManagerService))\n], DocChecklistRenderController);\nvar __defProp$a = Object.defineProperty, __getOwnPropDesc$a = Object.getOwnPropertyDescriptor, __decorateClass$a = /* @__PURE__ */ __name((decorators, target, key, kind) => {\n  for (var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$a(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)\n    (decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n  return kind && result && __defProp$a(target, key, result), result;\n}, \"__decorateClass$a\"), __decorateParam$a = /* @__PURE__ */ __name((index, decorator) => (target, key) => decorator(target, key, index), \"__decorateParam$a\"), _a17;\nlet DocClipboardController = (_a17 = class extends RxDisposable {\n  constructor(_context, _commandService, _docClipboardService, _docSelectionRenderService, _contextService) {\n    super(), this._context = _context, this._commandService = _commandService, this._docClipboardService = _docClipboardService, this._docSelectionRenderService = _docSelectionRenderService, this._contextService = _contextService, this._init();\n  }\n  _init() {\n    this._initLegacyPasteCommand();\n  }\n  _initLegacyPasteCommand() {\n    var _a28;\n    (_a28 = this._docSelectionRenderService) == null || _a28.onPaste$.pipe(takeUntil(this.dispose$)).subscribe((config) => {\n      var _a29, _b;\n      if (!whenDocOrEditor(this._contextService))\n        return;\n      config.event.preventDefault();\n      const clipboardEvent = config.event;\n      let htmlContent = (_a29 = clipboardEvent.clipboardData) == null ? void 0 : _a29.getData(\"text/html\");\n      const textContent = (_b = clipboardEvent.clipboardData) == null ? void 0 : _b.getData(\"text/plain\");\n      whenFocusEditor(this._contextService) && (htmlContent != null ? htmlContent : \"\").indexOf(\"</table>\") > -1 && (htmlContent = \"\"), this._docClipboardService.legacyPaste(htmlContent, textContent);\n    });\n  }\n}, __name(_a17, \"DocClipboardController\"), _a17);\nDocClipboardController = __decorateClass$a([\n  __decorateParam$a(1, ICommandService),\n  __decorateParam$a(2, IDocClipboardService),\n  __decorateParam$a(3, Inject(DocSelectionRenderService)),\n  __decorateParam$a(4, IContextService)\n], DocClipboardController);\nvar __defProp$9 = Object.defineProperty, __getOwnPropDesc$9 = Object.getOwnPropertyDescriptor, __decorateClass$9 = /* @__PURE__ */ __name((decorators, target, key, kind) => {\n  for (var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$9(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)\n    (decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n  return kind && result && __defProp$9(target, key, result), result;\n}, \"__decorateClass$9\"), __decorateParam$9 = /* @__PURE__ */ __name((index, decorator) => (target, key) => decorator(target, key, index), \"__decorateParam$9\");\nconst SKIP_UNIT_IDS = [\n  DEFAULT_EMPTY_DOCUMENT_VALUE,\n  DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY,\n  DOCS_NORMAL_EDITOR_UNIT_ID_KEY,\n  DOCS_ZEN_EDITOR_UNIT_ID_KEY\n];\nvar _a18;\nlet DocContextMenuRenderController = (_a18 = class extends Disposable {\n  constructor(_context, _contextMenuService, _commandService) {\n    super(), this._context = _context, this._contextMenuService = _contextMenuService, this._commandService = _commandService, SKIP_UNIT_IDS.includes(this._context.unitId) || (this._initPointerDown(), this._initEditChange());\n  }\n  _initPointerDown() {\n    var _a28, _b;\n    const documentsSubscription = ((_b = (_a28 = this._context) == null ? void 0 : _a28.mainComponent) == null ? void 0 : _b.onPointerDown$).subscribeEvent((event) => {\n      event.button === 2 && this._contextMenuService.triggerContextMenu(event, ContextMenuPosition.MAIN_AREA);\n    });\n    this.disposeWithMe(documentsSubscription);\n  }\n  _initEditChange() {\n    this.disposeWithMe(\n      this._commandService.onCommandExecuted((command) => {\n        command.id === RichTextEditingMutation.id && this._contextMenuService.visible && this._contextMenuService.hideContextMenu();\n      })\n    );\n  }\n}, __name(_a18, \"DocContextMenuRenderController\"), _a18);\nDocContextMenuRenderController = __decorateClass$9([\n  __decorateParam$9(1, IContextMenuService),\n  __decorateParam$9(2, ICommandService)\n], DocContextMenuRenderController);\nvar __defProp$8 = Object.defineProperty, __getOwnPropDesc$8 = Object.getOwnPropertyDescriptor, __decorateClass$8 = /* @__PURE__ */ __name((decorators, target, key, kind) => {\n  for (var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$8(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)\n    (decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n  return kind && result && __defProp$8(target, key, result), result;\n}, \"__decorateClass$8\"), __decorateParam$8 = /* @__PURE__ */ __name((index, decorator) => (target, key) => decorator(target, key, index), \"__decorateParam$8\"), _a19;\nlet DocEditorBridgeController = (_a19 = class extends Disposable {\n  constructor(_context, _univerInstanceService, _editorService, _commandService, _docSelectionRenderService, _docSkeletonManagerService, _renderManagerService) {\n    super();\n    __publicField(this, \"_initialEditors\", /* @__PURE__ */ new Set());\n    this._context = _context, this._univerInstanceService = _univerInstanceService, this._editorService = _editorService, this._commandService = _commandService, this._docSelectionRenderService = _docSelectionRenderService, this._docSkeletonManagerService = _docSkeletonManagerService, this._renderManagerService = _renderManagerService, this._initialize();\n  }\n  _initialize() {\n    this.disposeWithMe(\n      this._editorService.resize$.subscribe((unitId) => {\n        unitId === this._context.unitId && this._resize(unitId);\n      })\n    ), this._editorService.getAllEditor().forEach((editor) => {\n      const unitId = editor.editorUnitId;\n      unitId === this._context.unitId && (this._initialEditors.has(unitId) || (this._initialEditors.add(unitId), this._resize(unitId)));\n    }), this._commandExecutedListener(), this._initialSetValue(), this._initialBlur(), this._initialFocus(), this._initialValueChange();\n  }\n  // eslint-disable-next-line complexity\n  _resize(unitId) {\n    var _a28, _b;\n    if (unitId == null)\n      return;\n    const editor = this._editorService.getEditor(unitId);\n    if ((editor == null ? void 0 : editor.cancelDefaultResizeListener) === !0)\n      return;\n    const editorDataModel = this._univerInstanceService.getUniverDocInstance(unitId);\n    if (!editorDataModel)\n      return;\n    const skeleton = this._docSkeletonManagerService.getSkeleton();\n    if (editor == null || editor.render == null || skeleton == null || editorDataModel == null)\n      return;\n    skeleton.calculate();\n    const { marginTop = 0, marginBottom = 0, marginLeft = 0, marginRight = 0 } = editorDataModel.getSnapshot().documentStyle, { scene, mainComponent } = editor.render;\n    let { actualHeight, actualWidth } = skeleton.getActualSize();\n    actualHeight += marginTop + marginBottom, actualWidth += marginLeft + marginRight;\n    const { width, height } = editor.getBoundingClientRect(), viewportMain = scene.getViewport(VIEWPORT_KEY.VIEW_MAIN);\n    let scrollBar = viewportMain == null ? void 0 : viewportMain.getScrollBar();\n    const contentWidth = Math.max(actualWidth, width), contentHeight = Math.max(actualHeight, height);\n    scene.transformByState({\n      width: contentWidth,\n      height: contentHeight\n    }), mainComponent == null || mainComponent.resize(contentWidth, contentHeight), editor.isSingle() ? actualWidth > width ? scrollBar == null ? viewportMain && new ScrollBar(viewportMain, { barSize: 8, enableVertical: !1 }) : viewportMain == null || viewportMain.resetCanvasSizeAndUpdateScroll() : (scrollBar = null, viewportMain == null || viewportMain.scrollToBarPos({ x: 0, y: 0 }), (_b = viewportMain == null ? void 0 : viewportMain.getScrollBar()) == null || _b.dispose()) : actualHeight > height ? scrollBar == null ? viewportMain && new ScrollBar(viewportMain, { enableHorizontal: !1, barSize: 8 }) : viewportMain == null || viewportMain.resetCanvasSizeAndUpdateScroll() : (scrollBar = null, viewportMain == null || viewportMain.scrollToBarPos({ x: 0, y: 0 }), (_a28 = viewportMain == null ? void 0 : viewportMain.getScrollBar()) == null || _a28.dispose());\n  }\n  _initialSetValue() {\n    this.disposeWithMe(\n      this._editorService.setValue$.subscribe((param) => {\n        param.editorUnitId === this._context.unitId && this._commandService.executeCommand(CoverContentCommand.id, {\n          unitId: param.editorUnitId,\n          body: param.body,\n          segmentId: null\n        });\n      })\n    );\n  }\n  _initialBlur() {\n    this.disposeWithMe(\n      this._editorService.blur$.subscribe(() => {\n        this._docSelectionRenderService.removeAllRanges(), this._docSelectionRenderService.blur();\n      })\n    ), this.disposeWithMe(\n      this._docSelectionRenderService.onBlur$.subscribe(() => {\n        const { unitId } = this._context, editor = this._editorService.getEditor(unitId), focusEditor = this._editorService.getFocusEditor();\n        editor == null || editor.isSheetEditor() || focusEditor && focusEditor.editorUnitId === unitId || this._editorService.blur();\n      })\n    );\n  }\n  _initialFocus() {\n    this.disposeWithMe(\n      this._editorService.focus$.subscribe((textRange) => {\n        var _a28;\n        ((_a28 = this._editorService.getFocusEditor()) == null ? void 0 : _a28.editorUnitId) === this._context.unitId && (this._docSelectionRenderService.removeAllRanges(), this._docSelectionRenderService.addDocRanges([textRange]));\n      })\n    );\n    const focusExcepts = [\n      \"univer-formula-search\",\n      \"univer-formula-help\",\n      \"formula-help-decorator\",\n      \"univer-formula-help-param\"\n    ];\n    this.disposeWithMe(\n      fromEvent(window, \"mousedown\").subscribe((event) => {\n        const hasSearch = event.target.classList[0] || \"\";\n        if (checkForSubstrings(hasSearch, focusExcepts)) {\n          this._editorService.changeSpreadsheetFocusState(!0), event.stopPropagation();\n          return;\n        }\n        this._editorService.changeSpreadsheetFocusState(!1);\n      })\n    ), this._univerInstanceService.getAllUnitsForType(UniverInstanceType.UNIVER_SHEET).forEach((unit) => {\n      const unitId = unit.getUnitId(), render2 = this._renderManagerService.getRenderById(unitId), canvasEle = render2 == null ? void 0 : render2.engine.getCanvas().getCanvasEle();\n      canvasEle != null && fromEvent(canvasEle, \"mousedown\").subscribe((evt) => {\n        this._editorService.changeSpreadsheetFocusState(!0), evt.stopPropagation();\n      });\n    });\n  }\n  _initialValueChange() {\n    this.disposeWithMe(\n      this._docSelectionRenderService.onCompositionupdate$.subscribe(this._valueChange.bind(this))\n    ), this.disposeWithMe(\n      this._docSelectionRenderService.onInput$.subscribe(this._valueChange.bind(this))\n    ), this.disposeWithMe(\n      this._docSelectionRenderService.onKeydown$.subscribe(this._valueChange.bind(this))\n    ), this.disposeWithMe(\n      this._docSelectionRenderService.onPaste$.subscribe(this._valueChange.bind(this))\n    );\n  }\n  _valueChange() {\n    const { unitId } = this._context, editor = this._editorService.getEditor(unitId);\n    editor == null || editor.isSheetEditor() || this._editorService.refreshValueChange(unitId);\n  }\n  /**\n   * Listen to document edits to refresh the size of the formula editor.\n   */\n  _commandExecutedListener() {\n    const updateCommandList = [RichTextEditingMutation.id, SetEditorResizeOperation.id];\n    this.disposeWithMe(\n      this._commandService.onCommandExecuted((command) => {\n        if (updateCommandList.includes(command.id)) {\n          const params = command.params, { unitId } = params;\n          if (this._editorService.isSheetEditor(unitId) || unitId !== this._context.unitId)\n            return;\n          this._resize(unitId), this._valueChange();\n        }\n      })\n    );\n  }\n}, __name(_a19, \"DocEditorBridgeController\"), _a19);\nDocEditorBridgeController = __decorateClass$8([\n  __decorateParam$8(1, IUniverInstanceService),\n  __decorateParam$8(2, IEditorService),\n  __decorateParam$8(3, ICommandService),\n  __decorateParam$8(4, Inject(DocSelectionRenderService)),\n  __decorateParam$8(5, Inject(DocSkeletonManagerService)),\n  __decorateParam$8(6, IRenderManagerService)\n], DocEditorBridgeController);\nvar __defProp$7 = Object.defineProperty, __getOwnPropDesc$7 = Object.getOwnPropertyDescriptor, __decorateClass$7 = /* @__PURE__ */ __name((decorators, target, key, kind) => {\n  for (var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$7(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)\n    (decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n  return kind && result && __defProp$7(target, key, result), result;\n}, \"__decorateClass$7\"), __decorateParam$7 = /* @__PURE__ */ __name((index, decorator) => (target, key) => decorator(target, key, index), \"__decorateParam$7\"), _a20;\nlet DocIMEInputController = (_a20 = class extends Disposable {\n  constructor(_context, _univerInstanceService, _renderManagerSrv, _docSelectionRenderService, _docImeInputManagerService, _commandService) {\n    super();\n    __publicField(this, \"_previousIMEContent\", \"\");\n    __publicField(this, \"_isCompositionStart\", !0);\n    __publicField(this, \"_onStartSubscription\");\n    __publicField(this, \"_onUpdateSubscription\");\n    __publicField(this, \"_onEndSubscription\");\n    this._context = _context, this._univerInstanceService = _univerInstanceService, this._renderManagerSrv = _renderManagerSrv, this._docSelectionRenderService = _docSelectionRenderService, this._docImeInputManagerService = _docImeInputManagerService, this._commandService = _commandService, this._initialize();\n  }\n  dispose() {\n    var _a28, _b, _c;\n    (_a28 = this._onStartSubscription) == null || _a28.unsubscribe(), (_b = this._onUpdateSubscription) == null || _b.unsubscribe(), (_c = this._onEndSubscription) == null || _c.unsubscribe();\n  }\n  _initialize() {\n    this._initialOnCompositionstart(), this._initialOnCompositionUpdate(), this._initialOnCompositionend();\n  }\n  _initialOnCompositionstart() {\n    this._onStartSubscription = this._docSelectionRenderService.onCompositionstart$.subscribe((config) => {\n      if (config == null)\n        return;\n      this._resetIME();\n      const { activeRange } = config;\n      activeRange != null && this._docImeInputManagerService.setActiveRange(Tools.deepClone(activeRange));\n    });\n  }\n  _initialOnCompositionUpdate() {\n    this._onUpdateSubscription = this._docSelectionRenderService.onCompositionupdate$.subscribe((config) => {\n      this._updateContent(config, !0);\n    });\n  }\n  _initialOnCompositionend() {\n    this._onEndSubscription = this._docSelectionRenderService.onCompositionend$.subscribe((config) => {\n      this._updateContent(config, !1);\n    });\n  }\n  async _updateContent(config, isUpdate) {\n    var _a28;\n    if (config == null)\n      return;\n    const documentModel = this._univerInstanceService.getCurrentUniverDocInstance();\n    if (!documentModel)\n      return;\n    const skeleton = (_a28 = this._renderManagerSrv.getRenderById(documentModel.getUnitId())) == null ? void 0 : _a28.with(DocSkeletonManagerService).getSkeleton(), { event, activeRange } = config;\n    if (skeleton == null || activeRange == null)\n      return;\n    const content = event.data;\n    content === this._previousIMEContent && isUpdate || (await this._commandService.executeCommand(IMEInputCommand.id, {\n      unitId: documentModel.getUnitId(),\n      newText: content,\n      oldTextLen: this._previousIMEContent.length,\n      isCompositionStart: this._isCompositionStart,\n      isCompositionEnd: !isUpdate\n    }), isUpdate ? (this._isCompositionStart && (this._isCompositionStart = !1), this._previousIMEContent = content) : this._resetIME());\n  }\n  _resetIME() {\n    this._previousIMEContent = \"\", this._isCompositionStart = !0, this._docImeInputManagerService.clearUndoRedoMutationParamsCache(), this._docImeInputManagerService.setActiveRange(null);\n  }\n}, __name(_a20, \"DocIMEInputController\"), _a20);\nDocIMEInputController = __decorateClass$7([\n  __decorateParam$7(1, IUniverInstanceService),\n  __decorateParam$7(2, IRenderManagerService),\n  __decorateParam$7(3, Inject(DocSelectionRenderService)),\n  __decorateParam$7(4, Inject(DocIMEInputManagerService)),\n  __decorateParam$7(5, ICommandService)\n], DocIMEInputController);\nvar __defProp$6 = Object.defineProperty, __getOwnPropDesc$6 = Object.getOwnPropertyDescriptor, __decorateClass$6 = /* @__PURE__ */ __name((decorators, target, key, kind) => {\n  for (var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$6(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)\n    (decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n  return kind && result && __defProp$6(target, key, result), result;\n}, \"__decorateClass$6\"), __decorateParam$6 = /* @__PURE__ */ __name((index, decorator) => (target, key) => decorator(target, key, index), \"__decorateParam$6\"), _a21;\nlet DocInputController = (_a21 = class extends Disposable {\n  constructor(_context, _docSelectionRenderService, _docSkeletonManagerService, _commandService) {\n    super();\n    __publicField(this, \"_onInputSubscription\");\n    this._context = _context, this._docSelectionRenderService = _docSelectionRenderService, this._docSkeletonManagerService = _docSkeletonManagerService, this._commandService = _commandService, this._init();\n  }\n  dispose() {\n    var _a28;\n    super.dispose(), (_a28 = this._onInputSubscription) == null || _a28.unsubscribe();\n  }\n  _init() {\n    this._initialNormalInput();\n  }\n  _initialNormalInput() {\n    this._onInputSubscription = this._docSelectionRenderService.onInput$.subscribe(async (config) => {\n      if (config == null)\n        return;\n      const unitId = this._context.unitId, { event, content = \"\", activeRange } = config, e = event, skeleton = this._docSkeletonManagerService.getSkeleton();\n      if (e.data == null || skeleton == null || !skeleton || !activeRange)\n        return;\n      const { segmentId } = activeRange, UNITS = [DOCS_NORMAL_EDITOR_UNIT_ID_KEY, DOCS_ZEN_EDITOR_UNIT_ID_KEY, DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY];\n      await this._commandService.executeCommand(InsertCommand.id, {\n        unitId,\n        body: {\n          dataStream: content\n        },\n        range: activeRange,\n        segmentId,\n        extendLastRange: UNITS.includes(unitId)\n      }), content === \" \" && await this._commandService.executeCommand(AfterSpaceCommand.id);\n    });\n  }\n}, __name(_a21, \"DocInputController\"), _a21);\nDocInputController = __decorateClass$6([\n  __decorateParam$6(1, Inject(DocSelectionRenderService)),\n  __decorateParam$6(2, Inject(DocSkeletonManagerService)),\n  __decorateParam$6(3, ICommandService)\n], DocInputController);\nconst _DocPageLayoutService = class _DocPageLayoutService extends Disposable {\n  constructor(_context) {\n    super(), this._context = _context;\n  }\n  calculatePagePosition() {\n    var _a28, _b;\n    const docObject = neoGetDocObject(this._context), zoomRatio = (_b = (_a28 = this._context.unit.getSettings()) == null ? void 0 : _a28.zoomRatio) != null ? _b : 1, { document: docsComponent, scene, docBackground } = docObject, parent = scene == null ? void 0 : scene.getParent(), { width: docsWidth, height: docsHeight, pageMarginLeft, pageMarginTop } = docsComponent;\n    if (parent == null || docsWidth === Number.POSITIVE_INFINITY || docsHeight === Number.POSITIVE_INFINITY)\n      return;\n    const { width: engineWidth, height: engineHeight } = parent;\n    let docsLeft = 0, docsTop = 0, sceneWidth = 0, sceneHeight = 0, scrollToX = Number.POSITIVE_INFINITY;\n    engineWidth > (docsWidth + pageMarginLeft * 2) * zoomRatio ? (docsLeft = engineWidth / 2 - docsWidth * zoomRatio / 2, docsLeft /= zoomRatio, sceneWidth = (engineWidth - pageMarginLeft * 2) / zoomRatio, scrollToX = 0) : (docsLeft = pageMarginLeft, sceneWidth = docsWidth + pageMarginLeft * 2, scrollToX = (sceneWidth - engineWidth / zoomRatio) / 2), engineHeight > docsHeight ? (docsTop = engineHeight / 2 - docsHeight / 2, sceneHeight = (engineHeight - pageMarginTop * 2) / zoomRatio) : (docsTop = pageMarginTop, sceneHeight = docsHeight + pageMarginTop * 2), scene.resize(sceneWidth, sceneHeight + 200), docsComponent.translate(docsLeft, docsTop), docBackground.translate(docsLeft, docsTop);\n    const viewport = scene.getViewport(VIEWPORT_KEY.VIEW_MAIN);\n    return scrollToX !== Number.POSITIVE_INFINITY && viewport != null && viewport.scrollToViewportPos({\n      viewportScrollX: scrollToX\n    }), this;\n  }\n};\n__name(_DocPageLayoutService, \"DocPageLayoutService\");\nlet DocPageLayoutService = _DocPageLayoutService;\nvar __defProp$5 = Object.defineProperty, __getOwnPropDesc$5 = Object.getOwnPropertyDescriptor, __decorateClass$5 = /* @__PURE__ */ __name((decorators, target, key, kind) => {\n  for (var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$5(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)\n    (decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n  return kind && result && __defProp$5(target, key, result), result;\n}, \"__decorateClass$5\"), __decorateParam$5 = /* @__PURE__ */ __name((index, decorator) => (target, key) => decorator(target, key, index), \"__decorateParam$5\"), _a22;\nlet DocResizeRenderController = (_a22 = class extends Disposable {\n  constructor(_context, _docPageLayoutService, _textSelectionManagerService) {\n    super(), this._context = _context, this._docPageLayoutService = _docPageLayoutService, this._textSelectionManagerService = _textSelectionManagerService;\n    const unitId = this._context.unitId;\n    if (isInternalEditorID(unitId) && unitId !== DOCS_ZEN_EDITOR_UNIT_ID_KEY) return this;\n    this._initResize();\n  }\n  _initResize() {\n    this.disposeWithMe(\n      fromEventSubject(this._context.engine.onTransformChange$).pipe(\n        filter$1((evt) => evt.type === TRANSFORM_CHANGE_OBSERVABLE_TYPE.resize),\n        throttleTime(0, animationFrameScheduler)\n      ).subscribe(() => {\n        this._docPageLayoutService.calculatePagePosition(), this._textSelectionManagerService.refreshSelection();\n      })\n    );\n  }\n}, __name(_a22, \"DocResizeRenderController\"), _a22);\nDocResizeRenderController = __decorateClass$5([\n  __decorateParam$5(1, Inject(DocPageLayoutService)),\n  __decorateParam$5(2, Inject(DocSelectionManagerService))\n], DocResizeRenderController);\nvar __defProp$4 = Object.defineProperty, __getOwnPropDesc$4 = Object.getOwnPropertyDescriptor, __decorateClass$4 = /* @__PURE__ */ __name((decorators, target, key, kind) => {\n  for (var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$4(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)\n    (decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n  return kind && result && __defProp$4(target, key, result), result;\n}, \"__decorateClass$4\"), __decorateParam$4 = /* @__PURE__ */ __name((index, decorator) => (target, key) => decorator(target, key, index), \"__decorateParam$4\"), _a23;\nlet DocSelectionRenderController = (_a23 = class extends Disposable {\n  constructor(_context, _commandService, _editorService, _instanceSrv, _docSelectionRenderService, _docSkeletonManagerService, _docSelectionManagerService) {\n    super();\n    __publicField(this, \"_loadedMap\", /* @__PURE__ */ new WeakSet());\n    this._context = _context, this._commandService = _commandService, this._editorService = _editorService, this._instanceSrv = _instanceSrv, this._docSelectionRenderService = _docSelectionRenderService, this._docSkeletonManagerService = _docSkeletonManagerService, this._docSelectionManagerService = _docSelectionManagerService, this._initialize();\n  }\n  _initialize() {\n    this._init(), this._skeletonListener(), this._commandExecutedListener(), this._refreshListener(), this._syncSelection();\n  }\n  _init() {\n    const { unitId } = this._context, docObject = neoGetDocObject(this._context);\n    docObject == null || docObject.document == null || this._loadedMap.has(docObject.document) || (this._initialMain(unitId), this._loadedMap.add(docObject.document));\n  }\n  _refreshListener() {\n    this.disposeWithMe(\n      this._docSelectionManagerService.refreshSelection$.subscribe((params) => {\n        if (params == null)\n          return;\n        const { unitId, docRanges, isEditing, options } = params;\n        unitId === this._context.unitId && (this._docSelectionRenderService.removeAllRanges(), docRanges.length && this._docSelectionRenderService.addDocRanges(docRanges, isEditing, options));\n      })\n    );\n  }\n  _syncSelection() {\n    this.disposeWithMe(\n      this._docSelectionRenderService.textSelectionInner$.subscribe((params) => {\n        params != null && this._docSelectionManagerService.__replaceTextRangesWithNoRefresh(params);\n      })\n    );\n  }\n  // eslint-disable-next-line max-lines-per-function\n  _initialMain(unitId) {\n    const docObject = neoGetDocObject(this._context), { document: document2, scene } = docObject;\n    this.disposeWithMe(document2.onPointerEnter$.subscribeEvent(() => {\n      this._isEditorReadOnly(unitId) || (document2.cursor = CURSOR_TYPE.TEXT);\n    })), this.disposeWithMe(document2.onPointerLeave$.subscribeEvent(() => {\n      document2.cursor = CURSOR_TYPE.DEFAULT, scene.resetCursor();\n    })), this.disposeWithMe(document2.onPointerDown$.subscribeEvent((evt, state) => {\n      if (this._isEditorReadOnly(unitId))\n        return;\n      const docDataModel = this._instanceSrv.getCurrentUnitForType(UniverInstanceType.UNIVER_DOC);\n      (docDataModel == null ? void 0 : docDataModel.getUnitId()) !== unitId && this._instanceSrv.setCurrentUnitForType(unitId);\n      const skeleton = this._docSkeletonManagerService.getSkeleton(), { offsetX, offsetY } = evt, coord = this._getTransformCoordForDocumentOffset(offsetX, offsetY);\n      if (coord != null) {\n        const {\n          pageLayoutType = PageLayoutType.VERTICAL,\n          pageMarginLeft,\n          pageMarginTop\n        } = document2.getOffsetConfig(), { editArea } = skeleton.findEditAreaByCoord(\n          coord,\n          pageLayoutType,\n          pageMarginLeft,\n          pageMarginTop\n        ), viewModel = this._docSkeletonManagerService.getViewModel(), preEditArea = viewModel.getEditArea();\n        preEditArea !== DocumentEditArea.BODY && editArea !== DocumentEditArea.BODY && editArea !== preEditArea && viewModel.setEditArea(editArea);\n      }\n      if (this._docSelectionRenderService.__onPointDown(evt), this._editorService.getEditor(unitId)) {\n        this._setEditorFocus(unitId);\n        const { offsetX: offsetX2, offsetY: offsetY2 } = evt;\n        setTimeout(() => {\n          unitId !== this._editorService.getFocusId() && (this._setEditorFocus(unitId), this._docSelectionRenderService.setCursorManually(offsetX2, offsetY2));\n        }, 0);\n      }\n      evt.button !== 2 && state.stopPropagation();\n    })), this.disposeWithMe(document2.onDblclick$.subscribeEvent((evt) => {\n      this._isEditorReadOnly(unitId) || this._docSelectionRenderService.__handleDblClick(evt);\n    })), this.disposeWithMe(document2.onTripleClick$.subscribeEvent((evt) => {\n      this._isEditorReadOnly(unitId) || this._docSelectionRenderService.__handleTripleClick(evt);\n    }));\n  }\n  _getTransformCoordForDocumentOffset(evtOffsetX, evtOffsetY) {\n    const docObject = neoGetDocObject(this._context), { document: document2, scene } = docObject, { documentTransform } = document2.getOffsetConfig(), activeViewport = scene.getViewports()[0];\n    if (activeViewport == null)\n      return;\n    const originCoord = activeViewport.transformVector2SceneCoord(Vector2.FromArray([evtOffsetX, evtOffsetY]));\n    return documentTransform.clone().invert().applyPoint(originCoord);\n  }\n  _isEditorReadOnly(unitId) {\n    const editor = this._editorService.getEditor(unitId);\n    return editor ? editor.isReadOnly() : !1;\n  }\n  _setEditorFocus(unitId) {\n    this._editorService.focusStyle(unitId);\n  }\n  _commandExecutedListener() {\n    const updateCommandList = [SetDocZoomRatioOperation.id];\n    this.disposeWithMe(\n      this._commandService.onCommandExecuted((command) => {\n        var _a28;\n        if (updateCommandList.includes(command.id)) {\n          const params = command.params, { unitId: documentId } = params, unitId = (_a28 = this._docSelectionManagerService.getCurrentSelection()) == null ? void 0 : _a28.unitId;\n          if (documentId !== unitId)\n            return;\n          this._docSelectionManagerService.refreshSelection();\n        }\n      })\n    );\n  }\n  _skeletonListener() {\n    let init = !1;\n    this.disposeWithMe(this._docSkeletonManagerService.currentSkeleton$.subscribe((skeleton) => {\n      if (!skeleton) return;\n      const { unitId } = this._context, isInternalEditor = isInternalEditorID(unitId);\n      (init || !isInternalEditorID(this._context.unitId)) && (isInternalEditor || this._docSelectionManagerService.replaceTextRanges([\n        {\n          startOffset: 0,\n          endOffset: 0\n        }\n      ], !1)), init = !0;\n    }));\n  }\n}, __name(_a23, \"DocSelectionRenderController\"), _a23);\nDocSelectionRenderController = __decorateClass$4([\n  __decorateParam$4(1, ICommandService),\n  __decorateParam$4(2, IEditorService),\n  __decorateParam$4(3, IUniverInstanceService),\n  __decorateParam$4(4, Inject(DocSelectionRenderService)),\n  __decorateParam$4(5, Inject(DocSkeletonManagerService)),\n  __decorateParam$4(6, Inject(DocSelectionManagerService))\n], DocSelectionRenderController);\nvar __defProp$3 = Object.defineProperty, __getOwnPropDesc$3 = Object.getOwnPropertyDescriptor, __decorateClass$3 = /* @__PURE__ */ __name((decorators, target, key, kind) => {\n  for (var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$3(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)\n    (decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n  return kind && result && __defProp$3(target, key, result), result;\n}, \"__decorateClass$3\"), __decorateParam$3 = /* @__PURE__ */ __name((index, decorator) => (target, key) => decorator(target, key, index), \"__decorateParam$3\"), _a24;\nlet DocZoomRenderController = (_a24 = class extends Disposable {\n  constructor(_context, _contextService, _docSkeletonManagerService, _univerInstanceService, _commandService, _textSelectionManagerService, _editorService, _docPageLayoutService) {\n    super(), this._context = _context, this._contextService = _contextService, this._docSkeletonManagerService = _docSkeletonManagerService, this._univerInstanceService = _univerInstanceService, this._commandService = _commandService, this._textSelectionManagerService = _textSelectionManagerService, this._editorService = _editorService, this._docPageLayoutService = _docPageLayoutService, this._initSkeletonListener(), this._initCommandExecutedListener(), this._initRenderRefresher(), setTimeout(() => this.updateViewZoom(1, !0), 20);\n  }\n  _initRenderRefresher() {\n    this._docSkeletonManagerService.currentSkeleton$.subscribe((param) => {\n      if (param == null)\n        return;\n      const { unitId, scene } = this._context;\n      this._editorService.isEditor(unitId) || this.disposeWithMe(scene.onMouseWheel$.subscribeEvent((e) => {\n        if (!e.ctrlKey || !this._contextService.getContextValue(FOCUSING_DOC))\n          return;\n        const documentModel = this._univerInstanceService.getCurrentUniverDocInstance();\n        if (!documentModel)\n          return;\n        const deltaFactor = Math.abs(e.deltaX);\n        let ratioDelta = deltaFactor < 40 ? 0.2 : deltaFactor < 80 ? 0.4 : 0.2;\n        ratioDelta *= e.deltaY > 0 ? -1 : 1, scene.scaleX < 1 && (ratioDelta /= 2);\n        const currentRatio = documentModel.zoomRatio;\n        let nextRatio = +Number.parseFloat(`${currentRatio + ratioDelta}`).toFixed(1);\n        nextRatio = nextRatio >= 4 ? 4 : nextRatio <= 0.1 ? 0.1 : nextRatio, this._commandService.executeCommand(SetDocZoomRatioCommand.id, {\n          zoomRatio: nextRatio,\n          unitId: documentModel.getUnitId()\n        }), e.preventDefault();\n      }));\n    });\n  }\n  _initSkeletonListener() {\n    this.disposeWithMe(this._docSkeletonManagerService.currentSkeleton$.subscribe((param) => {\n      if (param == null)\n        return;\n      const documentModel = this._univerInstanceService.getCurrentUniverDocInstance();\n      if (!documentModel) return;\n      const zoomRatio = documentModel.zoomRatio || 1;\n      this.updateViewZoom(zoomRatio, !1);\n    }));\n  }\n  _initCommandExecutedListener() {\n    const updateCommandList = [SetDocZoomRatioOperation.id];\n    this.disposeWithMe(this._commandService.onCommandExecuted((command) => {\n      if (updateCommandList.includes(command.id) && command.params.unitId === this._context.unitId) {\n        const zoomRatio = this._context.unit.zoomRatio || 1;\n        this.updateViewZoom(zoomRatio);\n      }\n    }));\n  }\n  updateViewZoom(zoomRatio, needRefreshSelection = !0) {\n    var _a28;\n    const docObject = neoGetDocObject(this._context);\n    docObject.scene.scale(zoomRatio, zoomRatio), this._docPageLayoutService.calculatePagePosition(), needRefreshSelection && !this._editorService.isEditor(this._context.unitId) && this._textSelectionManagerService.refreshSelection(), (_a28 = docObject.scene.getTransformer()) == null || _a28.clearSelectedObjects();\n  }\n}, __name(_a24, \"DocZoomRenderController\"), _a24);\nDocZoomRenderController = __decorateClass$3([\n  __decorateParam$3(1, IContextService),\n  __decorateParam$3(2, Inject(DocSkeletonManagerService)),\n  __decorateParam$3(3, IUniverInstanceService),\n  __decorateParam$3(4, ICommandService),\n  __decorateParam$3(5, Inject(DocSelectionManagerService)),\n  __decorateParam$3(6, IEditorService),\n  __decorateParam$3(7, Inject(DocPageLayoutService))\n], DocZoomRenderController);\nvar __defProp$2 = Object.defineProperty, __getOwnPropDesc$2 = Object.getOwnPropertyDescriptor, __decorateClass$2 = /* @__PURE__ */ __name((decorators, target, key, kind) => {\n  for (var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$2(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)\n    (decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n  return kind && result && __defProp$2(target, key, result), result;\n}, \"__decorateClass$2\"), __decorateParam$2 = /* @__PURE__ */ __name((index, decorator) => (target, key) => decorator(target, key, index), \"__decorateParam$2\");\nconst DEBOUNCE_DELAY = 300;\nvar _a25;\nlet DocStateChangeManagerService = (_a25 = class extends RxDisposable {\n  constructor(_undoRedoService, _commandService, _univerInstanceService, _docStateEmitService, _renderManagerService) {\n    super();\n    __publicField(this, \"_docStateChange$\", new BehaviorSubject(null));\n    __publicField(this, \"docStateChange$\", this._docStateChange$.asObservable());\n    // This cache used for history compose.\n    __publicField(this, \"_historyStateCache\", /* @__PURE__ */ new Map());\n    // This cache used for collaboration state compose.\n    __publicField(this, \"_changeStateCache\", /* @__PURE__ */ new Map());\n    __publicField(this, \"_historyTimer\", null);\n    __publicField(this, \"_changeStateCacheTimer\", null);\n    this._undoRedoService = _undoRedoService, this._commandService = _commandService, this._univerInstanceService = _univerInstanceService, this._docStateEmitService = _docStateEmitService, this._renderManagerService = _renderManagerService, this._initialize(), this._listenDocStateChange();\n  }\n  _setChangeState(changeState) {\n    this._cacheChangeState(changeState, \"history\"), this._cacheChangeState(changeState, \"collaboration\");\n  }\n  _initialize() {\n    this.disposeWithMe(\n      this._commandService.beforeCommandExecuted((command) => {\n        if (command.id === UndoCommandId || command.id === RedoCommandId) {\n          const univerDoc = this._univerInstanceService.getCurrentUniverDocInstance();\n          if (univerDoc == null)\n            return;\n          const unitId = univerDoc.getUnitId();\n          this._pushHistory(unitId), this._emitChangeState(unitId);\n        }\n      })\n    );\n  }\n  _listenDocStateChange() {\n    this._docStateEmitService.docStateChangeParams$.pipe(takeUntil(this.dispose$)).subscribe((changeStateInfo) => {\n      var _a28;\n      if (changeStateInfo == null)\n        return;\n      const { isCompositionEnd, ...changeState } = changeStateInfo, imeInputManagerService = (_a28 = this._renderManagerService.getRenderById(changeStateInfo.unitId)) == null ? void 0 : _a28.with(DocIMEInputManagerService);\n      if (imeInputManagerService != null) {\n        if (isCompositionEnd) {\n          const historyParams = imeInputManagerService.fetchComposedUndoRedoMutationParams();\n          if (historyParams == null)\n            throw new Error(\"historyParams is null in RichTextEditingMutation\");\n          const { undoMutationParams, redoMutationParams, previousActiveRange } = historyParams;\n          changeState.redoState.actions = redoMutationParams.actions, changeState.undoState.actions = undoMutationParams.actions, changeState.undoState.textRanges = [previousActiveRange];\n        }\n        this._setChangeState(changeState);\n      }\n    });\n  }\n  _cacheChangeState(changeState, type = \"history\") {\n    const { trigger, unitId, noHistory, debounce = !1 } = changeState;\n    if (noHistory || trigger == null || type === \"history\" && (trigger === RedoCommandId || trigger === UndoCommandId))\n      return;\n    const stateCache = type === \"history\" ? this._historyStateCache : this._changeStateCache, cb = type === \"history\" ? this._pushHistory.bind(this) : this._emitChangeState.bind(this);\n    if (stateCache.has(unitId)) {\n      const cacheStates = stateCache.get(unitId);\n      cacheStates == null || cacheStates.push(changeState);\n    } else\n      stateCache.set(unitId, [changeState]);\n    debounce ? type === \"history\" ? (this._historyTimer && clearTimeout(this._historyTimer), this._historyTimer = setTimeout(() => {\n      cb(unitId);\n    }, DEBOUNCE_DELAY)) : (this._changeStateCacheTimer && clearTimeout(this._changeStateCacheTimer), this._changeStateCacheTimer = setTimeout(() => {\n      cb(unitId);\n    }, DEBOUNCE_DELAY)) : cb(unitId);\n  }\n  _pushHistory(unitId) {\n    const undoRedoService = this._undoRedoService, cacheStates = this._historyStateCache.get(unitId);\n    if (!Array.isArray(cacheStates) || cacheStates.length === 0)\n      return;\n    const len = cacheStates.length, commandId = cacheStates[0].commandId, firstState = cacheStates[0], lastState = cacheStates[len - 1], redoParams = {\n      unitId,\n      actions: cacheStates.reduce((acc, cur) => JSONX.compose(acc, cur.redoState.actions), null),\n      textRanges: lastState.redoState.textRanges\n    }, undoParams = {\n      unitId,\n      // Always need to put undoParams after redoParams, because `reverse` will change the `cacheStates` order.\n      actions: cacheStates.reverse().reduce((acc, cur) => JSONX.compose(acc, cur.undoState.actions), null),\n      textRanges: firstState.undoState.textRanges\n    };\n    undoRedoService.pushUndoRedo({\n      unitID: unitId,\n      undoMutations: [{ id: commandId, params: undoParams }],\n      redoMutations: [{ id: commandId, params: redoParams }]\n    }), cacheStates.length = 0;\n  }\n  _emitChangeState(unitId) {\n    const cacheStates = this._changeStateCache.get(unitId);\n    if (!Array.isArray(cacheStates) || cacheStates.length === 0)\n      return;\n    const len = cacheStates.length, { commandId, trigger, segmentId, noHistory, debounce } = cacheStates[0], firstState = cacheStates[0], lastState = cacheStates[len - 1], redoState = {\n      unitId,\n      actions: cacheStates.reduce((acc, cur) => JSONX.compose(acc, cur.redoState.actions), null),\n      textRanges: lastState.redoState.textRanges\n    }, undoState = {\n      unitId,\n      // Always need to put undoParams after redoParams, because `reverse` will change the `cacheStates` order.\n      actions: cacheStates.reverse().reduce((acc, cur) => JSONX.compose(acc, cur.undoState.actions), null),\n      textRanges: firstState.undoState.textRanges\n    }, changeState = {\n      commandId,\n      unitId,\n      trigger,\n      redoState,\n      undoState,\n      segmentId,\n      noHistory,\n      debounce\n    };\n    cacheStates.length = 0, this._docStateChange$.next(changeState);\n  }\n}, __name(_a25, \"DocStateChangeManagerService\"), _a25);\nDocStateChangeManagerService = __decorateClass$2([\n  OnLifecycle(LifecycleStages.Ready, DocStateChangeManagerService),\n  __decorateParam$2(0, Inject(IUndoRedoService)),\n  __decorateParam$2(1, ICommandService),\n  __decorateParam$2(2, IUniverInstanceService),\n  __decorateParam$2(3, Inject(DocStateEmitService)),\n  __decorateParam$2(4, IRenderManagerService)\n], DocStateChangeManagerService);\nvar __defProp$1 = Object.defineProperty, __getOwnPropDesc$1 = Object.getOwnPropertyDescriptor, __decorateClass$1 = /* @__PURE__ */ __name((decorators, target, key, kind) => {\n  for (var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$1(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)\n    (decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n  return kind && result && __defProp$1(target, key, result), result;\n}, \"__decorateClass$1\"), __decorateParam$1 = /* @__PURE__ */ __name((index, decorator) => (target, key) => decorator(target, key, index), \"__decorateParam$1\"), _a26;\nlet DocsRenderService = (_a26 = class extends RxDisposable {\n  constructor(_instanceSrv, _renderManagerService) {\n    super(), this._instanceSrv = _instanceSrv, this._renderManagerService = _renderManagerService, this._init();\n  }\n  _init() {\n    this._renderManagerService.createRender$.pipe(takeUntil(this.dispose$)).subscribe((unitId) => this._createRenderWithId(unitId)), this._instanceSrv.getAllUnitsForType(UniverInstanceType.UNIVER_DOC).forEach((documentModel) => this._createRenderer(documentModel)), this._instanceSrv.getTypeOfUnitAdded$(UniverInstanceType.UNIVER_DOC).pipe(takeUntil(this.dispose$)).subscribe((doc) => this._createRenderer(doc)), this._instanceSrv.getTypeOfUnitDisposed$(UniverInstanceType.UNIVER_DOC).pipe(takeUntil(this.dispose$)).subscribe((doc) => this._disposeRenderer(doc));\n  }\n  _createRenderer(doc) {\n    const unitId = doc.getUnitId();\n    this._renderManagerService.has(unitId) || (this._createRenderWithId(unitId), this._renderManagerService.setCurrent(unitId));\n  }\n  _createRenderWithId(unitId) {\n    this._renderManagerService.createRender(unitId);\n  }\n  _disposeRenderer(doc) {\n    const unitId = doc.getUnitId();\n    this._renderManagerService.removeRender(unitId);\n  }\n}, __name(_a26, \"DocsRenderService\"), _a26);\nDocsRenderService = __decorateClass$1([\n  OnLifecycle(LifecycleStages.Ready, DocsRenderService),\n  __decorateParam$1(0, IUniverInstanceService),\n  __decorateParam$1(1, IRenderManagerService)\n], DocsRenderService);\nconst BreakLineShortcut = {\n  id: EnterCommand.id,\n  preconditions: whenDocAndEditorFocusedWithBreakLine,\n  binding: KeyCode.ENTER\n}, DeleteLeftShortcut = {\n  id: DeleteLeftCommand.id,\n  preconditions: whenDocAndEditorFocused,\n  binding: KeyCode.BACKSPACE\n}, DeleteRightShortcut = {\n  id: DeleteRightCommand.id,\n  preconditions: whenDocAndEditorFocused,\n  binding: KeyCode.DELETE\n}, MoveCursorUpShortcut = {\n  id: MoveCursorOperation.id,\n  binding: KeyCode.ARROW_UP,\n  preconditions: whenDocAndEditorFocused,\n  staticParameters: {\n    direction: Direction.UP\n  }\n}, MoveCursorDownShortcut = {\n  id: MoveCursorOperation.id,\n  binding: KeyCode.ARROW_DOWN,\n  preconditions: whenDocAndEditorFocused,\n  staticParameters: {\n    direction: Direction.DOWN\n  }\n}, MoveCursorLeftShortcut = {\n  id: MoveCursorOperation.id,\n  binding: KeyCode.ARROW_LEFT,\n  preconditions: whenDocAndEditorFocused,\n  staticParameters: {\n    direction: Direction.LEFT\n  }\n}, MoveCursorRightShortcut = {\n  id: MoveCursorOperation.id,\n  binding: KeyCode.ARROW_RIGHT,\n  preconditions: whenDocAndEditorFocused,\n  staticParameters: {\n    direction: Direction.RIGHT\n  }\n}, MoveSelectionUpShortcut = {\n  id: MoveSelectionOperation.id,\n  binding: KeyCode.ARROW_UP | MetaKeys.SHIFT,\n  preconditions: whenDocAndEditorFocused,\n  staticParameters: {\n    direction: Direction.UP\n  }\n}, MoveSelectionDownShortcut = {\n  id: MoveSelectionOperation.id,\n  binding: KeyCode.ARROW_DOWN | MetaKeys.SHIFT,\n  preconditions: whenDocAndEditorFocused,\n  staticParameters: {\n    direction: Direction.DOWN\n  }\n}, MoveSelectionLeftShortcut = {\n  id: MoveSelectionOperation.id,\n  binding: KeyCode.ARROW_LEFT | MetaKeys.SHIFT,\n  preconditions: whenDocAndEditorFocused,\n  staticParameters: {\n    direction: Direction.LEFT\n  }\n}, MoveSelectionRightShortcut = {\n  id: MoveSelectionOperation.id,\n  binding: KeyCode.ARROW_RIGHT | MetaKeys.SHIFT,\n  preconditions: whenDocAndEditorFocused,\n  staticParameters: {\n    direction: Direction.RIGHT\n  }\n}, SelectAllShortcut = {\n  id: SelectAllOperation.id,\n  binding: KeyCode.A | MetaKeys.CTRL_COMMAND,\n  preconditions: /* @__PURE__ */ __name((contextService) => contextService.getContextValue(FOCUSING_UNIVER_EDITOR) && (contextService.getContextValue(FOCUSING_DOC) || contextService.getContextValue(EDITOR_ACTIVATED)), \"preconditions\")\n};\nvar __defProp2 = Object.defineProperty, __getOwnPropDesc = Object.getOwnPropertyDescriptor, __decorateClass = /* @__PURE__ */ __name((decorators, target, key, kind) => {\n  for (var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc(target, key) : target, i = decorators.length - 1, decorator; i >= 0; i--)\n    (decorator = decorators[i]) && (result = (kind ? decorator(target, key, result) : decorator(result)) || result);\n  return kind && result && __defProp2(target, key, result), result;\n}, \"__decorateClass\"), __decorateParam = /* @__PURE__ */ __name((index, decorator) => (target, key) => decorator(target, key, index), \"__decorateParam\"), _a27;\nlet UniverDocsUIPlugin = (_a27 = class extends Plugin {\n  constructor(_config = defaultPluginConfig, _injector, _renderManagerSrv, _commandService, _logService, _configService) {\n    super(), this._config = _config, this._injector = _injector, this._renderManagerSrv = _renderManagerSrv, this._commandService = _commandService, this._logService = _logService, this._configService = _configService;\n    const { menu, ...rest } = this._config;\n    menu && this._configService.setConfig(\"menu\", menu, { merge: !0 }), this._configService.setConfig(PLUGIN_CONFIG_KEY, rest), this._initDependencies(_injector), this._initializeShortcut(), this._initCommand();\n  }\n  onReady() {\n    this._initRenderBasics(), this._markDocAsFocused();\n  }\n  onRendered() {\n    this._initUI(), this._initRenderModules();\n  }\n  _initCommand() {\n    [\n      DeleteLeftCommand,\n      DeleteRightCommand,\n      SetInlineFormatBoldCommand,\n      SetInlineFormatItalicCommand,\n      SetInlineFormatUnderlineCommand,\n      SetInlineFormatStrikethroughCommand,\n      SetInlineFormatSubscriptCommand,\n      SetInlineFormatSuperscriptCommand,\n      SetInlineFormatFontSizeCommand,\n      SetInlineFormatFontFamilyCommand,\n      SetInlineFormatTextColorCommand,\n      ResetInlineFormatTextBackgroundColorCommand,\n      SetInlineFormatTextBackgroundColorCommand,\n      SetInlineFormatCommand,\n      BreakLineCommand,\n      InsertCommand,\n      DeleteCommand,\n      DeleteCustomBlockCommand,\n      UpdateCommand,\n      MergeTwoParagraphCommand,\n      SetDocZoomRatioOperation,\n      OrderListCommand,\n      BulletListCommand,\n      ListOperationCommand,\n      AlignLeftCommand,\n      AlignCenterCommand,\n      AlignRightCommand,\n      AlignOperationCommand,\n      AlignJustifyCommand,\n      CreateDocTableCommand,\n      DocTableInsertRowCommand,\n      DocTableInsertRowAboveCommand,\n      DocTableInsertRowBellowCommand,\n      DocTableInsertColumnCommand,\n      DocTableInsertColumnLeftCommand,\n      DocTableInsertColumnRightCommand,\n      DocTableDeleteRowsCommand,\n      DocTableDeleteColumnsCommand,\n      DocTableDeleteTableCommand,\n      DocTableTabCommand,\n      TabCommand,\n      AfterSpaceCommand,\n      EnterCommand,\n      ChangeListNestingLevelCommand,\n      ChangeListTypeCommand,\n      CheckListCommand,\n      ToggleCheckListCommand,\n      QuickListCommand,\n      IMEInputCommand,\n      DocParagraphSettingCommand,\n      InnerPasteCommand,\n      CutContentCommand,\n      ReplaceContentCommand,\n      CoverContentCommand,\n      SetDocZoomRatioCommand,\n      SelectAllOperation,\n      DocParagraphSettingPanelOperation,\n      MoveCursorOperation,\n      MoveSelectionOperation\n    ].forEach((e) => {\n      this._commandService.registerCommand(e);\n    }), [DocCopyCommand, DocCutCommand, DocPasteCommand].forEach((command) => this.disposeWithMe(this._commandService.registerMultipleCommand(command)));\n  }\n  _initializeShortcut() {\n    [\n      MoveCursorUpShortcut,\n      MoveCursorDownShortcut,\n      MoveCursorRightShortcut,\n      MoveCursorLeftShortcut,\n      MoveSelectionUpShortcut,\n      MoveSelectionDownShortcut,\n      MoveSelectionLeftShortcut,\n      MoveSelectionRightShortcut,\n      SelectAllShortcut,\n      DeleteLeftShortcut,\n      DeleteRightShortcut,\n      BreakLineShortcut,\n      ShiftTabShortCut\n    ].forEach((shortcut) => {\n      this._injector.get(IShortcutService).registerShortcut(shortcut);\n    });\n  }\n  _initDependencies(injector) {\n    mergeOverrideWithDependencies([\n      [DocClipboardController],\n      [DocEditorBridgeController],\n      // Controller\n      [DocUIController],\n      [DocAutoFormatController],\n      [DocTableController],\n      [DocMoveCursorController],\n      [AppUIController],\n      [DocParagraphSettingController],\n      // Services\n      [IDocClipboardService, { useClass: DocClipboardService }],\n      [DocCanvasPopManagerService],\n      [DocsRenderService],\n      [DocStateChangeManagerService],\n      [DocAutoFormatService]\n    ], this._config.override).forEach((d) => injector.add(d));\n  }\n  _markDocAsFocused() {\n    const currentService = this._injector.get(IUniverInstanceService), editorService = this._injector.get(IEditorService);\n    try {\n      const doc = currentService.getCurrentUnitForType(UniverInstanceType.UNIVER_DOC);\n      if (!doc) return;\n      const id = doc.getUnitId();\n      editorService.isEditor(id) || currentService.focusUnit(doc.getUnitId());\n    } catch (err) {\n      this._logService.warn(err);\n    }\n  }\n  _initUI() {\n    this._injector.get(AppUIController);\n  }\n  _initRenderBasics() {\n    [\n      // Services.\n      [DocSkeletonManagerService],\n      [DocSelectionRenderService],\n      [DocInterceptorService],\n      [DocPageLayoutService],\n      [DocIMEInputManagerService],\n      // Controllers.\n      [DocRenderController],\n      [DocZoomRenderController]\n    ].forEach((m2) => {\n      this._renderManagerSrv.registerRenderModule(UniverInstanceType.UNIVER_DOC, m2);\n    });\n  }\n  _initRenderModules() {\n    [\n      // Services\n      [DocEventManagerService],\n      // Controllers.\n      [DocBackScrollRenderController],\n      [DocSelectionRenderController],\n      [DocHeaderFooterController],\n      [DocResizeRenderController],\n      [DocContextMenuRenderController],\n      [DocChecklistRenderController],\n      [DocClipboardController],\n      [DocInputController],\n      [DocIMEInputController],\n      [DocEditorBridgeController]\n    ].forEach((m2) => {\n      this._renderManagerSrv.registerRenderModule(UniverInstanceType.UNIVER_DOC, m2);\n    });\n  }\n}, __name(_a27, \"UniverDocsUIPlugin\"), __publicField(_a27, \"pluginName\", DOC_UI_PLUGIN_NAME), __publicField(_a27, \"type\", UniverInstanceType.UNIVER_DOC), _a27);\nUniverDocsUIPlugin = __decorateClass([\n  __decorateParam(1, Inject(Injector)),\n  __decorateParam(2, IRenderManagerService),\n  __decorateParam(3, ICommandService),\n  __decorateParam(4, ILogService),\n  __decorateParam(5, IConfigService)\n], UniverDocsUIPlugin);\nexport {\n  AfterSpaceCommand,\n  AlignCenterCommand,\n  AlignJustifyCommand,\n  AlignLeftCommand,\n  AlignOperationCommand,\n  AlignRightCommand,\n  BreakLineCommand,\n  BulletListCommand,\n  ChangeListNestingLevelCommand,\n  ChangeListNestingLevelType,\n  ChangeListTypeCommand,\n  CheckListCommand,\n  CoverContentCommand,\n  CreateDocTableCommand,\n  CutContentCommand,\n  DOCS_COMPONENT_BACKGROUND_LAYER_INDEX,\n  DOCS_COMPONENT_DEFAULT_Z_INDEX,\n  DOCS_COMPONENT_HEADER_LAYER_INDEX,\n  DOCS_COMPONENT_MAIN_LAYER_INDEX,\n  DOCS_VIEW_KEY,\n  DOC_UI_PLUGIN_NAME,\n  DOC_VERTICAL_PADDING,\n  DefaultDocContainerConfig,\n  DefaultToolbarConfig,\n  DeleteCommand,\n  DeleteCustomBlockCommand,\n  DeleteLeftCommand,\n  DeleteRightCommand,\n  DocAutoFormatService,\n  DocBackScrollRenderController,\n  DocCanvasPopManagerService,\n  DocCopyCommand,\n  DocCreateTableOperation,\n  DocCutCommand,\n  DocEventManagerService,\n  DocIMEInputManagerService,\n  DocPasteCommand,\n  DocRenderController,\n  DocSelectionRenderService,\n  DocStateChangeManagerService,\n  DocTableDeleteColumnsCommand,\n  DocTableDeleteRowsCommand,\n  DocTableDeleteTableCommand,\n  DocTableInsertColumnCommand,\n  DocTableInsertColumnLeftCommand,\n  DocTableInsertColumnRightCommand,\n  DocTableInsertRowAboveCommand,\n  DocTableInsertRowBellowCommand,\n  DocTableInsertRowCommand,\n  DocTableTabCommand,\n  DocUIController,\n  DocsRenderService,\n  EditorInsertTextCommandId,\n  EnterCommand,\n  IDocClipboardService,\n  IMEInputCommand,\n  InnerPasteCommand,\n  InsertCommand,\n  ListOperationCommand,\n  MergeTwoParagraphCommand,\n  MoveCursorOperation,\n  MoveSelectionOperation,\n  NORMAL_TEXT_SELECTION_PLUGIN_NAME,\n  NodePositionConvertToCursor,\n  NodePositionConvertToRectRange,\n  OrderListCommand,\n  PastePluginLark,\n  PastePluginUniver,\n  PastePluginWord,\n  QuickListCommand,\n  RectRange,\n  ReplaceContentCommand,\n  ResetInlineFormatTextBackgroundColorCommand,\n  SelectAllOperation,\n  SetDocZoomRatioCommand,\n  SetDocZoomRatioOperation,\n  SetInlineFormatBoldCommand,\n  SetInlineFormatCommand,\n  SetInlineFormatFontFamilyCommand,\n  SetInlineFormatFontSizeCommand,\n  SetInlineFormatItalicCommand,\n  SetInlineFormatStrikethroughCommand,\n  SetInlineFormatSubscriptCommand,\n  SetInlineFormatSuperscriptCommand,\n  SetInlineFormatTextBackgroundColorCommand,\n  SetInlineFormatTextColorCommand,\n  SetInlineFormatUnderlineCommand,\n  TEXT_RANGE_LAYER_INDEX,\n  TabCommand,\n  TextRange,\n  ToggleCheckListCommand,\n  UniverDocsUIPlugin,\n  UpdateCommand,\n  VIEWPORT_KEY,\n  addCustomDecorationBySelectionFactory,\n  addCustomDecorationFactory,\n  addCustomRangeBySelectionFactory,\n  addCustomRangeFactory,\n  convertPositionsToRectRanges,\n  deleteCustomDecorationFactory,\n  deleteCustomRangeFactory,\n  docDrawingPositionToTransform,\n  genTableSource,\n  generateParagraphs,\n  getAnchorBounding,\n  getCanvasOffsetByEngine,\n  getCommandSkeleton,\n  getCursorWhenDelete,\n  getCustomBlockIdsInSelections,\n  getCutActionsFromDocRanges,\n  getDocObject,\n  getDocObjectById,\n  getEmptyTableCell,\n  getEmptyTableRow,\n  getLineBounding,\n  getOneTextSelectionRange,\n  getParagraphsInRange,\n  getParagraphsInRanges,\n  getRichTextEditPath,\n  getTableColumn,\n  hasParagraphInTable,\n  isInSameTableCell,\n  isValidRectRange,\n  menuSchema,\n  neoGetDocObject,\n  replaceSelectionFactory,\n  transformToDocDrawingPosition,\n  whenDocAndEditorFocused\n};\n","import { __values } from \"tslib\";\nimport { Subscription } from '../Subscription';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { arrRemove } from '../util/arrRemove';\nimport { asyncScheduler } from '../scheduler/async';\nimport { popScheduler } from '../util/args';\nimport { executeSchedule } from '../util/executeSchedule';\nexport function bufferTime(bufferTimeSpan) {\n    var _a, _b;\n    var otherArgs = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        otherArgs[_i - 1] = arguments[_i];\n    }\n    var scheduler = (_a = popScheduler(otherArgs)) !== null && _a !== void 0 ? _a : asyncScheduler;\n    var bufferCreationInterval = (_b = otherArgs[0]) !== null && _b !== void 0 ? _b : null;\n    var maxBufferSize = otherArgs[1] || Infinity;\n    return operate(function (source, subscriber) {\n        var bufferRecords = [];\n        var restartOnEmit = false;\n        var emit = function (record) {\n            var buffer = record.buffer, subs = record.subs;\n            subs.unsubscribe();\n            arrRemove(bufferRecords, record);\n            subscriber.next(buffer);\n            restartOnEmit && startBuffer();\n        };\n        var startBuffer = function () {\n            if (bufferRecords) {\n                var subs = new Subscription();\n                subscriber.add(subs);\n                var buffer = [];\n                var record_1 = {\n                    buffer: buffer,\n                    subs: subs,\n                };\n                bufferRecords.push(record_1);\n                executeSchedule(subs, scheduler, function () { return emit(record_1); }, bufferTimeSpan);\n            }\n        };\n        if (bufferCreationInterval !== null && bufferCreationInterval >= 0) {\n            executeSchedule(subscriber, scheduler, startBuffer, bufferCreationInterval, true);\n        }\n        else {\n            restartOnEmit = true;\n        }\n        startBuffer();\n        var bufferTimeSubscriber = createOperatorSubscriber(subscriber, function (value) {\n            var e_1, _a;\n            var recordsCopy = bufferRecords.slice();\n            try {\n                for (var recordsCopy_1 = __values(recordsCopy), recordsCopy_1_1 = recordsCopy_1.next(); !recordsCopy_1_1.done; recordsCopy_1_1 = recordsCopy_1.next()) {\n                    var record = recordsCopy_1_1.value;\n                    var buffer = record.buffer;\n                    buffer.push(value);\n                    maxBufferSize <= buffer.length && emit(record);\n                }\n            }\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\n            finally {\n                try {\n                    if (recordsCopy_1_1 && !recordsCopy_1_1.done && (_a = recordsCopy_1.return)) _a.call(recordsCopy_1);\n                }\n                finally { if (e_1) throw e_1.error; }\n            }\n        }, function () {\n            while (bufferRecords === null || bufferRecords === void 0 ? void 0 : bufferRecords.length) {\n                subscriber.next(bufferRecords.shift().buffer);\n            }\n            bufferTimeSubscriber === null || bufferTimeSubscriber === void 0 ? void 0 : bufferTimeSubscriber.unsubscribe();\n            subscriber.complete();\n            subscriber.unsubscribe();\n        }, undefined, function () { return (bufferRecords = null); });\n        source.subscribe(bufferTimeSubscriber);\n    });\n}\n//# sourceMappingURL=bufferTime.js.map","import { Subscription } from '../Subscription';\nimport { OperatorFunction, SchedulerLike } from '../types';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { arrRemove } from '../util/arrRemove';\nimport { asyncScheduler } from '../scheduler/async';\nimport { popScheduler } from '../util/args';\nimport { executeSchedule } from '../util/executeSchedule';\n\n/* tslint:disable:max-line-length */\nexport function bufferTime<T>(bufferTimeSpan: number, scheduler?: SchedulerLike): OperatorFunction<T, T[]>;\nexport function bufferTime<T>(\n  bufferTimeSpan: number,\n  bufferCreationInterval: number | null | undefined,\n  scheduler?: SchedulerLike\n): OperatorFunction<T, T[]>;\nexport function bufferTime<T>(\n  bufferTimeSpan: number,\n  bufferCreationInterval: number | null | undefined,\n  maxBufferSize: number,\n  scheduler?: SchedulerLike\n): OperatorFunction<T, T[]>;\n/* tslint:enable:max-line-length */\n\n/**\n * Buffers the source Observable values for a specific time period.\n *\n * <span class=\"informal\">Collects values from the past as an array, and emits\n * those arrays periodically in time.</span>\n *\n * ![](bufferTime.png)\n *\n * Buffers values from the source for a specific time duration `bufferTimeSpan`.\n * Unless the optional argument `bufferCreationInterval` is given, it emits and\n * resets the buffer every `bufferTimeSpan` milliseconds. If\n * `bufferCreationInterval` is given, this operator opens the buffer every\n * `bufferCreationInterval` milliseconds and closes (emits and resets) the\n * buffer every `bufferTimeSpan` milliseconds. When the optional argument\n * `maxBufferSize` is specified, the buffer will be closed either after\n * `bufferTimeSpan` milliseconds or when it contains `maxBufferSize` elements.\n *\n * ## Examples\n *\n * Every second, emit an array of the recent click events\n *\n * ```ts\n * import { fromEvent, bufferTime } from 'rxjs';\n *\n * const clicks = fromEvent(document, 'click');\n * const buffered = clicks.pipe(bufferTime(1000));\n * buffered.subscribe(x => console.log(x));\n * ```\n *\n * Every 5 seconds, emit the click events from the next 2 seconds\n *\n * ```ts\n * import { fromEvent, bufferTime } from 'rxjs';\n *\n * const clicks = fromEvent(document, 'click');\n * const buffered = clicks.pipe(bufferTime(2000, 5000));\n * buffered.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link buffer}\n * @see {@link bufferCount}\n * @see {@link bufferToggle}\n * @see {@link bufferWhen}\n * @see {@link windowTime}\n *\n * @param {number} bufferTimeSpan The amount of time to fill each buffer array.\n * @param {number} [bufferCreationInterval] The interval at which to start new\n * buffers.\n * @param {number} [maxBufferSize] The maximum buffer size.\n * @param {SchedulerLike} [scheduler=async] The scheduler on which to schedule the\n * intervals that determine buffer boundaries.\n * @return A function that returns an Observable of arrays of buffered values.\n */\nexport function bufferTime<T>(bufferTimeSpan: number, ...otherArgs: any[]): OperatorFunction<T, T[]> {\n  const scheduler = popScheduler(otherArgs) ?? asyncScheduler;\n  const bufferCreationInterval = (otherArgs[0] as number) ?? null;\n  const maxBufferSize = (otherArgs[1] as number) || Infinity;\n\n  return operate((source, subscriber) => {\n    // The active buffers, their related subscriptions, and removal functions.\n    let bufferRecords: { buffer: T[]; subs: Subscription }[] | null = [];\n    // If true, it means that every time we emit a buffer, we want to start a new buffer\n    // this is only really used for when *just* the buffer time span is passed.\n    let restartOnEmit = false;\n\n    /**\n     * Does the work of emitting the buffer from the record, ensuring that the\n     * record is removed before the emission so reentrant code (from some custom scheduling, perhaps)\n     * does not alter the buffer. Also checks to see if a new buffer needs to be started\n     * after the emit.\n     */\n    const emit = (record: { buffer: T[]; subs: Subscription }) => {\n      const { buffer, subs } = record;\n      subs.unsubscribe();\n      arrRemove(bufferRecords, record);\n      subscriber.next(buffer);\n      restartOnEmit && startBuffer();\n    };\n\n    /**\n     * Called every time we start a new buffer. This does\n     * the work of scheduling a job at the requested bufferTimeSpan\n     * that will emit the buffer (if it's not unsubscribed before then).\n     */\n    const startBuffer = () => {\n      if (bufferRecords) {\n        const subs = new Subscription();\n        subscriber.add(subs);\n        const buffer: T[] = [];\n        const record = {\n          buffer,\n          subs,\n        };\n        bufferRecords.push(record);\n        executeSchedule(subs, scheduler, () => emit(record), bufferTimeSpan);\n      }\n    };\n\n    if (bufferCreationInterval !== null && bufferCreationInterval >= 0) {\n      // The user passed both a bufferTimeSpan (required), and a creation interval\n      // That means we need to start new buffers on the interval, and those buffers need\n      // to wait the required time span before emitting.\n      executeSchedule(subscriber, scheduler, startBuffer, bufferCreationInterval, true);\n    } else {\n      restartOnEmit = true;\n    }\n\n    startBuffer();\n\n    const bufferTimeSubscriber = createOperatorSubscriber(\n      subscriber,\n      (value: T) => {\n        // Copy the records, so if we need to remove one we\n        // don't mutate the array. It's hard, but not impossible to\n        // set up a buffer time that could mutate the array and\n        // cause issues here.\n        const recordsCopy = bufferRecords!.slice();\n        for (const record of recordsCopy) {\n          // Loop over all buffers and\n          const { buffer } = record;\n          buffer.push(value);\n          // If the buffer is over the max size, we need to emit it.\n          maxBufferSize <= buffer.length && emit(record);\n        }\n      },\n      () => {\n        // The source completed, emit all of the active\n        // buffers we have before we complete.\n        while (bufferRecords?.length) {\n          subscriber.next(bufferRecords.shift()!.buffer);\n        }\n        bufferTimeSubscriber?.unsubscribe();\n        subscriber.complete();\n        subscriber.unsubscribe();\n      },\n      // Pass all errors through to consumer.\n      undefined,\n      // Clean up\n      () => (bufferRecords = null)\n    );\n\n    source.subscribe(bufferTimeSubscriber);\n  });\n}\n"],"names":["$parcel$export","e","n","v","s","Object","defineProperty","get","set","enumerable","configurable","parcelRequire","$parcel$global","globalThis","self","window","global","parcelRegister","register","module","exports","DOCS_VIEW_KEY2","VIEWPORT_KEY2","DeleteDirection2","INSERT_ROW_POSITION2","INSERT_COLUMN_POSITION2","CellPosition2","ChangeListNestingLevelType2","NodePositionType2","HeaderFooterType2","$bb9ae9d90429a70d$export$9e0654286d987857","$bb9ae9d90429a70d$export$691aac3130b48bd9","$bb9ae9d90429a70d$export$71efbe292af93edf","$bb9ae9d90429a70d$export$8d914703313ba357","$bb9ae9d90429a70d$export$7fbaae6acc82e724","$bb9ae9d90429a70d$export$8dc77b63959478b2","$bb9ae9d90429a70d$export$f0cad0406ddcd4fa","$bb9ae9d90429a70d$export$d58fc04233d01bfb","$bb9ae9d90429a70d$export$b83c33c82ff96791","$bb9ae9d90429a70d$export$e6da9cc4b65a2183","$bb9ae9d90429a70d$export$d752bba5c1df9b30","$bb9ae9d90429a70d$export$2ac5c6b1b1b0feee","$bb9ae9d90429a70d$export$6f96a39ba8cb4fb2","$bb9ae9d90429a70d$export$64d38e2980266dfc","$bb9ae9d90429a70d$export$e70c98b3ed3cca1c","$bb9ae9d90429a70d$export$73eebc63961c6386","$bb9ae9d90429a70d$export$eced467326987bcd","$bb9ae9d90429a70d$export$6723c87fd3465f36","$bb9ae9d90429a70d$export$b6aad3c88c8d5d81","$bb9ae9d90429a70d$export$61b23f520937a12f","$bb9ae9d90429a70d$export$6a8c10d8a8594492","$bb9ae9d90429a70d$export$ba4bc2e8402f82b3","$bb9ae9d90429a70d$export$12633081beeab12c","$bb9ae9d90429a70d$export$bb98a1a9da56437b","$bb9ae9d90429a70d$export$37b489d6b2152f0f","$bb9ae9d90429a70d$export$18c799e465d2606c","$bb9ae9d90429a70d$export$dba4bbd052c086b8","$bb9ae9d90429a70d$export$6dc2db33d8a277cd","$bb9ae9d90429a70d$export$923355e3fc8db131","$bb9ae9d90429a70d$export$928598871e94e5df","$bb9ae9d90429a70d$export$1e5a6f8f312f65d4","$bb9ae9d90429a70d$export$d5808d819c51512a","$7yNYd","$7AR1b","$3e0Iz","$fL2Ug","$6nOkr","$5LPkb","$5K4WI","$arCqp","$lMvMU","$5HvWP","$hciHF","$97m73","$1O3Nt","$1mjSk","$9z4na","$2jrJe","$gv2K9","$5gqvu","$1UDbf","$aFl3s","$binOv","$bb9ae9d90429a70d$var$__defProp","$bb9ae9d90429a70d$var$__defNormalProp","obj","key","value","writable","$bb9ae9d90429a70d$var$__name","target","$bb9ae9d90429a70d$var$__publicField","$bb9ae9d90429a70d$var$__defProp$q","$bb9ae9d90429a70d$var$__getOwnPropDesc$q","getOwnPropertyDescriptor","$bb9ae9d90429a70d$var$__decorateClass$q","decorators","kind","decorator","result","i","length","$bb9ae9d90429a70d$var$__decorateParam$q","index","$bb9ae9d90429a70d$var$getParagraphsInRange$1","activeRange","paragraphs","_a28","_b","startOffset","endOffset","results","start","paragraph","prevParagraph","startIndex","push","paragraphStart","paragraphEnd","$bb9ae9d90429a70d$export$a1c6e22fe3cdf060","$bb9ae9d90429a70d$var$_a","Disposable","constructor","_univerInstanceService","_textSelectionManagerService","Map","registerAutoFormat","match","matchList","_matches","id","sort","a","b","priority","toDisposable","matchList2","findIndex","splice","onAutoFormat","params","_c","_d","_e","_f","autoFormats","unit","getCurrentUnitForType","UniverInstanceType","UNIVER_DOC","selection","getActiveTextRange","doc","getSelfOrHeaderFooterModel","segmentId","context","isBody","getBody","customRanges","BuildTextUtils","customRange","getCustomRangesInterestsWithRange","commandId","commandParams","matched","find","getMutations","IUniverInstanceService","Inject","DocSelectionManagerService","MAIN","BACKGROUND","VIEW_MAIN","VIEW_TOP","VIEW_LEFT","VIEW_LEFT_TOP","$bb9ae9d90429a70d$export$ea0dbb208e4826e2","renderContext","mainComponent","scene","engine","components","document","docBackground","$bb9ae9d90429a70d$export$33c9206ff2745b13","univerInstanceService","renderManagerService","documentModel","unitId","getUnitId","currentRender","getRenderById","$bb9ae9d90429a70d$export$e028dd204d1996d9","param","ranges","type","doMutation","RichTextEditingMutation","actions","textRanges","textX","TextX","jsonX","JSONX","getInstance","cursor","end","t","TextXActionType","RETAIN","len","body","dataStream","customDecorations","endIndex","editOp","serialize","$bb9ae9d90429a70d$export$aca1be174465426e","accessor","IRenderManagerService","with","DocSkeletonManagerService","$bb9ae9d90429a70d$export$abad77f79f46bb97","docDataModel","headers","footers","getSnapshot","Error","rangeId","rangeType","wholeEntity","properties","propSelection","docSelectionManagerService","documentDataModel","getUnit","normalizeSelection","add","range","collapsed","path","insert","delete","$bb9ae9d90429a70d$export$f26f7ddc67950305","tables","some","table","insertBody","replace","debounce","selections","getCurrentTextRanges","decorations","filter","d","oldBodySlices","map","getBodySlice","bodySlices","bodySlice","_a29","copy","Tools","deepClone","decoration","forEach","oldBody","coverType","UpdateDocsAttributeType","REPLACE","position","left","positionH","posOffset","top","positionV","width","size","height","transform","marginLeft","marginTop","relativeFrom","ObjectRelativeFromH","MARGIN","ObjectRelativeFromV","PAGE","angle","$bb9ae9d90429a70d$export$e2fd85e54fa7b941","CommandType","COMMAND","handler","mutations","sequenceExecuteAsync","ICommandService","$bb9ae9d90429a70d$export$57d0a1299f7f4db8","$bb9ae9d90429a70d$export$94e417ac7df3c302","$bb9ae9d90429a70d$var$DeleteDirection","LEFT","RIGHT","commandService","cursorOffset","extendLastRange","originBody","actualRange","getDeleteSelection","getInsertSelection","cursorMove","style","dos","retain","getDeleteActions","INSERT","line","syncExecuteCommand","$bb9ae9d90429a70d$export$bcbb37853c82bc7a","direction","relativeCustomRanges","isIntersecting","toDeleteRanges","shouldDeleteCustomRange","deleteIndexes","range2","pre","aft","deleteStart","deleteIndex","DELETE","$bb9ae9d90429a70d$export$19ae6d3f93acfd2e","updateBody","getCurrentUniverDocInstance","$bb9ae9d90429a70d$export$d16c599b5109b812","DataStreamTreeTokenType","PARAGRAPH","bullet","listType","PresetListType","CHECK_LIST_CHECKED","CHECK_LIST","paragraphStyle","textStyle","st","BooleanNumber","FALSE","activeTextRange","rectRanges","getCurrentRectRanges","startOffset2","replaceTextRanges","p2","executeCommand","bodyAfter","normalizeBody","copyCustomRange","deleteRange","updateAttributeByInsert","$bb9ae9d90429a70d$var$INSERT_ROW_POSITION","ABOVE","BELLOW","$bb9ae9d90429a70d$var$INSERT_COLUMN_POSITION","$bb9ae9d90429a70d$var$genEmptyTable","rowCount","colCount","TABLE_START","sectionBreaks","TABLE_ROW_START","j","TABLE_CELL_START","TABLE_CELL_END","spaceAbove","lineSpacing","spaceBelow","TABLE_ROW_END","TABLE_END","$bb9ae9d90429a70d$export$ba2e502f47d52b71","margin","bottom","$bb9ae9d90429a70d$export$ff17ef97bed31451","col","tableCell","tableCells","Array","fill","trHeight","val","hRule","TableCellHeightRule","AUTO","$bb9ae9d90429a70d$export$4959bf4a22b5891f","TableSizeType","SPECIFIED","$bb9ae9d90429a70d$export$438ea56a96e58332","pageContentWidth","tableColumn","tableRow","tableRows","tableColumns","tableId","generateRandomId","align","TableAlignmentType","START","indent","textWrap","TableTextWrapType","NONE","dist","distB","distL","distR","distT","cellMargin","UNSPECIFIED","$bb9ae9d90429a70d$var$getRangeInfoFromRanges","textRange","Number","POSITIVE_INFINITY","NEGATIVE_INFINITY","rectRange","ed","sid","Math","min","max","isFinite","$bb9ae9d90429a70d$var$getInsertRowBody","$bb9ae9d90429a70d$var$getInsertColumnBody","$bb9ae9d90429a70d$var$getInsertRowActionsParams","rangeInfo","viewModel","vm","getSelfOrHeaderFooterViewModel","rowIndex","section","children","row","indexOf","offset","insertRowIndex","$bb9ae9d90429a70d$var$getInsertColumnActionsParams","offsets","columnIndex","tableNode","cell","cellIndex","insertIndex","$bb9ae9d90429a70d$var$getColumnWidths","pageWidth","insertColumnIndex","widths","newColWidth","totalWidth","$bb9ae9d90429a70d$var$getDeleteRowsActionsParams","rowIndexes","selectWholeTable","$bb9ae9d90429a70d$var$getDeleteColumnsActionParams","columnIndexes","startColumnIndex","endColumnIndex","delta","startCell","endCell","$bb9ae9d90429a70d$var$getDeleteTableActionParams","$bb9ae9d90429a70d$var$getDeleteRowContentActionParams","row2","rIndex","$bb9ae9d90429a70d$var$CellPosition","NEXT","PREV","$bb9ae9d90429a70d$var$getCellOffsets","targetTable","targetRow","newCell","nextRow","prevRow","$bb9ae9d90429a70d$export$aa9bc8623aab3a9c","customBlockIds","customBlocks","customBlock","blockId","$bb9ae9d90429a70d$var$hasRangeInTable","startNodePosition","$bb9ae9d90429a70d$export$b23e7be54cecd122","tableSource","drawings","isArray","memoryCursor","MemoryCursor","reset","rawActions","hasTable","hasCustomBlock","cloneBody","oldTableId","action","insertOp","drawingLen","drawingsOrder","block","drawingId","drawing","orderAction","moveCursor","reduce","acc","cur","compose","$bb9ae9d90429a70d$var$getCutActionsFromTextRanges","getDeleteExculdeLastLineBreakActions","removedCustomBlockIds","getDrawings","drawingOrder","getDrawingsOrder","sortedRemovedCustomBlockIds","drawingIndex","removeDrawingAction","removeOp","removeDrawingOrderAction","$bb9ae9d90429a70d$var$getCutActionsFromRectRanges","spanEntireRow","spanEntireTable","actionParams","moveCursorTo","reverse","delLen","$bb9ae9d90429a70d$export$55e7786fece24ca1","$bb9ae9d90429a70d$export$c235cac640c1f2b3","getUniverDocInstance","docSkeletonManagerService","getViewModel","$bb9ae9d90429a70d$var$getDeleteSelection","$bb9ae9d90429a70d$export$6d896186514a9d62","prevTextRanges","$bb9ae9d90429a70d$export$d11f1a7d3b7026a9","$bb9ae9d90429a70d$var$getParagraphBody","$bb9ae9d90429a70d$export$9d7b3e913f0b01bc","startRow","skeleton","getSkeleton","cursor2","segmentId2","segmentPage","curGlyph","findNodeByCharIndex","isBullet","hasListGlyph","isIndent","isIndentByGlyph","preGlyph","isFirstGlyph","getParagraphByGlyph","paragraphIndex","updateParagraph","paragraphStyle2","hanging","indentStart","content","streamType","layoutType","PositionedObjectLayoutType","INLINE","unitId2","prePreGlyph","count","$bb9ae9d90429a70d$var$getTextRangesWhenDelete","$bb9ae9d90429a70d$export$887646cf81f0174e","needDeleteGlyph","nextGlyph","SECTION_BREAK","textRuns","originTextRuns","originCustomBlocks","substring","getCustomRangeSlice","getCustomDecorationSlice","textRun","$bb9ae9d90429a70d$var$genId","$bb9ae9d90429a70d$var$extractId","html","$bb9ae9d90429a70d$var$_CopyContentCache","LRUMap","clipboardData","_cache","clear","$bb9ae9d90429a70d$var$copyContentCache","$bb9ae9d90429a70d$var$extractNodeStyle","node","styles2","docStyles","tagName","toLowerCase","bl","TRUE","ul","it","va","BaselineOffset","SUPERSCRIPT","SUBSCRIPT","cssRule","cssValue","getPropertyValue","ff","fontSize","parseInt","isNaN","endsWith","fs","pixelToPt","String","test","ol","color","ColorKit","isValid","cl","rgb","toRgbString","bg","$bb9ae9d90429a70d$var$parseToDom","rawHtml","parser","DOMParser","parseFromString","querySelector","$bb9ae9d90429a70d$var$matchFilter","filter2","name","$bb9ae9d90429a70d$var$_HtmlToUDMService","_HtmlToUDMService","use","plugin","_pluginList","includes","convert","pastePlugin","checkPasteType","dom","docData","_styleRules","stylesRules","_afterProcessRules","afterProcessRules","_tableCache","_styleCache","_process","childNodes","parent","nodes","nodeType","Node","TEXT_NODE","nodeValue","trim","text","has","getOwnPropertyNames","ts","skipParseTagNames","nodeName","ELEMENT_NODE","linkStart","_processBeforeLink","parentStyles","styleRule","nodeStyles","getStyle","_processBeforeTable","_processAfterTable","afterProcessRule","_processAfterLink","toUpperCase","lastTable","pop","$bb9ae9d90429a70d$var$DEFAULT_TABLE_WIDTH","element2","CUSTOM_RANGE_START","CUSTOM_RANGE_END","dataset","rangeid","CustomRangeType","HYPERLINK","url","href","$bb9ae9d90429a70d$var$getParagraphStyle","el","marginTopValue","ptToPixel","marginBottomValue","lineHeightValue","parseFloat","$bb9ae9d90429a70d$var$covertTextRunToHtml","slice","join","$bb9ae9d90429a70d$var$getBodyInlineSlice","cursorIndex","spanList","hasIntersectionBetweenTwoRanges","$bb9ae9d90429a70d$var$getBodySliceHtml","customRangesInRange","startIndex2","endIndex2","preHtml","sliceHtml","endHtml","$bb9ae9d90429a70d$var$convertBodyToHtml","parseDataStreamToTree","$bb9ae9d90429a70d$var$processNode","DataStreamTreeNodeType","n2","TABLE","TABLE_ROW","TABLE_CELL","$bb9ae9d90429a70d$var$_UDMToHtmlService","bodyList","$bb9ae9d90429a70d$var$__defProp$p","$bb9ae9d90429a70d$var$__getOwnPropDesc$p","$bb9ae9d90429a70d$var$__decorateClass$p","$bb9ae9d90429a70d$var$__decorateParam$p","$bb9ae9d90429a70d$var$getTableSlice","$bb9ae9d90429a70d$var$HtmlToUDMService","inlineStyle","className","$bb9ae9d90429a70d$export$6b47ccaaccf9c11f","createIdentifier","$bb9ae9d90429a70d$var$DocClipboardService","$bb9ae9d90429a70d$var$_a2","_logService","_commandService","_clipboardInterfaceService","_docSelectionManagerService","sliceType","SliceBodyType","needCache","snapshot","_getDocumentBodyInRanges","isCopyInHeaderFooter","_setClipboardData","error","cut","_cut","paste","items","partDocData","_genDocDataFromClipboardItems","_paste","legacyPaste","_genDocDataFromHtmlAndText","DOCS_NORMAL_EDITOR_UNIT_ID_KEY","textDocData","fromPlainText","activeEndOffset","newTextRanges","_body","_clipboardHooks","hook","onBeforePaste","documentBodyList","copyId","replaceAll","_umdToHtml","_p0","p1","cache","write","addClipboardHook","allRanges","getDocRanges","DOC_RANGE_TYPE","RECT","docBody","sliceBody","clipboardItem","types","PLAIN_TEXT_CLIPBOARD_MIME_TYPE","getType","then","blob","HTML_CLIPBOARD_MIME_TYPE","Promise","reject","copyCache","_htmlToUDM","$bb9ae9d90429a70d$var$whenDocOrEditor","contextService","getContextValue","FOCUSING_DOC","EDITOR_ACTIVATED","$bb9ae9d90429a70d$var$whenFocusEditor","ILogService","IClipboardInterfaceService","$bb9ae9d90429a70d$export$9f1a20871184dbfd","CopyCommand","multi","preconditions","$bb9ae9d90429a70d$export$f23b9559f1e5cf86","CutCommand","$bb9ae9d90429a70d$export$c2cb6d04fe50d389","PasteCommand","docClipboardService","clipboardItems","read","$bb9ae9d90429a70d$var$_DocIMEInputManagerService","RxDisposable","_context","clearUndoRedoMutationParamsCache","_undoMutationParamsCache","_redoMutationParamsCache","getUndoRedoMutationParamsCache","undoCache","redoCache","setUndoRedoMutationParamsCache","getActiveRange","_previousActiveRange","setActiveRange","pushUndoRedoMutationParams","undoParams","redoParams","fetchComposedUndoRedoMutationParams","undoMutationParams","redoMutationParams","previousActiveRange","dispose","newText","oldTextLen","isCompositionEnd","isCompositionStart","imeInputManagerService","insertRange","assign","noHistory","$bb9ae9d90429a70d$var$handleInlineFormat","preCommandId","$bb9ae9d90429a70d$var$SetInlineFormatBoldCommandId","$bb9ae9d90429a70d$var$SetInlineFormatItalicCommandId","$bb9ae9d90429a70d$var$SetInlineFormatUnderlineCommandId","$bb9ae9d90429a70d$var$SetInlineFormatStrikethroughCommandId","$bb9ae9d90429a70d$var$SetInlineFormatSubscriptCommandId","$bb9ae9d90429a70d$var$SetInlineFormatSuperscriptCommandId","$bb9ae9d90429a70d$var$SetInlineFormatFontSizeCommandId","$bb9ae9d90429a70d$var$SetInlineFormatFontFamilyCommandId","$bb9ae9d90429a70d$var$SetInlineFormatTextColorCommandId","$bb9ae9d90429a70d$var$SetInlineFormatTextBackgroundColorCommandId","$bb9ae9d90429a70d$export$7787f0bdf26d2ee3","$bb9ae9d90429a70d$var$ResetInlineFormatTextBackgroundColorCommandId","$bb9ae9d90429a70d$export$78c2c1a989d143a9","$bb9ae9d90429a70d$var$COMMAND_ID_TO_FORMAT_KEY_MAP","formatValue","docRanges","$bb9ae9d90429a70d$var$getReverseFormatValueInSelection","$bb9ae9d90429a70d$var$isTextDecoration","ti","si","NORMAL","$bb9ae9d90429a70d$export$7ae277bfd4e4bfd6","currentParagraphs","$bb9ae9d90429a70d$export$a2d7677ab44ff1ca","isAlreadyList","every","listId","curIndex","nextParagraph","customLists","lists","PRESET_LIST_TYPE","defaultTabStop","documentStyle","indentFirstLine","snapToGrid","listHanging","listIndentStart","nestingLevel","paragraphProperties","charSpace","gridType","$bb9ae9d90429a70d$var$findNearestSectionBreak","GridType","LINES","charSpaceApply","getCharSpaceApply","getNumberUnitValue","$bb9ae9d90429a70d$export$a2a53bf26cf288dd","activeRanges","$bb9ae9d90429a70d$var$getParagraphsRelative","$bb9ae9d90429a70d$export$dc1a06c250f0dd7","increase","decrease","$bb9ae9d90429a70d$export$1f6473f08b3bd4f","$bb9ae9d90429a70d$export$36fe13a9a4b57a90","isInTable","maxLevel","$bb9ae9d90429a70d$export$baa537c1cdd3ac5a","BULLET_LIST","$bb9ae9d90429a70d$export$dfb9f80f41464abe","$bb9ae9d90429a70d$export$29ccf42ee2e09c85","currentParagraph","$bb9ae9d90429a70d$export$e87051556a6af02d","ORDER_LIST","$bb9ae9d90429a70d$export$234148d9524301cf","bulletParagraphTextStyle","selectionParagraphs","unshift","lastParagraph","ps","currentIndex","sortedSectionBreaks","sortRulesFactory","sectionBreak","$bb9ae9d90429a70d$export$662c5ab3bad17c14","alignType","isAlreadyAligned","horizontalAlign","HorizontalAlign","$bb9ae9d90429a70d$export$7a3dedab32c2d5a9","$bb9ae9d90429a70d$export$d6d3a31584e4793b","CENTER","$bb9ae9d90429a70d$export$6e9dd45d49710046","$bb9ae9d90429a70d$export$8812c7b8ff337c70","JUSTIFIED","options","prevBody","$bb9ae9d90429a70d$var$getMutationParams","undoRedoService","IUndoRedoService","docDatModel","noNeedSetTextRange","clearUndoRedo","deleteLen","$bb9ae9d90429a70d$var$SetDocZoomRatioUndoMutationFactory","old","zoomRatio","$bb9ae9d90429a70d$export$324478118aea2b96","OPERATION","documentData","settings","$bb9ae9d90429a70d$export$fdc76f9b34e96863","documentId","setZoomRatioMutationParams","pushUndoRedo","unitID","undoMutations","redoMutations","$bb9ae9d90429a70d$export$4e832bb83534614c","isInParagraph","needCreateParagraph","isBehindTable","tableDataStream","tableParagraphs","page","marginRight","$bb9ae9d90429a70d$export$a24cf2b8bfb8aa0d","activeRectRanges","$bb9ae9d90429a70d$export$ec800041f6d17822","$bb9ae9d90429a70d$export$9460cec99108a171","$bb9ae9d90429a70d$var$DocTableInsertRowCommandId","$bb9ae9d90429a70d$var$DocTableInsertColumnCommandId","$bb9ae9d90429a70d$export$d24aed1c729ddbeb","$bb9ae9d90429a70d$export$5c48014be93c9100","$bb9ae9d90429a70d$export$e0b51bcab3a3cf9c","$bb9ae9d90429a70d$export$f1900f4bfa5f38e0","$bb9ae9d90429a70d$export$c84c1b77b54bc20c","insertRow","$bb9ae9d90429a70d$export$59ad16502cefbbfe","insertCell","insertTableSource","pageSize","replaceOp","insertCol","insertTableColumn","$bb9ae9d90429a70d$export$d60059992825479d","shift","textSelectionManager","$bb9ae9d90429a70d$var$COMPONENT_DOC_CREATE_TABLE_CONFIRM","$bb9ae9d90429a70d$var$COMPONENT_DOC_CREATE_TABLE_CONFIRM_ID","$bb9ae9d90429a70d$export$1e0acf08c78e9a29","localeService","LocaleService","confirmService","IConfirmService","tableCreateParams","handleRowColChange","open","label","props","title","onConfirm","close","onClose","$bb9ae9d90429a70d$export$b1260f52284457c5","$bb9ae9d90429a70d$var$__assign","arguments","prototype","hasOwnProperty","call","apply","$bb9ae9d90429a70d$var$__rest","getOwnPropertySymbols","propertyIsEnumerable","$bb9ae9d90429a70d$var$IconBase","forwardRef","ref","icon","extend","restProps","cls","concat","idSuffix","useRef","$bb9ae9d90429a70d$var$generateShortUuid","$bb9ae9d90429a70d$var$render","defIds","current","runtimeProps","rootProps","createElement","tag","$bb9ae9d90429a70d$var$replaceRuntimeIdsAndExtInAttrs","$bb9ae9d90429a70d$var$replaceRuntimeIdsInDefs","child","attrs","colorChannel1","entries","random","toString","displayName","$bb9ae9d90429a70d$var$element$4","viewBox","$bb9ae9d90429a70d$var$AlignTextBothSingle","$bb9ae9d90429a70d$var$element$3","$bb9ae9d90429a70d$var$HorizontallySingle","$bb9ae9d90429a70d$var$element$2","$bb9ae9d90429a70d$var$LeftJustifyingSingle","$bb9ae9d90429a70d$var$element$1","$bb9ae9d90429a70d$var$RightJustifyingSingle","$bb9ae9d90429a70d$var$element","fillRule","clipRule","$bb9ae9d90429a70d$var$TodoList","$bb9ae9d90429a70d$var$NodePositionType","column","divide","glyph","$bb9ae9d90429a70d$var$NodePositionMap","$bb9ae9d90429a70d$var$compareNodePositionLogic","pos1","pos2","$bb9ae9d90429a70d$var$compareNodePosition","$bb9ae9d90429a70d$export$7c80d2a14b5c99ad","rangeList","rangeCount","firstCursor","lastCursor","$bb9ae9d90429a70d$var$getOffsetInDivide","glyphGroup","startGlyphIndex","endGlyphIndex","contentLength","$bb9ae9d90429a70d$var$pushToPoints","startX","startY","endX","endY","points","x","y","$bb9ae9d90429a70d$var$_NodePositionConvertToCursor","_documentOffsetConfig","_docSkeleton","Liquid","getRangePointData","startOrigin","endOrigin","borderBoxPointGroup","contentBoxPointGroup","cursorList","_isValidPosition","_selectionIterator","start_sp","end_sp","isFirst","isLast","borderBoxPosition","contentBoxPosition","lineHeight","asc","paddingTop","marginBottom","_liquid","firstGlyph","lastGlyph","firstGlyphLeft","firstGlyphWidth","lastGlyphLeft","lastGlyphWidth","isCurrentList","glyphType","GlyphType","LIST","isStartBack","isBack","isEndBack","anchorGlyph","bBox","ba","bd","isStartBackFin","startPage","pageType","startPageType","endPage","endPageType","DocumentSkeletonPageType","HEADER","FOOTER","_resetCurrentNodePositionState","_currentStartState","_currentEndState","_setNodePositionState","_checkPreviousNodePositionState","typeIndex","isStart","resultState","state","_getSelectionRuler","startPosition","endPosition","nextLength","start_next","end_next","nextType","preStartNestType","preEndNestType","func","skeletonData","getSkeletonData","pages","skeHeaders","skeFooters","pageIndex","endPageIndex","endSegmentPage","pageLayoutType","pageMarginLeft","pageMarginTop","skipPageIndex","BODY","CELL","translatePage","headerId","footerId","segmentPage2","getPageFromPath","sections","start_s","end_s","translateSave","translatePagePadding","footerTop","pageHeight","translate","rowSke","tableSke","cellLeft","tableTop","tableLeft","rowTop","columns","start_c","end_c","translateSection","c","lines","start_l","end_l","translateColumn","l2","divides","start_d","end_d","translateLine","translateDivide","translateRestore","$bb9ae9d90429a70d$export$d6b48af136414a10","anchorNodePosition","focusNodePosition","anchorPath","focusPath","tableIdIndex","anchorTableId","getTableIdAndSliceIndex","anchorRowIndex","focusRowIndex","anchorCellIndex","focusCellIndex","$bb9ae9d90429a70d$export$57d2e8d2118a89","diffValue","$bb9ae9d90429a70d$var$compareNodePositionInTable","aPath","bPath","aTableId","bTableId","split","aRowCount","bRowCount","aCellCount","bCellCount","$bb9ae9d90429a70d$var$firstGlyphInCellPage","cellPage","$bb9ae9d90429a70d$var$lastGlyphInCellPage","lastSection","lastColumn","lastLine","lastGlyphGroup","$bb9ae9d90429a70d$var$_NodePositionConvertToRectRange","endNodePosition","pointGroup","startSegmentPage","rectInfo","_getTableRectRangeInfo","startRowIndex","startColumn","endRowIndex","endRow","endColumn","skeTables","startsWith","restorePagePadding","rows","rowStartCell","cells","rowEndCell","getNodePositionGroup","nodePositionGroup","compare","totalColumns","anchor","focus","_collectPositionGroup","startCellInRow","endCellInRow","startCellGlyph","endCellGlyph","findPositionByGlyph","startPath","endPath","$bb9ae9d90429a70d$export$ea37786f3b0c02f2","pointsGroup","startPoint","endPoint","xMin","xMax","yMin","yMax","point","right","$bb9ae9d90429a70d$var$_TextRange","_scene","_document","NORMAL_TEXT_SELECTION_PLUGIN_STYLE","_segmentId","_segmentPage","TEXT","_anchorBlink","refresh","setTimeout","_anchorShape","visible","deactivateStatic","_anchorBlinkTimer","setInterval","activeStatic","$bb9ae9d90429a70d$var$BLINK_OFF","_cursorList","getDataModel","RANGE_DIRECTION","FORWARD","BACKWARD","getAbsolutePosition","_isEmpty","documentOffsetConfig","getOffsetConfig","docsLeft","docsTop","convertor","_isCollapsed","cursorList2","_setCursorList","pos","getAnchor","setProps","stroke","strokeActive","getColor","COLORS","black","isActive","_current","activate","deactivate","_rangeShape","clearInterval","isIntersection","compareRange","activeStart","activeEnd","compareStart","compareEnd","hide","glyphAtCursor","findGlyphByPosition","_createOrUpdateAnchor","_createOrUpdateRange","keys","startNodeValue","updatePointGroup","show","polygon","RegularPolygon","$bb9ae9d90429a70d$var$TEXT_RANGE_KEY_PREFIX","evented","debounceParentDirty","addObject","bounding","boundingLeft","boundingTop","MIN_CURSOR_HEIGHT","isItalic","tan","ITALIC_DEGREE","PI","transformByState","skew","Rect","$bb9ae9d90429a70d$var$TEXT_ANCHOR_KEY_PREFIX","strokeWidth","$bb9ae9d90429a70d$export$6d3a9dd6e58ad5f9","document2","docSkeleton","$bb9ae9d90429a70d$export$89d6d93b0018901c","$bb9ae9d90429a70d$var$_RectRange","findCharIndexByPosition","_startRow","_startCol","_endRow","_endCol","_tableId","spanEntireColumn","cStartRow","cStartColumn","cEndRow","cEndColumn","Rectangle","hasIntersectionBetweenTwoRect","_updateTableInfo","startCol","endCol","$bb9ae9d90429a70d$var$RECT_RANGE_KEY_PREFIX","$bb9ae9d90429a70d$var$getTextRangeFromCharIndex","findNodePositionByCharIndex","$bb9ae9d90429a70d$var$getRectRangeFromCharIndex","$bb9ae9d90429a70d$var$getRangeListFromCharIndex","$bb9ae9d90429a70d$var$getRangeListFromSelection","anchorPosition","focusPosition","rangeParams","anchorOffset","focusOffset","endInTable","tableStart","tableEnd","children2","tableStartPosition","tableEndPosition","sp","ep","ap","fp","canvas","getCanvasElement","getOffsetRectForDom","$bb9ae9d90429a70d$var$getParagraphInfoByGlyph","line2","nodeIndex","hasFound","$bb9ae9d90429a70d$var$serializeTextRange","$bb9ae9d90429a70d$var$serializeRectRange","serializedTextRange","$bb9ae9d90429a70d$var$_a3","$bb9ae9d90429a70d$var$__defProp$o","$bb9ae9d90429a70d$var$__getOwnPropDesc$o","$bb9ae9d90429a70d$var$__decorateClass$o","$bb9ae9d90429a70d$var$__decorateParam$o","_layoutService","_docSkeletonManagerService","Subject","_onInputBefore$","asObservable","BehaviorSubject","_onKeydown$","_onInput$","_onCompositionstart$","_onCompositionupdate$","_onCompositionend$","_onSelectionStart$","_onPaste$","_textSelectionInner$","_onFocus$","_onBlur$","_onPointerDown$","_initDOM","_registerContainer","_setSystemHighlightColorToStyle","activeViewPort","getViewports","setSegment","_currentSegmentId","getSegment","setSegmentPage","_currentSegmentPage","getSegmentPage","_setRangeStyle","_selectionStyle","addDocRanges","isEditing","_addRectRanges","_addTextRange","next","_getAllTextRanges","_getAllRectRanges","_updateInputPosition","forceFocus","setCursorManually","evtOffsetX","evtOffsetY","startNode","_findNodeByCoord","strict","_getNodePosition","_removeAllRanges","_createTextRangeByAnchorPosition","sync","force","isFocusing","_input","activeElement","_container","zIndex","hasFocus","_editorFocusing","blur","focusEditor","blurEditor","__handleDblClick","evt","offsetX","offsetY","paragraphInfo","Intl","Segmenter","segments","granularity","segment","isWordLike","removeAllRanges","__handleTripleClick","__onPointDown","docSelection","button","nodeCharIndex","_anchorNodePosition","shiftKey","_getActiveRangeInstance","_updateActiveRangePosition","ctrlKey","disableObjectsEvent","scrollTimer","ScrollTimer","create","_scrollTimers","startScroll","getTransformer","clearSelectedObjects","preMoveOffsetX","preMoveOffsetY","_scenePointerMoveSubs","onPointerMove$","subscribeEvent","moveEvt","moveOffsetX","moveOffsetY","setCursor","CURSOR_TYPE","sqrt","_moving","scrolling","_scenePointerUpSubs","onPointerUp$","unsubscribe","enableObjectsEvent","_focusNodePosition","_rangeListCache","_rectRangeListCache","selectionInfo","timer","r","g","getSystemHighlightColor","_rangeList","_rectRangeList","_getActiveRange","_detachEvent","remove","container","inputParent","inputDom","appendChild","_inputParent","_initInput","_initInputEvents","disposeWithMe","registerContainerElement","cssText","contentEditable","classList","ratioX","_interactTextRanges","_interactRectRanges","newRanges","_removeAllTextRanges","_removeAllRectRanges","_removeAllCacheRanges","_deactivateAllTextRanges","_deactivateAllRectRanges","_addTextRangesToCache","_addRectRangesToCache","lastRange","_getCanvasOffset","getEngine","activeRangeInstance","getAbsoluteVector","Vector2","FromArray","canvasLeft","canvasTop","focusNode","setRemainCapture","__attachScrollEvent","viewport","_viewPortObserverMap","scrollBefore","onScrollAfter$","scrollStop","onScrollEnd$","viewport2","bounds","getBounding","viewBound","fromEvent","subscribe","_isIMEInputApply","_eventHandle","config","inputType","stopPropagation","preventDefault","textContent","innerHTML","event","_getTransformCoordForDocumentOffset","documentTransform","originCoord","transformVector2SceneCoord","clone","invert","applyPoint","restrictions","coord","PageLayoutType","VERTICAL","findNodeByCoord","complete","ILayoutService","$bb9ae9d90429a70d$var$COMPONENT_DOC_HEADER_FOOTER_PANEL","$bb9ae9d90429a70d$var$jsxRuntime","$bb9ae9d90429a70d$var$reactJsxRuntime_production_min","$bb9ae9d90429a70d$var$f","__esModule","default","$bb9ae9d90429a70d$var$k","Symbol","for","$bb9ae9d90429a70d$var$l","$bb9ae9d90429a70d$var$m","$bb9ae9d90429a70d$var$n","__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","ReactCurrentOwner","$bb9ae9d90429a70d$var$p","__self","__source","$bb9ae9d90429a70d$var$q","h","defaultProps","$$typeof","_owner","Fragment","jsx","jsxs","$bb9ae9d90429a70d$var$jsxRuntimeExports","$bb9ae9d90429a70d$var$styles$5","panel","optionsSection","optionsFormItem","optionsInput","optionsMarginSetting","$bb9ae9d90429a70d$var$DocHeaderFooterOptions","useDependency","docSelectionRenderService","setOptions","useState","handleCheckboxChange","prev","editArea","getEditArea","needCreateHeaderFooter","needChangeSegmentId","DocumentEditArea","firstPageHeaderId","firstPageFooterId","evenPageHeaderId","evenPageFooterId","$bb9ae9d90429a70d$var$CoreHeaderFooterCommandId","headerFooterProps","handleMarginChange","closeHeaderFooter","renderObject","transformer","getTransformerByCreate","render2","setEditArea","calculate","makeDirty","useEffect","marginHeader","marginFooter","useFirstPageHeaderFooter","evenAndOddHeaders","Checkbox","checked","onChange","optionsMarginItem","InputNumber","precision","Button","onClick","$bb9ae9d90429a70d$var$DocHeaderFooterPanel","isEditHeaderFooter","setIsEditHeaderFooter","subscription","editAreaChange$","editArea2","panelDisableText","$bb9ae9d90429a70d$var$drawBubble","ctx","radius","bottomRight","beginPath","moveTo","lineTo","arc","closePath","save","fillStyle","restore","$bb9ae9d90429a70d$var$_TextBubbleShape","_TextBubbleShape","Shape","drawWith","font","textWidth","measureText","$bb9ae9d90429a70d$var$COLLAB_CURSOR_LABEL_MAX_WIDTH","truncatedText","currentWidth","charWidth","maxTextWidth","fillText","$bb9ae9d90429a70d$var$COLLAB_CURSOR_LABEL_HEIGHT","_draw","$bb9ae9d90429a70d$var$__defProp$n","$bb9ae9d90429a70d$var$__getOwnPropDesc$n","$bb9ae9d90429a70d$var$__decorateClass$n","$bb9ae9d90429a70d$var$__decorateParam$n","$bb9ae9d90429a70d$var$HEADER_FOOTER_STROKE_COLOR","$bb9ae9d90429a70d$var$HEADER_FOOTER_FILL_COLOR","$bb9ae9d90429a70d$var$HeaderFooterType","FIRST_PAGE_HEADER","FIRST_PAGE_FOOTER","DEFAULT_HEADER","DEFAULT_FOOTER","EVEN_PAGE_HEADER","EVEN_PAGE_FOOTER","$bb9ae9d90429a70d$var$checkCreateHeaderFooterType","defaultHeaderId","defaultFooterId","createType","headerFooterId","$bb9ae9d90429a70d$var$DocHeaderFooterController","$bb9ae9d90429a70d$var$_a4","_editorService","_instanceSrv","_renderManagerService","_docSelectionRenderService","_localeService","_componentManager","WeakSet","_initialize","documentFlavor","DocumentFlavor","TRADITIONAL","_init","_drawHeaderFooterLabel","_initCustomComponents","componentManager","docObject","_loadedMap","_initialMain","onDblclick$","_isEditorReadOnly","preEditArea","pageNumber","findEditAreaByCoord","$bb9ae9d90429a70d$var$CoreHeaderFooterCommand","activeViewport","currentRender$","isEditor","docsComponent","pageRender$","isEditBody","pageLeft","pageTop","Path","dataArray","command","$bb9ae9d90429a70d$var$TextBubbleShape","editor","getEditor","isReadOnly","_getDocDataModel","IEditorService","ComponentManager","$bb9ae9d90429a70d$var$SidebarDocHeaderFooterPanelOperation","sidebarService","ISidebarService","header","$bb9ae9d90429a70d$var$getEmptyHeaderFooterBody","$bb9ae9d90429a70d$var$createHeaderFooterAction","firstSegmentId","isHeader","insertAction","secondSegmentId","insertPairAction","pairKey","k2","replaceAction","insertAction2","docViewModel","isUpdateMargin","oldValue","$bb9ae9d90429a70d$var$OpenHeaderFooterPanelCommand","_params","$bb9ae9d90429a70d$var$COMPONENT_PREFIX","$bb9ae9d90429a70d$var$COLOR_PICKER_COMPONENT","$bb9ae9d90429a70d$var$FONT_FAMILY_COMPONENT","$bb9ae9d90429a70d$var$FONT_FAMILY_ITEM_COMPONENT","$bb9ae9d90429a70d$var$FONT_SIZE_COMPONENT","$bb9ae9d90429a70d$var$styles$4","docListTypePicker","docListTypePickerItem","docListTypePickerItemActive","$bb9ae9d90429a70d$var$ListTypePicker","item","src","img","$bb9ae9d90429a70d$var$orderListOptions","ORDER_LIST_1","ORDER_LIST_2","ORDER_LIST_3","ORDER_LIST_4","ORDER_LIST_5","$bb9ae9d90429a70d$var$OrderListTypePicker","$bb9ae9d90429a70d$var$bulletOptions","BULLET_LIST_1","BULLET_LIST_2","BULLET_LIST_3","BULLET_LIST_4","BULLET_LIST_5","$bb9ae9d90429a70d$var$BulletListTypePicker","$bb9ae9d90429a70d$var$ORDER_LIST_TYPE_COMPONENT","$bb9ae9d90429a70d$var$BULLET_LIST_TYPE_COMPONENT","$bb9ae9d90429a70d$export$9cb76b3207b29c5d","FOCUSING_UNIVER_EDITOR","FOCUSING_COMMON_DRAWINGS","$bb9ae9d90429a70d$var$whenDocAndEditorFocusedWithBreakLine","FOCUSING_UNIVER_EDITOR_STANDALONE_SINGLE_MODE","$bb9ae9d90429a70d$var$TabShortCut","binding","KeyCode","TAB","$bb9ae9d90429a70d$var$ShiftTabShortCut","MetaKeys","SHIFT","staticParameters","$bb9ae9d90429a70d$var$BoldShortCut","B","CTRL_COMMAND","$bb9ae9d90429a70d$var$ItalicShortCut","I","$bb9ae9d90429a70d$var$UnderlineShortCut","U","$bb9ae9d90429a70d$var$StrikeThroughShortCut","X","$bb9ae9d90429a70d$var$SubscriptShortCut","COMMA","$bb9ae9d90429a70d$var$SuperscriptShortCut","PERIOD","$bb9ae9d90429a70d$var$AlignLeftShortCut","L","$bb9ae9d90429a70d$var$AlignRightShortCut","R","$bb9ae9d90429a70d$var$AlignCenterShortCut","E","$bb9ae9d90429a70d$var$AlignJustifyShortCut","J","$bb9ae9d90429a70d$var$OrderListShortCut","Digit7","$bb9ae9d90429a70d$var$BulletListShortCut","Digit8","$bb9ae9d90429a70d$var$ZOOM_MAP","$bb9ae9d90429a70d$var$ZoomSlider","currentDoc$","useMemo","getCurrentTypeOfUnit$","useObservable","getCurrentZoom","useCallback","round","getSettings","zoom","setZoom","handleChange","onCommandExecuted","commandInfo","Slider","shortcuts","$bb9ae9d90429a70d$var$CountBar","$bb9ae9d90429a70d$var$DocFooter","$bb9ae9d90429a70d$var$PLUGIN_CONFIG_KEY","$bb9ae9d90429a70d$var$defaultPluginConfig","layout","docContainerConfig","outerLeft","outerRight","footer","innerLeft","innerRight","frozenHeaderLT","frozenHeaderRT","frozenHeaderLM","frozenContent","infoBar","toolbar","toolbarConfig","undo","redo","bold","italic","strikethrough","underline","textColor","fillColor","horizontalAlignMode","verticalAlignMode","textWrapMode","textRotateMode","$bb9ae9d90429a70d$var$DocParagraphSettingCommand","$bb9ae9d90429a70d$var$useDocRanges","docParagraphSettingController","$bb9ae9d90429a70d$var$DocParagraphSettingController","closePanel","$bb9ae9d90429a70d$var$useCurrentParagraph","$bb9ae9d90429a70d$var$useFirstParagraphHorizontalAlign","defaultValue","_horizontalAlignSet","firstParagraph","$bb9ae9d90429a70d$var$useFirstParagraphIndentStart","_indentStartSet","$bb9ae9d90429a70d$var$useFirstParagraphIndentEnd","indentEnd","_indentEndSet","$bb9ae9d90429a70d$var$useFirstParagraphIndentFirstLine","_indentFirstLineSet","$bb9ae9d90429a70d$var$useFirstParagraphIndentHanging","_hangingSet","$bb9ae9d90429a70d$var$useFirstParagraphIndentSpaceAbove","_spaceAboveSet","$bb9ae9d90429a70d$var$useFirstParagraphSpaceBelow","_spaceBelowSet","$bb9ae9d90429a70d$var$useFirstParagraphLineSpacing","stateChange$","_lineSpacingSet","lineSpacingCache","spacingRule","_spacingRuleSet","SpacingRule","lineSpacingSet","spacingRuleSet","AT_LEAST","glyphNode","divideNode","lineNode","contentHeight","pipe","bufferTime","list","$bb9ae9d90429a70d$var$styles$1","paragraphSettingIconList","paragraphSettingIconListItem","paragraphSettingIconListActive","paragraphSettingTitle","paragraphSettingLabel","paragraphSettingMtBase","paragraphSettingFlexCol","paragraphSettingSpaceLine","$bb9ae9d90429a70d$var$AutoFocusInputNumber","step","finally","$bb9ae9d90429a70d$var$ParagraphSetting","alignmentOptions","horizontalAlignValue","horizontalAlignSet","indentStartSet","indentEndSet","indentFirstLineSet","hangingSet","spaceAboveSet","spaceBelowSet","lineSpaceConfig","paragraphSetting","Tooltip","placement","Select","$bb9ae9d90429a70d$var$isRangesEqual","oldRanges","oldRange","$bb9ae9d90429a70d$var$isRangesIntersection","$bb9ae9d90429a70d$var$ParagraphSettingIndex","currentLocale","currentLocale$","keySet","rangeRef","info","SetTextSelectionsOperation","trigger","$bb9ae9d90429a70d$var$__defProp$m","$bb9ae9d90429a70d$var$__getOwnPropDesc$m","$bb9ae9d90429a70d$var$__decorateClass$m","$bb9ae9d90429a70d$var$__decorateParam$m","$bb9ae9d90429a70d$var$paragraphSettingIndexKey","$bb9ae9d90429a70d$var$_a5","_sidebarService","openPanel","_id","OnLifecycle","LifecycleStages","Rendered","$bb9ae9d90429a70d$var$DocParagraphSettingPanelOperation","$bb9ae9d90429a70d$var$getDisableOnCollapsedObservable","Observable","subscriber","observable","textSelection$","$bb9ae9d90429a70d$var$inSameTable","tableIds","$bb9ae9d90429a70d$var$getDisableWhenSelectionNotInTableObservable","$bb9ae9d90429a70d$var$CopyMenuFactory","MenuItemType","BUTTON","disabled$","hidden$","getMenuHiddenObservable","$bb9ae9d90429a70d$var$ParagraphSettingMenuFactory","$bb9ae9d90429a70d$var$CutMenuFactory","$bb9ae9d90429a70d$var$PasteMenuFactory","$bb9ae9d90429a70d$var$DeleteMenuFactory","$bb9ae9d90429a70d$var$TABLE_INSERT_MENU_ID","$bb9ae9d90429a70d$var$TableInsertMenuItemFactory","SUBITEMS","combineLatest","one","two","$bb9ae9d90429a70d$var$InsertRowBeforeMenuItemFactory","$bb9ae9d90429a70d$var$InsertRowAfterMenuItemFactory","$bb9ae9d90429a70d$var$InsertColumnLeftMenuItemFactory","$bb9ae9d90429a70d$var$InsertColumnRightMenuItemFactory","$bb9ae9d90429a70d$var$TABLE_DELETE_MENU_ID","$bb9ae9d90429a70d$var$TableDeleteMenuItemFactory","$bb9ae9d90429a70d$var$DeleteRowsMenuItemFactory","$bb9ae9d90429a70d$var$DeleteColumnsMenuItemFactory","$bb9ae9d90429a70d$var$DeleteTableMenuItemFactory","$bb9ae9d90429a70d$var$getInsertTableHiddenObservable","focused$","getUnitType","currentRender2","getCurrentTypeOfRenderer","$bb9ae9d90429a70d$var$getTableDisabledObservable","getCustomRangeRaw","$bb9ae9d90429a70d$var$disableMenuWhenNoDocRange","$bb9ae9d90429a70d$var$BoldMenuItemFactory","tooltip","activated$","disposable","$bb9ae9d90429a70d$var$getFontStyleAtCursor","$bb9ae9d90429a70d$var$ItalicMenuItemFactory","$bb9ae9d90429a70d$var$UnderlineMenuItemFactory","$bb9ae9d90429a70d$var$StrikeThroughMenuItemFactory","$bb9ae9d90429a70d$var$SubscriptMenuItemFactory","$bb9ae9d90429a70d$var$SuperscriptMenuItemFactory","$bb9ae9d90429a70d$var$FontFamilySelectorMenuItemFactory","SELECTOR","FONT_FAMILY_LIST","hoverable","value$","$bb9ae9d90429a70d$var$FontSizeSelectorMenuItemFactory","FONT_SIZE_LIST","$bb9ae9d90429a70d$var$TextColorSelectorMenuItemFactory","themeService","ThemeService","BUTTON_SELECTOR","defaultColor","getCurrentTheme","$bb9ae9d90429a70d$var$HeaderFooterMenuItemFactory","getHeaderFooterMenuHiddenObservable","$bb9ae9d90429a70d$var$TABLE_MENU_ID","$bb9ae9d90429a70d$var$TableMenuFactory","three","$bb9ae9d90429a70d$var$InsertTableMenuFactory","_accessor","$bb9ae9d90429a70d$var$AlignLeftMenuItemFactory","$bb9ae9d90429a70d$var$getParagraphStyleAtCursor","$bb9ae9d90429a70d$var$AlignCenterMenuItemFactory","$bb9ae9d90429a70d$var$AlignRightMenuItemFactory","$bb9ae9d90429a70d$var$AlignJustifyMenuItemFactory","$bb9ae9d90429a70d$var$listValueFactory$","textSubscription","$bb9ae9d90429a70d$var$OrderListMenuItemFactory","$bb9ae9d90429a70d$var$BulletListMenuItemFactory","$bb9ae9d90429a70d$var$CheckListMenuItemFactory","$bb9ae9d90429a70d$var$ResetBackgroundColorMenuItemFactory","$bb9ae9d90429a70d$var$BackgroundColorSelectorMenuItemFactory","primaryColor","textSelectionService","curTextRun","prevIndex","$bb9ae9d90429a70d$export$f379d63d17da932e","RibbonStartGroup","FORMAT","order","menuItemFactory","LAYOUT","ContextMenuPosition","MAIN_AREA","ContextMenuGroup","$bb9ae9d90429a70d$var$_a6","$bb9ae9d90429a70d$var$__defProp$l","$bb9ae9d90429a70d$var$__getOwnPropDesc$l","$bb9ae9d90429a70d$var$__decorateClass$l","$bb9ae9d90429a70d$var$__decorateParam$l","$bb9ae9d90429a70d$export$ef4d9179ef3ec705","_injector","_menuManagerService","_uiPartsService","_shortcutService","_configService","ColorPicker","FontFamily","FontFamilyItem","FontSize","_initUiParts","workbook","UNIVER_SHEET","getConfig","registerComponent","BuiltInUIPart","connectInjector","_initMenus","mergeMenu","_initShortCut","shortcut","registerShortcut","_initFocusHandler","_initCommands","registerCommand","registerFocusHandler","Injector","IMenuManagerService","IUIPartsService","IShortcutService","IConfigService","$bb9ae9d90429a70d$var$__defProp$k","$bb9ae9d90429a70d$var$__getOwnPropDesc$k","$bb9ae9d90429a70d$var$__decorateClass$k","$bb9ae9d90429a70d$var$__decorateParam$k","$bb9ae9d90429a70d$export$8eff10ad7001c373","$bb9ae9d90429a70d$var$_a7","takeUntil","dispose$","_scrollToSelection","scrollToRange","scrollToNode","aLeft","aTop","viewportMain","getViewport","boundLeft","boundTop","boundRight","boundBottom","transViewportScroll2ScrollValue","scrollByBarDeltaValue","$bb9ae9d90429a70d$var$_a8","$bb9ae9d90429a70d$var$__defProp$j","$bb9ae9d90429a70d$var$__getOwnPropDesc$j","$bb9ae9d90429a70d$var$__decorateClass$j","$bb9ae9d90429a70d$var$__decorateParam$j","$bb9ae9d90429a70d$export$321e75563c26d788","_contextService","_addNewRender","_initRenderRefresh","_initCommandListener","reRender","disabled","_recalculateSizeBySkeleton","viewMain","Viewport","explicitViewportWidthSet","explicitViewportHeightSet","isWheelPreventDefaultX","attachControl","onMouseWheel$","deltaFactor","abs","deltaX","scrollNum","deltaY","scaleX","scale","onMouseWheel","ScrollBar","addLayer","Layer","_addComponent","runRenderLoop","render","documents","Documents","DocBackground","addObjects","enableLayerCache","currentSkeletonBefore$","_create","changeSkeleton","updateCommandList","HORIZONTAL","resize","IContextService","$bb9ae9d90429a70d$var$_a9","$bb9ae9d90429a70d$var$__defProp$i","$bb9ae9d90429a70d$var$__getOwnPropDesc$i","$bb9ae9d90429a70d$var$__decorateClass$i","$bb9ae9d90429a70d$var$__decorateParam$i","$bb9ae9d90429a70d$var$DocContainerUIController","_docContainer","getContentRef","locale","setLocale","getUIConfig","injector","changeLocale","getComponent","UIDidMount","cb","getDocContainer","$bb9ae9d90429a70d$var$_a10","$bb9ae9d90429a70d$var$__defProp$h","$bb9ae9d90429a70d$var$__getOwnPropDesc$h","$bb9ae9d90429a70d$var$__decorateClass$h","$bb9ae9d90429a70d$var$__decorateParam$h","$bb9ae9d90429a70d$var$AppUIController","_docContainerController","createInstance","$bb9ae9d90429a70d$var$_a11","$bb9ae9d90429a70d$var$__defProp$g","$bb9ae9d90429a70d$var$__getOwnPropDesc$g","$bb9ae9d90429a70d$var$__decorateClass$g","$bb9ae9d90429a70d$var$__decorateParam$g","$bb9ae9d90429a70d$var$DocAutoFormatController","_docAutoFormatService","_initListTabAutoFormat","_initListSpaceAutoFormat","_initDefaultEnterFormat","_initExitListAutoFormat","allParagraphs","bulletParagraphs","QuickListTypeMap","$bb9ae9d90429a70d$var$firstLineInTable","$bb9ae9d90429a70d$var$lastLineInTable","lastRow","lastCell","getLastLine","$bb9ae9d90429a70d$var$findTableAfterLine","values","$bb9ae9d90429a70d$var$findLineBeforeAndAfterTable","tablePage","lineBeforeTable","lineAfterTable","lineIterator","$bb9ae9d90429a70d$var$findBellowCell","bellowRow","$bb9ae9d90429a70d$var$findAboveCell","aboveRow","$bb9ae9d90429a70d$var$findTableBeforeLine","$bb9ae9d90429a70d$var$firstLineInCell","$bb9ae9d90429a70d$var$lastLineInCell","$bb9ae9d90429a70d$var$_a12","$bb9ae9d90429a70d$var$__defProp$f","$bb9ae9d90429a70d$var$__getOwnPropDesc$f","$bb9ae9d90429a70d$var$__decorateClass$f","$bb9ae9d90429a70d$var$__decorateParam$f","$bb9ae9d90429a70d$var$DocMoveCursorController","_commandExecutedListener","_onInputSubscription","_handleMoveCursor","_handleShiftMoveSelection","_getDocObject","rangeDirection","Direction","UP","dataStreamLength","_scrollToFocusNodePosition","focusGlyph","newPos","_getTopOrBottomPosition","DOWN","newFocusOffset","newActiveRange","getCustomRanges","preSpan","curSpan","skipTokens","endNode","nodePosition","skipCellContent","offsetLeft","_getGlyphLeftOffsetInLine","_getNextOrPrevLine","_matchPositionByLeftOffset","divideLeft","nearestNode","distance","_g","_h","_i","_j","_k","_l","newLine","currentLineIndex","nLine","$bb9ae9d90429a70d$var$findAboveOrBellowCellLine","tableAfterLine","firstLine","tableBeforeLine","currentColumnIndex","prevColumnLines","currentSectionIndex","prevColumns","column2","currentPageIndex","prevSections","backScrollController","bellowCell","aboveCell","$bb9ae9d90429a70d$var$DocCreateTableConfirm","setRowCount","setColCount","handleInputChange","rowCount2","colCount2","$bb9ae9d90429a70d$var$_a13","$bb9ae9d90429a70d$var$__defProp$e","$bb9ae9d90429a70d$var$__getOwnPropDesc$e","$bb9ae9d90429a70d$var$__decorateClass$e","$bb9ae9d90429a70d$var$__decorateParam$e","$bb9ae9d90429a70d$var$DocTableController","_registerCommands","$bb9ae9d90429a70d$var$__defProp$d","$bb9ae9d90429a70d$var$__getOwnPropDesc$d","$bb9ae9d90429a70d$var$__decorateClass$d","$bb9ae9d90429a70d$var$__decorateParam$d","$bb9ae9d90429a70d$var$transformBound2OffsetBound","originBound","topLeft","$bb9ae9d90429a70d$var$transformPosition2Offset","scaleY","getAncestorScale","viewportScrollX","actualScrollX","viewportScrollY","actualScrollY","$bb9ae9d90429a70d$var$transformOffset2Bound","$bb9ae9d90429a70d$var$calcDocRangePositions$1","canvasElement","canvasClientRect","getBoundingClientRect","widthOfCanvas","pxToNum","scaleAdjust","bound","$bb9ae9d90429a70d$var$_a14","_globalPopupManagerService","_createObjectPositionObserver","targetObject","calc","offsetBound","topOffset","leftOffset","domWidth","position$","DisposableCollection","_createRangePositionObserver","positions","positions$","attachPopupToObject","popup","addPopup","subUnitId","anchorRect","anchorRect$","removePopup","attachPopupToRange","multipleDirection","bounds$","bounds2","excludeRects","excludeRects$","canDispose","activePopupId","ICanvasPopupService","$bb9ae9d90429a70d$var$__defProp$c","$bb9ae9d90429a70d$var$__getOwnPropDesc$c","$bb9ae9d90429a70d$var$__decorateClass$c","$bb9ae9d90429a70d$var$__decorateParam$c","$bb9ae9d90429a70d$var$calcDocRangePositions","root","from","rect","$bb9ae9d90429a70d$var$calcDocGlyphPosition","$bb9ae9d90429a70d$var$_a15","_hoverCustomRanges$","distinctUntilChanged","segmentPageIndex","_clickCustomRanges$","_hoverBullet$","_clickBullet$","_initResetDirty","_initEvents","_initPointer","_skeleton","_documents","preCursor","hoverCustomRanges$","getCursor","POINTER","dirty$","_customRangeDirty","_bulletDirty","fromEventSubject","onTransformChange$","TRANSFORM_CHANGE_OBSERVABLE_TYPE","throttleTime","_calcActiveRanges","_calcActiveBullet","onPointerEnter$","onPointerDown$","mergeMap","down","take","up","timeStamp","_buildCustomRangeBoundsBySegment","layouts","rects","_buildCustomRangeBounds","customRangeBounds","_customRangeBounds","_buildBulletBoundsBySegment","_b2","_c2","i2","i3","flat","bulletNode","targetLine","_buildBulletBounds","_bulletBounds","$bb9ae9d90429a70d$var$_a16","$bb9ae9d90429a70d$var$__defProp$b","$bb9ae9d90429a70d$var$__getOwnPropDesc$b","$bb9ae9d90429a70d$var$__decorateClass$b","$bb9ae9d90429a70d$var$__decorateParam$b","$bb9ae9d90429a70d$var$DocChecklistRenderController","_docEventManagerService","_initPointerDownObserver","_initHoverCursor","clickBullets$","hoverBullet$","$bb9ae9d90429a70d$var$_a17","$bb9ae9d90429a70d$var$__defProp$a","$bb9ae9d90429a70d$var$__getOwnPropDesc$a","$bb9ae9d90429a70d$var$__decorateClass$a","$bb9ae9d90429a70d$var$__decorateParam$a","$bb9ae9d90429a70d$var$DocClipboardController","_docClipboardService","_initLegacyPasteCommand","onPaste$","clipboardEvent","htmlContent","getData","$bb9ae9d90429a70d$var$__defProp$9","$bb9ae9d90429a70d$var$__getOwnPropDesc$9","$bb9ae9d90429a70d$var$__decorateClass$9","$bb9ae9d90429a70d$var$__decorateParam$9","$bb9ae9d90429a70d$var$SKIP_UNIT_IDS","DEFAULT_EMPTY_DOCUMENT_VALUE","DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY","DOCS_ZEN_EDITOR_UNIT_ID_KEY","$bb9ae9d90429a70d$var$DocContextMenuRenderController","$bb9ae9d90429a70d$var$_a18","_contextMenuService","_initPointerDown","_initEditChange","documentsSubscription","triggerContextMenu","hideContextMenu","IContextMenuService","$bb9ae9d90429a70d$var$_a19","$bb9ae9d90429a70d$var$__defProp$8","$bb9ae9d90429a70d$var$__getOwnPropDesc$8","$bb9ae9d90429a70d$var$__decorateClass$8","$bb9ae9d90429a70d$var$__decorateParam$8","$bb9ae9d90429a70d$var$DocEditorBridgeController","Set","resize$","_resize","getAllEditor","editorUnitId","_initialEditors","_initialSetValue","_initialBlur","_initialFocus","_initialValueChange","cancelDefaultResizeListener","editorDataModel","actualHeight","actualWidth","getActualSize","scrollBar","getScrollBar","contentWidth","isSingle","barSize","enableVertical","resetCanvasSizeAndUpdateScroll","scrollToBarPos","enableHorizontal","setValue$","blur$","onBlur$","getFocusEditor","isSheetEditor","focus$","focusExcepts","hasSearch","checkForSubstrings","changeSpreadsheetFocusState","getAllUnitsForType","canvasEle","getCanvas","getCanvasEle","onCompositionupdate$","_valueChange","bind","onInput$","onKeydown$","refreshValueChange","SetEditorResizeOperation","$bb9ae9d90429a70d$var$_a20","$bb9ae9d90429a70d$var$__defProp$7","$bb9ae9d90429a70d$var$__getOwnPropDesc$7","$bb9ae9d90429a70d$var$__decorateClass$7","$bb9ae9d90429a70d$var$__decorateParam$7","$bb9ae9d90429a70d$var$DocIMEInputController","_renderManagerSrv","_docImeInputManagerService","_onStartSubscription","_onUpdateSubscription","_onEndSubscription","_initialOnCompositionstart","_initialOnCompositionUpdate","_initialOnCompositionend","onCompositionstart$","_resetIME","_updateContent","onCompositionend$","isUpdate","data","_previousIMEContent","_isCompositionStart","$bb9ae9d90429a70d$var$_a21","$bb9ae9d90429a70d$var$__defProp$6","$bb9ae9d90429a70d$var$__getOwnPropDesc$6","$bb9ae9d90429a70d$var$__decorateClass$6","$bb9ae9d90429a70d$var$__decorateParam$6","$bb9ae9d90429a70d$var$DocInputController","_initialNormalInput","UNITS","$bb9ae9d90429a70d$var$_DocPageLayoutService","calculatePagePosition","getParent","docsWidth","docsHeight","engineWidth","engineHeight","sceneWidth","sceneHeight","scrollToX","scrollToViewportPos","$bb9ae9d90429a70d$var$_a22","$bb9ae9d90429a70d$var$__defProp$5","$bb9ae9d90429a70d$var$__getOwnPropDesc$5","$bb9ae9d90429a70d$var$__decorateClass$5","$bb9ae9d90429a70d$var$__decorateParam$5","$bb9ae9d90429a70d$var$DocResizeRenderController","_docPageLayoutService","isInternalEditorID","_initResize","animationFrameScheduler","refreshSelection","$bb9ae9d90429a70d$var$_a23","$bb9ae9d90429a70d$var$__defProp$4","$bb9ae9d90429a70d$var$__getOwnPropDesc$4","$bb9ae9d90429a70d$var$__decorateClass$4","$bb9ae9d90429a70d$var$__decorateParam$4","$bb9ae9d90429a70d$var$DocSelectionRenderController","_skeletonListener","_refreshListener","_syncSelection","refreshSelection$","textSelectionInner$","__replaceTextRangesWithNoRefresh","onPointerLeave$","DEFAULT","resetCursor","setCurrentUnitForType","_setEditorFocus","offsetX2","offsetY2","getFocusId","onTripleClick$","focusStyle","getCurrentSelection","init","currentSkeleton$","isInternalEditor","$bb9ae9d90429a70d$var$_a24","$bb9ae9d90429a70d$var$__defProp$3","$bb9ae9d90429a70d$var$__getOwnPropDesc$3","$bb9ae9d90429a70d$var$__decorateClass$3","$bb9ae9d90429a70d$var$__decorateParam$3","$bb9ae9d90429a70d$var$DocZoomRenderController","_initSkeletonListener","_initCommandExecutedListener","_initRenderRefresher","updateViewZoom","ratioDelta","currentRatio","nextRatio","toFixed","needRefreshSelection","$bb9ae9d90429a70d$var$__defProp$2","$bb9ae9d90429a70d$var$__getOwnPropDesc$2","$bb9ae9d90429a70d$var$__decorateClass$2","$bb9ae9d90429a70d$var$__decorateParam$2","$bb9ae9d90429a70d$export$cc3d72a47d4cd6e3","$bb9ae9d90429a70d$var$_a25","_undoRedoService","_docStateEmitService","_docStateChange$","_listenDocStateChange","_setChangeState","changeState","_cacheChangeState","beforeCommandExecuted","UndoCommandId","RedoCommandId","univerDoc","_pushHistory","_emitChangeState","docStateChangeParams$","changeStateInfo","historyParams","redoState","undoState","stateCache","_historyStateCache","_changeStateCache","cacheStates","_historyTimer","clearTimeout","_changeStateCacheTimer","firstState","lastState","Ready","DocStateEmitService","$bb9ae9d90429a70d$var$_a26","$bb9ae9d90429a70d$var$__defProp$1","$bb9ae9d90429a70d$var$__getOwnPropDesc$1","$bb9ae9d90429a70d$var$__decorateClass$1","$bb9ae9d90429a70d$var$__decorateParam$1","$bb9ae9d90429a70d$export$c7516c8e4c4bc9a0","createRender$","_createRenderWithId","_createRenderer","getTypeOfUnitAdded$","getTypeOfUnitDisposed$","_disposeRenderer","setCurrent","createRender","removeRender","$bb9ae9d90429a70d$var$BreakLineShortcut","ENTER","$bb9ae9d90429a70d$var$DeleteLeftShortcut","BACKSPACE","$bb9ae9d90429a70d$var$DeleteRightShortcut","$bb9ae9d90429a70d$var$MoveCursorUpShortcut","ARROW_UP","$bb9ae9d90429a70d$var$MoveCursorDownShortcut","ARROW_DOWN","$bb9ae9d90429a70d$var$MoveCursorLeftShortcut","ARROW_LEFT","$bb9ae9d90429a70d$var$MoveCursorRightShortcut","ARROW_RIGHT","$bb9ae9d90429a70d$var$MoveSelectionUpShortcut","$bb9ae9d90429a70d$var$MoveSelectionDownShortcut","$bb9ae9d90429a70d$var$MoveSelectionLeftShortcut","$bb9ae9d90429a70d$var$MoveSelectionRightShortcut","$bb9ae9d90429a70d$var$SelectAllShortcut","A","$bb9ae9d90429a70d$var$_a27","$bb9ae9d90429a70d$var$__defProp2","$bb9ae9d90429a70d$var$__getOwnPropDesc","$bb9ae9d90429a70d$var$__decorateClass","$bb9ae9d90429a70d$var$__decorateParam","Plugin","_config","menu","rest","setConfig","merge","_initDependencies","_initializeShortcut","_initCommand","onReady","_initRenderBasics","_markDocAsFocused","onRendered","_initUI","_initRenderModules","registerMultipleCommand","mergeOverrideWithDependencies","useClass","override","currentService","editorService","focusUnit","err","warn","DocInterceptorService","m2","registerRenderModule","$8393d90e725f1304$export$d6b40c95035461c7","$1a7ft","$e1VZ5","$jSzwf","$iNetn","$hFN8R","$jaZjQ","$4xvfD","$99A8K","bufferTimeSpan","_a","otherArgs","scheduler","popScheduler","asyncScheduler","bufferCreationInterval","maxBufferSize","Infinity","operate","source","bufferRecords","restartOnEmit","emit","record","buffer","subs","arrRemove","startBuffer","Subscription","record_1","executeSchedule","bufferTimeSubscriber","createOperatorSubscriber","e_1","recordsCopy","recordsCopy_1","__values","recordsCopy_1_1","done","e_1_1","return","undefined"],"version":3,"file":"es.917821ab.js.map"}