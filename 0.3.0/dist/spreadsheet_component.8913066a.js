function e(e,t,n,a){Object.defineProperty(e,t,{get:n,set:a,enumerable:!0,configurable:!0})}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},a={},r=t.parcelRequire26fc;null==r&&((r=function(e){if(e in n)return n[e].exports;if(e in a){var t=a[e];delete a[e];var r={id:e,exports:{}};return n[e]=r,t.call(r.exports,r,r.exports),r.exports}var s=Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(e,t){a[e]=t},t.parcelRequire26fc=r);var s=r.register;s("6wcuN",function(t,n){e(t.exports,"register",function(){return a},function(e){return a=e}),e(t.exports,"resolve",function(){return r},function(e){return r=e});var a,r,s=new Map;a=function(e,t){for(var n=0;n<t.length-1;n+=2)s.set(t[n],{baseUrl:e,path:t[n+1]})},r=function(e){var t=s.get(e);if(null==t)throw Error("Could not resolve bundle with id "+e);return new URL(t.path,t.baseUrl).toString()}}),s("7N2Ry",function(e,t){var n=r("1XeGV");e.exports=n("34tX1").then(()=>r("7yNYd"))}),s("1XeGV",function(e,t){e.exports=function(e){return import(r("6wcuN").resolve(e))}}),s("kOUYr",function(e,t){var n=r("1XeGV");e.exports=n("bsj1K").then(()=>r("1UDbf"))}),s("8rjrh",function(e,t){var n=r("1XeGV");e.exports=Promise.all([n("34tX1"),n("9KcLI")]).then(()=>r("3e0Iz"))}),s("i7wor",function(e,t){var n=r("1XeGV");e.exports=Promise.all([n("bsj1K"),n("83zSG"),n("9KcLI"),n("34tX1"),n("cEaBk")]).then(()=>r("fL2Ug"))}),s("5eNBZ",function(e,t){var n=r("1XeGV");e.exports=Promise.all([n("83zSG"),n("34tX1"),n("7XIVP")]).then(()=>r("ejawP"))}),s("9k4bI",function(e,t){var n=r("1XeGV");e.exports=Promise.all([n("R3kUb"),n("eR5nu"),n("7XIVP"),n("bsj1K"),n("83zSG"),n("cEaBk"),n("9KcLI"),n("34tX1"),n("cGlq4")]).then(()=>r("4XALk"))}),s("flDEK",function(e,t){var n=r("1XeGV");e.exports=Promise.all([n("34tX1"),n("83zSG")]).then(()=>r("86b1c"))}),s("dQhF3",function(e,t){var n=r("1XeGV");e.exports=Promise.all([n("R3kUb"),n("eR5nu"),n("cGlq4"),n("7XIVP"),n("bsj1K"),n("83zSG"),n("cEaBk"),n("9KcLI"),n("34tX1"),n("fQ6Pz")]).then(()=>r("i5NZc"))}),s("02ghv",function(e,t){var n=r("1XeGV");e.exports=Promise.all([n("R3kUb"),n("eR5nu"),n("cGlq4"),n("7XIVP"),n("bsj1K"),n("83zSG"),n("cEaBk"),n("9KcLI"),n("34tX1"),n("jtPqR")]).then(()=>r("bRzks"))}),s("4H828",function(e,t){var n=r("1XeGV");e.exports=Promise.all([n("jtPqR"),n("fQ6Pz"),n("R3kUb"),n("eR5nu"),n("cGlq4"),n("7XIVP"),n("bsj1K"),n("83zSG"),n("cEaBk"),n("9KcLI"),n("34tX1"),n("9LVLP")]).then(()=>r("7qSdr"))}),s("252tF",function(e,t){var n=r("1XeGV");e.exports=n("buFfU").then(()=>r("5DAFn"))}),s("keYKK",function(e,t){var n=r("1XeGV");e.exports=Promise.all([n("9KcLI"),n("34tX1"),n("R3kUb")]).then(()=>r("7AR1b"))}),s("FUWpF",function(e,t){var n=r("1XeGV");e.exports=Promise.all([n("R3kUb"),n("bsj1K"),n("83zSG"),n("cEaBk"),n("9KcLI"),n("34tX1"),n("eR5nu")]).then(()=>r("g6Cit"))}),s("6Xmii",function(e,t){var n=r("1XeGV");e.exports=n("dI0Yq").then(()=>r("fsU3r"))}),s("11ygn",function(e,t){var n=r("1XeGV");e.exports=n("cXU77").then(()=>r("lH5uj"))}),s("fut46",function(e,t){var n=r("1XeGV");e.exports=n("4p4lP").then(()=>r("bx8hK"))}),s("d24Q8",function(e,t){var n=r("1XeGV");e.exports=n("2bsWP").then(()=>r("j6yrw"))}),s("7aGPl",function(e,t){var n=r("1XeGV");e.exports=n("igrod").then(()=>r("cJji3"))}),s("ihZKh",function(e,t){var n=r("1XeGV");e.exports=n("gwgTn").then(()=>r("4rp5R"))}),r("6wcuN").register(new URL("",import.meta.url).toString(),JSON.parse('["gBQDZ","spreadsheet_component.8913066a.js","34tX1","es.4073df86.js","bsj1K","es.d4561dfb.js","9KcLI","es.386b85e0.js","j1ekd","af-Cp38c8Xu.b1835272.js","12XI3","as-BRA2d3pp.b0be1134.js","7dQ6w","be-DuPPDo85.87de096b.js","aR3dB","bg-CREWvG4t.eb7adcee.js","6dlTG","bn-D2KtSTkr.ad9ff169.js","iHxY6","ca-4YYrF7D4.ec430d88.js","ierj0","cop-C8rmq-mf.abe44ed4.js","9YaaE","cs-D-GFbZkE.5e86901d.js","2uxVU","cu-B6XjYaXV.b00e0147.js","8Fzh7","cy-Dz9q6g42.760af764.js","6mvOi","da-C6piIYvN.3daf533c.js","5DymU","de-1901-BlrbOJIy.86f36e7b.js","h39JH","de-1996-DJBaU2Ij.a04619fd.js","3wBO2","de-ch-1901-CD9ndUrR.b17df4ee.js","afBvC","el-monoton-C7Dj3t8L.e1d43899.js","3GfEC","el-polyton-3hQ3_5V8.53e2c883.js","ekYfz","en-gb-BJlV3ZpD.5fc9489f.js","vcVG4","es-DVBhSqkX.2039e7e4.js","2Njvn","et-Db4qA7uM.d122c547.js","kRA9E","eu-Cks5q4oj.54ea2d51.js","8O9PV","fi-CloSDd5R.ab12fadf.js","1nNro","fr-B1BYHADY.f2fc8e4d.js","e4UQT","fur-CBBh0qht.3e2be8f9.js","gdCmT","ga-BcR3t3dJ.9f8184dd.js","dcMa7","gl-BBvFm_J1.49d33b10.js","8W2ni","grc-C45HXf-r.29d17182.js","ios3Z","gu-wLi0mXrk.e536299f.js","7Rd2S","hi-0oXXR9W5.2494e7b8.js","cQPq9","hr-qQvmVP7S.8e8e3d67.js","bsGms","hsb-Cfm_aA_B.369fb68a.js","9IU2y","hu-DX3GX0Md.4dd57195.js","arWzY","hy-CQNr6JSB.57e88c63.js","hhPte","ia-C6a-e-Dj.3f36aa59.js","6xNlC","id-Dz9P_puV.d3734f08.js","kR84t","is-i5pSEnjg.9883b016.js","aRurr","it-DW0whi0u.da4155a9.js","dWEUe","ka-BLB-V1lz.9f54a04e.js","jP9ip","kmr-B-KiPlp3.a08c4f90.js","5mEJO","kn-DO8F4Tga.84f00830.js","hJELK","la-x-classic-DfZknpxy.ae3e8ae7.js","f0wCn","la-x-liturgic-DTe6oXWw.d5270eb8.js","ko3ta","la-DHKd_s9q.94783506.js","8jP0y","lt-DtlA9rsC.c9ce13a7.js","46KdE","lv-DXaKRahI.adba6813.js","hfiuD","ml-BGEScgvb.da0163dc.js","emsTz","mn-cyrl-x-lmc-BGezHEbR.d2efbcde.js","kwNXT","mn-cyrl-BhdxkmdX.30626b07.js","5GkF7","mr-DEKWXvtC.ea46dd62.js","lOpB6","mul-ethi-BJCO9BlO.2bac3c41.js","b5qox","nb-DXDxUDDo.ce94be97.js","4A853","nl-DVAPWIGp.454641d8.js","lyWJR","nn-U4EJzxc1.8ef2c9ac.js","3WEIa","no-CYxBnhIW.4450472e.js","9BvKh","oc-DsUOXMQD.23b8f25f.js","g9ov9","or-CKqO0QN6.481d18c9.js","7nyGa","pa-C289aRic.c741c078.js","kH6O4","pi-BCynSWdr.9319f14a.js","50tW3","pl-Dc8CHLY1.3e0287af.js","elp71","pms-D7eF7JvK.543a79c8.js","dccfm","pt-BIKGx1hO.a7632f9e.js","bp2Xo","rm-CtXRfXwR.94492531.js","j94fw","ro-Dgc3hCQP.e1173079.js","72JGv","ru-CfO_VOSH.55cff1d0.js","3Na83","sa-Ci_yq_nB.00f5f1aa.js","3D1vM","sh-cyrl-B2Lh5Alp.913fb6cc.js","aa2ZT","sh-latn-B7Pprjwx.a102992e.js","hxVzT","sk-CertwDVR.1dcd724b.js","gwiqx","sl-BDe1PmyZ.639dc944.js","hfS1Y","sr-cyrl-Dw0eEBrg.ce360720.js","a9mgO","sv-BVAzsIUi.b1cab97d.js","c4m6x","ta-Cai0wUPn.aef7d99b.js","9glEV","te-DKbqLYh4.46516106.js","l4xIl","th-DJ6gR5Ug.ff693b3d.js","9DJv4","tk-DNRkC-pL.96f10546.js","9Elyk","tr-BRmPg68h.abfd5101.js","LHsoW","uk-BS0jT5id.be155c88.js","8bMdb","zh-latn-pinyin-UC2Ykr4P.a7a26069.js","cEaBk","es.8031d09e.js","fBi3N","vue.runtime.esm-bundler.c0bdcbe8.js","83zSG","es.4fcbf5f3.js","7XIVP","es.9d442354.js","cGlq4","es.d38276dd.js","eR5nu","es.917821ab.js","R3kUb","es.4cde6bdd.js","fQ6Pz","es.c3160f60.js","jtPqR","es.2c1bf632.js","9LVLP","es.a3f7342e.js","buFfU","zod.7959bba4.js","dI0Yq","en-US.6b1989c8.js","cXU77","en-US.6b3d7700.js","4p4lP","en-US.8a6ddb88.js","2bsWP","en-US.dc454c66.js","igrod","en-US.3f83ec5e.js","gwgTn","en-US.77870d63.js"]'));const o=r("7N2Ry").then(({Univer:e,LocaleType:t,Tools:n})=>({Univer:e,LocaleType:t,Tools:n})),i=r("kOUYr").then(({defaultTheme:e})=>({defaultTheme:e})),c=r("8rjrh").then(({UniverRenderEnginePlugin:e})=>e),l=r("i7wor").then(({UniverUIPlugin:e})=>e),_=r("5eNBZ").then(({UniverSheetsPlugin:e})=>e),d=r("9k4bI").then(({UniverSheetsUIPlugin:e})=>e),f=r("flDEK").then(({UniverFormulaEnginePlugin:e})=>e),H=r("dQhF3").then(({UniverSheetsNumfmtPlugin:e})=>e),b=r("02ghv").then(({UniverSheetsFormulaPlugin:e})=>e),u=r("4H828").then(({FUniver:e})=>({FUniver:e})),S=r("252tF"),R=r("keYKK").then(({UniverDocsPlugin:e})=>e),E=r("FUWpF").then(({UniverDocsUIPlugin:e})=>e),j=r("6Xmii"),p=r("11ygn"),h=r("fut46"),F=r("d24Q8"),A=r("7aGPl"),g=r("ihZKh");async function m(e){let{Univer:t,LocaleType:n,Tools:a}=await o,{defaultTheme:r}=await i,s=new t({theme:r,logLevel:3,locale:n.EN_US,locales:{[n.EN_US]:a.deepMerge(await j,await p,await h,await F,await A,await g)}});return s.registerPlugin(await c),e.className="sqlpage_spreadsheet",s.registerPlugin(await l,{container:e}),s.registerPlugin(await _),s.registerPlugin(await d),s.registerPlugin(await R),s.registerPlugin(await E),s}async function v(e){e.registerPlugin(await f),e.registerPlugin(await H),e.registerPlugin(await b)}async function w(e,t,n,a,r,s){if(!e)return;let o=new URL(e,window.location.href);o.searchParams.append("_sqlpage_embed","");let i=new URLSearchParams;i.append("x",t.toString()),i.append("y",n.toString()),null!=a&&i.append("value",a.toString()),"string"==typeof r.id&&i.append("id",r.id);let c=await fetch(o,{method:"POST",body:i}),l=await c.text();200===c.status||l||(l=c.statusText),l&&(s.resp_modal_body.innerHTML=l,new s.Modal(s.resp_modal).show())}async function P(e,t,n){let{update_link:a,freeze_x:r,freeze_y:s}=t,o=e.querySelector(".modal");if(!(o instanceof HTMLElement))throw Error("modal not found");let i=function(e){if(!e)throw Error("errorModal not found");let t=e.querySelector(".modal-body");if(!t)throw Error("errorModal not found");let n=window?.bootstrap?.Modal;if(!n)throw Error("bootstrap.Modal not found");return{resp_modal:e,resp_modal_body:t,Modal:n}}(o),c=function(e,t){let n={},a=1e3,r=26,s=x(t);for(let t of e){let[e,o,i,...c]=s.parse(t),l={v:i},_=c.length?function(e){let t={};for(let n=0;n<e.length;n++){let a=e[n];if(1===a)t.bl=1;else if(2===a)t.it=1;else if(3===a){let a=e[++n];t.bg={rgb:getComputedStyle(document.documentElement).getPropertyValue(`--tblr-${a}`)}}else if(4===a)t.ht=2;else if(5===a)t.ht=3;else if(6===a){let a=e[++n].toString();t.n={pattern:a}}else 7===a&&(t.id=e[++n].toString())}return t}(c):null;l.s=_,_?.id&&(l.custom={id:_.id}),"number"==typeof i&&(l.t=2);let d=n[o];d?d[e]=l:n[o]={[e]:l},a=Math.max(a,o),r=Math.max(r,e)}return{id:"sqlpage",name:"SQLPage Data",rowCount:a,columnCount:r,cellData:n}}(n,await S),l=await m(e);await v(l);let _=l.createUnit(2,{sheetOrder:["sqlpage"],name:"sqlpage",appVersion:"0.2.14",sheets:{sqlpage:c}}).getActiveSheet(),{FUniver:d}=await u,f=d.newAPI(l);(r||s)&&f.executeCommand("sheet.mutation.set-frozen",{unitId:_.getUnitId(),subUnitId:_.getSheetId(),startRow:s,startColumn:r,xSplit:r,ySplit:s}),f.onCommandExecuted(({id:e,params:t})=>{console.log(e,t),"sheet.mutation.set-range-values"===e&&function(e,t,n){let{cellValue:a}=e;if(a)for(let e in a){let r=a[e];for(let a in r){let s=r[a];s&&w(t,Number.parseInt(a),Number.parseInt(e),s.v,s.custom||{},n)}}}(t,a,i)})}const U=e=>e.object({update_link:e.string(),freeze_x:e.number().int().nonnegative().default(0),freeze_y:e.number().int().nonnegative().default(0)}),X=e=>e.union([e.string(),e.number()]),x=e=>e.tuple([e.number().int().nonnegative(),e.number().int().nonnegative(),e.union([e.string(),e.number(),e.null()])]).rest(X(e));async function y(e){try{let t=e.dataset;if(!t)throw Error("Props not found");let n=JSON.parse(t?.cells||"[]");if(!Array.isArray(n))throw Error(`Invalid cells${t?.cells}`);let a=U(await S).parse(JSON.parse(t?.props||"{}"));P(e,a,n)}catch(e){alert(`Invalid properties passed to the spreadsheet component: ${e}`)}}const D=document.getElementsByClassName("sqlpage_spreadsheet"),B=D[D.length-1];if(!(B instanceof HTMLElement))throw Error("No spreadsheet elements found");y(B);
//# sourceMappingURL=spreadsheet_component.8913066a.js.map
