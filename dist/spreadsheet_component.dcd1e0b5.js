!function(){function e(e,t,r,n){Object.defineProperty(e,t,{get:r,set:n,enumerable:!0,configurable:!0})}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},r={},n={},a=t.parcelRequire26fc;null==a&&((a=function(e){if(e in r)return r[e].exports;if(e in n){var t=n[e];delete n[e];var a={id:e,exports:{}};return r[e]=a,t.call(a.exports,a,a.exports),a.exports}var s=Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(e,t){n[e]=t},t.parcelRequire26fc=a);var s=a.register;s("dzyxx",function(t,r){e(t.exports,"register",function(){return n},function(e){return n=e}),e(t.exports,"resolve",function(){return a},function(e){return a=e});var n,a,s=new Map;n=function(e,t){for(var r=0;r<t.length-1;r+=2)s.set(t[r],{baseUrl:e,path:t[r+1]})},a=function(e){var t=s.get(e);if(null==t)throw Error("Could not resolve bundle with id "+e);return new URL(t.path,t.baseUrl).toString()}}),s("d3Jml",function(t,r){e(t.exports,"getBundleURL",function(){return n},function(e){return n=e});var n,a={};n=function(e){var t=a[e];return t||(t=function(){try{throw Error()}catch(t){var e=(""+t.stack).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^)\n]+/g);if(e)return(""+e[2]).replace(/^((?:https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/.+)\/[^/]+$/,"$1")+"/"}return"/"}(),a[e]=t),t}}),s("9RcdO",function(e,t){e.exports=a("8YGK2")(a("dzyxx").resolve("apEsh")).then(()=>a("83KcA"))}),s("8YGK2",function(e,t){var r=a("hoEmZ");e.exports=r(function(e){return new Promise(function(t,r){if([].concat(document.getElementsByTagName("script")).some(function(t){return t.src===e})){t();return}var n=document.createElement("link");n.href=e,n.rel="preload",n.as="script",document.head.appendChild(n);var a=document.createElement("script");a.async=!0,a.type="text/javascript",a.src=e,a.onerror=function(t){var n=TypeError("Failed to fetch dynamically imported module: ".concat(e,". Error: ").concat(t.message));a.onerror=a.onload=null,a.remove(),r(n)},a.onload=function(){a.onerror=a.onload=null,t()},document.getElementsByTagName("head")[0].appendChild(a)})})}),s("hoEmZ",function(e,t){var r={},n={},a={};e.exports=function(e,t){return function(s){var o=function(e){switch(e){case"preload":return n;case"prefetch":return a;default:return r}}(t);return o[s]?o[s]:o[s]=e.apply(null,arguments).catch(function(e){throw delete o[s],e})}}}),s("5y4D6",function(e,t){e.exports=a("8YGK2")(a("dzyxx").resolve("azPLm")).then(()=>a("bLx5G"))}),s("2y5Cq",function(e,t){e.exports=Promise.all([a("8YGK2")(a("dzyxx").resolve("apEsh")),a("8YGK2")(a("dzyxx").resolve("73Auj"))]).then(()=>a("D79YY"))}),s("aWrES",function(e,t){e.exports=Promise.all([a("8YGK2")(a("dzyxx").resolve("azPLm")),a("8YGK2")(a("dzyxx").resolve("3tiNK")),a("8YGK2")(a("dzyxx").resolve("73Auj")),a("8YGK2")(a("dzyxx").resolve("apEsh")),a("8YGK2")(a("dzyxx").resolve("58KQx"))]).then(()=>a("cahIb"))}),s("jwpBy",function(e,t){e.exports=Promise.all([a("8YGK2")(a("dzyxx").resolve("3tiNK")),a("8YGK2")(a("dzyxx").resolve("apEsh")),a("8YGK2")(a("dzyxx").resolve("ONuhG"))]).then(()=>a("ls2nu"))}),s("4d0dF",function(e,t){e.exports=Promise.all([a("8YGK2")(a("dzyxx").resolve("5z4oA")),a("8YGK2")(a("dzyxx").resolve("hHJxO")),a("8YGK2")(a("dzyxx").resolve("ONuhG")),a("8YGK2")(a("dzyxx").resolve("azPLm")),a("8YGK2")(a("dzyxx").resolve("3tiNK")),a("8YGK2")(a("dzyxx").resolve("58KQx")),a("8YGK2")(a("dzyxx").resolve("73Auj")),a("8YGK2")(a("dzyxx").resolve("apEsh")),a("8YGK2")(a("dzyxx").resolve("85yZO"))]).then(()=>a("11kpD"))}),s("gnk8T",function(e,t){e.exports=Promise.all([a("8YGK2")(a("dzyxx").resolve("apEsh")),a("8YGK2")(a("dzyxx").resolve("3tiNK"))]).then(()=>a("kkAWv"))}),s("6GJYh",function(e,t){e.exports=Promise.all([a("8YGK2")(a("dzyxx").resolve("5z4oA")),a("8YGK2")(a("dzyxx").resolve("hHJxO")),a("8YGK2")(a("dzyxx").resolve("85yZO")),a("8YGK2")(a("dzyxx").resolve("ONuhG")),a("8YGK2")(a("dzyxx").resolve("azPLm")),a("8YGK2")(a("dzyxx").resolve("3tiNK")),a("8YGK2")(a("dzyxx").resolve("58KQx")),a("8YGK2")(a("dzyxx").resolve("73Auj")),a("8YGK2")(a("dzyxx").resolve("apEsh")),a("8YGK2")(a("dzyxx").resolve("4XMBH"))]).then(()=>a("61xGp"))}),s("7KLar",function(e,t){e.exports=Promise.all([a("8YGK2")(a("dzyxx").resolve("5z4oA")),a("8YGK2")(a("dzyxx").resolve("hHJxO")),a("8YGK2")(a("dzyxx").resolve("85yZO")),a("8YGK2")(a("dzyxx").resolve("ONuhG")),a("8YGK2")(a("dzyxx").resolve("azPLm")),a("8YGK2")(a("dzyxx").resolve("3tiNK")),a("8YGK2")(a("dzyxx").resolve("58KQx")),a("8YGK2")(a("dzyxx").resolve("73Auj")),a("8YGK2")(a("dzyxx").resolve("apEsh")),a("8YGK2")(a("dzyxx").resolve("2xzoD"))]).then(()=>a("kqxPe"))}),s("idaMJ",function(e,t){e.exports=Promise.all([a("8YGK2")(a("dzyxx").resolve("2xzoD")),a("8YGK2")(a("dzyxx").resolve("4XMBH")),a("8YGK2")(a("dzyxx").resolve("5z4oA")),a("8YGK2")(a("dzyxx").resolve("hHJxO")),a("8YGK2")(a("dzyxx").resolve("85yZO")),a("8YGK2")(a("dzyxx").resolve("ONuhG")),a("8YGK2")(a("dzyxx").resolve("azPLm")),a("8YGK2")(a("dzyxx").resolve("3tiNK")),a("8YGK2")(a("dzyxx").resolve("58KQx")),a("8YGK2")(a("dzyxx").resolve("73Auj")),a("8YGK2")(a("dzyxx").resolve("apEsh")),a("8YGK2")(a("dzyxx").resolve("inHOa"))]).then(()=>a("9WggK"))}),s("6MVtT",function(e,t){e.exports=a("8YGK2")(a("dzyxx").resolve("5eEGw")).then(()=>a("dEw92"))}),s("lKAP2",function(e,t){e.exports=Promise.all([a("8YGK2")(a("dzyxx").resolve("73Auj")),a("8YGK2")(a("dzyxx").resolve("apEsh")),a("8YGK2")(a("dzyxx").resolve("5z4oA"))]).then(()=>a("kB4bq"))}),s("haVV7",function(e,t){e.exports=Promise.all([a("8YGK2")(a("dzyxx").resolve("5z4oA")),a("8YGK2")(a("dzyxx").resolve("azPLm")),a("8YGK2")(a("dzyxx").resolve("3tiNK")),a("8YGK2")(a("dzyxx").resolve("58KQx")),a("8YGK2")(a("dzyxx").resolve("73Auj")),a("8YGK2")(a("dzyxx").resolve("apEsh")),a("8YGK2")(a("dzyxx").resolve("hHJxO"))]).then(()=>a("70MC3"))}),s("7fqJu",function(e,t){e.exports=a("8YGK2")(a("dzyxx").resolve("lLaoP")).then(()=>a("j88Hs"))}),s("its7j",function(e,t){e.exports=a("8YGK2")(a("dzyxx").resolve("lffLx")).then(()=>a("3OUvn"))}),s("3I1fq",function(e,t){e.exports=a("8YGK2")(a("dzyxx").resolve("hBEND")).then(()=>a("bUhXz"))}),s("k2bja",function(e,t){e.exports=a("8YGK2")(a("dzyxx").resolve("iL1eB")).then(()=>a("gJdUJ"))}),s("qcAGl",function(e,t){e.exports=a("8YGK2")(a("dzyxx").resolve("5NMTQ")).then(()=>a("beP1K"))}),s("dd6oD",function(e,t){e.exports=a("8YGK2")(a("dzyxx").resolve("8vi8C")).then(()=>a("ge0e1"))}),a("dzyxx").register(a("d3Jml").getBundleURL("a3aaT"),JSON.parse('["a3aaT","spreadsheet_component.dcd1e0b5.js","apEsh","es.29c55add.js","azPLm","es.f2ec95df.js","73Auj","es.45e0ccd9.js","dcbjt","af-Cp38c8Xu.f3acea66.js","3o6uc","as-BRA2d3pp.2caa856f.js","3bHZd","be-DuPPDo85.5e1326ca.js","lMpcf","bg-CREWvG4t.cebfd38c.js","kOeqp","bn-D2KtSTkr.fed72c4e.js","9mCSp","ca-4YYrF7D4.d92e1594.js","9oT7C","cop-C8rmq-mf.1f499a47.js","93bvJ","cs-D-GFbZkE.ef04c883.js","9hu4y","cu-B6XjYaXV.bd7e3950.js","rgmSS","cy-Dz9q6g42.e5f9d81d.js","fQwer","da-C6piIYvN.8bd8bd88.js","2RPO8","de-1901-BlrbOJIy.d2fd1869.js","2gBop","de-1996-DJBaU2Ij.1a88ea4a.js","iHOW2","de-ch-1901-CD9ndUrR.8e79664f.js","kRZax","el-monoton-C7Dj3t8L.d1db7f2d.js","d2C4N","el-polyton-3hQ3_5V8.85d1291c.js","b32Gz","en-gb-BJlV3ZpD.d314aad3.js","2Hpg3","es-DVBhSqkX.8b8a090b.js","6blpv","et-Db4qA7uM.42bcb6e1.js","a1ugX","eu-Cks5q4oj.c0e72c76.js","aicaK","fi-CloSDd5R.8b79eadd.js","kYrtI","fr-B1BYHADY.69748a2d.js","4RHBn","fur-CBBh0qht.ccc8d681.js","7g7GK","ga-BcR3t3dJ.4e12f2b2.js","fKZDy","gl-BBvFm_J1.f02e48fa.js","aon9y","grc-C45HXf-r.43950c98.js","1jC29","gu-wLi0mXrk.0033f36c.js","bAzqj","hi-0oXXR9W5.bdf89caf.js","9FYgV","hr-qQvmVP7S.d38897c1.js","2nPWA","hsb-Cfm_aA_B.ca42274c.js","cixS6","hu-DX3GX0Md.29bd3de8.js","6rsgU","hy-CQNr6JSB.aada8253.js","5Rzvw","ia-C6a-e-Dj.e16b0354.js","f5ij8","id-Dz9P_puV.6901f899.js","eTZBP","is-i5pSEnjg.de75bf10.js","8IFw3","it-DW0whi0u.01a84796.js","lTuj4","ka-BLB-V1lz.55f3c05a.js","iADKM","kmr-B-KiPlp3.c88c7a10.js","gthNL","kn-DO8F4Tga.851262fb.js","6voCO","la-x-classic-DfZknpxy.8e342fb8.js","74hlj","la-x-liturgic-DTe6oXWw.ca3af5e4.js","bwTEp","la-DHKd_s9q.4e16ac65.js","a51Fa","lt-DtlA9rsC.9955f91c.js","fNnwG","lv-DXaKRahI.67337ad4.js","5YaoN","ml-BGEScgvb.cbc66d65.js","kXBwD","mn-cyrl-x-lmc-BGezHEbR.2285f8ce.js","6REZe","mn-cyrl-BhdxkmdX.601473c8.js","jlWCw","mr-DEKWXvtC.ab1f67a4.js","ec3GJ","mul-ethi-BJCO9BlO.191bdf42.js","EHPGy","nb-DXDxUDDo.6abdcaf4.js","bfXj8","nl-DVAPWIGp.454befff.js","cwqkN","nn-U4EJzxc1.61fb5c4c.js","aUA1D","no-CYxBnhIW.e5fb00e1.js","7us4U","oc-DsUOXMQD.6cc7e276.js","ffu4h","or-CKqO0QN6.c1aef720.js","ltQpt","pa-C289aRic.934bf53a.js","eHnSR","pi-BCynSWdr.aa2b42a0.js","kRdLI","pl-Dc8CHLY1.b46d3b3f.js","icpWB","pms-D7eF7JvK.8061c93d.js","dvwK5","pt-BIKGx1hO.e57a84ff.js","j1go5","rm-CtXRfXwR.d0229af6.js","cwqo5","ro-Dgc3hCQP.a1bfac59.js","kF3AP","ru-CfO_VOSH.dcdd7110.js","l0F72","sa-Ci_yq_nB.63694947.js","cCpdq","sh-cyrl-B2Lh5Alp.7610515f.js","ibaUk","sh-latn-B7Pprjwx.184522c4.js","8B169","sk-CertwDVR.a5ea3456.js","1xSvG","sl-BDe1PmyZ.fda1d799.js","79SOi","sr-cyrl-Dw0eEBrg.989847a8.js","eGpGe","sv-BVAzsIUi.ca6716ba.js","bOVjW","ta-Cai0wUPn.e71f1fd5.js","d7hno","te-DKbqLYh4.bf5b1127.js","9tYNC","th-DJ6gR5Ug.9197c38b.js","5Vuog","tk-DNRkC-pL.6071f732.js","edz1o","tr-BRmPg68h.256d935e.js","kKV3d","uk-BS0jT5id.acfb035c.js","iDf2T","zh-latn-pinyin-UC2Ykr4P.0464d8b1.js","58KQx","es.8eb3f5c1.js","9KnsC","vue.runtime.esm-bundler.5aec1449.js","3tiNK","es.1711776c.js","ONuhG","es.2b51d836.js","85yZO","es.a741fbee.js","hHJxO","es.d9e16717.js","5z4oA","es.5a078b65.js","4XMBH","es.6f3dd60a.js","2xzoD","es.b4f7bce2.js","inHOa","es.812dc271.js","5eEGw","zod.67536d7c.js","lLaoP","en-US.2df2946f.js","lffLx","en-US.a3e98a99.js","hBEND","en-US.294e96f7.js","iL1eB","en-US.98782d03.js","5NMTQ","en-US.49d94f98.js","8vi8C","en-US.06c6e7b3.js","eNQi1","spreadsheet_component.1f53b4c5.css"]'));let o=a("9RcdO").then(({Univer:e,LocaleType:t,Tools:r})=>({Univer:e,LocaleType:t,Tools:r})),d=a("5y4D6").then(({defaultTheme:e})=>({defaultTheme:e})),l=a("2y5Cq").then(({UniverRenderEnginePlugin:e})=>e),i=a("aWrES").then(({UniverUIPlugin:e})=>e),f=a("jwpBy").then(({UniverSheetsPlugin:e})=>e),c=a("4d0dF").then(({UniverSheetsUIPlugin:e})=>e),_=a("gnk8T").then(({UniverFormulaEnginePlugin:e})=>e),H=a("6GJYh").then(({UniverSheetsNumfmtPlugin:e})=>e),x=a("7KLar").then(({UniverSheetsFormulaPlugin:e})=>e),u=a("idaMJ").then(({FUniver:e})=>({FUniver:e})),p=a("6MVtT"),h=a("lKAP2").then(({UniverDocsPlugin:e})=>e),b=a("haVV7").then(({UniverDocsUIPlugin:e})=>e),E=a("7fqJu"),S=a("its7j"),y=a("3I1fq"),v=a("k2bja"),A=a("qcAGl"),j=a("dd6oD");async function R(e){let{Univer:t,LocaleType:r,Tools:n}=await o,{defaultTheme:a}=await d,s=new t({theme:a,logLevel:3,locale:r.EN_US,locales:{[r.EN_US]:n.deepMerge(await E,await S,await y,await v,await A,await j)}});return s.registerPlugin(await l),e.className="sqlpage_spreadsheet",s.registerPlugin(await i,{container:e}),s.registerPlugin(await f),s.registerPlugin(await c),s.registerPlugin(await h),s.registerPlugin(await b),s}async function m(e){e.registerPlugin(await _),e.registerPlugin(await H),e.registerPlugin(await x)}async function g(e,t,r,n,a,s){if(!e)return;let o=new URL(e,window.location.href);o.searchParams.append("_sqlpage_embed","");let d=new URLSearchParams;d.append("x",t.toString()),d.append("y",r.toString()),null!=n&&d.append("value",n.toString()),"string"==typeof a.id&&d.append("id",a.id);let l=await fetch(o,{method:"POST",body:d}),i=await l.text();200===l.status||i||(i=l.statusText),i&&(s.resp_modal_body.innerHTML=i,new s.Modal(s.resp_modal).show())}async function F(e,t,r){let{update_link:n,freeze_x:a,freeze_y:s}=t,o=e.querySelector(".modal");if(!(o instanceof HTMLElement))throw Error("modal not found");let d=function(e){if(!e)throw Error("errorModal not found");let t=e.querySelector(".modal-body");if(!t)throw Error("errorModal not found");let r=window?.bootstrap?.Modal;if(!r)throw Error("bootstrap.Modal not found");return{resp_modal:e,resp_modal_body:t,Modal:r}}(o),l=function(e,t){let r={},n=1e3,a=26,s=G(t);for(let t of e){let[e,o,d,...l]=s.parse(t),i={v:d},f=l.length?function(e){let t={};for(let r=0;r<e.length;r++){let n=e[r];if(1===n)t.bl=1;else if(2===n)t.it=1;else if(3===n){let n=e[++r];t.bg={rgb:getComputedStyle(document.documentElement).getPropertyValue(`--tblr-${n}`)}}else if(4===n)t.ht=2;else if(5===n)t.ht=3;else if(6===n){let n=e[++r].toString();t.n={pattern:n}}else 7===n&&(t.id=e[++r].toString())}return t}(l):null;i.s=f,f?.id&&(i.custom={id:f.id}),"number"==typeof d&&(i.t=2);let c=r[o];c?c[e]=i:r[o]={[e]:i},n=Math.max(n,o),a=Math.max(a,e)}return{id:"sqlpage",name:"SQLPage Data",rowCount:n,columnCount:a,cellData:r}}(r,await p),i=await R(e);await m(i);let f=i.createUnit(2,{sheetOrder:["sqlpage"],name:"sqlpage",appVersion:"0.2.14",sheets:{sqlpage:l}}).getActiveSheet(),{FUniver:c}=await u,_=c.newAPI(i);(a||s)&&_.executeCommand("sheet.mutation.set-frozen",{unitId:f.getUnitId(),subUnitId:f.getSheetId(),startRow:s,startColumn:a,xSplit:a,ySplit:s}),_.onCommandExecuted(({id:e,params:t})=>{console.log(e,t),"sheet.mutation.set-range-values"===e&&function(e,t,r){let{cellValue:n}=e;if(n)for(let e in n){let a=n[e];for(let n in a){let s=a[n];s&&g(t,Number.parseInt(n),Number.parseInt(e),s.v,s.custom||{},r)}}}(t,n,d)})}let z=e=>e.object({update_link:e.string(),freeze_x:e.number().int().nonnegative().default(0),freeze_y:e.number().int().nonnegative().default(0)}),K=e=>e.union([e.string(),e.number()]),G=e=>e.tuple([e.number().int().nonnegative(),e.number().int().nonnegative(),e.union([e.string(),e.number(),e.null()])]).rest(K(e));async function Y(e){try{let t=e.dataset;if(!t)throw Error("Props not found");let r=JSON.parse(t?.cells||"[]");if(!Array.isArray(r))throw Error(`Invalid cells${t?.cells}`);let n=z(await p).parse(JSON.parse(t?.props||"{}"));F(e,n,r)}catch(e){alert(`Invalid properties passed to the spreadsheet component: ${e}`)}}let w=document.getElementsByClassName("sqlpage_spreadsheet"),P=w[w.length-1];if(!(P instanceof HTMLElement))throw Error("No spreadsheet elements found");Y(P)}();
//# sourceMappingURL=spreadsheet_component.dcd1e0b5.js.map
