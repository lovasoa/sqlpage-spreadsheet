<div class="modal fade" id="errorModal_{{@component_index}}" tabindex="-1" aria-labelledby="errorModalLabel_{{@component_index}}" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cell Update</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body"></div>
    </div>
  </div>
</div>

<script nonce="{{@csp_nonce}}" src="https://cdn.jsdelivr.net/npm/@univerjs/umd@0.2.14/lib/univer.full.umd.js"></script>
<script nonce="{{@csp_nonce}}" src="https://cdn.jsdelivr.net/npm/@univerjs/umd@0.2.14/lib/locale/en-US.js"></script>
<style>
  @import url(https://cdn.jsdelivr.net/npm/@univerjs/umd@0.2.14/lib/univer.min.css);
  @media (min-width: 768px) {
    .sqlpage_spreadsheet {
      margin: 0 -2rem;
      width: calc(100% + 4rem);
    }
  }
</style>

<div id="_sqlpage_spreadsheet_univer_{{@component_index}}" class="sqlpage_spreadsheet" style="height: 80vh">
  <div class="d-flex justify-content-center h-100 align-items-center">
    <div class="spinner-border" role="status" style="width: 3rem; height: 3rem;">
      <span class="visually-hidden">Loading spreadsheet...</span>
    </div>
  </div>
</div>
 
<script 
type="module"
nonce="{{@csp_nonce}}"
data-cells="
[
{{#each_row}}
  {{~#unless (eq @row_index 0)~}}
    ,
  {{~/unless~}}
  [
    {{~stringify x~}}, {{~stringify y~}}, {{~stringify value~}}
    {{~#if bold~}} ,1 {{~/if~}}
    {{~#if italic~}} ,2 {{~/if~}}
    {{~#if color~}} ,3,{{stringify color}} {{~/if~}}
    {{~#if center~}} ,4 {{~/if~}}
    {{~#if right~}} ,5 {{~/if~}}
    {{~#if number_format~}} ,6,{{stringify number_format}} {{~/if~}}
    {{~#if id~}} ,7,{{stringify id}} {{~/if~}}
  ]
{{/each_row}}
]
" src="spreadsheet.ts"></script>